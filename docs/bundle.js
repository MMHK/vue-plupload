(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.VuePlupload = f()}})(function(){var define,module,exports;return (function(){function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}return e})()({1:[function(require,module,exports){
var VuePlupload = require('./src/vue-plupload.vue')

var vuepluploader = {
    install: function(Vue) {
        Vue.component('vue-plupload', VuePlupload)
    }
}

module.exports = vuepluploader
},{"./src/vue-plupload.vue":102}],2:[function(require,module,exports){
var hashClear = require('./_hashClear'),
    hashDelete = require('./_hashDelete'),
    hashGet = require('./_hashGet'),
    hashHas = require('./_hashHas'),
    hashSet = require('./_hashSet');

/**
 * Creates a hash object.
 *
 * @private
 * @constructor
 * @param {Array} [entries] The key-value pairs to cache.
 */
function Hash(entries) {
  var index = -1,
      length = entries == null ? 0 : entries.length;

  this.clear();
  while (++index < length) {
    var entry = entries[index];
    this.set(entry[0], entry[1]);
  }
}

// Add methods to `Hash`.
Hash.prototype.clear = hashClear;
Hash.prototype['delete'] = hashDelete;
Hash.prototype.get = hashGet;
Hash.prototype.has = hashHas;
Hash.prototype.set = hashSet;

module.exports = Hash;

},{"./_hashClear":43,"./_hashDelete":44,"./_hashGet":45,"./_hashHas":46,"./_hashSet":47}],3:[function(require,module,exports){
var listCacheClear = require('./_listCacheClear'),
    listCacheDelete = require('./_listCacheDelete'),
    listCacheGet = require('./_listCacheGet'),
    listCacheHas = require('./_listCacheHas'),
    listCacheSet = require('./_listCacheSet');

/**
 * Creates an list cache object.
 *
 * @private
 * @constructor
 * @param {Array} [entries] The key-value pairs to cache.
 */
function ListCache(entries) {
  var index = -1,
      length = entries == null ? 0 : entries.length;

  this.clear();
  while (++index < length) {
    var entry = entries[index];
    this.set(entry[0], entry[1]);
  }
}

// Add methods to `ListCache`.
ListCache.prototype.clear = listCacheClear;
ListCache.prototype['delete'] = listCacheDelete;
ListCache.prototype.get = listCacheGet;
ListCache.prototype.has = listCacheHas;
ListCache.prototype.set = listCacheSet;

module.exports = ListCache;

},{"./_listCacheClear":54,"./_listCacheDelete":55,"./_listCacheGet":56,"./_listCacheHas":57,"./_listCacheSet":58}],4:[function(require,module,exports){
var getNative = require('./_getNative'),
    root = require('./_root');

/* Built-in method references that are verified to be native. */
var Map = getNative(root, 'Map');

module.exports = Map;

},{"./_getNative":39,"./_root":70}],5:[function(require,module,exports){
var mapCacheClear = require('./_mapCacheClear'),
    mapCacheDelete = require('./_mapCacheDelete'),
    mapCacheGet = require('./_mapCacheGet'),
    mapCacheHas = require('./_mapCacheHas'),
    mapCacheSet = require('./_mapCacheSet');

/**
 * Creates a map cache object to store key-value pairs.
 *
 * @private
 * @constructor
 * @param {Array} [entries] The key-value pairs to cache.
 */
function MapCache(entries) {
  var index = -1,
      length = entries == null ? 0 : entries.length;

  this.clear();
  while (++index < length) {
    var entry = entries[index];
    this.set(entry[0], entry[1]);
  }
}

// Add methods to `MapCache`.
MapCache.prototype.clear = mapCacheClear;
MapCache.prototype['delete'] = mapCacheDelete;
MapCache.prototype.get = mapCacheGet;
MapCache.prototype.has = mapCacheHas;
MapCache.prototype.set = mapCacheSet;

module.exports = MapCache;

},{"./_mapCacheClear":59,"./_mapCacheDelete":60,"./_mapCacheGet":61,"./_mapCacheHas":62,"./_mapCacheSet":63}],6:[function(require,module,exports){
var ListCache = require('./_ListCache'),
    stackClear = require('./_stackClear'),
    stackDelete = require('./_stackDelete'),
    stackGet = require('./_stackGet'),
    stackHas = require('./_stackHas'),
    stackSet = require('./_stackSet');

/**
 * Creates a stack cache object to store key-value pairs.
 *
 * @private
 * @constructor
 * @param {Array} [entries] The key-value pairs to cache.
 */
function Stack(entries) {
  var data = this.__data__ = new ListCache(entries);
  this.size = data.size;
}

// Add methods to `Stack`.
Stack.prototype.clear = stackClear;
Stack.prototype['delete'] = stackDelete;
Stack.prototype.get = stackGet;
Stack.prototype.has = stackHas;
Stack.prototype.set = stackSet;

module.exports = Stack;

},{"./_ListCache":3,"./_stackClear":74,"./_stackDelete":75,"./_stackGet":76,"./_stackHas":77,"./_stackSet":78}],7:[function(require,module,exports){
var root = require('./_root');

/** Built-in value references. */
var Symbol = root.Symbol;

module.exports = Symbol;

},{"./_root":70}],8:[function(require,module,exports){
var root = require('./_root');

/** Built-in value references. */
var Uint8Array = root.Uint8Array;

module.exports = Uint8Array;

},{"./_root":70}],9:[function(require,module,exports){
/**
 * A faster alternative to `Function#apply`, this function invokes `func`
 * with the `this` binding of `thisArg` and the arguments of `args`.
 *
 * @private
 * @param {Function} func The function to invoke.
 * @param {*} thisArg The `this` binding of `func`.
 * @param {Array} args The arguments to invoke `func` with.
 * @returns {*} Returns the result of `func`.
 */
function apply(func, thisArg, args) {
  switch (args.length) {
    case 0: return func.call(thisArg);
    case 1: return func.call(thisArg, args[0]);
    case 2: return func.call(thisArg, args[0], args[1]);
    case 3: return func.call(thisArg, args[0], args[1], args[2]);
  }
  return func.apply(thisArg, args);
}

module.exports = apply;

},{}],10:[function(require,module,exports){
var baseTimes = require('./_baseTimes'),
    isArguments = require('./isArguments'),
    isArray = require('./isArray'),
    isBuffer = require('./isBuffer'),
    isIndex = require('./_isIndex'),
    isTypedArray = require('./isTypedArray');

/** Used for built-in method references. */
var objectProto = Object.prototype;

/** Used to check objects for own properties. */
var hasOwnProperty = objectProto.hasOwnProperty;

/**
 * Creates an array of the enumerable property names of the array-like `value`.
 *
 * @private
 * @param {*} value The value to query.
 * @param {boolean} inherited Specify returning inherited property names.
 * @returns {Array} Returns the array of property names.
 */
function arrayLikeKeys(value, inherited) {
  var isArr = isArray(value),
      isArg = !isArr && isArguments(value),
      isBuff = !isArr && !isArg && isBuffer(value),
      isType = !isArr && !isArg && !isBuff && isTypedArray(value),
      skipIndexes = isArr || isArg || isBuff || isType,
      result = skipIndexes ? baseTimes(value.length, String) : [],
      length = result.length;

  for (var key in value) {
    if ((inherited || hasOwnProperty.call(value, key)) &&
        !(skipIndexes && (
           // Safari 9 has enumerable `arguments.length` in strict mode.
           key == 'length' ||
           // Node.js 0.10 has enumerable non-index properties on buffers.
           (isBuff && (key == 'offset' || key == 'parent')) ||
           // PhantomJS 2 has enumerable non-index properties on typed arrays.
           (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||
           // Skip index properties.
           isIndex(key, length)
        ))) {
      result.push(key);
    }
  }
  return result;
}

module.exports = arrayLikeKeys;

},{"./_baseTimes":26,"./_isIndex":49,"./isArguments":83,"./isArray":84,"./isBuffer":87,"./isTypedArray":93}],11:[function(require,module,exports){
var baseAssignValue = require('./_baseAssignValue'),
    eq = require('./eq');

/**
 * This function is like `assignValue` except that it doesn't assign
 * `undefined` values.
 *
 * @private
 * @param {Object} object The object to modify.
 * @param {string} key The key of the property to assign.
 * @param {*} value The value to assign.
 */
function assignMergeValue(object, key, value) {
  if ((value !== undefined && !eq(object[key], value)) ||
      (value === undefined && !(key in object))) {
    baseAssignValue(object, key, value);
  }
}

module.exports = assignMergeValue;

},{"./_baseAssignValue":14,"./eq":81}],12:[function(require,module,exports){
var baseAssignValue = require('./_baseAssignValue'),
    eq = require('./eq');

/** Used for built-in method references. */
var objectProto = Object.prototype;

/** Used to check objects for own properties. */
var hasOwnProperty = objectProto.hasOwnProperty;

/**
 * Assigns `value` to `key` of `object` if the existing value is not equivalent
 * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)
 * for equality comparisons.
 *
 * @private
 * @param {Object} object The object to modify.
 * @param {string} key The key of the property to assign.
 * @param {*} value The value to assign.
 */
function assignValue(object, key, value) {
  var objValue = object[key];
  if (!(hasOwnProperty.call(object, key) && eq(objValue, value)) ||
      (value === undefined && !(key in object))) {
    baseAssignValue(object, key, value);
  }
}

module.exports = assignValue;

},{"./_baseAssignValue":14,"./eq":81}],13:[function(require,module,exports){
var eq = require('./eq');

/**
 * Gets the index at which the `key` is found in `array` of key-value pairs.
 *
 * @private
 * @param {Array} array The array to inspect.
 * @param {*} key The key to search for.
 * @returns {number} Returns the index of the matched value, else `-1`.
 */
function assocIndexOf(array, key) {
  var length = array.length;
  while (length--) {
    if (eq(array[length][0], key)) {
      return length;
    }
  }
  return -1;
}

module.exports = assocIndexOf;

},{"./eq":81}],14:[function(require,module,exports){
var defineProperty = require('./_defineProperty');

/**
 * The base implementation of `assignValue` and `assignMergeValue` without
 * value checks.
 *
 * @private
 * @param {Object} object The object to modify.
 * @param {string} key The key of the property to assign.
 * @param {*} value The value to assign.
 */
function baseAssignValue(object, key, value) {
  if (key == '__proto__' && defineProperty) {
    defineProperty(object, key, {
      'configurable': true,
      'enumerable': true,
      'value': value,
      'writable': true
    });
  } else {
    object[key] = value;
  }
}

module.exports = baseAssignValue;

},{"./_defineProperty":36}],15:[function(require,module,exports){
var isObject = require('./isObject');

/** Built-in value references. */
var objectCreate = Object.create;

/**
 * The base implementation of `_.create` without support for assigning
 * properties to the created object.
 *
 * @private
 * @param {Object} proto The object to inherit from.
 * @returns {Object} Returns the new object.
 */
var baseCreate = (function() {
  function object() {}
  return function(proto) {
    if (!isObject(proto)) {
      return {};
    }
    if (objectCreate) {
      return objectCreate(proto);
    }
    object.prototype = proto;
    var result = new object;
    object.prototype = undefined;
    return result;
  };
}());

module.exports = baseCreate;

},{"./isObject":90}],16:[function(require,module,exports){
var createBaseFor = require('./_createBaseFor');

/**
 * The base implementation of `baseForOwn` which iterates over `object`
 * properties returned by `keysFunc` and invokes `iteratee` for each property.
 * Iteratee functions may exit iteration early by explicitly returning `false`.
 *
 * @private
 * @param {Object} object The object to iterate over.
 * @param {Function} iteratee The function invoked per iteration.
 * @param {Function} keysFunc The function to get the keys of `object`.
 * @returns {Object} Returns `object`.
 */
var baseFor = createBaseFor();

module.exports = baseFor;

},{"./_createBaseFor":35}],17:[function(require,module,exports){
var Symbol = require('./_Symbol'),
    getRawTag = require('./_getRawTag'),
    objectToString = require('./_objectToString');

/** `Object#toString` result references. */
var nullTag = '[object Null]',
    undefinedTag = '[object Undefined]';

/** Built-in value references. */
var symToStringTag = Symbol ? Symbol.toStringTag : undefined;

/**
 * The base implementation of `getTag` without fallbacks for buggy environments.
 *
 * @private
 * @param {*} value The value to query.
 * @returns {string} Returns the `toStringTag`.
 */
function baseGetTag(value) {
  if (value == null) {
    return value === undefined ? undefinedTag : nullTag;
  }
  return (symToStringTag && symToStringTag in Object(value))
    ? getRawTag(value)
    : objectToString(value);
}

module.exports = baseGetTag;

},{"./_Symbol":7,"./_getRawTag":41,"./_objectToString":67}],18:[function(require,module,exports){
var baseGetTag = require('./_baseGetTag'),
    isObjectLike = require('./isObjectLike');

/** `Object#toString` result references. */
var argsTag = '[object Arguments]';

/**
 * The base implementation of `_.isArguments`.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an `arguments` object,
 */
function baseIsArguments(value) {
  return isObjectLike(value) && baseGetTag(value) == argsTag;
}

module.exports = baseIsArguments;

},{"./_baseGetTag":17,"./isObjectLike":91}],19:[function(require,module,exports){
var isFunction = require('./isFunction'),
    isMasked = require('./_isMasked'),
    isObject = require('./isObject'),
    toSource = require('./_toSource');

/**
 * Used to match `RegExp`
 * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).
 */
var reRegExpChar = /[\\^$.*+?()[\]{}|]/g;

/** Used to detect host constructors (Safari). */
var reIsHostCtor = /^\[object .+?Constructor\]$/;

/** Used for built-in method references. */
var funcProto = Function.prototype,
    objectProto = Object.prototype;

/** Used to resolve the decompiled source of functions. */
var funcToString = funcProto.toString;

/** Used to check objects for own properties. */
var hasOwnProperty = objectProto.hasOwnProperty;

/** Used to detect if a method is native. */
var reIsNative = RegExp('^' +
  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\$&')
  .replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g, '$1.*?') + '$'
);

/**
 * The base implementation of `_.isNative` without bad shim checks.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a native function,
 *  else `false`.
 */
function baseIsNative(value) {
  if (!isObject(value) || isMasked(value)) {
    return false;
  }
  var pattern = isFunction(value) ? reIsNative : reIsHostCtor;
  return pattern.test(toSource(value));
}

module.exports = baseIsNative;

},{"./_isMasked":52,"./_toSource":79,"./isFunction":88,"./isObject":90}],20:[function(require,module,exports){
var baseGetTag = require('./_baseGetTag'),
    isLength = require('./isLength'),
    isObjectLike = require('./isObjectLike');

/** `Object#toString` result references. */
var argsTag = '[object Arguments]',
    arrayTag = '[object Array]',
    boolTag = '[object Boolean]',
    dateTag = '[object Date]',
    errorTag = '[object Error]',
    funcTag = '[object Function]',
    mapTag = '[object Map]',
    numberTag = '[object Number]',
    objectTag = '[object Object]',
    regexpTag = '[object RegExp]',
    setTag = '[object Set]',
    stringTag = '[object String]',
    weakMapTag = '[object WeakMap]';

var arrayBufferTag = '[object ArrayBuffer]',
    dataViewTag = '[object DataView]',
    float32Tag = '[object Float32Array]',
    float64Tag = '[object Float64Array]',
    int8Tag = '[object Int8Array]',
    int16Tag = '[object Int16Array]',
    int32Tag = '[object Int32Array]',
    uint8Tag = '[object Uint8Array]',
    uint8ClampedTag = '[object Uint8ClampedArray]',
    uint16Tag = '[object Uint16Array]',
    uint32Tag = '[object Uint32Array]';

/** Used to identify `toStringTag` values of typed arrays. */
var typedArrayTags = {};
typedArrayTags[float32Tag] = typedArrayTags[float64Tag] =
typedArrayTags[int8Tag] = typedArrayTags[int16Tag] =
typedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =
typedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =
typedArrayTags[uint32Tag] = true;
typedArrayTags[argsTag] = typedArrayTags[arrayTag] =
typedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =
typedArrayTags[dataViewTag] = typedArrayTags[dateTag] =
typedArrayTags[errorTag] = typedArrayTags[funcTag] =
typedArrayTags[mapTag] = typedArrayTags[numberTag] =
typedArrayTags[objectTag] = typedArrayTags[regexpTag] =
typedArrayTags[setTag] = typedArrayTags[stringTag] =
typedArrayTags[weakMapTag] = false;

/**
 * The base implementation of `_.isTypedArray` without Node.js optimizations.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.
 */
function baseIsTypedArray(value) {
  return isObjectLike(value) &&
    isLength(value.length) && !!typedArrayTags[baseGetTag(value)];
}

module.exports = baseIsTypedArray;

},{"./_baseGetTag":17,"./isLength":89,"./isObjectLike":91}],21:[function(require,module,exports){
var isObject = require('./isObject'),
    isPrototype = require('./_isPrototype'),
    nativeKeysIn = require('./_nativeKeysIn');

/** Used for built-in method references. */
var objectProto = Object.prototype;

/** Used to check objects for own properties. */
var hasOwnProperty = objectProto.hasOwnProperty;

/**
 * The base implementation of `_.keysIn` which doesn't treat sparse arrays as dense.
 *
 * @private
 * @param {Object} object The object to query.
 * @returns {Array} Returns the array of property names.
 */
function baseKeysIn(object) {
  if (!isObject(object)) {
    return nativeKeysIn(object);
  }
  var isProto = isPrototype(object),
      result = [];

  for (var key in object) {
    if (!(key == 'constructor' && (isProto || !hasOwnProperty.call(object, key)))) {
      result.push(key);
    }
  }
  return result;
}

module.exports = baseKeysIn;

},{"./_isPrototype":53,"./_nativeKeysIn":65,"./isObject":90}],22:[function(require,module,exports){
var Stack = require('./_Stack'),
    assignMergeValue = require('./_assignMergeValue'),
    baseFor = require('./_baseFor'),
    baseMergeDeep = require('./_baseMergeDeep'),
    isObject = require('./isObject'),
    keysIn = require('./keysIn'),
    safeGet = require('./_safeGet');

/**
 * The base implementation of `_.merge` without support for multiple sources.
 *
 * @private
 * @param {Object} object The destination object.
 * @param {Object} source The source object.
 * @param {number} srcIndex The index of `source`.
 * @param {Function} [customizer] The function to customize merged values.
 * @param {Object} [stack] Tracks traversed source values and their merged
 *  counterparts.
 */
function baseMerge(object, source, srcIndex, customizer, stack) {
  if (object === source) {
    return;
  }
  baseFor(source, function(srcValue, key) {
    if (isObject(srcValue)) {
      stack || (stack = new Stack);
      baseMergeDeep(object, source, key, srcIndex, baseMerge, customizer, stack);
    }
    else {
      var newValue = customizer
        ? customizer(safeGet(object, key), srcValue, (key + ''), object, source, stack)
        : undefined;

      if (newValue === undefined) {
        newValue = srcValue;
      }
      assignMergeValue(object, key, newValue);
    }
  }, keysIn);
}

module.exports = baseMerge;

},{"./_Stack":6,"./_assignMergeValue":11,"./_baseFor":16,"./_baseMergeDeep":23,"./_safeGet":71,"./isObject":90,"./keysIn":94}],23:[function(require,module,exports){
var assignMergeValue = require('./_assignMergeValue'),
    cloneBuffer = require('./_cloneBuffer'),
    cloneTypedArray = require('./_cloneTypedArray'),
    copyArray = require('./_copyArray'),
    initCloneObject = require('./_initCloneObject'),
    isArguments = require('./isArguments'),
    isArray = require('./isArray'),
    isArrayLikeObject = require('./isArrayLikeObject'),
    isBuffer = require('./isBuffer'),
    isFunction = require('./isFunction'),
    isObject = require('./isObject'),
    isPlainObject = require('./isPlainObject'),
    isTypedArray = require('./isTypedArray'),
    safeGet = require('./_safeGet'),
    toPlainObject = require('./toPlainObject');

/**
 * A specialized version of `baseMerge` for arrays and objects which performs
 * deep merges and tracks traversed objects enabling objects with circular
 * references to be merged.
 *
 * @private
 * @param {Object} object The destination object.
 * @param {Object} source The source object.
 * @param {string} key The key of the value to merge.
 * @param {number} srcIndex The index of `source`.
 * @param {Function} mergeFunc The function to merge values.
 * @param {Function} [customizer] The function to customize assigned values.
 * @param {Object} [stack] Tracks traversed source values and their merged
 *  counterparts.
 */
function baseMergeDeep(object, source, key, srcIndex, mergeFunc, customizer, stack) {
  var objValue = safeGet(object, key),
      srcValue = safeGet(source, key),
      stacked = stack.get(srcValue);

  if (stacked) {
    assignMergeValue(object, key, stacked);
    return;
  }
  var newValue = customizer
    ? customizer(objValue, srcValue, (key + ''), object, source, stack)
    : undefined;

  var isCommon = newValue === undefined;

  if (isCommon) {
    var isArr = isArray(srcValue),
        isBuff = !isArr && isBuffer(srcValue),
        isTyped = !isArr && !isBuff && isTypedArray(srcValue);

    newValue = srcValue;
    if (isArr || isBuff || isTyped) {
      if (isArray(objValue)) {
        newValue = objValue;
      }
      else if (isArrayLikeObject(objValue)) {
        newValue = copyArray(objValue);
      }
      else if (isBuff) {
        isCommon = false;
        newValue = cloneBuffer(srcValue, true);
      }
      else if (isTyped) {
        isCommon = false;
        newValue = cloneTypedArray(srcValue, true);
      }
      else {
        newValue = [];
      }
    }
    else if (isPlainObject(srcValue) || isArguments(srcValue)) {
      newValue = objValue;
      if (isArguments(objValue)) {
        newValue = toPlainObject(objValue);
      }
      else if (!isObject(objValue) || (srcIndex && isFunction(objValue))) {
        newValue = initCloneObject(srcValue);
      }
    }
    else {
      isCommon = false;
    }
  }
  if (isCommon) {
    // Recursively merge objects and arrays (susceptible to call stack limits).
    stack.set(srcValue, newValue);
    mergeFunc(newValue, srcValue, srcIndex, customizer, stack);
    stack['delete'](srcValue);
  }
  assignMergeValue(object, key, newValue);
}

module.exports = baseMergeDeep;

},{"./_assignMergeValue":11,"./_cloneBuffer":29,"./_cloneTypedArray":30,"./_copyArray":31,"./_initCloneObject":48,"./_safeGet":71,"./isArguments":83,"./isArray":84,"./isArrayLikeObject":86,"./isBuffer":87,"./isFunction":88,"./isObject":90,"./isPlainObject":92,"./isTypedArray":93,"./toPlainObject":97}],24:[function(require,module,exports){
var identity = require('./identity'),
    overRest = require('./_overRest'),
    setToString = require('./_setToString');

/**
 * The base implementation of `_.rest` which doesn't validate or coerce arguments.
 *
 * @private
 * @param {Function} func The function to apply a rest parameter to.
 * @param {number} [start=func.length-1] The start position of the rest parameter.
 * @returns {Function} Returns the new function.
 */
function baseRest(func, start) {
  return setToString(overRest(func, start, identity), func + '');
}

module.exports = baseRest;

},{"./_overRest":69,"./_setToString":72,"./identity":82}],25:[function(require,module,exports){
var constant = require('./constant'),
    defineProperty = require('./_defineProperty'),
    identity = require('./identity');

/**
 * The base implementation of `setToString` without support for hot loop shorting.
 *
 * @private
 * @param {Function} func The function to modify.
 * @param {Function} string The `toString` result.
 * @returns {Function} Returns `func`.
 */
var baseSetToString = !defineProperty ? identity : function(func, string) {
  return defineProperty(func, 'toString', {
    'configurable': true,
    'enumerable': false,
    'value': constant(string),
    'writable': true
  });
};

module.exports = baseSetToString;

},{"./_defineProperty":36,"./constant":80,"./identity":82}],26:[function(require,module,exports){
/**
 * The base implementation of `_.times` without support for iteratee shorthands
 * or max array length checks.
 *
 * @private
 * @param {number} n The number of times to invoke `iteratee`.
 * @param {Function} iteratee The function invoked per iteration.
 * @returns {Array} Returns the array of results.
 */
function baseTimes(n, iteratee) {
  var index = -1,
      result = Array(n);

  while (++index < n) {
    result[index] = iteratee(index);
  }
  return result;
}

module.exports = baseTimes;

},{}],27:[function(require,module,exports){
/**
 * The base implementation of `_.unary` without support for storing metadata.
 *
 * @private
 * @param {Function} func The function to cap arguments for.
 * @returns {Function} Returns the new capped function.
 */
function baseUnary(func) {
  return function(value) {
    return func(value);
  };
}

module.exports = baseUnary;

},{}],28:[function(require,module,exports){
var Uint8Array = require('./_Uint8Array');

/**
 * Creates a clone of `arrayBuffer`.
 *
 * @private
 * @param {ArrayBuffer} arrayBuffer The array buffer to clone.
 * @returns {ArrayBuffer} Returns the cloned array buffer.
 */
function cloneArrayBuffer(arrayBuffer) {
  var result = new arrayBuffer.constructor(arrayBuffer.byteLength);
  new Uint8Array(result).set(new Uint8Array(arrayBuffer));
  return result;
}

module.exports = cloneArrayBuffer;

},{"./_Uint8Array":8}],29:[function(require,module,exports){
var root = require('./_root');

/** Detect free variable `exports`. */
var freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;

/** Detect free variable `module`. */
var freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;

/** Detect the popular CommonJS extension `module.exports`. */
var moduleExports = freeModule && freeModule.exports === freeExports;

/** Built-in value references. */
var Buffer = moduleExports ? root.Buffer : undefined,
    allocUnsafe = Buffer ? Buffer.allocUnsafe : undefined;

/**
 * Creates a clone of  `buffer`.
 *
 * @private
 * @param {Buffer} buffer The buffer to clone.
 * @param {boolean} [isDeep] Specify a deep clone.
 * @returns {Buffer} Returns the cloned buffer.
 */
function cloneBuffer(buffer, isDeep) {
  if (isDeep) {
    return buffer.slice();
  }
  var length = buffer.length,
      result = allocUnsafe ? allocUnsafe(length) : new buffer.constructor(length);

  buffer.copy(result);
  return result;
}

module.exports = cloneBuffer;

},{"./_root":70}],30:[function(require,module,exports){
var cloneArrayBuffer = require('./_cloneArrayBuffer');

/**
 * Creates a clone of `typedArray`.
 *
 * @private
 * @param {Object} typedArray The typed array to clone.
 * @param {boolean} [isDeep] Specify a deep clone.
 * @returns {Object} Returns the cloned typed array.
 */
function cloneTypedArray(typedArray, isDeep) {
  var buffer = isDeep ? cloneArrayBuffer(typedArray.buffer) : typedArray.buffer;
  return new typedArray.constructor(buffer, typedArray.byteOffset, typedArray.length);
}

module.exports = cloneTypedArray;

},{"./_cloneArrayBuffer":28}],31:[function(require,module,exports){
/**
 * Copies the values of `source` to `array`.
 *
 * @private
 * @param {Array} source The array to copy values from.
 * @param {Array} [array=[]] The array to copy values to.
 * @returns {Array} Returns `array`.
 */
function copyArray(source, array) {
  var index = -1,
      length = source.length;

  array || (array = Array(length));
  while (++index < length) {
    array[index] = source[index];
  }
  return array;
}

module.exports = copyArray;

},{}],32:[function(require,module,exports){
var assignValue = require('./_assignValue'),
    baseAssignValue = require('./_baseAssignValue');

/**
 * Copies properties of `source` to `object`.
 *
 * @private
 * @param {Object} source The object to copy properties from.
 * @param {Array} props The property identifiers to copy.
 * @param {Object} [object={}] The object to copy properties to.
 * @param {Function} [customizer] The function to customize copied values.
 * @returns {Object} Returns `object`.
 */
function copyObject(source, props, object, customizer) {
  var isNew = !object;
  object || (object = {});

  var index = -1,
      length = props.length;

  while (++index < length) {
    var key = props[index];

    var newValue = customizer
      ? customizer(object[key], source[key], key, object, source)
      : undefined;

    if (newValue === undefined) {
      newValue = source[key];
    }
    if (isNew) {
      baseAssignValue(object, key, newValue);
    } else {
      assignValue(object, key, newValue);
    }
  }
  return object;
}

module.exports = copyObject;

},{"./_assignValue":12,"./_baseAssignValue":14}],33:[function(require,module,exports){
var root = require('./_root');

/** Used to detect overreaching core-js shims. */
var coreJsData = root['__core-js_shared__'];

module.exports = coreJsData;

},{"./_root":70}],34:[function(require,module,exports){
var baseRest = require('./_baseRest'),
    isIterateeCall = require('./_isIterateeCall');

/**
 * Creates a function like `_.assign`.
 *
 * @private
 * @param {Function} assigner The function to assign values.
 * @returns {Function} Returns the new assigner function.
 */
function createAssigner(assigner) {
  return baseRest(function(object, sources) {
    var index = -1,
        length = sources.length,
        customizer = length > 1 ? sources[length - 1] : undefined,
        guard = length > 2 ? sources[2] : undefined;

    customizer = (assigner.length > 3 && typeof customizer == 'function')
      ? (length--, customizer)
      : undefined;

    if (guard && isIterateeCall(sources[0], sources[1], guard)) {
      customizer = length < 3 ? undefined : customizer;
      length = 1;
    }
    object = Object(object);
    while (++index < length) {
      var source = sources[index];
      if (source) {
        assigner(object, source, index, customizer);
      }
    }
    return object;
  });
}

module.exports = createAssigner;

},{"./_baseRest":24,"./_isIterateeCall":50}],35:[function(require,module,exports){
/**
 * Creates a base function for methods like `_.forIn` and `_.forOwn`.
 *
 * @private
 * @param {boolean} [fromRight] Specify iterating from right to left.
 * @returns {Function} Returns the new base function.
 */
function createBaseFor(fromRight) {
  return function(object, iteratee, keysFunc) {
    var index = -1,
        iterable = Object(object),
        props = keysFunc(object),
        length = props.length;

    while (length--) {
      var key = props[fromRight ? length : ++index];
      if (iteratee(iterable[key], key, iterable) === false) {
        break;
      }
    }
    return object;
  };
}

module.exports = createBaseFor;

},{}],36:[function(require,module,exports){
var getNative = require('./_getNative');

var defineProperty = (function() {
  try {
    var func = getNative(Object, 'defineProperty');
    func({}, '', {});
    return func;
  } catch (e) {}
}());

module.exports = defineProperty;

},{"./_getNative":39}],37:[function(require,module,exports){
(function (global){
/** Detect free variable `global` from Node.js. */
var freeGlobal = typeof global == 'object' && global && global.Object === Object && global;

module.exports = freeGlobal;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],38:[function(require,module,exports){
var isKeyable = require('./_isKeyable');

/**
 * Gets the data for `map`.
 *
 * @private
 * @param {Object} map The map to query.
 * @param {string} key The reference key.
 * @returns {*} Returns the map data.
 */
function getMapData(map, key) {
  var data = map.__data__;
  return isKeyable(key)
    ? data[typeof key == 'string' ? 'string' : 'hash']
    : data.map;
}

module.exports = getMapData;

},{"./_isKeyable":51}],39:[function(require,module,exports){
var baseIsNative = require('./_baseIsNative'),
    getValue = require('./_getValue');

/**
 * Gets the native function at `key` of `object`.
 *
 * @private
 * @param {Object} object The object to query.
 * @param {string} key The key of the method to get.
 * @returns {*} Returns the function if it's native, else `undefined`.
 */
function getNative(object, key) {
  var value = getValue(object, key);
  return baseIsNative(value) ? value : undefined;
}

module.exports = getNative;

},{"./_baseIsNative":19,"./_getValue":42}],40:[function(require,module,exports){
var overArg = require('./_overArg');

/** Built-in value references. */
var getPrototype = overArg(Object.getPrototypeOf, Object);

module.exports = getPrototype;

},{"./_overArg":68}],41:[function(require,module,exports){
var Symbol = require('./_Symbol');

/** Used for built-in method references. */
var objectProto = Object.prototype;

/** Used to check objects for own properties. */
var hasOwnProperty = objectProto.hasOwnProperty;

/**
 * Used to resolve the
 * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)
 * of values.
 */
var nativeObjectToString = objectProto.toString;

/** Built-in value references. */
var symToStringTag = Symbol ? Symbol.toStringTag : undefined;

/**
 * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.
 *
 * @private
 * @param {*} value The value to query.
 * @returns {string} Returns the raw `toStringTag`.
 */
function getRawTag(value) {
  var isOwn = hasOwnProperty.call(value, symToStringTag),
      tag = value[symToStringTag];

  try {
    value[symToStringTag] = undefined;
    var unmasked = true;
  } catch (e) {}

  var result = nativeObjectToString.call(value);
  if (unmasked) {
    if (isOwn) {
      value[symToStringTag] = tag;
    } else {
      delete value[symToStringTag];
    }
  }
  return result;
}

module.exports = getRawTag;

},{"./_Symbol":7}],42:[function(require,module,exports){
/**
 * Gets the value at `key` of `object`.
 *
 * @private
 * @param {Object} [object] The object to query.
 * @param {string} key The key of the property to get.
 * @returns {*} Returns the property value.
 */
function getValue(object, key) {
  return object == null ? undefined : object[key];
}

module.exports = getValue;

},{}],43:[function(require,module,exports){
var nativeCreate = require('./_nativeCreate');

/**
 * Removes all key-value entries from the hash.
 *
 * @private
 * @name clear
 * @memberOf Hash
 */
function hashClear() {
  this.__data__ = nativeCreate ? nativeCreate(null) : {};
  this.size = 0;
}

module.exports = hashClear;

},{"./_nativeCreate":64}],44:[function(require,module,exports){
/**
 * Removes `key` and its value from the hash.
 *
 * @private
 * @name delete
 * @memberOf Hash
 * @param {Object} hash The hash to modify.
 * @param {string} key The key of the value to remove.
 * @returns {boolean} Returns `true` if the entry was removed, else `false`.
 */
function hashDelete(key) {
  var result = this.has(key) && delete this.__data__[key];
  this.size -= result ? 1 : 0;
  return result;
}

module.exports = hashDelete;

},{}],45:[function(require,module,exports){
var nativeCreate = require('./_nativeCreate');

/** Used to stand-in for `undefined` hash values. */
var HASH_UNDEFINED = '__lodash_hash_undefined__';

/** Used for built-in method references. */
var objectProto = Object.prototype;

/** Used to check objects for own properties. */
var hasOwnProperty = objectProto.hasOwnProperty;

/**
 * Gets the hash value for `key`.
 *
 * @private
 * @name get
 * @memberOf Hash
 * @param {string} key The key of the value to get.
 * @returns {*} Returns the entry value.
 */
function hashGet(key) {
  var data = this.__data__;
  if (nativeCreate) {
    var result = data[key];
    return result === HASH_UNDEFINED ? undefined : result;
  }
  return hasOwnProperty.call(data, key) ? data[key] : undefined;
}

module.exports = hashGet;

},{"./_nativeCreate":64}],46:[function(require,module,exports){
var nativeCreate = require('./_nativeCreate');

/** Used for built-in method references. */
var objectProto = Object.prototype;

/** Used to check objects for own properties. */
var hasOwnProperty = objectProto.hasOwnProperty;

/**
 * Checks if a hash value for `key` exists.
 *
 * @private
 * @name has
 * @memberOf Hash
 * @param {string} key The key of the entry to check.
 * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.
 */
function hashHas(key) {
  var data = this.__data__;
  return nativeCreate ? (data[key] !== undefined) : hasOwnProperty.call(data, key);
}

module.exports = hashHas;

},{"./_nativeCreate":64}],47:[function(require,module,exports){
var nativeCreate = require('./_nativeCreate');

/** Used to stand-in for `undefined` hash values. */
var HASH_UNDEFINED = '__lodash_hash_undefined__';

/**
 * Sets the hash `key` to `value`.
 *
 * @private
 * @name set
 * @memberOf Hash
 * @param {string} key The key of the value to set.
 * @param {*} value The value to set.
 * @returns {Object} Returns the hash instance.
 */
function hashSet(key, value) {
  var data = this.__data__;
  this.size += this.has(key) ? 0 : 1;
  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;
  return this;
}

module.exports = hashSet;

},{"./_nativeCreate":64}],48:[function(require,module,exports){
var baseCreate = require('./_baseCreate'),
    getPrototype = require('./_getPrototype'),
    isPrototype = require('./_isPrototype');

/**
 * Initializes an object clone.
 *
 * @private
 * @param {Object} object The object to clone.
 * @returns {Object} Returns the initialized clone.
 */
function initCloneObject(object) {
  return (typeof object.constructor == 'function' && !isPrototype(object))
    ? baseCreate(getPrototype(object))
    : {};
}

module.exports = initCloneObject;

},{"./_baseCreate":15,"./_getPrototype":40,"./_isPrototype":53}],49:[function(require,module,exports){
/** Used as references for various `Number` constants. */
var MAX_SAFE_INTEGER = 9007199254740991;

/** Used to detect unsigned integer values. */
var reIsUint = /^(?:0|[1-9]\d*)$/;

/**
 * Checks if `value` is a valid array-like index.
 *
 * @private
 * @param {*} value The value to check.
 * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.
 * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.
 */
function isIndex(value, length) {
  var type = typeof value;
  length = length == null ? MAX_SAFE_INTEGER : length;

  return !!length &&
    (type == 'number' ||
      (type != 'symbol' && reIsUint.test(value))) &&
        (value > -1 && value % 1 == 0 && value < length);
}

module.exports = isIndex;

},{}],50:[function(require,module,exports){
var eq = require('./eq'),
    isArrayLike = require('./isArrayLike'),
    isIndex = require('./_isIndex'),
    isObject = require('./isObject');

/**
 * Checks if the given arguments are from an iteratee call.
 *
 * @private
 * @param {*} value The potential iteratee value argument.
 * @param {*} index The potential iteratee index or key argument.
 * @param {*} object The potential iteratee object argument.
 * @returns {boolean} Returns `true` if the arguments are from an iteratee call,
 *  else `false`.
 */
function isIterateeCall(value, index, object) {
  if (!isObject(object)) {
    return false;
  }
  var type = typeof index;
  if (type == 'number'
        ? (isArrayLike(object) && isIndex(index, object.length))
        : (type == 'string' && index in object)
      ) {
    return eq(object[index], value);
  }
  return false;
}

module.exports = isIterateeCall;

},{"./_isIndex":49,"./eq":81,"./isArrayLike":85,"./isObject":90}],51:[function(require,module,exports){
/**
 * Checks if `value` is suitable for use as unique object key.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is suitable, else `false`.
 */
function isKeyable(value) {
  var type = typeof value;
  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')
    ? (value !== '__proto__')
    : (value === null);
}

module.exports = isKeyable;

},{}],52:[function(require,module,exports){
var coreJsData = require('./_coreJsData');

/** Used to detect methods masquerading as native. */
var maskSrcKey = (function() {
  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');
  return uid ? ('Symbol(src)_1.' + uid) : '';
}());

/**
 * Checks if `func` has its source masked.
 *
 * @private
 * @param {Function} func The function to check.
 * @returns {boolean} Returns `true` if `func` is masked, else `false`.
 */
function isMasked(func) {
  return !!maskSrcKey && (maskSrcKey in func);
}

module.exports = isMasked;

},{"./_coreJsData":33}],53:[function(require,module,exports){
/** Used for built-in method references. */
var objectProto = Object.prototype;

/**
 * Checks if `value` is likely a prototype object.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.
 */
function isPrototype(value) {
  var Ctor = value && value.constructor,
      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;

  return value === proto;
}

module.exports = isPrototype;

},{}],54:[function(require,module,exports){
/**
 * Removes all key-value entries from the list cache.
 *
 * @private
 * @name clear
 * @memberOf ListCache
 */
function listCacheClear() {
  this.__data__ = [];
  this.size = 0;
}

module.exports = listCacheClear;

},{}],55:[function(require,module,exports){
var assocIndexOf = require('./_assocIndexOf');

/** Used for built-in method references. */
var arrayProto = Array.prototype;

/** Built-in value references. */
var splice = arrayProto.splice;

/**
 * Removes `key` and its value from the list cache.
 *
 * @private
 * @name delete
 * @memberOf ListCache
 * @param {string} key The key of the value to remove.
 * @returns {boolean} Returns `true` if the entry was removed, else `false`.
 */
function listCacheDelete(key) {
  var data = this.__data__,
      index = assocIndexOf(data, key);

  if (index < 0) {
    return false;
  }
  var lastIndex = data.length - 1;
  if (index == lastIndex) {
    data.pop();
  } else {
    splice.call(data, index, 1);
  }
  --this.size;
  return true;
}

module.exports = listCacheDelete;

},{"./_assocIndexOf":13}],56:[function(require,module,exports){
var assocIndexOf = require('./_assocIndexOf');

/**
 * Gets the list cache value for `key`.
 *
 * @private
 * @name get
 * @memberOf ListCache
 * @param {string} key The key of the value to get.
 * @returns {*} Returns the entry value.
 */
function listCacheGet(key) {
  var data = this.__data__,
      index = assocIndexOf(data, key);

  return index < 0 ? undefined : data[index][1];
}

module.exports = listCacheGet;

},{"./_assocIndexOf":13}],57:[function(require,module,exports){
var assocIndexOf = require('./_assocIndexOf');

/**
 * Checks if a list cache value for `key` exists.
 *
 * @private
 * @name has
 * @memberOf ListCache
 * @param {string} key The key of the entry to check.
 * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.
 */
function listCacheHas(key) {
  return assocIndexOf(this.__data__, key) > -1;
}

module.exports = listCacheHas;

},{"./_assocIndexOf":13}],58:[function(require,module,exports){
var assocIndexOf = require('./_assocIndexOf');

/**
 * Sets the list cache `key` to `value`.
 *
 * @private
 * @name set
 * @memberOf ListCache
 * @param {string} key The key of the value to set.
 * @param {*} value The value to set.
 * @returns {Object} Returns the list cache instance.
 */
function listCacheSet(key, value) {
  var data = this.__data__,
      index = assocIndexOf(data, key);

  if (index < 0) {
    ++this.size;
    data.push([key, value]);
  } else {
    data[index][1] = value;
  }
  return this;
}

module.exports = listCacheSet;

},{"./_assocIndexOf":13}],59:[function(require,module,exports){
var Hash = require('./_Hash'),
    ListCache = require('./_ListCache'),
    Map = require('./_Map');

/**
 * Removes all key-value entries from the map.
 *
 * @private
 * @name clear
 * @memberOf MapCache
 */
function mapCacheClear() {
  this.size = 0;
  this.__data__ = {
    'hash': new Hash,
    'map': new (Map || ListCache),
    'string': new Hash
  };
}

module.exports = mapCacheClear;

},{"./_Hash":2,"./_ListCache":3,"./_Map":4}],60:[function(require,module,exports){
var getMapData = require('./_getMapData');

/**
 * Removes `key` and its value from the map.
 *
 * @private
 * @name delete
 * @memberOf MapCache
 * @param {string} key The key of the value to remove.
 * @returns {boolean} Returns `true` if the entry was removed, else `false`.
 */
function mapCacheDelete(key) {
  var result = getMapData(this, key)['delete'](key);
  this.size -= result ? 1 : 0;
  return result;
}

module.exports = mapCacheDelete;

},{"./_getMapData":38}],61:[function(require,module,exports){
var getMapData = require('./_getMapData');

/**
 * Gets the map value for `key`.
 *
 * @private
 * @name get
 * @memberOf MapCache
 * @param {string} key The key of the value to get.
 * @returns {*} Returns the entry value.
 */
function mapCacheGet(key) {
  return getMapData(this, key).get(key);
}

module.exports = mapCacheGet;

},{"./_getMapData":38}],62:[function(require,module,exports){
var getMapData = require('./_getMapData');

/**
 * Checks if a map value for `key` exists.
 *
 * @private
 * @name has
 * @memberOf MapCache
 * @param {string} key The key of the entry to check.
 * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.
 */
function mapCacheHas(key) {
  return getMapData(this, key).has(key);
}

module.exports = mapCacheHas;

},{"./_getMapData":38}],63:[function(require,module,exports){
var getMapData = require('./_getMapData');

/**
 * Sets the map `key` to `value`.
 *
 * @private
 * @name set
 * @memberOf MapCache
 * @param {string} key The key of the value to set.
 * @param {*} value The value to set.
 * @returns {Object} Returns the map cache instance.
 */
function mapCacheSet(key, value) {
  var data = getMapData(this, key),
      size = data.size;

  data.set(key, value);
  this.size += data.size == size ? 0 : 1;
  return this;
}

module.exports = mapCacheSet;

},{"./_getMapData":38}],64:[function(require,module,exports){
var getNative = require('./_getNative');

/* Built-in method references that are verified to be native. */
var nativeCreate = getNative(Object, 'create');

module.exports = nativeCreate;

},{"./_getNative":39}],65:[function(require,module,exports){
/**
 * This function is like
 * [`Object.keys`](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)
 * except that it includes inherited enumerable properties.
 *
 * @private
 * @param {Object} object The object to query.
 * @returns {Array} Returns the array of property names.
 */
function nativeKeysIn(object) {
  var result = [];
  if (object != null) {
    for (var key in Object(object)) {
      result.push(key);
    }
  }
  return result;
}

module.exports = nativeKeysIn;

},{}],66:[function(require,module,exports){
var freeGlobal = require('./_freeGlobal');

/** Detect free variable `exports`. */
var freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;

/** Detect free variable `module`. */
var freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;

/** Detect the popular CommonJS extension `module.exports`. */
var moduleExports = freeModule && freeModule.exports === freeExports;

/** Detect free variable `process` from Node.js. */
var freeProcess = moduleExports && freeGlobal.process;

/** Used to access faster Node.js helpers. */
var nodeUtil = (function() {
  try {
    return freeProcess && freeProcess.binding && freeProcess.binding('util');
  } catch (e) {}
}());

module.exports = nodeUtil;

},{"./_freeGlobal":37}],67:[function(require,module,exports){
/** Used for built-in method references. */
var objectProto = Object.prototype;

/**
 * Used to resolve the
 * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)
 * of values.
 */
var nativeObjectToString = objectProto.toString;

/**
 * Converts `value` to a string using `Object.prototype.toString`.
 *
 * @private
 * @param {*} value The value to convert.
 * @returns {string} Returns the converted string.
 */
function objectToString(value) {
  return nativeObjectToString.call(value);
}

module.exports = objectToString;

},{}],68:[function(require,module,exports){
/**
 * Creates a unary function that invokes `func` with its argument transformed.
 *
 * @private
 * @param {Function} func The function to wrap.
 * @param {Function} transform The argument transform.
 * @returns {Function} Returns the new function.
 */
function overArg(func, transform) {
  return function(arg) {
    return func(transform(arg));
  };
}

module.exports = overArg;

},{}],69:[function(require,module,exports){
var apply = require('./_apply');

/* Built-in method references for those with the same name as other `lodash` methods. */
var nativeMax = Math.max;

/**
 * A specialized version of `baseRest` which transforms the rest array.
 *
 * @private
 * @param {Function} func The function to apply a rest parameter to.
 * @param {number} [start=func.length-1] The start position of the rest parameter.
 * @param {Function} transform The rest array transform.
 * @returns {Function} Returns the new function.
 */
function overRest(func, start, transform) {
  start = nativeMax(start === undefined ? (func.length - 1) : start, 0);
  return function() {
    var args = arguments,
        index = -1,
        length = nativeMax(args.length - start, 0),
        array = Array(length);

    while (++index < length) {
      array[index] = args[start + index];
    }
    index = -1;
    var otherArgs = Array(start + 1);
    while (++index < start) {
      otherArgs[index] = args[index];
    }
    otherArgs[start] = transform(array);
    return apply(func, this, otherArgs);
  };
}

module.exports = overRest;

},{"./_apply":9}],70:[function(require,module,exports){
var freeGlobal = require('./_freeGlobal');

/** Detect free variable `self`. */
var freeSelf = typeof self == 'object' && self && self.Object === Object && self;

/** Used as a reference to the global object. */
var root = freeGlobal || freeSelf || Function('return this')();

module.exports = root;

},{"./_freeGlobal":37}],71:[function(require,module,exports){
/**
 * Gets the value at `key`, unless `key` is "__proto__".
 *
 * @private
 * @param {Object} object The object to query.
 * @param {string} key The key of the property to get.
 * @returns {*} Returns the property value.
 */
function safeGet(object, key) {
  return key == '__proto__'
    ? undefined
    : object[key];
}

module.exports = safeGet;

},{}],72:[function(require,module,exports){
var baseSetToString = require('./_baseSetToString'),
    shortOut = require('./_shortOut');

/**
 * Sets the `toString` method of `func` to return `string`.
 *
 * @private
 * @param {Function} func The function to modify.
 * @param {Function} string The `toString` result.
 * @returns {Function} Returns `func`.
 */
var setToString = shortOut(baseSetToString);

module.exports = setToString;

},{"./_baseSetToString":25,"./_shortOut":73}],73:[function(require,module,exports){
/** Used to detect hot functions by number of calls within a span of milliseconds. */
var HOT_COUNT = 800,
    HOT_SPAN = 16;

/* Built-in method references for those with the same name as other `lodash` methods. */
var nativeNow = Date.now;

/**
 * Creates a function that'll short out and invoke `identity` instead
 * of `func` when it's called `HOT_COUNT` or more times in `HOT_SPAN`
 * milliseconds.
 *
 * @private
 * @param {Function} func The function to restrict.
 * @returns {Function} Returns the new shortable function.
 */
function shortOut(func) {
  var count = 0,
      lastCalled = 0;

  return function() {
    var stamp = nativeNow(),
        remaining = HOT_SPAN - (stamp - lastCalled);

    lastCalled = stamp;
    if (remaining > 0) {
      if (++count >= HOT_COUNT) {
        return arguments[0];
      }
    } else {
      count = 0;
    }
    return func.apply(undefined, arguments);
  };
}

module.exports = shortOut;

},{}],74:[function(require,module,exports){
var ListCache = require('./_ListCache');

/**
 * Removes all key-value entries from the stack.
 *
 * @private
 * @name clear
 * @memberOf Stack
 */
function stackClear() {
  this.__data__ = new ListCache;
  this.size = 0;
}

module.exports = stackClear;

},{"./_ListCache":3}],75:[function(require,module,exports){
/**
 * Removes `key` and its value from the stack.
 *
 * @private
 * @name delete
 * @memberOf Stack
 * @param {string} key The key of the value to remove.
 * @returns {boolean} Returns `true` if the entry was removed, else `false`.
 */
function stackDelete(key) {
  var data = this.__data__,
      result = data['delete'](key);

  this.size = data.size;
  return result;
}

module.exports = stackDelete;

},{}],76:[function(require,module,exports){
/**
 * Gets the stack value for `key`.
 *
 * @private
 * @name get
 * @memberOf Stack
 * @param {string} key The key of the value to get.
 * @returns {*} Returns the entry value.
 */
function stackGet(key) {
  return this.__data__.get(key);
}

module.exports = stackGet;

},{}],77:[function(require,module,exports){
/**
 * Checks if a stack value for `key` exists.
 *
 * @private
 * @name has
 * @memberOf Stack
 * @param {string} key The key of the entry to check.
 * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.
 */
function stackHas(key) {
  return this.__data__.has(key);
}

module.exports = stackHas;

},{}],78:[function(require,module,exports){
var ListCache = require('./_ListCache'),
    Map = require('./_Map'),
    MapCache = require('./_MapCache');

/** Used as the size to enable large array optimizations. */
var LARGE_ARRAY_SIZE = 200;

/**
 * Sets the stack `key` to `value`.
 *
 * @private
 * @name set
 * @memberOf Stack
 * @param {string} key The key of the value to set.
 * @param {*} value The value to set.
 * @returns {Object} Returns the stack cache instance.
 */
function stackSet(key, value) {
  var data = this.__data__;
  if (data instanceof ListCache) {
    var pairs = data.__data__;
    if (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {
      pairs.push([key, value]);
      this.size = ++data.size;
      return this;
    }
    data = this.__data__ = new MapCache(pairs);
  }
  data.set(key, value);
  this.size = data.size;
  return this;
}

module.exports = stackSet;

},{"./_ListCache":3,"./_Map":4,"./_MapCache":5}],79:[function(require,module,exports){
/** Used for built-in method references. */
var funcProto = Function.prototype;

/** Used to resolve the decompiled source of functions. */
var funcToString = funcProto.toString;

/**
 * Converts `func` to its source code.
 *
 * @private
 * @param {Function} func The function to convert.
 * @returns {string} Returns the source code.
 */
function toSource(func) {
  if (func != null) {
    try {
      return funcToString.call(func);
    } catch (e) {}
    try {
      return (func + '');
    } catch (e) {}
  }
  return '';
}

module.exports = toSource;

},{}],80:[function(require,module,exports){
/**
 * Creates a function that returns `value`.
 *
 * @static
 * @memberOf _
 * @since 2.4.0
 * @category Util
 * @param {*} value The value to return from the new function.
 * @returns {Function} Returns the new constant function.
 * @example
 *
 * var objects = _.times(2, _.constant({ 'a': 1 }));
 *
 * console.log(objects);
 * // => [{ 'a': 1 }, { 'a': 1 }]
 *
 * console.log(objects[0] === objects[1]);
 * // => true
 */
function constant(value) {
  return function() {
    return value;
  };
}

module.exports = constant;

},{}],81:[function(require,module,exports){
/**
 * Performs a
 * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)
 * comparison between two values to determine if they are equivalent.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to compare.
 * @param {*} other The other value to compare.
 * @returns {boolean} Returns `true` if the values are equivalent, else `false`.
 * @example
 *
 * var object = { 'a': 1 };
 * var other = { 'a': 1 };
 *
 * _.eq(object, object);
 * // => true
 *
 * _.eq(object, other);
 * // => false
 *
 * _.eq('a', 'a');
 * // => true
 *
 * _.eq('a', Object('a'));
 * // => false
 *
 * _.eq(NaN, NaN);
 * // => true
 */
function eq(value, other) {
  return value === other || (value !== value && other !== other);
}

module.exports = eq;

},{}],82:[function(require,module,exports){
/**
 * This method returns the first argument it receives.
 *
 * @static
 * @since 0.1.0
 * @memberOf _
 * @category Util
 * @param {*} value Any value.
 * @returns {*} Returns `value`.
 * @example
 *
 * var object = { 'a': 1 };
 *
 * console.log(_.identity(object) === object);
 * // => true
 */
function identity(value) {
  return value;
}

module.exports = identity;

},{}],83:[function(require,module,exports){
var baseIsArguments = require('./_baseIsArguments'),
    isObjectLike = require('./isObjectLike');

/** Used for built-in method references. */
var objectProto = Object.prototype;

/** Used to check objects for own properties. */
var hasOwnProperty = objectProto.hasOwnProperty;

/** Built-in value references. */
var propertyIsEnumerable = objectProto.propertyIsEnumerable;

/**
 * Checks if `value` is likely an `arguments` object.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an `arguments` object,
 *  else `false`.
 * @example
 *
 * _.isArguments(function() { return arguments; }());
 * // => true
 *
 * _.isArguments([1, 2, 3]);
 * // => false
 */
var isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {
  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&
    !propertyIsEnumerable.call(value, 'callee');
};

module.exports = isArguments;

},{"./_baseIsArguments":18,"./isObjectLike":91}],84:[function(require,module,exports){
/**
 * Checks if `value` is classified as an `Array` object.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an array, else `false`.
 * @example
 *
 * _.isArray([1, 2, 3]);
 * // => true
 *
 * _.isArray(document.body.children);
 * // => false
 *
 * _.isArray('abc');
 * // => false
 *
 * _.isArray(_.noop);
 * // => false
 */
var isArray = Array.isArray;

module.exports = isArray;

},{}],85:[function(require,module,exports){
var isFunction = require('./isFunction'),
    isLength = require('./isLength');

/**
 * Checks if `value` is array-like. A value is considered array-like if it's
 * not a function and has a `value.length` that's an integer greater than or
 * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is array-like, else `false`.
 * @example
 *
 * _.isArrayLike([1, 2, 3]);
 * // => true
 *
 * _.isArrayLike(document.body.children);
 * // => true
 *
 * _.isArrayLike('abc');
 * // => true
 *
 * _.isArrayLike(_.noop);
 * // => false
 */
function isArrayLike(value) {
  return value != null && isLength(value.length) && !isFunction(value);
}

module.exports = isArrayLike;

},{"./isFunction":88,"./isLength":89}],86:[function(require,module,exports){
var isArrayLike = require('./isArrayLike'),
    isObjectLike = require('./isObjectLike');

/**
 * This method is like `_.isArrayLike` except that it also checks if `value`
 * is an object.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an array-like object,
 *  else `false`.
 * @example
 *
 * _.isArrayLikeObject([1, 2, 3]);
 * // => true
 *
 * _.isArrayLikeObject(document.body.children);
 * // => true
 *
 * _.isArrayLikeObject('abc');
 * // => false
 *
 * _.isArrayLikeObject(_.noop);
 * // => false
 */
function isArrayLikeObject(value) {
  return isObjectLike(value) && isArrayLike(value);
}

module.exports = isArrayLikeObject;

},{"./isArrayLike":85,"./isObjectLike":91}],87:[function(require,module,exports){
var root = require('./_root'),
    stubFalse = require('./stubFalse');

/** Detect free variable `exports`. */
var freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;

/** Detect free variable `module`. */
var freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;

/** Detect the popular CommonJS extension `module.exports`. */
var moduleExports = freeModule && freeModule.exports === freeExports;

/** Built-in value references. */
var Buffer = moduleExports ? root.Buffer : undefined;

/* Built-in method references for those with the same name as other `lodash` methods. */
var nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined;

/**
 * Checks if `value` is a buffer.
 *
 * @static
 * @memberOf _
 * @since 4.3.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.
 * @example
 *
 * _.isBuffer(new Buffer(2));
 * // => true
 *
 * _.isBuffer(new Uint8Array(2));
 * // => false
 */
var isBuffer = nativeIsBuffer || stubFalse;

module.exports = isBuffer;

},{"./_root":70,"./stubFalse":96}],88:[function(require,module,exports){
var baseGetTag = require('./_baseGetTag'),
    isObject = require('./isObject');

/** `Object#toString` result references. */
var asyncTag = '[object AsyncFunction]',
    funcTag = '[object Function]',
    genTag = '[object GeneratorFunction]',
    proxyTag = '[object Proxy]';

/**
 * Checks if `value` is classified as a `Function` object.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a function, else `false`.
 * @example
 *
 * _.isFunction(_);
 * // => true
 *
 * _.isFunction(/abc/);
 * // => false
 */
function isFunction(value) {
  if (!isObject(value)) {
    return false;
  }
  // The use of `Object#toString` avoids issues with the `typeof` operator
  // in Safari 9 which returns 'object' for typed arrays and other constructors.
  var tag = baseGetTag(value);
  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;
}

module.exports = isFunction;

},{"./_baseGetTag":17,"./isObject":90}],89:[function(require,module,exports){
/** Used as references for various `Number` constants. */
var MAX_SAFE_INTEGER = 9007199254740991;

/**
 * Checks if `value` is a valid array-like length.
 *
 * **Note:** This method is loosely based on
 * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.
 * @example
 *
 * _.isLength(3);
 * // => true
 *
 * _.isLength(Number.MIN_VALUE);
 * // => false
 *
 * _.isLength(Infinity);
 * // => false
 *
 * _.isLength('3');
 * // => false
 */
function isLength(value) {
  return typeof value == 'number' &&
    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;
}

module.exports = isLength;

},{}],90:[function(require,module,exports){
/**
 * Checks if `value` is the
 * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)
 * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an object, else `false`.
 * @example
 *
 * _.isObject({});
 * // => true
 *
 * _.isObject([1, 2, 3]);
 * // => true
 *
 * _.isObject(_.noop);
 * // => true
 *
 * _.isObject(null);
 * // => false
 */
function isObject(value) {
  var type = typeof value;
  return value != null && (type == 'object' || type == 'function');
}

module.exports = isObject;

},{}],91:[function(require,module,exports){
/**
 * Checks if `value` is object-like. A value is object-like if it's not `null`
 * and has a `typeof` result of "object".
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is object-like, else `false`.
 * @example
 *
 * _.isObjectLike({});
 * // => true
 *
 * _.isObjectLike([1, 2, 3]);
 * // => true
 *
 * _.isObjectLike(_.noop);
 * // => false
 *
 * _.isObjectLike(null);
 * // => false
 */
function isObjectLike(value) {
  return value != null && typeof value == 'object';
}

module.exports = isObjectLike;

},{}],92:[function(require,module,exports){
var baseGetTag = require('./_baseGetTag'),
    getPrototype = require('./_getPrototype'),
    isObjectLike = require('./isObjectLike');

/** `Object#toString` result references. */
var objectTag = '[object Object]';

/** Used for built-in method references. */
var funcProto = Function.prototype,
    objectProto = Object.prototype;

/** Used to resolve the decompiled source of functions. */
var funcToString = funcProto.toString;

/** Used to check objects for own properties. */
var hasOwnProperty = objectProto.hasOwnProperty;

/** Used to infer the `Object` constructor. */
var objectCtorString = funcToString.call(Object);

/**
 * Checks if `value` is a plain object, that is, an object created by the
 * `Object` constructor or one with a `[[Prototype]]` of `null`.
 *
 * @static
 * @memberOf _
 * @since 0.8.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a plain object, else `false`.
 * @example
 *
 * function Foo() {
 *   this.a = 1;
 * }
 *
 * _.isPlainObject(new Foo);
 * // => false
 *
 * _.isPlainObject([1, 2, 3]);
 * // => false
 *
 * _.isPlainObject({ 'x': 0, 'y': 0 });
 * // => true
 *
 * _.isPlainObject(Object.create(null));
 * // => true
 */
function isPlainObject(value) {
  if (!isObjectLike(value) || baseGetTag(value) != objectTag) {
    return false;
  }
  var proto = getPrototype(value);
  if (proto === null) {
    return true;
  }
  var Ctor = hasOwnProperty.call(proto, 'constructor') && proto.constructor;
  return typeof Ctor == 'function' && Ctor instanceof Ctor &&
    funcToString.call(Ctor) == objectCtorString;
}

module.exports = isPlainObject;

},{"./_baseGetTag":17,"./_getPrototype":40,"./isObjectLike":91}],93:[function(require,module,exports){
var baseIsTypedArray = require('./_baseIsTypedArray'),
    baseUnary = require('./_baseUnary'),
    nodeUtil = require('./_nodeUtil');

/* Node.js helper references. */
var nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;

/**
 * Checks if `value` is classified as a typed array.
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.
 * @example
 *
 * _.isTypedArray(new Uint8Array);
 * // => true
 *
 * _.isTypedArray([]);
 * // => false
 */
var isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;

module.exports = isTypedArray;

},{"./_baseIsTypedArray":20,"./_baseUnary":27,"./_nodeUtil":66}],94:[function(require,module,exports){
var arrayLikeKeys = require('./_arrayLikeKeys'),
    baseKeysIn = require('./_baseKeysIn'),
    isArrayLike = require('./isArrayLike');

/**
 * Creates an array of the own and inherited enumerable property names of `object`.
 *
 * **Note:** Non-object values are coerced to objects.
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category Object
 * @param {Object} object The object to query.
 * @returns {Array} Returns the array of property names.
 * @example
 *
 * function Foo() {
 *   this.a = 1;
 *   this.b = 2;
 * }
 *
 * Foo.prototype.c = 3;
 *
 * _.keysIn(new Foo);
 * // => ['a', 'b', 'c'] (iteration order is not guaranteed)
 */
function keysIn(object) {
  return isArrayLike(object) ? arrayLikeKeys(object, true) : baseKeysIn(object);
}

module.exports = keysIn;

},{"./_arrayLikeKeys":10,"./_baseKeysIn":21,"./isArrayLike":85}],95:[function(require,module,exports){
var baseMerge = require('./_baseMerge'),
    createAssigner = require('./_createAssigner');

/**
 * This method is like `_.assign` except that it recursively merges own and
 * inherited enumerable string keyed properties of source objects into the
 * destination object. Source properties that resolve to `undefined` are
 * skipped if a destination value exists. Array and plain object properties
 * are merged recursively. Other objects and value types are overridden by
 * assignment. Source objects are applied from left to right. Subsequent
 * sources overwrite property assignments of previous sources.
 *
 * **Note:** This method mutates `object`.
 *
 * @static
 * @memberOf _
 * @since 0.5.0
 * @category Object
 * @param {Object} object The destination object.
 * @param {...Object} [sources] The source objects.
 * @returns {Object} Returns `object`.
 * @example
 *
 * var object = {
 *   'a': [{ 'b': 2 }, { 'd': 4 }]
 * };
 *
 * var other = {
 *   'a': [{ 'c': 3 }, { 'e': 5 }]
 * };
 *
 * _.merge(object, other);
 * // => { 'a': [{ 'b': 2, 'c': 3 }, { 'd': 4, 'e': 5 }] }
 */
var merge = createAssigner(function(object, source, srcIndex) {
  baseMerge(object, source, srcIndex);
});

module.exports = merge;

},{"./_baseMerge":22,"./_createAssigner":34}],96:[function(require,module,exports){
/**
 * This method returns `false`.
 *
 * @static
 * @memberOf _
 * @since 4.13.0
 * @category Util
 * @returns {boolean} Returns `false`.
 * @example
 *
 * _.times(2, _.stubFalse);
 * // => [false, false]
 */
function stubFalse() {
  return false;
}

module.exports = stubFalse;

},{}],97:[function(require,module,exports){
var copyObject = require('./_copyObject'),
    keysIn = require('./keysIn');

/**
 * Converts `value` to a plain object flattening inherited enumerable string
 * keyed properties of `value` to own properties of the plain object.
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category Lang
 * @param {*} value The value to convert.
 * @returns {Object} Returns the converted plain object.
 * @example
 *
 * function Foo() {
 *   this.b = 2;
 * }
 *
 * Foo.prototype.c = 3;
 *
 * _.assign({ 'a': 1 }, new Foo);
 * // => { 'a': 1, 'b': 2 }
 *
 * _.assign({ 'a': 1 }, _.toPlainObject(new Foo));
 * // => { 'a': 1, 'b': 2, 'c': 3 }
 */
function toPlainObject(value) {
  return copyObject(value, keysIn(value));
}

module.exports = toPlainObject;

},{"./_copyObject":32,"./keysIn":94}],98:[function(require,module,exports){
;var MXI_DEBUG = true;
/**
 * mOxie - multi-runtime File API & XMLHttpRequest L2 Polyfill
 * v1.5.7
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 *
 * Date: 2017-11-03
 */
;(function (global, factory) {
	var extract = function() {
		var ctx = {};
		factory.apply(ctx, arguments);
		return ctx.moxie;
	};
	
	if (typeof define === "function" && define.amd) {
		define("moxie", [], extract);
	} else if (typeof module === "object" && module.exports) {
		module.exports = extract();
	} else {
		global.moxie = extract();
	}
}(this || window, function() {
/**
 * Compiled inline version. (Library mode)
 */

/*jshint smarttabs:true, undef:true, latedef:true, curly:true, bitwise:true, camelcase:true */
/*globals $code */

(function(exports, undefined) {
	"use strict";

	var modules = {};

	function require(ids, callback) {
		var module, defs = [];

		for (var i = 0; i < ids.length; ++i) {
			module = modules[ids[i]] || resolve(ids[i]);
			if (!module) {
				throw 'module definition dependecy not found: ' + ids[i];
			}

			defs.push(module);
		}

		callback.apply(null, defs);
	}

	function define(id, dependencies, definition) {
		if (typeof id !== 'string') {
			throw 'invalid module definition, module id must be defined and be a string';
		}

		if (dependencies === undefined) {
			throw 'invalid module definition, dependencies must be specified';
		}

		if (definition === undefined) {
			throw 'invalid module definition, definition function must be specified';
		}

		require(dependencies, function() {
			modules[id] = definition.apply(null, arguments);
		});
	}

	function defined(id) {
		return !!modules[id];
	}

	function resolve(id) {
		var target = exports;
		var fragments = id.split(/[.\/]/);

		for (var fi = 0; fi < fragments.length; ++fi) {
			if (!target[fragments[fi]]) {
				return;
			}

			target = target[fragments[fi]];
		}

		return target;
	}

	function expose(ids) {
		for (var i = 0; i < ids.length; i++) {
			var target = exports;
			var id = ids[i];
			var fragments = id.split(/[.\/]/);

			for (var fi = 0; fi < fragments.length - 1; ++fi) {
				if (target[fragments[fi]] === undefined) {
					target[fragments[fi]] = {};
				}

				target = target[fragments[fi]];
			}

			target[fragments[fragments.length - 1]] = modules[id];
		}
	}

// Included from: src/javascript/core/utils/Basic.js

/**
 * Basic.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/**
@class moxie/core/utils/Basic
@public
@static
*/

define('moxie/core/utils/Basic', [], function() {
	/**
	Gets the true type of the built-in object (better version of typeof).
	@author Angus Croll (http://javascriptweblog.wordpress.com/)

	@method typeOf
	@static
	@param {Object} o Object to check.
	@return {String} Object [[Class]]
	*/
	function typeOf(o) {
		var undef;

		if (o === undef) {
			return 'undefined';
		} else if (o === null) {
			return 'null';
		} else if (o.nodeType) {
			return 'node';
		}

		// the snippet below is awesome, however it fails to detect null, undefined and arguments types in IE lte 8
		return ({}).toString.call(o).match(/\s([a-z|A-Z]+)/)[1].toLowerCase();
	}

	/**
	Extends the specified object with another object(s).

	@method extend
	@static
	@param {Object} target Object to extend.
	@param {Object} [obj]* Multiple objects to extend with.
	@return {Object} Same as target, the extended object.
	*/
	function extend() {
		return merge(false, false, arguments);
	}


	/**
	Extends the specified object with another object(s), but only if the property exists in the target.

	@method extendIf
	@static
	@param {Object} target Object to extend.
	@param {Object} [obj]* Multiple objects to extend with.
	@return {Object} Same as target, the extended object.
	*/
	function extendIf() {
		return merge(true, false, arguments);
	}


	function extendImmutable() {
		return merge(false, true, arguments);
	}


	function extendImmutableIf() {
		return merge(true, true, arguments);
	}


	function clone(value) {
		switch (typeOf(value)) {
			case 'array':
				return merge(false, true, [[], value]);

			case 'object':
				return merge(false, true, [{}, value]);

			default:
				return value;
		}
	}


	function shallowCopy(obj) {
		switch (typeOf(obj)) {
			case 'array':
				return Array.prototype.slice.call(obj);

			case 'object':
				return extend({}, obj);
		}
		return obj;
	}


	function merge(strict, immutable, args) {
		var undef;
		var target = args[0];

		each(args, function(arg, i) {
			if (i > 0) {
				each(arg, function(value, key) {
					var isComplex = inArray(typeOf(value), ['array', 'object']) !== -1;

					if (value === undef || strict && target[key] === undef) {
						return true;
					}

					if (isComplex && immutable) {
						value = shallowCopy(value);
					}

					if (typeOf(target[key]) === typeOf(value) && isComplex) {
						merge(strict, immutable, [target[key], value]);
					} else {
						target[key] = value;
					}
				});
			}
		});

		return target;
	}


	/**
	A way to inherit one `class` from another in a consisstent way (more or less)

	@method inherit
	@static
	@since >1.4.1
	@param {Function} child
	@param {Function} parent
	@return {Function} Prepared constructor
	*/
	function inherit(child, parent) {
		// copy over all parent properties
		for (var key in parent) {
			if ({}.hasOwnProperty.call(parent, key)) {
				child[key] = parent[key];
			}
		}

		// give child `class` a place to define its own methods
		function ctor() {
			this.constructor = child;

			if (MXI_DEBUG) {
				var getCtorName = function(fn) {
					var m = fn.toString().match(/^function\s([^\(\s]+)/);
					return m ? m[1] : false;
				};

				this.ctorName = getCtorName(child);
			}
		}
		ctor.prototype = parent.prototype;
		child.prototype = new ctor();

		// keep a way to reference parent methods
		child.parent = parent.prototype;
		return child;
	}


	/**
	Executes the callback function for each item in array/object. If you return false in the
	callback it will break the loop.

	@method each
	@static
	@param {Object} obj Object to iterate.
	@param {function} callback Callback function to execute for each item.
	*/
	function each(obj, callback) {
		var length, key, i, undef;

		if (obj) {
			try {
				length = obj.length;
			} catch(ex) {
				length = undef;
			}

			if (length === undef || typeof(length) !== 'number') {
				// Loop object items
				for (key in obj) {
					if (obj.hasOwnProperty(key)) {
						if (callback(obj[key], key) === false) {
							return;
						}
					}
				}
			} else {
				// Loop array items
				for (i = 0; i < length; i++) {
					if (callback(obj[i], i) === false) {
						return;
					}
				}
			}
		}
	}

	/**
	Checks if object is empty.

	@method isEmptyObj
	@static
	@param {Object} o Object to check.
	@return {Boolean}
	*/
	function isEmptyObj(obj) {
		var prop;

		if (!obj || typeOf(obj) !== 'object') {
			return true;
		}

		for (prop in obj) {
			return false;
		}

		return true;
	}

	/**
	Recieve an array of functions (usually async) to call in sequence, each  function
	receives a callback as first argument that it should call, when it completes. Finally,
	after everything is complete, main callback is called. Passing truthy value to the
	callback as a first argument will interrupt the sequence and invoke main callback
	immediately.

	@method inSeries
	@static
	@param {Array} queue Array of functions to call in sequence
	@param {Function} cb Main callback that is called in the end, or in case of error
	*/
	function inSeries(queue, cb) {
		var i = 0, length = queue.length;

		if (typeOf(cb) !== 'function') {
			cb = function() {};
		}

		if (!queue || !queue.length) {
			cb();
		}

		function callNext(i) {
			if (typeOf(queue[i]) === 'function') {
				queue[i](function(error) {
					/*jshint expr:true */
					++i < length && !error ? callNext(i) : cb(error);
				});
			}
		}
		callNext(i);
	}


	/**
	Recieve an array of functions (usually async) to call in parallel, each  function
	receives a callback as first argument that it should call, when it completes. After
	everything is complete, main callback is called. Passing truthy value to the
	callback as a first argument will interrupt the process and invoke main callback
	immediately.

	@method inParallel
	@static
	@param {Array} queue Array of functions to call in sequence
	@param {Function} cb Main callback that is called in the end, or in case of erro
	*/
	function inParallel(queue, cb) {
		var count = 0, num = queue.length, cbArgs = new Array(num);

		each(queue, function(fn, i) {
			fn(function(error) {
				if (error) {
					return cb(error);
				}

				var args = [].slice.call(arguments);
				args.shift(); // strip error - undefined or not

				cbArgs[i] = args;
				count++;

				if (count === num) {
					cbArgs.unshift(null);
					cb.apply(this, cbArgs);
				}
			});
		});
	}


	/**
	Find an element in array and return it's index if present, otherwise return -1.

	@method inArray
	@static
	@param {Mixed} needle Element to find
	@param {Array} array
	@return {Int} Index of the element, or -1 if not found
	*/
	function inArray(needle, array) {
		if (array) {
			if (Array.prototype.indexOf) {
				return Array.prototype.indexOf.call(array, needle);
			}

			for (var i = 0, length = array.length; i < length; i++) {
				if (array[i] === needle) {
					return i;
				}
			}
		}
		return -1;
	}


	/**
	Returns elements of first array if they are not present in second. And false - otherwise.

	@private
	@method arrayDiff
	@param {Array} needles
	@param {Array} array
	@return {Array|Boolean}
	*/
	function arrayDiff(needles, array) {
		var diff = [];

		if (typeOf(needles) !== 'array') {
			needles = [needles];
		}

		if (typeOf(array) !== 'array') {
			array = [array];
		}

		for (var i in needles) {
			if (inArray(needles[i], array) === -1) {
				diff.push(needles[i]);
			}
		}
		return diff.length ? diff : false;
	}


	/**
	Find intersection of two arrays.

	@private
	@method arrayIntersect
	@param {Array} array1
	@param {Array} array2
	@return {Array} Intersection of two arrays or null if there is none
	*/
	function arrayIntersect(array1, array2) {
		var result = [];
		each(array1, function(item) {
			if (inArray(item, array2) !== -1) {
				result.push(item);
			}
		});
		return result.length ? result : null;
	}


	/**
	Forces anything into an array.

	@method toArray
	@static
	@param {Object} obj Object with length field.
	@return {Array} Array object containing all items.
	*/
	function toArray(obj) {
		var i, arr = [];

		for (i = 0; i < obj.length; i++) {
			arr[i] = obj[i];
		}

		return arr;
	}


	/**
	Generates an unique ID. The only way a user would be able to get the same ID is if the two persons
	at the same exact millisecond manage to get the same 5 random numbers between 0-65535; it also uses
	a counter so each ID is guaranteed to be unique for the given page. It is more probable for the earth
	to be hit with an asteroid.

	@method guid
	@static
	@param {String} prefix to prepend (by default 'o' will be prepended).
	@method guid
	@return {String} Virtually unique id.
	*/
	var guid = (function() {
		var counter = 0;

		return function(prefix) {
			var guid = new Date().getTime().toString(32), i;

			for (i = 0; i < 5; i++) {
				guid += Math.floor(Math.random() * 65535).toString(32);
			}

			return (prefix || 'o_') + guid + (counter++).toString(32);
		};
	}());


	/**
	Trims white spaces around the string

	@method trim
	@static
	@param {String} str
	@return {String}
	*/
	function trim(str) {
		if (!str) {
			return str;
		}
		return String.prototype.trim ? String.prototype.trim.call(str) : str.toString().replace(/^\s*/, '').replace(/\s*$/, '');
	}


	/**
	Parses the specified size string into a byte value. For example 10kb becomes 10240.

	@method parseSizeStr
	@static
	@param {String/Number} size String to parse or number to just pass through.
	@return {Number} Size in bytes.
	*/
	function parseSizeStr(size) {
		if (typeof(size) !== 'string') {
			return size;
		}

		var muls = {
				t: 1099511627776,
				g: 1073741824,
				m: 1048576,
				k: 1024
			},
			mul;

		size = /^([0-9\.]+)([tmgk]?)$/.exec(size.toLowerCase().replace(/[^0-9\.tmkg]/g, ''));
		mul = size[2];
		size = +size[1];

		if (muls.hasOwnProperty(mul)) {
			size *= muls[mul];
		}
		return Math.floor(size);
	}


	/**
	 * Pseudo sprintf implementation - simple way to replace tokens with specified values.
	 *
	 * @param {String} str String with tokens
	 * @return {String} String with replaced tokens
	 */
	function sprintf(str) {
		var args = [].slice.call(arguments, 1);

		return str.replace(/%([a-z])/g, function($0, $1) {
			var value = args.shift();

			switch ($1) {
				case 's':
					return value + '';

				case 'd':
					return parseInt(value, 10);

				case 'f':
					return parseFloat(value);

				case 'c':
					return '';

				default:
					return value;
			}
		});
	}



	function delay(cb, timeout) {
		var self = this;
		setTimeout(function() {
			cb.call(self);
		}, timeout || 1);
	}


	return {
		guid: guid,
		typeOf: typeOf,
		extend: extend,
		extendIf: extendIf,
		extendImmutable: extendImmutable,
		extendImmutableIf: extendImmutableIf,
		clone: clone,
		inherit: inherit,
		each: each,
		isEmptyObj: isEmptyObj,
		inSeries: inSeries,
		inParallel: inParallel,
		inArray: inArray,
		arrayDiff: arrayDiff,
		arrayIntersect: arrayIntersect,
		toArray: toArray,
		trim: trim,
		sprintf: sprintf,
		parseSizeStr: parseSizeStr,
		delay: delay
	};
});

// Included from: src/javascript/core/utils/Encode.js

/**
 * Encode.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/**
@class moxie/core/utils/Encode
@public
@static
*/

define('moxie/core/utils/Encode', [], function() {

	/**
	Encode string with UTF-8

	@method utf8_encode
	@static
	@param {String} str String to encode
	@return {String} UTF-8 encoded string
	*/
	var utf8_encode = function(str) {
		return unescape(encodeURIComponent(str));
	};
	
	/**
	Decode UTF-8 encoded string

	@method utf8_decode
	@static
	@param {String} str String to decode
	@return {String} Decoded string
	*/
	var utf8_decode = function(str_data) {
		return decodeURIComponent(escape(str_data));
	};
	
	/**
	Decode Base64 encoded string (uses browser's default method if available),
	from: https://raw.github.com/kvz/phpjs/master/functions/url/base64_decode.js

	@method atob
	@static
	@param {String} data String to decode
	@return {String} Decoded string
	*/
	var atob = function(data, utf8) {
		if (typeof(window.atob) === 'function') {
			return utf8 ? utf8_decode(window.atob(data)) : window.atob(data);
		}

		// http://kevin.vanzonneveld.net
		// +   original by: Tyler Akins (http://rumkin.com)
		// +   improved by: Thunder.m
		// +      input by: Aman Gupta
		// +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
		// +   bugfixed by: Onno Marsman
		// +   bugfixed by: Pellentesque Malesuada
		// +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
		// +      input by: Brett Zamir (http://brett-zamir.me)
		// +   bugfixed by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
		// *     example 1: base64_decode('S2V2aW4gdmFuIFpvbm5ldmVsZA==');
		// *     returns 1: 'Kevin van Zonneveld'
		// mozilla has this native
		// - but breaks in 2.0.0.12!
		//if (typeof this.window.atob == 'function') {
		//    return atob(data);
		//}
		var b64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
		var o1, o2, o3, h1, h2, h3, h4, bits, i = 0,
			ac = 0,
			dec = "",
			tmp_arr = [];

		if (!data) {
			return data;
		}

		data += '';

		do { // unpack four hexets into three octets using index points in b64
			h1 = b64.indexOf(data.charAt(i++));
			h2 = b64.indexOf(data.charAt(i++));
			h3 = b64.indexOf(data.charAt(i++));
			h4 = b64.indexOf(data.charAt(i++));

			bits = h1 << 18 | h2 << 12 | h3 << 6 | h4;

			o1 = bits >> 16 & 0xff;
			o2 = bits >> 8 & 0xff;
			o3 = bits & 0xff;

			if (h3 == 64) {
				tmp_arr[ac++] = String.fromCharCode(o1);
			} else if (h4 == 64) {
				tmp_arr[ac++] = String.fromCharCode(o1, o2);
			} else {
				tmp_arr[ac++] = String.fromCharCode(o1, o2, o3);
			}
		} while (i < data.length);

		dec = tmp_arr.join('');

		return utf8 ? utf8_decode(dec) : dec;
	};
	
	/**
	Base64 encode string (uses browser's default method if available),
	from: https://raw.github.com/kvz/phpjs/master/functions/url/base64_encode.js

	@method btoa
	@static
	@param {String} data String to encode
	@return {String} Base64 encoded string
	*/
	var btoa = function(data, utf8) {
		if (utf8) {
			data = utf8_encode(data);
		}

		if (typeof(window.btoa) === 'function') {
			return window.btoa(data);
		}

		// http://kevin.vanzonneveld.net
		// +   original by: Tyler Akins (http://rumkin.com)
		// +   improved by: Bayron Guevara
		// +   improved by: Thunder.m
		// +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
		// +   bugfixed by: Pellentesque Malesuada
		// +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
		// +   improved by: Rafał Kukawski (http://kukawski.pl)
		// *     example 1: base64_encode('Kevin van Zonneveld');
		// *     returns 1: 'S2V2aW4gdmFuIFpvbm5ldmVsZA=='
		// mozilla has this native
		// - but breaks in 2.0.0.12!
		var b64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
		var o1, o2, o3, h1, h2, h3, h4, bits, i = 0,
			ac = 0,
			enc = "",
			tmp_arr = [];

		if (!data) {
			return data;
		}

		do { // pack three octets into four hexets
			o1 = data.charCodeAt(i++);
			o2 = data.charCodeAt(i++);
			o3 = data.charCodeAt(i++);

			bits = o1 << 16 | o2 << 8 | o3;

			h1 = bits >> 18 & 0x3f;
			h2 = bits >> 12 & 0x3f;
			h3 = bits >> 6 & 0x3f;
			h4 = bits & 0x3f;

			// use hexets to index into b64, and append result to encoded string
			tmp_arr[ac++] = b64.charAt(h1) + b64.charAt(h2) + b64.charAt(h3) + b64.charAt(h4);
		} while (i < data.length);

		enc = tmp_arr.join('');

		var r = data.length % 3;

		return (r ? enc.slice(0, r - 3) : enc) + '==='.slice(r || 3);
	};


	return {
		utf8_encode: utf8_encode,
		utf8_decode: utf8_decode,
		atob: atob,
		btoa: btoa
	};
});

// Included from: src/javascript/core/utils/Env.js

/**
 * Env.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/**
@class moxie/core/utils/Env
@public
@static
*/

define("moxie/core/utils/Env", [
	"moxie/core/utils/Basic"
], function(Basic) {

	/**
	 * UAParser.js v0.7.7
	 * Lightweight JavaScript-based User-Agent string parser
	 * https://github.com/faisalman/ua-parser-js
	 *
	 * Copyright © 2012-2015 Faisal Salman <fyzlman@gmail.com>
	 * Dual licensed under GPLv2 & MIT
	 */
	var UAParser = (function (undefined) {

	    //////////////
	    // Constants
	    /////////////


	    var EMPTY       = '',
	        UNKNOWN     = '?',
	        FUNC_TYPE   = 'function',
	        UNDEF_TYPE  = 'undefined',
	        OBJ_TYPE    = 'object',
	        MAJOR       = 'major',
	        MODEL       = 'model',
	        NAME        = 'name',
	        TYPE        = 'type',
	        VENDOR      = 'vendor',
	        VERSION     = 'version',
	        ARCHITECTURE= 'architecture',
	        CONSOLE     = 'console',
	        MOBILE      = 'mobile',
	        TABLET      = 'tablet';


	    ///////////
	    // Helper
	    //////////


	    var util = {
	        has : function (str1, str2) {
	            return str2.toLowerCase().indexOf(str1.toLowerCase()) !== -1;
	        },
	        lowerize : function (str) {
	            return str.toLowerCase();
	        }
	    };


	    ///////////////
	    // Map helper
	    //////////////


	    var mapper = {

	        rgx : function () {

	            // loop through all regexes maps
	            for (var result, i = 0, j, k, p, q, matches, match, args = arguments; i < args.length; i += 2) {

	                var regex = args[i],       // even sequence (0,2,4,..)
	                    props = args[i + 1];   // odd sequence (1,3,5,..)

	                // construct object barebones
	                if (typeof(result) === UNDEF_TYPE) {
	                    result = {};
	                    for (p in props) {
	                        q = props[p];
	                        if (typeof(q) === OBJ_TYPE) {
	                            result[q[0]] = undefined;
	                        } else {
	                            result[q] = undefined;
	                        }
	                    }
	                }

	                // try matching uastring with regexes
	                for (j = k = 0; j < regex.length; j++) {
	                    matches = regex[j].exec(this.getUA());
	                    if (!!matches) {
	                        for (p = 0; p < props.length; p++) {
	                            match = matches[++k];
	                            q = props[p];
	                            // check if given property is actually array
	                            if (typeof(q) === OBJ_TYPE && q.length > 0) {
	                                if (q.length == 2) {
	                                    if (typeof(q[1]) == FUNC_TYPE) {
	                                        // assign modified match
	                                        result[q[0]] = q[1].call(this, match);
	                                    } else {
	                                        // assign given value, ignore regex match
	                                        result[q[0]] = q[1];
	                                    }
	                                } else if (q.length == 3) {
	                                    // check whether function or regex
	                                    if (typeof(q[1]) === FUNC_TYPE && !(q[1].exec && q[1].test)) {
	                                        // call function (usually string mapper)
	                                        result[q[0]] = match ? q[1].call(this, match, q[2]) : undefined;
	                                    } else {
	                                        // sanitize match using given regex
	                                        result[q[0]] = match ? match.replace(q[1], q[2]) : undefined;
	                                    }
	                                } else if (q.length == 4) {
	                                        result[q[0]] = match ? q[3].call(this, match.replace(q[1], q[2])) : undefined;
	                                }
	                            } else {
	                                result[q] = match ? match : undefined;
	                            }
	                        }
	                        break;
	                    }
	                }

	                if(!!matches) break; // break the loop immediately if match found
	            }
	            return result;
	        },

	        str : function (str, map) {

	            for (var i in map) {
	                // check if array
	                if (typeof(map[i]) === OBJ_TYPE && map[i].length > 0) {
	                    for (var j = 0; j < map[i].length; j++) {
	                        if (util.has(map[i][j], str)) {
	                            return (i === UNKNOWN) ? undefined : i;
	                        }
	                    }
	                } else if (util.has(map[i], str)) {
	                    return (i === UNKNOWN) ? undefined : i;
	                }
	            }
	            return str;
	        }
	    };


	    ///////////////
	    // String map
	    //////////////


	    var maps = {

	        browser : {
	            oldsafari : {
	                major : {
	                    '1' : ['/8', '/1', '/3'],
	                    '2' : '/4',
	                    '?' : '/'
	                },
	                version : {
	                    '1.0'   : '/8',
	                    '1.2'   : '/1',
	                    '1.3'   : '/3',
	                    '2.0'   : '/412',
	                    '2.0.2' : '/416',
	                    '2.0.3' : '/417',
	                    '2.0.4' : '/419',
	                    '?'     : '/'
	                }
	            }
	        },

	        device : {
	            sprint : {
	                model : {
	                    'Evo Shift 4G' : '7373KT'
	                },
	                vendor : {
	                    'HTC'       : 'APA',
	                    'Sprint'    : 'Sprint'
	                }
	            }
	        },

	        os : {
	            windows : {
	                version : {
	                    'ME'        : '4.90',
	                    'NT 3.11'   : 'NT3.51',
	                    'NT 4.0'    : 'NT4.0',
	                    '2000'      : 'NT 5.0',
	                    'XP'        : ['NT 5.1', 'NT 5.2'],
	                    'Vista'     : 'NT 6.0',
	                    '7'         : 'NT 6.1',
	                    '8'         : 'NT 6.2',
	                    '8.1'       : 'NT 6.3',
	                    'RT'        : 'ARM'
	                }
	            }
	        }
	    };


	    //////////////
	    // Regex map
	    /////////////


	    var regexes = {

	        browser : [[

	            // Presto based
	            /(opera\smini)\/([\w\.-]+)/i,                                       // Opera Mini
	            /(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,                      // Opera Mobi/Tablet
	            /(opera).+version\/([\w\.]+)/i,                                     // Opera > 9.80
	            /(opera)[\/\s]+([\w\.]+)/i                                          // Opera < 9.80

	            ], [NAME, VERSION], [

	            /\s(opr)\/([\w\.]+)/i                                               // Opera Webkit
	            ], [[NAME, 'Opera'], VERSION], [

	            // Mixed
	            /(kindle)\/([\w\.]+)/i,                                             // Kindle
	            /(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,
	                                                                                // Lunascape/Maxthon/Netfront/Jasmine/Blazer

	            // Trident based
	            /(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,
	                                                                                // Avant/IEMobile/SlimBrowser/Baidu
	            /(?:ms|\()(ie)\s([\w\.]+)/i,                                        // Internet Explorer

	            // Webkit/KHTML based
	            /(rekonq)\/([\w\.]+)*/i,                                            // Rekonq
	            /(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi)\/([\w\.-]+)/i
	                                                                                // Chromium/Flock/RockMelt/Midori/Epiphany/Silk/Skyfire/Bolt/Iron
	            ], [NAME, VERSION], [

	            /(trident).+rv[:\s]([\w\.]+).+like\sgecko/i                         // IE11
	            ], [[NAME, 'IE'], VERSION], [

	            /(edge)\/((\d+)?[\w\.]+)/i                                          // Microsoft Edge
	            ], [NAME, VERSION], [

	            /(yabrowser)\/([\w\.]+)/i                                           // Yandex
	            ], [[NAME, 'Yandex'], VERSION], [

	            /(comodo_dragon)\/([\w\.]+)/i                                       // Comodo Dragon
	            ], [[NAME, /_/g, ' '], VERSION], [

	            /(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i,
	                                                                                // Chrome/OmniWeb/Arora/Tizen/Nokia
	            /(uc\s?browser|qqbrowser)[\/\s]?([\w\.]+)/i
	                                                                                // UCBrowser/QQBrowser
	            ], [NAME, VERSION], [

	            /(dolfin)\/([\w\.]+)/i                                              // Dolphin
	            ], [[NAME, 'Dolphin'], VERSION], [

	            /((?:android.+)crmo|crios)\/([\w\.]+)/i                             // Chrome for Android/iOS
	            ], [[NAME, 'Chrome'], VERSION], [

	            /XiaoMi\/MiuiBrowser\/([\w\.]+)/i                                   // MIUI Browser
	            ], [VERSION, [NAME, 'MIUI Browser']], [

	            /android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)/i         // Android Browser
	            ], [VERSION, [NAME, 'Android Browser']], [

	            /FBAV\/([\w\.]+);/i                                                 // Facebook App for iOS
	            ], [VERSION, [NAME, 'Facebook']], [

	            /version\/([\w\.]+).+?mobile\/\w+\s(safari)/i                       // Mobile Safari
	            ], [VERSION, [NAME, 'Mobile Safari']], [

	            /version\/([\w\.]+).+?(mobile\s?safari|safari)/i                    // Safari & Safari Mobile
	            ], [VERSION, NAME], [

	            /webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i                     // Safari < 3.0
	            ], [NAME, [VERSION, mapper.str, maps.browser.oldsafari.version]], [

	            /(konqueror)\/([\w\.]+)/i,                                          // Konqueror
	            /(webkit|khtml)\/([\w\.]+)/i
	            ], [NAME, VERSION], [

	            // Gecko based
	            /(navigator|netscape)\/([\w\.-]+)/i                                 // Netscape
	            ], [[NAME, 'Netscape'], VERSION], [
	            /(swiftfox)/i,                                                      // Swiftfox
	            /(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,
	                                                                                // IceDragon/Iceweasel/Camino/Chimera/Fennec/Maemo/Minimo/Conkeror
	            /(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,
	                                                                                // Firefox/SeaMonkey/K-Meleon/IceCat/IceApe/Firebird/Phoenix
	            /(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,                          // Mozilla

	            // Other
	            /(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf)[\/\s]?([\w\.]+)/i,
	                                                                                // Polaris/Lynx/Dillo/iCab/Doris/Amaya/w3m/NetSurf
	            /(links)\s\(([\w\.]+)/i,                                            // Links
	            /(gobrowser)\/?([\w\.]+)*/i,                                        // GoBrowser
	            /(ice\s?browser)\/v?([\w\._]+)/i,                                   // ICE Browser
	            /(mosaic)[\/\s]([\w\.]+)/i                                          // Mosaic
	            ], [NAME, VERSION]
	        ],

	        engine : [[

	            /windows.+\sedge\/([\w\.]+)/i                                       // EdgeHTML
	            ], [VERSION, [NAME, 'EdgeHTML']], [

	            /(presto)\/([\w\.]+)/i,                                             // Presto
	            /(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,     // WebKit/Trident/NetFront/NetSurf/Amaya/Lynx/w3m
	            /(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,                          // KHTML/Tasman/Links
	            /(icab)[\/\s]([23]\.[\d\.]+)/i                                      // iCab
	            ], [NAME, VERSION], [

	            /rv\:([\w\.]+).*(gecko)/i                                           // Gecko
	            ], [VERSION, NAME]
	        ],

	        os : [[

	            // Windows based
	            /microsoft\s(windows)\s(vista|xp)/i                                 // Windows (iTunes)
	            ], [NAME, VERSION], [
	            /(windows)\snt\s6\.2;\s(arm)/i,                                     // Windows RT
	            /(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i
	            ], [NAME, [VERSION, mapper.str, maps.os.windows.version]], [
	            /(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i
	            ], [[NAME, 'Windows'], [VERSION, mapper.str, maps.os.windows.version]], [

	            // Mobile/Embedded OS
	            /\((bb)(10);/i                                                      // BlackBerry 10
	            ], [[NAME, 'BlackBerry'], VERSION], [
	            /(blackberry)\w*\/?([\w\.]+)*/i,                                    // Blackberry
	            /(tizen)[\/\s]([\w\.]+)/i,                                          // Tizen
	            /(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,
	                                                                                // Android/WebOS/Palm/QNX/Bada/RIM/MeeGo/Contiki
	            /linux;.+(sailfish);/i                                              // Sailfish OS
	            ], [NAME, VERSION], [
	            /(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i                 // Symbian
	            ], [[NAME, 'Symbian'], VERSION], [
	            /\((series40);/i                                                    // Series 40
	            ], [NAME], [
	            /mozilla.+\(mobile;.+gecko.+firefox/i                               // Firefox OS
	            ], [[NAME, 'Firefox OS'], VERSION], [

	            // Console
	            /(nintendo|playstation)\s([wids3portablevu]+)/i,                    // Nintendo/Playstation

	            // GNU/Linux based
	            /(mint)[\/\s\(]?(\w+)*/i,                                           // Mint
	            /(mageia|vectorlinux)[;\s]/i,                                       // Mageia/VectorLinux
	            /(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?([\w\.-]+)*/i,
	                                                                                // Joli/Ubuntu/Debian/SUSE/Gentoo/Arch/Slackware
	                                                                                // Fedora/Mandriva/CentOS/PCLinuxOS/RedHat/Zenwalk/Linpus
	            /(hurd|linux)\s?([\w\.]+)*/i,                                       // Hurd/Linux
	            /(gnu)\s?([\w\.]+)*/i                                               // GNU
	            ], [NAME, VERSION], [

	            /(cros)\s[\w]+\s([\w\.]+\w)/i                                       // Chromium OS
	            ], [[NAME, 'Chromium OS'], VERSION],[

	            // Solaris
	            /(sunos)\s?([\w\.]+\d)*/i                                           // Solaris
	            ], [[NAME, 'Solaris'], VERSION], [

	            // BSD based
	            /\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i                   // FreeBSD/NetBSD/OpenBSD/PC-BSD/DragonFly
	            ], [NAME, VERSION],[

	            /(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i             // iOS
	            ], [[NAME, 'iOS'], [VERSION, /_/g, '.']], [

	            /(mac\sos\sx)\s?([\w\s\.]+\w)*/i,
	            /(macintosh|mac(?=_powerpc)\s)/i                                    // Mac OS
	            ], [[NAME, 'Mac OS'], [VERSION, /_/g, '.']], [

	            // Other
	            /((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,                            // Solaris
	            /(haiku)\s(\w+)/i,                                                  // Haiku
	            /(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,                               // AIX
	            /(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,
	                                                                                // Plan9/Minix/BeOS/OS2/AmigaOS/MorphOS/RISCOS/OpenVMS
	            /(unix)\s?([\w\.]+)*/i                                              // UNIX
	            ], [NAME, VERSION]
	        ]
	    };


	    /////////////////
	    // Constructor
	    ////////////////


	    var UAParser = function (uastring) {

	        var ua = uastring || ((window && window.navigator && window.navigator.userAgent) ? window.navigator.userAgent : EMPTY);

	        this.getBrowser = function () {
	            return mapper.rgx.apply(this, regexes.browser);
	        };
	        this.getEngine = function () {
	            return mapper.rgx.apply(this, regexes.engine);
	        };
	        this.getOS = function () {
	            return mapper.rgx.apply(this, regexes.os);
	        };
	        this.getResult = function() {
	            return {
	                ua      : this.getUA(),
	                browser : this.getBrowser(),
	                engine  : this.getEngine(),
	                os      : this.getOS()
	            };
	        };
	        this.getUA = function () {
	            return ua;
	        };
	        this.setUA = function (uastring) {
	            ua = uastring;
	            return this;
	        };
	        this.setUA(ua);
	    };

	    return UAParser;
	})();


	function version_compare(v1, v2, operator) {
	  // From: http://phpjs.org/functions
	  // +      original by: Philippe Jausions (http://pear.php.net/user/jausions)
	  // +      original by: Aidan Lister (http://aidanlister.com/)
	  // + reimplemented by: Kankrelune (http://www.webfaktory.info/)
	  // +      improved by: Brett Zamir (http://brett-zamir.me)
	  // +      improved by: Scott Baker
	  // +      improved by: Theriault
	  // *        example 1: version_compare('8.2.5rc', '8.2.5a');
	  // *        returns 1: 1
	  // *        example 2: version_compare('8.2.50', '8.2.52', '<');
	  // *        returns 2: true
	  // *        example 3: version_compare('5.3.0-dev', '5.3.0');
	  // *        returns 3: -1
	  // *        example 4: version_compare('4.1.0.52','4.01.0.51');
	  // *        returns 4: 1

	  // Important: compare must be initialized at 0.
	  var i = 0,
	    x = 0,
	    compare = 0,
	    // vm maps textual PHP versions to negatives so they're less than 0.
	    // PHP currently defines these as CASE-SENSITIVE. It is important to
	    // leave these as negatives so that they can come before numerical versions
	    // and as if no letters were there to begin with.
	    // (1alpha is < 1 and < 1.1 but > 1dev1)
	    // If a non-numerical value can't be mapped to this table, it receives
	    // -7 as its value.
	    vm = {
	      'dev': -6,
	      'alpha': -5,
	      'a': -5,
	      'beta': -4,
	      'b': -4,
	      'RC': -3,
	      'rc': -3,
	      '#': -2,
	      'p': 1,
	      'pl': 1
	    },
	    // This function will be called to prepare each version argument.
	    // It replaces every _, -, and + with a dot.
	    // It surrounds any nonsequence of numbers/dots with dots.
	    // It replaces sequences of dots with a single dot.
	    //    version_compare('4..0', '4.0') == 0
	    // Important: A string of 0 length needs to be converted into a value
	    // even less than an unexisting value in vm (-7), hence [-8].
	    // It's also important to not strip spaces because of this.
	    //   version_compare('', ' ') == 1
	    prepVersion = function (v) {
	      v = ('' + v).replace(/[_\-+]/g, '.');
	      v = v.replace(/([^.\d]+)/g, '.$1.').replace(/\.{2,}/g, '.');
	      return (!v.length ? [-8] : v.split('.'));
	    },
	    // This converts a version component to a number.
	    // Empty component becomes 0.
	    // Non-numerical component becomes a negative number.
	    // Numerical component becomes itself as an integer.
	    numVersion = function (v) {
	      return !v ? 0 : (isNaN(v) ? vm[v] || -7 : parseInt(v, 10));
	    };

	  v1 = prepVersion(v1);
	  v2 = prepVersion(v2);
	  x = Math.max(v1.length, v2.length);
	  for (i = 0; i < x; i++) {
	    if (v1[i] == v2[i]) {
	      continue;
	    }
	    v1[i] = numVersion(v1[i]);
	    v2[i] = numVersion(v2[i]);
	    if (v1[i] < v2[i]) {
	      compare = -1;
	      break;
	    } else if (v1[i] > v2[i]) {
	      compare = 1;
	      break;
	    }
	  }
	  if (!operator) {
	    return compare;
	  }

	  // Important: operator is CASE-SENSITIVE.
	  // "No operator" seems to be treated as "<."
	  // Any other values seem to make the function return null.
	  switch (operator) {
	  case '>':
	  case 'gt':
	    return (compare > 0);
	  case '>=':
	  case 'ge':
	    return (compare >= 0);
	  case '<=':
	  case 'le':
	    return (compare <= 0);
	  case '==':
	  case '=':
	  case 'eq':
	    return (compare === 0);
	  case '<>':
	  case '!=':
	  case 'ne':
	    return (compare !== 0);
	  case '':
	  case '<':
	  case 'lt':
	    return (compare < 0);
	  default:
	    return null;
	  }
	}


	var can = (function() {
		var caps = {
			access_global_ns: function () {
				return !!window.moxie;
			},

			define_property: (function() {
				/* // currently too much extra code required, not exactly worth it
				try { // as of IE8, getters/setters are supported only on DOM elements
					var obj = {};
					if (Object.defineProperty) {
						Object.defineProperty(obj, 'prop', {
							enumerable: true,
							configurable: true
						});
						return true;
					}
				} catch(ex) {}

				if (Object.prototype.__defineGetter__ && Object.prototype.__defineSetter__) {
					return true;
				}*/
				return false;
			}()),

			create_canvas: function() {
				// On the S60 and BB Storm, getContext exists, but always returns undefined
				// so we actually have to call getContext() to verify
				// github.com/Modernizr/Modernizr/issues/issue/97/
				var el = document.createElement('canvas');
				var isSupported = !!(el.getContext && el.getContext('2d'));
				caps.create_canvas = isSupported;
				return isSupported;
			},

			return_response_type: function(responseType) {
				try {
					if (Basic.inArray(responseType, ['', 'text', 'document']) !== -1) {
						return true;
					} else if (window.XMLHttpRequest) {
						var xhr = new XMLHttpRequest();
						xhr.open('get', '/'); // otherwise Gecko throws an exception
						if ('responseType' in xhr) {
							xhr.responseType = responseType;
							// as of 23.0.1271.64, Chrome switched from throwing exception to merely logging it to the console (why? o why?)
							if (xhr.responseType !== responseType) {
								return false;
							}
							return true;
						}
					}
				} catch (ex) {}
				return false;
			},

			use_blob_uri: function() {
				var URL = window.URL;
				caps.use_blob_uri = (URL &&
					'createObjectURL' in URL &&
					'revokeObjectURL' in URL &&
					(Env.browser !== 'IE' || Env.verComp(Env.version, '11.0.46', '>=')) // IE supports createObjectURL, but not fully, for example it fails to use it as a src for the image
				);
				return caps.use_blob_uri;
			},

			// ideas for this heavily come from Modernizr (http://modernizr.com/)
			use_data_uri: (function() {
				var du = new Image();

				du.onload = function() {
					caps.use_data_uri = (du.width === 1 && du.height === 1);
				};

				setTimeout(function() {
					du.src = "data:image/gif;base64,R0lGODlhAQABAIAAAP8AAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==";
				}, 1);
				return false;
			}()),

			use_data_uri_over32kb: function() { // IE8
				return caps.use_data_uri && (Env.browser !== 'IE' || Env.version >= 9);
			},

			use_data_uri_of: function(bytes) {
				return (caps.use_data_uri && bytes < 33000 || caps.use_data_uri_over32kb());
			},

			use_fileinput: function() {
				if (navigator.userAgent.match(/(Android (1.0|1.1|1.5|1.6|2.0|2.1))|(Windows Phone (OS 7|8.0))|(XBLWP)|(ZuneWP)|(w(eb)?OSBrowser)|(webOS)|(Kindle\/(1.0|2.0|2.5|3.0))/)) {
					return false;
				}

				var el = document.createElement('input');
				el.setAttribute('type', 'file');
				return caps.use_fileinput = !el.disabled;
			},

			use_webgl: function() {
				var canvas = document.createElement('canvas');
				var gl = null, isSupported;
				try {
					gl = canvas.getContext("webgl") || canvas.getContext("experimental-webgl");
				}
				catch(e) {}

				if (!gl) { // it seems that sometimes it doesn't throw exception, but still fails to get context
					gl = null;
				}

				isSupported = !!gl;
				caps.use_webgl = isSupported; // save result of our check
				canvas = undefined;
				return isSupported;
			}
		};

		return function(cap) {
			var args = [].slice.call(arguments);
			args.shift(); // shift of cap
			return Basic.typeOf(caps[cap]) === 'function' ? caps[cap].apply(this, args) : !!caps[cap];
		};
	}());


	var uaResult = new UAParser().getResult();


	var Env = {
		can: can,

		uaParser: UAParser,

		browser: uaResult.browser.name,
		version: uaResult.browser.version,
		os: uaResult.os.name, // everybody intuitively types it in a lowercase for some reason
		osVersion: uaResult.os.version,

		verComp: version_compare,

		swf_url: "../flash/Moxie.swf",
		xap_url: "../silverlight/Moxie.xap",
		global_event_dispatcher: "moxie.core.EventTarget.instance.dispatchEvent"
	};

	// for backward compatibility
	// @deprecated Use `Env.os` instead
	Env.OS = Env.os;

	if (MXI_DEBUG) {
		Env.debug = {
			runtime: true,
			events: false
		};

		Env.log = function() {

			function logObj(data) {
				// TODO: this should recursively print out the object in a pretty way
				console.appendChild(document.createTextNode(data + "\n"));
			}

			// if debugger present, IE8 might have window.console.log method, but not be able to apply on it (why...)
			if (window && window.console && window.console.log && window.console.log.apply) {
				window.console.log.apply(window.console, arguments);
			} else if (document) {
				var console = document.getElementById('moxie-console');
				if (!console) {
					console = document.createElement('pre');
					console.id = 'moxie-console';
					//console.style.display = 'none';
					document.body.appendChild(console);
				}

				var data = arguments[0];
				if (Basic.typeOf(data) === 'string') {
					data = Basic.sprintf.apply(this, arguments);
				} else if (Basic.inArray(Basic.typeOf(data), ['object', 'array']) !== -1) {
					logObj(data);
					return;
				}

				console.appendChild(document.createTextNode(data + "\n"));
			}
		};
	}

	return Env;
});

// Included from: src/javascript/core/Exceptions.js

/**
 * Exceptions.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

define('moxie/core/Exceptions', [
	'moxie/core/utils/Basic'
], function(Basic) {
	
	function _findKey(obj, value) {
		var key;
		for (key in obj) {
			if (obj[key] === value) {
				return key;
			}
		}
		return null;
	}

	/**
	@class moxie/core/Exception
	*/
	return {
		RuntimeError: (function() {
			var namecodes = {
				NOT_INIT_ERR: 1,
				EXCEPTION_ERR: 3,
				NOT_SUPPORTED_ERR: 9,
				JS_ERR: 4
			};

			function RuntimeError(code, message) {
				this.code = code;
				this.name = _findKey(namecodes, code);
				this.message = this.name + (message || ": RuntimeError " + this.code);
			}
			
			Basic.extend(RuntimeError, namecodes);
			RuntimeError.prototype = Error.prototype;
			return RuntimeError;
		}()),
		
		OperationNotAllowedException: (function() {
			
			function OperationNotAllowedException(code) {
				this.code = code;
				this.name = 'OperationNotAllowedException';
			}
			
			Basic.extend(OperationNotAllowedException, {
				NOT_ALLOWED_ERR: 1
			});
			
			OperationNotAllowedException.prototype = Error.prototype;
			
			return OperationNotAllowedException;
		}()),

		ImageError: (function() {
			var namecodes = {
				WRONG_FORMAT: 1,
				MAX_RESOLUTION_ERR: 2,
				INVALID_META_ERR: 3
			};

			function ImageError(code) {
				this.code = code;
				this.name = _findKey(namecodes, code);
				this.message = this.name + ": ImageError " + this.code;
			}
			
			Basic.extend(ImageError, namecodes);
			ImageError.prototype = Error.prototype;

			return ImageError;
		}()),

		FileException: (function() {
			var namecodes = {
				NOT_FOUND_ERR: 1,
				SECURITY_ERR: 2,
				ABORT_ERR: 3,
				NOT_READABLE_ERR: 4,
				ENCODING_ERR: 5,
				NO_MODIFICATION_ALLOWED_ERR: 6,
				INVALID_STATE_ERR: 7,
				SYNTAX_ERR: 8
			};

			function FileException(code) {
				this.code = code;
				this.name = _findKey(namecodes, code);
				this.message = this.name + ": FileException " + this.code;
			}
			
			Basic.extend(FileException, namecodes);
			FileException.prototype = Error.prototype;
			return FileException;
		}()),
		
		DOMException: (function() {
			var namecodes = {
				INDEX_SIZE_ERR: 1,
				DOMSTRING_SIZE_ERR: 2,
				HIERARCHY_REQUEST_ERR: 3,
				WRONG_DOCUMENT_ERR: 4,
				INVALID_CHARACTER_ERR: 5,
				NO_DATA_ALLOWED_ERR: 6,
				NO_MODIFICATION_ALLOWED_ERR: 7,
				NOT_FOUND_ERR: 8,
				NOT_SUPPORTED_ERR: 9,
				INUSE_ATTRIBUTE_ERR: 10,
				INVALID_STATE_ERR: 11,
				SYNTAX_ERR: 12,
				INVALID_MODIFICATION_ERR: 13,
				NAMESPACE_ERR: 14,
				INVALID_ACCESS_ERR: 15,
				VALIDATION_ERR: 16,
				TYPE_MISMATCH_ERR: 17,
				SECURITY_ERR: 18,
				NETWORK_ERR: 19,
				ABORT_ERR: 20,
				URL_MISMATCH_ERR: 21,
				QUOTA_EXCEEDED_ERR: 22,
				TIMEOUT_ERR: 23,
				INVALID_NODE_TYPE_ERR: 24,
				DATA_CLONE_ERR: 25
			};

			function DOMException(code) {
				this.code = code;
				this.name = _findKey(namecodes, code);
				this.message = this.name + ": DOMException " + this.code;
			}
			
			Basic.extend(DOMException, namecodes);
			DOMException.prototype = Error.prototype;
			return DOMException;
		}()),
		
		EventException: (function() {
			function EventException(code) {
				this.code = code;
				this.name = 'EventException';
			}
			
			Basic.extend(EventException, {
				UNSPECIFIED_EVENT_TYPE_ERR: 0
			});
			
			EventException.prototype = Error.prototype;
			
			return EventException;
		}())
	};
});

// Included from: src/javascript/core/utils/Dom.js

/**
 * Dom.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/**
@class moxie/core/utils/Dom
@public
@static
*/

define('moxie/core/utils/Dom', ['moxie/core/utils/Env'], function(Env) {

	/**
	Get DOM Element by it's id.

	@method get
	@param {String} id Identifier of the DOM Element
	@return {DOMElement}
	*/
	var get = function(id) {
		if (typeof id !== 'string') {
			return id;
		}
		return document.getElementById(id);
	};

	/**
	Checks if specified DOM element has specified class.

	@method hasClass
	@static
	@param {Object} obj DOM element like object to add handler to.
	@param {String} name Class name
	*/
	var hasClass = function(obj, name) {
		if (!obj.className) {
			return false;
		}

		var regExp = new RegExp("(^|\\s+)"+name+"(\\s+|$)");
		return regExp.test(obj.className);
	};

	/**
	Adds specified className to specified DOM element.

	@method addClass
	@static
	@param {Object} obj DOM element like object to add handler to.
	@param {String} name Class name
	*/
	var addClass = function(obj, name) {
		if (!hasClass(obj, name)) {
			obj.className = !obj.className ? name : obj.className.replace(/\s+$/, '') + ' ' + name;
		}
	};

	/**
	Removes specified className from specified DOM element.

	@method removeClass
	@static
	@param {Object} obj DOM element like object to add handler to.
	@param {String} name Class name
	*/
	var removeClass = function(obj, name) {
		if (obj.className) {
			var regExp = new RegExp("(^|\\s+)"+name+"(\\s+|$)");
			obj.className = obj.className.replace(regExp, function($0, $1, $2) {
				return $1 === ' ' && $2 === ' ' ? ' ' : '';
			});
		}
	};

	/**
	Returns a given computed style of a DOM element.

	@method getStyle
	@static
	@param {Object} obj DOM element like object.
	@param {String} name Style you want to get from the DOM element
	*/
	var getStyle = function(obj, name) {
		if (obj.currentStyle) {
			return obj.currentStyle[name];
		} else if (window.getComputedStyle) {
			return window.getComputedStyle(obj, null)[name];
		}
	};


	/**
	Returns the absolute x, y position of an Element. The position will be returned in a object with x, y fields.

	@method getPos
	@static
	@param {Element} node HTML element or element id to get x, y position from.
	@param {Element} root Optional root element to stop calculations at.
	@return {object} Absolute position of the specified element object with x, y fields.
	*/
	var getPos = function(node, root) {
		var x = 0, y = 0, parent, doc = document, nodeRect, rootRect;

		node = node;
		root = root || doc.body;

		// Returns the x, y cordinate for an element on IE 6 and IE 7
		function getIEPos(node) {
			var bodyElm, rect, x = 0, y = 0;

			if (node) {
				rect = node.getBoundingClientRect();
				bodyElm = doc.compatMode === "CSS1Compat" ? doc.documentElement : doc.body;
				x = rect.left + bodyElm.scrollLeft;
				y = rect.top + bodyElm.scrollTop;
			}

			return {
				x : x,
				y : y
			};
		}

		// Use getBoundingClientRect on IE 6 and IE 7 but not on IE 8 in standards mode
		if (node && node.getBoundingClientRect && Env.browser === 'IE' && (!doc.documentMode || doc.documentMode < 8)) {
			nodeRect = getIEPos(node);
			rootRect = getIEPos(root);

			return {
				x : nodeRect.x - rootRect.x,
				y : nodeRect.y - rootRect.y
			};
		}

		parent = node;
		while (parent && parent != root && parent.nodeType) {
			x += parent.offsetLeft || 0;
			y += parent.offsetTop || 0;
			parent = parent.offsetParent;
		}

		parent = node.parentNode;
		while (parent && parent != root && parent.nodeType) {
			x -= parent.scrollLeft || 0;
			y -= parent.scrollTop || 0;
			parent = parent.parentNode;
		}

		return {
			x : x,
			y : y
		};
	};

	/**
	Returns the size of the specified node in pixels.

	@method getSize
	@static
	@param {Node} node Node to get the size of.
	@return {Object} Object with a w and h property.
	*/
	var getSize = function(node) {
		return {
			w : node.offsetWidth || node.clientWidth,
			h : node.offsetHeight || node.clientHeight
		};
	};

	return {
		get: get,
		hasClass: hasClass,
		addClass: addClass,
		removeClass: removeClass,
		getStyle: getStyle,
		getPos: getPos,
		getSize: getSize
	};
});

// Included from: src/javascript/core/EventTarget.js

/**
 * EventTarget.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

define('moxie/core/EventTarget', [
	'moxie/core/utils/Env',
	'moxie/core/Exceptions',
	'moxie/core/utils/Basic'
], function(Env, x, Basic) {

	// hash of event listeners by object uid
	var eventpool = {};

	/**
	Parent object for all event dispatching components and objects

	@class moxie/core/EventTarget
	@constructor EventTarget
	*/
	function EventTarget() {
		/**
		Unique id of the event dispatcher, usually overriden by children

		@property uid
		@type String
		*/
		this.uid = Basic.guid();
	}


	Basic.extend(EventTarget.prototype, {

		/**
		Can be called from within a child  in order to acquire uniqie id in automated manner

		@method init
		*/
		init: function() {
			if (!this.uid) {
				this.uid = Basic.guid('uid_');
			}
		},

		/**
		Register a handler to a specific event dispatched by the object

		@method addEventListener
		@param {String} type Type or basically a name of the event to subscribe to
		@param {Function} fn Callback function that will be called when event happens
		@param {Number} [priority=0] Priority of the event handler - handlers with higher priorities will be called first
		@param {Object} [scope=this] A scope to invoke event handler in
		*/
		addEventListener: function(type, fn, priority, scope) {
			var self = this, list;

			// without uid no event handlers can be added, so make sure we got one
			if (!this.hasOwnProperty('uid')) {
				this.uid = Basic.guid('uid_');
			}

			type = Basic.trim(type);

			if (/\s/.test(type)) {
				// multiple event types were passed for one handler
				Basic.each(type.split(/\s+/), function(type) {
					self.addEventListener(type, fn, priority, scope);
				});
				return;
			}

			type = type.toLowerCase();
			priority = parseInt(priority, 10) || 0;

			list = eventpool[this.uid] && eventpool[this.uid][type] || [];
			list.push({fn : fn, priority : priority, scope : scope || this});

			if (!eventpool[this.uid]) {
				eventpool[this.uid] = {};
			}
			eventpool[this.uid][type] = list;
		},

		/**
		Check if any handlers were registered to the specified event

		@method hasEventListener
		@param {String} [type] Type or basically a name of the event to check
		@return {Mixed} Returns a handler if it was found and false, if - not
		*/
		hasEventListener: function(type) {
			var list;
			if (type) {
				type = type.toLowerCase();
				list = eventpool[this.uid] && eventpool[this.uid][type];
			} else {
				list = eventpool[this.uid];
			}
			return list ? list : false;
		},

		/**
		Unregister the handler from the event, or if former was not specified - unregister all handlers

		@method removeEventListener
		@param {String} type Type or basically a name of the event
		@param {Function} [fn] Handler to unregister
		*/
		removeEventListener: function(type, fn) {
			var self = this, list, i;

			type = type.toLowerCase();

			if (/\s/.test(type)) {
				// multiple event types were passed for one handler
				Basic.each(type.split(/\s+/), function(type) {
					self.removeEventListener(type, fn);
				});
				return;
			}

			list = eventpool[this.uid] && eventpool[this.uid][type];

			if (list) {
				if (fn) {
					for (i = list.length - 1; i >= 0; i--) {
						if (list[i].fn === fn) {
							list.splice(i, 1);
							break;
						}
					}
				} else {
					list = [];
				}

				// delete event list if it has become empty
				if (!list.length) {
					delete eventpool[this.uid][type];

					// and object specific entry in a hash if it has no more listeners attached
					if (Basic.isEmptyObj(eventpool[this.uid])) {
						delete eventpool[this.uid];
					}
				}
			}
		},

		/**
		Remove all event handlers from the object

		@method removeAllEventListeners
		*/
		removeAllEventListeners: function() {
			if (eventpool[this.uid]) {
				delete eventpool[this.uid];
			}
		},

		/**
		Dispatch the event

		@method dispatchEvent
		@param {String/Object} Type of event or event object to dispatch
		@param {Mixed} [...] Variable number of arguments to be passed to a handlers
		@return {Boolean} true by default and false if any handler returned false
		*/
		dispatchEvent: function(type) {
			var uid, list, args, tmpEvt, evt = {}, result = true, undef;

			if (Basic.typeOf(type) !== 'string') {
				// we can't use original object directly (because of Silverlight)
				tmpEvt = type;

				if (Basic.typeOf(tmpEvt.type) === 'string') {
					type = tmpEvt.type;

					if (tmpEvt.total !== undef && tmpEvt.loaded !== undef) { // progress event
						evt.total = tmpEvt.total;
						evt.loaded = tmpEvt.loaded;
					}
					evt.async = tmpEvt.async || false;
				} else {
					throw new x.EventException(x.EventException.UNSPECIFIED_EVENT_TYPE_ERR);
				}
			}

			// check if event is meant to be dispatched on an object having specific uid
			if (type.indexOf('::') !== -1) {
				(function(arr) {
					uid = arr[0];
					type = arr[1];
				}(type.split('::')));
			} else {
				uid = this.uid;
			}

			type = type.toLowerCase();

			list = eventpool[uid] && eventpool[uid][type];

			if (list) {
				// sort event list by prority
				list.sort(function(a, b) { return b.priority - a.priority; });

				args = [].slice.call(arguments);

				// first argument will be pseudo-event object
				args.shift();
				evt.type = type;
				args.unshift(evt);

				if (MXI_DEBUG && Env.debug.events) {
					Env.log("%cEvent '%s' fired on %s", 'color: #999;', evt.type, (this.ctorName ? this.ctorName + '::' : '') + uid);
				}

				// Dispatch event to all listeners
				var queue = [];
				Basic.each(list, function(handler) {
					// explicitly set the target, otherwise events fired from shims do not get it
					args[0].target = handler.scope;
					// if event is marked as async, detach the handler
					if (evt.async) {
						queue.push(function(cb) {
							setTimeout(function() {
								cb(handler.fn.apply(handler.scope, args) === false);
							}, 1);
						});
					} else {
						queue.push(function(cb) {
							cb(handler.fn.apply(handler.scope, args) === false); // if handler returns false stop propagation
						});
					}
				});
				if (queue.length) {
					Basic.inSeries(queue, function(err) {
						result = !err;
					});
				}
			}
			return result;
		},

		/**
		Register a handler to the event type that will run only once

		@method bindOnce
		@since >1.4.1
		@param {String} type Type or basically a name of the event to subscribe to
		@param {Function} fn Callback function that will be called when event happens
		@param {Number} [priority=0] Priority of the event handler - handlers with higher priorities will be called first
		@param {Object} [scope=this] A scope to invoke event handler in
		*/
		bindOnce: function(type, fn, priority, scope) {
			var self = this;
			self.bind.call(this, type, function cb() {
				self.unbind(type, cb);
				return fn.apply(this, arguments);
			}, priority, scope);
		},

		/**
		Alias for addEventListener

		@method bind
		@protected
		*/
		bind: function() {
			this.addEventListener.apply(this, arguments);
		},

		/**
		Alias for removeEventListener

		@method unbind
		@protected
		*/
		unbind: function() {
			this.removeEventListener.apply(this, arguments);
		},

		/**
		Alias for removeAllEventListeners

		@method unbindAll
		@protected
		*/
		unbindAll: function() {
			this.removeAllEventListeners.apply(this, arguments);
		},

		/**
		Alias for dispatchEvent

		@method trigger
		@protected
		*/
		trigger: function() {
			return this.dispatchEvent.apply(this, arguments);
		},


		/**
		Handle properties of on[event] type.

		@method handleEventProps
		@private
		*/
		handleEventProps: function(dispatches) {
			var self = this;

			this.bind(dispatches.join(' '), function(e) {
				var prop = 'on' + e.type.toLowerCase();
				if (Basic.typeOf(this[prop]) === 'function') {
					this[prop].apply(this, arguments);
				}
			});

			// object must have defined event properties, even if it doesn't make use of them
			Basic.each(dispatches, function(prop) {
				prop = 'on' + prop.toLowerCase(prop);
				if (Basic.typeOf(self[prop]) === 'undefined') {
					self[prop] = null;
				}
			});
		}

	});


	EventTarget.instance = new EventTarget();

	return EventTarget;
});

// Included from: src/javascript/runtime/Runtime.js

/**
 * Runtime.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

define('moxie/runtime/Runtime', [
	"moxie/core/utils/Env",
	"moxie/core/utils/Basic",
	"moxie/core/utils/Dom",
	"moxie/core/EventTarget"
], function(Env, Basic, Dom, EventTarget) {
	var runtimeConstructors = {}, runtimes = {};

	/**
	Common set of methods and properties for every runtime instance

	@class moxie/runtime/Runtime

	@param {Object} options
	@param {String} type Sanitized name of the runtime
	@param {Object} [caps] Set of capabilities that differentiate specified runtime
	@param {Object} [modeCaps] Set of capabilities that do require specific operational mode
	@param {String} [preferredMode='browser'] Preferred operational mode to choose if no required capabilities were requested
	*/
	function Runtime(options, type, caps, modeCaps, preferredMode) {
		/**
		Dispatched when runtime is initialized and ready.
		Results in RuntimeInit on a connected component.

		@event Init
		*/

		/**
		Dispatched when runtime fails to initialize.
		Results in RuntimeError on a connected component.

		@event Error
		*/

		var self = this
		, _shim
		, _uid = Basic.guid(type + '_')
		, defaultMode = preferredMode || 'browser'
		;

		options = options || {};

		// register runtime in private hash
		runtimes[_uid] = this;

		/**
		Default set of capabilities, which can be redifined later by specific runtime

		@private
		@property caps
		@type Object
		*/
		caps = Basic.extend({
			// Runtime can: 
			// provide access to raw binary data of the file
			access_binary: false,
			// provide access to raw binary data of the image (image extension is optional) 
			access_image_binary: false,
			// display binary data as thumbs for example
			display_media: false,
			// make cross-domain requests
			do_cors: false,
			// accept files dragged and dropped from the desktop
			drag_and_drop: false,
			// filter files in selection dialog by their extensions
			filter_by_extension: true,
			// resize image (and manipulate it raw data of any file in general)
			resize_image: false,
			// periodically report how many bytes of total in the file were uploaded (loaded)
			report_upload_progress: false,
			// provide access to the headers of http response 
			return_response_headers: false,
			// support response of specific type, which should be passed as an argument
			// e.g. runtime.can('return_response_type', 'blob')
			return_response_type: false,
			// return http status code of the response
			return_status_code: true,
			// send custom http header with the request
			send_custom_headers: false,
			// pick up the files from a dialog
			select_file: false,
			// select whole folder in file browse dialog
			select_folder: false,
			// select multiple files at once in file browse dialog
			select_multiple: true,
			// send raw binary data, that is generated after image resizing or manipulation of other kind
			send_binary_string: false,
			// send cookies with http request and therefore retain session
			send_browser_cookies: true,
			// send data formatted as multipart/form-data
			send_multipart: true,
			// slice the file or blob to smaller parts
			slice_blob: false,
			// upload file without preloading it to memory, stream it out directly from disk
			stream_upload: false,
			// programmatically trigger file browse dialog
			summon_file_dialog: false,
			// upload file of specific size, size should be passed as argument
			// e.g. runtime.can('upload_filesize', '500mb')
			upload_filesize: true,
			// initiate http request with specific http method, method should be passed as argument
			// e.g. runtime.can('use_http_method', 'put')
			use_http_method: true
		}, caps);
			
	
		// default to the mode that is compatible with preferred caps
		if (options.preferred_caps) {
			defaultMode = Runtime.getMode(modeCaps, options.preferred_caps, defaultMode);
		}

		if (MXI_DEBUG && Env.debug.runtime) {
			Env.log("\tdefault mode: %s", defaultMode);	
		}
		
		// small extension factory here (is meant to be extended with actual extensions constructors)
		_shim = (function() {
			var objpool = {};
			return {
				exec: function(uid, comp, fn, args) {
					if (_shim[comp]) {
						if (!objpool[uid]) {
							objpool[uid] = {
								context: this,
								instance: new _shim[comp]()
							};
						}
						if (objpool[uid].instance[fn]) {
							return objpool[uid].instance[fn].apply(this, args);
						}
					}
				},

				removeInstance: function(uid) {
					delete objpool[uid];
				},

				removeAllInstances: function() {
					var self = this;
					Basic.each(objpool, function(obj, uid) {
						if (Basic.typeOf(obj.instance.destroy) === 'function') {
							obj.instance.destroy.call(obj.context);
						}
						self.removeInstance(uid);
					});
				}
			};
		}());


		// public methods
		Basic.extend(this, {
			/**
			Specifies whether runtime instance was initialized or not

			@property initialized
			@type {Boolean}
			@default false
			*/
			initialized: false, // shims require this flag to stop initialization retries

			/**
			Unique ID of the runtime

			@property uid
			@type {String}
			*/
			uid: _uid,

			/**
			Runtime type (e.g. flash, html5, etc)

			@property type
			@type {String}
			*/
			type: type,

			/**
			Runtime (not native one) may operate in browser or client mode.

			@property mode
			@private
			@type {String|Boolean} current mode or false, if none possible
			*/
			mode: Runtime.getMode(modeCaps, (options.required_caps), defaultMode),

			/**
			id of the DOM container for the runtime (if available)

			@property shimid
			@type {String}
			*/
			shimid: _uid + '_container',

			/**
			Number of connected clients. If equal to zero, runtime can be destroyed

			@property clients
			@type {Number}
			*/
			clients: 0,

			/**
			Runtime initialization options

			@property options
			@type {Object}
			*/
			options: options,

			/**
			Checks if the runtime has specific capability

			@method can
			@param {String} cap Name of capability to check
			@param {Mixed} [value] If passed, capability should somehow correlate to the value
			@param {Object} [refCaps] Set of capabilities to check the specified cap against (defaults to internal set)
			@return {Boolean} true if runtime has such capability and false, if - not
			*/
			can: function(cap, value) {
				var refCaps = arguments[2] || caps;

				// if cap var is a comma-separated list of caps, convert it to object (key/value)
				if (Basic.typeOf(cap) === 'string' && Basic.typeOf(value) === 'undefined') {
					cap = Runtime.parseCaps(cap);
				}

				if (Basic.typeOf(cap) === 'object') {
					for (var key in cap) {
						if (!this.can(key, cap[key], refCaps)) {
							return false;
						}
					}
					return true;
				}

				// check the individual cap
				if (Basic.typeOf(refCaps[cap]) === 'function') {
					return refCaps[cap].call(this, value);
				} else {
					return (value === refCaps[cap]);
				}
			},

			/**
			Returns container for the runtime as DOM element

			@method getShimContainer
			@return {DOMElement}
			*/
			getShimContainer: function() {
				var container, shimContainer = Dom.get(this.shimid);

				// if no container for shim, create one
				if (!shimContainer) {
					container = Dom.get(this.options.container) || document.body;

					// create shim container and insert it at an absolute position into the outer container
					shimContainer = document.createElement('div');
					shimContainer.id = this.shimid;
					shimContainer.className = 'moxie-shim moxie-shim-' + this.type;

					Basic.extend(shimContainer.style, {
						position: 'absolute',
						top: '0px',
						left: '0px',
						width: '1px',
						height: '1px',
						overflow: 'hidden'
					});

					container.appendChild(shimContainer);
					container = null;
				}

				return shimContainer;
			},

			/**
			Returns runtime as DOM element (if appropriate)

			@method getShim
			@return {DOMElement}
			*/
			getShim: function() {
				return _shim;
			},

			/**
			Invokes a method within the runtime itself (might differ across the runtimes)

			@method shimExec
			@param {Mixed} []
			@protected
			@return {Mixed} Depends on the action and component
			*/
			shimExec: function(component, action) {
				var args = [].slice.call(arguments, 2);
				return self.getShim().exec.call(this, this.uid, component, action, args);
			},

			/**
			Operaional interface that is used by components to invoke specific actions on the runtime
			(is invoked in the scope of component)

			@method exec
			@param {Mixed} []*
			@protected
			@return {Mixed} Depends on the action and component
			*/
			exec: function(component, action) { // this is called in the context of component, not runtime
				var args = [].slice.call(arguments, 2);

				if (self[component] && self[component][action]) {
					return self[component][action].apply(this, args);
				}
				return self.shimExec.apply(this, arguments);
			},

			/**
			Destroys the runtime (removes all events and deletes DOM structures)

			@method destroy
			*/
			destroy: function() {
				if (!self) {
					return; // obviously already destroyed
				}

				var shimContainer = Dom.get(this.shimid);
				if (shimContainer) {
					shimContainer.parentNode.removeChild(shimContainer);
				}

				if (_shim) {
					_shim.removeAllInstances();
				}

				this.unbindAll();
				delete runtimes[this.uid];
				this.uid = null; // mark this runtime as destroyed
				_uid = self = _shim = shimContainer = null;
			}
		});

		// once we got the mode, test against all caps
		if (this.mode && options.required_caps && !this.can(options.required_caps)) {
			this.mode = false;
		}	
	}


	/**
	Default order to try different runtime types

	@property order
	@type String
	@static
	*/
	Runtime.order = 'html5,flash,silverlight,html4';


	/**
	Retrieves runtime from private hash by it's uid

	@method getRuntime
	@private
	@static
	@param {String} uid Unique identifier of the runtime
	@return {Runtime|Boolean} Returns runtime, if it exists and false, if - not
	*/
	Runtime.getRuntime = function(uid) {
		return runtimes[uid] ? runtimes[uid] : false;
	};


	/**
	Register constructor for the Runtime of new (or perhaps modified) type

	@method addConstructor
	@static
	@param {String} type Runtime type (e.g. flash, html5, etc)
	@param {Function} construct Constructor for the Runtime type
	*/
	Runtime.addConstructor = function(type, constructor) {
		constructor.prototype = EventTarget.instance;
		runtimeConstructors[type] = constructor;
	};


	/**
	Get the constructor for the specified type.

	method getConstructor
	@static
	@param {String} type Runtime type (e.g. flash, html5, etc)
	@return {Function} Constructor for the Runtime type
	*/
	Runtime.getConstructor = function(type) {
		return runtimeConstructors[type] || null;
	};


	/**
	Get info about the runtime (uid, type, capabilities)

	@method getInfo
	@static
	@param {String} uid Unique identifier of the runtime
	@return {Mixed} Info object or null if runtime doesn't exist
	*/
	Runtime.getInfo = function(uid) {
		var runtime = Runtime.getRuntime(uid);

		if (runtime) {
			return {
				uid: runtime.uid,
				type: runtime.type,
				mode: runtime.mode,
				can: function() {
					return runtime.can.apply(runtime, arguments);
				}
			};
		}
		return null;
	};


	/**
	Convert caps represented by a comma-separated string to the object representation.

	@method parseCaps
	@static
	@param {String} capStr Comma-separated list of capabilities
	@return {Object}
	*/
	Runtime.parseCaps = function(capStr) {
		var capObj = {};

		if (Basic.typeOf(capStr) !== 'string') {
			return capStr || {};
		}

		Basic.each(capStr.split(','), function(key) {
			capObj[key] = true; // we assume it to be - true
		});

		return capObj;
	};

	/**
	Test the specified runtime for specific capabilities.

	@method can
	@static
	@param {String} type Runtime type (e.g. flash, html5, etc)
	@param {String|Object} caps Set of capabilities to check
	@return {Boolean} Result of the test
	*/
	Runtime.can = function(type, caps) {
		var runtime
		, constructor = Runtime.getConstructor(type)
		, mode
		;
		if (constructor) {
			runtime = new constructor({
				required_caps: caps
			});
			mode = runtime.mode;
			runtime.destroy();
			return !!mode;
		}
		return false;
	};


	/**
	Figure out a runtime that supports specified capabilities.

	@method thatCan
	@static
	@param {String|Object} caps Set of capabilities to check
	@param {String} [runtimeOrder] Comma-separated list of runtimes to check against
	@return {String} Usable runtime identifier or null
	*/
	Runtime.thatCan = function(caps, runtimeOrder) {
		var types = (runtimeOrder || Runtime.order).split(/\s*,\s*/);
		for (var i in types) {
			if (Runtime.can(types[i], caps)) {
				return types[i];
			}
		}
		return null;
	};


	/**
	Figure out an operational mode for the specified set of capabilities.

	@method getMode
	@static
	@param {Object} modeCaps Set of capabilities that depend on particular runtime mode
	@param {Object} [requiredCaps] Supplied set of capabilities to find operational mode for
	@param {String|Boolean} [defaultMode='browser'] Default mode to use 
	@return {String|Boolean} Compatible operational mode
	*/
	Runtime.getMode = function(modeCaps, requiredCaps, defaultMode) {
		var mode = null;

		if (Basic.typeOf(defaultMode) === 'undefined') { // only if not specified
			defaultMode = 'browser';
		}

		if (requiredCaps && !Basic.isEmptyObj(modeCaps)) {
			// loop over required caps and check if they do require the same mode
			Basic.each(requiredCaps, function(value, cap) {
				if (modeCaps.hasOwnProperty(cap)) {
					var capMode = modeCaps[cap](value);

					// make sure we always have an array
					if (typeof(capMode) === 'string') {
						capMode = [capMode];
					}
					
					if (!mode) {
						mode = capMode;						
					} else if (!(mode = Basic.arrayIntersect(mode, capMode))) {
						// if cap requires conflicting mode - runtime cannot fulfill required caps

						if (MXI_DEBUG && Env.debug.runtime) {
							Env.log("\t\t%s: %s (conflicting mode requested: %s)", cap, value, capMode);
						}

						return (mode = false);
					}					
				}

				if (MXI_DEBUG && Env.debug.runtime) {
					Env.log("\t\t%s: %s (compatible modes: %s)", cap, value, mode);
				}
			});

			if (mode) {
				return Basic.inArray(defaultMode, mode) !== -1 ? defaultMode : mode[0];
			} else if (mode === false) {
				return false;
			}
		}
		return defaultMode; 
	};


	/**
	 * Third party shims (Flash and Silverlight) require global event target against which they
	 * will fire their events. However when moxie is not loaded to global namespace, default
	 * event target is not accessible and we have to create artificial ones.
	 *
	 * @method getGlobalEventTarget
	 * @static
	 * @return {String} Name of the global event target
	 */
	Runtime.getGlobalEventTarget = function() {
		if (/^moxie\./.test(Env.global_event_dispatcher) && !Env.can('access_global_ns')) {
			var uniqueCallbackName = Basic.guid('moxie_event_target_');

			window[uniqueCallbackName] = function(e, data) {
				EventTarget.instance.dispatchEvent(e, data);
			};

			Env.global_event_dispatcher = uniqueCallbackName;
		}

		return Env.global_event_dispatcher;
	};


	/**
	Capability check that always returns true

	@private
	@static
	@return {True}
	*/
	Runtime.capTrue = function() {
		return true;
	};

	/**
	Capability check that always returns false

	@private
	@static
	@return {False}
	*/
	Runtime.capFalse = function() {
		return false;
	};

	/**
	Evaluate the expression to boolean value and create a function that always returns it.

	@private
	@static
	@param {Mixed} expr Expression to evaluate
	@return {Function} Function returning the result of evaluation
	*/
	Runtime.capTest = function(expr) {
		return function() {
			return !!expr;
		};
	};

	return Runtime;
});

// Included from: src/javascript/runtime/RuntimeClient.js

/**
 * RuntimeClient.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

define('moxie/runtime/RuntimeClient', [
	'moxie/core/utils/Env',
	'moxie/core/Exceptions',
	'moxie/core/utils/Basic',
	'moxie/runtime/Runtime'
], function(Env, x, Basic, Runtime) {
	/**
	Set of methods and properties, required by a component to acquire ability to connect to a runtime

	@class moxie/runtime/RuntimeClient
	*/
	return function RuntimeClient() {
		var runtime;

		Basic.extend(this, {
			/**
			Connects to the runtime specified by the options. Will either connect to existing runtime or create a new one.
			Increments number of clients connected to the specified runtime.

			@private
			@method connectRuntime
			@param {Mixed} options Can be a runtme uid or a set of key-value pairs defining requirements and pre-requisites
			*/
			connectRuntime: function(options) {
				var comp = this, ruid;

				function initialize(items) {
					var type, constructor;

					// if we ran out of runtimes
					if (!items.length) {
						comp.trigger('RuntimeError', new x.RuntimeError(x.RuntimeError.NOT_INIT_ERR));
						runtime = null;
						return;
					}

					type = items.shift().toLowerCase();
					constructor = Runtime.getConstructor(type);
					if (!constructor) {
						if (MXI_DEBUG && Env.debug.runtime) {
							Env.log("Constructor for '%s' runtime is not available.", type);
						}
						initialize(items);
						return;
					}

					if (MXI_DEBUG && Env.debug.runtime) {
						Env.log("Trying runtime: %s", type);
						Env.log(options);
					}

					// try initializing the runtime
					runtime = new constructor(options);

					runtime.bind('Init', function() {
						// mark runtime as initialized
						runtime.initialized = true;

						if (MXI_DEBUG && Env.debug.runtime) {
							Env.log("Runtime '%s' initialized", runtime.type);
						}

						// jailbreak ...
						setTimeout(function() {
							runtime.clients++;
							comp.ruid = runtime.uid;
							// this will be triggered on component
							comp.trigger('RuntimeInit', runtime);
						}, 1);
					});

					runtime.bind('Error', function() {
						if (MXI_DEBUG && Env.debug.runtime) {
							Env.log("Runtime '%s' failed to initialize", runtime.type);
						}

						runtime.destroy(); // runtime cannot destroy itself from inside at a right moment, thus we do it here
						initialize(items);
					});

					runtime.bind('Exception', function(e, err) {
						var message = err.name + "(#" + err.code + ")" + (err.message ? ", from: " + err.message : '');
						
						if (MXI_DEBUG && Env.debug.runtime) {
							Env.log("Runtime '%s' has thrown an exception: %s", this.type, message);
						}
						comp.trigger('RuntimeError', new x.RuntimeError(x.RuntimeError.EXCEPTION_ERR, message));
					});

					if (MXI_DEBUG && Env.debug.runtime) {
						Env.log("\tselected mode: %s", runtime.mode);	
					}

					// check if runtime managed to pick-up operational mode
					if (!runtime.mode) {
						runtime.trigger('Error');
						return;
					}

					runtime.init();
				}

				// check if a particular runtime was requested
				if (Basic.typeOf(options) === 'string') {
					ruid = options;
				} else if (Basic.typeOf(options.ruid) === 'string') {
					ruid = options.ruid;
				}

				if (ruid) {
					runtime = Runtime.getRuntime(ruid);
					if (runtime) {
						comp.ruid = ruid;
						runtime.clients++;
						return runtime;
					} else {
						// there should be a runtime and there's none - weird case
						throw new x.RuntimeError(x.RuntimeError.NOT_INIT_ERR);
					}
				}

				// initialize a fresh one, that fits runtime list and required features best
				initialize((options.runtime_order || Runtime.order).split(/\s*,\s*/));
			},


			/**
			Disconnects from the runtime. Decrements number of clients connected to the specified runtime.

			@private
			@method disconnectRuntime
			*/
			disconnectRuntime: function() {
				if (runtime && --runtime.clients <= 0) {
					runtime.destroy();
				}

				// once the component is disconnected, it shouldn't have access to the runtime
				runtime = null;
			},


			/**
			Returns the runtime to which the client is currently connected.

			@method getRuntime
			@return {Runtime} Runtime or null if client is not connected
			*/
			getRuntime: function() {
				if (runtime && runtime.uid) {
					return runtime;
				}
				return runtime = null; // make sure we do not leave zombies rambling around
			},


			/**
			Handy shortcut to safely invoke runtime extension methods.
			
			@private
			@method exec
			@return {Mixed} Whatever runtime extension method returns
			*/
			exec: function() {
				return runtime ? runtime.exec.apply(this, arguments) : null;
			},


			/**
			Test runtime client for specific capability
			
			@method can
			@param {String} cap
			@return {Bool}
			*/
			can: function(cap) {
				return runtime ? runtime.can(cap) : false;
			}

		});
	};


});

// Included from: src/javascript/file/Blob.js

/**
 * Blob.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

define('moxie/file/Blob', [
	'moxie/core/utils/Basic',
	'moxie/core/utils/Encode',
	'moxie/runtime/RuntimeClient'
], function(Basic, Encode, RuntimeClient) {
	
	var blobpool = {};

	/**
	@class moxie/file/Blob
	@constructor
	@param {String} ruid Unique id of the runtime, to which this blob belongs to
	@param {Object} blob Object "Native" blob object, as it is represented in the runtime
	*/
	function Blob(ruid, blob) {

		function _sliceDetached(start, end, type) {
			var blob, data = blobpool[this.uid];

			if (Basic.typeOf(data) !== 'string' || !data.length) {
				return null; // or throw exception
			}

			blob = new Blob(null, {
				type: type,
				size: end - start
			});
			blob.detach(data.substr(start, blob.size));

			return blob;
		}

		RuntimeClient.call(this);

		if (ruid) {	
			this.connectRuntime(ruid);
		}

		if (!blob) {
			blob = {};
		} else if (Basic.typeOf(blob) === 'string') { // dataUrl or binary string
			blob = { data: blob };
		}

		Basic.extend(this, {
			
			/**
			Unique id of the component

			@property uid
			@type {String}
			*/
			uid: blob.uid || Basic.guid('uid_'),
			
			/**
			Unique id of the connected runtime, if falsy, then runtime will have to be initialized 
			before this Blob can be used, modified or sent

			@property ruid
			@type {String}
			*/
			ruid: ruid,
	
			/**
			Size of blob

			@property size
			@type {Number}
			@default 0
			*/
			size: blob.size || 0,
			
			/**
			Mime type of blob

			@property type
			@type {String}
			@default ''
			*/
			type: blob.type || '',
			
			/**
			@method slice
			@param {Number} [start=0]
			*/
			slice: function(start, end, type) {		
				if (this.isDetached()) {
					return _sliceDetached.apply(this, arguments);
				}
				return this.getRuntime().exec.call(this, 'Blob', 'slice', this.getSource(), start, end, type);
			},

			/**
			Returns "native" blob object (as it is represented in connected runtime) or null if not found

			@method getSource
			@return {Blob} Returns "native" blob object or null if not found
			*/
			getSource: function() {
				if (!blobpool[this.uid]) {
					return null;	
				}
				return blobpool[this.uid];
			},

			/** 
			Detaches blob from any runtime that it depends on and initialize with standalone value

			@method detach
			@protected
			@param {DOMString} [data=''] Standalone value
			*/
			detach: function(data) {
				if (this.ruid) {
					this.getRuntime().exec.call(this, 'Blob', 'destroy');
					this.disconnectRuntime();
					this.ruid = null;
				}

				data = data || '';

				// if dataUrl, convert to binary string
				if (data.substr(0, 5) == 'data:') {
					var base64Offset = data.indexOf(';base64,');
					this.type = data.substring(5, base64Offset);
					data = Encode.atob(data.substring(base64Offset + 8));
				}

				this.size = data.length;

				blobpool[this.uid] = data;
			},

			/**
			Checks if blob is standalone (detached of any runtime)
			
			@method isDetached
			@protected
			@return {Boolean}
			*/
			isDetached: function() {
				return !this.ruid && Basic.typeOf(blobpool[this.uid]) === 'string';
			},
			
			/** 
			Destroy Blob and free any resources it was using

			@method destroy
			*/
			destroy: function() {
				this.detach();
				delete blobpool[this.uid];
			}
		});

		
		if (blob.data) {
			this.detach(blob.data); // auto-detach if payload has been passed
		} else {
			blobpool[this.uid] = blob;	
		}
	}
	
	return Blob;
});

// Included from: src/javascript/core/I18n.js

/**
 * I18n.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

define("moxie/core/I18n", [
	"moxie/core/utils/Basic"
], function(Basic) {
	var i18n = {};

	/**
	@class moxie/core/I18n
	*/
	return {
		/**
		 * Extends the language pack object with new items.
		 *
		 * @param {Object} pack Language pack items to add.
		 * @return {Object} Extended language pack object.
		 */
		addI18n: function(pack) {
			return Basic.extend(i18n, pack);
		},

		/**
		 * Translates the specified string by checking for the english string in the language pack lookup.
		 *
		 * @param {String} str String to look for.
		 * @return {String} Translated string or the input string if it wasn't found.
		 */
		translate: function(str) {
			return i18n[str] || str;
		},

		/**
		 * Shortcut for translate function
		 *
		 * @param {String} str String to look for.
		 * @return {String} Translated string or the input string if it wasn't found.
		 */
		_: function(str) {
			return this.translate(str);
		},

		/**
		 * Pseudo sprintf implementation - simple way to replace tokens with specified values.
		 *
		 * @param {String} str String with tokens
		 * @return {String} String with replaced tokens
		 */
		sprintf: function(str) {
			var args = [].slice.call(arguments, 1);

			return str.replace(/%[a-z]/g, function() {
				var value = args.shift();
				return Basic.typeOf(value) !== 'undefined' ? value : '';
			});
		}
	};
});

// Included from: src/javascript/core/utils/Mime.js

/**
 * Mime.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/**
@class moxie/core/utils/Mime
@public
@static
*/

define("moxie/core/utils/Mime", [
	"moxie/core/utils/Basic",
	"moxie/core/I18n"
], function(Basic, I18n) {

	var mimeData = "" +
		"application/msword,doc dot," +
		"application/pdf,pdf," +
		"application/pgp-signature,pgp," +
		"application/postscript,ps ai eps," +
		"application/rtf,rtf," +
		"application/vnd.ms-excel,xls xlb xlt xla," +
		"application/vnd.ms-powerpoint,ppt pps pot ppa," +
		"application/zip,zip," +
		"application/x-shockwave-flash,swf swfl," +
		"application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx," +
		"application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx," +
		"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx," +
		"application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx," +
		"application/vnd.openxmlformats-officedocument.presentationml.template,potx," +
		"application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx," +
		"application/x-javascript,js," +
		"application/json,json," +
		"audio/mpeg,mp3 mpga mpega mp2," +
		"audio/x-wav,wav," +
		"audio/x-m4a,m4a," +
		"audio/ogg,oga ogg," +
		"audio/aiff,aiff aif," +
		"audio/flac,flac," +
		"audio/aac,aac," +
		"audio/ac3,ac3," +
		"audio/x-ms-wma,wma," +
		"image/bmp,bmp," +
		"image/gif,gif," +
		"image/jpeg,jpg jpeg jpe," +
		"image/photoshop,psd," +
		"image/png,png," +
		"image/svg+xml,svg svgz," +
		"image/tiff,tiff tif," +
		"text/plain,asc txt text diff log," +
		"text/html,htm html xhtml," +
		"text/css,css," +
		"text/csv,csv," +
		"text/rtf,rtf," +
		"video/mpeg,mpeg mpg mpe m2v," +
		"video/quicktime,qt mov," +
		"video/mp4,mp4," +
		"video/x-m4v,m4v," +
		"video/x-flv,flv," +
		"video/x-ms-wmv,wmv," +
		"video/avi,avi," +
		"video/webm,webm," +
		"video/3gpp,3gpp 3gp," +
		"video/3gpp2,3g2," +
		"video/vnd.rn-realvideo,rv," +
		"video/ogg,ogv," +
		"video/x-matroska,mkv," +
		"application/vnd.oasis.opendocument.formula-template,otf," +
		"application/octet-stream,exe";


	/**
	 * Map of mimes to extensions
	 *
	 * @property mimes
	 * @type {Object}
	 */
	var mimes = {};

	/**
	 * Map of extensions to mimes
	 *
	 * @property extensions
	 * @type {Object}
	 */
	var extensions = {};


	/**
	* Parses mimeData string into a mimes and extensions lookup maps. String should have the
	* following format:
	*
	* application/msword,doc dot,application/pdf,pdf, ...
	*
	* so mime-type followed by comma and followed by space-separated list of associated extensions,
	* then comma again and then another mime-type, etc.
	*
	* If invoked externally will replace override internal lookup maps with user-provided data.
	*
	* @method addMimeType
	* @param {String} mimeData
	*/
	var addMimeType = function (mimeData) {
		var items = mimeData.split(/,/), i, ii, ext;

		for (i = 0; i < items.length; i += 2) {
			ext = items[i + 1].split(/ /);

			// extension to mime lookup
			for (ii = 0; ii < ext.length; ii++) {
				mimes[ext[ii]] = items[i];
			}
			// mime to extension lookup
			extensions[items[i]] = ext;
		}
	};


	var extList2mimes = function (filters, addMissingExtensions) {
		var ext, i, ii, type, mimes = [];

		// convert extensions to mime types list
		for (i = 0; i < filters.length; i++) {
			ext = filters[i].extensions.toLowerCase().split(/\s*,\s*/);

			for (ii = 0; ii < ext.length; ii++) {

				// if there's an asterisk in the list, then accept attribute is not required
				if (ext[ii] === '*') {
					return [];
				}

				type = mimes[ext[ii]];

				// future browsers should filter by extension, finally
				if (addMissingExtensions && /^\w+$/.test(ext[ii])) {
					mimes.push('.' + ext[ii]);
				} else if (type && Basic.inArray(type, mimes) === -1) {
					mimes.push(type);
				} else if (!type) {
					// if we have no type in our map, then accept all
					return [];
				}
			}
		}
		return mimes;
	};


	var mimes2exts = function(mimes) {
		var exts = [];

		Basic.each(mimes, function(mime) {
			mime = mime.toLowerCase();

			if (mime === '*') {
				exts = [];
				return false;
			}

			// check if this thing looks like mime type
			var m = mime.match(/^(\w+)\/(\*|\w+)$/);
			if (m) {
				if (m[2] === '*') {
					// wildcard mime type detected
					Basic.each(extensions, function(arr, mime) {
						if ((new RegExp('^' + m[1] + '/')).test(mime)) {
							[].push.apply(exts, extensions[mime]);
						}
					});
				} else if (extensions[mime]) {
					[].push.apply(exts, extensions[mime]);
				}
			}
		});
		return exts;
	};


	var mimes2extList = function(mimes) {
		var accept = [], exts = [];

		if (Basic.typeOf(mimes) === 'string') {
			mimes = Basic.trim(mimes).split(/\s*,\s*/);
		}

		exts = mimes2exts(mimes);

		accept.push({
			title: I18n.translate('Files'),
			extensions: exts.length ? exts.join(',') : '*'
		});

		return accept;
	};

	/**
	 * Extract extension from the given filename
	 *
	 * @method getFileExtension
	 * @param {String} fileName
	 * @return {String} File extension
	 */
	var getFileExtension = function(fileName) {
		var matches = fileName && fileName.match(/\.([^.]+)$/);
		if (matches) {
			return matches[1].toLowerCase();
		}
		return '';
	};


	/**
	 * Get file mime-type from it's filename - will try to match the extension
	 * against internal mime-type lookup map
	 *
	 * @method getFileMime
	 * @param {String} fileName
	 * @return File mime-type if found or an empty string if not
	 */
	var getFileMime = function(fileName) {
		return mimes[getFileExtension(fileName)] || '';
	};


	addMimeType(mimeData);

	return {
		mimes: mimes,
		extensions: extensions,
		addMimeType: addMimeType,
		extList2mimes: extList2mimes,
		mimes2exts: mimes2exts,
		mimes2extList: mimes2extList,
		getFileExtension: getFileExtension,
		getFileMime: getFileMime
	}
});

// Included from: src/javascript/file/FileInput.js

/**
 * FileInput.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

define('moxie/file/FileInput', [
	'moxie/core/utils/Basic',
	'moxie/core/utils/Env',
	'moxie/core/utils/Mime',
	'moxie/core/utils/Dom',
	'moxie/core/Exceptions',
	'moxie/core/EventTarget',
	'moxie/core/I18n',
	'moxie/runtime/Runtime',
	'moxie/runtime/RuntimeClient'
], function(Basic, Env, Mime, Dom, x, EventTarget, I18n, Runtime, RuntimeClient) {
	/**
	Provides a convenient way to create cross-browser file-picker. Generates file selection dialog on click,
	converts selected files to _File_ objects, to be used in conjunction with _Image_, preloaded in memory
	with _FileReader_ or uploaded to a server through _XMLHttpRequest_.

	@class moxie/file/FileInput
	@constructor
	@extends EventTarget
	@uses RuntimeClient
	@param {Object|String|DOMElement} options If options is string or node, argument is considered as _browse\_button_.
		@param {String|DOMElement} options.browse_button DOM Element to turn into file picker.
		@param {Array} [options.accept] Array of mime types to accept. By default accepts all.
		@param {Boolean} [options.multiple=false] Enable selection of multiple files.
		@param {Boolean} [options.directory=false] Turn file input into the folder input (cannot be both at the same time).
		@param {String|DOMElement} [options.container] DOM Element to use as a container for file-picker. Defaults to parentNode
		for _browse\_button_.
		@param {Object|String} [options.required_caps] Set of required capabilities, that chosen runtime must support.

	@example
		<div id="container">
			<a id="file-picker" href="javascript:;">Browse...</a>
		</div>

		<script>
			var fileInput = new moxie.file.FileInput({
				browse_button: 'file-picker', // or document.getElementById('file-picker')
				container: 'container',
				accept: [
					{title: "Image files", extensions: "jpg,gif,png"} // accept only images
				],
				multiple: true // allow multiple file selection
			});

			fileInput.onchange = function(e) {
				// do something to files array
				console.info(e.target.files); // or this.files or fileInput.files
			};

			fileInput.init(); // initialize
		</script>
	*/
	var dispatches = [
		/**
		Dispatched when runtime is connected and file-picker is ready to be used.

		@event ready
		@param {Object} event
		*/
		'ready',

		/**
		Dispatched right after [ready](#event_ready) event, and whenever [refresh()](#method_refresh) is invoked.
		Check [corresponding documentation entry](#method_refresh) for more info.

		@event refresh
		@param {Object} event
		*/

		/**
		Dispatched when selection of files in the dialog is complete.

		@event change
		@param {Object} event
		*/
		'change',

		'cancel', // TODO: might be useful

		/**
		Dispatched when mouse cursor enters file-picker area. Can be used to style element
		accordingly.

		@event mouseenter
		@param {Object} event
		*/
		'mouseenter',

		/**
		Dispatched when mouse cursor leaves file-picker area. Can be used to style element
		accordingly.

		@event mouseleave
		@param {Object} event
		*/
		'mouseleave',

		/**
		Dispatched when functional mouse button is pressed on top of file-picker area.

		@event mousedown
		@param {Object} event
		*/
		'mousedown',

		/**
		Dispatched when functional mouse button is released on top of file-picker area.

		@event mouseup
		@param {Object} event
		*/
		'mouseup'
	];

	function FileInput(options) {
		if (MXI_DEBUG) {
			Env.log("Instantiating FileInput...");
		}

		var container, browseButton, defaults;

		// if flat argument passed it should be browse_button id
		if (Basic.inArray(Basic.typeOf(options), ['string', 'node']) !== -1) {
			options = { browse_button : options };
		}

		// this will help us to find proper default container
		browseButton = Dom.get(options.browse_button);
		if (!browseButton) {
			// browse button is required
			throw new x.DOMException(x.DOMException.NOT_FOUND_ERR);
		}

		// figure out the options
		defaults = {
			accept: [{
				title: I18n.translate('All Files'),
				extensions: '*'
			}],
			multiple: false,
			required_caps: false,
			container: browseButton.parentNode || document.body
		};

		options = Basic.extend({}, defaults, options);

		// convert to object representation
		if (typeof(options.required_caps) === 'string') {
			options.required_caps = Runtime.parseCaps(options.required_caps);
		}

		// normalize accept option (could be list of mime types or array of title/extensions pairs)
		if (typeof(options.accept) === 'string') {
			options.accept = Mime.mimes2extList(options.accept);
		}

		container = Dom.get(options.container);
		// make sure we have container
		if (!container) {
			container = document.body;
		}

		// make container relative, if it's not
		if (Dom.getStyle(container, 'position') === 'static') {
			container.style.position = 'relative';
		}

		container = browseButton = null; // IE

		RuntimeClient.call(this);

		Basic.extend(this, {
			/**
			Unique id of the component

			@property uid
			@protected
			@readOnly
			@type {String}
			@default UID
			*/
			uid: Basic.guid('uid_'),

			/**
			Unique id of the connected runtime, if any.

			@property ruid
			@protected
			@type {String}
			*/
			ruid: null,

			/**
			Unique id of the runtime container. Useful to get hold of it for various manipulations.

			@property shimid
			@protected
			@type {String}
			*/
			shimid: null,

			/**
			Array of selected moxie.file.File objects

			@property files
			@type {Array}
			@default null
			*/
			files: null,

			/**
			Initializes the file-picker, connects it to runtime and dispatches event ready when done.

			@method init
			*/
			init: function() {
				var self = this;

				self.bind('RuntimeInit', function(e, runtime) {
					self.ruid = runtime.uid;
					self.shimid = runtime.shimid;

					self.bind("Ready", function() {
						self.trigger("Refresh");
					}, 999);

					// re-position and resize shim container
					self.bind('Refresh', function() {
						var pos, size, browseButton, shimContainer, zIndex;

						browseButton = Dom.get(options.browse_button);
						shimContainer = Dom.get(runtime.shimid); // do not use runtime.getShimContainer(), since it will create container if it doesn't exist

						if (browseButton) {
							pos = Dom.getPos(browseButton, Dom.get(options.container));
							size = Dom.getSize(browseButton);
							zIndex = parseInt(Dom.getStyle(browseButton, 'z-index'), 10) || 0;

							if (shimContainer) {
								Basic.extend(shimContainer.style, {
									top: pos.y + 'px',
									left: pos.x + 'px',
									width: size.w + 'px',
									height: size.h + 'px',
									zIndex: zIndex + 1
								});
							}
						}
						shimContainer = browseButton = null;
					});

					runtime.exec.call(self, 'FileInput', 'init', options);
				});

				// runtime needs: options.required_features, options.runtime_order and options.container
				self.connectRuntime(Basic.extend({}, options, {
					required_caps: {
						select_file: true
					}
				}));
			},


			/**
			 * Get current option value by its name
			 *
			 * @method getOption
			 * @param name
			 * @return {Mixed}
			 */
			getOption: function(name) {
				return options[name];
			},


			/**
			 * Sets a new value for the option specified by name
			 *
			 * @method setOption
			 * @param name
			 * @param value
			 */
			setOption: function(name, value) {
				if (!options.hasOwnProperty(name)) {
					return;
				}

				var oldValue = options[name];

				switch (name) {
					case 'accept':
						if (typeof(value) === 'string') {
							value = Mime.mimes2extList(value);
						}
						break;

					case 'container':
					case 'required_caps':
						throw new x.FileException(x.FileException.NO_MODIFICATION_ALLOWED_ERR);
				}

				options[name] = value;
				this.exec('FileInput', 'setOption', name, value);

				this.trigger('OptionChanged', name, value, oldValue);
			},

			/**
			Disables file-picker element, so that it doesn't react to mouse clicks.

			@method disable
			@param {Boolean} [state=true] Disable component if - true, enable if - false
			*/
			disable: function(state) {
				var runtime = this.getRuntime();
				if (runtime) {
					this.exec('FileInput', 'disable', Basic.typeOf(state) === 'undefined' ? true : state);
				}
			},


			/**
			Reposition and resize dialog trigger to match the position and size of browse_button element.

			@method refresh
			*/
			refresh: function() {
				this.trigger("Refresh");
			},


			/**
			Destroy component.

			@method destroy
			*/
			destroy: function() {
				var runtime = this.getRuntime();
				if (runtime) {
					runtime.exec.call(this, 'FileInput', 'destroy');
					this.disconnectRuntime();
				}

				if (Basic.typeOf(this.files) === 'array') {
					// no sense in leaving associated files behind
					Basic.each(this.files, function(file) {
						file.destroy();
					});
				}
				this.files = null;

				this.unbindAll();
			}
		});

		this.handleEventProps(dispatches);
	}

	FileInput.prototype = EventTarget.instance;

	return FileInput;
});

// Included from: src/javascript/file/File.js

/**
 * File.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

define('moxie/file/File', [
	'moxie/core/utils/Basic',
	'moxie/core/utils/Mime',
	'moxie/file/Blob'
], function(Basic, Mime, Blob) {
	/**
	@class moxie/file/File
	@extends Blob
	@constructor
	@param {String} ruid Unique id of the runtime, to which this blob belongs to
	@param {Object} file Object "Native" file object, as it is represented in the runtime
	*/
	function File(ruid, file) {
		if (!file) { // avoid extra errors in case we overlooked something
			file = {};
		}

		Blob.apply(this, arguments);

		if (!this.type) {
			this.type = Mime.getFileMime(file.name);
		}

		// sanitize file name or generate new one
		var name;
		if (file.name) {
			name = file.name.replace(/\\/g, '/');
			name = name.substr(name.lastIndexOf('/') + 1);
		} else if (this.type) {
			var prefix = this.type.split('/')[0];
			name = Basic.guid((prefix !== '' ? prefix : 'file') + '_');
			
			if (Mime.extensions[this.type]) {
				name += '.' + Mime.extensions[this.type][0]; // append proper extension if possible
			}
		}
		
		
		Basic.extend(this, {
			/**
			File name

			@property name
			@type {String}
			@default UID
			*/
			name: name || Basic.guid('file_'),

			/**
			Relative path to the file inside a directory

			@property relativePath
			@type {String}
			@default ''
			*/
			relativePath: '',
			
			/**
			Date of last modification

			@property lastModifiedDate
			@type {String}
			@default now
			*/
			lastModifiedDate: file.lastModifiedDate || (new Date()).toLocaleString() // Thu Aug 23 2012 19:40:00 GMT+0400 (GET)
		});
	}

	File.prototype = Blob.prototype;

	return File;
});

// Included from: src/javascript/file/FileDrop.js

/**
 * FileDrop.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

define('moxie/file/FileDrop', [
	'moxie/core/I18n',
	'moxie/core/utils/Dom',
	'moxie/core/Exceptions',
	'moxie/core/utils/Basic',
	'moxie/core/utils/Env',
	'moxie/file/File',
	'moxie/runtime/RuntimeClient',
	'moxie/core/EventTarget',
	'moxie/core/utils/Mime'
], function(I18n, Dom, x, Basic, Env, File, RuntimeClient, EventTarget, Mime) {
	/**
	Turn arbitrary DOM element to a drop zone accepting files. Converts selected files to _File_ objects, to be used 
	in conjunction with _Image_, preloaded in memory with _FileReader_ or uploaded to a server through 
	_XMLHttpRequest_.

	@example
		<div id="drop_zone">
			Drop files here
		</div>
		<br />
		<div id="filelist"></div>

		<script type="text/javascript">
			var fileDrop = new moxie.file.FileDrop('drop_zone'), fileList = moxie.utils.Dom.get('filelist');

			fileDrop.ondrop = function() {
				moxie.utils.Basic.each(this.files, function(file) {
					fileList.innerHTML += '<div>' + file.name + '</div>';
				});
			};

			fileDrop.init();
		</script>

	@class moxie/file/FileDrop
	@constructor
	@extends EventTarget
	@uses RuntimeClient
	@param {Object|String} options If options has typeof string, argument is considered as options.drop_zone
		@param {String|DOMElement} options.drop_zone DOM Element to turn into a drop zone
		@param {Array} [options.accept] Array of mime types to accept. By default accepts all
		@param {Object|String} [options.required_caps] Set of required capabilities, that chosen runtime must support
	*/
	var dispatches = [
		/**
		Dispatched when runtime is connected and drop zone is ready to accept files.

		@event ready
		@param {Object} event
		*/
		'ready', 

		/**
		Dispatched when dragging cursor enters the drop zone.

		@event dragenter
		@param {Object} event
		*/
		'dragenter',

		/**
		Dispatched when dragging cursor leaves the drop zone.

		@event dragleave
		@param {Object} event
		*/
		'dragleave', 

		/**
		Dispatched when file is dropped onto the drop zone.

		@event drop
		@param {Object} event
		*/
		'drop', 

		/**
		Dispatched if error occurs.

		@event error
		@param {Object} event
		*/
		'error'
	];

	function FileDrop(options) {
		if (MXI_DEBUG) {
			Env.log("Instantiating FileDrop...");	
		}

		var self = this, defaults;

		// if flat argument passed it should be drop_zone id
		if (typeof(options) === 'string') {
			options = { drop_zone : options };
		}

		// figure out the options
		defaults = {
			accept: [{
				title: I18n.translate('All Files'),
				extensions: '*'
			}],
			required_caps: {
				drag_and_drop: true
			}
		};
		
		options = typeof(options) === 'object' ? Basic.extend({}, defaults, options) : defaults;

		// this will help us to find proper default container
		options.container = Dom.get(options.drop_zone) || document.body;

		// make container relative, if it is not
		if (Dom.getStyle(options.container, 'position') === 'static') {
			options.container.style.position = 'relative';
		}
					
		// normalize accept option (could be list of mime types or array of title/extensions pairs)
		if (typeof(options.accept) === 'string') {
			options.accept = Mime.mimes2extList(options.accept);
		}

		RuntimeClient.call(self);

		Basic.extend(self, {
			uid: Basic.guid('uid_'),

			ruid: null,

			files: null,

			init: function() {		
				self.bind('RuntimeInit', function(e, runtime) {
					self.ruid = runtime.uid;
					runtime.exec.call(self, 'FileDrop', 'init', options);
					self.dispatchEvent('ready');
				});
							
				// runtime needs: options.required_features, options.runtime_order and options.container
				self.connectRuntime(options); // throws RuntimeError
			},

			destroy: function() {
				var runtime = this.getRuntime();
				if (runtime) {
					runtime.exec.call(this, 'FileDrop', 'destroy');
					this.disconnectRuntime();
				}
				this.files = null;
				
				this.unbindAll();
			}
		});

		this.handleEventProps(dispatches);
	}

	FileDrop.prototype = EventTarget.instance;

	return FileDrop;
});

// Included from: src/javascript/file/FileReader.js

/**
 * FileReader.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

define('moxie/file/FileReader', [
	'moxie/core/utils/Basic',
	'moxie/core/utils/Encode',
	'moxie/core/Exceptions',
	'moxie/core/EventTarget',
	'moxie/file/Blob',
	'moxie/runtime/RuntimeClient'
], function(Basic, Encode, x, EventTarget, Blob, RuntimeClient) {
	/**
	Utility for preloading o.Blob/o.File objects in memory. By design closely follows [W3C FileReader](http://www.w3.org/TR/FileAPI/#dfn-filereader)
	interface. Where possible uses native FileReader, where - not falls back to shims.

	@class moxie/file/FileReader
	@constructor FileReader
	@extends EventTarget
	@uses RuntimeClient
	*/
	var dispatches = [

		/** 
		Dispatched when the read starts.

		@event loadstart
		@param {Object} event
		*/
		'loadstart', 

		/** 
		Dispatched while reading (and decoding) blob, and reporting partial Blob data (progess.loaded/progress.total).

		@event progress
		@param {Object} event
		*/
		'progress', 

		/** 
		Dispatched when the read has successfully completed.

		@event load
		@param {Object} event
		*/
		'load', 

		/** 
		Dispatched when the read has been aborted. For instance, by invoking the abort() method.

		@event abort
		@param {Object} event
		*/
		'abort', 

		/** 
		Dispatched when the read has failed.

		@event error
		@param {Object} event
		*/
		'error', 

		/** 
		Dispatched when the request has completed (either in success or failure).

		@event loadend
		@param {Object} event
		*/
		'loadend'
	];
	
	function FileReader() {

		RuntimeClient.call(this);

		Basic.extend(this, {
			/**
			UID of the component instance.

			@property uid
			@type {String}
			*/
			uid: Basic.guid('uid_'),

			/**
			Contains current state of FileReader object. Can take values of FileReader.EMPTY, FileReader.LOADING
			and FileReader.DONE.

			@property readyState
			@type {Number}
			@default FileReader.EMPTY
			*/
			readyState: FileReader.EMPTY,
			
			/**
			Result of the successful read operation.

			@property result
			@type {String}
			*/
			result: null,
			
			/**
			Stores the error of failed asynchronous read operation.

			@property error
			@type {DOMError}
			*/
			error: null,
			
			/**
			Initiates reading of File/Blob object contents to binary string.

			@method readAsBinaryString
			@param {Blob|File} blob Object to preload
			*/
			readAsBinaryString: function(blob) {
				_read.call(this, 'readAsBinaryString', blob);
			},
			
			/**
			Initiates reading of File/Blob object contents to dataURL string.

			@method readAsDataURL
			@param {Blob|File} blob Object to preload
			*/
			readAsDataURL: function(blob) {
				_read.call(this, 'readAsDataURL', blob);
			},
			
			/**
			Initiates reading of File/Blob object contents to string.

			@method readAsText
			@param {Blob|File} blob Object to preload
			*/
			readAsText: function(blob) {
				_read.call(this, 'readAsText', blob);
			},
			
			/**
			Aborts preloading process.

			@method abort
			*/
			abort: function() {
				this.result = null;
				
				if (Basic.inArray(this.readyState, [FileReader.EMPTY, FileReader.DONE]) !== -1) {
					return;
				} else if (this.readyState === FileReader.LOADING) {
					this.readyState = FileReader.DONE;
				}

				this.exec('FileReader', 'abort');
				
				this.trigger('abort');
				this.trigger('loadend');
			},

			/**
			Destroy component and release resources.

			@method destroy
			*/
			destroy: function() {
				this.abort();
				this.exec('FileReader', 'destroy');
				this.disconnectRuntime();
				this.unbindAll();
			}
		});

		// uid must already be assigned
		this.handleEventProps(dispatches);

		this.bind('Error', function(e, err) {
			this.readyState = FileReader.DONE;
			this.error = err;
		}, 999);
		
		this.bind('Load', function(e) {
			this.readyState = FileReader.DONE;
		}, 999);

		
		function _read(op, blob) {
			var self = this;			

			this.trigger('loadstart');

			if (this.readyState === FileReader.LOADING) {
				this.trigger('error', new x.DOMException(x.DOMException.INVALID_STATE_ERR));
				this.trigger('loadend');
				return;
			}

			// if source is not o.Blob/o.File
			if (!(blob instanceof Blob)) {
				this.trigger('error', new x.DOMException(x.DOMException.NOT_FOUND_ERR));
				this.trigger('loadend');
				return;
			}

			this.result = null;
			this.readyState = FileReader.LOADING;
			
			if (blob.isDetached()) {
				var src = blob.getSource();
				switch (op) {
					case 'readAsText':
					case 'readAsBinaryString':
						this.result = src;
						break;
					case 'readAsDataURL':
						this.result = 'data:' + blob.type + ';base64,' + Encode.btoa(src);
						break;
				}
				this.readyState = FileReader.DONE;
				this.trigger('load');
				this.trigger('loadend');
			} else {
				this.connectRuntime(blob.ruid);
				this.exec('FileReader', 'read', op, blob);
			}
		}
	}
	
	/**
	Initial FileReader state

	@property EMPTY
	@type {Number}
	@final
	@static
	@default 0
	*/
	FileReader.EMPTY = 0;

	/**
	FileReader switches to this state when it is preloading the source

	@property LOADING
	@type {Number}
	@final
	@static
	@default 1
	*/
	FileReader.LOADING = 1;

	/**
	Preloading is complete, this is a final state

	@property DONE
	@type {Number}
	@final
	@static
	@default 2
	*/
	FileReader.DONE = 2;

	FileReader.prototype = EventTarget.instance;

	return FileReader;
});

// Included from: src/javascript/core/utils/Url.js

/**
 * Url.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/**
@class moxie/core/utils/Url
@public
@static
*/

define('moxie/core/utils/Url', [
	'moxie/core/utils/Basic'
], function(Basic) {
	/**
	Parse url into separate components and fill in absent parts with parts from current url,
	based on https://raw.github.com/kvz/phpjs/master/functions/url/parse_url.js

	@method parseUrl
	@static
	@param {String} url Url to parse (defaults to empty string if undefined)
	@return {Object} Hash containing extracted uri components
	*/
	var parseUrl = function(url, currentUrl) {
		var key = ['source', 'scheme', 'authority', 'userInfo', 'user', 'pass', 'host', 'port', 'relative', 'path', 'directory', 'file', 'query', 'fragment']
		, i = key.length
		, ports = {
			http: 80,
			https: 443
		}
		, uri = {}
		, regex = /^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@\/]*):?([^:@\/]*))?@)?(\[[\da-fA-F:]+\]|[^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/
		, m = regex.exec(url || '')
		, isRelative
		, isSchemeLess = /^\/\/\w/.test(url)
		;

		switch (Basic.typeOf(currentUrl)) {
			case 'undefined':
				currentUrl = parseUrl(document.location.href, false);
				break;

			case 'string':
				currentUrl = parseUrl(currentUrl, false);
				break;
		}

		while (i--) {
			if (m[i]) {
				uri[key[i]] = m[i];
			}
		}

		isRelative = !isSchemeLess && !uri.scheme;

		if (isSchemeLess || isRelative) {
			uri.scheme = currentUrl.scheme;
		}

		// when url is relative, we set the origin and the path ourselves
		if (isRelative) {
			uri.host = currentUrl.host;
			uri.port = currentUrl.port;

			var path = '';
			// for urls without trailing slash we need to figure out the path
			if (/^[^\/]/.test(uri.path)) {
				path = currentUrl.path;
				// if path ends with a filename, strip it
				if (/\/[^\/]*\.[^\/]*$/.test(path)) {
					path = path.replace(/\/[^\/]+$/, '/');
				} else {
					// avoid double slash at the end (see #127)
					path = path.replace(/\/?$/, '/');
				}
			}
			uri.path = path + (uri.path || ''); // site may reside at domain.com or domain.com/subdir
		}

		if (!uri.port) {
			uri.port = ports[uri.scheme] || 80;
		}

		uri.port = parseInt(uri.port, 10);

		if (!uri.path) {
			uri.path = "/";
		}

		delete uri.source;

		return uri;
	};

	/**
	Resolve url - among other things will turn relative url to absolute

	@method resolveUrl
	@static
	@param {String|Object} url Either absolute or relative, or a result of parseUrl call
	@return {String} Resolved, absolute url
	*/
	var resolveUrl = function(url) {
		var ports = { // we ignore default ports
			http: 80,
			https: 443
		}
		, urlp = typeof(url) === 'object' ? url : parseUrl(url);
		;

		return urlp.scheme + '://' + urlp.host + (urlp.port !== ports[urlp.scheme] ? ':' + urlp.port : '') + urlp.path + (urlp.query ? urlp.query : '');
	};

	/**
	Check if specified url has the same origin as the current document

	@method hasSameOrigin
	@static
	@param {String|Object} url
	@return {Boolean}
	*/
	var hasSameOrigin = function(url) {
		function origin(url) {
			return [url.scheme, url.host, url.port].join('/');
		}

		if (typeof url === 'string') {
			url = parseUrl(url);
		}

		return origin(parseUrl()) === origin(url);
	};

	return {
		parseUrl: parseUrl,
		resolveUrl: resolveUrl,
		hasSameOrigin: hasSameOrigin
	};
});

// Included from: src/javascript/runtime/RuntimeTarget.js

/**
 * RuntimeTarget.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

define('moxie/runtime/RuntimeTarget', [
	'moxie/core/utils/Basic',
	'moxie/runtime/RuntimeClient',
	"moxie/core/EventTarget"
], function(Basic, RuntimeClient, EventTarget) {
	/**
	Instance of this class can be used as a target for the events dispatched by shims,
	when allowing them onto components is for either reason inappropriate

	@class moxie/runtime/RuntimeTarget
	@constructor
	@protected
	@extends EventTarget
	*/
	function RuntimeTarget() {
		this.uid = Basic.guid('uid_');
		
		RuntimeClient.call(this);

		this.destroy = function() {
			this.disconnectRuntime();
			this.unbindAll();
		};
	}

	RuntimeTarget.prototype = EventTarget.instance;

	return RuntimeTarget;
});

// Included from: src/javascript/file/FileReaderSync.js

/**
 * FileReaderSync.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

define('moxie/file/FileReaderSync', [
	'moxie/core/utils/Basic',
	'moxie/runtime/RuntimeClient',
	'moxie/core/utils/Encode'
], function(Basic, RuntimeClient, Encode) {
	/**
	Synchronous FileReader implementation. Something like this is available in WebWorkers environment, here
	it can be used to read only preloaded blobs/files and only below certain size (not yet sure what that'd be,
	but probably < 1mb). Not meant to be used directly by user.

	@class moxie/file/FileReaderSync
	@private
	@constructor
	*/
	return function() {
		RuntimeClient.call(this);

		Basic.extend(this, {
			uid: Basic.guid('uid_'),

			readAsBinaryString: function(blob) {
				return _read.call(this, 'readAsBinaryString', blob);
			},
			
			readAsDataURL: function(blob) {
				return _read.call(this, 'readAsDataURL', blob);
			},
			
			/*readAsArrayBuffer: function(blob) {
				return _read.call(this, 'readAsArrayBuffer', blob);
			},*/
			
			readAsText: function(blob) {
				return _read.call(this, 'readAsText', blob);
			}
		});

		function _read(op, blob) {
			if (blob.isDetached()) {
				var src = blob.getSource();
				switch (op) {
					case 'readAsBinaryString':
						return src;
					case 'readAsDataURL':
						return 'data:' + blob.type + ';base64,' + Encode.btoa(src);
					case 'readAsText':
						var txt = '';
						for (var i = 0, length = src.length; i < length; i++) {
							txt += String.fromCharCode(src[i]);
						}
						return txt;
				}
			} else {
				var result = this.connectRuntime(blob.ruid).exec.call(this, 'FileReaderSync', 'read', op, blob);
				this.disconnectRuntime();
				return result;
			}
		}
	};
});

// Included from: src/javascript/xhr/FormData.js

/**
 * FormData.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

define("moxie/xhr/FormData", [
	"moxie/core/Exceptions",
	"moxie/core/utils/Basic",
	"moxie/file/Blob"
], function(x, Basic, Blob) {
	/**
	FormData

	@class moxie/xhr/FormData
	@constructor
	*/
	function FormData() {
		var _blob, _fields = [];

		Basic.extend(this, {
			/**
			Append another key-value pair to the FormData object

			@method append
			@param {String} name Name for the new field
			@param {String|Blob|Array|Object} value Value for the field
			*/
			append: function(name, value) {
				var self = this, valueType = Basic.typeOf(value);

				// according to specs value might be either Blob or String
				if (value instanceof Blob) {
					_blob = {
						name: name,
						value: value // unfortunately we can only send single Blob in one FormData
					};
				} else if ('array' === valueType) {
					name += '[]';

					Basic.each(value, function(value) {
						self.append(name, value);
					});
				} else if ('object' === valueType) {
					Basic.each(value, function(value, key) {
						self.append(name + '[' + key + ']', value);
					});
				} else if ('null' === valueType || 'undefined' === valueType || 'number' === valueType && isNaN(value)) {
					self.append(name, "false");
				} else {
					_fields.push({
						name: name,
						value: value.toString()
					});
				}
			},

			/**
			Checks if FormData contains Blob.

			@method hasBlob
			@return {Boolean}
			*/
			hasBlob: function() {
				return !!this.getBlob();
			},

			/**
			Retrieves blob.

			@method getBlob
			@return {Object} Either Blob if found or null
			*/
			getBlob: function() {
				return _blob && _blob.value || null;
			},

			/**
			Retrieves blob field name.

			@method getBlobName
			@return {String} Either Blob field name or null
			*/
			getBlobName: function() {
				return _blob && _blob.name || null;
			},

			/**
			Loop over the fields in FormData and invoke the callback for each of them.

			@method each
			@param {Function} cb Callback to call for each field
			*/
			each: function(cb) {
				Basic.each(_fields, function(field) {
					cb(field.value, field.name);
				});

				if (_blob) {
					cb(_blob.value, _blob.name);
				}
			},

			destroy: function() {
				_blob = null;
				_fields = [];
			}
		});
	}

	return FormData;
});

// Included from: src/javascript/xhr/XMLHttpRequest.js

/**
 * XMLHttpRequest.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

define("moxie/xhr/XMLHttpRequest", [
	"moxie/core/utils/Basic",
	"moxie/core/Exceptions",
	"moxie/core/EventTarget",
	"moxie/core/utils/Encode",
	"moxie/core/utils/Url",
	"moxie/runtime/Runtime",
	"moxie/runtime/RuntimeTarget",
	"moxie/file/Blob",
	"moxie/file/FileReaderSync",
	"moxie/xhr/FormData",
	"moxie/core/utils/Env",
	"moxie/core/utils/Mime"
], function(Basic, x, EventTarget, Encode, Url, Runtime, RuntimeTarget, Blob, FileReaderSync, FormData, Env, Mime) {

	var httpCode = {
		100: 'Continue',
		101: 'Switching Protocols',
		102: 'Processing',

		200: 'OK',
		201: 'Created',
		202: 'Accepted',
		203: 'Non-Authoritative Information',
		204: 'No Content',
		205: 'Reset Content',
		206: 'Partial Content',
		207: 'Multi-Status',
		226: 'IM Used',

		300: 'Multiple Choices',
		301: 'Moved Permanently',
		302: 'Found',
		303: 'See Other',
		304: 'Not Modified',
		305: 'Use Proxy',
		306: 'Reserved',
		307: 'Temporary Redirect',

		400: 'Bad Request',
		401: 'Unauthorized',
		402: 'Payment Required',
		403: 'Forbidden',
		404: 'Not Found',
		405: 'Method Not Allowed',
		406: 'Not Acceptable',
		407: 'Proxy Authentication Required',
		408: 'Request Timeout',
		409: 'Conflict',
		410: 'Gone',
		411: 'Length Required',
		412: 'Precondition Failed',
		413: 'Request Entity Too Large',
		414: 'Request-URI Too Long',
		415: 'Unsupported Media Type',
		416: 'Requested Range Not Satisfiable',
		417: 'Expectation Failed',
		422: 'Unprocessable Entity',
		423: 'Locked',
		424: 'Failed Dependency',
		426: 'Upgrade Required',

		500: 'Internal Server Error',
		501: 'Not Implemented',
		502: 'Bad Gateway',
		503: 'Service Unavailable',
		504: 'Gateway Timeout',
		505: 'HTTP Version Not Supported',
		506: 'Variant Also Negotiates',
		507: 'Insufficient Storage',
		510: 'Not Extended'
	};

	function XMLHttpRequestUpload() {
		this.uid = Basic.guid('uid_');
	}

	XMLHttpRequestUpload.prototype = EventTarget.instance;

	/**
	Implementation of XMLHttpRequest

	@class moxie/xhr/XMLHttpRequest
	@constructor
	@uses RuntimeClient
	@extends EventTarget
	*/
	var dispatches = [
		'loadstart',

		'progress',

		'abort',

		'error',

		'load',

		'timeout',

		'loadend'

		// readystatechange (for historical reasons)
	];

	var NATIVE = 1, RUNTIME = 2;

	function XMLHttpRequest() {
		var self = this,
			// this (together with _p() @see below) is here to gracefully upgrade to setter/getter syntax where possible
			props = {
				/**
				The amount of milliseconds a request can take before being terminated. Initially zero. Zero means there is no timeout.

				@property timeout
				@type Number
				@default 0
				*/
				timeout: 0,

				/**
				Current state, can take following values:
				UNSENT (numeric value 0)
				The object has been constructed.

				OPENED (numeric value 1)
				The open() method has been successfully invoked. During this state request headers can be set using setRequestHeader() and the request can be made using the send() method.

				HEADERS_RECEIVED (numeric value 2)
				All redirects (if any) have been followed and all HTTP headers of the final response have been received. Several response members of the object are now available.

				LOADING (numeric value 3)
				The response entity body is being received.

				DONE (numeric value 4)

				@property readyState
				@type Number
				@default 0 (UNSENT)
				*/
				readyState: XMLHttpRequest.UNSENT,

				/**
				True when user credentials are to be included in a cross-origin request. False when they are to be excluded
				in a cross-origin request and when cookies are to be ignored in its response. Initially false.

				@property withCredentials
				@type Boolean
				@default false
				*/
				withCredentials: false,

				/**
				Returns the HTTP status code.

				@property status
				@type Number
				@default 0
				*/
				status: 0,

				/**
				Returns the HTTP status text.

				@property statusText
				@type String
				*/
				statusText: "",

				/**
				Returns the response type. Can be set to change the response type. Values are:
				the empty string (default), "arraybuffer", "blob", "document", "json", and "text".

				@property responseType
				@type String
				*/
				responseType: "",

				/**
				Returns the document response entity body.

				Throws an "InvalidStateError" exception if responseType is not the empty string or "document".

				@property responseXML
				@type Document
				*/
				responseXML: null,

				/**
				Returns the text response entity body.

				Throws an "InvalidStateError" exception if responseType is not the empty string or "text".

				@property responseText
				@type String
				*/
				responseText: null,

				/**
				Returns the response entity body (http://www.w3.org/TR/XMLHttpRequest/#response-entity-body).
				Can become: ArrayBuffer, Blob, Document, JSON, Text

				@property response
				@type Mixed
				*/
				response: null
			},

			_async = true,
			_url,
			_method,
			_headers = {},
			_user,
			_password,
			_encoding = null,
			_mimeType = null,

			// flags
			_sync_flag = false,
			_send_flag = false,
			_upload_events_flag = false,
			_upload_complete_flag = false,
			_error_flag = false,
			_same_origin_flag = false,

			// times
			_start_time,
			_timeoutset_time,

			_finalMime = null,
			_finalCharset = null,

			_options = {},
			_xhr,
			_responseHeaders = '',
			_responseHeadersBag
			;


		Basic.extend(this, props, {
			/**
			Unique id of the component

			@property uid
			@type String
			*/
			uid: Basic.guid('uid_'),

			/**
			Target for Upload events

			@property upload
			@type XMLHttpRequestUpload
			*/
			upload: new XMLHttpRequestUpload(),


			/**
			Sets the request method, request URL, synchronous flag, request username, and request password.

			Throws a "SyntaxError" exception if one of the following is true:

			method is not a valid HTTP method.
			url cannot be resolved.
			url contains the "user:password" format in the userinfo production.
			Throws a "SecurityError" exception if method is a case-insensitive match for CONNECT, TRACE or TRACK.

			Throws an "InvalidAccessError" exception if one of the following is true:

			Either user or password is passed as argument and the origin of url does not match the XMLHttpRequest origin.
			There is an associated XMLHttpRequest document and either the timeout attribute is not zero,
			the withCredentials attribute is true, or the responseType attribute is not the empty string.


			@method open
			@param {String} method HTTP method to use on request
			@param {String} url URL to request
			@param {Boolean} [async=true] If false request will be done in synchronous manner. Asynchronous by default.
			@param {String} [user] Username to use in HTTP authentication process on server-side
			@param {String} [password] Password to use in HTTP authentication process on server-side
			*/
			open: function(method, url, async, user, password) {
				var urlp;

				// first two arguments are required
				if (!method || !url) {
					throw new x.DOMException(x.DOMException.SYNTAX_ERR);
				}

				// 2 - check if any code point in method is higher than U+00FF or after deflating method it does not match the method
				if (/[\u0100-\uffff]/.test(method) || Encode.utf8_encode(method) !== method) {
					throw new x.DOMException(x.DOMException.SYNTAX_ERR);
				}

				// 3
				if (!!~Basic.inArray(method.toUpperCase(), ['CONNECT', 'DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT', 'TRACE', 'TRACK'])) {
					_method = method.toUpperCase();
				}


				// 4 - allowing these methods poses a security risk
				if (!!~Basic.inArray(_method, ['CONNECT', 'TRACE', 'TRACK'])) {
					throw new x.DOMException(x.DOMException.SECURITY_ERR);
				}

				// 5
				url = Encode.utf8_encode(url);

				// 6 - Resolve url relative to the XMLHttpRequest base URL. If the algorithm returns an error, throw a "SyntaxError".
				urlp = Url.parseUrl(url);

				_same_origin_flag = Url.hasSameOrigin(urlp);

				// 7 - manually build up absolute url
				_url = Url.resolveUrl(url);

				// 9-10, 12-13
				if ((user || password) && !_same_origin_flag) {
					throw new x.DOMException(x.DOMException.INVALID_ACCESS_ERR);
				}

				_user = user || urlp.user;
				_password = password || urlp.pass;

				// 11
				_async = async || true;

				if (_async === false && (_p('timeout') || _p('withCredentials') || _p('responseType') !== "")) {
					throw new x.DOMException(x.DOMException.INVALID_ACCESS_ERR);
				}

				// 14 - terminate abort()

				// 15 - terminate send()

				// 18
				_sync_flag = !_async;
				_send_flag = false;
				_headers = {};
				_reset.call(this);

				// 19
				_p('readyState', XMLHttpRequest.OPENED);

				// 20
				this.dispatchEvent('readystatechange');
			},

			/**
			Appends an header to the list of author request headers, or if header is already
			in the list of author request headers, combines its value with value.

			Throws an "InvalidStateError" exception if the state is not OPENED or if the send() flag is set.
			Throws a "SyntaxError" exception if header is not a valid HTTP header field name or if value
			is not a valid HTTP header field value.

			@method setRequestHeader
			@param {String} header
			@param {String|Number} value
			*/
			setRequestHeader: function(header, value) {
				var uaHeaders = [ // these headers are controlled by the user agent
						"accept-charset",
						"accept-encoding",
						"access-control-request-headers",
						"access-control-request-method",
						"connection",
						"content-length",
						"cookie",
						"cookie2",
						"content-transfer-encoding",
						"date",
						"expect",
						"host",
						"keep-alive",
						"origin",
						"referer",
						"te",
						"trailer",
						"transfer-encoding",
						"upgrade",
						"user-agent",
						"via"
					];

				// 1-2
				if (_p('readyState') !== XMLHttpRequest.OPENED || _send_flag) {
					throw new x.DOMException(x.DOMException.INVALID_STATE_ERR);
				}

				// 3
				if (/[\u0100-\uffff]/.test(header) || Encode.utf8_encode(header) !== header) {
					throw new x.DOMException(x.DOMException.SYNTAX_ERR);
				}

				// 4
				/* this step is seemingly bypassed in browsers, probably to allow various unicode characters in header values
				if (/[\u0100-\uffff]/.test(value) || Encode.utf8_encode(value) !== value) {
					throw new x.DOMException(x.DOMException.SYNTAX_ERR);
				}*/

				header = Basic.trim(header).toLowerCase();

				// setting of proxy-* and sec-* headers is prohibited by spec
				if (!!~Basic.inArray(header, uaHeaders) || /^(proxy\-|sec\-)/.test(header)) {
					return false;
				}

				// camelize
				// browsers lowercase header names (at least for custom ones)
				// header = header.replace(/\b\w/g, function($1) { return $1.toUpperCase(); });

				if (!_headers[header]) {
					_headers[header] = value;
				} else {
					// http://tools.ietf.org/html/rfc2616#section-4.2 (last paragraph)
					_headers[header] += ', ' + value;
				}
				return true;
			},

			/**
			 * Test if the specified header is already set on this request.
			 * Returns a header value or boolean false if it's not yet set.
			 *
			 * @method hasRequestHeader
			 * @param {String} header Name of the header to test
			 * @return {Boolean|String}
			 */
			hasRequestHeader: function(header) {
				return header && _headers[header.toLowerCase()] || false;
			},

			/**
			Returns all headers from the response, with the exception of those whose field name is Set-Cookie or Set-Cookie2.

			@method getAllResponseHeaders
			@return {String} reponse headers or empty string
			*/
			getAllResponseHeaders: function() {
				return _responseHeaders || '';
			},

			/**
			Returns the header field value from the response of which the field name matches header,
			unless the field name is Set-Cookie or Set-Cookie2.

			@method getResponseHeader
			@param {String} header
			@return {String} value(s) for the specified header or null
			*/
			getResponseHeader: function(header) {
				header = header.toLowerCase();

				if (_error_flag || !!~Basic.inArray(header, ['set-cookie', 'set-cookie2'])) {
					return null;
				}

				if (_responseHeaders && _responseHeaders !== '') {
					// if we didn't parse response headers until now, do it and keep for later
					if (!_responseHeadersBag) {
						_responseHeadersBag = {};
						Basic.each(_responseHeaders.split(/\r\n/), function(line) {
							var pair = line.split(/:\s+/);
							if (pair.length === 2) { // last line might be empty, omit
								pair[0] = Basic.trim(pair[0]); // just in case
								_responseHeadersBag[pair[0].toLowerCase()] = { // simply to retain header name in original form
									header: pair[0],
									value: Basic.trim(pair[1])
								};
							}
						});
					}
					if (_responseHeadersBag.hasOwnProperty(header)) {
						return _responseHeadersBag[header].header + ': ' + _responseHeadersBag[header].value;
					}
				}
				return null;
			},

			/**
			Sets the Content-Type header for the response to mime.
			Throws an "InvalidStateError" exception if the state is LOADING or DONE.
			Throws a "SyntaxError" exception if mime is not a valid media type.

			@method overrideMimeType
			@param String mime Mime type to set
			*/
			overrideMimeType: function(mime) {
				var matches, charset;

				// 1
				if (!!~Basic.inArray(_p('readyState'), [XMLHttpRequest.LOADING, XMLHttpRequest.DONE])) {
					throw new x.DOMException(x.DOMException.INVALID_STATE_ERR);
				}

				// 2
				mime = Basic.trim(mime.toLowerCase());

				if (/;/.test(mime) && (matches = mime.match(/^([^;]+)(?:;\scharset\=)?(.*)$/))) {
					mime = matches[1];
					if (matches[2]) {
						charset = matches[2];
					}
				}

				if (!Mime.mimes[mime]) {
					throw new x.DOMException(x.DOMException.SYNTAX_ERR);
				}

				// 3-4
				_finalMime = mime;
				_finalCharset = charset;
			},

			/**
			Initiates the request. The optional argument provides the request entity body.
			The argument is ignored if request method is GET or HEAD.

			Throws an "InvalidStateError" exception if the state is not OPENED or if the send() flag is set.

			@method send
			@param {Blob|Document|String|FormData} [data] Request entity body
			@param {Object} [options] Set of requirements and pre-requisities for runtime initialization
			*/
			send: function(data, options) {
				if (Basic.typeOf(options) === 'string') {
					_options = { ruid: options };
				} else if (!options) {
					_options = {};
				} else {
					_options = options;
				}

				// 1-2
				if (this.readyState !== XMLHttpRequest.OPENED || _send_flag) {
					throw new x.DOMException(x.DOMException.INVALID_STATE_ERR);
				}

				// 3
				// sending Blob
				if (data instanceof Blob) {
					_options.ruid = data.ruid;
					_mimeType = data.type || 'application/octet-stream';
				}

				// FormData
				else if (data instanceof FormData) {
					if (data.hasBlob()) {
						var blob = data.getBlob();
						_options.ruid = blob.ruid;
						_mimeType = blob.type || 'application/octet-stream';
					}
				}

				// DOMString
				else if (typeof data === 'string') {
					_encoding = 'UTF-8';
					_mimeType = 'text/plain;charset=UTF-8';

					// data should be converted to Unicode and encoded as UTF-8
					data = Encode.utf8_encode(data);
				}

				// if withCredentials not set, but requested, set it automatically
				if (!this.withCredentials) {
					this.withCredentials = (_options.required_caps && _options.required_caps.send_browser_cookies) && !_same_origin_flag;
				}

				// 4 - storage mutex
				// 5
				_upload_events_flag = (!_sync_flag && this.upload.hasEventListener()); // DSAP
				// 6
				_error_flag = false;
				// 7
				_upload_complete_flag = !data;
				// 8 - Asynchronous steps
				if (!_sync_flag) {
					// 8.1
					_send_flag = true;
					// 8.2
					// this.dispatchEvent('loadstart'); // will be dispatched either by native or runtime xhr
					// 8.3
					//if (!_upload_complete_flag) {
						// this.upload.dispatchEvent('loadstart');	// will be dispatched either by native or runtime xhr
					//}
				}
				// 8.5 - Return the send() method call, but continue running the steps in this algorithm.
				_doXHR.call(this, data);
			},

			/**
			Cancels any network activity.

			@method abort
			*/
			abort: function() {
				_error_flag = true;
				_sync_flag = false;

				if (!~Basic.inArray(_p('readyState'), [XMLHttpRequest.UNSENT, XMLHttpRequest.OPENED, XMLHttpRequest.DONE])) {
					_p('readyState', XMLHttpRequest.DONE);
					_send_flag = false;

					if (_xhr) {
						_xhr.getRuntime().exec.call(_xhr, 'XMLHttpRequest', 'abort', _upload_complete_flag);
					} else {
						throw new x.DOMException(x.DOMException.INVALID_STATE_ERR);
					}

					_upload_complete_flag = true;
				} else {
					_p('readyState', XMLHttpRequest.UNSENT);
				}
			},

			destroy: function() {
				if (_xhr) {
					if (Basic.typeOf(_xhr.destroy) === 'function') {
						_xhr.destroy();
					}
					_xhr = null;
				}

				this.unbindAll();

				if (this.upload) {
					this.upload.unbindAll();
					this.upload = null;
				}
			}
		});

		this.handleEventProps(dispatches.concat(['readystatechange'])); // for historical reasons
		this.upload.handleEventProps(dispatches);

		/* this is nice, but maybe too lengthy

		// if supported by JS version, set getters/setters for specific properties
		o.defineProperty(this, 'readyState', {
			configurable: false,

			get: function() {
				return _p('readyState');
			}
		});

		o.defineProperty(this, 'timeout', {
			configurable: false,

			get: function() {
				return _p('timeout');
			},

			set: function(value) {

				if (_sync_flag) {
					throw new x.DOMException(x.DOMException.INVALID_ACCESS_ERR);
				}

				// timeout still should be measured relative to the start time of request
				_timeoutset_time = (new Date).getTime();

				_p('timeout', value);
			}
		});

		// the withCredentials attribute has no effect when fetching same-origin resources
		o.defineProperty(this, 'withCredentials', {
			configurable: false,

			get: function() {
				return _p('withCredentials');
			},

			set: function(value) {
				// 1-2
				if (!~o.inArray(_p('readyState'), [XMLHttpRequest.UNSENT, XMLHttpRequest.OPENED]) || _send_flag) {
					throw new x.DOMException(x.DOMException.INVALID_STATE_ERR);
				}

				// 3-4
				if (_anonymous_flag || _sync_flag) {
					throw new x.DOMException(x.DOMException.INVALID_ACCESS_ERR);
				}

				// 5
				_p('withCredentials', value);
			}
		});

		o.defineProperty(this, 'status', {
			configurable: false,

			get: function() {
				return _p('status');
			}
		});

		o.defineProperty(this, 'statusText', {
			configurable: false,

			get: function() {
				return _p('statusText');
			}
		});

		o.defineProperty(this, 'responseType', {
			configurable: false,

			get: function() {
				return _p('responseType');
			},

			set: function(value) {
				// 1
				if (!!~o.inArray(_p('readyState'), [XMLHttpRequest.LOADING, XMLHttpRequest.DONE])) {
					throw new x.DOMException(x.DOMException.INVALID_STATE_ERR);
				}

				// 2
				if (_sync_flag) {
					throw new x.DOMException(x.DOMException.INVALID_ACCESS_ERR);
				}

				// 3
				_p('responseType', value.toLowerCase());
			}
		});

		o.defineProperty(this, 'responseText', {
			configurable: false,

			get: function() {
				// 1
				if (!~o.inArray(_p('responseType'), ['', 'text'])) {
					throw new x.DOMException(x.DOMException.INVALID_STATE_ERR);
				}

				// 2-3
				if (_p('readyState') !== XMLHttpRequest.DONE && _p('readyState') !== XMLHttpRequest.LOADING || _error_flag) {
					throw new x.DOMException(x.DOMException.INVALID_STATE_ERR);
				}

				return _p('responseText');
			}
		});

		o.defineProperty(this, 'responseXML', {
			configurable: false,

			get: function() {
				// 1
				if (!~o.inArray(_p('responseType'), ['', 'document'])) {
					throw new x.DOMException(x.DOMException.INVALID_STATE_ERR);
				}

				// 2-3
				if (_p('readyState') !== XMLHttpRequest.DONE || _error_flag) {
					throw new x.DOMException(x.DOMException.INVALID_STATE_ERR);
				}

				return _p('responseXML');
			}
		});

		o.defineProperty(this, 'response', {
			configurable: false,

			get: function() {
				if (!!~o.inArray(_p('responseType'), ['', 'text'])) {
					if (_p('readyState') !== XMLHttpRequest.DONE && _p('readyState') !== XMLHttpRequest.LOADING || _error_flag) {
						return '';
					}
				}

				if (_p('readyState') !== XMLHttpRequest.DONE || _error_flag) {
					return null;
				}

				return _p('response');
			}
		});

		*/

		function _p(prop, value) {
			if (!props.hasOwnProperty(prop)) {
				return;
			}
			if (arguments.length === 1) { // get
				return Env.can('define_property') ? props[prop] : self[prop];
			} else { // set
				if (Env.can('define_property')) {
					props[prop] = value;
				} else {
					self[prop] = value;
				}
			}
		}

		/*
		function _toASCII(str, AllowUnassigned, UseSTD3ASCIIRules) {
			// TODO: http://tools.ietf.org/html/rfc3490#section-4.1
			return str.toLowerCase();
		}
		*/


		function _doXHR(data) {
			var self = this;

			_start_time = new Date().getTime();

			_xhr = new RuntimeTarget();

			function loadEnd() {
				if (_xhr) { // it could have been destroyed by now
					_xhr.destroy();
					_xhr = null;
				}
				self.dispatchEvent('loadend');
				self = null;
			}

			function exec(runtime) {
				_xhr.bind('LoadStart', function(e) {
					_p('readyState', XMLHttpRequest.LOADING);
					self.dispatchEvent('readystatechange');

					self.dispatchEvent(e);

					if (_upload_events_flag) {
						self.upload.dispatchEvent(e);
					}
				});

				_xhr.bind('Progress', function(e) {
					if (_p('readyState') !== XMLHttpRequest.LOADING) {
						_p('readyState', XMLHttpRequest.LOADING); // LoadStart unreliable (in Flash for example)
						self.dispatchEvent('readystatechange');
					}
					self.dispatchEvent(e);
				});

				_xhr.bind('UploadProgress', function(e) {
					if (_upload_events_flag) {
						self.upload.dispatchEvent({
							type: 'progress',
							lengthComputable: false,
							total: e.total,
							loaded: e.loaded
						});
					}
				});

				_xhr.bind('Load', function(e) {
					_p('readyState', XMLHttpRequest.DONE);
					_p('status', Number(runtime.exec.call(_xhr, 'XMLHttpRequest', 'getStatus') || 0));
					_p('statusText', httpCode[_p('status')] || "");

					_p('response', runtime.exec.call(_xhr, 'XMLHttpRequest', 'getResponse', _p('responseType')));

					if (!!~Basic.inArray(_p('responseType'), ['text', ''])) {
						_p('responseText', _p('response'));
					} else if (_p('responseType') === 'document') {
						_p('responseXML', _p('response'));
					}

					_responseHeaders = runtime.exec.call(_xhr, 'XMLHttpRequest', 'getAllResponseHeaders');

					self.dispatchEvent('readystatechange');

					if (_p('status') > 0) { // status 0 usually means that server is unreachable
						if (_upload_events_flag) {
							self.upload.dispatchEvent(e);
						}
						self.dispatchEvent(e);
					} else {
						_error_flag = true;
						self.dispatchEvent('error');
					}
					loadEnd();
				});

				_xhr.bind('Abort', function(e) {
					self.dispatchEvent(e);
					loadEnd();
				});

				_xhr.bind('Error', function(e) {
					_error_flag = true;
					_p('readyState', XMLHttpRequest.DONE);
					self.dispatchEvent('readystatechange');
					_upload_complete_flag = true;
					self.dispatchEvent(e);
					loadEnd();
				});

				runtime.exec.call(_xhr, 'XMLHttpRequest', 'send', {
					url: _url,
					method: _method,
					async: _async,
					user: _user,
					password: _password,
					headers: _headers,
					mimeType: _mimeType,
					encoding: _encoding,
					responseType: self.responseType,
					withCredentials: self.withCredentials,
					options: _options
				}, data);
			}

			// clarify our requirements
			if (typeof(_options.required_caps) === 'string') {
				_options.required_caps = Runtime.parseCaps(_options.required_caps);
			}

			_options.required_caps = Basic.extend({}, _options.required_caps, {
				return_response_type: self.responseType
			});

			if (data instanceof FormData) {
				_options.required_caps.send_multipart = true;
			}

			if (!Basic.isEmptyObj(_headers)) {
				_options.required_caps.send_custom_headers = true;
			}

			if (!_same_origin_flag) {
				_options.required_caps.do_cors = true;
			}


			if (_options.ruid) { // we do not need to wait if we can connect directly
				exec(_xhr.connectRuntime(_options));
			} else {
				_xhr.bind('RuntimeInit', function(e, runtime) {
					exec(runtime);
				});
				_xhr.bind('RuntimeError', function(e, err) {
					self.dispatchEvent('RuntimeError', err);
				});
				_xhr.connectRuntime(_options);
			}
		}


		function _reset() {
			_p('responseText', "");
			_p('responseXML', null);
			_p('response', null);
			_p('status', 0);
			_p('statusText', "");
			_start_time = _timeoutset_time = null;
		}
	}

	XMLHttpRequest.UNSENT = 0;
	XMLHttpRequest.OPENED = 1;
	XMLHttpRequest.HEADERS_RECEIVED = 2;
	XMLHttpRequest.LOADING = 3;
	XMLHttpRequest.DONE = 4;

	XMLHttpRequest.prototype = EventTarget.instance;

	return XMLHttpRequest;
});

// Included from: src/javascript/runtime/Transporter.js

/**
 * Transporter.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

define("moxie/runtime/Transporter", [
	"moxie/core/utils/Basic",
	"moxie/core/utils/Encode",
	"moxie/runtime/RuntimeClient",
	"moxie/core/EventTarget"
], function(Basic, Encode, RuntimeClient, EventTarget) {

	/**
	@class moxie/runtime/Transporter
	@private
	@constructor
	*/
	function Transporter() {
		var mod, _runtime, _data, _size, _pos, _chunk_size;

		RuntimeClient.call(this);

		Basic.extend(this, {
			uid: Basic.guid('uid_'),

			state: Transporter.IDLE,

			result: null,

			transport: function(data, type, options) {
				var self = this;

				options = Basic.extend({
					chunk_size: 204798
				}, options);

				// should divide by three, base64 requires this
				if ((mod = options.chunk_size % 3)) {
					options.chunk_size += 3 - mod;
				}

				_chunk_size = options.chunk_size;

				_reset.call(this);
				_data = data;
				_size = data.length;

				if (Basic.typeOf(options) === 'string' || options.ruid) {
					_run.call(self, type, this.connectRuntime(options));
				} else {
					// we require this to run only once
					var cb = function(e, runtime) {
						self.unbind("RuntimeInit", cb);
						_run.call(self, type, runtime);
					};
					this.bind("RuntimeInit", cb);
					this.connectRuntime(options);
				}
			},

			abort: function() {
				var self = this;

				self.state = Transporter.IDLE;
				if (_runtime) {
					_runtime.exec.call(self, 'Transporter', 'clear');
					self.trigger("TransportingAborted");
				}

				_reset.call(self);
			},


			destroy: function() {
				this.unbindAll();
				_runtime = null;
				this.disconnectRuntime();
				_reset.call(this);
			}
		});

		function _reset() {
			_size = _pos = 0;
			_data = this.result = null;
		}

		function _run(type, runtime) {
			var self = this;

			_runtime = runtime;

			//self.unbind("RuntimeInit");

			self.bind("TransportingProgress", function(e) {
				_pos = e.loaded;

				if (_pos < _size && Basic.inArray(self.state, [Transporter.IDLE, Transporter.DONE]) === -1) {
					_transport.call(self);
				}
			}, 999);

			self.bind("TransportingComplete", function() {
				_pos = _size;
				self.state = Transporter.DONE;
				_data = null; // clean a bit
				self.result = _runtime.exec.call(self, 'Transporter', 'getAsBlob', type || '');
			}, 999);

			self.state = Transporter.BUSY;
			self.trigger("TransportingStarted");
			_transport.call(self);
		}

		function _transport() {
			var self = this,
				chunk,
				bytesLeft = _size - _pos;

			if (_chunk_size > bytesLeft) {
				_chunk_size = bytesLeft;
			}

			chunk = Encode.btoa(_data.substr(_pos, _chunk_size));
			_runtime.exec.call(self, 'Transporter', 'receive', chunk, _size);
		}
	}

	Transporter.IDLE = 0;
	Transporter.BUSY = 1;
	Transporter.DONE = 2;

	Transporter.prototype = EventTarget.instance;

	return Transporter;
});

// Included from: src/javascript/image/Image.js

/**
 * Image.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

define("moxie/image/Image", [
	"moxie/core/utils/Basic",
	"moxie/core/utils/Dom",
	"moxie/core/Exceptions",
	"moxie/file/FileReaderSync",
	"moxie/xhr/XMLHttpRequest",
	"moxie/runtime/Runtime",
	"moxie/runtime/RuntimeClient",
	"moxie/runtime/Transporter",
	"moxie/core/utils/Env",
	"moxie/core/EventTarget",
	"moxie/file/Blob",
	"moxie/file/File",
	"moxie/core/utils/Encode"
], function(Basic, Dom, x, FileReaderSync, XMLHttpRequest, Runtime, RuntimeClient, Transporter, Env, EventTarget, Blob, File, Encode) {
	/**
	Image preloading and manipulation utility. Additionally it provides access to image meta info (Exif, GPS) and raw binary data.

	@class moxie/image/Image
	@constructor
	@extends EventTarget
	*/
	var dispatches = [
		'progress',

		/**
		Dispatched when loading is complete.

		@event load
		@param {Object} event
		*/
		'load',

		'error',

		/**
		Dispatched when resize operation is complete.

		@event resize
		@param {Object} event
		*/
		'resize',

		/**
		Dispatched when visual representation of the image is successfully embedded
		into the corresponsing container.

		@event embedded
		@param {Object} event
		*/
		'embedded'
	];

	function Image() {

		RuntimeClient.call(this);

		Basic.extend(this, {
			/**
			Unique id of the component

			@property uid
			@type {String}
			*/
			uid: Basic.guid('uid_'),

			/**
			Unique id of the connected runtime, if any.

			@property ruid
			@type {String}
			*/
			ruid: null,

			/**
			Name of the file, that was used to create an image, if available. If not equals to empty string.

			@property name
			@type {String}
			@default ""
			*/
			name: "",

			/**
			Size of the image in bytes. Actual value is set only after image is preloaded.

			@property size
			@type {Number}
			@default 0
			*/
			size: 0,

			/**
			Width of the image. Actual value is set only after image is preloaded.

			@property width
			@type {Number}
			@default 0
			*/
			width: 0,

			/**
			Height of the image. Actual value is set only after image is preloaded.

			@property height
			@type {Number}
			@default 0
			*/
			height: 0,

			/**
			Mime type of the image. Currently only image/jpeg and image/png are supported. Actual value is set only after image is preloaded.

			@property type
			@type {String}
			@default ""
			*/
			type: "",

			/**
			Holds meta info (Exif, GPS). Is populated only for image/jpeg. Actual value is set only after image is preloaded.

			@property meta
			@type {Object}
			@default {}
			*/
			meta: {},

			/**
			Alias for load method, that takes another moxie.image.Image object as a source (see load).

			@method clone
			@param {Image} src Source for the image
			@param {Boolean} [exact=false] Whether to activate in-depth clone mode
			*/
			clone: function() {
				this.load.apply(this, arguments);
			},

			/**
			Loads image from various sources. Currently the source for new image can be: moxie.image.Image,
			moxie.file.Blob/moxie.file.File, native Blob/File, dataUrl or URL. Depending on the type of the
			source, arguments - differ. When source is URL, Image will be downloaded from remote destination
			and loaded in memory.

			@example
				var img = new moxie.image.Image();
				img.onload = function() {
					var blob = img.getAsBlob();

					var formData = new moxie.xhr.FormData();
					formData.append('file', blob);

					var xhr = new moxie.xhr.XMLHttpRequest();
					xhr.onload = function() {
						// upload complete
					};
					xhr.open('post', 'upload.php');
					xhr.send(formData);
				};
				img.load("http://www.moxiecode.com/images/mox-logo.jpg"); // notice file extension (.jpg)


			@method load
			@param {Image|Blob|File|String} src Source for the image
			@param {Boolean|Object} [mixed]
			*/
			load: function() {
				_load.apply(this, arguments);
			},


			/**
			Resizes the image to fit the specified width/height. If crop is specified, image will also be
			cropped to the exact dimensions.

			@method resize
			@since 3.0
			@param {Object} options
				@param {Number} options.width Resulting width
				@param {Number} [options.height=width] Resulting height (optional, if not supplied will default to width)
				@param {String} [options.type='image/jpeg'] MIME type of the resulting image
				@param {Number} [options.quality=90] In the case of JPEG, controls the quality of resulting image
				@param {Boolean} [options.crop='cc'] If not falsy, image will be cropped, by default from center
				@param {Boolean} [options.fit=true] Whether to upscale the image to fit the exact dimensions
				@param {Boolean} [options.preserveHeaders=true] Whether to preserve meta headers (on JPEGs after resize)
				@param {String} [options.resample='default'] Resampling algorithm to use during resize
				@param {Boolean} [options.multipass=true] Whether to scale the image in steps (results in better quality)
			*/
			resize: function(options) {
				var self = this;
				var orientation;
				var scale;

				var srcRect = {
					x: 0,
					y: 0,
					width: self.width,
					height: self.height
				};

				var opts = Basic.extendIf({
					width: self.width,
					height: self.height,
					type: self.type || 'image/jpeg',
					quality: 90,
					crop: false,
					fit: true,
					preserveHeaders: true,
					resample: 'default',
					multipass: true
				}, options);

				try {
					if (!self.size) { // only preloaded image objects can be used as source
						throw new x.DOMException(x.DOMException.INVALID_STATE_ERR);
					}

					// no way to reliably intercept the crash due to high resolution, so we simply avoid it
					if (self.width > Image.MAX_RESIZE_WIDTH || self.height > Image.MAX_RESIZE_HEIGHT) {
						throw new x.ImageError(x.ImageError.MAX_RESOLUTION_ERR);
					}

					// take into account orientation tag
					orientation = (self.meta && self.meta.tiff && self.meta.tiff.Orientation) || 1;

					if (Basic.inArray(orientation, [5,6,7,8]) !== -1) { // values that require 90 degree rotation
						var tmp = opts.width;
						opts.width = opts.height;
						opts.height = tmp;
					}

					if (opts.crop) {
						scale = Math.max(opts.width/self.width, opts.height/self.height);

						if (options.fit) {
							// first scale it up or down to fit the original image
							srcRect.width = Math.min(Math.ceil(opts.width/scale), self.width);
							srcRect.height = Math.min(Math.ceil(opts.height/scale), self.height);

							// recalculate the scale for adapted dimensions
							scale = opts.width/srcRect.width;
						} else {
							srcRect.width = Math.min(opts.width, self.width);
							srcRect.height = Math.min(opts.height, self.height);

							// now we do not need to scale it any further
							scale = 1;
						}

						if (typeof(opts.crop) === 'boolean') {
							opts.crop = 'cc';
						}

						switch (opts.crop.toLowerCase().replace(/_/, '-')) {
							case 'rb':
							case 'right-bottom':
								srcRect.x = self.width - srcRect.width;
								srcRect.y = self.height - srcRect.height;
								break;

							case 'cb':
							case 'center-bottom':
								srcRect.x = Math.floor((self.width - srcRect.width) / 2);
								srcRect.y = self.height - srcRect.height;
								break;

							case 'lb':
							case 'left-bottom':
								srcRect.x = 0;
								srcRect.y = self.height - srcRect.height;
								break;

							case 'lt':
							case 'left-top':
								srcRect.x = 0;
								srcRect.y = 0;
								break;

							case 'ct':
							case 'center-top':
								srcRect.x = Math.floor((self.width - srcRect.width) / 2);
								srcRect.y = 0;
								break;

							case 'rt':
							case 'right-top':
								srcRect.x = self.width - srcRect.width;
								srcRect.y = 0;
								break;

							case 'rc':
							case 'right-center':
							case 'right-middle':
								srcRect.x = self.width - srcRect.width;
								srcRect.y = Math.floor((self.height - srcRect.height) / 2);
								break;


							case 'lc':
							case 'left-center':
							case 'left-middle':
								srcRect.x = 0;
								srcRect.y = Math.floor((self.height - srcRect.height) / 2);
								break;

							case 'cc':
							case 'center-center':
							case 'center-middle':
							default:
								srcRect.x = Math.floor((self.width - srcRect.width) / 2);
								srcRect.y = Math.floor((self.height - srcRect.height) / 2);
						}

						// original image might be smaller than requested crop, so - avoid negative values
						srcRect.x = Math.max(srcRect.x, 0);
						srcRect.y = Math.max(srcRect.y, 0);
					} else {
						scale = Math.min(opts.width/self.width, opts.height/self.height);

						// do not upscale if we were asked to not fit it
						if (scale > 1 && !opts.fit) {
							scale = 1;
						}
					}

					this.exec('Image', 'resize', srcRect, scale, opts);
				} catch(ex) {
					// for now simply trigger error event
					self.trigger('error', ex.code);
				}
			},

			/**
			Downsizes the image to fit the specified width/height. If crop is supplied, image will be cropped to exact dimensions.

			@method downsize
			@deprecated use resize()
			*/
			downsize: function(options) {
				var defaults = {
					width: this.width,
					height: this.height,
					type: this.type || 'image/jpeg',
					quality: 90,
					crop: false,
					fit: false,
					preserveHeaders: true,
					resample: 'default'
				}, opts;

				if (typeof(options) === 'object') {
					opts = Basic.extend(defaults, options);
				} else {
					// for backward compatibility
					opts = Basic.extend(defaults, {
						width: arguments[0],
						height: arguments[1],
						crop: arguments[2],
						preserveHeaders: arguments[3]
					});
				}

				this.resize(opts);
			},

			/**
			Alias for downsize(width, height, true). (see downsize)

			@method crop
			@param {Number} width Resulting width
			@param {Number} [height=width] Resulting height (optional, if not supplied will default to width)
			@param {Boolean} [preserveHeaders=true] Whether to preserve meta headers (on JPEGs after resize)
			*/
			crop: function(width, height, preserveHeaders) {
				this.downsize(width, height, true, preserveHeaders);
			},

			getAsCanvas: function() {
				if (!Env.can('create_canvas')) {
					throw new x.RuntimeError(x.RuntimeError.NOT_SUPPORTED_ERR);
				}
				return this.exec('Image', 'getAsCanvas');
			},

			/**
			Retrieves image in it's current state as moxie.file.Blob object. Cannot be run on empty or image in progress (throws
			DOMException.INVALID_STATE_ERR).

			@method getAsBlob
			@param {String} [type="image/jpeg"] Mime type of resulting blob. Can either be image/jpeg or image/png
			@param {Number} [quality=90] Applicable only together with mime type image/jpeg
			@return {Blob} Image as Blob
			*/
			getAsBlob: function(type, quality) {
				if (!this.size) {
					throw new x.DOMException(x.DOMException.INVALID_STATE_ERR);
				}
				return this.exec('Image', 'getAsBlob', type || 'image/jpeg', quality || 90);
			},

			/**
			Retrieves image in it's current state as dataURL string. Cannot be run on empty or image in progress (throws
			DOMException.INVALID_STATE_ERR).

			@method getAsDataURL
			@param {String} [type="image/jpeg"] Mime type of resulting blob. Can either be image/jpeg or image/png
			@param {Number} [quality=90] Applicable only together with mime type image/jpeg
			@return {String} Image as dataURL string
			*/
			getAsDataURL: function(type, quality) {
				if (!this.size) {
					throw new x.DOMException(x.DOMException.INVALID_STATE_ERR);
				}
				return this.exec('Image', 'getAsDataURL', type || 'image/jpeg', quality || 90);
			},

			/**
			Retrieves image in it's current state as binary string. Cannot be run on empty or image in progress (throws
			DOMException.INVALID_STATE_ERR).

			@method getAsBinaryString
			@param {String} [type="image/jpeg"] Mime type of resulting blob. Can either be image/jpeg or image/png
			@param {Number} [quality=90] Applicable only together with mime type image/jpeg
			@return {String} Image as binary string
			*/
			getAsBinaryString: function(type, quality) {
				var dataUrl = this.getAsDataURL(type, quality);
				return Encode.atob(dataUrl.substring(dataUrl.indexOf('base64,') + 7));
			},

			/**
			Embeds a visual representation of the image into the specified node. Depending on the runtime,
			it might be a canvas, an img node or a thrid party shim object (Flash or SilverLight - very rare,
			can be used in legacy browsers that do not have canvas or proper dataURI support).

			@method embed
			@param {DOMElement} el DOM element to insert the image object into
			@param {Object} [options]
				@param {Number} [options.width] The width of an embed (defaults to the image width)
				@param {Number} [options.height] The height of an embed (defaults to the image height)
				@param {String} [options.type="image/jpeg"] Mime type
				@param {Number} [options.quality=90] Quality of an embed, if mime type is image/jpeg
				@param {Boolean} [options.crop=false] Whether to crop an embed to the specified dimensions
				@param {Boolean} [options.fit=true] By default thumbs will be up- or downscaled as necessary to fit the dimensions
			*/
			embed: function(el, options) {
				var self = this
				, runtime // this has to be outside of all the closures to contain proper runtime
				;

				var opts = Basic.extend({
					width: this.width,
					height: this.height,
					type: this.type || 'image/jpeg',
					quality: 90,
					fit: true,
					resample: 'nearest'
				}, options);


				function render(type, quality) {
					var img = this;

					// if possible, embed a canvas element directly
					if (Env.can('create_canvas')) {
						var canvas = img.getAsCanvas();
						if (canvas) {
							el.appendChild(canvas);
							canvas = null;
							img.destroy();
							self.trigger('embedded');
							return;
						}
					}

					var dataUrl = img.getAsDataURL(type, quality);
					if (!dataUrl) {
						throw new x.ImageError(x.ImageError.WRONG_FORMAT);
					}

					if (Env.can('use_data_uri_of', dataUrl.length)) {
						el.innerHTML = '<img src="' + dataUrl + '" width="' + img.width + '" height="' + img.height + '" alt="" />';
						img.destroy();
						self.trigger('embedded');
					} else {
						var tr = new Transporter();

						tr.bind("TransportingComplete", function() {
							runtime = self.connectRuntime(this.result.ruid);

							self.bind("Embedded", function() {
								// position and size properly
								Basic.extend(runtime.getShimContainer().style, {
									//position: 'relative',
									top: '0px',
									left: '0px',
									width: img.width + 'px',
									height: img.height + 'px'
								});

								// some shims (Flash/SilverLight) reinitialize, if parent element is hidden, reordered or it's
								// position type changes (in Gecko), but since we basically need this only in IEs 6/7 and
								// sometimes 8 and they do not have this problem, we can comment this for now
								/*tr.bind("RuntimeInit", function(e, runtime) {
									tr.destroy();
									runtime.destroy();
									onResize.call(self); // re-feed our image data
								});*/

								runtime = null; // release
							}, 999);

							runtime.exec.call(self, "ImageView", "display", this.result.uid, width, height);
							img.destroy();
						});

						tr.transport(Encode.atob(dataUrl.substring(dataUrl.indexOf('base64,') + 7)), type, {
							required_caps: {
								display_media: true
							},
							runtime_order: 'flash,silverlight',
							container: el
						});
					}
				}

				try {
					if (!(el = Dom.get(el))) {
						throw new x.DOMException(x.DOMException.INVALID_NODE_TYPE_ERR);
					}

					if (!this.size) { // only preloaded image objects can be used as source
						throw new x.DOMException(x.DOMException.INVALID_STATE_ERR);
					}

					// high-resolution images cannot be consistently handled across the runtimes
					if (this.width > Image.MAX_RESIZE_WIDTH || this.height > Image.MAX_RESIZE_HEIGHT) {
						//throw new x.ImageError(x.ImageError.MAX_RESOLUTION_ERR);
					}

					var imgCopy = new Image();

					imgCopy.bind("Resize", function() {
						render.call(this, opts.type, opts.quality);
					});

					imgCopy.bind("Load", function() {
						this.downsize(opts);
					});

					// if embedded thumb data is available and dimensions are big enough, use it
					if (this.meta.thumb && this.meta.thumb.width >= opts.width && this.meta.thumb.height >= opts.height) {
						imgCopy.load(this.meta.thumb.data);
					} else {
						imgCopy.clone(this, false);
					}

					return imgCopy;
				} catch(ex) {
					// for now simply trigger error event
					this.trigger('error', ex.code);
				}
			},

			/**
			Properly destroys the image and frees resources in use. If any. Recommended way to dispose
			moxie.image.Image object.

			@method destroy
			*/
			destroy: function() {
				if (this.ruid) {
					this.getRuntime().exec.call(this, 'Image', 'destroy');
					this.disconnectRuntime();
				}
				if (this.meta && this.meta.thumb) {
					// thumb is blob, make sure we destroy it first
					this.meta.thumb.data.destroy();
				}
				this.unbindAll();
			}
		});


		// this is here, because in order to bind properly, we need uid, which is created above
		this.handleEventProps(dispatches);

		this.bind('Load Resize', function() {
			return _updateInfo.call(this); // if operation fails (e.g. image is neither PNG nor JPEG) cancel all pending events
		}, 999);


		function _updateInfo(info) {
			try {
				if (!info) {
					info = this.exec('Image', 'getInfo');
				}

				this.size = info.size;
				this.width = info.width;
				this.height = info.height;
				this.type = info.type;
				this.meta = info.meta;

				// update file name, only if empty
				if (this.name === '') {
					this.name = info.name;
				}

				return true;
			} catch(ex) {
				this.trigger('error', ex.code);
				return false;
			}
		}


		function _load(src) {
			var srcType = Basic.typeOf(src);

			try {
				// if source is Image
				if (src instanceof Image) {
					if (!src.size) { // only preloaded image objects can be used as source
						throw new x.DOMException(x.DOMException.INVALID_STATE_ERR);
					}
					_loadFromImage.apply(this, arguments);
				}
				// if source is o.Blob/o.File
				else if (src instanceof Blob) {
					if (!~Basic.inArray(src.type, ['image/jpeg', 'image/png'])) {
						throw new x.ImageError(x.ImageError.WRONG_FORMAT);
					}
					_loadFromBlob.apply(this, arguments);
				}
				// if native blob/file
				else if (Basic.inArray(srcType, ['blob', 'file']) !== -1) {
					_load.call(this, new File(null, src), arguments[1]);
				}
				// if String
				else if (srcType === 'string') {
					// if dataUrl String
					if (src.substr(0, 5) === 'data:') {
						_load.call(this, new Blob(null, { data: src }), arguments[1]);
					}
					// else assume Url, either relative or absolute
					else {
						_loadFromUrl.apply(this, arguments);
					}
				}
				// if source seems to be an img node
				else if (srcType === 'node' && src.nodeName.toLowerCase() === 'img') {
					_load.call(this, src.src, arguments[1]);
				}
				else {
					throw new x.DOMException(x.DOMException.TYPE_MISMATCH_ERR);
				}
			} catch(ex) {
				// for now simply trigger error event
				this.trigger('error', ex.code);
			}
		}


		function _loadFromImage(img, exact) {
			var runtime = this.connectRuntime(img.ruid);
			this.ruid = runtime.uid;
			runtime.exec.call(this, 'Image', 'loadFromImage', img, (Basic.typeOf(exact) === 'undefined' ? true : exact));
		}


		function _loadFromBlob(blob, options) {
			var self = this;

			self.name = blob.name || '';

			function exec(runtime) {
				self.ruid = runtime.uid;
				runtime.exec.call(self, 'Image', 'loadFromBlob', blob);
			}

			if (blob.isDetached()) {
				this.bind('RuntimeInit', function(e, runtime) {
					exec(runtime);
				});

				// convert to object representation
				if (options && typeof(options.required_caps) === 'string') {
					options.required_caps = Runtime.parseCaps(options.required_caps);
				}

				this.connectRuntime(Basic.extend({
					required_caps: {
						access_image_binary: true,
						resize_image: true
					}
				}, options));
			} else {
				exec(this.connectRuntime(blob.ruid));
			}
		}


		function _loadFromUrl(url, options) {
			var self = this, xhr;

			xhr = new XMLHttpRequest();

			xhr.open('get', url);
			xhr.responseType = 'blob';

			xhr.onprogress = function(e) {
				self.trigger(e);
			};

			xhr.onload = function() {
				_loadFromBlob.call(self, xhr.response, true);
			};

			xhr.onerror = function(e) {
				self.trigger(e);
			};

			xhr.onloadend = function() {
				xhr.destroy();
			};

			xhr.bind('RuntimeError', function(e, err) {
				self.trigger('RuntimeError', err);
			});

			xhr.send(null, options);
		}
	}

	// virtual world will crash on you if image has a resolution higher than this:
	Image.MAX_RESIZE_WIDTH = 8192;
	Image.MAX_RESIZE_HEIGHT = 8192;

	Image.prototype = EventTarget.instance;

	return Image;
});

// Included from: src/javascript/runtime/html5/Runtime.js

/**
 * Runtime.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/*global File:true */

/**
Defines constructor for HTML5 runtime.

@class moxie/runtime/html5/Runtime
@private
*/
define("moxie/runtime/html5/Runtime", [
	"moxie/core/utils/Basic",
	"moxie/core/Exceptions",
	"moxie/runtime/Runtime",
	"moxie/core/utils/Env"
], function(Basic, x, Runtime, Env) {
	
	var type = "html5", extensions = {};
	
	function Html5Runtime(options) {
		var I = this
		, Test = Runtime.capTest
		, True = Runtime.capTrue
		;

		var caps = Basic.extend({
				access_binary: Test(window.FileReader || window.File && window.File.getAsDataURL),
				access_image_binary: function() {
					return I.can('access_binary') && !!extensions.Image;
				},
				display_media: Test(
					(Env.can('create_canvas') || Env.can('use_data_uri_over32kb')) && 
					defined('moxie/image/Image')
				),
				do_cors: Test(window.XMLHttpRequest && 'withCredentials' in new XMLHttpRequest()),
				drag_and_drop: Test(function() {
					// this comes directly from Modernizr: http://www.modernizr.com/
					var div = document.createElement('div');
					// IE has support for drag and drop since version 5, but doesn't support dropping files from desktop
					return (('draggable' in div) || ('ondragstart' in div && 'ondrop' in div)) && 
						(Env.browser !== 'IE' || Env.verComp(Env.version, 9, '>'));
				}()),
				filter_by_extension: Test(function() { // if you know how to feature-detect this, please suggest
					return !(
						(Env.browser === 'Chrome' && Env.verComp(Env.version, 28, '<')) || 
						(Env.browser === 'IE' && Env.verComp(Env.version, 10, '<')) || 
						(Env.browser === 'Safari' && Env.verComp(Env.version, 7, '<')) ||
						(Env.browser === 'Firefox' && Env.verComp(Env.version, 37, '<'))
					);
				}()),
				return_response_headers: True,
				return_response_type: function(responseType) {
					if (responseType === 'json' && !!window.JSON) { // we can fake this one even if it's not supported
						return true;
					} 
					return Env.can('return_response_type', responseType);
				},
				return_status_code: True,
				report_upload_progress: Test(window.XMLHttpRequest && new XMLHttpRequest().upload),
				resize_image: function() {
					return I.can('access_binary') && Env.can('create_canvas');
				},
				select_file: function() {
					return Env.can('use_fileinput') && window.File;
				},
				select_folder: function() {
					return I.can('select_file') && (
						Env.browser === 'Chrome' && Env.verComp(Env.version, 21, '>=') ||
						Env.browser === 'Firefox' && Env.verComp(Env.version, 42, '>=') // https://developer.mozilla.org/en-US/Firefox/Releases/42
					);
				},
				select_multiple: function() {
					// it is buggy on Safari Windows and iOS
					return I.can('select_file') &&
						!(Env.browser === 'Safari' && Env.os === 'Windows') &&
						!(Env.os === 'iOS' && Env.verComp(Env.osVersion, "7.0.0", '>') && Env.verComp(Env.osVersion, "8.0.0", '<'));
				},
				send_binary_string: Test(window.XMLHttpRequest && (new XMLHttpRequest().sendAsBinary || (window.Uint8Array && window.ArrayBuffer))),
				send_custom_headers: Test(window.XMLHttpRequest),
				send_multipart: function() {
					return !!(window.XMLHttpRequest && new XMLHttpRequest().upload && window.FormData) || I.can('send_binary_string');
				},
				slice_blob: Test(window.File && (File.prototype.mozSlice || File.prototype.webkitSlice || File.prototype.slice)),
				stream_upload: function(){
					return I.can('slice_blob') && I.can('send_multipart');
				},
				summon_file_dialog: function() { // yeah... some dirty sniffing here...
					return I.can('select_file') && !(
						(Env.browser === 'Firefox' && Env.verComp(Env.version, 4, '<')) ||
						(Env.browser === 'Opera' && Env.verComp(Env.version, 12, '<')) ||
						(Env.browser === 'IE' && Env.verComp(Env.version, 10, '<'))
					);
				},
				upload_filesize: True,
				use_http_method: True
			}, 
			arguments[2]
		);

		Runtime.call(this, options, (arguments[1] || type), caps);


		Basic.extend(this, {

			init : function() {
				this.trigger("Init");
			},

			destroy: (function(destroy) { // extend default destroy method
				return function() {
					destroy.call(I);
					destroy = I = null;
				};
			}(this.destroy))
		});

		Basic.extend(this.getShim(), extensions);
	}

	Runtime.addConstructor(type, Html5Runtime);

	return extensions;
});

// Included from: src/javascript/runtime/html5/file/Blob.js

/**
 * Blob.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/**
@class moxie/runtime/html5/file/Blob
@private
*/
define("moxie/runtime/html5/file/Blob", [
	"moxie/runtime/html5/Runtime",
	"moxie/file/Blob"
], function(extensions, Blob) {

	function HTML5Blob() {
		function w3cBlobSlice(blob, start, end) {
			var blobSlice;

			if (window.File.prototype.slice) {
				try {
					blob.slice();	// depricated version will throw WRONG_ARGUMENTS_ERR exception
					return blob.slice(start, end);
				} catch (e) {
					// depricated slice method
					return blob.slice(start, end - start);
				}
			// slice method got prefixed: https://bugzilla.mozilla.org/show_bug.cgi?id=649672
			} else if ((blobSlice = window.File.prototype.webkitSlice || window.File.prototype.mozSlice)) {
				return blobSlice.call(blob, start, end);
			} else {
				return null; // or throw some exception
			}
		}

		this.slice = function() {
			return new Blob(this.getRuntime().uid, w3cBlobSlice.apply(this, arguments));
		};

		this.destroy = function() {
			this.getRuntime().getShim().removeInstance(this.uid);
		};
	}

	return (extensions.Blob = HTML5Blob);
});

// Included from: src/javascript/core/utils/Events.js

/**
 * Events.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/**
@class moxie/core/utils/Events
@public
@static
*/

define('moxie/core/utils/Events', [
	'moxie/core/utils/Basic'
], function(Basic) {
	var eventhash = {}, uid = 'moxie_' + Basic.guid();
	
	// IE W3C like event funcs
	function preventDefault() {
		this.returnValue = false;
	}

	function stopPropagation() {
		this.cancelBubble = true;
	}

	/**
	Adds an event handler to the specified object and store reference to the handler
	in objects internal Plupload registry (@see removeEvent).
	
	@method addEvent
	@static
	@param {Object} obj DOM element like object to add handler to.
	@param {String} name Name to add event listener to.
	@param {Function} callback Function to call when event occurs.
	@param {String} [key] that might be used to add specifity to the event record.
	*/
	var addEvent = function(obj, name, callback, key) {
		var func, events;
					
		name = name.toLowerCase();

		// Add event listener
		if (obj.addEventListener) {
			func = callback;
			
			obj.addEventListener(name, func, false);
		} else if (obj.attachEvent) {
			func = function() {
				var evt = window.event;

				if (!evt.target) {
					evt.target = evt.srcElement;
				}

				evt.preventDefault = preventDefault;
				evt.stopPropagation = stopPropagation;

				callback(evt);
			};

			obj.attachEvent('on' + name, func);
		}
		
		// Log event handler to objects internal mOxie registry
		if (!obj[uid]) {
			obj[uid] = Basic.guid();
		}
		
		if (!eventhash.hasOwnProperty(obj[uid])) {
			eventhash[obj[uid]] = {};
		}
		
		events = eventhash[obj[uid]];
		
		if (!events.hasOwnProperty(name)) {
			events[name] = [];
		}
				
		events[name].push({
			func: func,
			orig: callback, // store original callback for IE
			key: key
		});
	};
	
	
	/**
	Remove event handler from the specified object. If third argument (callback)
	is not specified remove all events with the specified name.
	
	@method removeEvent
	@static
	@param {Object} obj DOM element to remove event listener(s) from.
	@param {String} name Name of event listener to remove.
	@param {Function|String} [callback] might be a callback or unique key to match.
	*/
	var removeEvent = function(obj, name, callback) {
		var type, undef;
		
		name = name.toLowerCase();
		
		if (obj[uid] && eventhash[obj[uid]] && eventhash[obj[uid]][name]) {
			type = eventhash[obj[uid]][name];
		} else {
			return;
		}
			
		for (var i = type.length - 1; i >= 0; i--) {
			// undefined or not, key should match
			if (type[i].orig === callback || type[i].key === callback) {
				if (obj.removeEventListener) {
					obj.removeEventListener(name, type[i].func, false);
				} else if (obj.detachEvent) {
					obj.detachEvent('on'+name, type[i].func);
				}
				
				type[i].orig = null;
				type[i].func = null;
				type.splice(i, 1);
				
				// If callback was passed we are done here, otherwise proceed
				if (callback !== undef) {
					break;
				}
			}
		}
		
		// If event array got empty, remove it
		if (!type.length) {
			delete eventhash[obj[uid]][name];
		}
		
		// If mOxie registry has become empty, remove it
		if (Basic.isEmptyObj(eventhash[obj[uid]])) {
			delete eventhash[obj[uid]];
			
			// IE doesn't let you remove DOM object property with - delete
			try {
				delete obj[uid];
			} catch(e) {
				obj[uid] = undef;
			}
		}
	};
	
	
	/**
	Remove all kind of events from the specified object
	
	@method removeAllEvents
	@static
	@param {Object} obj DOM element to remove event listeners from.
	@param {String} [key] unique key to match, when removing events.
	*/
	var removeAllEvents = function(obj, key) {		
		if (!obj || !obj[uid]) {
			return;
		}
		
		Basic.each(eventhash[obj[uid]], function(events, name) {
			removeEvent(obj, name, key);
		});
	};

	return {
		addEvent: addEvent,
		removeEvent: removeEvent,
		removeAllEvents: removeAllEvents
	};
});

// Included from: src/javascript/runtime/html5/file/FileInput.js

/**
 * FileInput.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/**
@class moxie/runtime/html5/file/FileInput
@private
*/
define("moxie/runtime/html5/file/FileInput", [
	"moxie/runtime/html5/Runtime",
	"moxie/file/File",
	"moxie/core/utils/Basic",
	"moxie/core/utils/Dom",
	"moxie/core/utils/Events",
	"moxie/core/utils/Mime",
	"moxie/core/utils/Env"
], function(extensions, File, Basic, Dom, Events, Mime, Env) {
	
	function FileInput() {
		var _options, _browseBtnZIndex; // save original z-index

		Basic.extend(this, {
			init: function(options) {
				var comp = this, I = comp.getRuntime(), input, shimContainer, mimes, browseButton, zIndex, top;

				_options = options;

				// figure out accept string
				mimes = Mime.extList2mimes(_options.accept, I.can('filter_by_extension'));

				shimContainer = I.getShimContainer();

				shimContainer.innerHTML = '<input id="' + I.uid +'" type="file" style="font-size:999px;opacity:0;"' +
					(_options.multiple && I.can('select_multiple') ? 'multiple' : '') + 
					(_options.directory && I.can('select_folder') ? 'webkitdirectory directory' : '') + // Chrome 11+
					(mimes ? ' accept="' + mimes.join(',') + '"' : '') + ' />';

				input = Dom.get(I.uid);

				// prepare file input to be placed underneath the browse_button element
				Basic.extend(input.style, {
					position: 'absolute',
					top: 0,
					left: 0,
					width: '100%',
					height: '100%'
				});


				browseButton = Dom.get(_options.browse_button);
				_browseBtnZIndex = Dom.getStyle(browseButton, 'z-index') || 'auto';

				// Route click event to the input[type=file] element for browsers that support such behavior
				if (I.can('summon_file_dialog')) {
					if (Dom.getStyle(browseButton, 'position') === 'static') {
						browseButton.style.position = 'relative';
					}

					Events.addEvent(browseButton, 'click', function(e) {
						var input = Dom.get(I.uid);
						if (input && !input.disabled) { // for some reason FF (up to 8.0.1 so far) lets to click disabled input[type=file]
							input.click();
						}
						e.preventDefault();
					}, comp.uid);

					comp.bind('Refresh', function() {
						zIndex = parseInt(_browseBtnZIndex, 10) || 1;

						Dom.get(_options.browse_button).style.zIndex = zIndex;
						this.getRuntime().getShimContainer().style.zIndex = zIndex - 1;
					});
				}

				/* Since we have to place input[type=file] on top of the browse_button for some browsers,
				browse_button loses interactivity, so we restore it here */
				top = I.can('summon_file_dialog') ? browseButton : shimContainer;

				Events.addEvent(top, 'mouseover', function() {
					comp.trigger('mouseenter');
				}, comp.uid);

				Events.addEvent(top, 'mouseout', function() {
					comp.trigger('mouseleave');
				}, comp.uid);

				Events.addEvent(top, 'mousedown', function() {
					comp.trigger('mousedown');
				}, comp.uid);

				Events.addEvent(Dom.get(_options.container), 'mouseup', function() {
					comp.trigger('mouseup');
				}, comp.uid);

				// it shouldn't be possible to tab into the hidden element
				(I.can('summon_file_dialog') ? input : browseButton).setAttribute('tabindex', -1);

				input.onchange = function onChange() { // there should be only one handler for this
					comp.files = [];

					Basic.each(this.files, function(file) {
						var relativePath = '';

						if (_options.directory) {
							// folders are represented by dots, filter them out (Chrome 11+)
							if (file.name == ".") {
								// if it looks like a folder...
								return true;
							}
						}

						if (file.webkitRelativePath) {
							relativePath = '/' + file.webkitRelativePath.replace(/^\//, '');
						}
						
						file = new File(I.uid, file);
						file.relativePath = relativePath;

						comp.files.push(file);
					});

					// clearing the value enables the user to select the same file again if they want to
					if (Env.browser !== 'IE' && Env.browser !== 'IEMobile') {
						this.value = '';
					} else {
						// in IE input[type="file"] is read-only so the only way to reset it is to re-insert it
						var clone = this.cloneNode(true);
						this.parentNode.replaceChild(clone, this);
						clone.onchange = onChange;
					}

					if (comp.files.length) {
						comp.trigger('change');
					}
				};

				// ready event is perfectly asynchronous
				comp.trigger({
					type: 'ready',
					async: true
				});

				shimContainer = null;
			},


			setOption: function(name, value) {
				var I = this.getRuntime();
				var input = Dom.get(I.uid);

				switch (name) {
					case 'accept':
						if (value) {
							var mimes = value.mimes || Mime.extList2mimes(value, I.can('filter_by_extension'));
							input.setAttribute('accept', mimes.join(','));
						} else {
							input.removeAttribute('accept');
						}
						break;

					case 'directory':
						if (value && I.can('select_folder')) {
							input.setAttribute('directory', '');
							input.setAttribute('webkitdirectory', '');
						} else {
							input.removeAttribute('directory');
							input.removeAttribute('webkitdirectory');
						}
						break;

					case 'multiple':
						if (value && I.can('select_multiple')) {
							input.setAttribute('multiple', '');
						} else {
							input.removeAttribute('multiple');
						}

				}
			},


			disable: function(state) {
				var I = this.getRuntime(), input;

				if ((input = Dom.get(I.uid))) {
					input.disabled = !!state;
				}
			},

			destroy: function() {
				var I = this.getRuntime()
				, shim = I.getShim()
				, shimContainer = I.getShimContainer()
				, container = _options && Dom.get(_options.container)
				, browseButton = _options && Dom.get(_options.browse_button)
				;
				
				if (container) {
					Events.removeAllEvents(container, this.uid);
				}
				
				if (browseButton) {
					Events.removeAllEvents(browseButton, this.uid);
					browseButton.style.zIndex = _browseBtnZIndex; // reset to original value
				}
				
				if (shimContainer) {
					Events.removeAllEvents(shimContainer, this.uid);
					shimContainer.innerHTML = '';
				}

				shim.removeInstance(this.uid);

				_options = shimContainer = container = browseButton = shim = null;
			}
		});
	}

	return (extensions.FileInput = FileInput);
});

// Included from: src/javascript/runtime/html5/file/FileDrop.js

/**
 * FileDrop.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/**
@class moxie/runtime/html5/file/FileDrop
@private
*/
define("moxie/runtime/html5/file/FileDrop", [
	"moxie/runtime/html5/Runtime",
	'moxie/file/File',
	"moxie/core/utils/Basic",
	"moxie/core/utils/Dom",
	"moxie/core/utils/Events",
	"moxie/core/utils/Mime"
], function(extensions, File, Basic, Dom, Events, Mime) {
	
	function FileDrop() {
		var _files = [], _allowedExts = [], _options, _ruid;

		Basic.extend(this, {
			init: function(options) {
				var comp = this, dropZone;

				_options = options;
				_ruid = comp.ruid; // every dropped-in file should have a reference to the runtime
				_allowedExts = _extractExts(_options.accept);
				dropZone = _options.container;

				Events.addEvent(dropZone, 'dragover', function(e) {
					if (!_hasFiles(e)) {
						return;
					}
					e.preventDefault();
					e.dataTransfer.dropEffect = 'copy';
				}, comp.uid);

				Events.addEvent(dropZone, 'drop', function(e) {
					if (!_hasFiles(e)) {
						return;
					}
					e.preventDefault();

					_files = [];

					// Chrome 21+ accepts folders via Drag'n'Drop
					if (e.dataTransfer.items && e.dataTransfer.items[0].webkitGetAsEntry) {
						_readItems(e.dataTransfer.items, function() {
							comp.files = _files;
							comp.trigger("drop");
						});
					} else {
						Basic.each(e.dataTransfer.files, function(file) {
							_addFile(file);
						});
						comp.files = _files;
						comp.trigger("drop");
					}
				}, comp.uid);

				Events.addEvent(dropZone, 'dragenter', function(e) {
					comp.trigger("dragenter");
				}, comp.uid);

				Events.addEvent(dropZone, 'dragleave', function(e) {
					comp.trigger("dragleave");
				}, comp.uid);
			},

			destroy: function() {
				Events.removeAllEvents(_options && Dom.get(_options.container), this.uid);
				_ruid = _files = _allowedExts = _options = null;
				this.getRuntime().getShim().removeInstance(this.uid);
			}
		});


		function _hasFiles(e) {
			if (!e.dataTransfer || !e.dataTransfer.types) { // e.dataTransfer.files is not available in Gecko during dragover
				return false;
			}

			var types = Basic.toArray(e.dataTransfer.types || []);

			return Basic.inArray("Files", types) !== -1 ||
				Basic.inArray("public.file-url", types) !== -1 || // Safari < 5
				Basic.inArray("application/x-moz-file", types) !== -1 // Gecko < 1.9.2 (< Firefox 3.6)
				;
		}


		function _addFile(file, relativePath) {
			if (_isAcceptable(file)) {
				var fileObj = new File(_ruid, file);
				fileObj.relativePath = relativePath || '';
				_files.push(fileObj);
			}
		}

		
		function _extractExts(accept) {
			var exts = [];
			for (var i = 0; i < accept.length; i++) {
				[].push.apply(exts, accept[i].extensions.split(/\s*,\s*/));
			}
			return Basic.inArray('*', exts) === -1 ? exts : [];
		}


		function _isAcceptable(file) {
			if (!_allowedExts.length) {
				return true;
			}
			var ext = Mime.getFileExtension(file.name);
			return !ext || Basic.inArray(ext, _allowedExts) !== -1;
		}


		function _readItems(items, cb) {
			var entries = [];
			Basic.each(items, function(item) {
				var entry = item.webkitGetAsEntry();
				// Address #998 (https://code.google.com/p/chromium/issues/detail?id=332579)
				if (entry) {
					// file() fails on OSX when the filename contains a special character (e.g. umlaut): see #61
					if (entry.isFile) {
						_addFile(item.getAsFile(), entry.fullPath);
					} else {
						entries.push(entry);
					}
				}
			});

			if (entries.length) {
				_readEntries(entries, cb);
			} else {
				cb();
			}
		}


		function _readEntries(entries, cb) {
			var queue = [];
			Basic.each(entries, function(entry) {
				queue.push(function(cbcb) {
					_readEntry(entry, cbcb);
				});
			});
			Basic.inSeries(queue, function() {
				cb();
			});
		}


		function _readEntry(entry, cb) {
			if (entry.isFile) {
				entry.file(function(file) {
					_addFile(file, entry.fullPath);
					cb();
				}, function() {
					// fire an error event maybe
					cb();
				});
			} else if (entry.isDirectory) {
				_readDirEntry(entry, cb);
			} else {
				cb(); // not file, not directory? what then?..
			}
		}


		function _readDirEntry(dirEntry, cb) {
			var entries = [], dirReader = dirEntry.createReader();

			// keep quering recursively till no more entries
			function getEntries(cbcb) {
				dirReader.readEntries(function(moreEntries) {
					if (moreEntries.length) {
						[].push.apply(entries, moreEntries);
						getEntries(cbcb);
					} else {
						cbcb();
					}
				}, cbcb);
			}

			// ...and you thought FileReader was crazy...
			getEntries(function() {
				_readEntries(entries, cb);
			}); 
		}
	}

	return (extensions.FileDrop = FileDrop);
});

// Included from: src/javascript/runtime/html5/file/FileReader.js

/**
 * FileReader.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/**
@class moxie/runtime/html5/file/FileReader
@private
*/
define("moxie/runtime/html5/file/FileReader", [
	"moxie/runtime/html5/Runtime",
	"moxie/core/utils/Encode",
	"moxie/core/utils/Basic"
], function(extensions, Encode, Basic) {
	
	function FileReader() {
		var _fr, _convertToBinary = false;

		Basic.extend(this, {

			read: function(op, blob) {
				var comp = this;

				comp.result = '';

				_fr = new window.FileReader();

				_fr.addEventListener('progress', function(e) {
					comp.trigger(e);
				});

				_fr.addEventListener('load', function(e) {
					comp.result = _convertToBinary ? _toBinary(_fr.result) : _fr.result;
					comp.trigger(e);
				});

				_fr.addEventListener('error', function(e) {
					comp.trigger(e, _fr.error);
				});

				_fr.addEventListener('loadend', function(e) {
					_fr = null;
					comp.trigger(e);
				});

				if (Basic.typeOf(_fr[op]) === 'function') {
					_convertToBinary = false;
					_fr[op](blob.getSource());
				} else if (op === 'readAsBinaryString') { // readAsBinaryString is depricated in general and never existed in IE10+
					_convertToBinary = true;
					_fr.readAsDataURL(blob.getSource());
				}
			},

			abort: function() {
				if (_fr) {
					_fr.abort();
				}
			},

			destroy: function() {
				_fr = null;
				this.getRuntime().getShim().removeInstance(this.uid);
			}
		});

		function _toBinary(str) {
			return Encode.atob(str.substring(str.indexOf('base64,') + 7));
		}
	}

	return (extensions.FileReader = FileReader);
});

// Included from: src/javascript/runtime/html5/xhr/XMLHttpRequest.js

/**
 * XMLHttpRequest.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/*global ActiveXObject:true */

/**
@class moxie/runtime/html5/xhr/XMLHttpRequest
@private
*/
define("moxie/runtime/html5/xhr/XMLHttpRequest", [
	"moxie/runtime/html5/Runtime",
	"moxie/core/utils/Basic",
	"moxie/core/utils/Mime",
	"moxie/core/utils/Url",
	"moxie/file/File",
	"moxie/file/Blob",
	"moxie/xhr/FormData",
	"moxie/core/Exceptions",
	"moxie/core/utils/Env"
], function(extensions, Basic, Mime, Url, File, Blob, FormData, x, Env) {
	
	function XMLHttpRequest() {
		var self = this
		, _xhr
		, _filename
		;

		Basic.extend(this, {
			send: function(meta, data) {
				var target = this
				, isGecko2_5_6 = (Env.browser === 'Mozilla' && Env.verComp(Env.version, 4, '>=') && Env.verComp(Env.version, 7, '<'))
				, isAndroidBrowser = Env.browser === 'Android Browser'
				, mustSendAsBinary = false
				;

				// extract file name
				_filename = meta.url.replace(/^.+?\/([\w\-\.]+)$/, '$1').toLowerCase();

				_xhr = _getNativeXHR();
				_xhr.open(meta.method, meta.url, meta.async, meta.user, meta.password);


				// prepare data to be sent
				if (data instanceof Blob) {
					if (data.isDetached()) {
						mustSendAsBinary = true;
					}
					data = data.getSource();
				} else if (data instanceof FormData) {

					if (data.hasBlob()) {
						if (data.getBlob().isDetached()) {
							data = _prepareMultipart.call(target, data); // _xhr must be instantiated and be in OPENED state
							mustSendAsBinary = true;
						} else if ((isGecko2_5_6 || isAndroidBrowser) && Basic.typeOf(data.getBlob().getSource()) === 'blob' && window.FileReader) {
							// Gecko 2/5/6 can't send blob in FormData: https://bugzilla.mozilla.org/show_bug.cgi?id=649150
							// Android browsers (default one and Dolphin) seem to have the same issue, see: #613
							_preloadAndSend.call(target, meta, data);
							return; // _preloadAndSend will reinvoke send() with transmutated FormData =%D
						}	
					}

					// transfer fields to real FormData
					if (data instanceof FormData) { // if still a FormData, e.g. not mangled by _prepareMultipart()
						var fd = new window.FormData();
						data.each(function(value, name) {
							if (value instanceof Blob) {
								fd.append(name, value.getSource());
							} else {
								fd.append(name, value);
							}
						});
						data = fd;
					}
				}


				// if XHR L2
				if (_xhr.upload) {
					if (meta.withCredentials) {
						_xhr.withCredentials = true;
					}

					_xhr.addEventListener('load', function(e) {
						target.trigger(e);
					});

					_xhr.addEventListener('error', function(e) {
						target.trigger(e);
					});

					// additionally listen to progress events
					_xhr.addEventListener('progress', function(e) {
						target.trigger(e);
					});

					_xhr.upload.addEventListener('progress', function(e) {
						target.trigger({
							type: 'UploadProgress',
							loaded: e.loaded,
							total: e.total
						});
					});
				// ... otherwise simulate XHR L2
				} else {
					_xhr.onreadystatechange = function onReadyStateChange() {
						
						// fake Level 2 events
						switch (_xhr.readyState) {
							
							case 1: // XMLHttpRequest.OPENED
								// readystatechanged is fired twice for OPENED state (in IE and Mozilla) - neu
								break;
							
							// looks like HEADERS_RECEIVED (state 2) is not reported in Opera (or it's old versions) - neu
							case 2: // XMLHttpRequest.HEADERS_RECEIVED
								break;
								
							case 3: // XMLHttpRequest.LOADING 
								// try to fire progress event for not XHR L2
								var total, loaded;
								
								try {
									if (Url.hasSameOrigin(meta.url)) { // Content-Length not accessible for cross-domain on some browsers
										total = _xhr.getResponseHeader('Content-Length') || 0; // old Safari throws an exception here
									}

									if (_xhr.responseText) { // responseText was introduced in IE7
										loaded = _xhr.responseText.length;
									}
								} catch(ex) {
									total = loaded = 0;
								}

								target.trigger({
									type: 'progress',
									lengthComputable: !!total,
									total: parseInt(total, 10),
									loaded: loaded
								});
								break;
								
							case 4: // XMLHttpRequest.DONE
								// release readystatechange handler (mostly for IE)
								_xhr.onreadystatechange = function() {};

								// usually status 0 is returned when server is unreachable, but FF also fails to status 0 for 408 timeout
								try {
									if (_xhr.status >= 200 && _xhr.status < 400) {
										target.trigger('load');
										break;
									}
								} catch(ex) {}

								target.trigger('error');
								break;
						}
					};
				}
				

				// set request headers
				if (!Basic.isEmptyObj(meta.headers)) {
					Basic.each(meta.headers, function(value, header) {
						_xhr.setRequestHeader(header, value);
					});
				}

				// request response type
				if ("" !== meta.responseType && 'responseType' in _xhr) {
					if ('json' === meta.responseType && !Env.can('return_response_type', 'json')) { // we can fake this one
						_xhr.responseType = 'text';
					} else {
						_xhr.responseType = meta.responseType;
					}
				}

				// send ...
				if (!mustSendAsBinary) {
					_xhr.send(data);
				} else {
					if (_xhr.sendAsBinary) { // Gecko
						_xhr.sendAsBinary(data);
					} else { // other browsers having support for typed arrays
						(function() {
							// mimic Gecko's sendAsBinary
							var ui8a = new Uint8Array(data.length);
							for (var i = 0; i < data.length; i++) {
								ui8a[i] = (data.charCodeAt(i) & 0xff);
							}
							_xhr.send(ui8a.buffer);
						}());
					}
				}

				target.trigger('loadstart');
			},

			getStatus: function() {
				// according to W3C spec it should return 0 for readyState < 3, but instead it throws an exception
				try {
					if (_xhr) {
						return _xhr.status;
					}
				} catch(ex) {}
				return 0;
			},

			getResponse: function(responseType) {
				var I = this.getRuntime();

				try {
					switch (responseType) {
						case 'blob':
							var file = new File(I.uid, _xhr.response);
							
							// try to extract file name from content-disposition if possible (might be - not, if CORS for example)	
							var disposition = _xhr.getResponseHeader('Content-Disposition');
							if (disposition) {
								// extract filename from response header if available
								var match = disposition.match(/filename=([\'\"'])([^\1]+)\1/);
								if (match) {
									_filename = match[2];
								}
							}
							file.name = _filename;

							// pre-webkit Opera doesn't set type property on the blob response
							if (!file.type) {
								file.type = Mime.getFileMime(_filename);
							}
							return file;

						case 'json':
							if (!Env.can('return_response_type', 'json')) {
								return _xhr.status === 200 && !!window.JSON ? JSON.parse(_xhr.responseText) : null;
							}
							return _xhr.response;

						case 'document':
							return _getDocument(_xhr);

						default:
							return _xhr.responseText !== '' ? _xhr.responseText : null; // against the specs, but for consistency across the runtimes
					}
				} catch(ex) {
					return null;
				}				
			},

			getAllResponseHeaders: function() {
				try {
					return _xhr.getAllResponseHeaders();
				} catch(ex) {}
				return '';
			},

			abort: function() {
				if (_xhr) {
					_xhr.abort();
				}
			},

			destroy: function() {
				self = _filename = null;
				this.getRuntime().getShim().removeInstance(this.uid);
			}
		});


		// here we go... ugly fix for ugly bug
		function _preloadAndSend(meta, data) {
			var target = this, blob, fr;
				
			// get original blob
			blob = data.getBlob().getSource();
			
			// preload blob in memory to be sent as binary string
			fr = new window.FileReader();
			fr.onload = function() {
				// overwrite original blob
				data.append(data.getBlobName(), new Blob(null, {
					type: blob.type,
					data: fr.result
				}));
				// invoke send operation again
				self.send.call(target, meta, data);
			};
			fr.readAsBinaryString(blob);
		}

		
		function _getNativeXHR() {
			if (window.XMLHttpRequest && !(Env.browser === 'IE' && Env.verComp(Env.version, 8, '<'))) { // IE7 has native XHR but it's buggy
				return new window.XMLHttpRequest();
			} else {
				return (function() {
					var progIDs = ['Msxml2.XMLHTTP.6.0', 'Microsoft.XMLHTTP']; // if 6.0 available, use it, otherwise failback to default 3.0
					for (var i = 0; i < progIDs.length; i++) {
						try {
							return new ActiveXObject(progIDs[i]);
						} catch (ex) {}
					}
				})();
			}
		}
		
		// @credits Sergey Ilinsky	(http://www.ilinsky.com/)
		function _getDocument(xhr) {
			var rXML = xhr.responseXML;
			var rText = xhr.responseText;
			
			// Try parsing responseText (@see: http://www.ilinsky.com/articles/XMLHttpRequest/#bugs-ie-responseXML-content-type)
			if (Env.browser === 'IE' && rText && rXML && !rXML.documentElement && /[^\/]+\/[^\+]+\+xml/.test(xhr.getResponseHeader("Content-Type"))) {
				rXML = new window.ActiveXObject("Microsoft.XMLDOM");
				rXML.async = false;
				rXML.validateOnParse = false;
				rXML.loadXML(rText);
			}
	
			// Check if there is no error in document
			if (rXML) {
				if ((Env.browser === 'IE' && rXML.parseError !== 0) || !rXML.documentElement || rXML.documentElement.tagName === "parsererror") {
					return null;
				}
			}
			return rXML;
		}


		function _prepareMultipart(fd) {
			var boundary = '----moxieboundary' + new Date().getTime()
			, dashdash = '--'
			, crlf = '\r\n'
			, multipart = ''
			, I = this.getRuntime()
			;

			if (!I.can('send_binary_string')) {
				throw new x.RuntimeError(x.RuntimeError.NOT_SUPPORTED_ERR);
			}

			_xhr.setRequestHeader('Content-Type', 'multipart/form-data; boundary=' + boundary);

			// append multipart parameters
			fd.each(function(value, name) {
				// Firefox 3.6 failed to convert multibyte characters to UTF-8 in sendAsBinary(), 
				// so we try it here ourselves with: unescape(encodeURIComponent(value))
				if (value instanceof Blob) {
					// Build RFC2388 blob
					multipart += dashdash + boundary + crlf +
						'Content-Disposition: form-data; name="' + name + '"; filename="' + unescape(encodeURIComponent(value.name || 'blob')) + '"' + crlf +
						'Content-Type: ' + (value.type || 'application/octet-stream') + crlf + crlf +
						value.getSource() + crlf;
				} else {
					multipart += dashdash + boundary + crlf +
						'Content-Disposition: form-data; name="' + name + '"' + crlf + crlf +
						unescape(encodeURIComponent(value)) + crlf;
				}
			});

			multipart += dashdash + boundary + dashdash + crlf;

			return multipart;
		}
	}

	return (extensions.XMLHttpRequest = XMLHttpRequest);
});

// Included from: src/javascript/runtime/html5/utils/BinaryReader.js

/**
 * BinaryReader.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/**
@class moxie/runtime/html5/utils/BinaryReader
@private
*/
define("moxie/runtime/html5/utils/BinaryReader", [
	"moxie/core/utils/Basic"
], function(Basic) {

	
	function BinaryReader(data) {
		if (data instanceof ArrayBuffer) {
			ArrayBufferReader.apply(this, arguments);
		} else {
			UTF16StringReader.apply(this, arguments);
		}
	}

	Basic.extend(BinaryReader.prototype, {
		
		littleEndian: false,


		read: function(idx, size) {
			var sum, mv, i;

			if (idx + size > this.length()) {
				throw new Error("You are trying to read outside the source boundaries.");
			}
			
			mv = this.littleEndian 
				? 0 
				: -8 * (size - 1)
			;

			for (i = 0, sum = 0; i < size; i++) {
				sum |= (this.readByteAt(idx + i) << Math.abs(mv + i*8));
			}
			return sum;
		},


		write: function(idx, num, size) {
			var mv, i, str = '';

			if (idx > this.length()) {
				throw new Error("You are trying to write outside the source boundaries.");
			}

			mv = this.littleEndian 
				? 0 
				: -8 * (size - 1)
			;

			for (i = 0; i < size; i++) {
				this.writeByteAt(idx + i, (num >> Math.abs(mv + i*8)) & 255);
			}
		},


		BYTE: function(idx) {
			return this.read(idx, 1);
		},


		SHORT: function(idx) {
			return this.read(idx, 2);
		},


		LONG: function(idx) {
			return this.read(idx, 4);
		},


		SLONG: function(idx) { // 2's complement notation
			var num = this.read(idx, 4);
			return (num > 2147483647 ? num - 4294967296 : num);
		},


		CHAR: function(idx) {
			return String.fromCharCode(this.read(idx, 1));
		},


		STRING: function(idx, count) {
			return this.asArray('CHAR', idx, count).join('');
		},


		asArray: function(type, idx, count) {
			var values = [];

			for (var i = 0; i < count; i++) {
				values[i] = this[type](idx + i);
			}
			return values;
		}
	});


	function ArrayBufferReader(data) {
		var _dv = new DataView(data);

		Basic.extend(this, {
			
			readByteAt: function(idx) {
				return _dv.getUint8(idx);
			},


			writeByteAt: function(idx, value) {
				_dv.setUint8(idx, value);
			},
			

			SEGMENT: function(idx, size, value) {
				switch (arguments.length) {
					case 2:
						return data.slice(idx, idx + size);

					case 1:
						return data.slice(idx);

					case 3:
						if (value === null) {
							value = new ArrayBuffer();
						}

						if (value instanceof ArrayBuffer) {					
							var arr = new Uint8Array(this.length() - size + value.byteLength);
							if (idx > 0) {
								arr.set(new Uint8Array(data.slice(0, idx)), 0);
							}
							arr.set(new Uint8Array(value), idx);
							arr.set(new Uint8Array(data.slice(idx + size)), idx + value.byteLength);

							this.clear();
							data = arr.buffer;
							_dv = new DataView(data);
							break;
						}

					default: return data;
				}
			},


			length: function() {
				return data ? data.byteLength : 0;
			},


			clear: function() {
				_dv = data = null;
			}
		});
	}


	function UTF16StringReader(data) {
		Basic.extend(this, {
			
			readByteAt: function(idx) {
				return data.charCodeAt(idx);
			},


			writeByteAt: function(idx, value) {
				putstr(String.fromCharCode(value), idx, 1);
			},


			SEGMENT: function(idx, length, segment) {
				switch (arguments.length) {
					case 1:
						return data.substr(idx);
					case 2:
						return data.substr(idx, length);
					case 3:
						putstr(segment !== null ? segment : '', idx, length);
						break;
					default: return data;
				}
			},


			length: function() {
				return data ? data.length : 0;
			}, 

			clear: function() {
				data = null;
			}
		});


		function putstr(segment, idx, length) {
			length = arguments.length === 3 ? length : data.length - idx - 1;
			data = data.substr(0, idx) + segment + data.substr(length + idx);
		}
	}


	return BinaryReader;
});

// Included from: src/javascript/runtime/html5/image/JPEGHeaders.js

/**
 * JPEGHeaders.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */
 
/**
@class moxie/runtime/html5/image/JPEGHeaders
@private
*/
define("moxie/runtime/html5/image/JPEGHeaders", [
	"moxie/runtime/html5/utils/BinaryReader",
	"moxie/core/Exceptions"
], function(BinaryReader, x) {
	
	return function JPEGHeaders(data) {
		var headers = [], _br, idx, marker, length = 0;

		_br = new BinaryReader(data);

		// Check if data is jpeg
		if (_br.SHORT(0) !== 0xFFD8) {
			_br.clear();
			throw new x.ImageError(x.ImageError.WRONG_FORMAT);
		}

		idx = 2;

		while (idx <= _br.length()) {
			marker = _br.SHORT(idx);

			// omit RST (restart) markers
			if (marker >= 0xFFD0 && marker <= 0xFFD7) {
				idx += 2;
				continue;
			}

			// no headers allowed after SOS marker
			if (marker === 0xFFDA || marker === 0xFFD9) {
				break;
			}

			length = _br.SHORT(idx + 2) + 2;

			// APPn marker detected
			if (marker >= 0xFFE1 && marker <= 0xFFEF) {
				headers.push({
					hex: marker,
					name: 'APP' + (marker & 0x000F),
					start: idx,
					length: length,
					segment: _br.SEGMENT(idx, length)
				});
			}

			idx += length;
		}

		_br.clear();

		return {
			headers: headers,

			restore: function(data) {
				var max, i, br;

				br = new BinaryReader(data);

				idx = br.SHORT(2) == 0xFFE0 ? 4 + br.SHORT(4) : 2;

				for (i = 0, max = headers.length; i < max; i++) {
					br.SEGMENT(idx, 0, headers[i].segment);
					idx += headers[i].length;
				}

				data = br.SEGMENT();
				br.clear();
				return data;
			},

			strip: function(data) {
				var br, headers, jpegHeaders, i;

				jpegHeaders = new JPEGHeaders(data);
				headers = jpegHeaders.headers;
				jpegHeaders.purge();

				br = new BinaryReader(data);

				i = headers.length;
				while (i--) {
					br.SEGMENT(headers[i].start, headers[i].length, '');
				}
				
				data = br.SEGMENT();
				br.clear();
				return data;
			},

			get: function(name) {
				var array = [];

				for (var i = 0, max = headers.length; i < max; i++) {
					if (headers[i].name === name.toUpperCase()) {
						array.push(headers[i].segment);
					}
				}
				return array;
			},

			set: function(name, segment) {
				var array = [], i, ii, max;

				if (typeof(segment) === 'string') {
					array.push(segment);
				} else {
					array = segment;
				}

				for (i = ii = 0, max = headers.length; i < max; i++) {
					if (headers[i].name === name.toUpperCase()) {
						headers[i].segment = array[ii];
						headers[i].length = array[ii].length;
						ii++;
					}
					if (ii >= array.length) {
						break;
					}
				}
			},

			purge: function() {
				this.headers = headers = [];
			}
		};
	};
});

// Included from: src/javascript/runtime/html5/image/ExifParser.js

/**
 * ExifParser.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/**
@class moxie/runtime/html5/image/ExifParser
@private
*/
define("moxie/runtime/html5/image/ExifParser", [
	"moxie/core/utils/Basic",
	"moxie/runtime/html5/utils/BinaryReader",
	"moxie/core/Exceptions"
], function(Basic, BinaryReader, x) {
	
	function ExifParser(data) {
		var __super__, tags, tagDescs, offsets, idx, Tiff;
		
		BinaryReader.call(this, data);

		tags = {
			tiff: {
				/*
				The image orientation viewed in terms of rows and columns.

				1 = The 0th row is at the visual top of the image, and the 0th column is the visual left-hand side.
				2 = The 0th row is at the visual top of the image, and the 0th column is the visual right-hand side.
				3 = The 0th row is at the visual bottom of the image, and the 0th column is the visual right-hand side.
				4 = The 0th row is at the visual bottom of the image, and the 0th column is the visual left-hand side.
				5 = The 0th row is the visual left-hand side of the image, and the 0th column is the visual top.
				6 = The 0th row is the visual right-hand side of the image, and the 0th column is the visual top.
				7 = The 0th row is the visual right-hand side of the image, and the 0th column is the visual bottom.
				8 = The 0th row is the visual left-hand side of the image, and the 0th column is the visual bottom.
				*/
				0x0112: 'Orientation',
				0x010E: 'ImageDescription',
				0x010F: 'Make',
				0x0110: 'Model',
				0x0131: 'Software',
				0x8769: 'ExifIFDPointer',
				0x8825:	'GPSInfoIFDPointer'
			},
			exif: {
				0x9000: 'ExifVersion',
				0xA001: 'ColorSpace',
				0xA002: 'PixelXDimension',
				0xA003: 'PixelYDimension',
				0x9003: 'DateTimeOriginal',
				0x829A: 'ExposureTime',
				0x829D: 'FNumber',
				0x8827: 'ISOSpeedRatings',
				0x9201: 'ShutterSpeedValue',
				0x9202: 'ApertureValue'	,
				0x9207: 'MeteringMode',
				0x9208: 'LightSource',
				0x9209: 'Flash',
				0x920A: 'FocalLength',
				0xA402: 'ExposureMode',
				0xA403: 'WhiteBalance',
				0xA406: 'SceneCaptureType',
				0xA404: 'DigitalZoomRatio',
				0xA408: 'Contrast',
				0xA409: 'Saturation',
				0xA40A: 'Sharpness'
			},
			gps: {
				0x0000: 'GPSVersionID',
				0x0001: 'GPSLatitudeRef',
				0x0002: 'GPSLatitude',
				0x0003: 'GPSLongitudeRef',
				0x0004: 'GPSLongitude'
			},

			thumb: {
				0x0201: 'JPEGInterchangeFormat',
				0x0202: 'JPEGInterchangeFormatLength'
			}
		};

		tagDescs = {
			'ColorSpace': {
				1: 'sRGB',
				0: 'Uncalibrated'
			},

			'MeteringMode': {
				0: 'Unknown',
				1: 'Average',
				2: 'CenterWeightedAverage',
				3: 'Spot',
				4: 'MultiSpot',
				5: 'Pattern',
				6: 'Partial',
				255: 'Other'
			},

			'LightSource': {
				1: 'Daylight',
				2: 'Fliorescent',
				3: 'Tungsten',
				4: 'Flash',
				9: 'Fine weather',
				10: 'Cloudy weather',
				11: 'Shade',
				12: 'Daylight fluorescent (D 5700 - 7100K)',
				13: 'Day white fluorescent (N 4600 -5400K)',
				14: 'Cool white fluorescent (W 3900 - 4500K)',
				15: 'White fluorescent (WW 3200 - 3700K)',
				17: 'Standard light A',
				18: 'Standard light B',
				19: 'Standard light C',
				20: 'D55',
				21: 'D65',
				22: 'D75',
				23: 'D50',
				24: 'ISO studio tungsten',
				255: 'Other'
			},

			'Flash': {
				0x0000: 'Flash did not fire',
				0x0001: 'Flash fired',
				0x0005: 'Strobe return light not detected',
				0x0007: 'Strobe return light detected',
				0x0009: 'Flash fired, compulsory flash mode',
				0x000D: 'Flash fired, compulsory flash mode, return light not detected',
				0x000F: 'Flash fired, compulsory flash mode, return light detected',
				0x0010: 'Flash did not fire, compulsory flash mode',
				0x0018: 'Flash did not fire, auto mode',
				0x0019: 'Flash fired, auto mode',
				0x001D: 'Flash fired, auto mode, return light not detected',
				0x001F: 'Flash fired, auto mode, return light detected',
				0x0020: 'No flash function',
				0x0041: 'Flash fired, red-eye reduction mode',
				0x0045: 'Flash fired, red-eye reduction mode, return light not detected',
				0x0047: 'Flash fired, red-eye reduction mode, return light detected',
				0x0049: 'Flash fired, compulsory flash mode, red-eye reduction mode',
				0x004D: 'Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected',
				0x004F: 'Flash fired, compulsory flash mode, red-eye reduction mode, return light detected',
				0x0059: 'Flash fired, auto mode, red-eye reduction mode',
				0x005D: 'Flash fired, auto mode, return light not detected, red-eye reduction mode',
				0x005F: 'Flash fired, auto mode, return light detected, red-eye reduction mode'
			},

			'ExposureMode': {
				0: 'Auto exposure',
				1: 'Manual exposure',
				2: 'Auto bracket'
			},

			'WhiteBalance': {
				0: 'Auto white balance',
				1: 'Manual white balance'
			},

			'SceneCaptureType': {
				0: 'Standard',
				1: 'Landscape',
				2: 'Portrait',
				3: 'Night scene'
			},

			'Contrast': {
				0: 'Normal',
				1: 'Soft',
				2: 'Hard'
			},

			'Saturation': {
				0: 'Normal',
				1: 'Low saturation',
				2: 'High saturation'
			},

			'Sharpness': {
				0: 'Normal',
				1: 'Soft',
				2: 'Hard'
			},

			// GPS related
			'GPSLatitudeRef': {
				N: 'North latitude',
				S: 'South latitude'
			},

			'GPSLongitudeRef': {
				E: 'East longitude',
				W: 'West longitude'
			}
		};

		offsets = {
			tiffHeader: 10
		};
		
		idx = offsets.tiffHeader;

		__super__ = {
			clear: this.clear
		};

		// Public functions
		Basic.extend(this, {
			
			read: function() {
				try {
					return ExifParser.prototype.read.apply(this, arguments);
				} catch (ex) {
					throw new x.ImageError(x.ImageError.INVALID_META_ERR);
				}
			},


			write: function() {
				try {
					return ExifParser.prototype.write.apply(this, arguments);
				} catch (ex) {
					throw new x.ImageError(x.ImageError.INVALID_META_ERR);
				}
			},


			UNDEFINED: function() {
				return this.BYTE.apply(this, arguments);
			},


			RATIONAL: function(idx) {
				return this.LONG(idx) / this.LONG(idx + 4)
			},


			SRATIONAL: function(idx) {
				return this.SLONG(idx) / this.SLONG(idx + 4)
			},

			ASCII: function(idx) {
				return this.CHAR(idx);
			},

			TIFF: function() {
				return Tiff || null;
			},


			EXIF: function() {
				var Exif = null;

				if (offsets.exifIFD) {
					try {
						Exif = extractTags.call(this, offsets.exifIFD, tags.exif);
					} catch(ex) {
						return null;
					}

					// Fix formatting of some tags
					if (Exif.ExifVersion && Basic.typeOf(Exif.ExifVersion) === 'array') {
						for (var i = 0, exifVersion = ''; i < Exif.ExifVersion.length; i++) {
							exifVersion += String.fromCharCode(Exif.ExifVersion[i]);
						}
						Exif.ExifVersion = exifVersion;
					}
				}

				return Exif;
			},


			GPS: function() {
				var GPS = null;

				if (offsets.gpsIFD) {
					try {
						GPS = extractTags.call(this, offsets.gpsIFD, tags.gps);
					} catch (ex) {
						return null;
					}

					// iOS devices (and probably some others) do not put in GPSVersionID tag (why?..)
					if (GPS.GPSVersionID && Basic.typeOf(GPS.GPSVersionID) === 'array') {
						GPS.GPSVersionID = GPS.GPSVersionID.join('.');
					}
				}

				return GPS;
			},


			thumb: function() {
				if (offsets.IFD1) {
					try {
						var IFD1Tags = extractTags.call(this, offsets.IFD1, tags.thumb);
						
						if ('JPEGInterchangeFormat' in IFD1Tags) {
							return this.SEGMENT(offsets.tiffHeader + IFD1Tags.JPEGInterchangeFormat, IFD1Tags.JPEGInterchangeFormatLength);
						}
					} catch (ex) {}
				}
				return null;
			},


			setExif: function(tag, value) {
				// Right now only setting of width/height is possible
				if (tag !== 'PixelXDimension' && tag !== 'PixelYDimension') { return false; }

				return setTag.call(this, 'exif', tag, value);
			},


			clear: function() {
				__super__.clear();
				data = tags = tagDescs = Tiff = offsets = __super__ = null;
			}
		});


		// Check if that's APP1 and that it has EXIF
		if (this.SHORT(0) !== 0xFFE1 || this.STRING(4, 5).toUpperCase() !== "EXIF\0") {
			throw new x.ImageError(x.ImageError.INVALID_META_ERR);
		}

		// Set read order of multi-byte data
		this.littleEndian = (this.SHORT(idx) == 0x4949);

		// Check if always present bytes are indeed present
		if (this.SHORT(idx+=2) !== 0x002A) {
			throw new x.ImageError(x.ImageError.INVALID_META_ERR);
		}

		offsets.IFD0 = offsets.tiffHeader + this.LONG(idx += 2);
		Tiff = extractTags.call(this, offsets.IFD0, tags.tiff);

		if ('ExifIFDPointer' in Tiff) {
			offsets.exifIFD = offsets.tiffHeader + Tiff.ExifIFDPointer;
			delete Tiff.ExifIFDPointer;
		}

		if ('GPSInfoIFDPointer' in Tiff) {
			offsets.gpsIFD = offsets.tiffHeader + Tiff.GPSInfoIFDPointer;
			delete Tiff.GPSInfoIFDPointer;
		}

		if (Basic.isEmptyObj(Tiff)) {
			Tiff = null;
		}

		// check if we have a thumb as well
		var IFD1Offset = this.LONG(offsets.IFD0 + this.SHORT(offsets.IFD0) * 12 + 2);
		if (IFD1Offset) {
			offsets.IFD1 = offsets.tiffHeader + IFD1Offset;
		}


		function extractTags(IFD_offset, tags2extract) {
			var data = this;
			var length, i, tag, type, count, size, offset, value, values = [], hash = {};
			
			var types = {
				1 : 'BYTE',
				7 : 'UNDEFINED',
				2 : 'ASCII',
				3 : 'SHORT',
				4 : 'LONG',
				5 : 'RATIONAL',
				9 : 'SLONG',
				10: 'SRATIONAL'
			};

			var sizes = {
				'BYTE' 		: 1,
				'UNDEFINED'	: 1,
				'ASCII'		: 1,
				'SHORT'		: 2,
				'LONG' 		: 4,
				'RATIONAL' 	: 8,
				'SLONG'		: 4,
				'SRATIONAL'	: 8
			};

			length = data.SHORT(IFD_offset);

			// The size of APP1 including all these elements shall not exceed the 64 Kbytes specified in the JPEG standard.

			for (i = 0; i < length; i++) {
				values = [];

				// Set binary reader pointer to beginning of the next tag
				offset = IFD_offset + 2 + i*12;

				tag = tags2extract[data.SHORT(offset)];

				if (tag === undefined) {
					continue; // Not the tag we requested
				}

				type = types[data.SHORT(offset+=2)];
				count = data.LONG(offset+=2);
				size = sizes[type];

				if (!size) {
					throw new x.ImageError(x.ImageError.INVALID_META_ERR);
				}

				offset += 4;

				// tag can only fit 4 bytes of data, if data is larger we should look outside
				if (size * count > 4) {
					// instead of data tag contains an offset of the data
					offset = data.LONG(offset) + offsets.tiffHeader;
				}

				// in case we left the boundaries of data throw an early exception
				if (offset + size * count >= this.length()) {
					throw new x.ImageError(x.ImageError.INVALID_META_ERR);
				} 

				// special care for the string
				if (type === 'ASCII') {
					hash[tag] = Basic.trim(data.STRING(offset, count).replace(/\0$/, '')); // strip trailing NULL
					continue;
				} else {
					values = data.asArray(type, offset, count);
					value = (count == 1 ? values[0] : values);

					if (tagDescs.hasOwnProperty(tag) && typeof value != 'object') {
						hash[tag] = tagDescs[tag][value];
					} else {
						hash[tag] = value;
					}
				}
			}

			return hash;
		}

		// At the moment only setting of simple (LONG) values, that do not require offset recalculation, is supported
		function setTag(ifd, tag, value) {
			var offset, length, tagOffset, valueOffset = 0;

			// If tag name passed translate into hex key
			if (typeof(tag) === 'string') {
				var tmpTags = tags[ifd.toLowerCase()];
				for (var hex in tmpTags) {
					if (tmpTags[hex] === tag) {
						tag = hex;
						break;
					}
				}
			}
			offset = offsets[ifd.toLowerCase() + 'IFD'];
			length = this.SHORT(offset);

			for (var i = 0; i < length; i++) {
				tagOffset = offset + 12 * i + 2;

				if (this.SHORT(tagOffset) == tag) {
					valueOffset = tagOffset + 8;
					break;
				}
			}

			if (!valueOffset) {
				return false;
			}

			try {
				this.write(valueOffset, value, 4);
			} catch(ex) {
				return false;
			}

			return true;
		}
	}

	ExifParser.prototype = BinaryReader.prototype;

	return ExifParser;
});

// Included from: src/javascript/runtime/html5/image/JPEG.js

/**
 * JPEG.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/**
@class moxie/runtime/html5/image/JPEG
@private
*/
define("moxie/runtime/html5/image/JPEG", [
	"moxie/core/utils/Basic",
	"moxie/core/Exceptions",
	"moxie/runtime/html5/image/JPEGHeaders",
	"moxie/runtime/html5/utils/BinaryReader",
	"moxie/runtime/html5/image/ExifParser"
], function(Basic, x, JPEGHeaders, BinaryReader, ExifParser) {
	
	function JPEG(data) {
		var _br, _hm, _ep, _info;

		_br = new BinaryReader(data);

		// check if it is jpeg
		if (_br.SHORT(0) !== 0xFFD8) {
			throw new x.ImageError(x.ImageError.WRONG_FORMAT);
		}

		// backup headers
		_hm = new JPEGHeaders(data);

		// extract exif info
		try {
			_ep = new ExifParser(_hm.get('app1')[0]);
		} catch(ex) {}

		// get dimensions
		_info = _getDimensions.call(this);

		Basic.extend(this, {
			type: 'image/jpeg',

			size: _br.length(),

			width: _info && _info.width || 0,

			height: _info && _info.height || 0,

			setExif: function(tag, value) {
				if (!_ep) {
					return false; // or throw an exception
				}

				if (Basic.typeOf(tag) === 'object') {
					Basic.each(tag, function(value, tag) {
						_ep.setExif(tag, value);
					});
				} else {
					_ep.setExif(tag, value);
				}

				// update internal headers
				_hm.set('app1', _ep.SEGMENT());
			},

			writeHeaders: function() {
				if (!arguments.length) {
					// if no arguments passed, update headers internally
					return _hm.restore(data);
				}
				return _hm.restore(arguments[0]);
			},

			stripHeaders: function(data) {
				return _hm.strip(data);
			},

			purge: function() {
				_purge.call(this);
			}
		});

		if (_ep) {
			this.meta = {
				tiff: _ep.TIFF(),
				exif: _ep.EXIF(),
				gps: _ep.GPS(),
				thumb: _getThumb()
			};
		}


		function _getDimensions(br) {
			var idx = 0
			, marker
			, length
			;

			if (!br) {
				br = _br;
			}

			// examine all through the end, since some images might have very large APP segments
			while (idx <= br.length()) {
				marker = br.SHORT(idx += 2);

				if (marker >= 0xFFC0 && marker <= 0xFFC3) { // SOFn
					idx += 5; // marker (2 bytes) + length (2 bytes) + Sample precision (1 byte)
					return {
						height: br.SHORT(idx),
						width: br.SHORT(idx += 2)
					};
				}
				length = br.SHORT(idx += 2);
				idx += length - 2;
			}
			return null;
		}


		function _getThumb() {
			var data =  _ep.thumb()
			, br
			, info
			;

			if (data) {
				br = new BinaryReader(data);
				info = _getDimensions(br);
				br.clear();

				if (info) {
					info.data = data;
					return info;
				}
			}
			return null;
		}


		function _purge() {
			if (!_ep || !_hm || !_br) { 
				return; // ignore any repeating purge requests
			}
			_ep.clear();
			_hm.purge();
			_br.clear();
			_info = _hm = _ep = _br = null;
		}
	}

	return JPEG;
});

// Included from: src/javascript/runtime/html5/image/PNG.js

/**
 * PNG.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/**
@class moxie/runtime/html5/image/PNG
@private
*/
define("moxie/runtime/html5/image/PNG", [
	"moxie/core/Exceptions",
	"moxie/core/utils/Basic",
	"moxie/runtime/html5/utils/BinaryReader"
], function(x, Basic, BinaryReader) {
	
	function PNG(data) {
		var _br, _hm, _ep, _info;

		_br = new BinaryReader(data);

		// check if it's png
		(function() {
			var idx = 0, i = 0
			, signature = [0x8950, 0x4E47, 0x0D0A, 0x1A0A]
			;

			for (i = 0; i < signature.length; i++, idx += 2) {
				if (signature[i] != _br.SHORT(idx)) {
					throw new x.ImageError(x.ImageError.WRONG_FORMAT);
				}
			}
		}());

		function _getDimensions() {
			var chunk, idx;

			chunk = _getChunkAt.call(this, 8);

			if (chunk.type == 'IHDR') {
				idx = chunk.start;
				return {
					width: _br.LONG(idx),
					height: _br.LONG(idx += 4)
				};
			}
			return null;
		}

		function _purge() {
			if (!_br) {
				return; // ignore any repeating purge requests
			}
			_br.clear();
			data = _info = _hm = _ep = _br = null;
		}

		_info = _getDimensions.call(this);

		Basic.extend(this, {
			type: 'image/png',

			size: _br.length(),

			width: _info.width,

			height: _info.height,

			purge: function() {
				_purge.call(this);
			}
		});

		// for PNG we can safely trigger purge automatically, as we do not keep any data for later
		_purge.call(this);

		function _getChunkAt(idx) {
			var length, type, start, CRC;

			length = _br.LONG(idx);
			type = _br.STRING(idx += 4, 4);
			start = idx += 4;
			CRC = _br.LONG(idx + length);

			return {
				length: length,
				type: type,
				start: start,
				CRC: CRC
			};
		}
	}

	return PNG;
});

// Included from: src/javascript/runtime/html5/image/ImageInfo.js

/**
 * ImageInfo.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/**
Optional image investigation tool for HTML5 runtime. Provides the following features:
- ability to distinguish image type (JPEG or PNG) by signature
- ability to extract image width/height directly from it's internals, without preloading in memory (fast)
- ability to extract APP headers from JPEGs (Exif, GPS, etc)
- ability to replace width/height tags in extracted JPEG headers
- ability to restore APP headers, that were for example stripped during image manipulation

@class moxie/runtime/html5/image/ImageInfo
@private
@param {String} data Image source as binary string
*/
define("moxie/runtime/html5/image/ImageInfo", [
	"moxie/core/utils/Basic",
	"moxie/core/Exceptions",
	"moxie/runtime/html5/image/JPEG",
	"moxie/runtime/html5/image/PNG"
], function(Basic, x, JPEG, PNG) {

	return function(data) {
		var _cs = [JPEG, PNG], _img;

		// figure out the format, throw: ImageError.WRONG_FORMAT if not supported
		_img = (function() {
			for (var i = 0; i < _cs.length; i++) {
				try {
					return new _cs[i](data);
				} catch (ex) {
					// console.info(ex);
				}
			}
			throw new x.ImageError(x.ImageError.WRONG_FORMAT);
		}());

		Basic.extend(this, {
			/**
			Image Mime Type extracted from it's depths

			@property type
			@type {String}
			@default ''
			*/
			type: '',

			/**
			Image size in bytes

			@property size
			@type {Number}
			@default 0
			*/
			size: 0,

			/**
			Image width extracted from image source

			@property width
			@type {Number}
			@default 0
			*/
			width: 0,

			/**
			Image height extracted from image source

			@property height
			@type {Number}
			@default 0
			*/
			height: 0,

			/**
			Sets Exif tag. Currently applicable only for width and height tags. Obviously works only with JPEGs.

			@method setExif
			@param {String} tag Tag to set
			@param {Mixed} value Value to assign to the tag
			*/
			setExif: function() {},

			/**
			Restores headers to the source.

			@method writeHeaders
			@param {String} data Image source as binary string
			@return {String} Updated binary string
			*/
			writeHeaders: function(data) {
				return data;
			},

			/**
			Strip all headers from the source.

			@method stripHeaders
			@param {String} data Image source as binary string
			@return {String} Updated binary string
			*/
			stripHeaders: function(data) {
				return data;
			},

			/**
			Dispose resources.

			@method purge
			*/
			purge: function() {
				data = null;
			}
		});

		Basic.extend(this, _img);

		this.purge = function() {
			_img.purge();
			_img = null;
		};
	};
});

// Included from: src/javascript/runtime/html5/image/ResizerCanvas.js

/**
 * ResizerCanvas.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/**
 * Resizes image/canvas using canvas
 */
define("moxie/runtime/html5/image/ResizerCanvas", [], function() {

    function scale(image, ratio, resample) {
        var sD = image.width > image.height ? 'width' : 'height'; // take the largest side
        var dD = Math.round(image[sD] * ratio);
        var scaleCapped = false;

        if (resample !== 'nearest' && (ratio < 0.5 || ratio > 2)) {
            ratio = ratio < 0.5 ? 0.5 : 2;
            scaleCapped = true;
        }

        var tCanvas = _scale(image, ratio);

        if (scaleCapped) {
            return scale(tCanvas, dD / tCanvas[sD], resample);
        } else {
            return tCanvas;
        }
    }


    function _scale(image, ratio) {
        var sW = image.width;
        var sH = image.height;
        var dW = Math.round(sW * ratio);
        var dH = Math.round(sH * ratio);

        var canvas = document.createElement('canvas');
        canvas.width = dW;
        canvas.height = dH;
        canvas.getContext("2d").drawImage(image, 0, 0, sW, sH, 0, 0, dW, dH);

        image = null; // just in case
        return canvas;
    }

    return {
        scale: scale
    };

});

// Included from: src/javascript/runtime/html5/image/Image.js

/**
 * Image.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/**
@class moxie/runtime/html5/image/Image
@private
*/
define("moxie/runtime/html5/image/Image", [
	"moxie/runtime/html5/Runtime",
	"moxie/core/utils/Basic",
	"moxie/core/Exceptions",
	"moxie/core/utils/Encode",
	"moxie/file/Blob",
	"moxie/file/File",
	"moxie/runtime/html5/image/ImageInfo",
	"moxie/runtime/html5/image/ResizerCanvas",
	"moxie/core/utils/Mime",
	"moxie/core/utils/Env"
], function(extensions, Basic, x, Encode, Blob, File, ImageInfo, ResizerCanvas, Mime, Env) {

	function HTML5Image() {
		var me = this
		, _img, _imgInfo, _canvas, _binStr, _blob
		, _modified = false // is set true whenever image is modified
		, _preserveHeaders = true
		;

		Basic.extend(this, {
			loadFromBlob: function(blob) {
				var I = this.getRuntime()
				, asBinary = arguments.length > 1 ? arguments[1] : true
				;

				if (!I.can('access_binary')) {
					throw new x.RuntimeError(x.RuntimeError.NOT_SUPPORTED_ERR);
				}

				_blob = blob;

				if (blob.isDetached()) {
					_binStr = blob.getSource();
					_preload.call(this, _binStr);
					return;
				} else {
					_readAsDataUrl.call(this, blob.getSource(), function(dataUrl) {
						if (asBinary) {
							_binStr = _toBinary(dataUrl);
						}
						_preload.call(this, dataUrl);
					});
				}
			},

			loadFromImage: function(img, exact) {
				this.meta = img.meta;

				_blob = new File(null, {
					name: img.name,
					size: img.size,
					type: img.type
				});

				_preload.call(this, exact ? (_binStr = img.getAsBinaryString()) : img.getAsDataURL());
			},

			getInfo: function() {
				var I = this.getRuntime(), info;

				if (!_imgInfo && _binStr && I.can('access_image_binary')) {
					_imgInfo = new ImageInfo(_binStr);
				}

				// this stuff below is definitely having fun with itself
				info = {
					width: _getImg().width || 0,
					height: _getImg().height || 0,
					type: _blob.type || Mime.getFileMime(_blob.name),
					size: _binStr && _binStr.length || _blob.size || 0,
					name: _blob.name || '',
					meta: null
				};

				if (_preserveHeaders) {
					info.meta = _imgInfo && _imgInfo.meta || this.meta || {};

					// if data was taken from ImageInfo it will be a binary string, so we convert it to blob
					if (info.meta && info.meta.thumb && !(info.meta.thumb.data instanceof Blob)) {
						info.meta.thumb.data = new Blob(null, {
							type: 'image/jpeg',
							data: info.meta.thumb.data
						});
					}
				}

				return info;
			},


			resize: function(rect, ratio, options) {
				var canvas = document.createElement('canvas');
				canvas.width = rect.width;
				canvas.height = rect.height;

				canvas.getContext("2d").drawImage(_getImg(), rect.x, rect.y, rect.width, rect.height, 0, 0, canvas.width, canvas.height);

				_canvas = ResizerCanvas.scale(canvas, ratio);

				_preserveHeaders = options.preserveHeaders;

				// rotate if required, according to orientation tag
				if (!_preserveHeaders) {
					var orientation = (this.meta && this.meta.tiff && this.meta.tiff.Orientation) || 1;
					_canvas = _rotateToOrientaion(_canvas, orientation);
				}

				this.width = _canvas.width;
				this.height = _canvas.height;

				_modified = true;

				this.trigger('Resize');
			},

			getAsCanvas: function() {
				if (!_canvas) {
					_canvas = _getCanvas();
				}
				_canvas.id = this.uid + '_canvas';
				return _canvas;
			},

			getAsBlob: function(type, quality) {
				if (type !== this.type) {
					_modified = true; // reconsider the state
					return new File(null, {
						name: _blob.name || '',
						type: type,
						data: me.getAsDataURL(type, quality)
					});
				}
				return new File(null, {
					name: _blob.name || '',
					type: type,
					data: me.getAsBinaryString(type, quality)
				});
			},

			getAsDataURL: function(type) {
				var quality = arguments[1] || 90;

				// if image has not been modified, return the source right away
				if (!_modified) {
					return _img.src;
				}

				// make sure we have a canvas to work with
				_getCanvas();

				if ('image/jpeg' !== type) {
					return _canvas.toDataURL('image/png');
				} else {
					try {
						// older Geckos used to result in an exception on quality argument
						return _canvas.toDataURL('image/jpeg', quality/100);
					} catch (ex) {
						return _canvas.toDataURL('image/jpeg');
					}
				}
			},

			getAsBinaryString: function(type, quality) {
				// if image has not been modified, return the source right away
				if (!_modified) {
					// if image was not loaded from binary string
					if (!_binStr) {
						_binStr = _toBinary(me.getAsDataURL(type, quality));
					}
					return _binStr;
				}

				if ('image/jpeg' !== type) {
					_binStr = _toBinary(me.getAsDataURL(type, quality));
				} else {
					var dataUrl;

					// if jpeg
					if (!quality) {
						quality = 90;
					}

					// make sure we have a canvas to work with
					_getCanvas();

					try {
						// older Geckos used to result in an exception on quality argument
						dataUrl = _canvas.toDataURL('image/jpeg', quality/100);
					} catch (ex) {
						dataUrl = _canvas.toDataURL('image/jpeg');
					}

					_binStr = _toBinary(dataUrl);

					if (_imgInfo) {
						_binStr = _imgInfo.stripHeaders(_binStr);

						if (_preserveHeaders) {
							// update dimensions info in exif
							if (_imgInfo.meta && _imgInfo.meta.exif) {
								_imgInfo.setExif({
									PixelXDimension: this.width,
									PixelYDimension: this.height
								});
							}

							// re-inject the headers
							_binStr = _imgInfo.writeHeaders(_binStr);
						}

						// will be re-created from fresh on next getInfo call
						_imgInfo.purge();
						_imgInfo = null;
					}
				}

				_modified = false;

				return _binStr;
			},

			destroy: function() {
				me = null;
				_purge.call(this);
				this.getRuntime().getShim().removeInstance(this.uid);
			}
		});


		function _getImg() {
			if (!_canvas && !_img) {
				throw new x.ImageError(x.DOMException.INVALID_STATE_ERR);
			}
			return _canvas || _img;
		}


		function _getCanvas() {
			var canvas = _getImg();
			if (canvas.nodeName.toLowerCase() == 'canvas') {
				return canvas;
			}
			_canvas = document.createElement('canvas');
			_canvas.width = canvas.width;
			_canvas.height = canvas.height;
			_canvas.getContext("2d").drawImage(canvas, 0, 0);
			return _canvas;
		}


		function _toBinary(str) {
			return Encode.atob(str.substring(str.indexOf('base64,') + 7));
		}


		function _toDataUrl(str, type) {
			return 'data:' + (type || '') + ';base64,' + Encode.btoa(str);
		}


		function _preload(str) {
			var comp = this;

			_img = new Image();
			_img.onerror = function() {
				_purge.call(this);
				comp.trigger('error', x.ImageError.WRONG_FORMAT);
			};
			_img.onload = function() {
				comp.trigger('load');
			};

			_img.src = str.substr(0, 5) == 'data:' ? str : _toDataUrl(str, _blob.type);
		}


		function _readAsDataUrl(file, callback) {
			var comp = this, fr;

			// use FileReader if it's available
			if (window.FileReader) {
				fr = new FileReader();
				fr.onload = function() {
					callback.call(comp, this.result);
				};
				fr.onerror = function() {
					comp.trigger('error', x.ImageError.WRONG_FORMAT);
				};
				fr.readAsDataURL(file);
			} else {
				return callback.call(this, file.getAsDataURL());
			}
		}

		/**
		* Transform canvas coordination according to specified frame size and orientation
		* Orientation value is from EXIF tag
		* @author Shinichi Tomita <shinichi.tomita@gmail.com>
		*/
		function _rotateToOrientaion(img, orientation) {
			var RADIANS = Math.PI/180;
			var canvas = document.createElement('canvas');
			var ctx = canvas.getContext('2d');
			var width = img.width;
			var height = img.height;

			if (Basic.inArray(orientation, [5,6,7,8]) > -1) {
				canvas.width = height;
				canvas.height = width;
			} else {
				canvas.width = width;
				canvas.height = height;
			}

			/**
			1 = The 0th row is at the visual top of the image, and the 0th column is the visual left-hand side.
			2 = The 0th row is at the visual top of the image, and the 0th column is the visual right-hand side.
			3 = The 0th row is at the visual bottom of the image, and the 0th column is the visual right-hand side.
			4 = The 0th row is at the visual bottom of the image, and the 0th column is the visual left-hand side.
			5 = The 0th row is the visual left-hand side of the image, and the 0th column is the visual top.
			6 = The 0th row is the visual right-hand side of the image, and the 0th column is the visual top.
			7 = The 0th row is the visual right-hand side of the image, and the 0th column is the visual bottom.
			8 = The 0th row is the visual left-hand side of the image, and the 0th column is the visual bottom.
			*/
			switch (orientation) {
				case 2:
					// horizontal flip
					ctx.translate(width, 0);
					ctx.scale(-1, 1);
					break;
				case 3:
					// 180 rotate left
					ctx.translate(width, height);
					ctx.rotate(180 * RADIANS);
					break;
				case 4:
					// vertical flip
					ctx.translate(0, height);
					ctx.scale(1, -1);
					break;
				case 5:
					// vertical flip + 90 rotate right
					ctx.rotate(90 * RADIANS);
					ctx.scale(1, -1);
					break;
				case 6:
					// 90 rotate right
					ctx.rotate(90 * RADIANS);
					ctx.translate(0, -height);
					break;
				case 7:
					// horizontal flip + 90 rotate right
					ctx.rotate(90 * RADIANS);
					ctx.translate(width, -height);
					ctx.scale(-1, 1);
					break;
				case 8:
					// 90 rotate left
					ctx.rotate(-90 * RADIANS);
					ctx.translate(-width, 0);
					break;
			}

			ctx.drawImage(img, 0, 0, width, height);
			return canvas;
		}


		function _purge() {
			if (_imgInfo) {
				_imgInfo.purge();
				_imgInfo = null;
			}

			_binStr = _img = _canvas = _blob = null;
			_modified = false;
		}
	}

	return (extensions.Image = HTML5Image);
});

// Included from: src/javascript/runtime/flash/Runtime.js

/**
 * Runtime.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/*global ActiveXObject:true */

/**
Defines constructor for Flash runtime.

@class moxie/runtime/flash/Runtime
@private
*/
define("moxie/runtime/flash/Runtime", [
	"moxie/core/utils/Basic",
	"moxie/core/utils/Env",
	"moxie/core/utils/Dom",
	"moxie/core/Exceptions",
	"moxie/runtime/Runtime"
], function(Basic, Env, Dom, x, Runtime) {
	
	var type = 'flash', extensions = {};

	/**
	Get the version of the Flash Player

	@method getShimVersion
	@private
	@return {Number} Flash Player version
	*/
	function getShimVersion() {
		var version;

		try {
			version = navigator.plugins['Shockwave Flash'];
			version = version.description;
		} catch (e1) {
			try {
				version = new ActiveXObject('ShockwaveFlash.ShockwaveFlash').GetVariable('$version');
			} catch (e2) {
				version = '0.0';
			}
		}
		version = version.match(/\d+/g);
		return parseFloat(version[0] + '.' + version[1]);
	}


	/**
	Cross-browser SWF removal
    	- Especially needed to safely and completely remove a SWF in Internet Explorer

   	Originated from SWFObject v2.2 <http://code.google.com/p/swfobject/> 
	*/
	function removeSWF(id) {
        var obj = Dom.get(id);
        if (obj && obj.nodeName == "OBJECT") {
            if (Env.browser === 'IE') {
                obj.style.display = "none";
                (function onInit(){
                	// http://msdn.microsoft.com/en-us/library/ie/ms534360(v=vs.85).aspx
                    if (obj.readyState == 4) {
                        removeObjectInIE(id);
                    }
                    else {
                        setTimeout(onInit, 10);
                    }
                })();
            }
            else {
                obj.parentNode.removeChild(obj);
            }
        }
    }


	function removeObjectInIE(id) {
        var obj = Dom.get(id);
        if (obj) {
            for (var i in obj) {
                if (typeof obj[i] == "function") {
                    obj[i] = null;
                }
            }
            obj.parentNode.removeChild(obj);
        }
    }

	/**
	Constructor for the Flash Runtime
	*/
	function FlashRuntime(options) {
		var I = this, initTimer;

		options = Basic.extend({ swf_url: Env.swf_url }, options);

		Runtime.call(this, options, type, {
			access_binary: function(value) {
				return value && I.mode === 'browser';
			},
			access_image_binary: function(value) {
				return value && I.mode === 'browser';
			},
			display_media: Runtime.capTest(defined('moxie/image/Image')),
			do_cors: Runtime.capTrue,
			drag_and_drop: false,
			report_upload_progress: function() {
				return I.mode === 'client';
			},
			resize_image: Runtime.capTrue,
			return_response_headers: false,
			return_response_type: function(responseType) {
				if (responseType === 'json' && !!window.JSON) {
					return true;
				} 
				return !Basic.arrayDiff(responseType, ['', 'text', 'document']) || I.mode === 'browser';
			},
			return_status_code: function(code) {
				return I.mode === 'browser' || !Basic.arrayDiff(code, [200, 404]);
			},
			select_file: Runtime.capTrue,
			select_multiple: Runtime.capTrue,
			send_binary_string: function(value) {
				return value && I.mode === 'browser';
			},
			send_browser_cookies: function(value) {
				return value && I.mode === 'browser';
			},
			send_custom_headers: function(value) {
				return value && I.mode === 'browser';
			},
			send_multipart: Runtime.capTrue,
			slice_blob: function(value) {
				return value && I.mode === 'browser';
			},
			stream_upload: function(value) {
				return value && I.mode === 'browser';
			},
			summon_file_dialog: false,
			upload_filesize: function(size) {
				return Basic.parseSizeStr(size) <= 2097152 || I.mode === 'client';
			},
			use_http_method: function(methods) {
				return !Basic.arrayDiff(methods, ['GET', 'POST']);
			}
		}, { 
			// capabilities that require specific mode
			access_binary: function(value) {
				return value ? 'browser' : 'client';
			},
			access_image_binary: function(value) {
				return value ? 'browser' : 'client';
			},
			report_upload_progress: function(value) {
				return value ? 'browser' : 'client';
			},
			return_response_type: function(responseType) {
				return Basic.arrayDiff(responseType, ['', 'text', 'json', 'document']) ? 'browser' : ['client', 'browser'];
			},
			return_status_code: function(code) {
				return Basic.arrayDiff(code, [200, 404]) ? 'browser' : ['client', 'browser'];
			},
			send_binary_string: function(value) {
				return value ? 'browser' : 'client';
			},
			send_browser_cookies: function(value) {
				return value ? 'browser' : 'client';
			},
			send_custom_headers: function(value) {
				return value ? 'browser' : 'client';
			},
			slice_blob: function(value) {
				return value ? 'browser' : 'client';
			},
			stream_upload: function(value) {
				return value ? 'client' : 'browser';
			},
			upload_filesize: function(size) {
				return Basic.parseSizeStr(size) >= 2097152 ? 'client' : 'browser';
			}
		}, 'client');


		// minimal requirement for Flash Player version
		if (getShimVersion() < 11.3) {
			if (MXI_DEBUG && Env.debug.runtime) {
				Env.log("\tFlash didn't meet minimal version requirement (11.3).");	
			}

			this.mode = false; // with falsy mode, runtime won't operable, no matter what the mode was before
		}


		Basic.extend(this, {

			getShim: function() {
				return Dom.get(this.uid);
			},

			shimExec: function(component, action) {
				var args = [].slice.call(arguments, 2);
				return I.getShim().exec(this.uid, component, action, args);
			},

			init: function() {
				var html, el, container;

				container = this.getShimContainer();

				// if not the minimal height, shims are not initialized in older browsers (e.g FF3.6, IE6,7,8, Safari 4.0,5.0, etc)
				Basic.extend(container.style, {
					position: 'absolute',
					top: '-8px',
					left: '-8px',
					width: '9px',
					height: '9px',
					overflow: 'hidden'
				});

				// insert flash object
				html = '<object id="' + this.uid + '" type="application/x-shockwave-flash" data="' +  options.swf_url + '" ';

				if (Env.browser === 'IE') {
					html += 'classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" ';
				}

				html += 'width="100%" height="100%" style="outline:0">'  +
					'<param name="movie" value="' + options.swf_url + '" />' +
					'<param name="flashvars" value="uid=' + escape(this.uid) + '&target=' + Runtime.getGlobalEventTarget() + '" />' +
					'<param name="wmode" value="transparent" />' +
					'<param name="allowscriptaccess" value="always" />' +
				'</object>';

				if (Env.browser === 'IE') {
					el = document.createElement('div');
					container.appendChild(el);
					el.outerHTML = html;
					el = container = null; // just in case
				} else {
					container.innerHTML = html;
				}

				// Init is dispatched by the shim
				initTimer = setTimeout(function() {
					if (I && !I.initialized) { // runtime might be already destroyed by this moment
						I.trigger("Error", new x.RuntimeError(x.RuntimeError.NOT_INIT_ERR));

						if (MXI_DEBUG && Env.debug.runtime) {
							Env.log("\tFlash failed to initialize within a specified period of time (typically 5s).");	
						}
					}
				}, 5000);
			},

			destroy: (function(destroy) { // extend default destroy method
				return function() {
					removeSWF(I.uid); // SWF removal requires special care in IE

					destroy.call(I);
					clearTimeout(initTimer); // initialization check might be still onwait
					options = initTimer = destroy = I = null;
				};
			}(this.destroy))

		}, extensions);
	}

	Runtime.addConstructor(type, FlashRuntime);

	return extensions;
});

// Included from: src/javascript/runtime/flash/file/Blob.js

/**
 * Blob.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/**
@class moxie/runtime/flash/file/Blob
@private
*/
define("moxie/runtime/flash/file/Blob", [
	"moxie/runtime/flash/Runtime",
	"moxie/file/Blob"
], function(extensions, Blob) {

	var FlashBlob = {
		slice: function(blob, start, end, type) {
			var self = this.getRuntime();

			if (start < 0) {
				start = Math.max(blob.size + start, 0);
			} else if (start > 0) {
				start = Math.min(start, blob.size);
			}

			if (end < 0) {
				end = Math.max(blob.size + end, 0);
			} else if (end > 0) {
				end = Math.min(end, blob.size);
			}

			blob = self.shimExec.call(this, 'Blob', 'slice', start, end, type || '');

			if (blob) {
				blob = new Blob(self.uid, blob);
			}
			return blob;
		}
	};

	return (extensions.Blob = FlashBlob);
});

// Included from: src/javascript/runtime/flash/file/FileInput.js

/**
 * FileInput.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/**
@class moxie/runtime/flash/file/FileInput
@private
*/
define("moxie/runtime/flash/file/FileInput", [
	"moxie/runtime/flash/Runtime",
	"moxie/file/File",
	"moxie/core/utils/Dom",
	"moxie/core/utils/Basic"
], function(extensions, File, Dom, Basic) {

	var FileInput = {
		init: function(options) {
			var comp = this, I = this.getRuntime();
			var browseButton = Dom.get(options.browse_button);

			if (browseButton) {
				browseButton.setAttribute('tabindex', -1);
				browseButton = null;
			}

			this.bind("Change", function() {
				var files = I.shimExec.call(comp, 'FileInput', 'getFiles');
				comp.files = [];
				Basic.each(files, function(file) {
					comp.files.push(new File(I.uid, file));
				});
			}, 999);

			this.getRuntime().shimExec.call(this, 'FileInput', 'init', {
				accept: options.accept,
				multiple: options.multiple
			});

			this.trigger('ready');
		}
	};

	return (extensions.FileInput = FileInput);
});

// Included from: src/javascript/runtime/flash/file/FileReader.js

/**
 * FileReader.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/**
@class moxie/runtime/flash/file/FileReader
@private
*/
define("moxie/runtime/flash/file/FileReader", [
	"moxie/runtime/flash/Runtime",
	"moxie/core/utils/Encode"
], function(extensions, Encode) {

	function _formatData(data, op) {
		switch (op) {
			case 'readAsText':
				return Encode.atob(data, 'utf8');
			case 'readAsBinaryString':
				return Encode.atob(data);
			case 'readAsDataURL':
				return data;
		}
		return null;
	}

	var FileReader = {
		read: function(op, blob) {
			var comp = this;

			comp.result = '';

			// special prefix for DataURL read mode
			if (op === 'readAsDataURL') {
				comp.result = 'data:' + (blob.type || '') + ';base64,';
			}

			comp.bind('Progress', function(e, data) {
				if (data) {
					comp.result += _formatData(data, op);
				}
			}, 999);

			return comp.getRuntime().shimExec.call(this, 'FileReader', 'readAsBase64', blob.uid);
		}
	};

	return (extensions.FileReader = FileReader);
});

// Included from: src/javascript/runtime/flash/file/FileReaderSync.js

/**
 * FileReaderSync.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/**
@class moxie/runtime/flash/file/FileReaderSync
@private
*/
define("moxie/runtime/flash/file/FileReaderSync", [
	"moxie/runtime/flash/Runtime",
	"moxie/core/utils/Encode"
], function(extensions, Encode) {
	
	function _formatData(data, op) {
		switch (op) {
			case 'readAsText':
				return Encode.atob(data, 'utf8');
			case 'readAsBinaryString':
				return Encode.atob(data);
			case 'readAsDataURL':
				return data;
		}
		return null;
	}

	var FileReaderSync = {
		read: function(op, blob) {
			var result, self = this.getRuntime();

			result = self.shimExec.call(this, 'FileReaderSync', 'readAsBase64', blob.uid);
			if (!result) {
				return null; // or throw ex
			}

			// special prefix for DataURL read mode
			if (op === 'readAsDataURL') {
				result = 'data:' + (blob.type || '') + ';base64,' + result;
			}

			return _formatData(result, op, blob.type);
		}
	};

	return (extensions.FileReaderSync = FileReaderSync);
});

// Included from: src/javascript/runtime/flash/runtime/Transporter.js

/**
 * Transporter.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/**
@class moxie/runtime/flash/runtime/Transporter
@private
*/
define("moxie/runtime/flash/runtime/Transporter", [
	"moxie/runtime/flash/Runtime",
	"moxie/file/Blob"
], function(extensions, Blob) {

	var Transporter = {
		getAsBlob: function(type) {
			var self = this.getRuntime()
			, blob = self.shimExec.call(this, 'Transporter', 'getAsBlob', type)
			;
			if (blob) {
				return new Blob(self.uid, blob);
			}
			return null;
		}
	};

	return (extensions.Transporter = Transporter);
});

// Included from: src/javascript/runtime/flash/xhr/XMLHttpRequest.js

/**
 * XMLHttpRequest.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/**
@class moxie/runtime/flash/xhr/XMLHttpRequest
@private
*/
define("moxie/runtime/flash/xhr/XMLHttpRequest", [
	"moxie/runtime/flash/Runtime",
	"moxie/core/utils/Basic",
	"moxie/file/Blob",
	"moxie/file/File",
	"moxie/file/FileReaderSync",
	"moxie/runtime/flash/file/FileReaderSync",
	"moxie/xhr/FormData",
	"moxie/runtime/Transporter",
	"moxie/runtime/flash/runtime/Transporter"
], function(extensions, Basic, Blob, File, FileReaderSync, FileReaderSyncFlash, FormData, Transporter, TransporterFlash) {
	
	var XMLHttpRequest = {

		send: function(meta, data) {
			var target = this, self = target.getRuntime();

			function send() {
				meta.transport = self.mode;
				self.shimExec.call(target, 'XMLHttpRequest', 'send', meta, data);
			}


			function appendBlob(name, blob) {
				self.shimExec.call(target, 'XMLHttpRequest', 'appendBlob', name, blob.uid);
				data = null;
				send();
			}


			function attachBlob(blob, cb) {
				var tr = new Transporter();

				tr.bind("TransportingComplete", function() {
					cb(this.result);
				});

				tr.transport(blob.getSource(), blob.type, {
					ruid: self.uid
				});
			}

			// copy over the headers if any
			if (!Basic.isEmptyObj(meta.headers)) {
				Basic.each(meta.headers, function(value, header) {
					self.shimExec.call(target, 'XMLHttpRequest', 'setRequestHeader', header, value.toString()); // Silverlight doesn't accept integers into the arguments of type object
				});
			}

			// transfer over multipart params and blob itself
			if (data instanceof FormData) {
				var blobField;
				data.each(function(value, name) {
					if (value instanceof Blob) {
						blobField = name;
					} else {
						self.shimExec.call(target, 'XMLHttpRequest', 'append', name, value);
					}
				});

				if (!data.hasBlob()) {
					data = null;
					send();
				} else {
					var blob = data.getBlob();
					if (blob.isDetached()) {
						attachBlob(blob, function(attachedBlob) {
							blob.destroy();
							appendBlob(blobField, attachedBlob);		
						});
					} else {
						appendBlob(blobField, blob);
					}
				}
			} else if (data instanceof Blob) {
				if (data.isDetached()) {
					attachBlob(data, function(attachedBlob) {
						data.destroy();
						data = attachedBlob.uid;
						send();
					});
				} else {
					data = data.uid;
					send();
				}
			} else {
				send();
			}
		},

		getResponse: function(responseType) {
			var frs, blob, self = this.getRuntime();

			blob = self.shimExec.call(this, 'XMLHttpRequest', 'getResponseAsBlob');

			if (blob) {
				blob = new File(self.uid, blob);

				if ('blob' === responseType) {
					return blob;
				}

				try { 
					frs = new FileReaderSync();

					if (!!~Basic.inArray(responseType, ["", "text"])) {
						return frs.readAsText(blob);
					} else if ('json' === responseType && !!window.JSON) {
						return JSON.parse(frs.readAsText(blob));
					}
				} finally {
					blob.destroy();
				}
			}
			return null;
		},

		abort: function(upload_complete_flag) {
			var self = this.getRuntime();

			self.shimExec.call(this, 'XMLHttpRequest', 'abort');

			this.dispatchEvent('readystatechange');
			// this.dispatchEvent('progress');
			this.dispatchEvent('abort');

			//if (!upload_complete_flag) {
				// this.dispatchEvent('uploadprogress');
			//}
		}
	};

	return (extensions.XMLHttpRequest = XMLHttpRequest);
});

// Included from: src/javascript/runtime/flash/image/Image.js

/**
 * Image.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/**
@class moxie/runtime/flash/image/Image
@private
*/
define("moxie/runtime/flash/image/Image", [
	"moxie/runtime/flash/Runtime",
	"moxie/core/utils/Basic",
	"moxie/runtime/Transporter",
	"moxie/file/Blob",
	"moxie/file/FileReaderSync"
], function(extensions, Basic, Transporter, Blob, FileReaderSync) {
	
	var Image = {
		loadFromBlob: function(blob) {
			var comp = this, self = comp.getRuntime();

			function exec(srcBlob) {
				self.shimExec.call(comp, 'Image', 'loadFromBlob', srcBlob.uid);
				comp = self = null;
			}

			if (blob.isDetached()) { // binary string
				var tr = new Transporter();
				tr.bind("TransportingComplete", function() {
					exec(tr.result.getSource());
				});
				tr.transport(blob.getSource(), blob.type, { ruid: self.uid });
			} else {
				exec(blob.getSource());
			}
		},

		loadFromImage: function(img) {
			var self = this.getRuntime();
			return self.shimExec.call(this, 'Image', 'loadFromImage', img.uid);
		},

		getInfo: function() {
			var self = this.getRuntime()
			, info = self.shimExec.call(this, 'Image', 'getInfo')
			;

			if (info.meta && info.meta.thumb && info.meta.thumb.data && !(self.meta.thumb.data instanceof Blob)) {
				info.meta.thumb.data = new Blob(self.uid, info.meta.thumb.data);
			}
			return info;
		},

		getAsBlob: function(type, quality) {
			var self = this.getRuntime()
			, blob = self.shimExec.call(this, 'Image', 'getAsBlob', type, quality)
			;
			if (blob) {
				return new Blob(self.uid, blob);
			}
			return null;
		},

		getAsDataURL: function() {
			var self = this.getRuntime()
			, blob = self.Image.getAsBlob.apply(this, arguments)
			, frs
			;
			if (!blob) {
				return null;
			}
			frs = new FileReaderSync();
			return frs.readAsDataURL(blob);
		}
	};

	return (extensions.Image = Image);
});

// Included from: src/javascript/runtime/silverlight/Runtime.js

/**
 * RunTime.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/*global ActiveXObject:true */

/**
Defines constructor for Silverlight runtime.

@class moxie/runtime/silverlight/Runtime
@private
*/
define("moxie/runtime/silverlight/Runtime", [
	"moxie/core/utils/Basic",
	"moxie/core/utils/Env",
	"moxie/core/utils/Dom",
	"moxie/core/Exceptions",
	"moxie/runtime/Runtime"
], function(Basic, Env, Dom, x, Runtime) {
	
	var type = "silverlight", extensions = {};

	function isInstalled(version) {
		var isVersionSupported = false, control = null, actualVer,
			actualVerArray, reqVerArray, requiredVersionPart, actualVersionPart, index = 0;

		try {
			try {
				control = new ActiveXObject('AgControl.AgControl');

				if (control.IsVersionSupported(version)) {
					isVersionSupported = true;
				}

				control = null;
			} catch (e) {
				var plugin = navigator.plugins["Silverlight Plug-In"];

				if (plugin) {
					actualVer = plugin.description;

					if (actualVer === "1.0.30226.2") {
						actualVer = "2.0.30226.2";
					}

					actualVerArray = actualVer.split(".");

					while (actualVerArray.length > 3) {
						actualVerArray.pop();
					}

					while ( actualVerArray.length < 4) {
						actualVerArray.push(0);
					}

					reqVerArray = version.split(".");

					while (reqVerArray.length > 4) {
						reqVerArray.pop();
					}

					do {
						requiredVersionPart = parseInt(reqVerArray[index], 10);
						actualVersionPart = parseInt(actualVerArray[index], 10);
						index++;
					} while (index < reqVerArray.length && requiredVersionPart === actualVersionPart);

					if (requiredVersionPart <= actualVersionPart && !isNaN(requiredVersionPart)) {
						isVersionSupported = true;
					}
				}
			}
		} catch (e2) {
			isVersionSupported = false;
		}

		return isVersionSupported;
	}

	/**
	Constructor for the Silverlight Runtime
	*/
	function SilverlightRuntime(options) {
		var I = this, initTimer;

		options = Basic.extend({ xap_url: Env.xap_url }, options);

		Runtime.call(this, options, type, {
			access_binary: Runtime.capTrue,
			access_image_binary: Runtime.capTrue,
			display_media: Runtime.capTest(defined('moxie/image/Image')),
			do_cors: Runtime.capTrue,
			drag_and_drop: false,
			report_upload_progress: Runtime.capTrue,
			resize_image: Runtime.capTrue,
			return_response_headers: function(value) {
				return value && I.mode === 'client';
			},
			return_response_type: function(responseType) {
				if (responseType !== 'json') {
					return true;
				} else {
					return !!window.JSON;
				}
			},
			return_status_code: function(code) {
				return I.mode === 'client' || !Basic.arrayDiff(code, [200, 404]);
			},
			select_file: Runtime.capTrue,
			select_multiple: Runtime.capTrue,
			send_binary_string: Runtime.capTrue,
			send_browser_cookies: function(value) {
				return value && I.mode === 'browser';
			},
			send_custom_headers: function(value) {
				return value && I.mode === 'client';
			},
			send_multipart: Runtime.capTrue,
			slice_blob: Runtime.capTrue,
			stream_upload: true,
			summon_file_dialog: false,
			upload_filesize: Runtime.capTrue,
			use_http_method: function(methods) {
				return I.mode === 'client' || !Basic.arrayDiff(methods, ['GET', 'POST']);
			}
		}, { 
			// capabilities that require specific mode
			return_response_headers: function(value) {
				return value ? 'client' : 'browser';
			},
			return_status_code: function(code) {
				return Basic.arrayDiff(code, [200, 404]) ? 'client' : ['client', 'browser'];
			},
			send_browser_cookies: function(value) {
				return value ? 'browser' : 'client';
			},
			send_custom_headers: function(value) {
				return value ? 'client' : 'browser';
			},
			use_http_method: function(methods) {
				return Basic.arrayDiff(methods, ['GET', 'POST']) ? 'client' : ['client', 'browser'];
			}
		});


		// minimal requirement
		if (!isInstalled('2.0.31005.0') || Env.browser === 'Opera') {
			if (MXI_DEBUG && Env.debug.runtime) {
				Env.log("\tSilverlight is not installed or minimal version (2.0.31005.0) requirement not met (not likely).");	
			}

			this.mode = false;
		}


		Basic.extend(this, {
			getShim: function() {
				return Dom.get(this.uid).content.Moxie;
			},

			shimExec: function(component, action) {
				var args = [].slice.call(arguments, 2);
				return I.getShim().exec(this.uid, component, action, args);
			},

			init : function() {
				var container;

				container = this.getShimContainer();

				container.innerHTML = '<object id="' + this.uid + '" data="data:application/x-silverlight," type="application/x-silverlight-2" width="100%" height="100%" style="outline:none;">' +
					'<param name="source" value="' + options.xap_url + '"/>' +
					'<param name="background" value="Transparent"/>' +
					'<param name="windowless" value="true"/>' +
					'<param name="enablehtmlaccess" value="true"/>' +
					'<param name="initParams" value="uid=' + this.uid + ',target=' + Runtime.getGlobalEventTarget() + '"/>' +
				'</object>';

				// Init is dispatched by the shim
				initTimer = setTimeout(function() {
					if (I && !I.initialized) { // runtime might be already destroyed by this moment
						I.trigger("Error", new x.RuntimeError(x.RuntimeError.NOT_INIT_ERR));

						if (MXI_DEBUG && Env.debug.runtime) {
							Env.log("\Silverlight failed to initialize within a specified period of time (5-10s).");	
						}
					}
				}, Env.OS !== 'Windows'? 10000 : 5000); // give it more time to initialize in non Windows OS (like Mac)
			},

			destroy: (function(destroy) { // extend default destroy method
				return function() {
					destroy.call(I);
					clearTimeout(initTimer); // initialization check might be still onwait
					options = initTimer = destroy = I = null;
				};
			}(this.destroy))

		}, extensions);
	}

	Runtime.addConstructor(type, SilverlightRuntime); 

	return extensions;
});

// Included from: src/javascript/runtime/silverlight/file/Blob.js

/**
 * Blob.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/**
@class moxie/runtime/silverlight/file/Blob
@private
*/
define("moxie/runtime/silverlight/file/Blob", [
	"moxie/runtime/silverlight/Runtime",
	"moxie/core/utils/Basic",
	"moxie/runtime/flash/file/Blob"
], function(extensions, Basic, Blob) {
	return (extensions.Blob = Basic.extend({}, Blob));
});

// Included from: src/javascript/runtime/silverlight/file/FileInput.js

/**
 * FileInput.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/**
@class moxie/runtime/silverlight/file/FileInput
@private
*/
define("moxie/runtime/silverlight/file/FileInput", [
	"moxie/runtime/silverlight/Runtime",
	"moxie/file/File",
	"moxie/core/utils/Dom",
	"moxie/core/utils/Basic"
], function(extensions, File, Dom, Basic) {

	function toFilters(accept) {
		var filter = '';
		for (var i = 0; i < accept.length; i++) {
			filter += (filter !== '' ? '|' : '') + accept[i].title + " | *." + accept[i].extensions.replace(/,/g, ';*.');
		}
		return filter;
	}

	
	var FileInput = {
		init: function(options) {
			var comp = this, I = this.getRuntime();
			var browseButton = Dom.get(options.browse_button);

			if (browseButton) {
				browseButton.setAttribute('tabindex', -1);
				browseButton = null;
			}

			this.bind("Change", function() {
				var files = I.shimExec.call(comp, 'FileInput', 'getFiles');
				comp.files = [];
				Basic.each(files, function(file) {
					comp.files.push(new File(I.uid, file));
				});
			}, 999);
			
			I.shimExec.call(this, 'FileInput', 'init', toFilters(options.accept), options.multiple);
			this.trigger('ready');
		},

		setOption: function(name, value) {
			if (name == 'accept') {
				value = toFilters(value);
			}
			this.getRuntime().shimExec.call(this, 'FileInput', 'setOption', name, value);
		}
	};

	return (extensions.FileInput = FileInput);
});

// Included from: src/javascript/runtime/silverlight/file/FileDrop.js

/**
 * FileDrop.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/**
@class moxie/runtime/silverlight/file/FileDrop
@private
*/
define("moxie/runtime/silverlight/file/FileDrop", [
	"moxie/runtime/silverlight/Runtime",
	"moxie/core/utils/Dom", 
	"moxie/core/utils/Events"
], function(extensions, Dom, Events) {

	// not exactly useful, since works only in safari (...crickets...)
	var FileDrop = {
		init: function() {
			var comp = this, self = comp.getRuntime(), dropZone;

			dropZone = self.getShimContainer();

			Events.addEvent(dropZone, 'dragover', function(e) {
				e.preventDefault();
				e.stopPropagation();
				e.dataTransfer.dropEffect = 'copy';
			}, comp.uid);

			Events.addEvent(dropZone, 'dragenter', function(e) {
				e.preventDefault();
				var flag = Dom.get(self.uid).dragEnter(e);
				// If handled, then stop propagation of event in DOM
				if (flag) {
					e.stopPropagation();
				}
			}, comp.uid);

			Events.addEvent(dropZone, 'drop', function(e) {
				e.preventDefault();
				var flag = Dom.get(self.uid).dragDrop(e);
				// If handled, then stop propagation of event in DOM
				if (flag) {
					e.stopPropagation();
				}
			}, comp.uid);

			return self.shimExec.call(this, 'FileDrop', 'init');
		}
	};

	return (extensions.FileDrop = FileDrop);
});

// Included from: src/javascript/runtime/silverlight/file/FileReader.js

/**
 * FileReader.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/**
@class moxie/runtime/silverlight/file/FileReader
@private
*/
define("moxie/runtime/silverlight/file/FileReader", [
	"moxie/runtime/silverlight/Runtime",
	"moxie/core/utils/Basic",
	"moxie/runtime/flash/file/FileReader"
], function(extensions, Basic, FileReader) {
	return (extensions.FileReader = Basic.extend({}, FileReader));
});

// Included from: src/javascript/runtime/silverlight/file/FileReaderSync.js

/**
 * FileReaderSync.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/**
@class moxie/runtime/silverlight/file/FileReaderSync
@private
*/
define("moxie/runtime/silverlight/file/FileReaderSync", [
	"moxie/runtime/silverlight/Runtime",
	"moxie/core/utils/Basic",
	"moxie/runtime/flash/file/FileReaderSync"
], function(extensions, Basic, FileReaderSync) {
	return (extensions.FileReaderSync = Basic.extend({}, FileReaderSync));
});

// Included from: src/javascript/runtime/silverlight/runtime/Transporter.js

/**
 * Transporter.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/**
@class moxie/runtime/silverlight/runtime/Transporter
@private
*/
define("moxie/runtime/silverlight/runtime/Transporter", [
	"moxie/runtime/silverlight/Runtime",
	"moxie/core/utils/Basic",
	"moxie/runtime/flash/runtime/Transporter"
], function(extensions, Basic, Transporter) {
	return (extensions.Transporter = Basic.extend({}, Transporter));
});

// Included from: src/javascript/runtime/silverlight/xhr/XMLHttpRequest.js

/**
 * XMLHttpRequest.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/**
@class moxie/runtime/silverlight/xhr/XMLHttpRequest
@private
*/
define("moxie/runtime/silverlight/xhr/XMLHttpRequest", [
	"moxie/runtime/silverlight/Runtime",
	"moxie/core/utils/Basic",
	"moxie/runtime/flash/xhr/XMLHttpRequest",
	"moxie/runtime/silverlight/file/FileReaderSync",
	"moxie/runtime/silverlight/runtime/Transporter"
], function(extensions, Basic, XMLHttpRequest, FileReaderSyncSilverlight, TransporterSilverlight) {
	return (extensions.XMLHttpRequest = Basic.extend({}, XMLHttpRequest));
});

// Included from: src/javascript/runtime/silverlight/image/Image.js

/**
 * Image.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */
 
/**
@class moxie/runtime/silverlight/image/Image
@private
*/
define("moxie/runtime/silverlight/image/Image", [
	"moxie/runtime/silverlight/Runtime",
	"moxie/core/utils/Basic",
	"moxie/file/Blob",
	"moxie/runtime/flash/image/Image"
], function(extensions, Basic, Blob, Image) {
	return (extensions.Image = Basic.extend({}, Image, {

		getInfo: function() {
			var self = this.getRuntime()
			, grps = ['tiff', 'exif', 'gps', 'thumb']
			, info = { meta: {} }
			, rawInfo = self.shimExec.call(this, 'Image', 'getInfo')
			;

			if (rawInfo.meta) {
				Basic.each(grps, function(grp) {
					var meta = rawInfo.meta[grp]
					, tag
					, i
					, length
					, value
					;
					if (meta && meta.keys) {
						info.meta[grp] = {};
						for (i = 0, length = meta.keys.length; i < length; i++) {
							tag = meta.keys[i];
							value = meta[tag];
							if (value) {
								// convert numbers
								if (/^(\d|[1-9]\d+)$/.test(value)) { // integer (make sure doesn't start with zero)
									value = parseInt(value, 10);
								} else if (/^\d*\.\d+$/.test(value)) { // double
									value = parseFloat(value);
								}
								info.meta[grp][tag] = value;
							}
						}
					}
				});

				// save thumb data as blob
				if (info.meta && info.meta.thumb && info.meta.thumb.data && !(self.meta.thumb.data instanceof Blob)) {
					info.meta.thumb.data = new Blob(self.uid, info.meta.thumb.data);
				}
			}

			info.width = parseInt(rawInfo.width, 10);
			info.height = parseInt(rawInfo.height, 10);
			info.size = parseInt(rawInfo.size, 10);
			info.type = rawInfo.type;
			info.name = rawInfo.name;

			return info;
		},

		resize: function(rect, ratio, opts) {
			this.getRuntime().shimExec.call(this, 'Image', 'resize', rect.x, rect.y, rect.width, rect.height, ratio, opts.preserveHeaders, opts.resample);
		}
	}));
});

// Included from: src/javascript/runtime/html4/Runtime.js

/**
 * Runtime.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/*global File:true */

/**
Defines constructor for HTML4 runtime.

@class moxie/runtime/html4/Runtime
@private
*/
define("moxie/runtime/html4/Runtime", [
	"moxie/core/utils/Basic",
	"moxie/core/Exceptions",
	"moxie/runtime/Runtime",
	"moxie/core/utils/Env"
], function(Basic, x, Runtime, Env) {
	
	var type = 'html4', extensions = {};

	function Html4Runtime(options) {
		var I = this
		, Test = Runtime.capTest
		, True = Runtime.capTrue
		;

		Runtime.call(this, options, type, {
			access_binary: Test(window.FileReader || window.File && File.getAsDataURL),
			access_image_binary: false,
			display_media: Test(
				(Env.can('create_canvas') || Env.can('use_data_uri_over32kb')) && 
				defined('moxie/image/Image')
			),
			do_cors: false,
			drag_and_drop: false,
			filter_by_extension: Test(function() { // if you know how to feature-detect this, please suggest
				return !(
					(Env.browser === 'Chrome' && Env.verComp(Env.version, 28, '<')) || 
					(Env.browser === 'IE' && Env.verComp(Env.version, 10, '<')) || 
					(Env.browser === 'Safari' && Env.verComp(Env.version, 7, '<')) ||
					(Env.browser === 'Firefox' && Env.verComp(Env.version, 37, '<'))
				);
			}()),
			resize_image: function() {
				return extensions.Image && I.can('access_binary') && Env.can('create_canvas');
			},
			report_upload_progress: false,
			return_response_headers: false,
			return_response_type: function(responseType) {
				if (responseType === 'json' && !!window.JSON) {
					return true;
				} 
				return !!~Basic.inArray(responseType, ['text', 'document', '']);
			},
			return_status_code: function(code) {
				return !Basic.arrayDiff(code, [200, 404]);
			},
			select_file: function() {
				return Env.can('use_fileinput');
			},
			select_multiple: false,
			send_binary_string: false,
			send_custom_headers: false,
			send_multipart: true,
			slice_blob: false,
			stream_upload: function() {
				return I.can('select_file');
			},
			summon_file_dialog: function() { // yeah... some dirty sniffing here...
				return I.can('select_file') && !(
					(Env.browser === 'Firefox' && Env.verComp(Env.version, 4, '<')) ||
					(Env.browser === 'Opera' && Env.verComp(Env.version, 12, '<')) ||
					(Env.browser === 'IE' && Env.verComp(Env.version, 10, '<'))
				);
			},
			upload_filesize: True,
			use_http_method: function(methods) {
				return !Basic.arrayDiff(methods, ['GET', 'POST']);
			}
		});


		Basic.extend(this, {
			init : function() {
				this.trigger("Init");
			},

			destroy: (function(destroy) { // extend default destroy method
				return function() {
					destroy.call(I);
					destroy = I = null;
				};
			}(this.destroy))
		});

		Basic.extend(this.getShim(), extensions);
	}

	Runtime.addConstructor(type, Html4Runtime);

	return extensions;
});

// Included from: src/javascript/runtime/html4/file/FileInput.js

/**
 * FileInput.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/**
@class moxie/runtime/html4/file/FileInput
@private
*/
define("moxie/runtime/html4/file/FileInput", [
	"moxie/runtime/html4/Runtime",
	"moxie/file/File",
	"moxie/core/utils/Basic",
	"moxie/core/utils/Dom",
	"moxie/core/utils/Events",
	"moxie/core/utils/Mime",
	"moxie/core/utils/Env"
], function(extensions, File, Basic, Dom, Events, Mime, Env) {
	
	function FileInput() {
		var _uid, _mimes = [], _options, _browseBtnZIndex; // save original z-index;

		function addInput() {
			var comp = this, I = comp.getRuntime(), shimContainer, browseButton, currForm, form, input, uid;

			uid = Basic.guid('uid_');

			shimContainer = I.getShimContainer(); // we get new ref every time to avoid memory leaks in IE

			if (_uid) { // move previous form out of the view
				currForm = Dom.get(_uid + '_form');
				if (currForm) {
					Basic.extend(currForm.style, { top: '100%' });
					// it shouldn't be possible to tab into the hidden element
					currForm.firstChild.setAttribute('tabindex', -1);
				}
			}

			// build form in DOM, since innerHTML version not able to submit file for some reason
			form = document.createElement('form');
			form.setAttribute('id', uid + '_form');
			form.setAttribute('method', 'post');
			form.setAttribute('enctype', 'multipart/form-data');
			form.setAttribute('encoding', 'multipart/form-data');

			Basic.extend(form.style, {
				overflow: 'hidden',
				position: 'absolute',
				top: 0,
				left: 0,
				width: '100%',
				height: '100%'
			});

			input = document.createElement('input');
			input.setAttribute('id', uid);
			input.setAttribute('type', 'file');
			input.setAttribute('accept', _mimes.join(','));

			if (I.can('summon_file_dialog')) {
				input.setAttribute('tabindex', -1);
			}

			Basic.extend(input.style, {
				fontSize: '999px',
				opacity: 0
			});

			form.appendChild(input);
			shimContainer.appendChild(form);

			// prepare file input to be placed underneath the browse_button element
			Basic.extend(input.style, {
				position: 'absolute',
				top: 0,
				left: 0,
				width: '100%',
				height: '100%'
			});

			if (Env.browser === 'IE' && Env.verComp(Env.version, 10, '<')) {
				Basic.extend(input.style, {
					filter : "progid:DXImageTransform.Microsoft.Alpha(opacity=0)"
				});
			}

			input.onchange = function() { // there should be only one handler for this
				var file;

				if (!this.value) {
					return;
				}

				if (this.files) { // check if browser is fresh enough
					file = this.files[0];
				} else {
					file = {
						name: this.value
					};
				}

				file = new File(I.uid, file);

				// clear event handler
				this.onchange = function() {}; 
				addInput.call(comp); 

				comp.files = [file];

				// substitute all ids with file uids (consider file.uid read-only - we cannot do it the other way around)
				input.setAttribute('id', file.uid);
				form.setAttribute('id', file.uid + '_form');
				
				comp.trigger('change');

				input = form = null;
			};


			// route click event to the input
			if (I.can('summon_file_dialog')) {
				browseButton = Dom.get(_options.browse_button);
				Events.removeEvent(browseButton, 'click', comp.uid);
				Events.addEvent(browseButton, 'click', function(e) {
					if (input && !input.disabled) { // for some reason FF (up to 8.0.1 so far) lets to click disabled input[type=file]
						input.click();
					}
					e.preventDefault();
				}, comp.uid);
			}

			_uid = uid;

			shimContainer = currForm = browseButton = null;
		}

		Basic.extend(this, {
			init: function(options) {
				var comp = this, I = comp.getRuntime(), shimContainer;

				// figure out accept string
				_options = options;
				_mimes = Mime.extList2mimes(options.accept, I.can('filter_by_extension'));

				shimContainer = I.getShimContainer();

				(function() {
					var browseButton, zIndex, top;

					browseButton = Dom.get(options.browse_button);
					_browseBtnZIndex = Dom.getStyle(browseButton, 'z-index') || 'auto';

					// Route click event to the input[type=file] element for browsers that support such behavior
					if (I.can('summon_file_dialog')) {
						if (Dom.getStyle(browseButton, 'position') === 'static') {
							browseButton.style.position = 'relative';
						}						

						comp.bind('Refresh', function() {
							zIndex = parseInt(_browseBtnZIndex, 10) || 1;

							Dom.get(_options.browse_button).style.zIndex = zIndex;
							this.getRuntime().getShimContainer().style.zIndex = zIndex - 1;
						});
					} else {
						// it shouldn't be possible to tab into the hidden element
						browseButton.setAttribute('tabindex', -1);
					}

					/* Since we have to place input[type=file] on top of the browse_button for some browsers,
					browse_button loses interactivity, so we restore it here */
					top = I.can('summon_file_dialog') ? browseButton : shimContainer;

					Events.addEvent(top, 'mouseover', function() {
						comp.trigger('mouseenter');
					}, comp.uid);

					Events.addEvent(top, 'mouseout', function() {
						comp.trigger('mouseleave');
					}, comp.uid);

					Events.addEvent(top, 'mousedown', function() {
						comp.trigger('mousedown');
					}, comp.uid);

					Events.addEvent(Dom.get(options.container), 'mouseup', function() {
						comp.trigger('mouseup');
					}, comp.uid);

					browseButton = null;
				}());

				addInput.call(this);

				shimContainer = null;

				// trigger ready event asynchronously
				comp.trigger({
					type: 'ready',
					async: true
				});
			},

			setOption: function(name, value) {
				var I = this.getRuntime();
				var input;

				if (name == 'accept') {
					_mimes = value.mimes || Mime.extList2mimes(value, I.can('filter_by_extension'));
				}

				// update current input
				input = Dom.get(_uid)
				if (input) {
					input.setAttribute('accept', _mimes.join(','));
				}
			},


			disable: function(state) {
				var input;

				if ((input = Dom.get(_uid))) {
					input.disabled = !!state;
				}
			},

			destroy: function() {
				var I = this.getRuntime()
				, shim = I.getShim()
				, shimContainer = I.getShimContainer()
				, container = _options && Dom.get(_options.container)
				, browseButton = _options && Dom.get(_options.browse_button)
				;
				
				if (container) {
					Events.removeAllEvents(container, this.uid);
				}
				
				if (browseButton) {
					Events.removeAllEvents(browseButton, this.uid);
					browseButton.style.zIndex = _browseBtnZIndex; // reset to original value
				}
				
				if (shimContainer) {
					Events.removeAllEvents(shimContainer, this.uid);
					shimContainer.innerHTML = '';
				}

				shim.removeInstance(this.uid);

				_uid = _mimes = _options = shimContainer = container = browseButton = shim = null;
			}
		});
	}

	return (extensions.FileInput = FileInput);
});

// Included from: src/javascript/runtime/html4/file/FileReader.js

/**
 * FileReader.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/**
@class moxie/runtime/html4/file/FileReader
@private
*/
define("moxie/runtime/html4/file/FileReader", [
	"moxie/runtime/html4/Runtime",
	"moxie/runtime/html5/file/FileReader"
], function(extensions, FileReader) {
	return (extensions.FileReader = FileReader);
});

// Included from: src/javascript/runtime/html4/xhr/XMLHttpRequest.js

/**
 * XMLHttpRequest.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/**
@class moxie/runtime/html4/xhr/XMLHttpRequest
@private
*/
define("moxie/runtime/html4/xhr/XMLHttpRequest", [
	"moxie/runtime/html4/Runtime",
	"moxie/core/utils/Basic",
	"moxie/core/utils/Dom",
	"moxie/core/utils/Url",
	"moxie/core/Exceptions",
	"moxie/core/utils/Events",
	"moxie/file/Blob",
	"moxie/xhr/FormData"
], function(extensions, Basic, Dom, Url, x, Events, Blob, FormData) {
	
	function XMLHttpRequest() {
		var _status, _response, _iframe;

		function cleanup(cb) {
			var target = this, uid, form, inputs, i, hasFile = false;

			if (!_iframe) {
				return;
			}

			uid = _iframe.id.replace(/_iframe$/, '');

			form = Dom.get(uid + '_form');
			if (form) {
				inputs = form.getElementsByTagName('input');
				i = inputs.length;

				while (i--) {
					switch (inputs[i].getAttribute('type')) {
						case 'hidden':
							inputs[i].parentNode.removeChild(inputs[i]);
							break;
						case 'file':
							hasFile = true; // flag the case for later
							break;
					}
				}
				inputs = [];

				if (!hasFile) { // we need to keep the form for sake of possible retries
					form.parentNode.removeChild(form);
				}
				form = null;
			}

			// without timeout, request is marked as canceled (in console)
			setTimeout(function() {
				Events.removeEvent(_iframe, 'load', target.uid);
				if (_iframe.parentNode) { // #382
					_iframe.parentNode.removeChild(_iframe);
				}

				// check if shim container has any other children, if - not, remove it as well
				var shimContainer = target.getRuntime().getShimContainer();
				if (!shimContainer.children.length) {
					shimContainer.parentNode.removeChild(shimContainer);
				}

				shimContainer = _iframe = null;
				cb();
			}, 1);
		}

		Basic.extend(this, {
			send: function(meta, data) {
				var target = this, I = target.getRuntime(), uid, form, input, blob;

				_status = _response = null;

				function createIframe() {
					var container = I.getShimContainer() || document.body
					, temp = document.createElement('div')
					;

					// IE 6 won't be able to set the name using setAttribute or iframe.name
					temp.innerHTML = '<iframe id="' + uid + '_iframe" name="' + uid + '_iframe" src="javascript:&quot;&quot;" style="display:none"></iframe>';
					_iframe = temp.firstChild;
					container.appendChild(_iframe);

					/* _iframe.onreadystatechange = function() {
						console.info(_iframe.readyState);
					};*/

					Events.addEvent(_iframe, 'load', function() { // _iframe.onload doesn't work in IE lte 8
						var el;

						try {
							el = _iframe.contentWindow.document || _iframe.contentDocument || window.frames[_iframe.id].document;

							// try to detect some standard error pages
							if (/^4(0[0-9]|1[0-7]|2[2346])\s/.test(el.title)) { // test if title starts with 4xx HTTP error
								_status = el.title.replace(/^(\d+).*$/, '$1');
							} else {
								_status = 200;
								// get result
								_response = Basic.trim(el.body.innerHTML);

								// we need to fire these at least once
								target.trigger({
									type: 'progress',
									loaded: _response.length,
									total: _response.length
								});

								if (blob) { // if we were uploading a file
									target.trigger({
										type: 'uploadprogress',
										loaded: blob.size || 1025,
										total: blob.size || 1025
									});
								}
							}
						} catch (ex) {
							if (Url.hasSameOrigin(meta.url)) {
								// if response is sent with error code, iframe in IE gets redirected to res://ieframe.dll/http_x.htm
								// which obviously results to cross domain error (wtf?)
								_status = 404;
							} else {
								cleanup.call(target, function() {
									target.trigger('error');
								});
								return;
							}
						}	
					
						cleanup.call(target, function() {
							target.trigger('load');
						});
					}, target.uid);
				} // end createIframe

				// prepare data to be sent and convert if required
				if (data instanceof FormData && data.hasBlob()) {
					blob = data.getBlob();
					uid = blob.uid;
					input = Dom.get(uid);
					form = Dom.get(uid + '_form');
					if (!form) {
						throw new x.DOMException(x.DOMException.NOT_FOUND_ERR);
					}
				} else {
					uid = Basic.guid('uid_');

					form = document.createElement('form');
					form.setAttribute('id', uid + '_form');
					form.setAttribute('method', meta.method);
					form.setAttribute('enctype', 'multipart/form-data');
					form.setAttribute('encoding', 'multipart/form-data');

					I.getShimContainer().appendChild(form);
				}

				// set upload target
				form.setAttribute('target', uid + '_iframe');

				if (data instanceof FormData) {
					data.each(function(value, name) {
						if (value instanceof Blob) {
							if (input) {
								input.setAttribute('name', name);
							}
						} else {
							var hidden = document.createElement('input');

							Basic.extend(hidden, {
								type : 'hidden',
								name : name,
								value : value
							});

							// make sure that input[type="file"], if it's there, comes last
							if (input) {
								form.insertBefore(hidden, input);
							} else {
								form.appendChild(hidden);
							}
						}
					});
				}

				// set destination url
				form.setAttribute("action", meta.url);

				createIframe();
				form.submit();
				target.trigger('loadstart');
			},

			getStatus: function() {
				return _status;
			},

			getResponse: function(responseType) {
				if ('json' === responseType) {
					// strip off <pre>..</pre> tags that might be enclosing the response
					if (Basic.typeOf(_response) === 'string' && !!window.JSON) {
						try {
							return JSON.parse(_response.replace(/^\s*<pre[^>]*>/, '').replace(/<\/pre>\s*$/, ''));
						} catch (ex) {
							return null;
						}
					} 
				} else if ('document' === responseType) {

				}
				return _response;
			},

			abort: function() {
				var target = this;

				if (_iframe && _iframe.contentWindow) {
					if (_iframe.contentWindow.stop) { // FireFox/Safari/Chrome
						_iframe.contentWindow.stop();
					} else if (_iframe.contentWindow.document.execCommand) { // IE
						_iframe.contentWindow.document.execCommand('Stop');
					} else {
						_iframe.src = "about:blank";
					}
				}

				cleanup.call(this, function() {
					// target.dispatchEvent('readystatechange');
					target.dispatchEvent('abort');
				});
			},

			destroy: function() {
				this.getRuntime().getShim().removeInstance(this.uid);
			}
		});
	}

	return (extensions.XMLHttpRequest = XMLHttpRequest);
});

// Included from: src/javascript/runtime/html4/image/Image.js

/**
 * Image.js
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 */

/**
@class moxie/runtime/html4/image/Image
@private
*/
define("moxie/runtime/html4/image/Image", [
	"moxie/runtime/html4/Runtime",
	"moxie/runtime/html5/image/Image"
], function(extensions, Image) {
	return (extensions.Image = Image);
});

expose(["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/core/utils/Env","moxie/core/Exceptions","moxie/core/utils/Dom","moxie/core/EventTarget","moxie/runtime/Runtime","moxie/runtime/RuntimeClient","moxie/file/Blob","moxie/core/I18n","moxie/core/utils/Mime","moxie/file/FileInput","moxie/file/File","moxie/file/FileDrop","moxie/file/FileReader","moxie/core/utils/Url","moxie/runtime/RuntimeTarget","moxie/xhr/FormData","moxie/xhr/XMLHttpRequest","moxie/image/Image","moxie/core/utils/Events","moxie/runtime/html5/image/ResizerCanvas"]);
})(this);
}));
},{}],99:[function(require,module,exports){
/**
 * mOxie - multi-runtime File API & XMLHttpRequest L2 Polyfill
 * v1.5.7
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 *
 * Date: 2017-11-03
 */
!function(e,t){var i=function(){var e={};return t.apply(e,arguments),e.moxie};"function"==typeof define&&define.amd?define("moxie",[],i):"object"==typeof module&&module.exports?module.exports=i():e.moxie=i()}(this||window,function(){!function(e,t){"use strict";function i(e,t){for(var i,n=[],r=0;r<e.length;++r){if(i=s[e[r]]||o(e[r]),!i)throw"module definition dependecy not found: "+e[r];n.push(i)}t.apply(null,n)}function n(e,n,r){if("string"!=typeof e)throw"invalid module definition, module id must be defined and be a string";if(n===t)throw"invalid module definition, dependencies must be specified";if(r===t)throw"invalid module definition, definition function must be specified";i(n,function(){s[e]=r.apply(null,arguments)})}function r(e){return!!s[e]}function o(t){for(var i=e,n=t.split(/[.\/]/),r=0;r<n.length;++r){if(!i[n[r]])return;i=i[n[r]]}return i}function a(i){for(var n=0;n<i.length;n++){for(var r=e,o=i[n],a=o.split(/[.\/]/),u=0;u<a.length-1;++u)r[a[u]]===t&&(r[a[u]]={}),r=r[a[u]];r[a[a.length-1]]=s[o]}}var s={};n("moxie/core/utils/Basic",[],function(){function e(e){var t;return e===t?"undefined":null===e?"null":e.nodeType?"node":{}.toString.call(e).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()}function t(){return s(!1,!1,arguments)}function i(){return s(!0,!1,arguments)}function n(){return s(!1,!0,arguments)}function r(){return s(!0,!0,arguments)}function o(t){switch(e(t)){case"array":return s(!1,!0,[[],t]);case"object":return s(!1,!0,[{},t]);default:return t}}function a(i){switch(e(i)){case"array":return Array.prototype.slice.call(i);case"object":return t({},i)}return i}function s(t,i,n){var r,o=n[0];return c(n,function(n,u){u>0&&c(n,function(n,u){var c=-1!==h(e(n),["array","object"]);return n===r||t&&o[u]===r?!0:(c&&i&&(n=a(n)),e(o[u])===e(n)&&c?s(t,i,[o[u],n]):o[u]=n,void 0)})}),o}function u(e,t){function i(){this.constructor=e}for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.parent=t.prototype,e}function c(e,t){var i,n,r,o;if(e){try{i=e.length}catch(a){i=o}if(i===o||"number"!=typeof i){for(n in e)if(e.hasOwnProperty(n)&&t(e[n],n)===!1)return}else for(r=0;i>r;r++)if(t(e[r],r)===!1)return}}function l(t){var i;if(!t||"object"!==e(t))return!0;for(i in t)return!1;return!0}function d(t,i){function n(r){"function"===e(t[r])&&t[r](function(e){++r<o&&!e?n(r):i(e)})}var r=0,o=t.length;"function"!==e(i)&&(i=function(){}),t&&t.length||i(),n(r)}function m(e,t){var i=0,n=e.length,r=new Array(n);c(e,function(e,o){e(function(e){if(e)return t(e);var a=[].slice.call(arguments);a.shift(),r[o]=a,i++,i===n&&(r.unshift(null),t.apply(this,r))})})}function h(e,t){if(t){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(t,e);for(var i=0,n=t.length;n>i;i++)if(t[i]===e)return i}return-1}function f(t,i){var n=[];"array"!==e(t)&&(t=[t]),"array"!==e(i)&&(i=[i]);for(var r in t)-1===h(t[r],i)&&n.push(t[r]);return n.length?n:!1}function p(e,t){var i=[];return c(e,function(e){-1!==h(e,t)&&i.push(e)}),i.length?i:null}function g(e){var t,i=[];for(t=0;t<e.length;t++)i[t]=e[t];return i}function x(e){return e?String.prototype.trim?String.prototype.trim.call(e):e.toString().replace(/^\s*/,"").replace(/\s*$/,""):e}function v(e){if("string"!=typeof e)return e;var t,i={t:1099511627776,g:1073741824,m:1048576,k:1024};return e=/^([0-9\.]+)([tmgk]?)$/.exec(e.toLowerCase().replace(/[^0-9\.tmkg]/g,"")),t=e[2],e=+e[1],i.hasOwnProperty(t)&&(e*=i[t]),Math.floor(e)}function w(e){var t=[].slice.call(arguments,1);return e.replace(/%([a-z])/g,function(e,i){var n=t.shift();switch(i){case"s":return n+"";case"d":return parseInt(n,10);case"f":return parseFloat(n);case"c":return"";default:return n}})}function y(e,t){var i=this;setTimeout(function(){e.call(i)},t||1)}var E=function(){var e=0;return function(t){var i,n=(new Date).getTime().toString(32);for(i=0;5>i;i++)n+=Math.floor(65535*Math.random()).toString(32);return(t||"o_")+n+(e++).toString(32)}}();return{guid:E,typeOf:e,extend:t,extendIf:i,extendImmutable:n,extendImmutableIf:r,clone:o,inherit:u,each:c,isEmptyObj:l,inSeries:d,inParallel:m,inArray:h,arrayDiff:f,arrayIntersect:p,toArray:g,trim:x,sprintf:w,parseSizeStr:v,delay:y}}),n("moxie/core/utils/Encode",[],function(){var e=function(e){return unescape(encodeURIComponent(e))},t=function(e){return decodeURIComponent(escape(e))},i=function(e,i){if("function"==typeof window.atob)return i?t(window.atob(e)):window.atob(e);var n,r,o,a,s,u,c,l,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",m=0,h=0,f="",p=[];if(!e)return e;e+="";do a=d.indexOf(e.charAt(m++)),s=d.indexOf(e.charAt(m++)),u=d.indexOf(e.charAt(m++)),c=d.indexOf(e.charAt(m++)),l=a<<18|s<<12|u<<6|c,n=255&l>>16,r=255&l>>8,o=255&l,p[h++]=64==u?String.fromCharCode(n):64==c?String.fromCharCode(n,r):String.fromCharCode(n,r,o);while(m<e.length);return f=p.join(""),i?t(f):f},n=function(t,i){if(i&&(t=e(t)),"function"==typeof window.btoa)return window.btoa(t);var n,r,o,a,s,u,c,l,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",m=0,h=0,f="",p=[];if(!t)return t;do n=t.charCodeAt(m++),r=t.charCodeAt(m++),o=t.charCodeAt(m++),l=n<<16|r<<8|o,a=63&l>>18,s=63&l>>12,u=63&l>>6,c=63&l,p[h++]=d.charAt(a)+d.charAt(s)+d.charAt(u)+d.charAt(c);while(m<t.length);f=p.join("");var g=t.length%3;return(g?f.slice(0,g-3):f)+"===".slice(g||3)};return{utf8_encode:e,utf8_decode:t,atob:i,btoa:n}}),n("moxie/core/utils/Env",["moxie/core/utils/Basic"],function(e){function i(e,t,i){var n=0,r=0,o=0,a={dev:-6,alpha:-5,a:-5,beta:-4,b:-4,RC:-3,rc:-3,"#":-2,p:1,pl:1},s=function(e){return e=(""+e).replace(/[_\-+]/g,"."),e=e.replace(/([^.\d]+)/g,".$1.").replace(/\.{2,}/g,"."),e.length?e.split("."):[-8]},u=function(e){return e?isNaN(e)?a[e]||-7:parseInt(e,10):0};for(e=s(e),t=s(t),r=Math.max(e.length,t.length),n=0;r>n;n++)if(e[n]!=t[n]){if(e[n]=u(e[n]),t[n]=u(t[n]),e[n]<t[n]){o=-1;break}if(e[n]>t[n]){o=1;break}}if(!i)return o;switch(i){case">":case"gt":return o>0;case">=":case"ge":return o>=0;case"<=":case"le":return 0>=o;case"==":case"=":case"eq":return 0===o;case"<>":case"!=":case"ne":return 0!==o;case"":case"<":case"lt":return 0>o;default:return null}}var n=function(e){var t="",i="?",n="function",r="undefined",o="object",a="name",s="version",u={has:function(e,t){return-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()}},c={rgx:function(){for(var t,i,a,s,u,c,l,d=0,m=arguments;d<m.length;d+=2){var h=m[d],f=m[d+1];if(typeof t===r){t={};for(s in f)u=f[s],typeof u===o?t[u[0]]=e:t[u]=e}for(i=a=0;i<h.length;i++)if(c=h[i].exec(this.getUA())){for(s=0;s<f.length;s++)l=c[++a],u=f[s],typeof u===o&&u.length>0?2==u.length?t[u[0]]=typeof u[1]==n?u[1].call(this,l):u[1]:3==u.length?t[u[0]]=typeof u[1]!==n||u[1].exec&&u[1].test?l?l.replace(u[1],u[2]):e:l?u[1].call(this,l,u[2]):e:4==u.length&&(t[u[0]]=l?u[3].call(this,l.replace(u[1],u[2])):e):t[u]=l?l:e;break}if(c)break}return t},str:function(t,n){for(var r in n)if(typeof n[r]===o&&n[r].length>0){for(var a=0;a<n[r].length;a++)if(u.has(n[r][a],t))return r===i?e:r}else if(u.has(n[r],t))return r===i?e:r;return t}},l={browser:{oldsafari:{major:{1:["/8","/1","/3"],2:"/4","?":"/"},version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2000:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",RT:"ARM"}}}},d={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[a,s],[/\s(opr)\/([\w\.]+)/i],[[a,"Opera"],s],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi)\/([\w\.-]+)/i],[a,s],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[a,"IE"],s],[/(edge)\/((\d+)?[\w\.]+)/i],[a,s],[/(yabrowser)\/([\w\.]+)/i],[[a,"Yandex"],s],[/(comodo_dragon)\/([\w\.]+)/i],[[a,/_/g," "],s],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i,/(uc\s?browser|qqbrowser)[\/\s]?([\w\.]+)/i],[a,s],[/(dolfin)\/([\w\.]+)/i],[[a,"Dolphin"],s],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[a,"Chrome"],s],[/XiaoMi\/MiuiBrowser\/([\w\.]+)/i],[s,[a,"MIUI Browser"]],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)/i],[s,[a,"Android Browser"]],[/FBAV\/([\w\.]+);/i],[s,[a,"Facebook"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[s,[a,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[s,a],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[a,[s,c.str,l.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[a,s],[/(navigator|netscape)\/([\w\.-]+)/i],[[a,"Netscape"],s],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[a,s]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[s,[a,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[a,s],[/rv\:([\w\.]+).*(gecko)/i],[s,a]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[a,s],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[a,[s,c.str,l.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[a,"Windows"],[s,c.str,l.os.windows.version]],[/\((bb)(10);/i],[[a,"BlackBerry"],s],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],[a,s],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[a,"Symbian"],s],[/\((series40);/i],[a],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[a,"Firefox OS"],s],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[a,s],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[a,"Chromium OS"],s],[/(sunos)\s?([\w\.]+\d)*/i],[[a,"Solaris"],s],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[a,s],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[[a,"iOS"],[s,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[[a,"Mac OS"],[s,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],[a,s]]},m=function(e){var i=e||(window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:t);this.getBrowser=function(){return c.rgx.apply(this,d.browser)},this.getEngine=function(){return c.rgx.apply(this,d.engine)},this.getOS=function(){return c.rgx.apply(this,d.os)},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS()}},this.getUA=function(){return i},this.setUA=function(e){return i=e,this},this.setUA(i)};return m}(),r=function(){var i={access_global_ns:function(){return!!window.moxie},define_property:function(){return!1}(),create_canvas:function(){var e=document.createElement("canvas"),t=!(!e.getContext||!e.getContext("2d"));return i.create_canvas=t,t},return_response_type:function(t){try{if(-1!==e.inArray(t,["","text","document"]))return!0;if(window.XMLHttpRequest){var i=new XMLHttpRequest;if(i.open("get","/"),"responseType"in i)return i.responseType=t,i.responseType!==t?!1:!0}}catch(n){}return!1},use_blob_uri:function(){var e=window.URL;return i.use_blob_uri=e&&"createObjectURL"in e&&"revokeObjectURL"in e&&("IE"!==a.browser||a.verComp(a.version,"11.0.46",">=")),i.use_blob_uri},use_data_uri:function(){var e=new Image;return e.onload=function(){i.use_data_uri=1===e.width&&1===e.height},setTimeout(function(){e.src="data:image/gif;base64,R0lGODlhAQABAIAAAP8AAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="},1),!1}(),use_data_uri_over32kb:function(){return i.use_data_uri&&("IE"!==a.browser||a.version>=9)},use_data_uri_of:function(e){return i.use_data_uri&&33e3>e||i.use_data_uri_over32kb()},use_fileinput:function(){if(navigator.userAgent.match(/(Android (1.0|1.1|1.5|1.6|2.0|2.1))|(Windows Phone (OS 7|8.0))|(XBLWP)|(ZuneWP)|(w(eb)?OSBrowser)|(webOS)|(Kindle\/(1.0|2.0|2.5|3.0))/))return!1;var e=document.createElement("input");return e.setAttribute("type","file"),i.use_fileinput=!e.disabled},use_webgl:function(){var e,n=document.createElement("canvas"),r=null;try{r=n.getContext("webgl")||n.getContext("experimental-webgl")}catch(o){}return r||(r=null),e=!!r,i.use_webgl=e,n=t,e}};return function(t){var n=[].slice.call(arguments);return n.shift(),"function"===e.typeOf(i[t])?i[t].apply(this,n):!!i[t]}}(),o=(new n).getResult(),a={can:r,uaParser:n,browser:o.browser.name,version:o.browser.version,os:o.os.name,osVersion:o.os.version,verComp:i,swf_url:"../flash/Moxie.swf",xap_url:"../silverlight/Moxie.xap",global_event_dispatcher:"moxie.core.EventTarget.instance.dispatchEvent"};return a.OS=a.os,a}),n("moxie/core/Exceptions",["moxie/core/utils/Basic"],function(e){function t(e,t){var i;for(i in e)if(e[i]===t)return i;return null}return{RuntimeError:function(){function i(e,i){this.code=e,this.name=t(n,e),this.message=this.name+(i||": RuntimeError "+this.code)}var n={NOT_INIT_ERR:1,EXCEPTION_ERR:3,NOT_SUPPORTED_ERR:9,JS_ERR:4};return e.extend(i,n),i.prototype=Error.prototype,i}(),OperationNotAllowedException:function(){function t(e){this.code=e,this.name="OperationNotAllowedException"}return e.extend(t,{NOT_ALLOWED_ERR:1}),t.prototype=Error.prototype,t}(),ImageError:function(){function i(e){this.code=e,this.name=t(n,e),this.message=this.name+": ImageError "+this.code}var n={WRONG_FORMAT:1,MAX_RESOLUTION_ERR:2,INVALID_META_ERR:3};return e.extend(i,n),i.prototype=Error.prototype,i}(),FileException:function(){function i(e){this.code=e,this.name=t(n,e),this.message=this.name+": FileException "+this.code}var n={NOT_FOUND_ERR:1,SECURITY_ERR:2,ABORT_ERR:3,NOT_READABLE_ERR:4,ENCODING_ERR:5,NO_MODIFICATION_ALLOWED_ERR:6,INVALID_STATE_ERR:7,SYNTAX_ERR:8};return e.extend(i,n),i.prototype=Error.prototype,i}(),DOMException:function(){function i(e){this.code=e,this.name=t(n,e),this.message=this.name+": DOMException "+this.code}var n={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};return e.extend(i,n),i.prototype=Error.prototype,i}(),EventException:function(){function t(e){this.code=e,this.name="EventException"}return e.extend(t,{UNSPECIFIED_EVENT_TYPE_ERR:0}),t.prototype=Error.prototype,t}()}}),n("moxie/core/utils/Dom",["moxie/core/utils/Env"],function(e){var t=function(e){return"string"!=typeof e?e:document.getElementById(e)},i=function(e,t){if(!e.className)return!1;var i=new RegExp("(^|\\s+)"+t+"(\\s+|$)");return i.test(e.className)},n=function(e,t){i(e,t)||(e.className=e.className?e.className.replace(/\s+$/,"")+" "+t:t)},r=function(e,t){if(e.className){var i=new RegExp("(^|\\s+)"+t+"(\\s+|$)");e.className=e.className.replace(i,function(e,t,i){return" "===t&&" "===i?" ":""})}},o=function(e,t){return e.currentStyle?e.currentStyle[t]:window.getComputedStyle?window.getComputedStyle(e,null)[t]:void 0},a=function(t,i){function n(e){var t,i,n=0,r=0;return e&&(i=e.getBoundingClientRect(),t="CSS1Compat"===c.compatMode?c.documentElement:c.body,n=i.left+t.scrollLeft,r=i.top+t.scrollTop),{x:n,y:r}}var r,o,a,s=0,u=0,c=document;if(t=t,i=i||c.body,t&&t.getBoundingClientRect&&"IE"===e.browser&&(!c.documentMode||c.documentMode<8))return o=n(t),a=n(i),{x:o.x-a.x,y:o.y-a.y};for(r=t;r&&r!=i&&r.nodeType;)s+=r.offsetLeft||0,u+=r.offsetTop||0,r=r.offsetParent;for(r=t.parentNode;r&&r!=i&&r.nodeType;)s-=r.scrollLeft||0,u-=r.scrollTop||0,r=r.parentNode;return{x:s,y:u}},s=function(e){return{w:e.offsetWidth||e.clientWidth,h:e.offsetHeight||e.clientHeight}};return{get:t,hasClass:i,addClass:n,removeClass:r,getStyle:o,getPos:a,getSize:s}}),n("moxie/core/EventTarget",["moxie/core/utils/Env","moxie/core/Exceptions","moxie/core/utils/Basic"],function(e,t,i){function n(){this.uid=i.guid()}var r={};return i.extend(n.prototype,{init:function(){this.uid||(this.uid=i.guid("uid_"))},addEventListener:function(e,t,n,o){var a,s=this;return this.hasOwnProperty("uid")||(this.uid=i.guid("uid_")),e=i.trim(e),/\s/.test(e)?(i.each(e.split(/\s+/),function(e){s.addEventListener(e,t,n,o)}),void 0):(e=e.toLowerCase(),n=parseInt(n,10)||0,a=r[this.uid]&&r[this.uid][e]||[],a.push({fn:t,priority:n,scope:o||this}),r[this.uid]||(r[this.uid]={}),r[this.uid][e]=a,void 0)},hasEventListener:function(e){var t;return e?(e=e.toLowerCase(),t=r[this.uid]&&r[this.uid][e]):t=r[this.uid],t?t:!1},removeEventListener:function(e,t){var n,o,a=this;if(e=e.toLowerCase(),/\s/.test(e))return i.each(e.split(/\s+/),function(e){a.removeEventListener(e,t)}),void 0;if(n=r[this.uid]&&r[this.uid][e]){if(t){for(o=n.length-1;o>=0;o--)if(n[o].fn===t){n.splice(o,1);break}}else n=[];n.length||(delete r[this.uid][e],i.isEmptyObj(r[this.uid])&&delete r[this.uid])}},removeAllEventListeners:function(){r[this.uid]&&delete r[this.uid]},dispatchEvent:function(e){var n,o,a,s,u,c={},l=!0;if("string"!==i.typeOf(e)){if(s=e,"string"!==i.typeOf(s.type))throw new t.EventException(t.EventException.UNSPECIFIED_EVENT_TYPE_ERR);e=s.type,s.total!==u&&s.loaded!==u&&(c.total=s.total,c.loaded=s.loaded),c.async=s.async||!1}if(-1!==e.indexOf("::")?function(t){n=t[0],e=t[1]}(e.split("::")):n=this.uid,e=e.toLowerCase(),o=r[n]&&r[n][e]){o.sort(function(e,t){return t.priority-e.priority}),a=[].slice.call(arguments),a.shift(),c.type=e,a.unshift(c);var d=[];i.each(o,function(e){a[0].target=e.scope,c.async?d.push(function(t){setTimeout(function(){t(e.fn.apply(e.scope,a)===!1)},1)}):d.push(function(t){t(e.fn.apply(e.scope,a)===!1)})}),d.length&&i.inSeries(d,function(e){l=!e})}return l},bindOnce:function(e,t,i,n){var r=this;r.bind.call(this,e,function o(){return r.unbind(e,o),t.apply(this,arguments)},i,n)},bind:function(){this.addEventListener.apply(this,arguments)},unbind:function(){this.removeEventListener.apply(this,arguments)},unbindAll:function(){this.removeAllEventListeners.apply(this,arguments)},trigger:function(){return this.dispatchEvent.apply(this,arguments)},handleEventProps:function(e){var t=this;this.bind(e.join(" "),function(e){var t="on"+e.type.toLowerCase();"function"===i.typeOf(this[t])&&this[t].apply(this,arguments)}),i.each(e,function(e){e="on"+e.toLowerCase(e),"undefined"===i.typeOf(t[e])&&(t[e]=null)})}}),n.instance=new n,n}),n("moxie/runtime/Runtime",["moxie/core/utils/Env","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/EventTarget"],function(e,t,i,n){function r(e,n,o,s,u){var c,l=this,d=t.guid(n+"_"),m=u||"browser";e=e||{},a[d]=this,o=t.extend({access_binary:!1,access_image_binary:!1,display_media:!1,do_cors:!1,drag_and_drop:!1,filter_by_extension:!0,resize_image:!1,report_upload_progress:!1,return_response_headers:!1,return_response_type:!1,return_status_code:!0,send_custom_headers:!1,select_file:!1,select_folder:!1,select_multiple:!0,send_binary_string:!1,send_browser_cookies:!0,send_multipart:!0,slice_blob:!1,stream_upload:!1,summon_file_dialog:!1,upload_filesize:!0,use_http_method:!0},o),e.preferred_caps&&(m=r.getMode(s,e.preferred_caps,m)),c=function(){var e={};return{exec:function(t,i,n,r){return c[i]&&(e[t]||(e[t]={context:this,instance:new c[i]}),e[t].instance[n])?e[t].instance[n].apply(this,r):void 0},removeInstance:function(t){delete e[t]},removeAllInstances:function(){var i=this;t.each(e,function(e,n){"function"===t.typeOf(e.instance.destroy)&&e.instance.destroy.call(e.context),i.removeInstance(n)})}}}(),t.extend(this,{initialized:!1,uid:d,type:n,mode:r.getMode(s,e.required_caps,m),shimid:d+"_container",clients:0,options:e,can:function(e,i){var n=arguments[2]||o;if("string"===t.typeOf(e)&&"undefined"===t.typeOf(i)&&(e=r.parseCaps(e)),"object"===t.typeOf(e)){for(var a in e)if(!this.can(a,e[a],n))return!1;return!0}return"function"===t.typeOf(n[e])?n[e].call(this,i):i===n[e]},getShimContainer:function(){var e,n=i.get(this.shimid);return n||(e=i.get(this.options.container)||document.body,n=document.createElement("div"),n.id=this.shimid,n.className="moxie-shim moxie-shim-"+this.type,t.extend(n.style,{position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"}),e.appendChild(n),e=null),n},getShim:function(){return c},shimExec:function(e,t){var i=[].slice.call(arguments,2);return l.getShim().exec.call(this,this.uid,e,t,i)},exec:function(e,t){var i=[].slice.call(arguments,2);return l[e]&&l[e][t]?l[e][t].apply(this,i):l.shimExec.apply(this,arguments)},destroy:function(){if(l){var e=i.get(this.shimid);e&&e.parentNode.removeChild(e),c&&c.removeAllInstances(),this.unbindAll(),delete a[this.uid],this.uid=null,d=l=c=e=null}}}),this.mode&&e.required_caps&&!this.can(e.required_caps)&&(this.mode=!1)}var o={},a={};return r.order="html5,flash,silverlight,html4",r.getRuntime=function(e){return a[e]?a[e]:!1},r.addConstructor=function(e,t){t.prototype=n.instance,o[e]=t},r.getConstructor=function(e){return o[e]||null},r.getInfo=function(e){var t=r.getRuntime(e);return t?{uid:t.uid,type:t.type,mode:t.mode,can:function(){return t.can.apply(t,arguments)}}:null},r.parseCaps=function(e){var i={};return"string"!==t.typeOf(e)?e||{}:(t.each(e.split(","),function(e){i[e]=!0}),i)},r.can=function(e,t){var i,n,o=r.getConstructor(e);return o?(i=new o({required_caps:t}),n=i.mode,i.destroy(),!!n):!1},r.thatCan=function(e,t){var i=(t||r.order).split(/\s*,\s*/);for(var n in i)if(r.can(i[n],e))return i[n];return null},r.getMode=function(e,i,n){var r=null;if("undefined"===t.typeOf(n)&&(n="browser"),i&&!t.isEmptyObj(e)){if(t.each(i,function(i,n){if(e.hasOwnProperty(n)){var o=e[n](i);if("string"==typeof o&&(o=[o]),r){if(!(r=t.arrayIntersect(r,o)))return r=!1}else r=o}}),r)return-1!==t.inArray(n,r)?n:r[0];if(r===!1)return!1}return n},r.getGlobalEventTarget=function(){if(/^moxie\./.test(e.global_event_dispatcher)&&!e.can("access_global_ns")){var i=t.guid("moxie_event_target_");window[i]=function(e,t){n.instance.dispatchEvent(e,t)},e.global_event_dispatcher=i}return e.global_event_dispatcher},r.capTrue=function(){return!0},r.capFalse=function(){return!1},r.capTest=function(e){return function(){return!!e}},r}),n("moxie/runtime/RuntimeClient",["moxie/core/utils/Env","moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/Runtime"],function(e,t,i,n){return function(){var e;i.extend(this,{connectRuntime:function(r){function o(i){var a,u;return i.length?(a=i.shift().toLowerCase(),(u=n.getConstructor(a))?(e=new u(r),e.bind("Init",function(){e.initialized=!0,setTimeout(function(){e.clients++,s.ruid=e.uid,s.trigger("RuntimeInit",e)},1)}),e.bind("Error",function(){e.destroy(),o(i)}),e.bind("Exception",function(e,i){var n=i.name+"(#"+i.code+")"+(i.message?", from: "+i.message:"");s.trigger("RuntimeError",new t.RuntimeError(t.RuntimeError.EXCEPTION_ERR,n))}),e.mode?(e.init(),void 0):(e.trigger("Error"),void 0)):(o(i),void 0)):(s.trigger("RuntimeError",new t.RuntimeError(t.RuntimeError.NOT_INIT_ERR)),e=null,void 0)}var a,s=this;if("string"===i.typeOf(r)?a=r:"string"===i.typeOf(r.ruid)&&(a=r.ruid),a){if(e=n.getRuntime(a))return s.ruid=a,e.clients++,e;throw new t.RuntimeError(t.RuntimeError.NOT_INIT_ERR)}o((r.runtime_order||n.order).split(/\s*,\s*/))},disconnectRuntime:function(){e&&--e.clients<=0&&e.destroy(),e=null},getRuntime:function(){return e&&e.uid?e:e=null},exec:function(){return e?e.exec.apply(this,arguments):null},can:function(t){return e?e.can(t):!1}})}}),n("moxie/file/Blob",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient"],function(e,t,i){function n(o,a){function s(t,i,o){var a,s=r[this.uid];return"string"===e.typeOf(s)&&s.length?(a=new n(null,{type:o,size:i-t}),a.detach(s.substr(t,a.size)),a):null}i.call(this),o&&this.connectRuntime(o),a?"string"===e.typeOf(a)&&(a={data:a}):a={},e.extend(this,{uid:a.uid||e.guid("uid_"),ruid:o,size:a.size||0,type:a.type||"",slice:function(e,t,i){return this.isDetached()?s.apply(this,arguments):this.getRuntime().exec.call(this,"Blob","slice",this.getSource(),e,t,i)},getSource:function(){return r[this.uid]?r[this.uid]:null},detach:function(e){if(this.ruid&&(this.getRuntime().exec.call(this,"Blob","destroy"),this.disconnectRuntime(),this.ruid=null),e=e||"","data:"==e.substr(0,5)){var i=e.indexOf(";base64,");this.type=e.substring(5,i),e=t.atob(e.substring(i+8))}this.size=e.length,r[this.uid]=e},isDetached:function(){return!this.ruid&&"string"===e.typeOf(r[this.uid])},destroy:function(){this.detach(),delete r[this.uid]}}),a.data?this.detach(a.data):r[this.uid]=a}var r={};return n}),n("moxie/core/I18n",["moxie/core/utils/Basic"],function(e){var t={};return{addI18n:function(i){return e.extend(t,i)},translate:function(e){return t[e]||e},_:function(e){return this.translate(e)},sprintf:function(t){var i=[].slice.call(arguments,1);return t.replace(/%[a-z]/g,function(){var t=i.shift();return"undefined"!==e.typeOf(t)?t:""})}}}),n("moxie/core/utils/Mime",["moxie/core/utils/Basic","moxie/core/I18n"],function(e,t){var i="application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb xlt xla,application/vnd.ms-powerpoint,ppt pps pot ppa,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mp3 mpga mpega mp2,audio/x-wav,wav,audio/x-m4a,m4a,audio/ogg,oga ogg,audio/aiff,aiff aif,audio/flac,flac,audio/aac,aac,audio/ac3,ac3,audio/x-ms-wma,wma,image/bmp,bmp,image/gif,gif,image/jpeg,jpg jpeg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe m2v,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/3gpp,3gpp 3gp,video/3gpp2,3g2,video/vnd.rn-realvideo,rv,video/ogg,ogv,video/x-matroska,mkv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe",n={},r={},o=function(e){var t,i,o,a=e.split(/,/);for(t=0;t<a.length;t+=2){for(o=a[t+1].split(/ /),i=0;i<o.length;i++)n[o[i]]=a[t];r[a[t]]=o}},a=function(t,i){var n,r,o,a,s=[];for(r=0;r<t.length;r++)for(n=t[r].extensions.toLowerCase().split(/\s*,\s*/),o=0;o<n.length;o++){if("*"===n[o])return[];if(a=s[n[o]],i&&/^\w+$/.test(n[o]))s.push("."+n[o]);else if(a&&-1===e.inArray(a,s))s.push(a);else if(!a)return[]}return s},s=function(t){var i=[];return e.each(t,function(t){if(t=t.toLowerCase(),"*"===t)return i=[],!1;var n=t.match(/^(\w+)\/(\*|\w+)$/);n&&("*"===n[2]?e.each(r,function(e,t){new RegExp("^"+n[1]+"/").test(t)&&[].push.apply(i,r[t])}):r[t]&&[].push.apply(i,r[t]))}),i},u=function(i){var n=[],r=[];return"string"===e.typeOf(i)&&(i=e.trim(i).split(/\s*,\s*/)),r=s(i),n.push({title:t.translate("Files"),extensions:r.length?r.join(","):"*"}),n},c=function(e){var t=e&&e.match(/\.([^.]+)$/);return t?t[1].toLowerCase():""},l=function(e){return n[c(e)]||""};return o(i),{mimes:n,extensions:r,addMimeType:o,extList2mimes:a,mimes2exts:s,mimes2extList:u,getFileExtension:c,getFileMime:l}}),n("moxie/file/FileInput",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Mime","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/core/EventTarget","moxie/core/I18n","moxie/runtime/Runtime","moxie/runtime/RuntimeClient"],function(e,t,i,n,r,o,a,s,u){function c(t){var o,c,d;if(-1!==e.inArray(e.typeOf(t),["string","node"])&&(t={browse_button:t}),c=n.get(t.browse_button),!c)throw new r.DOMException(r.DOMException.NOT_FOUND_ERR);d={accept:[{title:a.translate("All Files"),extensions:"*"}],multiple:!1,required_caps:!1,container:c.parentNode||document.body},t=e.extend({},d,t),"string"==typeof t.required_caps&&(t.required_caps=s.parseCaps(t.required_caps)),"string"==typeof t.accept&&(t.accept=i.mimes2extList(t.accept)),o=n.get(t.container),o||(o=document.body),"static"===n.getStyle(o,"position")&&(o.style.position="relative"),o=c=null,u.call(this),e.extend(this,{uid:e.guid("uid_"),ruid:null,shimid:null,files:null,init:function(){var i=this;i.bind("RuntimeInit",function(r,o){i.ruid=o.uid,i.shimid=o.shimid,i.bind("Ready",function(){i.trigger("Refresh")},999),i.bind("Refresh",function(){var i,r,a,s,u;a=n.get(t.browse_button),s=n.get(o.shimid),a&&(i=n.getPos(a,n.get(t.container)),r=n.getSize(a),u=parseInt(n.getStyle(a,"z-index"),10)||0,s&&e.extend(s.style,{top:i.y+"px",left:i.x+"px",width:r.w+"px",height:r.h+"px",zIndex:u+1})),s=a=null}),o.exec.call(i,"FileInput","init",t)}),i.connectRuntime(e.extend({},t,{required_caps:{select_file:!0}}))},getOption:function(e){return t[e]},setOption:function(e,n){if(t.hasOwnProperty(e)){var o=t[e];switch(e){case"accept":"string"==typeof n&&(n=i.mimes2extList(n));break;case"container":case"required_caps":throw new r.FileException(r.FileException.NO_MODIFICATION_ALLOWED_ERR)}t[e]=n,this.exec("FileInput","setOption",e,n),this.trigger("OptionChanged",e,n,o)}},disable:function(t){var i=this.getRuntime();i&&this.exec("FileInput","disable","undefined"===e.typeOf(t)?!0:t)},refresh:function(){this.trigger("Refresh")},destroy:function(){var t=this.getRuntime();t&&(t.exec.call(this,"FileInput","destroy"),this.disconnectRuntime()),"array"===e.typeOf(this.files)&&e.each(this.files,function(e){e.destroy()}),this.files=null,this.unbindAll()}}),this.handleEventProps(l)}var l=["ready","change","cancel","mouseenter","mouseleave","mousedown","mouseup"];return c.prototype=o.instance,c}),n("moxie/file/File",["moxie/core/utils/Basic","moxie/core/utils/Mime","moxie/file/Blob"],function(e,t,i){function n(n,r){r||(r={}),i.apply(this,arguments),this.type||(this.type=t.getFileMime(r.name));var o;if(r.name)o=r.name.replace(/\\/g,"/"),o=o.substr(o.lastIndexOf("/")+1);else if(this.type){var a=this.type.split("/")[0];o=e.guid((""!==a?a:"file")+"_"),t.extensions[this.type]&&(o+="."+t.extensions[this.type][0])}e.extend(this,{name:o||e.guid("file_"),relativePath:"",lastModifiedDate:r.lastModifiedDate||(new Date).toLocaleString()})}return n.prototype=i.prototype,n}),n("moxie/file/FileDrop",["moxie/core/I18n","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/core/utils/Basic","moxie/core/utils/Env","moxie/file/File","moxie/runtime/RuntimeClient","moxie/core/EventTarget","moxie/core/utils/Mime"],function(e,t,i,n,r,o,a,s,u){function c(i){var r,o=this;"string"==typeof i&&(i={drop_zone:i}),r={accept:[{title:e.translate("All Files"),extensions:"*"}],required_caps:{drag_and_drop:!0}},i="object"==typeof i?n.extend({},r,i):r,i.container=t.get(i.drop_zone)||document.body,"static"===t.getStyle(i.container,"position")&&(i.container.style.position="relative"),"string"==typeof i.accept&&(i.accept=u.mimes2extList(i.accept)),a.call(o),n.extend(o,{uid:n.guid("uid_"),ruid:null,files:null,init:function(){o.bind("RuntimeInit",function(e,t){o.ruid=t.uid,t.exec.call(o,"FileDrop","init",i),o.dispatchEvent("ready")
}),o.connectRuntime(i)},destroy:function(){var e=this.getRuntime();e&&(e.exec.call(this,"FileDrop","destroy"),this.disconnectRuntime()),this.files=null,this.unbindAll()}}),this.handleEventProps(l)}var l=["ready","dragenter","dragleave","drop","error"];return c.prototype=s.instance,c}),n("moxie/file/FileReader",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/core/Exceptions","moxie/core/EventTarget","moxie/file/Blob","moxie/runtime/RuntimeClient"],function(e,t,i,n,r,o){function a(){function n(e,n){if(this.trigger("loadstart"),this.readyState===a.LOADING)return this.trigger("error",new i.DOMException(i.DOMException.INVALID_STATE_ERR)),this.trigger("loadend"),void 0;if(!(n instanceof r))return this.trigger("error",new i.DOMException(i.DOMException.NOT_FOUND_ERR)),this.trigger("loadend"),void 0;if(this.result=null,this.readyState=a.LOADING,n.isDetached()){var o=n.getSource();switch(e){case"readAsText":case"readAsBinaryString":this.result=o;break;case"readAsDataURL":this.result="data:"+n.type+";base64,"+t.btoa(o)}this.readyState=a.DONE,this.trigger("load"),this.trigger("loadend")}else this.connectRuntime(n.ruid),this.exec("FileReader","read",e,n)}o.call(this),e.extend(this,{uid:e.guid("uid_"),readyState:a.EMPTY,result:null,error:null,readAsBinaryString:function(e){n.call(this,"readAsBinaryString",e)},readAsDataURL:function(e){n.call(this,"readAsDataURL",e)},readAsText:function(e){n.call(this,"readAsText",e)},abort:function(){this.result=null,-1===e.inArray(this.readyState,[a.EMPTY,a.DONE])&&(this.readyState===a.LOADING&&(this.readyState=a.DONE),this.exec("FileReader","abort"),this.trigger("abort"),this.trigger("loadend"))},destroy:function(){this.abort(),this.exec("FileReader","destroy"),this.disconnectRuntime(),this.unbindAll()}}),this.handleEventProps(s),this.bind("Error",function(e,t){this.readyState=a.DONE,this.error=t},999),this.bind("Load",function(){this.readyState=a.DONE},999)}var s=["loadstart","progress","load","abort","error","loadend"];return a.EMPTY=0,a.LOADING=1,a.DONE=2,a.prototype=n.instance,a}),n("moxie/core/utils/Url",["moxie/core/utils/Basic"],function(e){var t=function(i,n){var r,o=["source","scheme","authority","userInfo","user","pass","host","port","relative","path","directory","file","query","fragment"],a=o.length,s={http:80,https:443},u={},c=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@\/]*):?([^:@\/]*))?@)?(\[[\da-fA-F:]+\]|[^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/,l=c.exec(i||""),d=/^\/\/\w/.test(i);switch(e.typeOf(n)){case"undefined":n=t(document.location.href,!1);break;case"string":n=t(n,!1)}for(;a--;)l[a]&&(u[o[a]]=l[a]);if(r=!d&&!u.scheme,(d||r)&&(u.scheme=n.scheme),r){u.host=n.host,u.port=n.port;var m="";/^[^\/]/.test(u.path)&&(m=n.path,m=/\/[^\/]*\.[^\/]*$/.test(m)?m.replace(/\/[^\/]+$/,"/"):m.replace(/\/?$/,"/")),u.path=m+(u.path||"")}return u.port||(u.port=s[u.scheme]||80),u.port=parseInt(u.port,10),u.path||(u.path="/"),delete u.source,u},i=function(e){var i={http:80,https:443},n="object"==typeof e?e:t(e);return n.scheme+"://"+n.host+(n.port!==i[n.scheme]?":"+n.port:"")+n.path+(n.query?n.query:"")},n=function(e){function i(e){return[e.scheme,e.host,e.port].join("/")}return"string"==typeof e&&(e=t(e)),i(t())===i(e)};return{parseUrl:t,resolveUrl:i,hasSameOrigin:n}}),n("moxie/runtime/RuntimeTarget",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(e,t,i){function n(){this.uid=e.guid("uid_"),t.call(this),this.destroy=function(){this.disconnectRuntime(),this.unbindAll()}}return n.prototype=i.instance,n}),n("moxie/file/FileReaderSync",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/utils/Encode"],function(e,t,i){return function(){function n(e,t){if(!t.isDetached()){var n=this.connectRuntime(t.ruid).exec.call(this,"FileReaderSync","read",e,t);return this.disconnectRuntime(),n}var r=t.getSource();switch(e){case"readAsBinaryString":return r;case"readAsDataURL":return"data:"+t.type+";base64,"+i.btoa(r);case"readAsText":for(var o="",a=0,s=r.length;s>a;a++)o+=String.fromCharCode(r[a]);return o}}t.call(this),e.extend(this,{uid:e.guid("uid_"),readAsBinaryString:function(e){return n.call(this,"readAsBinaryString",e)},readAsDataURL:function(e){return n.call(this,"readAsDataURL",e)},readAsText:function(e){return n.call(this,"readAsText",e)}})}}),n("moxie/xhr/FormData",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/file/Blob"],function(e,t,i){function n(){var e,n=[];t.extend(this,{append:function(r,o){var a=this,s=t.typeOf(o);o instanceof i?e={name:r,value:o}:"array"===s?(r+="[]",t.each(o,function(e){a.append(r,e)})):"object"===s?t.each(o,function(e,t){a.append(r+"["+t+"]",e)}):"null"===s||"undefined"===s||"number"===s&&isNaN(o)?a.append(r,"false"):n.push({name:r,value:o.toString()})},hasBlob:function(){return!!this.getBlob()},getBlob:function(){return e&&e.value||null},getBlobName:function(){return e&&e.name||null},each:function(i){t.each(n,function(e){i(e.value,e.name)}),e&&i(e.value,e.name)},destroy:function(){e=null,n=[]}})}return n}),n("moxie/xhr/XMLHttpRequest",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/core/EventTarget","moxie/core/utils/Encode","moxie/core/utils/Url","moxie/runtime/Runtime","moxie/runtime/RuntimeTarget","moxie/file/Blob","moxie/file/FileReaderSync","moxie/xhr/FormData","moxie/core/utils/Env","moxie/core/utils/Mime"],function(e,t,i,n,r,o,a,s,u,c,l,d){function m(){this.uid=e.guid("uid_")}function h(){function i(e,t){return I.hasOwnProperty(e)?1===arguments.length?l.can("define_property")?I[e]:A[e]:(l.can("define_property")?I[e]=t:A[e]=t,void 0):void 0}function u(t){function n(){_&&(_.destroy(),_=null),s.dispatchEvent("loadend"),s=null}function r(r){_.bind("LoadStart",function(e){i("readyState",h.LOADING),s.dispatchEvent("readystatechange"),s.dispatchEvent(e),L&&s.upload.dispatchEvent(e)}),_.bind("Progress",function(e){i("readyState")!==h.LOADING&&(i("readyState",h.LOADING),s.dispatchEvent("readystatechange")),s.dispatchEvent(e)}),_.bind("UploadProgress",function(e){L&&s.upload.dispatchEvent({type:"progress",lengthComputable:!1,total:e.total,loaded:e.loaded})}),_.bind("Load",function(t){i("readyState",h.DONE),i("status",Number(r.exec.call(_,"XMLHttpRequest","getStatus")||0)),i("statusText",f[i("status")]||""),i("response",r.exec.call(_,"XMLHttpRequest","getResponse",i("responseType"))),~e.inArray(i("responseType"),["text",""])?i("responseText",i("response")):"document"===i("responseType")&&i("responseXML",i("response")),U=r.exec.call(_,"XMLHttpRequest","getAllResponseHeaders"),s.dispatchEvent("readystatechange"),i("status")>0?(L&&s.upload.dispatchEvent(t),s.dispatchEvent(t)):(F=!0,s.dispatchEvent("error")),n()}),_.bind("Abort",function(e){s.dispatchEvent(e),n()}),_.bind("Error",function(e){F=!0,i("readyState",h.DONE),s.dispatchEvent("readystatechange"),M=!0,s.dispatchEvent(e),n()}),r.exec.call(_,"XMLHttpRequest","send",{url:x,method:v,async:T,user:w,password:y,headers:S,mimeType:D,encoding:O,responseType:s.responseType,withCredentials:s.withCredentials,options:k},t)}var s=this;E=(new Date).getTime(),_=new a,"string"==typeof k.required_caps&&(k.required_caps=o.parseCaps(k.required_caps)),k.required_caps=e.extend({},k.required_caps,{return_response_type:s.responseType}),t instanceof c&&(k.required_caps.send_multipart=!0),e.isEmptyObj(S)||(k.required_caps.send_custom_headers=!0),B||(k.required_caps.do_cors=!0),k.ruid?r(_.connectRuntime(k)):(_.bind("RuntimeInit",function(e,t){r(t)}),_.bind("RuntimeError",function(e,t){s.dispatchEvent("RuntimeError",t)}),_.connectRuntime(k))}function g(){i("responseText",""),i("responseXML",null),i("response",null),i("status",0),i("statusText",""),E=b=null}var x,v,w,y,E,b,_,R,A=this,I={timeout:0,readyState:h.UNSENT,withCredentials:!1,status:0,statusText:"",responseType:"",responseXML:null,responseText:null,response:null},T=!0,S={},O=null,D=null,N=!1,C=!1,L=!1,M=!1,F=!1,B=!1,P=null,H=null,k={},U="";e.extend(this,I,{uid:e.guid("uid_"),upload:new m,open:function(o,a,s,u,c){var l;if(!o||!a)throw new t.DOMException(t.DOMException.SYNTAX_ERR);if(/[\u0100-\uffff]/.test(o)||n.utf8_encode(o)!==o)throw new t.DOMException(t.DOMException.SYNTAX_ERR);if(~e.inArray(o.toUpperCase(),["CONNECT","DELETE","GET","HEAD","OPTIONS","POST","PUT","TRACE","TRACK"])&&(v=o.toUpperCase()),~e.inArray(v,["CONNECT","TRACE","TRACK"]))throw new t.DOMException(t.DOMException.SECURITY_ERR);if(a=n.utf8_encode(a),l=r.parseUrl(a),B=r.hasSameOrigin(l),x=r.resolveUrl(a),(u||c)&&!B)throw new t.DOMException(t.DOMException.INVALID_ACCESS_ERR);if(w=u||l.user,y=c||l.pass,T=s||!0,T===!1&&(i("timeout")||i("withCredentials")||""!==i("responseType")))throw new t.DOMException(t.DOMException.INVALID_ACCESS_ERR);N=!T,C=!1,S={},g.call(this),i("readyState",h.OPENED),this.dispatchEvent("readystatechange")},setRequestHeader:function(r,o){var a=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","content-transfer-encoding","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"];if(i("readyState")!==h.OPENED||C)throw new t.DOMException(t.DOMException.INVALID_STATE_ERR);if(/[\u0100-\uffff]/.test(r)||n.utf8_encode(r)!==r)throw new t.DOMException(t.DOMException.SYNTAX_ERR);return r=e.trim(r).toLowerCase(),~e.inArray(r,a)||/^(proxy\-|sec\-)/.test(r)?!1:(S[r]?S[r]+=", "+o:S[r]=o,!0)},hasRequestHeader:function(e){return e&&S[e.toLowerCase()]||!1},getAllResponseHeaders:function(){return U||""},getResponseHeader:function(t){return t=t.toLowerCase(),F||~e.inArray(t,["set-cookie","set-cookie2"])?null:U&&""!==U&&(R||(R={},e.each(U.split(/\r\n/),function(t){var i=t.split(/:\s+/);2===i.length&&(i[0]=e.trim(i[0]),R[i[0].toLowerCase()]={header:i[0],value:e.trim(i[1])})})),R.hasOwnProperty(t))?R[t].header+": "+R[t].value:null},overrideMimeType:function(n){var r,o;if(~e.inArray(i("readyState"),[h.LOADING,h.DONE]))throw new t.DOMException(t.DOMException.INVALID_STATE_ERR);if(n=e.trim(n.toLowerCase()),/;/.test(n)&&(r=n.match(/^([^;]+)(?:;\scharset\=)?(.*)$/))&&(n=r[1],r[2]&&(o=r[2])),!d.mimes[n])throw new t.DOMException(t.DOMException.SYNTAX_ERR);P=n,H=o},send:function(i,r){if(k="string"===e.typeOf(r)?{ruid:r}:r?r:{},this.readyState!==h.OPENED||C)throw new t.DOMException(t.DOMException.INVALID_STATE_ERR);if(i instanceof s)k.ruid=i.ruid,D=i.type||"application/octet-stream";else if(i instanceof c){if(i.hasBlob()){var o=i.getBlob();k.ruid=o.ruid,D=o.type||"application/octet-stream"}}else"string"==typeof i&&(O="UTF-8",D="text/plain;charset=UTF-8",i=n.utf8_encode(i));this.withCredentials||(this.withCredentials=k.required_caps&&k.required_caps.send_browser_cookies&&!B),L=!N&&this.upload.hasEventListener(),F=!1,M=!i,N||(C=!0),u.call(this,i)},abort:function(){if(F=!0,N=!1,~e.inArray(i("readyState"),[h.UNSENT,h.OPENED,h.DONE]))i("readyState",h.UNSENT);else{if(i("readyState",h.DONE),C=!1,!_)throw new t.DOMException(t.DOMException.INVALID_STATE_ERR);_.getRuntime().exec.call(_,"XMLHttpRequest","abort",M),M=!0}},destroy:function(){_&&("function"===e.typeOf(_.destroy)&&_.destroy(),_=null),this.unbindAll(),this.upload&&(this.upload.unbindAll(),this.upload=null)}}),this.handleEventProps(p.concat(["readystatechange"])),this.upload.handleEventProps(p)}var f={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Reserved",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",426:"Upgrade Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",510:"Not Extended"};m.prototype=i.instance;var p=["loadstart","progress","abort","error","load","timeout","loadend"];return h.UNSENT=0,h.OPENED=1,h.HEADERS_RECEIVED=2,h.LOADING=3,h.DONE=4,h.prototype=i.instance,h}),n("moxie/runtime/Transporter",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(e,t,i,n){function r(){function n(){l=d=0,c=this.result=null}function o(t,i){var n=this;u=i,n.bind("TransportingProgress",function(t){d=t.loaded,l>d&&-1===e.inArray(n.state,[r.IDLE,r.DONE])&&a.call(n)},999),n.bind("TransportingComplete",function(){d=l,n.state=r.DONE,c=null,n.result=u.exec.call(n,"Transporter","getAsBlob",t||"")},999),n.state=r.BUSY,n.trigger("TransportingStarted"),a.call(n)}function a(){var e,i=this,n=l-d;m>n&&(m=n),e=t.btoa(c.substr(d,m)),u.exec.call(i,"Transporter","receive",e,l)}var s,u,c,l,d,m;i.call(this),e.extend(this,{uid:e.guid("uid_"),state:r.IDLE,result:null,transport:function(t,i,r){var a=this;if(r=e.extend({chunk_size:204798},r),(s=r.chunk_size%3)&&(r.chunk_size+=3-s),m=r.chunk_size,n.call(this),c=t,l=t.length,"string"===e.typeOf(r)||r.ruid)o.call(a,i,this.connectRuntime(r));else{var u=function(e,t){a.unbind("RuntimeInit",u),o.call(a,i,t)};this.bind("RuntimeInit",u),this.connectRuntime(r)}},abort:function(){var e=this;e.state=r.IDLE,u&&(u.exec.call(e,"Transporter","clear"),e.trigger("TransportingAborted")),n.call(e)},destroy:function(){this.unbindAll(),u=null,this.disconnectRuntime(),n.call(this)}})}return r.IDLE=0,r.BUSY=1,r.DONE=2,r.prototype=n.instance,r}),n("moxie/image/Image",["moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/file/FileReaderSync","moxie/xhr/XMLHttpRequest","moxie/runtime/Runtime","moxie/runtime/RuntimeClient","moxie/runtime/Transporter","moxie/core/utils/Env","moxie/core/EventTarget","moxie/file/Blob","moxie/file/File","moxie/core/utils/Encode"],function(e,t,i,n,r,o,a,s,u,c,l,d,m){function h(){function n(e){try{return e||(e=this.exec("Image","getInfo")),this.size=e.size,this.width=e.width,this.height=e.height,this.type=e.type,this.meta=e.meta,""===this.name&&(this.name=e.name),!0}catch(t){return this.trigger("error",t.code),!1}}function c(t){var n=e.typeOf(t);try{if(t instanceof h){if(!t.size)throw new i.DOMException(i.DOMException.INVALID_STATE_ERR);p.apply(this,arguments)}else if(t instanceof l){if(!~e.inArray(t.type,["image/jpeg","image/png"]))throw new i.ImageError(i.ImageError.WRONG_FORMAT);g.apply(this,arguments)}else if(-1!==e.inArray(n,["blob","file"]))c.call(this,new d(null,t),arguments[1]);else if("string"===n)"data:"===t.substr(0,5)?c.call(this,new l(null,{data:t}),arguments[1]):x.apply(this,arguments);else{if("node"!==n||"img"!==t.nodeName.toLowerCase())throw new i.DOMException(i.DOMException.TYPE_MISMATCH_ERR);c.call(this,t.src,arguments[1])}}catch(r){this.trigger("error",r.code)}}function p(t,i){var n=this.connectRuntime(t.ruid);this.ruid=n.uid,n.exec.call(this,"Image","loadFromImage",t,"undefined"===e.typeOf(i)?!0:i)}function g(t,i){function n(e){r.ruid=e.uid,e.exec.call(r,"Image","loadFromBlob",t)}var r=this;r.name=t.name||"",t.isDetached()?(this.bind("RuntimeInit",function(e,t){n(t)}),i&&"string"==typeof i.required_caps&&(i.required_caps=o.parseCaps(i.required_caps)),this.connectRuntime(e.extend({required_caps:{access_image_binary:!0,resize_image:!0}},i))):n(this.connectRuntime(t.ruid))}function x(e,t){var i,n=this;i=new r,i.open("get",e),i.responseType="blob",i.onprogress=function(e){n.trigger(e)},i.onload=function(){g.call(n,i.response,!0)},i.onerror=function(e){n.trigger(e)},i.onloadend=function(){i.destroy()},i.bind("RuntimeError",function(e,t){n.trigger("RuntimeError",t)}),i.send(null,t)}a.call(this),e.extend(this,{uid:e.guid("uid_"),ruid:null,name:"",size:0,width:0,height:0,type:"",meta:{},clone:function(){this.load.apply(this,arguments)},load:function(){c.apply(this,arguments)},resize:function(t){var n,r,o=this,a={x:0,y:0,width:o.width,height:o.height},s=e.extendIf({width:o.width,height:o.height,type:o.type||"image/jpeg",quality:90,crop:!1,fit:!0,preserveHeaders:!0,resample:"default",multipass:!0},t);try{if(!o.size)throw new i.DOMException(i.DOMException.INVALID_STATE_ERR);if(o.width>h.MAX_RESIZE_WIDTH||o.height>h.MAX_RESIZE_HEIGHT)throw new i.ImageError(i.ImageError.MAX_RESOLUTION_ERR);if(n=o.meta&&o.meta.tiff&&o.meta.tiff.Orientation||1,-1!==e.inArray(n,[5,6,7,8])){var u=s.width;s.width=s.height,s.height=u}if(s.crop){switch(r=Math.max(s.width/o.width,s.height/o.height),t.fit?(a.width=Math.min(Math.ceil(s.width/r),o.width),a.height=Math.min(Math.ceil(s.height/r),o.height),r=s.width/a.width):(a.width=Math.min(s.width,o.width),a.height=Math.min(s.height,o.height),r=1),"boolean"==typeof s.crop&&(s.crop="cc"),s.crop.toLowerCase().replace(/_/,"-")){case"rb":case"right-bottom":a.x=o.width-a.width,a.y=o.height-a.height;break;case"cb":case"center-bottom":a.x=Math.floor((o.width-a.width)/2),a.y=o.height-a.height;break;case"lb":case"left-bottom":a.x=0,a.y=o.height-a.height;break;case"lt":case"left-top":a.x=0,a.y=0;break;case"ct":case"center-top":a.x=Math.floor((o.width-a.width)/2),a.y=0;break;case"rt":case"right-top":a.x=o.width-a.width,a.y=0;break;case"rc":case"right-center":case"right-middle":a.x=o.width-a.width,a.y=Math.floor((o.height-a.height)/2);break;case"lc":case"left-center":case"left-middle":a.x=0,a.y=Math.floor((o.height-a.height)/2);break;case"cc":case"center-center":case"center-middle":default:a.x=Math.floor((o.width-a.width)/2),a.y=Math.floor((o.height-a.height)/2)}a.x=Math.max(a.x,0),a.y=Math.max(a.y,0)}else r=Math.min(s.width/o.width,s.height/o.height),r>1&&!s.fit&&(r=1);this.exec("Image","resize",a,r,s)}catch(c){o.trigger("error",c.code)}},downsize:function(t){var i,n={width:this.width,height:this.height,type:this.type||"image/jpeg",quality:90,crop:!1,fit:!1,preserveHeaders:!0,resample:"default"};i="object"==typeof t?e.extend(n,t):e.extend(n,{width:arguments[0],height:arguments[1],crop:arguments[2],preserveHeaders:arguments[3]}),this.resize(i)},crop:function(e,t,i){this.downsize(e,t,!0,i)},getAsCanvas:function(){if(!u.can("create_canvas"))throw new i.RuntimeError(i.RuntimeError.NOT_SUPPORTED_ERR);return this.exec("Image","getAsCanvas")},getAsBlob:function(e,t){if(!this.size)throw new i.DOMException(i.DOMException.INVALID_STATE_ERR);return this.exec("Image","getAsBlob",e||"image/jpeg",t||90)},getAsDataURL:function(e,t){if(!this.size)throw new i.DOMException(i.DOMException.INVALID_STATE_ERR);return this.exec("Image","getAsDataURL",e||"image/jpeg",t||90)},getAsBinaryString:function(e,t){var i=this.getAsDataURL(e,t);return m.atob(i.substring(i.indexOf("base64,")+7))},embed:function(n,r){function o(t,r){var o=this;if(u.can("create_canvas")){var l=o.getAsCanvas();if(l)return n.appendChild(l),l=null,o.destroy(),c.trigger("embedded"),void 0}var d=o.getAsDataURL(t,r);if(!d)throw new i.ImageError(i.ImageError.WRONG_FORMAT);if(u.can("use_data_uri_of",d.length))n.innerHTML='<img src="'+d+'" width="'+o.width+'" height="'+o.height+'" alt="" />',o.destroy(),c.trigger("embedded");else{var h=new s;h.bind("TransportingComplete",function(){a=c.connectRuntime(this.result.ruid),c.bind("Embedded",function(){e.extend(a.getShimContainer().style,{top:"0px",left:"0px",width:o.width+"px",height:o.height+"px"}),a=null},999),a.exec.call(c,"ImageView","display",this.result.uid,width,height),o.destroy()}),h.transport(m.atob(d.substring(d.indexOf("base64,")+7)),t,{required_caps:{display_media:!0},runtime_order:"flash,silverlight",container:n})}}var a,c=this,l=e.extend({width:this.width,height:this.height,type:this.type||"image/jpeg",quality:90,fit:!0,resample:"nearest"},r);try{if(!(n=t.get(n)))throw new i.DOMException(i.DOMException.INVALID_NODE_TYPE_ERR);if(!this.size)throw new i.DOMException(i.DOMException.INVALID_STATE_ERR);this.width>h.MAX_RESIZE_WIDTH||this.height>h.MAX_RESIZE_HEIGHT;var d=new h;return d.bind("Resize",function(){o.call(this,l.type,l.quality)}),d.bind("Load",function(){this.downsize(l)}),this.meta.thumb&&this.meta.thumb.width>=l.width&&this.meta.thumb.height>=l.height?d.load(this.meta.thumb.data):d.clone(this,!1),d}catch(f){this.trigger("error",f.code)}},destroy:function(){this.ruid&&(this.getRuntime().exec.call(this,"Image","destroy"),this.disconnectRuntime()),this.meta&&this.meta.thumb&&this.meta.thumb.data.destroy(),this.unbindAll()}}),this.handleEventProps(f),this.bind("Load Resize",function(){return n.call(this)},999)}var f=["progress","load","error","resize","embedded"];return h.MAX_RESIZE_WIDTH=8192,h.MAX_RESIZE_HEIGHT=8192,h.prototype=c.instance,h}),n("moxie/runtime/html5/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(e,t,i,n){function o(t){var o=this,u=i.capTest,c=i.capTrue,l=e.extend({access_binary:u(window.FileReader||window.File&&window.File.getAsDataURL),access_image_binary:function(){return o.can("access_binary")&&!!s.Image},display_media:u((n.can("create_canvas")||n.can("use_data_uri_over32kb"))&&r("moxie/image/Image")),do_cors:u(window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest),drag_and_drop:u(function(){var e=document.createElement("div");return("draggable"in e||"ondragstart"in e&&"ondrop"in e)&&("IE"!==n.browser||n.verComp(n.version,9,">"))}()),filter_by_extension:u(function(){return!("Chrome"===n.browser&&n.verComp(n.version,28,"<")||"IE"===n.browser&&n.verComp(n.version,10,"<")||"Safari"===n.browser&&n.verComp(n.version,7,"<")||"Firefox"===n.browser&&n.verComp(n.version,37,"<"))}()),return_response_headers:c,return_response_type:function(e){return"json"===e&&window.JSON?!0:n.can("return_response_type",e)},return_status_code:c,report_upload_progress:u(window.XMLHttpRequest&&(new XMLHttpRequest).upload),resize_image:function(){return o.can("access_binary")&&n.can("create_canvas")},select_file:function(){return n.can("use_fileinput")&&window.File},select_folder:function(){return o.can("select_file")&&("Chrome"===n.browser&&n.verComp(n.version,21,">=")||"Firefox"===n.browser&&n.verComp(n.version,42,">="))},select_multiple:function(){return!(!o.can("select_file")||"Safari"===n.browser&&"Windows"===n.os||"iOS"===n.os&&n.verComp(n.osVersion,"7.0.0",">")&&n.verComp(n.osVersion,"8.0.0","<"))},send_binary_string:u(window.XMLHttpRequest&&((new XMLHttpRequest).sendAsBinary||window.Uint8Array&&window.ArrayBuffer)),send_custom_headers:u(window.XMLHttpRequest),send_multipart:function(){return!!(window.XMLHttpRequest&&(new XMLHttpRequest).upload&&window.FormData)||o.can("send_binary_string")},slice_blob:u(window.File&&(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice)),stream_upload:function(){return o.can("slice_blob")&&o.can("send_multipart")},summon_file_dialog:function(){return o.can("select_file")&&!("Firefox"===n.browser&&n.verComp(n.version,4,"<")||"Opera"===n.browser&&n.verComp(n.version,12,"<")||"IE"===n.browser&&n.verComp(n.version,10,"<"))},upload_filesize:c,use_http_method:c},arguments[2]);i.call(this,t,arguments[1]||a,l),e.extend(this,{init:function(){this.trigger("Init")},destroy:function(e){return function(){e.call(o),e=o=null}}(this.destroy)}),e.extend(this.getShim(),s)}var a="html5",s={};return i.addConstructor(a,o),s}),n("moxie/runtime/html5/file/Blob",["moxie/runtime/html5/Runtime","moxie/file/Blob"],function(e,t){function i(){function e(e,t,i){var n;if(!window.File.prototype.slice)return(n=window.File.prototype.webkitSlice||window.File.prototype.mozSlice)?n.call(e,t,i):null;try{return e.slice(),e.slice(t,i)}catch(r){return e.slice(t,i-t)}}this.slice=function(){return new t(this.getRuntime().uid,e.apply(this,arguments))},this.destroy=function(){this.getRuntime().getShim().removeInstance(this.uid)}}return e.Blob=i}),n("moxie/core/utils/Events",["moxie/core/utils/Basic"],function(e){function t(){this.returnValue=!1}function i(){this.cancelBubble=!0}var n={},r="moxie_"+e.guid(),o=function(o,a,s,u){var c,l;a=a.toLowerCase(),o.addEventListener?(c=s,o.addEventListener(a,c,!1)):o.attachEvent&&(c=function(){var e=window.event;e.target||(e.target=e.srcElement),e.preventDefault=t,e.stopPropagation=i,s(e)},o.attachEvent("on"+a,c)),o[r]||(o[r]=e.guid()),n.hasOwnProperty(o[r])||(n[o[r]]={}),l=n[o[r]],l.hasOwnProperty(a)||(l[a]=[]),l[a].push({func:c,orig:s,key:u})},a=function(t,i,o){var a,s;if(i=i.toLowerCase(),t[r]&&n[t[r]]&&n[t[r]][i]){a=n[t[r]][i];for(var u=a.length-1;u>=0&&(a[u].orig!==o&&a[u].key!==o||(t.removeEventListener?t.removeEventListener(i,a[u].func,!1):t.detachEvent&&t.detachEvent("on"+i,a[u].func),a[u].orig=null,a[u].func=null,a.splice(u,1),o===s));u--);if(a.length||delete n[t[r]][i],e.isEmptyObj(n[t[r]])){delete n[t[r]];try{delete t[r]}catch(c){t[r]=s}}}},s=function(t,i){t&&t[r]&&e.each(n[t[r]],function(e,n){a(t,n,i)})};return{addEvent:o,removeEvent:a,removeAllEvents:s}}),n("moxie/runtime/html5/file/FileInput",["moxie/runtime/html5/Runtime","moxie/file/File","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime","moxie/core/utils/Env"],function(e,t,i,n,r,o,a){function s(){var e,s;i.extend(this,{init:function(u){var c,l,d,m,h,f,p=this,g=p.getRuntime();e=u,d=o.extList2mimes(e.accept,g.can("filter_by_extension")),l=g.getShimContainer(),l.innerHTML='<input id="'+g.uid+'" type="file" style="font-size:999px;opacity:0;"'+(e.multiple&&g.can("select_multiple")?"multiple":"")+(e.directory&&g.can("select_folder")?"webkitdirectory directory":"")+(d?' accept="'+d.join(",")+'"':"")+" />",c=n.get(g.uid),i.extend(c.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"}),m=n.get(e.browse_button),s=n.getStyle(m,"z-index")||"auto",g.can("summon_file_dialog")&&("static"===n.getStyle(m,"position")&&(m.style.position="relative"),r.addEvent(m,"click",function(e){var t=n.get(g.uid);t&&!t.disabled&&t.click(),e.preventDefault()},p.uid),p.bind("Refresh",function(){h=parseInt(s,10)||1,n.get(e.browse_button).style.zIndex=h,this.getRuntime().getShimContainer().style.zIndex=h-1})),f=g.can("summon_file_dialog")?m:l,r.addEvent(f,"mouseover",function(){p.trigger("mouseenter")},p.uid),r.addEvent(f,"mouseout",function(){p.trigger("mouseleave")},p.uid),r.addEvent(f,"mousedown",function(){p.trigger("mousedown")},p.uid),r.addEvent(n.get(e.container),"mouseup",function(){p.trigger("mouseup")},p.uid),(g.can("summon_file_dialog")?c:m).setAttribute("tabindex",-1),c.onchange=function x(){if(p.files=[],i.each(this.files,function(i){var n="";return e.directory&&"."==i.name?!0:(i.webkitRelativePath&&(n="/"+i.webkitRelativePath.replace(/^\//,"")),i=new t(g.uid,i),i.relativePath=n,p.files.push(i),void 0)}),"IE"!==a.browser&&"IEMobile"!==a.browser)this.value="";else{var n=this.cloneNode(!0);this.parentNode.replaceChild(n,this),n.onchange=x}p.files.length&&p.trigger("change")},p.trigger({type:"ready",async:!0}),l=null},setOption:function(e,t){var i=this.getRuntime(),r=n.get(i.uid);switch(e){case"accept":if(t){var a=t.mimes||o.extList2mimes(t,i.can("filter_by_extension"));r.setAttribute("accept",a.join(","))}else r.removeAttribute("accept");break;case"directory":t&&i.can("select_folder")?(r.setAttribute("directory",""),r.setAttribute("webkitdirectory","")):(r.removeAttribute("directory"),r.removeAttribute("webkitdirectory"));break;case"multiple":t&&i.can("select_multiple")?r.setAttribute("multiple",""):r.removeAttribute("multiple")}},disable:function(e){var t,i=this.getRuntime();(t=n.get(i.uid))&&(t.disabled=!!e)},destroy:function(){var t=this.getRuntime(),i=t.getShim(),o=t.getShimContainer(),a=e&&n.get(e.container),u=e&&n.get(e.browse_button);a&&r.removeAllEvents(a,this.uid),u&&(r.removeAllEvents(u,this.uid),u.style.zIndex=s),o&&(r.removeAllEvents(o,this.uid),o.innerHTML=""),i.removeInstance(this.uid),e=o=a=u=i=null}})}return e.FileInput=s}),n("moxie/runtime/html5/file/FileDrop",["moxie/runtime/html5/Runtime","moxie/file/File","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime"],function(e,t,i,n,r,o){function a(){function e(e){if(!e.dataTransfer||!e.dataTransfer.types)return!1;var t=i.toArray(e.dataTransfer.types||[]);return-1!==i.inArray("Files",t)||-1!==i.inArray("public.file-url",t)||-1!==i.inArray("application/x-moz-file",t)}function a(e,i){if(u(e)){var n=new t(f,e);n.relativePath=i||"",p.push(n)}}function s(e){for(var t=[],n=0;n<e.length;n++)[].push.apply(t,e[n].extensions.split(/\s*,\s*/));return-1===i.inArray("*",t)?t:[]}function u(e){if(!g.length)return!0;var t=o.getFileExtension(e.name);return!t||-1!==i.inArray(t,g)}function c(e,t){var n=[];i.each(e,function(e){var t=e.webkitGetAsEntry();t&&(t.isFile?a(e.getAsFile(),t.fullPath):n.push(t))}),n.length?l(n,t):t()}function l(e,t){var n=[];i.each(e,function(e){n.push(function(t){d(e,t)})}),i.inSeries(n,function(){t()})}function d(e,t){e.isFile?e.file(function(i){a(i,e.fullPath),t()},function(){t()}):e.isDirectory?m(e,t):t()}function m(e,t){function i(e){r.readEntries(function(t){t.length?([].push.apply(n,t),i(e)):e()},e)}var n=[],r=e.createReader();i(function(){l(n,t)})}var h,f,p=[],g=[];i.extend(this,{init:function(t){var n,o=this;h=t,f=o.ruid,g=s(h.accept),n=h.container,r.addEvent(n,"dragover",function(t){e(t)&&(t.preventDefault(),t.dataTransfer.dropEffect="copy")},o.uid),r.addEvent(n,"drop",function(t){e(t)&&(t.preventDefault(),p=[],t.dataTransfer.items&&t.dataTransfer.items[0].webkitGetAsEntry?c(t.dataTransfer.items,function(){o.files=p,o.trigger("drop")}):(i.each(t.dataTransfer.files,function(e){a(e)}),o.files=p,o.trigger("drop")))},o.uid),r.addEvent(n,"dragenter",function(){o.trigger("dragenter")},o.uid),r.addEvent(n,"dragleave",function(){o.trigger("dragleave")},o.uid)},destroy:function(){r.removeAllEvents(h&&n.get(h.container),this.uid),f=p=g=h=null,this.getRuntime().getShim().removeInstance(this.uid)}})}return e.FileDrop=a}),n("moxie/runtime/html5/file/FileReader",["moxie/runtime/html5/Runtime","moxie/core/utils/Encode","moxie/core/utils/Basic"],function(e,t,i){function n(){function e(e){return t.atob(e.substring(e.indexOf("base64,")+7))}var n,r=!1;i.extend(this,{read:function(t,o){var a=this;a.result="",n=new window.FileReader,n.addEventListener("progress",function(e){a.trigger(e)}),n.addEventListener("load",function(t){a.result=r?e(n.result):n.result,a.trigger(t)}),n.addEventListener("error",function(e){a.trigger(e,n.error)}),n.addEventListener("loadend",function(e){n=null,a.trigger(e)}),"function"===i.typeOf(n[t])?(r=!1,n[t](o.getSource())):"readAsBinaryString"===t&&(r=!0,n.readAsDataURL(o.getSource()))},abort:function(){n&&n.abort()},destroy:function(){n=null,this.getRuntime().getShim().removeInstance(this.uid)}})}return e.FileReader=n}),n("moxie/runtime/html5/xhr/XMLHttpRequest",["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/utils/Mime","moxie/core/utils/Url","moxie/file/File","moxie/file/Blob","moxie/xhr/FormData","moxie/core/Exceptions","moxie/core/utils/Env"],function(e,t,i,n,r,o,a,s,u){function c(){function e(e,t){var i,n,r=this;i=t.getBlob().getSource(),n=new window.FileReader,n.onload=function(){t.append(t.getBlobName(),new o(null,{type:i.type,data:n.result})),f.send.call(r,e,t)},n.readAsBinaryString(i)}function c(){return!window.XMLHttpRequest||"IE"===u.browser&&u.verComp(u.version,8,"<")?function(){for(var e=["Msxml2.XMLHTTP.6.0","Microsoft.XMLHTTP"],t=0;t<e.length;t++)try{return new ActiveXObject(e[t])}catch(i){}}():new window.XMLHttpRequest}function l(e){var t=e.responseXML,i=e.responseText;return"IE"===u.browser&&i&&t&&!t.documentElement&&/[^\/]+\/[^\+]+\+xml/.test(e.getResponseHeader("Content-Type"))&&(t=new window.ActiveXObject("Microsoft.XMLDOM"),t.async=!1,t.validateOnParse=!1,t.loadXML(i)),t&&("IE"===u.browser&&0!==t.parseError||!t.documentElement||"parsererror"===t.documentElement.tagName)?null:t
}function d(e){var t="----moxieboundary"+(new Date).getTime(),i="--",n="\r\n",r="",a=this.getRuntime();if(!a.can("send_binary_string"))throw new s.RuntimeError(s.RuntimeError.NOT_SUPPORTED_ERR);return m.setRequestHeader("Content-Type","multipart/form-data; boundary="+t),e.each(function(e,a){r+=e instanceof o?i+t+n+'Content-Disposition: form-data; name="'+a+'"; filename="'+unescape(encodeURIComponent(e.name||"blob"))+'"'+n+"Content-Type: "+(e.type||"application/octet-stream")+n+n+e.getSource()+n:i+t+n+'Content-Disposition: form-data; name="'+a+'"'+n+n+unescape(encodeURIComponent(e))+n}),r+=i+t+i+n}var m,h,f=this;t.extend(this,{send:function(i,r){var s=this,l="Mozilla"===u.browser&&u.verComp(u.version,4,">=")&&u.verComp(u.version,7,"<"),f="Android Browser"===u.browser,p=!1;if(h=i.url.replace(/^.+?\/([\w\-\.]+)$/,"$1").toLowerCase(),m=c(),m.open(i.method,i.url,i.async,i.user,i.password),r instanceof o)r.isDetached()&&(p=!0),r=r.getSource();else if(r instanceof a){if(r.hasBlob())if(r.getBlob().isDetached())r=d.call(s,r),p=!0;else if((l||f)&&"blob"===t.typeOf(r.getBlob().getSource())&&window.FileReader)return e.call(s,i,r),void 0;if(r instanceof a){var g=new window.FormData;r.each(function(e,t){e instanceof o?g.append(t,e.getSource()):g.append(t,e)}),r=g}}m.upload?(i.withCredentials&&(m.withCredentials=!0),m.addEventListener("load",function(e){s.trigger(e)}),m.addEventListener("error",function(e){s.trigger(e)}),m.addEventListener("progress",function(e){s.trigger(e)}),m.upload.addEventListener("progress",function(e){s.trigger({type:"UploadProgress",loaded:e.loaded,total:e.total})})):m.onreadystatechange=function(){switch(m.readyState){case 1:break;case 2:break;case 3:var e,t;try{n.hasSameOrigin(i.url)&&(e=m.getResponseHeader("Content-Length")||0),m.responseText&&(t=m.responseText.length)}catch(r){e=t=0}s.trigger({type:"progress",lengthComputable:!!e,total:parseInt(e,10),loaded:t});break;case 4:m.onreadystatechange=function(){};try{if(m.status>=200&&m.status<400){s.trigger("load");break}}catch(r){}s.trigger("error")}},t.isEmptyObj(i.headers)||t.each(i.headers,function(e,t){m.setRequestHeader(t,e)}),""!==i.responseType&&"responseType"in m&&(m.responseType="json"!==i.responseType||u.can("return_response_type","json")?i.responseType:"text"),p?m.sendAsBinary?m.sendAsBinary(r):function(){for(var e=new Uint8Array(r.length),t=0;t<r.length;t++)e[t]=255&r.charCodeAt(t);m.send(e.buffer)}():m.send(r),s.trigger("loadstart")},getStatus:function(){try{if(m)return m.status}catch(e){}return 0},getResponse:function(e){var t=this.getRuntime();try{switch(e){case"blob":var n=new r(t.uid,m.response),o=m.getResponseHeader("Content-Disposition");if(o){var a=o.match(/filename=([\'\"'])([^\1]+)\1/);a&&(h=a[2])}return n.name=h,n.type||(n.type=i.getFileMime(h)),n;case"json":return u.can("return_response_type","json")?m.response:200===m.status&&window.JSON?JSON.parse(m.responseText):null;case"document":return l(m);default:return""!==m.responseText?m.responseText:null}}catch(s){return null}},getAllResponseHeaders:function(){try{return m.getAllResponseHeaders()}catch(e){}return""},abort:function(){m&&m.abort()},destroy:function(){f=h=null,this.getRuntime().getShim().removeInstance(this.uid)}})}return e.XMLHttpRequest=c}),n("moxie/runtime/html5/utils/BinaryReader",["moxie/core/utils/Basic"],function(e){function t(e){e instanceof ArrayBuffer?i.apply(this,arguments):n.apply(this,arguments)}function i(t){var i=new DataView(t);e.extend(this,{readByteAt:function(e){return i.getUint8(e)},writeByteAt:function(e,t){i.setUint8(e,t)},SEGMENT:function(e,n,r){switch(arguments.length){case 2:return t.slice(e,e+n);case 1:return t.slice(e);case 3:if(null===r&&(r=new ArrayBuffer),r instanceof ArrayBuffer){var o=new Uint8Array(this.length()-n+r.byteLength);e>0&&o.set(new Uint8Array(t.slice(0,e)),0),o.set(new Uint8Array(r),e),o.set(new Uint8Array(t.slice(e+n)),e+r.byteLength),this.clear(),t=o.buffer,i=new DataView(t);break}default:return t}},length:function(){return t?t.byteLength:0},clear:function(){i=t=null}})}function n(t){function i(e,i,n){n=3===arguments.length?n:t.length-i-1,t=t.substr(0,i)+e+t.substr(n+i)}e.extend(this,{readByteAt:function(e){return t.charCodeAt(e)},writeByteAt:function(e,t){i(String.fromCharCode(t),e,1)},SEGMENT:function(e,n,r){switch(arguments.length){case 1:return t.substr(e);case 2:return t.substr(e,n);case 3:i(null!==r?r:"",e,n);break;default:return t}},length:function(){return t?t.length:0},clear:function(){t=null}})}return e.extend(t.prototype,{littleEndian:!1,read:function(e,t){var i,n,r;if(e+t>this.length())throw new Error("You are trying to read outside the source boundaries.");for(n=this.littleEndian?0:-8*(t-1),r=0,i=0;t>r;r++)i|=this.readByteAt(e+r)<<Math.abs(n+8*r);return i},write:function(e,t,i){var n,r;if(e>this.length())throw new Error("You are trying to write outside the source boundaries.");for(n=this.littleEndian?0:-8*(i-1),r=0;i>r;r++)this.writeByteAt(e+r,255&t>>Math.abs(n+8*r))},BYTE:function(e){return this.read(e,1)},SHORT:function(e){return this.read(e,2)},LONG:function(e){return this.read(e,4)},SLONG:function(e){var t=this.read(e,4);return t>2147483647?t-4294967296:t},CHAR:function(e){return String.fromCharCode(this.read(e,1))},STRING:function(e,t){return this.asArray("CHAR",e,t).join("")},asArray:function(e,t,i){for(var n=[],r=0;i>r;r++)n[r]=this[e](t+r);return n}}),t}),n("moxie/runtime/html5/image/JPEGHeaders",["moxie/runtime/html5/utils/BinaryReader","moxie/core/Exceptions"],function(e,t){return function i(n){var r,o,a,s=[],u=0;if(r=new e(n),65496!==r.SHORT(0))throw r.clear(),new t.ImageError(t.ImageError.WRONG_FORMAT);for(o=2;o<=r.length();)if(a=r.SHORT(o),a>=65488&&65495>=a)o+=2;else{if(65498===a||65497===a)break;u=r.SHORT(o+2)+2,a>=65505&&65519>=a&&s.push({hex:a,name:"APP"+(15&a),start:o,length:u,segment:r.SEGMENT(o,u)}),o+=u}return r.clear(),{headers:s,restore:function(t){var i,n,r;for(r=new e(t),o=65504==r.SHORT(2)?4+r.SHORT(4):2,n=0,i=s.length;i>n;n++)r.SEGMENT(o,0,s[n].segment),o+=s[n].length;return t=r.SEGMENT(),r.clear(),t},strip:function(t){var n,r,o,a;for(o=new i(t),r=o.headers,o.purge(),n=new e(t),a=r.length;a--;)n.SEGMENT(r[a].start,r[a].length,"");return t=n.SEGMENT(),n.clear(),t},get:function(e){for(var t=[],i=0,n=s.length;n>i;i++)s[i].name===e.toUpperCase()&&t.push(s[i].segment);return t},set:function(e,t){var i,n,r,o=[];for("string"==typeof t?o.push(t):o=t,i=n=0,r=s.length;r>i&&(s[i].name===e.toUpperCase()&&(s[i].segment=o[n],s[i].length=o[n].length,n++),!(n>=o.length));i++);},purge:function(){this.headers=s=[]}}}}),n("moxie/runtime/html5/image/ExifParser",["moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader","moxie/core/Exceptions"],function(e,i,n){function r(o){function a(i,r){var o,a,s,u,c,m,h,f,p=this,g=[],x={},v={1:"BYTE",7:"UNDEFINED",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",9:"SLONG",10:"SRATIONAL"},w={BYTE:1,UNDEFINED:1,ASCII:1,SHORT:2,LONG:4,RATIONAL:8,SLONG:4,SRATIONAL:8};for(o=p.SHORT(i),a=0;o>a;a++)if(g=[],h=i+2+12*a,s=r[p.SHORT(h)],s!==t){if(u=v[p.SHORT(h+=2)],c=p.LONG(h+=2),m=w[u],!m)throw new n.ImageError(n.ImageError.INVALID_META_ERR);if(h+=4,m*c>4&&(h=p.LONG(h)+d.tiffHeader),h+m*c>=this.length())throw new n.ImageError(n.ImageError.INVALID_META_ERR);"ASCII"!==u?(g=p.asArray(u,h,c),f=1==c?g[0]:g,x[s]=l.hasOwnProperty(s)&&"object"!=typeof f?l[s][f]:f):x[s]=e.trim(p.STRING(h,c).replace(/\0$/,""))}return x}function s(e,t,i){var n,r,o,a=0;if("string"==typeof t){var s=c[e.toLowerCase()];for(var u in s)if(s[u]===t){t=u;break}}n=d[e.toLowerCase()+"IFD"],r=this.SHORT(n);for(var l=0;r>l;l++)if(o=n+12*l+2,this.SHORT(o)==t){a=o+8;break}if(!a)return!1;try{this.write(a,i,4)}catch(m){return!1}return!0}var u,c,l,d,m,h;if(i.call(this,o),c={tiff:{274:"Orientation",270:"ImageDescription",271:"Make",272:"Model",305:"Software",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"},thumb:{513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength"}},l={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}},d={tiffHeader:10},m=d.tiffHeader,u={clear:this.clear},e.extend(this,{read:function(){try{return r.prototype.read.apply(this,arguments)}catch(e){throw new n.ImageError(n.ImageError.INVALID_META_ERR)}},write:function(){try{return r.prototype.write.apply(this,arguments)}catch(e){throw new n.ImageError(n.ImageError.INVALID_META_ERR)}},UNDEFINED:function(){return this.BYTE.apply(this,arguments)},RATIONAL:function(e){return this.LONG(e)/this.LONG(e+4)},SRATIONAL:function(e){return this.SLONG(e)/this.SLONG(e+4)},ASCII:function(e){return this.CHAR(e)},TIFF:function(){return h||null},EXIF:function(){var t=null;if(d.exifIFD){try{t=a.call(this,d.exifIFD,c.exif)}catch(i){return null}if(t.ExifVersion&&"array"===e.typeOf(t.ExifVersion)){for(var n=0,r="";n<t.ExifVersion.length;n++)r+=String.fromCharCode(t.ExifVersion[n]);t.ExifVersion=r}}return t},GPS:function(){var t=null;if(d.gpsIFD){try{t=a.call(this,d.gpsIFD,c.gps)}catch(i){return null}t.GPSVersionID&&"array"===e.typeOf(t.GPSVersionID)&&(t.GPSVersionID=t.GPSVersionID.join("."))}return t},thumb:function(){if(d.IFD1)try{var e=a.call(this,d.IFD1,c.thumb);if("JPEGInterchangeFormat"in e)return this.SEGMENT(d.tiffHeader+e.JPEGInterchangeFormat,e.JPEGInterchangeFormatLength)}catch(t){}return null},setExif:function(e,t){return"PixelXDimension"!==e&&"PixelYDimension"!==e?!1:s.call(this,"exif",e,t)},clear:function(){u.clear(),o=c=l=h=d=u=null}}),65505!==this.SHORT(0)||"EXIF\0"!==this.STRING(4,5).toUpperCase())throw new n.ImageError(n.ImageError.INVALID_META_ERR);if(this.littleEndian=18761==this.SHORT(m),42!==this.SHORT(m+=2))throw new n.ImageError(n.ImageError.INVALID_META_ERR);d.IFD0=d.tiffHeader+this.LONG(m+=2),h=a.call(this,d.IFD0,c.tiff),"ExifIFDPointer"in h&&(d.exifIFD=d.tiffHeader+h.ExifIFDPointer,delete h.ExifIFDPointer),"GPSInfoIFDPointer"in h&&(d.gpsIFD=d.tiffHeader+h.GPSInfoIFDPointer,delete h.GPSInfoIFDPointer),e.isEmptyObj(h)&&(h=null);var f=this.LONG(d.IFD0+12*this.SHORT(d.IFD0)+2);f&&(d.IFD1=d.tiffHeader+f)}return r.prototype=i.prototype,r}),n("moxie/runtime/html5/image/JPEG",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEGHeaders","moxie/runtime/html5/utils/BinaryReader","moxie/runtime/html5/image/ExifParser"],function(e,t,i,n,r){function o(o){function a(e){var t,i,n=0;for(e||(e=c);n<=e.length();){if(t=e.SHORT(n+=2),t>=65472&&65475>=t)return n+=5,{height:e.SHORT(n),width:e.SHORT(n+=2)};i=e.SHORT(n+=2),n+=i-2}return null}function s(){var e,t,i=d.thumb();return i&&(e=new n(i),t=a(e),e.clear(),t)?(t.data=i,t):null}function u(){d&&l&&c&&(d.clear(),l.purge(),c.clear(),m=l=d=c=null)}var c,l,d,m;if(c=new n(o),65496!==c.SHORT(0))throw new t.ImageError(t.ImageError.WRONG_FORMAT);l=new i(o);try{d=new r(l.get("app1")[0])}catch(h){}m=a.call(this),e.extend(this,{type:"image/jpeg",size:c.length(),width:m&&m.width||0,height:m&&m.height||0,setExif:function(t,i){return d?("object"===e.typeOf(t)?e.each(t,function(e,t){d.setExif(t,e)}):d.setExif(t,i),l.set("app1",d.SEGMENT()),void 0):!1},writeHeaders:function(){return arguments.length?l.restore(arguments[0]):l.restore(o)},stripHeaders:function(e){return l.strip(e)},purge:function(){u.call(this)}}),d&&(this.meta={tiff:d.TIFF(),exif:d.EXIF(),gps:d.GPS(),thumb:s()})}return o}),n("moxie/runtime/html5/image/PNG",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader"],function(e,t,i){function n(n){function r(){var e,t;return e=a.call(this,8),"IHDR"==e.type?(t=e.start,{width:s.LONG(t),height:s.LONG(t+=4)}):null}function o(){s&&(s.clear(),n=l=u=c=s=null)}function a(e){var t,i,n,r;return t=s.LONG(e),i=s.STRING(e+=4,4),n=e+=4,r=s.LONG(e+t),{length:t,type:i,start:n,CRC:r}}var s,u,c,l;s=new i(n),function(){var t=0,i=0,n=[35152,20039,3338,6666];for(i=0;i<n.length;i++,t+=2)if(n[i]!=s.SHORT(t))throw new e.ImageError(e.ImageError.WRONG_FORMAT)}(),l=r.call(this),t.extend(this,{type:"image/png",size:s.length(),width:l.width,height:l.height,purge:function(){o.call(this)}}),o.call(this)}return n}),n("moxie/runtime/html5/image/ImageInfo",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEG","moxie/runtime/html5/image/PNG"],function(e,t,i,n){return function(r){var o,a=[i,n];o=function(){for(var e=0;e<a.length;e++)try{return new a[e](r)}catch(i){}throw new t.ImageError(t.ImageError.WRONG_FORMAT)}(),e.extend(this,{type:"",size:0,width:0,height:0,setExif:function(){},writeHeaders:function(e){return e},stripHeaders:function(e){return e},purge:function(){r=null}}),e.extend(this,o),this.purge=function(){o.purge(),o=null}}}),n("moxie/runtime/html5/image/ResizerCanvas",[],function(){function e(i,n,r){var o=i.width>i.height?"width":"height",a=Math.round(i[o]*n),s=!1;"nearest"!==r&&(.5>n||n>2)&&(n=.5>n?.5:2,s=!0);var u=t(i,n);return s?e(u,a/u[o],r):u}function t(e,t){var i=e.width,n=e.height,r=Math.round(i*t),o=Math.round(n*t),a=document.createElement("canvas");return a.width=r,a.height=o,a.getContext("2d").drawImage(e,0,0,i,n,0,0,r,o),e=null,a}return{scale:e}}),n("moxie/runtime/html5/image/Image",["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/Exceptions","moxie/core/utils/Encode","moxie/file/Blob","moxie/file/File","moxie/runtime/html5/image/ImageInfo","moxie/runtime/html5/image/ResizerCanvas","moxie/core/utils/Mime","moxie/core/utils/Env"],function(e,t,i,n,r,o,a,s,u){function c(){function e(){if(!v&&!g)throw new i.ImageError(i.DOMException.INVALID_STATE_ERR);return v||g}function c(){var t=e();return"canvas"==t.nodeName.toLowerCase()?t:(v=document.createElement("canvas"),v.width=t.width,v.height=t.height,v.getContext("2d").drawImage(t,0,0),v)}function l(e){return n.atob(e.substring(e.indexOf("base64,")+7))}function d(e,t){return"data:"+(t||"")+";base64,"+n.btoa(e)}function m(e){var t=this;g=new Image,g.onerror=function(){p.call(this),t.trigger("error",i.ImageError.WRONG_FORMAT)},g.onload=function(){t.trigger("load")},g.src="data:"==e.substr(0,5)?e:d(e,y.type)}function h(e,t){var n,r=this;return window.FileReader?(n=new FileReader,n.onload=function(){t.call(r,this.result)},n.onerror=function(){r.trigger("error",i.ImageError.WRONG_FORMAT)},n.readAsDataURL(e),void 0):t.call(this,e.getAsDataURL())}function f(e,i){var n=Math.PI/180,r=document.createElement("canvas"),o=r.getContext("2d"),a=e.width,s=e.height;switch(t.inArray(i,[5,6,7,8])>-1?(r.width=s,r.height=a):(r.width=a,r.height=s),i){case 2:o.translate(a,0),o.scale(-1,1);break;case 3:o.translate(a,s),o.rotate(180*n);break;case 4:o.translate(0,s),o.scale(1,-1);break;case 5:o.rotate(90*n),o.scale(1,-1);break;case 6:o.rotate(90*n),o.translate(0,-s);break;case 7:o.rotate(90*n),o.translate(a,-s),o.scale(-1,1);break;case 8:o.rotate(-90*n),o.translate(-a,0)}return o.drawImage(e,0,0,a,s),r}function p(){x&&(x.purge(),x=null),w=g=v=y=null,b=!1}var g,x,v,w,y,E=this,b=!1,_=!0;t.extend(this,{loadFromBlob:function(e){var t=this.getRuntime(),n=arguments.length>1?arguments[1]:!0;if(!t.can("access_binary"))throw new i.RuntimeError(i.RuntimeError.NOT_SUPPORTED_ERR);return y=e,e.isDetached()?(w=e.getSource(),m.call(this,w),void 0):(h.call(this,e.getSource(),function(e){n&&(w=l(e)),m.call(this,e)}),void 0)},loadFromImage:function(e,t){this.meta=e.meta,y=new o(null,{name:e.name,size:e.size,type:e.type}),m.call(this,t?w=e.getAsBinaryString():e.getAsDataURL())},getInfo:function(){var t,i=this.getRuntime();return!x&&w&&i.can("access_image_binary")&&(x=new a(w)),t={width:e().width||0,height:e().height||0,type:y.type||u.getFileMime(y.name),size:w&&w.length||y.size||0,name:y.name||"",meta:null},_&&(t.meta=x&&x.meta||this.meta||{},!t.meta||!t.meta.thumb||t.meta.thumb.data instanceof r||(t.meta.thumb.data=new r(null,{type:"image/jpeg",data:t.meta.thumb.data}))),t},resize:function(t,i,n){var r=document.createElement("canvas");if(r.width=t.width,r.height=t.height,r.getContext("2d").drawImage(e(),t.x,t.y,t.width,t.height,0,0,r.width,r.height),v=s.scale(r,i),_=n.preserveHeaders,!_){var o=this.meta&&this.meta.tiff&&this.meta.tiff.Orientation||1;v=f(v,o)}this.width=v.width,this.height=v.height,b=!0,this.trigger("Resize")},getAsCanvas:function(){return v||(v=c()),v.id=this.uid+"_canvas",v},getAsBlob:function(e,t){return e!==this.type?(b=!0,new o(null,{name:y.name||"",type:e,data:E.getAsDataURL(e,t)})):new o(null,{name:y.name||"",type:e,data:E.getAsBinaryString(e,t)})},getAsDataURL:function(e){var t=arguments[1]||90;if(!b)return g.src;if(c(),"image/jpeg"!==e)return v.toDataURL("image/png");try{return v.toDataURL("image/jpeg",t/100)}catch(i){return v.toDataURL("image/jpeg")}},getAsBinaryString:function(e,t){if(!b)return w||(w=l(E.getAsDataURL(e,t))),w;if("image/jpeg"!==e)w=l(E.getAsDataURL(e,t));else{var i;t||(t=90),c();try{i=v.toDataURL("image/jpeg",t/100)}catch(n){i=v.toDataURL("image/jpeg")}w=l(i),x&&(w=x.stripHeaders(w),_&&(x.meta&&x.meta.exif&&x.setExif({PixelXDimension:this.width,PixelYDimension:this.height}),w=x.writeHeaders(w)),x.purge(),x=null)}return b=!1,w},destroy:function(){E=null,p.call(this),this.getRuntime().getShim().removeInstance(this.uid)}})}return e.Image=c}),n("moxie/runtime/flash/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(e,t,i,n,o){function a(){var e;try{e=navigator.plugins["Shockwave Flash"],e=e.description}catch(t){try{e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(i){e="0.0"}}return e=e.match(/\d+/g),parseFloat(e[0]+"."+e[1])}function s(e){var n=i.get(e);n&&"OBJECT"==n.nodeName&&("IE"===t.browser?(n.style.display="none",function r(){4==n.readyState?u(e):setTimeout(r,10)}()):n.parentNode.removeChild(n))}function u(e){var t=i.get(e);if(t){for(var n in t)"function"==typeof t[n]&&(t[n]=null);t.parentNode.removeChild(t)}}function c(u){var c,m=this;u=e.extend({swf_url:t.swf_url},u),o.call(this,u,l,{access_binary:function(e){return e&&"browser"===m.mode},access_image_binary:function(e){return e&&"browser"===m.mode},display_media:o.capTest(r("moxie/image/Image")),do_cors:o.capTrue,drag_and_drop:!1,report_upload_progress:function(){return"client"===m.mode},resize_image:o.capTrue,return_response_headers:!1,return_response_type:function(t){return"json"===t&&window.JSON?!0:!e.arrayDiff(t,["","text","document"])||"browser"===m.mode},return_status_code:function(t){return"browser"===m.mode||!e.arrayDiff(t,[200,404])},select_file:o.capTrue,select_multiple:o.capTrue,send_binary_string:function(e){return e&&"browser"===m.mode},send_browser_cookies:function(e){return e&&"browser"===m.mode},send_custom_headers:function(e){return e&&"browser"===m.mode},send_multipart:o.capTrue,slice_blob:function(e){return e&&"browser"===m.mode},stream_upload:function(e){return e&&"browser"===m.mode},summon_file_dialog:!1,upload_filesize:function(t){return e.parseSizeStr(t)<=2097152||"client"===m.mode},use_http_method:function(t){return!e.arrayDiff(t,["GET","POST"])}},{access_binary:function(e){return e?"browser":"client"},access_image_binary:function(e){return e?"browser":"client"},report_upload_progress:function(e){return e?"browser":"client"},return_response_type:function(t){return e.arrayDiff(t,["","text","json","document"])?"browser":["client","browser"]},return_status_code:function(t){return e.arrayDiff(t,[200,404])?"browser":["client","browser"]},send_binary_string:function(e){return e?"browser":"client"},send_browser_cookies:function(e){return e?"browser":"client"},send_custom_headers:function(e){return e?"browser":"client"},slice_blob:function(e){return e?"browser":"client"},stream_upload:function(e){return e?"client":"browser"},upload_filesize:function(t){return e.parseSizeStr(t)>=2097152?"client":"browser"}},"client"),a()<11.3&&(this.mode=!1),e.extend(this,{getShim:function(){return i.get(this.uid)},shimExec:function(e,t){var i=[].slice.call(arguments,2);return m.getShim().exec(this.uid,e,t,i)},init:function(){var i,r,a;a=this.getShimContainer(),e.extend(a.style,{position:"absolute",top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"}),i='<object id="'+this.uid+'" type="application/x-shockwave-flash" data="'+u.swf_url+'" ',"IE"===t.browser&&(i+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '),i+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+u.swf_url+'" />'+'<param name="flashvars" value="uid='+escape(this.uid)+"&target="+o.getGlobalEventTarget()+'" />'+'<param name="wmode" value="transparent" />'+'<param name="allowscriptaccess" value="always" />'+"</object>","IE"===t.browser?(r=document.createElement("div"),a.appendChild(r),r.outerHTML=i,r=a=null):a.innerHTML=i,c=setTimeout(function(){m&&!m.initialized&&m.trigger("Error",new n.RuntimeError(n.RuntimeError.NOT_INIT_ERR))},5e3)},destroy:function(e){return function(){s(m.uid),e.call(m),clearTimeout(c),u=c=e=m=null}}(this.destroy)},d)}var l="flash",d={};return o.addConstructor(l,c),d}),n("moxie/runtime/flash/file/Blob",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(e,t){var i={slice:function(e,i,n,r){var o=this.getRuntime();return 0>i?i=Math.max(e.size+i,0):i>0&&(i=Math.min(i,e.size)),0>n?n=Math.max(e.size+n,0):n>0&&(n=Math.min(n,e.size)),e=o.shimExec.call(this,"Blob","slice",i,n,r||""),e&&(e=new t(o.uid,e)),e}};return e.Blob=i}),n("moxie/runtime/flash/file/FileInput",["moxie/runtime/flash/Runtime","moxie/file/File","moxie/core/utils/Dom","moxie/core/utils/Basic"],function(e,t,i,n){var r={init:function(e){var r=this,o=this.getRuntime(),a=i.get(e.browse_button);a&&(a.setAttribute("tabindex",-1),a=null),this.bind("Change",function(){var e=o.shimExec.call(r,"FileInput","getFiles");r.files=[],n.each(e,function(e){r.files.push(new t(o.uid,e))})},999),this.getRuntime().shimExec.call(this,"FileInput","init",{accept:e.accept,multiple:e.multiple}),this.trigger("ready")}};return e.FileInput=r}),n("moxie/runtime/flash/file/FileReader",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(e,t){function i(e,i){switch(i){case"readAsText":return t.atob(e,"utf8");case"readAsBinaryString":return t.atob(e);case"readAsDataURL":return e}return null}var n={read:function(e,t){var n=this;return n.result="","readAsDataURL"===e&&(n.result="data:"+(t.type||"")+";base64,"),n.bind("Progress",function(t,r){r&&(n.result+=i(r,e))},999),n.getRuntime().shimExec.call(this,"FileReader","readAsBase64",t.uid)}};return e.FileReader=n}),n("moxie/runtime/flash/file/FileReaderSync",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(e,t){function i(e,i){switch(i){case"readAsText":return t.atob(e,"utf8");case"readAsBinaryString":return t.atob(e);case"readAsDataURL":return e}return null}var n={read:function(e,t){var n,r=this.getRuntime();return(n=r.shimExec.call(this,"FileReaderSync","readAsBase64",t.uid))?("readAsDataURL"===e&&(n="data:"+(t.type||"")+";base64,"+n),i(n,e,t.type)):null}};return e.FileReaderSync=n}),n("moxie/runtime/flash/runtime/Transporter",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(e,t){var i={getAsBlob:function(e){var i=this.getRuntime(),n=i.shimExec.call(this,"Transporter","getAsBlob",e);return n?new t(i.uid,n):null}};return e.Transporter=i}),n("moxie/runtime/flash/xhr/XMLHttpRequest",["moxie/runtime/flash/Runtime","moxie/core/utils/Basic","moxie/file/Blob","moxie/file/File","moxie/file/FileReaderSync","moxie/runtime/flash/file/FileReaderSync","moxie/xhr/FormData","moxie/runtime/Transporter","moxie/runtime/flash/runtime/Transporter"],function(e,t,i,n,r,o,a,s){var u={send:function(e,n){function r(){e.transport=l.mode,l.shimExec.call(c,"XMLHttpRequest","send",e,n)}function o(e,t){l.shimExec.call(c,"XMLHttpRequest","appendBlob",e,t.uid),n=null,r()}function u(e,t){var i=new s;i.bind("TransportingComplete",function(){t(this.result)}),i.transport(e.getSource(),e.type,{ruid:l.uid})}var c=this,l=c.getRuntime();if(t.isEmptyObj(e.headers)||t.each(e.headers,function(e,t){l.shimExec.call(c,"XMLHttpRequest","setRequestHeader",t,e.toString())}),n instanceof a){var d;if(n.each(function(e,t){e instanceof i?d=t:l.shimExec.call(c,"XMLHttpRequest","append",t,e)}),n.hasBlob()){var m=n.getBlob();m.isDetached()?u(m,function(e){m.destroy(),o(d,e)}):o(d,m)}else n=null,r()}else n instanceof i?n.isDetached()?u(n,function(e){n.destroy(),n=e.uid,r()}):(n=n.uid,r()):r()},getResponse:function(e){var i,o,a=this.getRuntime();if(o=a.shimExec.call(this,"XMLHttpRequest","getResponseAsBlob")){if(o=new n(a.uid,o),"blob"===e)return o;try{if(i=new r,~t.inArray(e,["","text"]))return i.readAsText(o);if("json"===e&&window.JSON)return JSON.parse(i.readAsText(o))}finally{o.destroy()}}return null},abort:function(){var e=this.getRuntime();e.shimExec.call(this,"XMLHttpRequest","abort"),this.dispatchEvent("readystatechange"),this.dispatchEvent("abort")}};return e.XMLHttpRequest=u}),n("moxie/runtime/flash/image/Image",["moxie/runtime/flash/Runtime","moxie/core/utils/Basic","moxie/runtime/Transporter","moxie/file/Blob","moxie/file/FileReaderSync"],function(e,t,i,n,r){var o={loadFromBlob:function(e){function t(e){r.shimExec.call(n,"Image","loadFromBlob",e.uid),n=r=null}var n=this,r=n.getRuntime();if(e.isDetached()){var o=new i;o.bind("TransportingComplete",function(){t(o.result.getSource())}),o.transport(e.getSource(),e.type,{ruid:r.uid})}else t(e.getSource())},loadFromImage:function(e){var t=this.getRuntime();return t.shimExec.call(this,"Image","loadFromImage",e.uid)},getInfo:function(){var e=this.getRuntime(),t=e.shimExec.call(this,"Image","getInfo");return t.meta&&t.meta.thumb&&t.meta.thumb.data&&!(e.meta.thumb.data instanceof n)&&(t.meta.thumb.data=new n(e.uid,t.meta.thumb.data)),t},getAsBlob:function(e,t){var i=this.getRuntime(),r=i.shimExec.call(this,"Image","getAsBlob",e,t);return r?new n(i.uid,r):null},getAsDataURL:function(){var e,t=this.getRuntime(),i=t.Image.getAsBlob.apply(this,arguments);return i?(e=new r,e.readAsDataURL(i)):null}};return e.Image=o}),n("moxie/runtime/silverlight/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(e,t,i,n,o){function a(e){var t,i,n,r,o,a=!1,s=null,u=0;try{try{s=new ActiveXObject("AgControl.AgControl"),s.IsVersionSupported(e)&&(a=!0),s=null}catch(c){var l=navigator.plugins["Silverlight Plug-In"];if(l){for(t=l.description,"1.0.30226.2"===t&&(t="2.0.30226.2"),i=t.split(".");i.length>3;)i.pop();for(;i.length<4;)i.push(0);for(n=e.split(".");n.length>4;)n.pop();do r=parseInt(n[u],10),o=parseInt(i[u],10),u++;while(u<n.length&&r===o);o>=r&&!isNaN(r)&&(a=!0)}}}catch(d){a=!1}return a}function s(s){var l,d=this;s=e.extend({xap_url:t.xap_url},s),o.call(this,s,u,{access_binary:o.capTrue,access_image_binary:o.capTrue,display_media:o.capTest(r("moxie/image/Image")),do_cors:o.capTrue,drag_and_drop:!1,report_upload_progress:o.capTrue,resize_image:o.capTrue,return_response_headers:function(e){return e&&"client"===d.mode},return_response_type:function(e){return"json"!==e?!0:!!window.JSON},return_status_code:function(t){return"client"===d.mode||!e.arrayDiff(t,[200,404])},select_file:o.capTrue,select_multiple:o.capTrue,send_binary_string:o.capTrue,send_browser_cookies:function(e){return e&&"browser"===d.mode},send_custom_headers:function(e){return e&&"client"===d.mode},send_multipart:o.capTrue,slice_blob:o.capTrue,stream_upload:!0,summon_file_dialog:!1,upload_filesize:o.capTrue,use_http_method:function(t){return"client"===d.mode||!e.arrayDiff(t,["GET","POST"])}},{return_response_headers:function(e){return e?"client":"browser"},return_status_code:function(t){return e.arrayDiff(t,[200,404])?"client":["client","browser"]},send_browser_cookies:function(e){return e?"browser":"client"},send_custom_headers:function(e){return e?"client":"browser"},use_http_method:function(t){return e.arrayDiff(t,["GET","POST"])?"client":["client","browser"]}}),a("2.0.31005.0")&&"Opera"!==t.browser||(this.mode=!1),e.extend(this,{getShim:function(){return i.get(this.uid).content.Moxie},shimExec:function(e,t){var i=[].slice.call(arguments,2);return d.getShim().exec(this.uid,e,t,i)},init:function(){var e;e=this.getShimContainer(),e.innerHTML='<object id="'+this.uid+'" data="data:application/x-silverlight," type="application/x-silverlight-2" width="100%" height="100%" style="outline:none;">'+'<param name="source" value="'+s.xap_url+'"/>'+'<param name="background" value="Transparent"/>'+'<param name="windowless" value="true"/>'+'<param name="enablehtmlaccess" value="true"/>'+'<param name="initParams" value="uid='+this.uid+",target="+o.getGlobalEventTarget()+'"/>'+"</object>",l=setTimeout(function(){d&&!d.initialized&&d.trigger("Error",new n.RuntimeError(n.RuntimeError.NOT_INIT_ERR))},"Windows"!==t.OS?1e4:5e3)},destroy:function(e){return function(){e.call(d),clearTimeout(l),s=l=e=d=null}}(this.destroy)},c)}var u="silverlight",c={};return o.addConstructor(u,s),c}),n("moxie/runtime/silverlight/file/Blob",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/Blob"],function(e,t,i){return e.Blob=t.extend({},i)}),n("moxie/runtime/silverlight/file/FileInput",["moxie/runtime/silverlight/Runtime","moxie/file/File","moxie/core/utils/Dom","moxie/core/utils/Basic"],function(e,t,i,n){function r(e){for(var t="",i=0;i<e.length;i++)t+=(""!==t?"|":"")+e[i].title+" | *."+e[i].extensions.replace(/,/g,";*.");return t}var o={init:function(e){var o=this,a=this.getRuntime(),s=i.get(e.browse_button);s&&(s.setAttribute("tabindex",-1),s=null),this.bind("Change",function(){var e=a.shimExec.call(o,"FileInput","getFiles");
o.files=[],n.each(e,function(e){o.files.push(new t(a.uid,e))})},999),a.shimExec.call(this,"FileInput","init",r(e.accept),e.multiple),this.trigger("ready")},setOption:function(e,t){"accept"==e&&(t=r(t)),this.getRuntime().shimExec.call(this,"FileInput","setOption",e,t)}};return e.FileInput=o}),n("moxie/runtime/silverlight/file/FileDrop",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Dom","moxie/core/utils/Events"],function(e,t,i){var n={init:function(){var e,n=this,r=n.getRuntime();return e=r.getShimContainer(),i.addEvent(e,"dragover",function(e){e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="copy"},n.uid),i.addEvent(e,"dragenter",function(e){e.preventDefault();var i=t.get(r.uid).dragEnter(e);i&&e.stopPropagation()},n.uid),i.addEvent(e,"drop",function(e){e.preventDefault();var i=t.get(r.uid).dragDrop(e);i&&e.stopPropagation()},n.uid),r.shimExec.call(this,"FileDrop","init")}};return e.FileDrop=n}),n("moxie/runtime/silverlight/file/FileReader",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReader"],function(e,t,i){return e.FileReader=t.extend({},i)}),n("moxie/runtime/silverlight/file/FileReaderSync",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReaderSync"],function(e,t,i){return e.FileReaderSync=t.extend({},i)}),n("moxie/runtime/silverlight/runtime/Transporter",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/runtime/Transporter"],function(e,t,i){return e.Transporter=t.extend({},i)}),n("moxie/runtime/silverlight/xhr/XMLHttpRequest",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/xhr/XMLHttpRequest","moxie/runtime/silverlight/file/FileReaderSync","moxie/runtime/silverlight/runtime/Transporter"],function(e,t,i){return e.XMLHttpRequest=t.extend({},i)}),n("moxie/runtime/silverlight/image/Image",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/file/Blob","moxie/runtime/flash/image/Image"],function(e,t,i,n){return e.Image=t.extend({},n,{getInfo:function(){var e=this.getRuntime(),n=["tiff","exif","gps","thumb"],r={meta:{}},o=e.shimExec.call(this,"Image","getInfo");return o.meta&&(t.each(n,function(e){var t,i,n,a,s=o.meta[e];if(s&&s.keys)for(r.meta[e]={},i=0,n=s.keys.length;n>i;i++)t=s.keys[i],a=s[t],a&&(/^(\d|[1-9]\d+)$/.test(a)?a=parseInt(a,10):/^\d*\.\d+$/.test(a)&&(a=parseFloat(a)),r.meta[e][t]=a)}),r.meta&&r.meta.thumb&&r.meta.thumb.data&&!(e.meta.thumb.data instanceof i)&&(r.meta.thumb.data=new i(e.uid,r.meta.thumb.data))),r.width=parseInt(o.width,10),r.height=parseInt(o.height,10),r.size=parseInt(o.size,10),r.type=o.type,r.name=o.name,r},resize:function(e,t,i){this.getRuntime().shimExec.call(this,"Image","resize",e.x,e.y,e.width,e.height,t,i.preserveHeaders,i.resample)}})}),n("moxie/runtime/html4/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(e,t,i,n){function o(t){var o=this,u=i.capTest,c=i.capTrue;i.call(this,t,a,{access_binary:u(window.FileReader||window.File&&File.getAsDataURL),access_image_binary:!1,display_media:u((n.can("create_canvas")||n.can("use_data_uri_over32kb"))&&r("moxie/image/Image")),do_cors:!1,drag_and_drop:!1,filter_by_extension:u(function(){return!("Chrome"===n.browser&&n.verComp(n.version,28,"<")||"IE"===n.browser&&n.verComp(n.version,10,"<")||"Safari"===n.browser&&n.verComp(n.version,7,"<")||"Firefox"===n.browser&&n.verComp(n.version,37,"<"))}()),resize_image:function(){return s.Image&&o.can("access_binary")&&n.can("create_canvas")},report_upload_progress:!1,return_response_headers:!1,return_response_type:function(t){return"json"===t&&window.JSON?!0:!!~e.inArray(t,["text","document",""])},return_status_code:function(t){return!e.arrayDiff(t,[200,404])},select_file:function(){return n.can("use_fileinput")},select_multiple:!1,send_binary_string:!1,send_custom_headers:!1,send_multipart:!0,slice_blob:!1,stream_upload:function(){return o.can("select_file")},summon_file_dialog:function(){return o.can("select_file")&&!("Firefox"===n.browser&&n.verComp(n.version,4,"<")||"Opera"===n.browser&&n.verComp(n.version,12,"<")||"IE"===n.browser&&n.verComp(n.version,10,"<"))},upload_filesize:c,use_http_method:function(t){return!e.arrayDiff(t,["GET","POST"])}}),e.extend(this,{init:function(){this.trigger("Init")},destroy:function(e){return function(){e.call(o),e=o=null}}(this.destroy)}),e.extend(this.getShim(),s)}var a="html4",s={};return i.addConstructor(a,o),s}),n("moxie/runtime/html4/file/FileInput",["moxie/runtime/html4/Runtime","moxie/file/File","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime","moxie/core/utils/Env"],function(e,t,i,n,r,o,a){function s(){function e(){var o,c,d,m,h,f,p=this,g=p.getRuntime();f=i.guid("uid_"),o=g.getShimContainer(),s&&(d=n.get(s+"_form"),d&&(i.extend(d.style,{top:"100%"}),d.firstChild.setAttribute("tabindex",-1))),m=document.createElement("form"),m.setAttribute("id",f+"_form"),m.setAttribute("method","post"),m.setAttribute("enctype","multipart/form-data"),m.setAttribute("encoding","multipart/form-data"),i.extend(m.style,{overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",height:"100%"}),h=document.createElement("input"),h.setAttribute("id",f),h.setAttribute("type","file"),h.setAttribute("accept",l.join(",")),g.can("summon_file_dialog")&&h.setAttribute("tabindex",-1),i.extend(h.style,{fontSize:"999px",opacity:0}),m.appendChild(h),o.appendChild(m),i.extend(h.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"}),"IE"===a.browser&&a.verComp(a.version,10,"<")&&i.extend(h.style,{filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"}),h.onchange=function(){var i;this.value&&(i=this.files?this.files[0]:{name:this.value},i=new t(g.uid,i),this.onchange=function(){},e.call(p),p.files=[i],h.setAttribute("id",i.uid),m.setAttribute("id",i.uid+"_form"),p.trigger("change"),h=m=null)},g.can("summon_file_dialog")&&(c=n.get(u.browse_button),r.removeEvent(c,"click",p.uid),r.addEvent(c,"click",function(e){h&&!h.disabled&&h.click(),e.preventDefault()},p.uid)),s=f,o=d=c=null}var s,u,c,l=[];i.extend(this,{init:function(t){var i,a=this,s=a.getRuntime();u=t,l=o.extList2mimes(t.accept,s.can("filter_by_extension")),i=s.getShimContainer(),function(){var e,o,l;e=n.get(t.browse_button),c=n.getStyle(e,"z-index")||"auto",s.can("summon_file_dialog")?("static"===n.getStyle(e,"position")&&(e.style.position="relative"),a.bind("Refresh",function(){o=parseInt(c,10)||1,n.get(u.browse_button).style.zIndex=o,this.getRuntime().getShimContainer().style.zIndex=o-1})):e.setAttribute("tabindex",-1),l=s.can("summon_file_dialog")?e:i,r.addEvent(l,"mouseover",function(){a.trigger("mouseenter")},a.uid),r.addEvent(l,"mouseout",function(){a.trigger("mouseleave")},a.uid),r.addEvent(l,"mousedown",function(){a.trigger("mousedown")},a.uid),r.addEvent(n.get(t.container),"mouseup",function(){a.trigger("mouseup")},a.uid),e=null}(),e.call(this),i=null,a.trigger({type:"ready",async:!0})},setOption:function(e,t){var i,r=this.getRuntime();"accept"==e&&(l=t.mimes||o.extList2mimes(t,r.can("filter_by_extension"))),i=n.get(s),i&&i.setAttribute("accept",l.join(","))},disable:function(e){var t;(t=n.get(s))&&(t.disabled=!!e)},destroy:function(){var e=this.getRuntime(),t=e.getShim(),i=e.getShimContainer(),o=u&&n.get(u.container),a=u&&n.get(u.browse_button);o&&r.removeAllEvents(o,this.uid),a&&(r.removeAllEvents(a,this.uid),a.style.zIndex=c),i&&(r.removeAllEvents(i,this.uid),i.innerHTML=""),t.removeInstance(this.uid),s=l=u=i=o=a=t=null}})}return e.FileInput=s}),n("moxie/runtime/html4/file/FileReader",["moxie/runtime/html4/Runtime","moxie/runtime/html5/file/FileReader"],function(e,t){return e.FileReader=t}),n("moxie/runtime/html4/xhr/XMLHttpRequest",["moxie/runtime/html4/Runtime","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Url","moxie/core/Exceptions","moxie/core/utils/Events","moxie/file/Blob","moxie/xhr/FormData"],function(e,t,i,n,r,o,a,s){function u(){function e(e){var t,n,r,a,s=this,u=!1;if(l){if(t=l.id.replace(/_iframe$/,""),n=i.get(t+"_form")){for(r=n.getElementsByTagName("input"),a=r.length;a--;)switch(r[a].getAttribute("type")){case"hidden":r[a].parentNode.removeChild(r[a]);break;case"file":u=!0}r=[],u||n.parentNode.removeChild(n),n=null}setTimeout(function(){o.removeEvent(l,"load",s.uid),l.parentNode&&l.parentNode.removeChild(l);var t=s.getRuntime().getShimContainer();t.children.length||t.parentNode.removeChild(t),t=l=null,e()},1)}}var u,c,l;t.extend(this,{send:function(d,m){function h(){var i=w.getShimContainer()||document.body,r=document.createElement("div");r.innerHTML='<iframe id="'+f+'_iframe" name="'+f+'_iframe" src="javascript:&quot;&quot;" style="display:none"></iframe>',l=r.firstChild,i.appendChild(l),o.addEvent(l,"load",function(){var i;try{i=l.contentWindow.document||l.contentDocument||window.frames[l.id].document,/^4(0[0-9]|1[0-7]|2[2346])\s/.test(i.title)?u=i.title.replace(/^(\d+).*$/,"$1"):(u=200,c=t.trim(i.body.innerHTML),v.trigger({type:"progress",loaded:c.length,total:c.length}),x&&v.trigger({type:"uploadprogress",loaded:x.size||1025,total:x.size||1025}))}catch(r){if(!n.hasSameOrigin(d.url))return e.call(v,function(){v.trigger("error")}),void 0;u=404}e.call(v,function(){v.trigger("load")})},v.uid)}var f,p,g,x,v=this,w=v.getRuntime();if(u=c=null,m instanceof s&&m.hasBlob()){if(x=m.getBlob(),f=x.uid,g=i.get(f),p=i.get(f+"_form"),!p)throw new r.DOMException(r.DOMException.NOT_FOUND_ERR)}else f=t.guid("uid_"),p=document.createElement("form"),p.setAttribute("id",f+"_form"),p.setAttribute("method",d.method),p.setAttribute("enctype","multipart/form-data"),p.setAttribute("encoding","multipart/form-data"),w.getShimContainer().appendChild(p);p.setAttribute("target",f+"_iframe"),m instanceof s&&m.each(function(e,i){if(e instanceof a)g&&g.setAttribute("name",i);else{var n=document.createElement("input");t.extend(n,{type:"hidden",name:i,value:e}),g?p.insertBefore(n,g):p.appendChild(n)}}),p.setAttribute("action",d.url),h(),p.submit(),v.trigger("loadstart")},getStatus:function(){return u},getResponse:function(e){if("json"===e&&"string"===t.typeOf(c)&&window.JSON)try{return JSON.parse(c.replace(/^\s*<pre[^>]*>/,"").replace(/<\/pre>\s*$/,""))}catch(i){return null}return c},abort:function(){var t=this;l&&l.contentWindow&&(l.contentWindow.stop?l.contentWindow.stop():l.contentWindow.document.execCommand?l.contentWindow.document.execCommand("Stop"):l.src="about:blank"),e.call(this,function(){t.dispatchEvent("abort")})},destroy:function(){this.getRuntime().getShim().removeInstance(this.uid)}})}return e.XMLHttpRequest=u}),n("moxie/runtime/html4/image/Image",["moxie/runtime/html4/Runtime","moxie/runtime/html5/image/Image"],function(e,t){return e.Image=t}),a(["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/core/utils/Env","moxie/core/Exceptions","moxie/core/utils/Dom","moxie/core/EventTarget","moxie/runtime/Runtime","moxie/runtime/RuntimeClient","moxie/file/Blob","moxie/core/I18n","moxie/core/utils/Mime","moxie/file/FileInput","moxie/file/File","moxie/file/FileDrop","moxie/file/FileReader","moxie/core/utils/Url","moxie/runtime/RuntimeTarget","moxie/xhr/FormData","moxie/xhr/XMLHttpRequest","moxie/image/Image","moxie/core/utils/Events","moxie/runtime/html5/image/ResizerCanvas"])}(this)});
/**
 * Plupload - multi-runtime File Uploader
 * v2.3.6
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 *
 * Date: 2017-11-03
 */
!function(e,t){var i=function(){var e={};return t.apply(e,arguments),e.plupload};"function"==typeof define&&define.amd?define("plupload",["./moxie"],i):"object"==typeof module&&module.exports?module.exports=i(require("./moxie")):e.plupload=i(e.moxie)}(this||window,function(e){!function(e,t,i){function n(e){function t(e,t,i){var r={chunks:"slice_blob",jpgresize:"send_binary_string",pngresize:"send_binary_string",progress:"report_upload_progress",multi_selection:"select_multiple",dragdrop:"drag_and_drop",drop_element:"drag_and_drop",headers:"send_custom_headers",urlstream_upload:"send_binary_string",canSendBinary:"send_binary",triggerDialog:"summon_file_dialog"};r[e]?n[r[e]]=t:i||(n[e]=t)}var i=e.required_features,n={};return"string"==typeof i?l.each(i.split(/\s*,\s*/),function(e){t(e,!0)}):"object"==typeof i?l.each(i,function(e,i){t(i,e)}):i===!0&&(e.chunk_size&&e.chunk_size>0&&(n.slice_blob=!0),l.isEmptyObj(e.resize)&&e.multipart!==!1||(n.send_binary_string=!0),e.http_method&&(n.use_http_method=e.http_method),l.each(e,function(e,i){t(i,!!e,!0)})),n}var r=window.setTimeout,s={},a=t.core.utils,o=t.runtime.Runtime,l={VERSION:"2.3.6",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,FILE_DUPLICATE_ERROR:-602,IMAGE_FORMAT_ERROR:-700,MEMORY_ERROR:-701,IMAGE_DIMENSIONS_ERROR:-702,moxie:t,mimeTypes:a.Mime.mimes,ua:a.Env,typeOf:a.Basic.typeOf,extend:a.Basic.extend,guid:a.Basic.guid,getAll:function(e){var t,i=[];"array"!==l.typeOf(e)&&(e=[e]);for(var n=e.length;n--;)t=l.get(e[n]),t&&i.push(t);return i.length?i:null},get:a.Dom.get,each:a.Basic.each,getPos:a.Dom.getPos,getSize:a.Dom.getSize,xmlEncode:function(e){var t={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},i=/[<>&\"\']/g;return e?(""+e).replace(i,function(e){return t[e]?"&"+t[e]+";":e}):e},toArray:a.Basic.toArray,inArray:a.Basic.inArray,inSeries:a.Basic.inSeries,addI18n:t.core.I18n.addI18n,translate:t.core.I18n.translate,sprintf:a.Basic.sprintf,isEmptyObj:a.Basic.isEmptyObj,hasClass:a.Dom.hasClass,addClass:a.Dom.addClass,removeClass:a.Dom.removeClass,getStyle:a.Dom.getStyle,addEvent:a.Events.addEvent,removeEvent:a.Events.removeEvent,removeAllEvents:a.Events.removeAllEvents,cleanName:function(e){var t,i;for(i=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"],t=0;t<i.length;t+=2)e=e.replace(i[t],i[t+1]);return e=e.replace(/\s+/g,"_"),e=e.replace(/[^a-z0-9_\-\.]+/gi,"")},buildUrl:function(e,t){var i="";return l.each(t,function(e,t){i+=(i?"&":"")+encodeURIComponent(t)+"="+encodeURIComponent(e)}),i&&(e+=(e.indexOf("?")>0?"&":"?")+i),e},formatSize:function(e){function t(e,t){return Math.round(e*Math.pow(10,t))/Math.pow(10,t)}if(e===i||/\D/.test(e))return l.translate("N/A");var n=Math.pow(1024,4);return e>n?t(e/n,1)+" "+l.translate("tb"):e>(n/=1024)?t(e/n,1)+" "+l.translate("gb"):e>(n/=1024)?t(e/n,1)+" "+l.translate("mb"):e>1024?Math.round(e/1024)+" "+l.translate("kb"):e+" "+l.translate("b")},parseSize:a.Basic.parseSizeStr,predictRuntime:function(e,t){var i,n;return i=new l.Uploader(e),n=o.thatCan(i.getOption().required_features,t||e.runtimes),i.destroy(),n},addFileFilter:function(e,t){s[e]=t}};l.addFileFilter("mime_types",function(e,t,i){e.length&&!e.regexp.test(t.name)?(this.trigger("Error",{code:l.FILE_EXTENSION_ERROR,message:l.translate("File extension error."),file:t}),i(!1)):i(!0)}),l.addFileFilter("max_file_size",function(e,t,i){var n;e=l.parseSize(e),t.size!==n&&e&&t.size>e?(this.trigger("Error",{code:l.FILE_SIZE_ERROR,message:l.translate("File size error."),file:t}),i(!1)):i(!0)}),l.addFileFilter("prevent_duplicates",function(e,t,i){if(e)for(var n=this.files.length;n--;)if(t.name===this.files[n].name&&t.size===this.files[n].size)return this.trigger("Error",{code:l.FILE_DUPLICATE_ERROR,message:l.translate("Duplicate file error."),file:t}),i(!1),void 0;i(!0)}),l.addFileFilter("prevent_empty",function(e,t,n){e&&!t.size&&t.size!==i?(this.trigger("Error",{code:l.FILE_SIZE_ERROR,message:l.translate("File size error."),file:t}),n(!1)):n(!0)}),l.Uploader=function(e){function a(){var e,t,i=0;if(this.state==l.STARTED){for(t=0;t<D.length;t++)e||D[t].status!=l.QUEUED?i++:(e=D[t],this.trigger("BeforeUpload",e)&&(e.status=l.UPLOADING,this.trigger("UploadFile",e)));i==D.length&&(this.state!==l.STOPPED&&(this.state=l.STOPPED,this.trigger("StateChanged")),this.trigger("UploadComplete",D))}}function u(e){e.percent=e.size>0?Math.ceil(100*(e.loaded/e.size)):100,d()}function d(){var e,t,n,r=0;for(I.reset(),e=0;e<D.length;e++)t=D[e],t.size!==i?(I.size+=t.origSize,n=t.loaded*t.origSize/t.size,(!t.completeTimestamp||t.completeTimestamp>S)&&(r+=n),I.loaded+=n):I.size=i,t.status==l.DONE?I.uploaded++:t.status==l.FAILED?I.failed++:I.queued++;I.size===i?I.percent=D.length>0?Math.ceil(100*(I.uploaded/D.length)):0:(I.bytesPerSec=Math.ceil(r/((+new Date-S||1)/1e3)),I.percent=I.size>0?Math.ceil(100*(I.loaded/I.size)):0)}function c(){var e=F[0]||P[0];return e?e.getRuntime().uid:!1}function f(){this.bind("FilesAdded FilesRemoved",function(e){e.trigger("QueueChanged"),e.refresh()}),this.bind("CancelUpload",b),this.bind("BeforeUpload",m),this.bind("UploadFile",_),this.bind("UploadProgress",E),this.bind("StateChanged",v),this.bind("QueueChanged",d),this.bind("Error",R),this.bind("FileUploaded",y),this.bind("Destroy",z)}function p(e,i){var n=this,r=0,s=[],a={runtime_order:e.runtimes,required_caps:e.required_features,preferred_caps:x,swf_url:e.flash_swf_url,xap_url:e.silverlight_xap_url};l.each(e.runtimes.split(/\s*,\s*/),function(t){e[t]&&(a[t]=e[t])}),e.browse_button&&l.each(e.browse_button,function(i){s.push(function(s){var u=new t.file.FileInput(l.extend({},a,{accept:e.filters.mime_types,name:e.file_data_name,multiple:e.multi_selection,container:e.container,browse_button:i}));u.onready=function(){var e=o.getInfo(this.ruid);l.extend(n.features,{chunks:e.can("slice_blob"),multipart:e.can("send_multipart"),multi_selection:e.can("select_multiple")}),r++,F.push(this),s()},u.onchange=function(){n.addFile(this.files)},u.bind("mouseenter mouseleave mousedown mouseup",function(t){U||(e.browse_button_hover&&("mouseenter"===t.type?l.addClass(i,e.browse_button_hover):"mouseleave"===t.type&&l.removeClass(i,e.browse_button_hover)),e.browse_button_active&&("mousedown"===t.type?l.addClass(i,e.browse_button_active):"mouseup"===t.type&&l.removeClass(i,e.browse_button_active)))}),u.bind("mousedown",function(){n.trigger("Browse")}),u.bind("error runtimeerror",function(){u=null,s()}),u.init()})}),e.drop_element&&l.each(e.drop_element,function(e){s.push(function(i){var s=new t.file.FileDrop(l.extend({},a,{drop_zone:e}));s.onready=function(){var e=o.getInfo(this.ruid);l.extend(n.features,{chunks:e.can("slice_blob"),multipart:e.can("send_multipart"),dragdrop:e.can("drag_and_drop")}),r++,P.push(this),i()},s.ondrop=function(){n.addFile(this.files)},s.bind("error runtimeerror",function(){s=null,i()}),s.init()})}),l.inSeries(s,function(){"function"==typeof i&&i(r)})}function g(e,n,r,s){var a=new t.image.Image;try{a.onload=function(){n.width>this.width&&n.height>this.height&&n.quality===i&&n.preserve_headers&&!n.crop?(this.destroy(),s(e)):a.downsize(n.width,n.height,n.crop,n.preserve_headers)},a.onresize=function(){var t=this.getAsBlob(e.type,n.quality);this.destroy(),s(t)},a.bind("error runtimeerror",function(){this.destroy(),s(e)}),a.load(e,r)}catch(o){s(e)}}function h(e,i,r){function s(e,i,n){var r=O[e];switch(e){case"max_file_size":"max_file_size"===e&&(O.max_file_size=O.filters.max_file_size=i);break;case"chunk_size":(i=l.parseSize(i))&&(O[e]=i,O.send_file_name=!0);break;case"multipart":O[e]=i,i||(O.send_file_name=!0);break;case"http_method":O[e]="PUT"===i.toUpperCase()?"PUT":"POST";break;case"unique_names":O[e]=i,i&&(O.send_file_name=!0);break;case"filters":"array"===l.typeOf(i)&&(i={mime_types:i}),n?l.extend(O.filters,i):O.filters=i,i.mime_types&&("string"===l.typeOf(i.mime_types)&&(i.mime_types=t.core.utils.Mime.mimes2extList(i.mime_types)),i.mime_types.regexp=function(e){var t=[];return l.each(e,function(e){l.each(e.extensions.split(/,/),function(e){/^\s*\*\s*$/.test(e)?t.push("\\.*"):t.push("\\."+e.replace(new RegExp("["+"/^$.*+?|()[]{}\\".replace(/./g,"\\$&")+"]","g"),"\\$&"))})}),new RegExp("("+t.join("|")+")$","i")}(i.mime_types),O.filters.mime_types=i.mime_types);break;case"resize":O.resize=i?l.extend({preserve_headers:!0,crop:!1},i):!1;break;case"prevent_duplicates":O.prevent_duplicates=O.filters.prevent_duplicates=!!i;break;case"container":case"browse_button":case"drop_element":i="container"===e?l.get(i):l.getAll(i);case"runtimes":case"multi_selection":case"flash_swf_url":case"silverlight_xap_url":O[e]=i,n||(u=!0);break;default:O[e]=i}n||a.trigger("OptionChanged",e,i,r)}var a=this,u=!1;"object"==typeof e?l.each(e,function(e,t){s(t,e,r)}):s(e,i,r),r?(O.required_features=n(l.extend({},O)),x=n(l.extend({},O,{required_features:!0}))):u&&(a.trigger("Destroy"),p.call(a,O,function(e){e?(a.runtime=o.getInfo(c()).type,a.trigger("Init",{runtime:a.runtime}),a.trigger("PostInit")):a.trigger("Error",{code:l.INIT_ERROR,message:l.translate("Init error.")})}))}function m(e,t){if(e.settings.unique_names){var i=t.name.match(/\.([^.]+)$/),n="part";i&&(n=i[1]),t.target_name=t.id+"."+n}}function _(e,i){function n(){c-->0?r(s,1e3):(i.loaded=p,e.trigger("Error",{code:l.HTTP_ERROR,message:l.translate("HTTP Error."),file:i,response:T.responseText,status:T.status,responseHeaders:T.getAllResponseHeaders()}))}function s(){var t,n,r={};i.status===l.UPLOADING&&e.state!==l.STOPPED&&(e.settings.send_file_name&&(r.name=i.target_name||i.name),d&&f.chunks&&o.size>d?(n=Math.min(d,o.size-p),t=o.slice(p,p+n)):(n=o.size,t=o),d&&f.chunks&&(e.settings.send_chunk_number?(r.chunk=Math.ceil(p/d),r.chunks=Math.ceil(o.size/d)):(r.offset=p,r.total=o.size)),e.trigger("BeforeChunkUpload",i,r,t,p)&&a(r,t,n))}function a(a,d,g){var m;T=new t.xhr.XMLHttpRequest,T.upload&&(T.upload.onprogress=function(t){i.loaded=Math.min(i.size,p+t.loaded),e.trigger("UploadProgress",i)}),T.onload=function(){return T.status<200||T.status>=400?(n(),void 0):(c=e.settings.max_retries,g<o.size?(d.destroy(),p+=g,i.loaded=Math.min(p,o.size),e.trigger("ChunkUploaded",i,{offset:i.loaded,total:o.size,response:T.responseText,status:T.status,responseHeaders:T.getAllResponseHeaders()}),"Android Browser"===l.ua.browser&&e.trigger("UploadProgress",i)):i.loaded=i.size,d=m=null,!p||p>=o.size?(i.size!=i.origSize&&(o.destroy(),o=null),e.trigger("UploadProgress",i),i.status=l.DONE,i.completeTimestamp=+new Date,e.trigger("FileUploaded",i,{response:T.responseText,status:T.status,responseHeaders:T.getAllResponseHeaders()})):r(s,1),void 0)},T.onerror=function(){n()},T.onloadend=function(){this.destroy()},e.settings.multipart&&f.multipart?(T.open(e.settings.http_method,u,!0),l.each(e.settings.headers,function(e,t){T.setRequestHeader(t,e)}),m=new t.xhr.FormData,l.each(l.extend(a,e.settings.multipart_params),function(e,t){m.append(t,e)}),m.append(e.settings.file_data_name,d),T.send(m,h)):(u=l.buildUrl(e.settings.url,l.extend(a,e.settings.multipart_params)),T.open(e.settings.http_method,u,!0),l.each(e.settings.headers,function(e,t){T.setRequestHeader(t,e)}),T.hasRequestHeader("Content-Type")||T.setRequestHeader("Content-Type","application/octet-stream"),T.send(d,h))}var o,u=e.settings.url,d=e.settings.chunk_size,c=e.settings.max_retries,f=e.features,p=0,h={runtime_order:e.settings.runtimes,required_caps:e.settings.required_features,preferred_caps:x,swf_url:e.settings.flash_swf_url,xap_url:e.settings.silverlight_xap_url};i.loaded&&(p=i.loaded=d?d*Math.floor(i.loaded/d):0),o=i.getSource(),l.isEmptyObj(e.settings.resize)||-1===l.inArray(o.type,["image/jpeg","image/png"])?s():g(o,e.settings.resize,h,function(e){o=e,i.size=e.size,s()})}function E(e,t){u(t)}function v(e){if(e.state==l.STARTED)S=+new Date;else if(e.state==l.STOPPED)for(var t=e.files.length-1;t>=0;t--)e.files[t].status==l.UPLOADING&&(e.files[t].status=l.QUEUED,d())}function b(){T&&T.abort()}function y(e){d(),r(function(){a.call(e)},1)}function R(e,t){t.code===l.INIT_ERROR?e.destroy():t.code===l.HTTP_ERROR&&(t.file.status=l.FAILED,t.file.completeTimestamp=+new Date,u(t.file),e.state==l.STARTED&&(e.trigger("CancelUpload"),r(function(){a.call(e)},1)))}function z(e){e.stop(),l.each(D,function(e){e.destroy()}),D=[],F.length&&(l.each(F,function(e){e.destroy()}),F=[]),P.length&&(l.each(P,function(e){e.destroy()}),P=[]),x={},U=!1,S=T=null,I.reset()}var O,S,I,T,w=l.guid(),D=[],x={},F=[],P=[],U=!1;O={chunk_size:0,file_data_name:"file",filters:{mime_types:[],max_file_size:0,prevent_duplicates:!1,prevent_empty:!0},flash_swf_url:"js/Moxie.swf",http_method:"POST",max_retries:0,multipart:!0,multi_selection:!0,resize:!1,runtimes:o.order,send_file_name:!0,send_chunk_number:!0,silverlight_xap_url:"js/Moxie.xap"},h.call(this,e,null,!0),I=new l.QueueProgress,l.extend(this,{id:w,uid:w,state:l.STOPPED,features:{},runtime:null,files:D,settings:O,total:I,init:function(){var e,t,i=this;return e=i.getOption("preinit"),"function"==typeof e?e(i):l.each(e,function(e,t){i.bind(t,e)}),f.call(i),l.each(["container","browse_button","drop_element"],function(e){return null===i.getOption(e)?(t={code:l.INIT_ERROR,message:l.sprintf(l.translate("%s specified, but cannot be found."),e)},!1):void 0}),t?i.trigger("Error",t):O.browse_button||O.drop_element?(p.call(i,O,function(e){var t=i.getOption("init");"function"==typeof t?t(i):l.each(t,function(e,t){i.bind(t,e)}),e?(i.runtime=o.getInfo(c()).type,i.trigger("Init",{runtime:i.runtime}),i.trigger("PostInit")):i.trigger("Error",{code:l.INIT_ERROR,message:l.translate("Init error.")})}),void 0):i.trigger("Error",{code:l.INIT_ERROR,message:l.translate("You must specify either browse_button or drop_element.")})},setOption:function(e,t){h.call(this,e,t,!this.runtime)},getOption:function(e){return e?O[e]:O},refresh:function(){F.length&&l.each(F,function(e){e.trigger("Refresh")}),this.trigger("Refresh")},start:function(){this.state!=l.STARTED&&(this.state=l.STARTED,this.trigger("StateChanged"),a.call(this))},stop:function(){this.state!=l.STOPPED&&(this.state=l.STOPPED,this.trigger("StateChanged"),this.trigger("CancelUpload"))},disableBrowse:function(){U=arguments[0]!==i?arguments[0]:!0,F.length&&l.each(F,function(e){e.disable(U)}),this.trigger("DisableBrowse",U)},getFile:function(e){var t;for(t=D.length-1;t>=0;t--)if(D[t].id===e)return D[t]},addFile:function(e,i){function n(e,t){var i=[];l.each(u.settings.filters,function(t,n){s[n]&&i.push(function(i){s[n].call(u,t,e,function(e){i(!e)})})}),l.inSeries(i,t)}function a(e){var s=l.typeOf(e);if(e instanceof t.file.File){if(!e.ruid&&!e.isDetached()){if(!o)return!1;e.ruid=o,e.connectRuntime(o)}a(new l.File(e))}else e instanceof t.file.Blob?(a(e.getSource()),e.destroy()):e instanceof l.File?(i&&(e.name=i),d.push(function(t){n(e,function(i){i||(D.push(e),f.push(e),u.trigger("FileFiltered",e)),r(t,1)})})):-1!==l.inArray(s,["file","blob"])?a(new t.file.File(null,e)):"node"===s&&"filelist"===l.typeOf(e.files)?l.each(e.files,a):"array"===s&&(i=null,l.each(e,a))}var o,u=this,d=[],f=[];o=c(),a(e),d.length&&l.inSeries(d,function(){f.length&&u.trigger("FilesAdded",f)})},removeFile:function(e){for(var t="string"==typeof e?e:e.id,i=D.length-1;i>=0;i--)if(D[i].id===t)return this.splice(i,1)[0]},splice:function(e,t){var n=D.splice(e===i?0:e,t===i?D.length:t),r=!1;return this.state==l.STARTED&&(l.each(n,function(e){return e.status===l.UPLOADING?(r=!0,!1):void 0}),r&&this.stop()),this.trigger("FilesRemoved",n),l.each(n,function(e){e.destroy()}),r&&this.start(),n},dispatchEvent:function(e){var t,i;if(e=e.toLowerCase(),t=this.hasEventListener(e)){t.sort(function(e,t){return t.priority-e.priority}),i=[].slice.call(arguments),i.shift(),i.unshift(this);for(var n=0;n<t.length;n++)if(t[n].fn.apply(t[n].scope,i)===!1)return!1}return!0},bind:function(e,t,i,n){l.Uploader.prototype.bind.call(this,e,t,n,i)},destroy:function(){this.trigger("Destroy"),O=I=null,this.unbindAll()}})},l.Uploader.prototype=t.core.EventTarget.instance,l.File=function(){function e(e){l.extend(this,{id:l.guid(),name:e.name||e.fileName,type:e.type||"",relativePath:e.relativePath||"",size:e.fileSize||e.size,origSize:e.fileSize||e.size,loaded:0,percent:0,status:l.QUEUED,lastModifiedDate:e.lastModifiedDate||(new Date).toLocaleString(),completeTimestamp:0,getNative:function(){var e=this.getSource().getSource();return-1!==l.inArray(l.typeOf(e),["blob","file"])?e:null},getSource:function(){return t[this.id]?t[this.id]:null},destroy:function(){var e=this.getSource();e&&(e.destroy(),delete t[this.id])}}),t[this.id]=e}var t={};return e}(),l.QueueProgress=function(){var e=this;e.size=0,e.loaded=0,e.uploaded=0,e.failed=0,e.queued=0,e.percent=0,e.bytesPerSec=0,e.reset=function(){e.size=e.loaded=e.uploaded=e.failed=e.queued=e.percent=e.bytesPerSec=0}},e.plupload=l}(this,e)});
},{"./moxie":98}],100:[function(require,module,exports){
var Vue // late bind
var version
var map = (window.__VUE_HOT_MAP__ = Object.create(null))
var installed = false
var isBrowserify = false
var initHookName = 'beforeCreate'

exports.install = function (vue, browserify) {
  if (installed) { return }
  installed = true

  Vue = vue.__esModule ? vue.default : vue
  version = Vue.version.split('.').map(Number)
  isBrowserify = browserify

  // compat with < 2.0.0-alpha.7
  if (Vue.config._lifecycleHooks.indexOf('init') > -1) {
    initHookName = 'init'
  }

  exports.compatible = version[0] >= 2
  if (!exports.compatible) {
    console.warn(
      '[HMR] You are using a version of vue-hot-reload-api that is ' +
        'only compatible with Vue.js core ^2.0.0.'
    )
    return
  }
}

/**
 * Create a record for a hot module, which keeps track of its constructor
 * and instances
 *
 * @param {String} id
 * @param {Object} options
 */

exports.createRecord = function (id, options) {
  if(map[id]) { return }
  
  var Ctor = null
  if (typeof options === 'function') {
    Ctor = options
    options = Ctor.options
  }
  makeOptionsHot(id, options)
  map[id] = {
    Ctor: Ctor,
    options: options,
    instances: []
  }
}

/**
 * Check if module is recorded
 *
 * @param {String} id
 */

exports.isRecorded = function (id) {
  return typeof map[id] !== 'undefined'
}

/**
 * Make a Component options object hot.
 *
 * @param {String} id
 * @param {Object} options
 */

function makeOptionsHot(id, options) {
  if (options.functional) {
    var render = options.render
    options.render = function (h, ctx) {
      var instances = map[id].instances
      if (ctx && instances.indexOf(ctx.parent) < 0) {
        instances.push(ctx.parent)
      }
      return render(h, ctx)
    }
  } else {
    injectHook(options, initHookName, function() {
      var record = map[id]
      if (!record.Ctor) {
        record.Ctor = this.constructor
      }
      record.instances.push(this)
    })
    injectHook(options, 'beforeDestroy', function() {
      var instances = map[id].instances
      instances.splice(instances.indexOf(this), 1)
    })
  }
}

/**
 * Inject a hook to a hot reloadable component so that
 * we can keep track of it.
 *
 * @param {Object} options
 * @param {String} name
 * @param {Function} hook
 */

function injectHook(options, name, hook) {
  var existing = options[name]
  options[name] = existing
    ? Array.isArray(existing) ? existing.concat(hook) : [existing, hook]
    : [hook]
}

function tryWrap(fn) {
  return function (id, arg) {
    try {
      fn(id, arg)
    } catch (e) {
      console.error(e)
      console.warn(
        'Something went wrong during Vue component hot-reload. Full reload required.'
      )
    }
  }
}

function updateOptions (oldOptions, newOptions) {
  for (var key in oldOptions) {
    if (!(key in newOptions)) {
      delete oldOptions[key]
    }
  }
  for (var key$1 in newOptions) {
    oldOptions[key$1] = newOptions[key$1]
  }
}

exports.rerender = tryWrap(function (id, options) {
  var record = map[id]
  if (!options) {
    record.instances.slice().forEach(function (instance) {
      instance.$forceUpdate()
    })
    return
  }
  if (typeof options === 'function') {
    options = options.options
  }
  if (record.Ctor) {
    record.Ctor.options.render = options.render
    record.Ctor.options.staticRenderFns = options.staticRenderFns
    record.instances.slice().forEach(function (instance) {
      instance.$options.render = options.render
      instance.$options.staticRenderFns = options.staticRenderFns
      // reset static trees
      // pre 2.5, all static trees are cahced together on the instance
      if (instance._staticTrees) {
        instance._staticTrees = []
      }
      // 2.5.0
      if (Array.isArray(record.Ctor.options.cached)) {
        record.Ctor.options.cached = []
      }
      // 2.5.3
      if (Array.isArray(instance.$options.cached)) {
        instance.$options.cached = []
      }
      // post 2.5.4: v-once trees are cached on instance._staticTrees.
      // Pure static trees are cached on the staticRenderFns array
      // (both already reset above)
      instance.$forceUpdate()
    })
  } else {
    // functional or no instance created yet
    record.options.render = options.render
    record.options.staticRenderFns = options.staticRenderFns

    // handle functional component re-render
    if (record.options.functional) {
      // rerender with full options
      if (Object.keys(options).length > 2) {
        updateOptions(record.options, options)
      } else {
        // template-only rerender.
        // need to inject the style injection code for CSS modules
        // to work properly.
        var injectStyles = record.options._injectStyles
        if (injectStyles) {
          var render = options.render
          record.options.render = function (h, ctx) {
            injectStyles.call(ctx)
            return render(h, ctx)
          }
        }
      }
      record.options._Ctor = null
      // 2.5.3
      if (Array.isArray(record.options.cached)) {
        record.options.cached = []
      }
      record.instances.slice().forEach(function (instance) {
        instance.$forceUpdate()
      })
    }
  }
})

exports.reload = tryWrap(function (id, options) {
  var record = map[id]
  if (options) {
    if (typeof options === 'function') {
      options = options.options
    }
    makeOptionsHot(id, options)
    if (record.Ctor) {
      if (version[1] < 2) {
        // preserve pre 2.2 behavior for global mixin handling
        record.Ctor.extendOptions = options
      }
      var newCtor = record.Ctor.super.extend(options)
      record.Ctor.options = newCtor.options
      record.Ctor.cid = newCtor.cid
      record.Ctor.prototype = newCtor.prototype
      if (newCtor.release) {
        // temporary global mixin strategy used in < 2.0.0-alpha.6
        newCtor.release()
      }
    } else {
      updateOptions(record.options, options)
    }
  }
  record.instances.slice().forEach(function (instance) {
    if (instance.$vnode && instance.$vnode.context) {
      instance.$vnode.context.$forceUpdate()
    } else {
      console.warn(
        'Root or manually mounted instance modified. Full reload required.'
      )
    }
  })
})

},{}],101:[function(require,module,exports){
var inserted = exports.cache = {}

function noop () {}

exports.insert = function (css) {
  if (inserted[css]) return noop
  inserted[css] = true

  var elem = document.createElement('style')
  elem.setAttribute('type', 'text/css')

  if ('textContent' in elem) {
    elem.textContent = css
  } else {
    elem.styleSheet.cssText = css
  }

  document.getElementsByTagName('head')[0].appendChild(elem)
  return function () {
    document.getElementsByTagName('head')[0].removeChild(elem)
    inserted[css] = false
  }
}

},{}],102:[function(require,module,exports){
(function (global){
var __vueify_style_dispose__ = require("vueify/lib/insert-css").insert(".plupload-btn {\r\n    color: #fff;\r\n    background-color: #337ab7;\r\n    border-color: #2e6da4;\r\n    display: inline-block;\r\n    padding: 6px 12px;\r\n    margin-bottom: 0;\r\n    font-size: 14px;\r\n    font-weight: 400;\r\n    line-height: 1.42857143;\r\n    text-align: center;\r\n    vertical-align: middle;\r\n    touch-action: manipulation;\r\n    cursor: pointer;\r\n    user-select: none;\r\n    background-image: none;\r\n    border: 1px solid transparent;\r\n    border-radius: 4px;\r\n}")
;(function(){
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//

var Vue = global.Vue || require("vue");
var plupload = require("plupload");
var merge = require('lodash/merge');

var uploaderDefaultOption = {
    runtimes: 'html5,html4'
};

module.exports = Vue.extend({
    props: {
        className: {
            type: String,
            default: "plupload-btn"
        },
        text: {
            type: String,
            default: "Upload"
        },
        options: {
            type: Object,
            default: function () {
                return {

                }
            }
        }
    },
    
    methods: {
        renderUI: function() {
            var self = this;

            Vue.nextTick(function () {

                var opt = merge(uploaderDefaultOption, self.options, {

                    browse_button: self.$refs.btn,

                    init: {
                        PostInit: function (uploader) {
                            self.$emit("init", uploader)
                        },

                        FilesAdded: function (up, files) {
                            self.$emit("added", up, files)
                        },

                        UploadProgress: function (up, file) {
                            self.$emit("progress", up, file)
                        },

                        FileUploaded: function(up, file, result) {
                            self.$emit("uploaded", up, file, result)
                        },

                        Error: function (up, err) {
                            self.$emit("error", up, err)
                        }
                    }
                })

                var uploader = new plupload.Uploader(opt);

                uploader.init();
            });
        }
    },

    mounted: function () {
        this.renderUI();
    },
    
    updated: function() {
        this.renderUI();
    }
});


})()
if (module.exports.__esModule) module.exports = module.exports.default
var __vue__options__ = (typeof module.exports === "function"? module.exports.options: module.exports)
if (__vue__options__.functional) {console.error("[vueify] functional components are not supported and should be defined in plain js files using render functions.")}
__vue__options__.render = function render () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('input',{ref:"btn",class:_vm.className,attrs:{"value":_vm.text,"type":"button"}})}
__vue__options__.staticRenderFns = []
if (module.hot) {(function () {  var hotAPI = require("vue-hot-reload-api")
  hotAPI.install(require("vue"), true)
  if (!hotAPI.compatible) return
  module.hot.accept()
  module.hot.dispose(__vueify_style_dispose__)
  if (!module.hot.data) {
    hotAPI.createRecord("data-v-5f761c44", __vue__options__)
  } else {
    hotAPI.reload("data-v-5f761c44", __vue__options__)
  }
})()}

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"lodash/merge":95,"plupload":99,"vue":"vue","vue-hot-reload-api":100,"vueify/lib/insert-css":101}]},{},[1])(1)
});

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJpbmRleC5qcyIsIm5vZGVfbW9kdWxlcy9sb2Rhc2gvX0hhc2guanMiLCJub2RlX21vZHVsZXMvbG9kYXNoL19MaXN0Q2FjaGUuanMiLCJub2RlX21vZHVsZXMvbG9kYXNoL19NYXAuanMiLCJub2RlX21vZHVsZXMvbG9kYXNoL19NYXBDYWNoZS5qcyIsIm5vZGVfbW9kdWxlcy9sb2Rhc2gvX1N0YWNrLmpzIiwibm9kZV9tb2R1bGVzL2xvZGFzaC9fU3ltYm9sLmpzIiwibm9kZV9tb2R1bGVzL2xvZGFzaC9fVWludDhBcnJheS5qcyIsIm5vZGVfbW9kdWxlcy9sb2Rhc2gvX2FwcGx5LmpzIiwibm9kZV9tb2R1bGVzL2xvZGFzaC9fYXJyYXlMaWtlS2V5cy5qcyIsIm5vZGVfbW9kdWxlcy9sb2Rhc2gvX2Fzc2lnbk1lcmdlVmFsdWUuanMiLCJub2RlX21vZHVsZXMvbG9kYXNoL19hc3NpZ25WYWx1ZS5qcyIsIm5vZGVfbW9kdWxlcy9sb2Rhc2gvX2Fzc29jSW5kZXhPZi5qcyIsIm5vZGVfbW9kdWxlcy9sb2Rhc2gvX2Jhc2VBc3NpZ25WYWx1ZS5qcyIsIm5vZGVfbW9kdWxlcy9sb2Rhc2gvX2Jhc2VDcmVhdGUuanMiLCJub2RlX21vZHVsZXMvbG9kYXNoL19iYXNlRm9yLmpzIiwibm9kZV9tb2R1bGVzL2xvZGFzaC9fYmFzZUdldFRhZy5qcyIsIm5vZGVfbW9kdWxlcy9sb2Rhc2gvX2Jhc2VJc0FyZ3VtZW50cy5qcyIsIm5vZGVfbW9kdWxlcy9sb2Rhc2gvX2Jhc2VJc05hdGl2ZS5qcyIsIm5vZGVfbW9kdWxlcy9sb2Rhc2gvX2Jhc2VJc1R5cGVkQXJyYXkuanMiLCJub2RlX21vZHVsZXMvbG9kYXNoL19iYXNlS2V5c0luLmpzIiwibm9kZV9tb2R1bGVzL2xvZGFzaC9fYmFzZU1lcmdlLmpzIiwibm9kZV9tb2R1bGVzL2xvZGFzaC9fYmFzZU1lcmdlRGVlcC5qcyIsIm5vZGVfbW9kdWxlcy9sb2Rhc2gvX2Jhc2VSZXN0LmpzIiwibm9kZV9tb2R1bGVzL2xvZGFzaC9fYmFzZVNldFRvU3RyaW5nLmpzIiwibm9kZV9tb2R1bGVzL2xvZGFzaC9fYmFzZVRpbWVzLmpzIiwibm9kZV9tb2R1bGVzL2xvZGFzaC9fYmFzZVVuYXJ5LmpzIiwibm9kZV9tb2R1bGVzL2xvZGFzaC9fY2xvbmVBcnJheUJ1ZmZlci5qcyIsIm5vZGVfbW9kdWxlcy9sb2Rhc2gvX2Nsb25lQnVmZmVyLmpzIiwibm9kZV9tb2R1bGVzL2xvZGFzaC9fY2xvbmVUeXBlZEFycmF5LmpzIiwibm9kZV9tb2R1bGVzL2xvZGFzaC9fY29weUFycmF5LmpzIiwibm9kZV9tb2R1bGVzL2xvZGFzaC9fY29weU9iamVjdC5qcyIsIm5vZGVfbW9kdWxlcy9sb2Rhc2gvX2NvcmVKc0RhdGEuanMiLCJub2RlX21vZHVsZXMvbG9kYXNoL19jcmVhdGVBc3NpZ25lci5qcyIsIm5vZGVfbW9kdWxlcy9sb2Rhc2gvX2NyZWF0ZUJhc2VGb3IuanMiLCJub2RlX21vZHVsZXMvbG9kYXNoL19kZWZpbmVQcm9wZXJ0eS5qcyIsIm5vZGVfbW9kdWxlcy9sb2Rhc2gvX2ZyZWVHbG9iYWwuanMiLCJub2RlX21vZHVsZXMvbG9kYXNoL19nZXRNYXBEYXRhLmpzIiwibm9kZV9tb2R1bGVzL2xvZGFzaC9fZ2V0TmF0aXZlLmpzIiwibm9kZV9tb2R1bGVzL2xvZGFzaC9fZ2V0UHJvdG90eXBlLmpzIiwibm9kZV9tb2R1bGVzL2xvZGFzaC9fZ2V0UmF3VGFnLmpzIiwibm9kZV9tb2R1bGVzL2xvZGFzaC9fZ2V0VmFsdWUuanMiLCJub2RlX21vZHVsZXMvbG9kYXNoL19oYXNoQ2xlYXIuanMiLCJub2RlX21vZHVsZXMvbG9kYXNoL19oYXNoRGVsZXRlLmpzIiwibm9kZV9tb2R1bGVzL2xvZGFzaC9faGFzaEdldC5qcyIsIm5vZGVfbW9kdWxlcy9sb2Rhc2gvX2hhc2hIYXMuanMiLCJub2RlX21vZHVsZXMvbG9kYXNoL19oYXNoU2V0LmpzIiwibm9kZV9tb2R1bGVzL2xvZGFzaC9faW5pdENsb25lT2JqZWN0LmpzIiwibm9kZV9tb2R1bGVzL2xvZGFzaC9faXNJbmRleC5qcyIsIm5vZGVfbW9kdWxlcy9sb2Rhc2gvX2lzSXRlcmF0ZWVDYWxsLmpzIiwibm9kZV9tb2R1bGVzL2xvZGFzaC9faXNLZXlhYmxlLmpzIiwibm9kZV9tb2R1bGVzL2xvZGFzaC9faXNNYXNrZWQuanMiLCJub2RlX21vZHVsZXMvbG9kYXNoL19pc1Byb3RvdHlwZS5qcyIsIm5vZGVfbW9kdWxlcy9sb2Rhc2gvX2xpc3RDYWNoZUNsZWFyLmpzIiwibm9kZV9tb2R1bGVzL2xvZGFzaC9fbGlzdENhY2hlRGVsZXRlLmpzIiwibm9kZV9tb2R1bGVzL2xvZGFzaC9fbGlzdENhY2hlR2V0LmpzIiwibm9kZV9tb2R1bGVzL2xvZGFzaC9fbGlzdENhY2hlSGFzLmpzIiwibm9kZV9tb2R1bGVzL2xvZGFzaC9fbGlzdENhY2hlU2V0LmpzIiwibm9kZV9tb2R1bGVzL2xvZGFzaC9fbWFwQ2FjaGVDbGVhci5qcyIsIm5vZGVfbW9kdWxlcy9sb2Rhc2gvX21hcENhY2hlRGVsZXRlLmpzIiwibm9kZV9tb2R1bGVzL2xvZGFzaC9fbWFwQ2FjaGVHZXQuanMiLCJub2RlX21vZHVsZXMvbG9kYXNoL19tYXBDYWNoZUhhcy5qcyIsIm5vZGVfbW9kdWxlcy9sb2Rhc2gvX21hcENhY2hlU2V0LmpzIiwibm9kZV9tb2R1bGVzL2xvZGFzaC9fbmF0aXZlQ3JlYXRlLmpzIiwibm9kZV9tb2R1bGVzL2xvZGFzaC9fbmF0aXZlS2V5c0luLmpzIiwibm9kZV9tb2R1bGVzL2xvZGFzaC9fbm9kZVV0aWwuanMiLCJub2RlX21vZHVsZXMvbG9kYXNoL19vYmplY3RUb1N0cmluZy5qcyIsIm5vZGVfbW9kdWxlcy9sb2Rhc2gvX292ZXJBcmcuanMiLCJub2RlX21vZHVsZXMvbG9kYXNoL19vdmVyUmVzdC5qcyIsIm5vZGVfbW9kdWxlcy9sb2Rhc2gvX3Jvb3QuanMiLCJub2RlX21vZHVsZXMvbG9kYXNoL19zYWZlR2V0LmpzIiwibm9kZV9tb2R1bGVzL2xvZGFzaC9fc2V0VG9TdHJpbmcuanMiLCJub2RlX21vZHVsZXMvbG9kYXNoL19zaG9ydE91dC5qcyIsIm5vZGVfbW9kdWxlcy9sb2Rhc2gvX3N0YWNrQ2xlYXIuanMiLCJub2RlX21vZHVsZXMvbG9kYXNoL19zdGFja0RlbGV0ZS5qcyIsIm5vZGVfbW9kdWxlcy9sb2Rhc2gvX3N0YWNrR2V0LmpzIiwibm9kZV9tb2R1bGVzL2xvZGFzaC9fc3RhY2tIYXMuanMiLCJub2RlX21vZHVsZXMvbG9kYXNoL19zdGFja1NldC5qcyIsIm5vZGVfbW9kdWxlcy9sb2Rhc2gvX3RvU291cmNlLmpzIiwibm9kZV9tb2R1bGVzL2xvZGFzaC9jb25zdGFudC5qcyIsIm5vZGVfbW9kdWxlcy9sb2Rhc2gvZXEuanMiLCJub2RlX21vZHVsZXMvbG9kYXNoL2lkZW50aXR5LmpzIiwibm9kZV9tb2R1bGVzL2xvZGFzaC9pc0FyZ3VtZW50cy5qcyIsIm5vZGVfbW9kdWxlcy9sb2Rhc2gvaXNBcnJheS5qcyIsIm5vZGVfbW9kdWxlcy9sb2Rhc2gvaXNBcnJheUxpa2UuanMiLCJub2RlX21vZHVsZXMvbG9kYXNoL2lzQXJyYXlMaWtlT2JqZWN0LmpzIiwibm9kZV9tb2R1bGVzL2xvZGFzaC9pc0J1ZmZlci5qcyIsIm5vZGVfbW9kdWxlcy9sb2Rhc2gvaXNGdW5jdGlvbi5qcyIsIm5vZGVfbW9kdWxlcy9sb2Rhc2gvaXNMZW5ndGguanMiLCJub2RlX21vZHVsZXMvbG9kYXNoL2lzT2JqZWN0LmpzIiwibm9kZV9tb2R1bGVzL2xvZGFzaC9pc09iamVjdExpa2UuanMiLCJub2RlX21vZHVsZXMvbG9kYXNoL2lzUGxhaW5PYmplY3QuanMiLCJub2RlX21vZHVsZXMvbG9kYXNoL2lzVHlwZWRBcnJheS5qcyIsIm5vZGVfbW9kdWxlcy9sb2Rhc2gva2V5c0luLmpzIiwibm9kZV9tb2R1bGVzL2xvZGFzaC9tZXJnZS5qcyIsIm5vZGVfbW9kdWxlcy9sb2Rhc2gvc3R1YkZhbHNlLmpzIiwibm9kZV9tb2R1bGVzL2xvZGFzaC90b1BsYWluT2JqZWN0LmpzIiwibm9kZV9tb2R1bGVzL3BsdXBsb2FkL2pzL21veGllLmpzIiwibm9kZV9tb2R1bGVzL3BsdXBsb2FkL2pzL3BsdXBsb2FkLmZ1bGwubWluLmpzIiwibm9kZV9tb2R1bGVzL3Z1ZS1ob3QtcmVsb2FkLWFwaS9kaXN0L2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3Z1ZWlmeS9saWIvaW5zZXJ0LWNzcy5qcyIsInNyYy9zcmMvdnVlLXBsdXBsb2FkLnZ1ZT8zNzEwOGM4OCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNSQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNQQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDZEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25DQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ05BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDWEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQ0pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ05BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDYkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDZkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDZkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNiQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNUQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNmQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDZEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDZkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNkQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDZEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25DQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDajhXQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoUEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7QUN2QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUF0R0E7QUFBQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9cmV0dXJuIGV9KSgpIiwidmFyIFZ1ZVBsdXBsb2FkID0gcmVxdWlyZSgnLi9zcmMvdnVlLXBsdXBsb2FkLnZ1ZScpXHJcblxyXG52YXIgdnVlcGx1cGxvYWRlciA9IHtcclxuICAgIGluc3RhbGw6IGZ1bmN0aW9uKFZ1ZSkge1xyXG4gICAgICAgIFZ1ZS5jb21wb25lbnQoJ3Z1ZS1wbHVwbG9hZCcsIFZ1ZVBsdXBsb2FkKVxyXG4gICAgfVxyXG59XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHZ1ZXBsdXBsb2FkZXIiLCJ2YXIgaGFzaENsZWFyID0gcmVxdWlyZSgnLi9faGFzaENsZWFyJyksXG4gICAgaGFzaERlbGV0ZSA9IHJlcXVpcmUoJy4vX2hhc2hEZWxldGUnKSxcbiAgICBoYXNoR2V0ID0gcmVxdWlyZSgnLi9faGFzaEdldCcpLFxuICAgIGhhc2hIYXMgPSByZXF1aXJlKCcuL19oYXNoSGFzJyksXG4gICAgaGFzaFNldCA9IHJlcXVpcmUoJy4vX2hhc2hTZXQnKTtcblxuLyoqXG4gKiBDcmVhdGVzIGEgaGFzaCBvYmplY3QuXG4gKlxuICogQHByaXZhdGVcbiAqIEBjb25zdHJ1Y3RvclxuICogQHBhcmFtIHtBcnJheX0gW2VudHJpZXNdIFRoZSBrZXktdmFsdWUgcGFpcnMgdG8gY2FjaGUuXG4gKi9cbmZ1bmN0aW9uIEhhc2goZW50cmllcykge1xuICB2YXIgaW5kZXggPSAtMSxcbiAgICAgIGxlbmd0aCA9IGVudHJpZXMgPT0gbnVsbCA/IDAgOiBlbnRyaWVzLmxlbmd0aDtcblxuICB0aGlzLmNsZWFyKCk7XG4gIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgdmFyIGVudHJ5ID0gZW50cmllc1tpbmRleF07XG4gICAgdGhpcy5zZXQoZW50cnlbMF0sIGVudHJ5WzFdKTtcbiAgfVxufVxuXG4vLyBBZGQgbWV0aG9kcyB0byBgSGFzaGAuXG5IYXNoLnByb3RvdHlwZS5jbGVhciA9IGhhc2hDbGVhcjtcbkhhc2gucHJvdG90eXBlWydkZWxldGUnXSA9IGhhc2hEZWxldGU7XG5IYXNoLnByb3RvdHlwZS5nZXQgPSBoYXNoR2V0O1xuSGFzaC5wcm90b3R5cGUuaGFzID0gaGFzaEhhcztcbkhhc2gucHJvdG90eXBlLnNldCA9IGhhc2hTZXQ7XG5cbm1vZHVsZS5leHBvcnRzID0gSGFzaDtcbiIsInZhciBsaXN0Q2FjaGVDbGVhciA9IHJlcXVpcmUoJy4vX2xpc3RDYWNoZUNsZWFyJyksXG4gICAgbGlzdENhY2hlRGVsZXRlID0gcmVxdWlyZSgnLi9fbGlzdENhY2hlRGVsZXRlJyksXG4gICAgbGlzdENhY2hlR2V0ID0gcmVxdWlyZSgnLi9fbGlzdENhY2hlR2V0JyksXG4gICAgbGlzdENhY2hlSGFzID0gcmVxdWlyZSgnLi9fbGlzdENhY2hlSGFzJyksXG4gICAgbGlzdENhY2hlU2V0ID0gcmVxdWlyZSgnLi9fbGlzdENhY2hlU2V0Jyk7XG5cbi8qKlxuICogQ3JlYXRlcyBhbiBsaXN0IGNhY2hlIG9iamVjdC5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQGNvbnN0cnVjdG9yXG4gKiBAcGFyYW0ge0FycmF5fSBbZW50cmllc10gVGhlIGtleS12YWx1ZSBwYWlycyB0byBjYWNoZS5cbiAqL1xuZnVuY3Rpb24gTGlzdENhY2hlKGVudHJpZXMpIHtcbiAgdmFyIGluZGV4ID0gLTEsXG4gICAgICBsZW5ndGggPSBlbnRyaWVzID09IG51bGwgPyAwIDogZW50cmllcy5sZW5ndGg7XG5cbiAgdGhpcy5jbGVhcigpO1xuICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuICAgIHZhciBlbnRyeSA9IGVudHJpZXNbaW5kZXhdO1xuICAgIHRoaXMuc2V0KGVudHJ5WzBdLCBlbnRyeVsxXSk7XG4gIH1cbn1cblxuLy8gQWRkIG1ldGhvZHMgdG8gYExpc3RDYWNoZWAuXG5MaXN0Q2FjaGUucHJvdG90eXBlLmNsZWFyID0gbGlzdENhY2hlQ2xlYXI7XG5MaXN0Q2FjaGUucHJvdG90eXBlWydkZWxldGUnXSA9IGxpc3RDYWNoZURlbGV0ZTtcbkxpc3RDYWNoZS5wcm90b3R5cGUuZ2V0ID0gbGlzdENhY2hlR2V0O1xuTGlzdENhY2hlLnByb3RvdHlwZS5oYXMgPSBsaXN0Q2FjaGVIYXM7XG5MaXN0Q2FjaGUucHJvdG90eXBlLnNldCA9IGxpc3RDYWNoZVNldDtcblxubW9kdWxlLmV4cG9ydHMgPSBMaXN0Q2FjaGU7XG4iLCJ2YXIgZ2V0TmF0aXZlID0gcmVxdWlyZSgnLi9fZ2V0TmF0aXZlJyksXG4gICAgcm9vdCA9IHJlcXVpcmUoJy4vX3Jvb3QnKTtcblxuLyogQnVpbHQtaW4gbWV0aG9kIHJlZmVyZW5jZXMgdGhhdCBhcmUgdmVyaWZpZWQgdG8gYmUgbmF0aXZlLiAqL1xudmFyIE1hcCA9IGdldE5hdGl2ZShyb290LCAnTWFwJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gTWFwO1xuIiwidmFyIG1hcENhY2hlQ2xlYXIgPSByZXF1aXJlKCcuL19tYXBDYWNoZUNsZWFyJyksXG4gICAgbWFwQ2FjaGVEZWxldGUgPSByZXF1aXJlKCcuL19tYXBDYWNoZURlbGV0ZScpLFxuICAgIG1hcENhY2hlR2V0ID0gcmVxdWlyZSgnLi9fbWFwQ2FjaGVHZXQnKSxcbiAgICBtYXBDYWNoZUhhcyA9IHJlcXVpcmUoJy4vX21hcENhY2hlSGFzJyksXG4gICAgbWFwQ2FjaGVTZXQgPSByZXF1aXJlKCcuL19tYXBDYWNoZVNldCcpO1xuXG4vKipcbiAqIENyZWF0ZXMgYSBtYXAgY2FjaGUgb2JqZWN0IHRvIHN0b3JlIGtleS12YWx1ZSBwYWlycy5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQGNvbnN0cnVjdG9yXG4gKiBAcGFyYW0ge0FycmF5fSBbZW50cmllc10gVGhlIGtleS12YWx1ZSBwYWlycyB0byBjYWNoZS5cbiAqL1xuZnVuY3Rpb24gTWFwQ2FjaGUoZW50cmllcykge1xuICB2YXIgaW5kZXggPSAtMSxcbiAgICAgIGxlbmd0aCA9IGVudHJpZXMgPT0gbnVsbCA/IDAgOiBlbnRyaWVzLmxlbmd0aDtcblxuICB0aGlzLmNsZWFyKCk7XG4gIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgdmFyIGVudHJ5ID0gZW50cmllc1tpbmRleF07XG4gICAgdGhpcy5zZXQoZW50cnlbMF0sIGVudHJ5WzFdKTtcbiAgfVxufVxuXG4vLyBBZGQgbWV0aG9kcyB0byBgTWFwQ2FjaGVgLlxuTWFwQ2FjaGUucHJvdG90eXBlLmNsZWFyID0gbWFwQ2FjaGVDbGVhcjtcbk1hcENhY2hlLnByb3RvdHlwZVsnZGVsZXRlJ10gPSBtYXBDYWNoZURlbGV0ZTtcbk1hcENhY2hlLnByb3RvdHlwZS5nZXQgPSBtYXBDYWNoZUdldDtcbk1hcENhY2hlLnByb3RvdHlwZS5oYXMgPSBtYXBDYWNoZUhhcztcbk1hcENhY2hlLnByb3RvdHlwZS5zZXQgPSBtYXBDYWNoZVNldDtcblxubW9kdWxlLmV4cG9ydHMgPSBNYXBDYWNoZTtcbiIsInZhciBMaXN0Q2FjaGUgPSByZXF1aXJlKCcuL19MaXN0Q2FjaGUnKSxcbiAgICBzdGFja0NsZWFyID0gcmVxdWlyZSgnLi9fc3RhY2tDbGVhcicpLFxuICAgIHN0YWNrRGVsZXRlID0gcmVxdWlyZSgnLi9fc3RhY2tEZWxldGUnKSxcbiAgICBzdGFja0dldCA9IHJlcXVpcmUoJy4vX3N0YWNrR2V0JyksXG4gICAgc3RhY2tIYXMgPSByZXF1aXJlKCcuL19zdGFja0hhcycpLFxuICAgIHN0YWNrU2V0ID0gcmVxdWlyZSgnLi9fc3RhY2tTZXQnKTtcblxuLyoqXG4gKiBDcmVhdGVzIGEgc3RhY2sgY2FjaGUgb2JqZWN0IHRvIHN0b3JlIGtleS12YWx1ZSBwYWlycy5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQGNvbnN0cnVjdG9yXG4gKiBAcGFyYW0ge0FycmF5fSBbZW50cmllc10gVGhlIGtleS12YWx1ZSBwYWlycyB0byBjYWNoZS5cbiAqL1xuZnVuY3Rpb24gU3RhY2soZW50cmllcykge1xuICB2YXIgZGF0YSA9IHRoaXMuX19kYXRhX18gPSBuZXcgTGlzdENhY2hlKGVudHJpZXMpO1xuICB0aGlzLnNpemUgPSBkYXRhLnNpemU7XG59XG5cbi8vIEFkZCBtZXRob2RzIHRvIGBTdGFja2AuXG5TdGFjay5wcm90b3R5cGUuY2xlYXIgPSBzdGFja0NsZWFyO1xuU3RhY2sucHJvdG90eXBlWydkZWxldGUnXSA9IHN0YWNrRGVsZXRlO1xuU3RhY2sucHJvdG90eXBlLmdldCA9IHN0YWNrR2V0O1xuU3RhY2sucHJvdG90eXBlLmhhcyA9IHN0YWNrSGFzO1xuU3RhY2sucHJvdG90eXBlLnNldCA9IHN0YWNrU2V0O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFN0YWNrO1xuIiwidmFyIHJvb3QgPSByZXF1aXJlKCcuL19yb290Jyk7XG5cbi8qKiBCdWlsdC1pbiB2YWx1ZSByZWZlcmVuY2VzLiAqL1xudmFyIFN5bWJvbCA9IHJvb3QuU3ltYm9sO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFN5bWJvbDtcbiIsInZhciByb290ID0gcmVxdWlyZSgnLi9fcm9vdCcpO1xuXG4vKiogQnVpbHQtaW4gdmFsdWUgcmVmZXJlbmNlcy4gKi9cbnZhciBVaW50OEFycmF5ID0gcm9vdC5VaW50OEFycmF5O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFVpbnQ4QXJyYXk7XG4iLCIvKipcbiAqIEEgZmFzdGVyIGFsdGVybmF0aXZlIHRvIGBGdW5jdGlvbiNhcHBseWAsIHRoaXMgZnVuY3Rpb24gaW52b2tlcyBgZnVuY2BcbiAqIHdpdGggdGhlIGB0aGlzYCBiaW5kaW5nIG9mIGB0aGlzQXJnYCBhbmQgdGhlIGFyZ3VtZW50cyBvZiBgYXJnc2AuXG4gKlxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmMgVGhlIGZ1bmN0aW9uIHRvIGludm9rZS5cbiAqIEBwYXJhbSB7Kn0gdGhpc0FyZyBUaGUgYHRoaXNgIGJpbmRpbmcgb2YgYGZ1bmNgLlxuICogQHBhcmFtIHtBcnJheX0gYXJncyBUaGUgYXJndW1lbnRzIHRvIGludm9rZSBgZnVuY2Agd2l0aC5cbiAqIEByZXR1cm5zIHsqfSBSZXR1cm5zIHRoZSByZXN1bHQgb2YgYGZ1bmNgLlxuICovXG5mdW5jdGlvbiBhcHBseShmdW5jLCB0aGlzQXJnLCBhcmdzKSB7XG4gIHN3aXRjaCAoYXJncy5sZW5ndGgpIHtcbiAgICBjYXNlIDA6IHJldHVybiBmdW5jLmNhbGwodGhpc0FyZyk7XG4gICAgY2FzZSAxOiByZXR1cm4gZnVuYy5jYWxsKHRoaXNBcmcsIGFyZ3NbMF0pO1xuICAgIGNhc2UgMjogcmV0dXJuIGZ1bmMuY2FsbCh0aGlzQXJnLCBhcmdzWzBdLCBhcmdzWzFdKTtcbiAgICBjYXNlIDM6IHJldHVybiBmdW5jLmNhbGwodGhpc0FyZywgYXJnc1swXSwgYXJnc1sxXSwgYXJnc1syXSk7XG4gIH1cbiAgcmV0dXJuIGZ1bmMuYXBwbHkodGhpc0FyZywgYXJncyk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gYXBwbHk7XG4iLCJ2YXIgYmFzZVRpbWVzID0gcmVxdWlyZSgnLi9fYmFzZVRpbWVzJyksXG4gICAgaXNBcmd1bWVudHMgPSByZXF1aXJlKCcuL2lzQXJndW1lbnRzJyksXG4gICAgaXNBcnJheSA9IHJlcXVpcmUoJy4vaXNBcnJheScpLFxuICAgIGlzQnVmZmVyID0gcmVxdWlyZSgnLi9pc0J1ZmZlcicpLFxuICAgIGlzSW5kZXggPSByZXF1aXJlKCcuL19pc0luZGV4JyksXG4gICAgaXNUeXBlZEFycmF5ID0gcmVxdWlyZSgnLi9pc1R5cGVkQXJyYXknKTtcblxuLyoqIFVzZWQgZm9yIGJ1aWx0LWluIG1ldGhvZCByZWZlcmVuY2VzLiAqL1xudmFyIG9iamVjdFByb3RvID0gT2JqZWN0LnByb3RvdHlwZTtcblxuLyoqIFVzZWQgdG8gY2hlY2sgb2JqZWN0cyBmb3Igb3duIHByb3BlcnRpZXMuICovXG52YXIgaGFzT3duUHJvcGVydHkgPSBvYmplY3RQcm90by5oYXNPd25Qcm9wZXJ0eTtcblxuLyoqXG4gKiBDcmVhdGVzIGFuIGFycmF5IG9mIHRoZSBlbnVtZXJhYmxlIHByb3BlcnR5IG5hbWVzIG9mIHRoZSBhcnJheS1saWtlIGB2YWx1ZWAuXG4gKlxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIHF1ZXJ5LlxuICogQHBhcmFtIHtib29sZWFufSBpbmhlcml0ZWQgU3BlY2lmeSByZXR1cm5pbmcgaW5oZXJpdGVkIHByb3BlcnR5IG5hbWVzLlxuICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBhcnJheSBvZiBwcm9wZXJ0eSBuYW1lcy5cbiAqL1xuZnVuY3Rpb24gYXJyYXlMaWtlS2V5cyh2YWx1ZSwgaW5oZXJpdGVkKSB7XG4gIHZhciBpc0FyciA9IGlzQXJyYXkodmFsdWUpLFxuICAgICAgaXNBcmcgPSAhaXNBcnIgJiYgaXNBcmd1bWVudHModmFsdWUpLFxuICAgICAgaXNCdWZmID0gIWlzQXJyICYmICFpc0FyZyAmJiBpc0J1ZmZlcih2YWx1ZSksXG4gICAgICBpc1R5cGUgPSAhaXNBcnIgJiYgIWlzQXJnICYmICFpc0J1ZmYgJiYgaXNUeXBlZEFycmF5KHZhbHVlKSxcbiAgICAgIHNraXBJbmRleGVzID0gaXNBcnIgfHwgaXNBcmcgfHwgaXNCdWZmIHx8IGlzVHlwZSxcbiAgICAgIHJlc3VsdCA9IHNraXBJbmRleGVzID8gYmFzZVRpbWVzKHZhbHVlLmxlbmd0aCwgU3RyaW5nKSA6IFtdLFxuICAgICAgbGVuZ3RoID0gcmVzdWx0Lmxlbmd0aDtcblxuICBmb3IgKHZhciBrZXkgaW4gdmFsdWUpIHtcbiAgICBpZiAoKGluaGVyaXRlZCB8fCBoYXNPd25Qcm9wZXJ0eS5jYWxsKHZhbHVlLCBrZXkpKSAmJlxuICAgICAgICAhKHNraXBJbmRleGVzICYmIChcbiAgICAgICAgICAgLy8gU2FmYXJpIDkgaGFzIGVudW1lcmFibGUgYGFyZ3VtZW50cy5sZW5ndGhgIGluIHN0cmljdCBtb2RlLlxuICAgICAgICAgICBrZXkgPT0gJ2xlbmd0aCcgfHxcbiAgICAgICAgICAgLy8gTm9kZS5qcyAwLjEwIGhhcyBlbnVtZXJhYmxlIG5vbi1pbmRleCBwcm9wZXJ0aWVzIG9uIGJ1ZmZlcnMuXG4gICAgICAgICAgIChpc0J1ZmYgJiYgKGtleSA9PSAnb2Zmc2V0JyB8fCBrZXkgPT0gJ3BhcmVudCcpKSB8fFxuICAgICAgICAgICAvLyBQaGFudG9tSlMgMiBoYXMgZW51bWVyYWJsZSBub24taW5kZXggcHJvcGVydGllcyBvbiB0eXBlZCBhcnJheXMuXG4gICAgICAgICAgIChpc1R5cGUgJiYgKGtleSA9PSAnYnVmZmVyJyB8fCBrZXkgPT0gJ2J5dGVMZW5ndGgnIHx8IGtleSA9PSAnYnl0ZU9mZnNldCcpKSB8fFxuICAgICAgICAgICAvLyBTa2lwIGluZGV4IHByb3BlcnRpZXMuXG4gICAgICAgICAgIGlzSW5kZXgoa2V5LCBsZW5ndGgpXG4gICAgICAgICkpKSB7XG4gICAgICByZXN1bHQucHVzaChrZXkpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGFycmF5TGlrZUtleXM7XG4iLCJ2YXIgYmFzZUFzc2lnblZhbHVlID0gcmVxdWlyZSgnLi9fYmFzZUFzc2lnblZhbHVlJyksXG4gICAgZXEgPSByZXF1aXJlKCcuL2VxJyk7XG5cbi8qKlxuICogVGhpcyBmdW5jdGlvbiBpcyBsaWtlIGBhc3NpZ25WYWx1ZWAgZXhjZXB0IHRoYXQgaXQgZG9lc24ndCBhc3NpZ25cbiAqIGB1bmRlZmluZWRgIHZhbHVlcy5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIG1vZGlmeS5cbiAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgVGhlIGtleSBvZiB0aGUgcHJvcGVydHkgdG8gYXNzaWduLlxuICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gYXNzaWduLlxuICovXG5mdW5jdGlvbiBhc3NpZ25NZXJnZVZhbHVlKG9iamVjdCwga2V5LCB2YWx1ZSkge1xuICBpZiAoKHZhbHVlICE9PSB1bmRlZmluZWQgJiYgIWVxKG9iamVjdFtrZXldLCB2YWx1ZSkpIHx8XG4gICAgICAodmFsdWUgPT09IHVuZGVmaW5lZCAmJiAhKGtleSBpbiBvYmplY3QpKSkge1xuICAgIGJhc2VBc3NpZ25WYWx1ZShvYmplY3QsIGtleSwgdmFsdWUpO1xuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gYXNzaWduTWVyZ2VWYWx1ZTtcbiIsInZhciBiYXNlQXNzaWduVmFsdWUgPSByZXF1aXJlKCcuL19iYXNlQXNzaWduVmFsdWUnKSxcbiAgICBlcSA9IHJlcXVpcmUoJy4vZXEnKTtcblxuLyoqIFVzZWQgZm9yIGJ1aWx0LWluIG1ldGhvZCByZWZlcmVuY2VzLiAqL1xudmFyIG9iamVjdFByb3RvID0gT2JqZWN0LnByb3RvdHlwZTtcblxuLyoqIFVzZWQgdG8gY2hlY2sgb2JqZWN0cyBmb3Igb3duIHByb3BlcnRpZXMuICovXG52YXIgaGFzT3duUHJvcGVydHkgPSBvYmplY3RQcm90by5oYXNPd25Qcm9wZXJ0eTtcblxuLyoqXG4gKiBBc3NpZ25zIGB2YWx1ZWAgdG8gYGtleWAgb2YgYG9iamVjdGAgaWYgdGhlIGV4aXN0aW5nIHZhbHVlIGlzIG5vdCBlcXVpdmFsZW50XG4gKiB1c2luZyBbYFNhbWVWYWx1ZVplcm9gXShodHRwOi8vZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi83LjAvI3NlYy1zYW1ldmFsdWV6ZXJvKVxuICogZm9yIGVxdWFsaXR5IGNvbXBhcmlzb25zLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gbW9kaWZ5LlxuICogQHBhcmFtIHtzdHJpbmd9IGtleSBUaGUga2V5IG9mIHRoZSBwcm9wZXJ0eSB0byBhc3NpZ24uXG4gKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBhc3NpZ24uXG4gKi9cbmZ1bmN0aW9uIGFzc2lnblZhbHVlKG9iamVjdCwga2V5LCB2YWx1ZSkge1xuICB2YXIgb2JqVmFsdWUgPSBvYmplY3Rba2V5XTtcbiAgaWYgKCEoaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIGtleSkgJiYgZXEob2JqVmFsdWUsIHZhbHVlKSkgfHxcbiAgICAgICh2YWx1ZSA9PT0gdW5kZWZpbmVkICYmICEoa2V5IGluIG9iamVjdCkpKSB7XG4gICAgYmFzZUFzc2lnblZhbHVlKG9iamVjdCwga2V5LCB2YWx1ZSk7XG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBhc3NpZ25WYWx1ZTtcbiIsInZhciBlcSA9IHJlcXVpcmUoJy4vZXEnKTtcblxuLyoqXG4gKiBHZXRzIHRoZSBpbmRleCBhdCB3aGljaCB0aGUgYGtleWAgaXMgZm91bmQgaW4gYGFycmF5YCBvZiBrZXktdmFsdWUgcGFpcnMuXG4gKlxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBpbnNwZWN0LlxuICogQHBhcmFtIHsqfSBrZXkgVGhlIGtleSB0byBzZWFyY2ggZm9yLlxuICogQHJldHVybnMge251bWJlcn0gUmV0dXJucyB0aGUgaW5kZXggb2YgdGhlIG1hdGNoZWQgdmFsdWUsIGVsc2UgYC0xYC5cbiAqL1xuZnVuY3Rpb24gYXNzb2NJbmRleE9mKGFycmF5LCBrZXkpIHtcbiAgdmFyIGxlbmd0aCA9IGFycmF5Lmxlbmd0aDtcbiAgd2hpbGUgKGxlbmd0aC0tKSB7XG4gICAgaWYgKGVxKGFycmF5W2xlbmd0aF1bMF0sIGtleSkpIHtcbiAgICAgIHJldHVybiBsZW5ndGg7XG4gICAgfVxuICB9XG4gIHJldHVybiAtMTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBhc3NvY0luZGV4T2Y7XG4iLCJ2YXIgZGVmaW5lUHJvcGVydHkgPSByZXF1aXJlKCcuL19kZWZpbmVQcm9wZXJ0eScpO1xuXG4vKipcbiAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBhc3NpZ25WYWx1ZWAgYW5kIGBhc3NpZ25NZXJnZVZhbHVlYCB3aXRob3V0XG4gKiB2YWx1ZSBjaGVja3MuXG4gKlxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBtb2RpZnkuXG4gKiBAcGFyYW0ge3N0cmluZ30ga2V5IFRoZSBrZXkgb2YgdGhlIHByb3BlcnR5IHRvIGFzc2lnbi5cbiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGFzc2lnbi5cbiAqL1xuZnVuY3Rpb24gYmFzZUFzc2lnblZhbHVlKG9iamVjdCwga2V5LCB2YWx1ZSkge1xuICBpZiAoa2V5ID09ICdfX3Byb3RvX18nICYmIGRlZmluZVByb3BlcnR5KSB7XG4gICAgZGVmaW5lUHJvcGVydHkob2JqZWN0LCBrZXksIHtcbiAgICAgICdjb25maWd1cmFibGUnOiB0cnVlLFxuICAgICAgJ2VudW1lcmFibGUnOiB0cnVlLFxuICAgICAgJ3ZhbHVlJzogdmFsdWUsXG4gICAgICAnd3JpdGFibGUnOiB0cnVlXG4gICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgb2JqZWN0W2tleV0gPSB2YWx1ZTtcbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGJhc2VBc3NpZ25WYWx1ZTtcbiIsInZhciBpc09iamVjdCA9IHJlcXVpcmUoJy4vaXNPYmplY3QnKTtcblxuLyoqIEJ1aWx0LWluIHZhbHVlIHJlZmVyZW5jZXMuICovXG52YXIgb2JqZWN0Q3JlYXRlID0gT2JqZWN0LmNyZWF0ZTtcblxuLyoqXG4gKiBUaGUgYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiBgXy5jcmVhdGVgIHdpdGhvdXQgc3VwcG9ydCBmb3IgYXNzaWduaW5nXG4gKiBwcm9wZXJ0aWVzIHRvIHRoZSBjcmVhdGVkIG9iamVjdC5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtPYmplY3R9IHByb3RvIFRoZSBvYmplY3QgdG8gaW5oZXJpdCBmcm9tLlxuICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyB0aGUgbmV3IG9iamVjdC5cbiAqL1xudmFyIGJhc2VDcmVhdGUgPSAoZnVuY3Rpb24oKSB7XG4gIGZ1bmN0aW9uIG9iamVjdCgpIHt9XG4gIHJldHVybiBmdW5jdGlvbihwcm90bykge1xuICAgIGlmICghaXNPYmplY3QocHJvdG8pKSB7XG4gICAgICByZXR1cm4ge307XG4gICAgfVxuICAgIGlmIChvYmplY3RDcmVhdGUpIHtcbiAgICAgIHJldHVybiBvYmplY3RDcmVhdGUocHJvdG8pO1xuICAgIH1cbiAgICBvYmplY3QucHJvdG90eXBlID0gcHJvdG87XG4gICAgdmFyIHJlc3VsdCA9IG5ldyBvYmplY3Q7XG4gICAgb2JqZWN0LnByb3RvdHlwZSA9IHVuZGVmaW5lZDtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xufSgpKTtcblxubW9kdWxlLmV4cG9ydHMgPSBiYXNlQ3JlYXRlO1xuIiwidmFyIGNyZWF0ZUJhc2VGb3IgPSByZXF1aXJlKCcuL19jcmVhdGVCYXNlRm9yJyk7XG5cbi8qKlxuICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYGJhc2VGb3JPd25gIHdoaWNoIGl0ZXJhdGVzIG92ZXIgYG9iamVjdGBcbiAqIHByb3BlcnRpZXMgcmV0dXJuZWQgYnkgYGtleXNGdW5jYCBhbmQgaW52b2tlcyBgaXRlcmF0ZWVgIGZvciBlYWNoIHByb3BlcnR5LlxuICogSXRlcmF0ZWUgZnVuY3Rpb25zIG1heSBleGl0IGl0ZXJhdGlvbiBlYXJseSBieSBleHBsaWNpdGx5IHJldHVybmluZyBgZmFsc2VgLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gaXRlcmF0ZSBvdmVyLlxuICogQHBhcmFtIHtGdW5jdGlvbn0gaXRlcmF0ZWUgVGhlIGZ1bmN0aW9uIGludm9rZWQgcGVyIGl0ZXJhdGlvbi5cbiAqIEBwYXJhbSB7RnVuY3Rpb259IGtleXNGdW5jIFRoZSBmdW5jdGlvbiB0byBnZXQgdGhlIGtleXMgb2YgYG9iamVjdGAuXG4gKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIGBvYmplY3RgLlxuICovXG52YXIgYmFzZUZvciA9IGNyZWF0ZUJhc2VGb3IoKTtcblxubW9kdWxlLmV4cG9ydHMgPSBiYXNlRm9yO1xuIiwidmFyIFN5bWJvbCA9IHJlcXVpcmUoJy4vX1N5bWJvbCcpLFxuICAgIGdldFJhd1RhZyA9IHJlcXVpcmUoJy4vX2dldFJhd1RhZycpLFxuICAgIG9iamVjdFRvU3RyaW5nID0gcmVxdWlyZSgnLi9fb2JqZWN0VG9TdHJpbmcnKTtcblxuLyoqIGBPYmplY3QjdG9TdHJpbmdgIHJlc3VsdCByZWZlcmVuY2VzLiAqL1xudmFyIG51bGxUYWcgPSAnW29iamVjdCBOdWxsXScsXG4gICAgdW5kZWZpbmVkVGFnID0gJ1tvYmplY3QgVW5kZWZpbmVkXSc7XG5cbi8qKiBCdWlsdC1pbiB2YWx1ZSByZWZlcmVuY2VzLiAqL1xudmFyIHN5bVRvU3RyaW5nVGFnID0gU3ltYm9sID8gU3ltYm9sLnRvU3RyaW5nVGFnIDogdW5kZWZpbmVkO1xuXG4vKipcbiAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBnZXRUYWdgIHdpdGhvdXQgZmFsbGJhY2tzIGZvciBidWdneSBlbnZpcm9ubWVudHMuXG4gKlxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIHF1ZXJ5LlxuICogQHJldHVybnMge3N0cmluZ30gUmV0dXJucyB0aGUgYHRvU3RyaW5nVGFnYC5cbiAqL1xuZnVuY3Rpb24gYmFzZUdldFRhZyh2YWx1ZSkge1xuICBpZiAodmFsdWUgPT0gbnVsbCkge1xuICAgIHJldHVybiB2YWx1ZSA9PT0gdW5kZWZpbmVkID8gdW5kZWZpbmVkVGFnIDogbnVsbFRhZztcbiAgfVxuICByZXR1cm4gKHN5bVRvU3RyaW5nVGFnICYmIHN5bVRvU3RyaW5nVGFnIGluIE9iamVjdCh2YWx1ZSkpXG4gICAgPyBnZXRSYXdUYWcodmFsdWUpXG4gICAgOiBvYmplY3RUb1N0cmluZyh2YWx1ZSk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gYmFzZUdldFRhZztcbiIsInZhciBiYXNlR2V0VGFnID0gcmVxdWlyZSgnLi9fYmFzZUdldFRhZycpLFxuICAgIGlzT2JqZWN0TGlrZSA9IHJlcXVpcmUoJy4vaXNPYmplY3RMaWtlJyk7XG5cbi8qKiBgT2JqZWN0I3RvU3RyaW5nYCByZXN1bHQgcmVmZXJlbmNlcy4gKi9cbnZhciBhcmdzVGFnID0gJ1tvYmplY3QgQXJndW1lbnRzXSc7XG5cbi8qKlxuICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8uaXNBcmd1bWVudHNgLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlzIGFuIGBhcmd1bWVudHNgIG9iamVjdCxcbiAqL1xuZnVuY3Rpb24gYmFzZUlzQXJndW1lbnRzKHZhbHVlKSB7XG4gIHJldHVybiBpc09iamVjdExpa2UodmFsdWUpICYmIGJhc2VHZXRUYWcodmFsdWUpID09IGFyZ3NUYWc7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gYmFzZUlzQXJndW1lbnRzO1xuIiwidmFyIGlzRnVuY3Rpb24gPSByZXF1aXJlKCcuL2lzRnVuY3Rpb24nKSxcbiAgICBpc01hc2tlZCA9IHJlcXVpcmUoJy4vX2lzTWFza2VkJyksXG4gICAgaXNPYmplY3QgPSByZXF1aXJlKCcuL2lzT2JqZWN0JyksXG4gICAgdG9Tb3VyY2UgPSByZXF1aXJlKCcuL190b1NvdXJjZScpO1xuXG4vKipcbiAqIFVzZWQgdG8gbWF0Y2ggYFJlZ0V4cGBcbiAqIFtzeW50YXggY2hhcmFjdGVyc10oaHR0cDovL2VjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvNy4wLyNzZWMtcGF0dGVybnMpLlxuICovXG52YXIgcmVSZWdFeHBDaGFyID0gL1tcXFxcXiQuKis/KClbXFxde318XS9nO1xuXG4vKiogVXNlZCB0byBkZXRlY3QgaG9zdCBjb25zdHJ1Y3RvcnMgKFNhZmFyaSkuICovXG52YXIgcmVJc0hvc3RDdG9yID0gL15cXFtvYmplY3QgLis/Q29uc3RydWN0b3JcXF0kLztcblxuLyoqIFVzZWQgZm9yIGJ1aWx0LWluIG1ldGhvZCByZWZlcmVuY2VzLiAqL1xudmFyIGZ1bmNQcm90byA9IEZ1bmN0aW9uLnByb3RvdHlwZSxcbiAgICBvYmplY3RQcm90byA9IE9iamVjdC5wcm90b3R5cGU7XG5cbi8qKiBVc2VkIHRvIHJlc29sdmUgdGhlIGRlY29tcGlsZWQgc291cmNlIG9mIGZ1bmN0aW9ucy4gKi9cbnZhciBmdW5jVG9TdHJpbmcgPSBmdW5jUHJvdG8udG9TdHJpbmc7XG5cbi8qKiBVc2VkIHRvIGNoZWNrIG9iamVjdHMgZm9yIG93biBwcm9wZXJ0aWVzLiAqL1xudmFyIGhhc093blByb3BlcnR5ID0gb2JqZWN0UHJvdG8uaGFzT3duUHJvcGVydHk7XG5cbi8qKiBVc2VkIHRvIGRldGVjdCBpZiBhIG1ldGhvZCBpcyBuYXRpdmUuICovXG52YXIgcmVJc05hdGl2ZSA9IFJlZ0V4cCgnXicgK1xuICBmdW5jVG9TdHJpbmcuY2FsbChoYXNPd25Qcm9wZXJ0eSkucmVwbGFjZShyZVJlZ0V4cENoYXIsICdcXFxcJCYnKVxuICAucmVwbGFjZSgvaGFzT3duUHJvcGVydHl8KGZ1bmN0aW9uKS4qPyg/PVxcXFxcXCgpfCBmb3IgLis/KD89XFxcXFxcXSkvZywgJyQxLio/JykgKyAnJCdcbik7XG5cbi8qKlxuICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8uaXNOYXRpdmVgIHdpdGhvdXQgYmFkIHNoaW0gY2hlY2tzLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlzIGEgbmF0aXZlIGZ1bmN0aW9uLFxuICogIGVsc2UgYGZhbHNlYC5cbiAqL1xuZnVuY3Rpb24gYmFzZUlzTmF0aXZlKHZhbHVlKSB7XG4gIGlmICghaXNPYmplY3QodmFsdWUpIHx8IGlzTWFza2VkKHZhbHVlKSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICB2YXIgcGF0dGVybiA9IGlzRnVuY3Rpb24odmFsdWUpID8gcmVJc05hdGl2ZSA6IHJlSXNIb3N0Q3RvcjtcbiAgcmV0dXJuIHBhdHRlcm4udGVzdCh0b1NvdXJjZSh2YWx1ZSkpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGJhc2VJc05hdGl2ZTtcbiIsInZhciBiYXNlR2V0VGFnID0gcmVxdWlyZSgnLi9fYmFzZUdldFRhZycpLFxuICAgIGlzTGVuZ3RoID0gcmVxdWlyZSgnLi9pc0xlbmd0aCcpLFxuICAgIGlzT2JqZWN0TGlrZSA9IHJlcXVpcmUoJy4vaXNPYmplY3RMaWtlJyk7XG5cbi8qKiBgT2JqZWN0I3RvU3RyaW5nYCByZXN1bHQgcmVmZXJlbmNlcy4gKi9cbnZhciBhcmdzVGFnID0gJ1tvYmplY3QgQXJndW1lbnRzXScsXG4gICAgYXJyYXlUYWcgPSAnW29iamVjdCBBcnJheV0nLFxuICAgIGJvb2xUYWcgPSAnW29iamVjdCBCb29sZWFuXScsXG4gICAgZGF0ZVRhZyA9ICdbb2JqZWN0IERhdGVdJyxcbiAgICBlcnJvclRhZyA9ICdbb2JqZWN0IEVycm9yXScsXG4gICAgZnVuY1RhZyA9ICdbb2JqZWN0IEZ1bmN0aW9uXScsXG4gICAgbWFwVGFnID0gJ1tvYmplY3QgTWFwXScsXG4gICAgbnVtYmVyVGFnID0gJ1tvYmplY3QgTnVtYmVyXScsXG4gICAgb2JqZWN0VGFnID0gJ1tvYmplY3QgT2JqZWN0XScsXG4gICAgcmVnZXhwVGFnID0gJ1tvYmplY3QgUmVnRXhwXScsXG4gICAgc2V0VGFnID0gJ1tvYmplY3QgU2V0XScsXG4gICAgc3RyaW5nVGFnID0gJ1tvYmplY3QgU3RyaW5nXScsXG4gICAgd2Vha01hcFRhZyA9ICdbb2JqZWN0IFdlYWtNYXBdJztcblxudmFyIGFycmF5QnVmZmVyVGFnID0gJ1tvYmplY3QgQXJyYXlCdWZmZXJdJyxcbiAgICBkYXRhVmlld1RhZyA9ICdbb2JqZWN0IERhdGFWaWV3XScsXG4gICAgZmxvYXQzMlRhZyA9ICdbb2JqZWN0IEZsb2F0MzJBcnJheV0nLFxuICAgIGZsb2F0NjRUYWcgPSAnW29iamVjdCBGbG9hdDY0QXJyYXldJyxcbiAgICBpbnQ4VGFnID0gJ1tvYmplY3QgSW50OEFycmF5XScsXG4gICAgaW50MTZUYWcgPSAnW29iamVjdCBJbnQxNkFycmF5XScsXG4gICAgaW50MzJUYWcgPSAnW29iamVjdCBJbnQzMkFycmF5XScsXG4gICAgdWludDhUYWcgPSAnW29iamVjdCBVaW50OEFycmF5XScsXG4gICAgdWludDhDbGFtcGVkVGFnID0gJ1tvYmplY3QgVWludDhDbGFtcGVkQXJyYXldJyxcbiAgICB1aW50MTZUYWcgPSAnW29iamVjdCBVaW50MTZBcnJheV0nLFxuICAgIHVpbnQzMlRhZyA9ICdbb2JqZWN0IFVpbnQzMkFycmF5XSc7XG5cbi8qKiBVc2VkIHRvIGlkZW50aWZ5IGB0b1N0cmluZ1RhZ2AgdmFsdWVzIG9mIHR5cGVkIGFycmF5cy4gKi9cbnZhciB0eXBlZEFycmF5VGFncyA9IHt9O1xudHlwZWRBcnJheVRhZ3NbZmxvYXQzMlRhZ10gPSB0eXBlZEFycmF5VGFnc1tmbG9hdDY0VGFnXSA9XG50eXBlZEFycmF5VGFnc1tpbnQ4VGFnXSA9IHR5cGVkQXJyYXlUYWdzW2ludDE2VGFnXSA9XG50eXBlZEFycmF5VGFnc1tpbnQzMlRhZ10gPSB0eXBlZEFycmF5VGFnc1t1aW50OFRhZ10gPVxudHlwZWRBcnJheVRhZ3NbdWludDhDbGFtcGVkVGFnXSA9IHR5cGVkQXJyYXlUYWdzW3VpbnQxNlRhZ10gPVxudHlwZWRBcnJheVRhZ3NbdWludDMyVGFnXSA9IHRydWU7XG50eXBlZEFycmF5VGFnc1thcmdzVGFnXSA9IHR5cGVkQXJyYXlUYWdzW2FycmF5VGFnXSA9XG50eXBlZEFycmF5VGFnc1thcnJheUJ1ZmZlclRhZ10gPSB0eXBlZEFycmF5VGFnc1tib29sVGFnXSA9XG50eXBlZEFycmF5VGFnc1tkYXRhVmlld1RhZ10gPSB0eXBlZEFycmF5VGFnc1tkYXRlVGFnXSA9XG50eXBlZEFycmF5VGFnc1tlcnJvclRhZ10gPSB0eXBlZEFycmF5VGFnc1tmdW5jVGFnXSA9XG50eXBlZEFycmF5VGFnc1ttYXBUYWddID0gdHlwZWRBcnJheVRhZ3NbbnVtYmVyVGFnXSA9XG50eXBlZEFycmF5VGFnc1tvYmplY3RUYWddID0gdHlwZWRBcnJheVRhZ3NbcmVnZXhwVGFnXSA9XG50eXBlZEFycmF5VGFnc1tzZXRUYWddID0gdHlwZWRBcnJheVRhZ3Nbc3RyaW5nVGFnXSA9XG50eXBlZEFycmF5VGFnc1t3ZWFrTWFwVGFnXSA9IGZhbHNlO1xuXG4vKipcbiAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLmlzVHlwZWRBcnJheWAgd2l0aG91dCBOb2RlLmpzIG9wdGltaXphdGlvbnMuXG4gKlxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgYSB0eXBlZCBhcnJheSwgZWxzZSBgZmFsc2VgLlxuICovXG5mdW5jdGlvbiBiYXNlSXNUeXBlZEFycmF5KHZhbHVlKSB7XG4gIHJldHVybiBpc09iamVjdExpa2UodmFsdWUpICYmXG4gICAgaXNMZW5ndGgodmFsdWUubGVuZ3RoKSAmJiAhIXR5cGVkQXJyYXlUYWdzW2Jhc2VHZXRUYWcodmFsdWUpXTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBiYXNlSXNUeXBlZEFycmF5O1xuIiwidmFyIGlzT2JqZWN0ID0gcmVxdWlyZSgnLi9pc09iamVjdCcpLFxuICAgIGlzUHJvdG90eXBlID0gcmVxdWlyZSgnLi9faXNQcm90b3R5cGUnKSxcbiAgICBuYXRpdmVLZXlzSW4gPSByZXF1aXJlKCcuL19uYXRpdmVLZXlzSW4nKTtcblxuLyoqIFVzZWQgZm9yIGJ1aWx0LWluIG1ldGhvZCByZWZlcmVuY2VzLiAqL1xudmFyIG9iamVjdFByb3RvID0gT2JqZWN0LnByb3RvdHlwZTtcblxuLyoqIFVzZWQgdG8gY2hlY2sgb2JqZWN0cyBmb3Igb3duIHByb3BlcnRpZXMuICovXG52YXIgaGFzT3duUHJvcGVydHkgPSBvYmplY3RQcm90by5oYXNPd25Qcm9wZXJ0eTtcblxuLyoqXG4gKiBUaGUgYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiBgXy5rZXlzSW5gIHdoaWNoIGRvZXNuJ3QgdHJlYXQgc3BhcnNlIGFycmF5cyBhcyBkZW5zZS5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIHF1ZXJ5LlxuICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBhcnJheSBvZiBwcm9wZXJ0eSBuYW1lcy5cbiAqL1xuZnVuY3Rpb24gYmFzZUtleXNJbihvYmplY3QpIHtcbiAgaWYgKCFpc09iamVjdChvYmplY3QpKSB7XG4gICAgcmV0dXJuIG5hdGl2ZUtleXNJbihvYmplY3QpO1xuICB9XG4gIHZhciBpc1Byb3RvID0gaXNQcm90b3R5cGUob2JqZWN0KSxcbiAgICAgIHJlc3VsdCA9IFtdO1xuXG4gIGZvciAodmFyIGtleSBpbiBvYmplY3QpIHtcbiAgICBpZiAoIShrZXkgPT0gJ2NvbnN0cnVjdG9yJyAmJiAoaXNQcm90byB8fCAhaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIGtleSkpKSkge1xuICAgICAgcmVzdWx0LnB1c2goa2V5KTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBiYXNlS2V5c0luO1xuIiwidmFyIFN0YWNrID0gcmVxdWlyZSgnLi9fU3RhY2snKSxcbiAgICBhc3NpZ25NZXJnZVZhbHVlID0gcmVxdWlyZSgnLi9fYXNzaWduTWVyZ2VWYWx1ZScpLFxuICAgIGJhc2VGb3IgPSByZXF1aXJlKCcuL19iYXNlRm9yJyksXG4gICAgYmFzZU1lcmdlRGVlcCA9IHJlcXVpcmUoJy4vX2Jhc2VNZXJnZURlZXAnKSxcbiAgICBpc09iamVjdCA9IHJlcXVpcmUoJy4vaXNPYmplY3QnKSxcbiAgICBrZXlzSW4gPSByZXF1aXJlKCcuL2tleXNJbicpLFxuICAgIHNhZmVHZXQgPSByZXF1aXJlKCcuL19zYWZlR2V0Jyk7XG5cbi8qKlxuICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8ubWVyZ2VgIHdpdGhvdXQgc3VwcG9ydCBmb3IgbXVsdGlwbGUgc291cmNlcy5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgZGVzdGluYXRpb24gb2JqZWN0LlxuICogQHBhcmFtIHtPYmplY3R9IHNvdXJjZSBUaGUgc291cmNlIG9iamVjdC5cbiAqIEBwYXJhbSB7bnVtYmVyfSBzcmNJbmRleCBUaGUgaW5kZXggb2YgYHNvdXJjZWAuXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY3VzdG9taXplcl0gVGhlIGZ1bmN0aW9uIHRvIGN1c3RvbWl6ZSBtZXJnZWQgdmFsdWVzLlxuICogQHBhcmFtIHtPYmplY3R9IFtzdGFja10gVHJhY2tzIHRyYXZlcnNlZCBzb3VyY2UgdmFsdWVzIGFuZCB0aGVpciBtZXJnZWRcbiAqICBjb3VudGVycGFydHMuXG4gKi9cbmZ1bmN0aW9uIGJhc2VNZXJnZShvYmplY3QsIHNvdXJjZSwgc3JjSW5kZXgsIGN1c3RvbWl6ZXIsIHN0YWNrKSB7XG4gIGlmIChvYmplY3QgPT09IHNvdXJjZSkge1xuICAgIHJldHVybjtcbiAgfVxuICBiYXNlRm9yKHNvdXJjZSwgZnVuY3Rpb24oc3JjVmFsdWUsIGtleSkge1xuICAgIGlmIChpc09iamVjdChzcmNWYWx1ZSkpIHtcbiAgICAgIHN0YWNrIHx8IChzdGFjayA9IG5ldyBTdGFjayk7XG4gICAgICBiYXNlTWVyZ2VEZWVwKG9iamVjdCwgc291cmNlLCBrZXksIHNyY0luZGV4LCBiYXNlTWVyZ2UsIGN1c3RvbWl6ZXIsIHN0YWNrKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICB2YXIgbmV3VmFsdWUgPSBjdXN0b21pemVyXG4gICAgICAgID8gY3VzdG9taXplcihzYWZlR2V0KG9iamVjdCwga2V5KSwgc3JjVmFsdWUsIChrZXkgKyAnJyksIG9iamVjdCwgc291cmNlLCBzdGFjaylcbiAgICAgICAgOiB1bmRlZmluZWQ7XG5cbiAgICAgIGlmIChuZXdWYWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIG5ld1ZhbHVlID0gc3JjVmFsdWU7XG4gICAgICB9XG4gICAgICBhc3NpZ25NZXJnZVZhbHVlKG9iamVjdCwga2V5LCBuZXdWYWx1ZSk7XG4gICAgfVxuICB9LCBrZXlzSW4pO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGJhc2VNZXJnZTtcbiIsInZhciBhc3NpZ25NZXJnZVZhbHVlID0gcmVxdWlyZSgnLi9fYXNzaWduTWVyZ2VWYWx1ZScpLFxuICAgIGNsb25lQnVmZmVyID0gcmVxdWlyZSgnLi9fY2xvbmVCdWZmZXInKSxcbiAgICBjbG9uZVR5cGVkQXJyYXkgPSByZXF1aXJlKCcuL19jbG9uZVR5cGVkQXJyYXknKSxcbiAgICBjb3B5QXJyYXkgPSByZXF1aXJlKCcuL19jb3B5QXJyYXknKSxcbiAgICBpbml0Q2xvbmVPYmplY3QgPSByZXF1aXJlKCcuL19pbml0Q2xvbmVPYmplY3QnKSxcbiAgICBpc0FyZ3VtZW50cyA9IHJlcXVpcmUoJy4vaXNBcmd1bWVudHMnKSxcbiAgICBpc0FycmF5ID0gcmVxdWlyZSgnLi9pc0FycmF5JyksXG4gICAgaXNBcnJheUxpa2VPYmplY3QgPSByZXF1aXJlKCcuL2lzQXJyYXlMaWtlT2JqZWN0JyksXG4gICAgaXNCdWZmZXIgPSByZXF1aXJlKCcuL2lzQnVmZmVyJyksXG4gICAgaXNGdW5jdGlvbiA9IHJlcXVpcmUoJy4vaXNGdW5jdGlvbicpLFxuICAgIGlzT2JqZWN0ID0gcmVxdWlyZSgnLi9pc09iamVjdCcpLFxuICAgIGlzUGxhaW5PYmplY3QgPSByZXF1aXJlKCcuL2lzUGxhaW5PYmplY3QnKSxcbiAgICBpc1R5cGVkQXJyYXkgPSByZXF1aXJlKCcuL2lzVHlwZWRBcnJheScpLFxuICAgIHNhZmVHZXQgPSByZXF1aXJlKCcuL19zYWZlR2V0JyksXG4gICAgdG9QbGFpbk9iamVjdCA9IHJlcXVpcmUoJy4vdG9QbGFpbk9iamVjdCcpO1xuXG4vKipcbiAqIEEgc3BlY2lhbGl6ZWQgdmVyc2lvbiBvZiBgYmFzZU1lcmdlYCBmb3IgYXJyYXlzIGFuZCBvYmplY3RzIHdoaWNoIHBlcmZvcm1zXG4gKiBkZWVwIG1lcmdlcyBhbmQgdHJhY2tzIHRyYXZlcnNlZCBvYmplY3RzIGVuYWJsaW5nIG9iamVjdHMgd2l0aCBjaXJjdWxhclxuICogcmVmZXJlbmNlcyB0byBiZSBtZXJnZWQuXG4gKlxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIGRlc3RpbmF0aW9uIG9iamVjdC5cbiAqIEBwYXJhbSB7T2JqZWN0fSBzb3VyY2UgVGhlIHNvdXJjZSBvYmplY3QuXG4gKiBAcGFyYW0ge3N0cmluZ30ga2V5IFRoZSBrZXkgb2YgdGhlIHZhbHVlIHRvIG1lcmdlLlxuICogQHBhcmFtIHtudW1iZXJ9IHNyY0luZGV4IFRoZSBpbmRleCBvZiBgc291cmNlYC5cbiAqIEBwYXJhbSB7RnVuY3Rpb259IG1lcmdlRnVuYyBUaGUgZnVuY3Rpb24gdG8gbWVyZ2UgdmFsdWVzLlxuICogQHBhcmFtIHtGdW5jdGlvbn0gW2N1c3RvbWl6ZXJdIFRoZSBmdW5jdGlvbiB0byBjdXN0b21pemUgYXNzaWduZWQgdmFsdWVzLlxuICogQHBhcmFtIHtPYmplY3R9IFtzdGFja10gVHJhY2tzIHRyYXZlcnNlZCBzb3VyY2UgdmFsdWVzIGFuZCB0aGVpciBtZXJnZWRcbiAqICBjb3VudGVycGFydHMuXG4gKi9cbmZ1bmN0aW9uIGJhc2VNZXJnZURlZXAob2JqZWN0LCBzb3VyY2UsIGtleSwgc3JjSW5kZXgsIG1lcmdlRnVuYywgY3VzdG9taXplciwgc3RhY2spIHtcbiAgdmFyIG9ialZhbHVlID0gc2FmZUdldChvYmplY3QsIGtleSksXG4gICAgICBzcmNWYWx1ZSA9IHNhZmVHZXQoc291cmNlLCBrZXkpLFxuICAgICAgc3RhY2tlZCA9IHN0YWNrLmdldChzcmNWYWx1ZSk7XG5cbiAgaWYgKHN0YWNrZWQpIHtcbiAgICBhc3NpZ25NZXJnZVZhbHVlKG9iamVjdCwga2V5LCBzdGFja2VkKTtcbiAgICByZXR1cm47XG4gIH1cbiAgdmFyIG5ld1ZhbHVlID0gY3VzdG9taXplclxuICAgID8gY3VzdG9taXplcihvYmpWYWx1ZSwgc3JjVmFsdWUsIChrZXkgKyAnJyksIG9iamVjdCwgc291cmNlLCBzdGFjaylcbiAgICA6IHVuZGVmaW5lZDtcblxuICB2YXIgaXNDb21tb24gPSBuZXdWYWx1ZSA9PT0gdW5kZWZpbmVkO1xuXG4gIGlmIChpc0NvbW1vbikge1xuICAgIHZhciBpc0FyciA9IGlzQXJyYXkoc3JjVmFsdWUpLFxuICAgICAgICBpc0J1ZmYgPSAhaXNBcnIgJiYgaXNCdWZmZXIoc3JjVmFsdWUpLFxuICAgICAgICBpc1R5cGVkID0gIWlzQXJyICYmICFpc0J1ZmYgJiYgaXNUeXBlZEFycmF5KHNyY1ZhbHVlKTtcblxuICAgIG5ld1ZhbHVlID0gc3JjVmFsdWU7XG4gICAgaWYgKGlzQXJyIHx8IGlzQnVmZiB8fCBpc1R5cGVkKSB7XG4gICAgICBpZiAoaXNBcnJheShvYmpWYWx1ZSkpIHtcbiAgICAgICAgbmV3VmFsdWUgPSBvYmpWYWx1ZTtcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKGlzQXJyYXlMaWtlT2JqZWN0KG9ialZhbHVlKSkge1xuICAgICAgICBuZXdWYWx1ZSA9IGNvcHlBcnJheShvYmpWYWx1ZSk7XG4gICAgICB9XG4gICAgICBlbHNlIGlmIChpc0J1ZmYpIHtcbiAgICAgICAgaXNDb21tb24gPSBmYWxzZTtcbiAgICAgICAgbmV3VmFsdWUgPSBjbG9uZUJ1ZmZlcihzcmNWYWx1ZSwgdHJ1ZSk7XG4gICAgICB9XG4gICAgICBlbHNlIGlmIChpc1R5cGVkKSB7XG4gICAgICAgIGlzQ29tbW9uID0gZmFsc2U7XG4gICAgICAgIG5ld1ZhbHVlID0gY2xvbmVUeXBlZEFycmF5KHNyY1ZhbHVlLCB0cnVlKTtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICBuZXdWYWx1ZSA9IFtdO1xuICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChpc1BsYWluT2JqZWN0KHNyY1ZhbHVlKSB8fCBpc0FyZ3VtZW50cyhzcmNWYWx1ZSkpIHtcbiAgICAgIG5ld1ZhbHVlID0gb2JqVmFsdWU7XG4gICAgICBpZiAoaXNBcmd1bWVudHMob2JqVmFsdWUpKSB7XG4gICAgICAgIG5ld1ZhbHVlID0gdG9QbGFpbk9iamVjdChvYmpWYWx1ZSk7XG4gICAgICB9XG4gICAgICBlbHNlIGlmICghaXNPYmplY3Qob2JqVmFsdWUpIHx8IChzcmNJbmRleCAmJiBpc0Z1bmN0aW9uKG9ialZhbHVlKSkpIHtcbiAgICAgICAgbmV3VmFsdWUgPSBpbml0Q2xvbmVPYmplY3Qoc3JjVmFsdWUpO1xuICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIGlzQ29tbW9uID0gZmFsc2U7XG4gICAgfVxuICB9XG4gIGlmIChpc0NvbW1vbikge1xuICAgIC8vIFJlY3Vyc2l2ZWx5IG1lcmdlIG9iamVjdHMgYW5kIGFycmF5cyAoc3VzY2VwdGlibGUgdG8gY2FsbCBzdGFjayBsaW1pdHMpLlxuICAgIHN0YWNrLnNldChzcmNWYWx1ZSwgbmV3VmFsdWUpO1xuICAgIG1lcmdlRnVuYyhuZXdWYWx1ZSwgc3JjVmFsdWUsIHNyY0luZGV4LCBjdXN0b21pemVyLCBzdGFjayk7XG4gICAgc3RhY2tbJ2RlbGV0ZSddKHNyY1ZhbHVlKTtcbiAgfVxuICBhc3NpZ25NZXJnZVZhbHVlKG9iamVjdCwga2V5LCBuZXdWYWx1ZSk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gYmFzZU1lcmdlRGVlcDtcbiIsInZhciBpZGVudGl0eSA9IHJlcXVpcmUoJy4vaWRlbnRpdHknKSxcbiAgICBvdmVyUmVzdCA9IHJlcXVpcmUoJy4vX292ZXJSZXN0JyksXG4gICAgc2V0VG9TdHJpbmcgPSByZXF1aXJlKCcuL19zZXRUb1N0cmluZycpO1xuXG4vKipcbiAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLnJlc3RgIHdoaWNoIGRvZXNuJ3QgdmFsaWRhdGUgb3IgY29lcmNlIGFyZ3VtZW50cy5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuYyBUaGUgZnVuY3Rpb24gdG8gYXBwbHkgYSByZXN0IHBhcmFtZXRlciB0by5cbiAqIEBwYXJhbSB7bnVtYmVyfSBbc3RhcnQ9ZnVuYy5sZW5ndGgtMV0gVGhlIHN0YXJ0IHBvc2l0aW9uIG9mIHRoZSByZXN0IHBhcmFtZXRlci5cbiAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgbmV3IGZ1bmN0aW9uLlxuICovXG5mdW5jdGlvbiBiYXNlUmVzdChmdW5jLCBzdGFydCkge1xuICByZXR1cm4gc2V0VG9TdHJpbmcob3ZlclJlc3QoZnVuYywgc3RhcnQsIGlkZW50aXR5KSwgZnVuYyArICcnKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBiYXNlUmVzdDtcbiIsInZhciBjb25zdGFudCA9IHJlcXVpcmUoJy4vY29uc3RhbnQnKSxcbiAgICBkZWZpbmVQcm9wZXJ0eSA9IHJlcXVpcmUoJy4vX2RlZmluZVByb3BlcnR5JyksXG4gICAgaWRlbnRpdHkgPSByZXF1aXJlKCcuL2lkZW50aXR5Jyk7XG5cbi8qKlxuICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYHNldFRvU3RyaW5nYCB3aXRob3V0IHN1cHBvcnQgZm9yIGhvdCBsb29wIHNob3J0aW5nLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBmdW5jIFRoZSBmdW5jdGlvbiB0byBtb2RpZnkuXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBzdHJpbmcgVGhlIGB0b1N0cmluZ2AgcmVzdWx0LlxuICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIGBmdW5jYC5cbiAqL1xudmFyIGJhc2VTZXRUb1N0cmluZyA9ICFkZWZpbmVQcm9wZXJ0eSA/IGlkZW50aXR5IDogZnVuY3Rpb24oZnVuYywgc3RyaW5nKSB7XG4gIHJldHVybiBkZWZpbmVQcm9wZXJ0eShmdW5jLCAndG9TdHJpbmcnLCB7XG4gICAgJ2NvbmZpZ3VyYWJsZSc6IHRydWUsXG4gICAgJ2VudW1lcmFibGUnOiBmYWxzZSxcbiAgICAndmFsdWUnOiBjb25zdGFudChzdHJpbmcpLFxuICAgICd3cml0YWJsZSc6IHRydWVcbiAgfSk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGJhc2VTZXRUb1N0cmluZztcbiIsIi8qKlxuICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8udGltZXNgIHdpdGhvdXQgc3VwcG9ydCBmb3IgaXRlcmF0ZWUgc2hvcnRoYW5kc1xuICogb3IgbWF4IGFycmF5IGxlbmd0aCBjaGVja3MuXG4gKlxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7bnVtYmVyfSBuIFRoZSBudW1iZXIgb2YgdGltZXMgdG8gaW52b2tlIGBpdGVyYXRlZWAuXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBpdGVyYXRlZSBUaGUgZnVuY3Rpb24gaW52b2tlZCBwZXIgaXRlcmF0aW9uLlxuICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBhcnJheSBvZiByZXN1bHRzLlxuICovXG5mdW5jdGlvbiBiYXNlVGltZXMobiwgaXRlcmF0ZWUpIHtcbiAgdmFyIGluZGV4ID0gLTEsXG4gICAgICByZXN1bHQgPSBBcnJheShuKTtcblxuICB3aGlsZSAoKytpbmRleCA8IG4pIHtcbiAgICByZXN1bHRbaW5kZXhdID0gaXRlcmF0ZWUoaW5kZXgpO1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gYmFzZVRpbWVzO1xuIiwiLyoqXG4gKiBUaGUgYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiBgXy51bmFyeWAgd2l0aG91dCBzdXBwb3J0IGZvciBzdG9yaW5nIG1ldGFkYXRhLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBmdW5jIFRoZSBmdW5jdGlvbiB0byBjYXAgYXJndW1lbnRzIGZvci5cbiAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgbmV3IGNhcHBlZCBmdW5jdGlvbi5cbiAqL1xuZnVuY3Rpb24gYmFzZVVuYXJ5KGZ1bmMpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgcmV0dXJuIGZ1bmModmFsdWUpO1xuICB9O1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGJhc2VVbmFyeTtcbiIsInZhciBVaW50OEFycmF5ID0gcmVxdWlyZSgnLi9fVWludDhBcnJheScpO1xuXG4vKipcbiAqIENyZWF0ZXMgYSBjbG9uZSBvZiBgYXJyYXlCdWZmZXJgLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0ge0FycmF5QnVmZmVyfSBhcnJheUJ1ZmZlciBUaGUgYXJyYXkgYnVmZmVyIHRvIGNsb25lLlxuICogQHJldHVybnMge0FycmF5QnVmZmVyfSBSZXR1cm5zIHRoZSBjbG9uZWQgYXJyYXkgYnVmZmVyLlxuICovXG5mdW5jdGlvbiBjbG9uZUFycmF5QnVmZmVyKGFycmF5QnVmZmVyKSB7XG4gIHZhciByZXN1bHQgPSBuZXcgYXJyYXlCdWZmZXIuY29uc3RydWN0b3IoYXJyYXlCdWZmZXIuYnl0ZUxlbmd0aCk7XG4gIG5ldyBVaW50OEFycmF5KHJlc3VsdCkuc2V0KG5ldyBVaW50OEFycmF5KGFycmF5QnVmZmVyKSk7XG4gIHJldHVybiByZXN1bHQ7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gY2xvbmVBcnJheUJ1ZmZlcjtcbiIsInZhciByb290ID0gcmVxdWlyZSgnLi9fcm9vdCcpO1xuXG4vKiogRGV0ZWN0IGZyZWUgdmFyaWFibGUgYGV4cG9ydHNgLiAqL1xudmFyIGZyZWVFeHBvcnRzID0gdHlwZW9mIGV4cG9ydHMgPT0gJ29iamVjdCcgJiYgZXhwb3J0cyAmJiAhZXhwb3J0cy5ub2RlVHlwZSAmJiBleHBvcnRzO1xuXG4vKiogRGV0ZWN0IGZyZWUgdmFyaWFibGUgYG1vZHVsZWAuICovXG52YXIgZnJlZU1vZHVsZSA9IGZyZWVFeHBvcnRzICYmIHR5cGVvZiBtb2R1bGUgPT0gJ29iamVjdCcgJiYgbW9kdWxlICYmICFtb2R1bGUubm9kZVR5cGUgJiYgbW9kdWxlO1xuXG4vKiogRGV0ZWN0IHRoZSBwb3B1bGFyIENvbW1vbkpTIGV4dGVuc2lvbiBgbW9kdWxlLmV4cG9ydHNgLiAqL1xudmFyIG1vZHVsZUV4cG9ydHMgPSBmcmVlTW9kdWxlICYmIGZyZWVNb2R1bGUuZXhwb3J0cyA9PT0gZnJlZUV4cG9ydHM7XG5cbi8qKiBCdWlsdC1pbiB2YWx1ZSByZWZlcmVuY2VzLiAqL1xudmFyIEJ1ZmZlciA9IG1vZHVsZUV4cG9ydHMgPyByb290LkJ1ZmZlciA6IHVuZGVmaW5lZCxcbiAgICBhbGxvY1Vuc2FmZSA9IEJ1ZmZlciA/IEJ1ZmZlci5hbGxvY1Vuc2FmZSA6IHVuZGVmaW5lZDtcblxuLyoqXG4gKiBDcmVhdGVzIGEgY2xvbmUgb2YgIGBidWZmZXJgLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0ge0J1ZmZlcn0gYnVmZmVyIFRoZSBidWZmZXIgdG8gY2xvbmUuXG4gKiBAcGFyYW0ge2Jvb2xlYW59IFtpc0RlZXBdIFNwZWNpZnkgYSBkZWVwIGNsb25lLlxuICogQHJldHVybnMge0J1ZmZlcn0gUmV0dXJucyB0aGUgY2xvbmVkIGJ1ZmZlci5cbiAqL1xuZnVuY3Rpb24gY2xvbmVCdWZmZXIoYnVmZmVyLCBpc0RlZXApIHtcbiAgaWYgKGlzRGVlcCkge1xuICAgIHJldHVybiBidWZmZXIuc2xpY2UoKTtcbiAgfVxuICB2YXIgbGVuZ3RoID0gYnVmZmVyLmxlbmd0aCxcbiAgICAgIHJlc3VsdCA9IGFsbG9jVW5zYWZlID8gYWxsb2NVbnNhZmUobGVuZ3RoKSA6IG5ldyBidWZmZXIuY29uc3RydWN0b3IobGVuZ3RoKTtcblxuICBidWZmZXIuY29weShyZXN1bHQpO1xuICByZXR1cm4gcmVzdWx0O1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGNsb25lQnVmZmVyO1xuIiwidmFyIGNsb25lQXJyYXlCdWZmZXIgPSByZXF1aXJlKCcuL19jbG9uZUFycmF5QnVmZmVyJyk7XG5cbi8qKlxuICogQ3JlYXRlcyBhIGNsb25lIG9mIGB0eXBlZEFycmF5YC5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtPYmplY3R9IHR5cGVkQXJyYXkgVGhlIHR5cGVkIGFycmF5IHRvIGNsb25lLlxuICogQHBhcmFtIHtib29sZWFufSBbaXNEZWVwXSBTcGVjaWZ5IGEgZGVlcCBjbG9uZS5cbiAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgdGhlIGNsb25lZCB0eXBlZCBhcnJheS5cbiAqL1xuZnVuY3Rpb24gY2xvbmVUeXBlZEFycmF5KHR5cGVkQXJyYXksIGlzRGVlcCkge1xuICB2YXIgYnVmZmVyID0gaXNEZWVwID8gY2xvbmVBcnJheUJ1ZmZlcih0eXBlZEFycmF5LmJ1ZmZlcikgOiB0eXBlZEFycmF5LmJ1ZmZlcjtcbiAgcmV0dXJuIG5ldyB0eXBlZEFycmF5LmNvbnN0cnVjdG9yKGJ1ZmZlciwgdHlwZWRBcnJheS5ieXRlT2Zmc2V0LCB0eXBlZEFycmF5Lmxlbmd0aCk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gY2xvbmVUeXBlZEFycmF5O1xuIiwiLyoqXG4gKiBDb3BpZXMgdGhlIHZhbHVlcyBvZiBgc291cmNlYCB0byBgYXJyYXlgLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0ge0FycmF5fSBzb3VyY2UgVGhlIGFycmF5IHRvIGNvcHkgdmFsdWVzIGZyb20uXG4gKiBAcGFyYW0ge0FycmF5fSBbYXJyYXk9W11dIFRoZSBhcnJheSB0byBjb3B5IHZhbHVlcyB0by5cbiAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyBgYXJyYXlgLlxuICovXG5mdW5jdGlvbiBjb3B5QXJyYXkoc291cmNlLCBhcnJheSkge1xuICB2YXIgaW5kZXggPSAtMSxcbiAgICAgIGxlbmd0aCA9IHNvdXJjZS5sZW5ndGg7XG5cbiAgYXJyYXkgfHwgKGFycmF5ID0gQXJyYXkobGVuZ3RoKSk7XG4gIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgYXJyYXlbaW5kZXhdID0gc291cmNlW2luZGV4XTtcbiAgfVxuICByZXR1cm4gYXJyYXk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gY29weUFycmF5O1xuIiwidmFyIGFzc2lnblZhbHVlID0gcmVxdWlyZSgnLi9fYXNzaWduVmFsdWUnKSxcbiAgICBiYXNlQXNzaWduVmFsdWUgPSByZXF1aXJlKCcuL19iYXNlQXNzaWduVmFsdWUnKTtcblxuLyoqXG4gKiBDb3BpZXMgcHJvcGVydGllcyBvZiBgc291cmNlYCB0byBgb2JqZWN0YC5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtPYmplY3R9IHNvdXJjZSBUaGUgb2JqZWN0IHRvIGNvcHkgcHJvcGVydGllcyBmcm9tLlxuICogQHBhcmFtIHtBcnJheX0gcHJvcHMgVGhlIHByb3BlcnR5IGlkZW50aWZpZXJzIHRvIGNvcHkuXG4gKiBAcGFyYW0ge09iamVjdH0gW29iamVjdD17fV0gVGhlIG9iamVjdCB0byBjb3B5IHByb3BlcnRpZXMgdG8uXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY3VzdG9taXplcl0gVGhlIGZ1bmN0aW9uIHRvIGN1c3RvbWl6ZSBjb3BpZWQgdmFsdWVzLlxuICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyBgb2JqZWN0YC5cbiAqL1xuZnVuY3Rpb24gY29weU9iamVjdChzb3VyY2UsIHByb3BzLCBvYmplY3QsIGN1c3RvbWl6ZXIpIHtcbiAgdmFyIGlzTmV3ID0gIW9iamVjdDtcbiAgb2JqZWN0IHx8IChvYmplY3QgPSB7fSk7XG5cbiAgdmFyIGluZGV4ID0gLTEsXG4gICAgICBsZW5ndGggPSBwcm9wcy5sZW5ndGg7XG5cbiAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICB2YXIga2V5ID0gcHJvcHNbaW5kZXhdO1xuXG4gICAgdmFyIG5ld1ZhbHVlID0gY3VzdG9taXplclxuICAgICAgPyBjdXN0b21pemVyKG9iamVjdFtrZXldLCBzb3VyY2Vba2V5XSwga2V5LCBvYmplY3QsIHNvdXJjZSlcbiAgICAgIDogdW5kZWZpbmVkO1xuXG4gICAgaWYgKG5ld1ZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgIG5ld1ZhbHVlID0gc291cmNlW2tleV07XG4gICAgfVxuICAgIGlmIChpc05ldykge1xuICAgICAgYmFzZUFzc2lnblZhbHVlKG9iamVjdCwga2V5LCBuZXdWYWx1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGFzc2lnblZhbHVlKG9iamVjdCwga2V5LCBuZXdWYWx1ZSk7XG4gICAgfVxuICB9XG4gIHJldHVybiBvYmplY3Q7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gY29weU9iamVjdDtcbiIsInZhciByb290ID0gcmVxdWlyZSgnLi9fcm9vdCcpO1xuXG4vKiogVXNlZCB0byBkZXRlY3Qgb3ZlcnJlYWNoaW5nIGNvcmUtanMgc2hpbXMuICovXG52YXIgY29yZUpzRGF0YSA9IHJvb3RbJ19fY29yZS1qc19zaGFyZWRfXyddO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGNvcmVKc0RhdGE7XG4iLCJ2YXIgYmFzZVJlc3QgPSByZXF1aXJlKCcuL19iYXNlUmVzdCcpLFxuICAgIGlzSXRlcmF0ZWVDYWxsID0gcmVxdWlyZSgnLi9faXNJdGVyYXRlZUNhbGwnKTtcblxuLyoqXG4gKiBDcmVhdGVzIGEgZnVuY3Rpb24gbGlrZSBgXy5hc3NpZ25gLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBhc3NpZ25lciBUaGUgZnVuY3Rpb24gdG8gYXNzaWduIHZhbHVlcy5cbiAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgbmV3IGFzc2lnbmVyIGZ1bmN0aW9uLlxuICovXG5mdW5jdGlvbiBjcmVhdGVBc3NpZ25lcihhc3NpZ25lcikge1xuICByZXR1cm4gYmFzZVJlc3QoZnVuY3Rpb24ob2JqZWN0LCBzb3VyY2VzKSB7XG4gICAgdmFyIGluZGV4ID0gLTEsXG4gICAgICAgIGxlbmd0aCA9IHNvdXJjZXMubGVuZ3RoLFxuICAgICAgICBjdXN0b21pemVyID0gbGVuZ3RoID4gMSA/IHNvdXJjZXNbbGVuZ3RoIC0gMV0gOiB1bmRlZmluZWQsXG4gICAgICAgIGd1YXJkID0gbGVuZ3RoID4gMiA/IHNvdXJjZXNbMl0gOiB1bmRlZmluZWQ7XG5cbiAgICBjdXN0b21pemVyID0gKGFzc2lnbmVyLmxlbmd0aCA+IDMgJiYgdHlwZW9mIGN1c3RvbWl6ZXIgPT0gJ2Z1bmN0aW9uJylcbiAgICAgID8gKGxlbmd0aC0tLCBjdXN0b21pemVyKVxuICAgICAgOiB1bmRlZmluZWQ7XG5cbiAgICBpZiAoZ3VhcmQgJiYgaXNJdGVyYXRlZUNhbGwoc291cmNlc1swXSwgc291cmNlc1sxXSwgZ3VhcmQpKSB7XG4gICAgICBjdXN0b21pemVyID0gbGVuZ3RoIDwgMyA/IHVuZGVmaW5lZCA6IGN1c3RvbWl6ZXI7XG4gICAgICBsZW5ndGggPSAxO1xuICAgIH1cbiAgICBvYmplY3QgPSBPYmplY3Qob2JqZWN0KTtcbiAgICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuICAgICAgdmFyIHNvdXJjZSA9IHNvdXJjZXNbaW5kZXhdO1xuICAgICAgaWYgKHNvdXJjZSkge1xuICAgICAgICBhc3NpZ25lcihvYmplY3QsIHNvdXJjZSwgaW5kZXgsIGN1c3RvbWl6ZXIpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gb2JqZWN0O1xuICB9KTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBjcmVhdGVBc3NpZ25lcjtcbiIsIi8qKlxuICogQ3JlYXRlcyBhIGJhc2UgZnVuY3Rpb24gZm9yIG1ldGhvZHMgbGlrZSBgXy5mb3JJbmAgYW5kIGBfLmZvck93bmAuXG4gKlxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gW2Zyb21SaWdodF0gU3BlY2lmeSBpdGVyYXRpbmcgZnJvbSByaWdodCB0byBsZWZ0LlxuICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgYmFzZSBmdW5jdGlvbi5cbiAqL1xuZnVuY3Rpb24gY3JlYXRlQmFzZUZvcihmcm9tUmlnaHQpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKG9iamVjdCwgaXRlcmF0ZWUsIGtleXNGdW5jKSB7XG4gICAgdmFyIGluZGV4ID0gLTEsXG4gICAgICAgIGl0ZXJhYmxlID0gT2JqZWN0KG9iamVjdCksXG4gICAgICAgIHByb3BzID0ga2V5c0Z1bmMob2JqZWN0KSxcbiAgICAgICAgbGVuZ3RoID0gcHJvcHMubGVuZ3RoO1xuXG4gICAgd2hpbGUgKGxlbmd0aC0tKSB7XG4gICAgICB2YXIga2V5ID0gcHJvcHNbZnJvbVJpZ2h0ID8gbGVuZ3RoIDogKytpbmRleF07XG4gICAgICBpZiAoaXRlcmF0ZWUoaXRlcmFibGVba2V5XSwga2V5LCBpdGVyYWJsZSkgPT09IGZhbHNlKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gb2JqZWN0O1xuICB9O1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGNyZWF0ZUJhc2VGb3I7XG4iLCJ2YXIgZ2V0TmF0aXZlID0gcmVxdWlyZSgnLi9fZ2V0TmF0aXZlJyk7XG5cbnZhciBkZWZpbmVQcm9wZXJ0eSA9IChmdW5jdGlvbigpIHtcbiAgdHJ5IHtcbiAgICB2YXIgZnVuYyA9IGdldE5hdGl2ZShPYmplY3QsICdkZWZpbmVQcm9wZXJ0eScpO1xuICAgIGZ1bmMoe30sICcnLCB7fSk7XG4gICAgcmV0dXJuIGZ1bmM7XG4gIH0gY2F0Y2ggKGUpIHt9XG59KCkpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGRlZmluZVByb3BlcnR5O1xuIiwiLyoqIERldGVjdCBmcmVlIHZhcmlhYmxlIGBnbG9iYWxgIGZyb20gTm9kZS5qcy4gKi9cbnZhciBmcmVlR2xvYmFsID0gdHlwZW9mIGdsb2JhbCA9PSAnb2JqZWN0JyAmJiBnbG9iYWwgJiYgZ2xvYmFsLk9iamVjdCA9PT0gT2JqZWN0ICYmIGdsb2JhbDtcblxubW9kdWxlLmV4cG9ydHMgPSBmcmVlR2xvYmFsO1xuIiwidmFyIGlzS2V5YWJsZSA9IHJlcXVpcmUoJy4vX2lzS2V5YWJsZScpO1xuXG4vKipcbiAqIEdldHMgdGhlIGRhdGEgZm9yIGBtYXBgLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0ge09iamVjdH0gbWFwIFRoZSBtYXAgdG8gcXVlcnkuXG4gKiBAcGFyYW0ge3N0cmluZ30ga2V5IFRoZSByZWZlcmVuY2Uga2V5LlxuICogQHJldHVybnMgeyp9IFJldHVybnMgdGhlIG1hcCBkYXRhLlxuICovXG5mdW5jdGlvbiBnZXRNYXBEYXRhKG1hcCwga2V5KSB7XG4gIHZhciBkYXRhID0gbWFwLl9fZGF0YV9fO1xuICByZXR1cm4gaXNLZXlhYmxlKGtleSlcbiAgICA/IGRhdGFbdHlwZW9mIGtleSA9PSAnc3RyaW5nJyA/ICdzdHJpbmcnIDogJ2hhc2gnXVxuICAgIDogZGF0YS5tYXA7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gZ2V0TWFwRGF0YTtcbiIsInZhciBiYXNlSXNOYXRpdmUgPSByZXF1aXJlKCcuL19iYXNlSXNOYXRpdmUnKSxcbiAgICBnZXRWYWx1ZSA9IHJlcXVpcmUoJy4vX2dldFZhbHVlJyk7XG5cbi8qKlxuICogR2V0cyB0aGUgbmF0aXZlIGZ1bmN0aW9uIGF0IGBrZXlgIG9mIGBvYmplY3RgLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gcXVlcnkuXG4gKiBAcGFyYW0ge3N0cmluZ30ga2V5IFRoZSBrZXkgb2YgdGhlIG1ldGhvZCB0byBnZXQuXG4gKiBAcmV0dXJucyB7Kn0gUmV0dXJucyB0aGUgZnVuY3Rpb24gaWYgaXQncyBuYXRpdmUsIGVsc2UgYHVuZGVmaW5lZGAuXG4gKi9cbmZ1bmN0aW9uIGdldE5hdGl2ZShvYmplY3QsIGtleSkge1xuICB2YXIgdmFsdWUgPSBnZXRWYWx1ZShvYmplY3QsIGtleSk7XG4gIHJldHVybiBiYXNlSXNOYXRpdmUodmFsdWUpID8gdmFsdWUgOiB1bmRlZmluZWQ7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gZ2V0TmF0aXZlO1xuIiwidmFyIG92ZXJBcmcgPSByZXF1aXJlKCcuL19vdmVyQXJnJyk7XG5cbi8qKiBCdWlsdC1pbiB2YWx1ZSByZWZlcmVuY2VzLiAqL1xudmFyIGdldFByb3RvdHlwZSA9IG92ZXJBcmcoT2JqZWN0LmdldFByb3RvdHlwZU9mLCBPYmplY3QpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGdldFByb3RvdHlwZTtcbiIsInZhciBTeW1ib2wgPSByZXF1aXJlKCcuL19TeW1ib2wnKTtcblxuLyoqIFVzZWQgZm9yIGJ1aWx0LWluIG1ldGhvZCByZWZlcmVuY2VzLiAqL1xudmFyIG9iamVjdFByb3RvID0gT2JqZWN0LnByb3RvdHlwZTtcblxuLyoqIFVzZWQgdG8gY2hlY2sgb2JqZWN0cyBmb3Igb3duIHByb3BlcnRpZXMuICovXG52YXIgaGFzT3duUHJvcGVydHkgPSBvYmplY3RQcm90by5oYXNPd25Qcm9wZXJ0eTtcblxuLyoqXG4gKiBVc2VkIHRvIHJlc29sdmUgdGhlXG4gKiBbYHRvU3RyaW5nVGFnYF0oaHR0cDovL2VjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvNy4wLyNzZWMtb2JqZWN0LnByb3RvdHlwZS50b3N0cmluZylcbiAqIG9mIHZhbHVlcy5cbiAqL1xudmFyIG5hdGl2ZU9iamVjdFRvU3RyaW5nID0gb2JqZWN0UHJvdG8udG9TdHJpbmc7XG5cbi8qKiBCdWlsdC1pbiB2YWx1ZSByZWZlcmVuY2VzLiAqL1xudmFyIHN5bVRvU3RyaW5nVGFnID0gU3ltYm9sID8gU3ltYm9sLnRvU3RyaW5nVGFnIDogdW5kZWZpbmVkO1xuXG4vKipcbiAqIEEgc3BlY2lhbGl6ZWQgdmVyc2lvbiBvZiBgYmFzZUdldFRhZ2Agd2hpY2ggaWdub3JlcyBgU3ltYm9sLnRvU3RyaW5nVGFnYCB2YWx1ZXMuXG4gKlxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIHF1ZXJ5LlxuICogQHJldHVybnMge3N0cmluZ30gUmV0dXJucyB0aGUgcmF3IGB0b1N0cmluZ1RhZ2AuXG4gKi9cbmZ1bmN0aW9uIGdldFJhd1RhZyh2YWx1ZSkge1xuICB2YXIgaXNPd24gPSBoYXNPd25Qcm9wZXJ0eS5jYWxsKHZhbHVlLCBzeW1Ub1N0cmluZ1RhZyksXG4gICAgICB0YWcgPSB2YWx1ZVtzeW1Ub1N0cmluZ1RhZ107XG5cbiAgdHJ5IHtcbiAgICB2YWx1ZVtzeW1Ub1N0cmluZ1RhZ10gPSB1bmRlZmluZWQ7XG4gICAgdmFyIHVubWFza2VkID0gdHJ1ZTtcbiAgfSBjYXRjaCAoZSkge31cblxuICB2YXIgcmVzdWx0ID0gbmF0aXZlT2JqZWN0VG9TdHJpbmcuY2FsbCh2YWx1ZSk7XG4gIGlmICh1bm1hc2tlZCkge1xuICAgIGlmIChpc093bikge1xuICAgICAgdmFsdWVbc3ltVG9TdHJpbmdUYWddID0gdGFnO1xuICAgIH0gZWxzZSB7XG4gICAgICBkZWxldGUgdmFsdWVbc3ltVG9TdHJpbmdUYWddO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGdldFJhd1RhZztcbiIsIi8qKlxuICogR2V0cyB0aGUgdmFsdWUgYXQgYGtleWAgb2YgYG9iamVjdGAuXG4gKlxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7T2JqZWN0fSBbb2JqZWN0XSBUaGUgb2JqZWN0IHRvIHF1ZXJ5LlxuICogQHBhcmFtIHtzdHJpbmd9IGtleSBUaGUga2V5IG9mIHRoZSBwcm9wZXJ0eSB0byBnZXQuXG4gKiBAcmV0dXJucyB7Kn0gUmV0dXJucyB0aGUgcHJvcGVydHkgdmFsdWUuXG4gKi9cbmZ1bmN0aW9uIGdldFZhbHVlKG9iamVjdCwga2V5KSB7XG4gIHJldHVybiBvYmplY3QgPT0gbnVsbCA/IHVuZGVmaW5lZCA6IG9iamVjdFtrZXldO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGdldFZhbHVlO1xuIiwidmFyIG5hdGl2ZUNyZWF0ZSA9IHJlcXVpcmUoJy4vX25hdGl2ZUNyZWF0ZScpO1xuXG4vKipcbiAqIFJlbW92ZXMgYWxsIGtleS12YWx1ZSBlbnRyaWVzIGZyb20gdGhlIGhhc2guXG4gKlxuICogQHByaXZhdGVcbiAqIEBuYW1lIGNsZWFyXG4gKiBAbWVtYmVyT2YgSGFzaFxuICovXG5mdW5jdGlvbiBoYXNoQ2xlYXIoKSB7XG4gIHRoaXMuX19kYXRhX18gPSBuYXRpdmVDcmVhdGUgPyBuYXRpdmVDcmVhdGUobnVsbCkgOiB7fTtcbiAgdGhpcy5zaXplID0gMDtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBoYXNoQ2xlYXI7XG4iLCIvKipcbiAqIFJlbW92ZXMgYGtleWAgYW5kIGl0cyB2YWx1ZSBmcm9tIHRoZSBoYXNoLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAbmFtZSBkZWxldGVcbiAqIEBtZW1iZXJPZiBIYXNoXG4gKiBAcGFyYW0ge09iamVjdH0gaGFzaCBUaGUgaGFzaCB0byBtb2RpZnkuXG4gKiBAcGFyYW0ge3N0cmluZ30ga2V5IFRoZSBrZXkgb2YgdGhlIHZhbHVlIHRvIHJlbW92ZS5cbiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgZW50cnkgd2FzIHJlbW92ZWQsIGVsc2UgYGZhbHNlYC5cbiAqL1xuZnVuY3Rpb24gaGFzaERlbGV0ZShrZXkpIHtcbiAgdmFyIHJlc3VsdCA9IHRoaXMuaGFzKGtleSkgJiYgZGVsZXRlIHRoaXMuX19kYXRhX19ba2V5XTtcbiAgdGhpcy5zaXplIC09IHJlc3VsdCA/IDEgOiAwO1xuICByZXR1cm4gcmVzdWx0O1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGhhc2hEZWxldGU7XG4iLCJ2YXIgbmF0aXZlQ3JlYXRlID0gcmVxdWlyZSgnLi9fbmF0aXZlQ3JlYXRlJyk7XG5cbi8qKiBVc2VkIHRvIHN0YW5kLWluIGZvciBgdW5kZWZpbmVkYCBoYXNoIHZhbHVlcy4gKi9cbnZhciBIQVNIX1VOREVGSU5FRCA9ICdfX2xvZGFzaF9oYXNoX3VuZGVmaW5lZF9fJztcblxuLyoqIFVzZWQgZm9yIGJ1aWx0LWluIG1ldGhvZCByZWZlcmVuY2VzLiAqL1xudmFyIG9iamVjdFByb3RvID0gT2JqZWN0LnByb3RvdHlwZTtcblxuLyoqIFVzZWQgdG8gY2hlY2sgb2JqZWN0cyBmb3Igb3duIHByb3BlcnRpZXMuICovXG52YXIgaGFzT3duUHJvcGVydHkgPSBvYmplY3RQcm90by5oYXNPd25Qcm9wZXJ0eTtcblxuLyoqXG4gKiBHZXRzIHRoZSBoYXNoIHZhbHVlIGZvciBga2V5YC5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQG5hbWUgZ2V0XG4gKiBAbWVtYmVyT2YgSGFzaFxuICogQHBhcmFtIHtzdHJpbmd9IGtleSBUaGUga2V5IG9mIHRoZSB2YWx1ZSB0byBnZXQuXG4gKiBAcmV0dXJucyB7Kn0gUmV0dXJucyB0aGUgZW50cnkgdmFsdWUuXG4gKi9cbmZ1bmN0aW9uIGhhc2hHZXQoa2V5KSB7XG4gIHZhciBkYXRhID0gdGhpcy5fX2RhdGFfXztcbiAgaWYgKG5hdGl2ZUNyZWF0ZSkge1xuICAgIHZhciByZXN1bHQgPSBkYXRhW2tleV07XG4gICAgcmV0dXJuIHJlc3VsdCA9PT0gSEFTSF9VTkRFRklORUQgPyB1bmRlZmluZWQgOiByZXN1bHQ7XG4gIH1cbiAgcmV0dXJuIGhhc093blByb3BlcnR5LmNhbGwoZGF0YSwga2V5KSA/IGRhdGFba2V5XSA6IHVuZGVmaW5lZDtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBoYXNoR2V0O1xuIiwidmFyIG5hdGl2ZUNyZWF0ZSA9IHJlcXVpcmUoJy4vX25hdGl2ZUNyZWF0ZScpO1xuXG4vKiogVXNlZCBmb3IgYnVpbHQtaW4gbWV0aG9kIHJlZmVyZW5jZXMuICovXG52YXIgb2JqZWN0UHJvdG8gPSBPYmplY3QucHJvdG90eXBlO1xuXG4vKiogVXNlZCB0byBjaGVjayBvYmplY3RzIGZvciBvd24gcHJvcGVydGllcy4gKi9cbnZhciBoYXNPd25Qcm9wZXJ0eSA9IG9iamVjdFByb3RvLmhhc093blByb3BlcnR5O1xuXG4vKipcbiAqIENoZWNrcyBpZiBhIGhhc2ggdmFsdWUgZm9yIGBrZXlgIGV4aXN0cy5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQG5hbWUgaGFzXG4gKiBAbWVtYmVyT2YgSGFzaFxuICogQHBhcmFtIHtzdHJpbmd9IGtleSBUaGUga2V5IG9mIHRoZSBlbnRyeSB0byBjaGVjay5cbiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBhbiBlbnRyeSBmb3IgYGtleWAgZXhpc3RzLCBlbHNlIGBmYWxzZWAuXG4gKi9cbmZ1bmN0aW9uIGhhc2hIYXMoa2V5KSB7XG4gIHZhciBkYXRhID0gdGhpcy5fX2RhdGFfXztcbiAgcmV0dXJuIG5hdGl2ZUNyZWF0ZSA/IChkYXRhW2tleV0gIT09IHVuZGVmaW5lZCkgOiBoYXNPd25Qcm9wZXJ0eS5jYWxsKGRhdGEsIGtleSk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gaGFzaEhhcztcbiIsInZhciBuYXRpdmVDcmVhdGUgPSByZXF1aXJlKCcuL19uYXRpdmVDcmVhdGUnKTtcblxuLyoqIFVzZWQgdG8gc3RhbmQtaW4gZm9yIGB1bmRlZmluZWRgIGhhc2ggdmFsdWVzLiAqL1xudmFyIEhBU0hfVU5ERUZJTkVEID0gJ19fbG9kYXNoX2hhc2hfdW5kZWZpbmVkX18nO1xuXG4vKipcbiAqIFNldHMgdGhlIGhhc2ggYGtleWAgdG8gYHZhbHVlYC5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQG5hbWUgc2V0XG4gKiBAbWVtYmVyT2YgSGFzaFxuICogQHBhcmFtIHtzdHJpbmd9IGtleSBUaGUga2V5IG9mIHRoZSB2YWx1ZSB0byBzZXQuXG4gKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBzZXQuXG4gKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIHRoZSBoYXNoIGluc3RhbmNlLlxuICovXG5mdW5jdGlvbiBoYXNoU2V0KGtleSwgdmFsdWUpIHtcbiAgdmFyIGRhdGEgPSB0aGlzLl9fZGF0YV9fO1xuICB0aGlzLnNpemUgKz0gdGhpcy5oYXMoa2V5KSA/IDAgOiAxO1xuICBkYXRhW2tleV0gPSAobmF0aXZlQ3JlYXRlICYmIHZhbHVlID09PSB1bmRlZmluZWQpID8gSEFTSF9VTkRFRklORUQgOiB2YWx1ZTtcbiAgcmV0dXJuIHRoaXM7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gaGFzaFNldDtcbiIsInZhciBiYXNlQ3JlYXRlID0gcmVxdWlyZSgnLi9fYmFzZUNyZWF0ZScpLFxuICAgIGdldFByb3RvdHlwZSA9IHJlcXVpcmUoJy4vX2dldFByb3RvdHlwZScpLFxuICAgIGlzUHJvdG90eXBlID0gcmVxdWlyZSgnLi9faXNQcm90b3R5cGUnKTtcblxuLyoqXG4gKiBJbml0aWFsaXplcyBhbiBvYmplY3QgY2xvbmUuXG4gKlxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBjbG9uZS5cbiAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgdGhlIGluaXRpYWxpemVkIGNsb25lLlxuICovXG5mdW5jdGlvbiBpbml0Q2xvbmVPYmplY3Qob2JqZWN0KSB7XG4gIHJldHVybiAodHlwZW9mIG9iamVjdC5jb25zdHJ1Y3RvciA9PSAnZnVuY3Rpb24nICYmICFpc1Byb3RvdHlwZShvYmplY3QpKVxuICAgID8gYmFzZUNyZWF0ZShnZXRQcm90b3R5cGUob2JqZWN0KSlcbiAgICA6IHt9O1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGluaXRDbG9uZU9iamVjdDtcbiIsIi8qKiBVc2VkIGFzIHJlZmVyZW5jZXMgZm9yIHZhcmlvdXMgYE51bWJlcmAgY29uc3RhbnRzLiAqL1xudmFyIE1BWF9TQUZFX0lOVEVHRVIgPSA5MDA3MTk5MjU0NzQwOTkxO1xuXG4vKiogVXNlZCB0byBkZXRlY3QgdW5zaWduZWQgaW50ZWdlciB2YWx1ZXMuICovXG52YXIgcmVJc1VpbnQgPSAvXig/OjB8WzEtOV1cXGQqKSQvO1xuXG4vKipcbiAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGEgdmFsaWQgYXJyYXktbGlrZSBpbmRleC5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gKiBAcGFyYW0ge251bWJlcn0gW2xlbmd0aD1NQVhfU0FGRV9JTlRFR0VSXSBUaGUgdXBwZXIgYm91bmRzIG9mIGEgdmFsaWQgaW5kZXguXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBhIHZhbGlkIGluZGV4LCBlbHNlIGBmYWxzZWAuXG4gKi9cbmZ1bmN0aW9uIGlzSW5kZXgodmFsdWUsIGxlbmd0aCkge1xuICB2YXIgdHlwZSA9IHR5cGVvZiB2YWx1ZTtcbiAgbGVuZ3RoID0gbGVuZ3RoID09IG51bGwgPyBNQVhfU0FGRV9JTlRFR0VSIDogbGVuZ3RoO1xuXG4gIHJldHVybiAhIWxlbmd0aCAmJlxuICAgICh0eXBlID09ICdudW1iZXInIHx8XG4gICAgICAodHlwZSAhPSAnc3ltYm9sJyAmJiByZUlzVWludC50ZXN0KHZhbHVlKSkpICYmXG4gICAgICAgICh2YWx1ZSA+IC0xICYmIHZhbHVlICUgMSA9PSAwICYmIHZhbHVlIDwgbGVuZ3RoKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBpc0luZGV4O1xuIiwidmFyIGVxID0gcmVxdWlyZSgnLi9lcScpLFxuICAgIGlzQXJyYXlMaWtlID0gcmVxdWlyZSgnLi9pc0FycmF5TGlrZScpLFxuICAgIGlzSW5kZXggPSByZXF1aXJlKCcuL19pc0luZGV4JyksXG4gICAgaXNPYmplY3QgPSByZXF1aXJlKCcuL2lzT2JqZWN0Jyk7XG5cbi8qKlxuICogQ2hlY2tzIGlmIHRoZSBnaXZlbiBhcmd1bWVudHMgYXJlIGZyb20gYW4gaXRlcmF0ZWUgY2FsbC5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgcG90ZW50aWFsIGl0ZXJhdGVlIHZhbHVlIGFyZ3VtZW50LlxuICogQHBhcmFtIHsqfSBpbmRleCBUaGUgcG90ZW50aWFsIGl0ZXJhdGVlIGluZGV4IG9yIGtleSBhcmd1bWVudC5cbiAqIEBwYXJhbSB7Kn0gb2JqZWN0IFRoZSBwb3RlbnRpYWwgaXRlcmF0ZWUgb2JqZWN0IGFyZ3VtZW50LlxuICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIHRoZSBhcmd1bWVudHMgYXJlIGZyb20gYW4gaXRlcmF0ZWUgY2FsbCxcbiAqICBlbHNlIGBmYWxzZWAuXG4gKi9cbmZ1bmN0aW9uIGlzSXRlcmF0ZWVDYWxsKHZhbHVlLCBpbmRleCwgb2JqZWN0KSB7XG4gIGlmICghaXNPYmplY3Qob2JqZWN0KSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICB2YXIgdHlwZSA9IHR5cGVvZiBpbmRleDtcbiAgaWYgKHR5cGUgPT0gJ251bWJlcidcbiAgICAgICAgPyAoaXNBcnJheUxpa2Uob2JqZWN0KSAmJiBpc0luZGV4KGluZGV4LCBvYmplY3QubGVuZ3RoKSlcbiAgICAgICAgOiAodHlwZSA9PSAnc3RyaW5nJyAmJiBpbmRleCBpbiBvYmplY3QpXG4gICAgICApIHtcbiAgICByZXR1cm4gZXEob2JqZWN0W2luZGV4XSwgdmFsdWUpO1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBpc0l0ZXJhdGVlQ2FsbDtcbiIsIi8qKlxuICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgc3VpdGFibGUgZm9yIHVzZSBhcyB1bmlxdWUgb2JqZWN0IGtleS5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBzdWl0YWJsZSwgZWxzZSBgZmFsc2VgLlxuICovXG5mdW5jdGlvbiBpc0tleWFibGUodmFsdWUpIHtcbiAgdmFyIHR5cGUgPSB0eXBlb2YgdmFsdWU7XG4gIHJldHVybiAodHlwZSA9PSAnc3RyaW5nJyB8fCB0eXBlID09ICdudW1iZXInIHx8IHR5cGUgPT0gJ3N5bWJvbCcgfHwgdHlwZSA9PSAnYm9vbGVhbicpXG4gICAgPyAodmFsdWUgIT09ICdfX3Byb3RvX18nKVxuICAgIDogKHZhbHVlID09PSBudWxsKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBpc0tleWFibGU7XG4iLCJ2YXIgY29yZUpzRGF0YSA9IHJlcXVpcmUoJy4vX2NvcmVKc0RhdGEnKTtcblxuLyoqIFVzZWQgdG8gZGV0ZWN0IG1ldGhvZHMgbWFzcXVlcmFkaW5nIGFzIG5hdGl2ZS4gKi9cbnZhciBtYXNrU3JjS2V5ID0gKGZ1bmN0aW9uKCkge1xuICB2YXIgdWlkID0gL1teLl0rJC8uZXhlYyhjb3JlSnNEYXRhICYmIGNvcmVKc0RhdGEua2V5cyAmJiBjb3JlSnNEYXRhLmtleXMuSUVfUFJPVE8gfHwgJycpO1xuICByZXR1cm4gdWlkID8gKCdTeW1ib2woc3JjKV8xLicgKyB1aWQpIDogJyc7XG59KCkpO1xuXG4vKipcbiAqIENoZWNrcyBpZiBgZnVuY2AgaGFzIGl0cyBzb3VyY2UgbWFza2VkLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBmdW5jIFRoZSBmdW5jdGlvbiB0byBjaGVjay5cbiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgZnVuY2AgaXMgbWFza2VkLCBlbHNlIGBmYWxzZWAuXG4gKi9cbmZ1bmN0aW9uIGlzTWFza2VkKGZ1bmMpIHtcbiAgcmV0dXJuICEhbWFza1NyY0tleSAmJiAobWFza1NyY0tleSBpbiBmdW5jKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBpc01hc2tlZDtcbiIsIi8qKiBVc2VkIGZvciBidWlsdC1pbiBtZXRob2QgcmVmZXJlbmNlcy4gKi9cbnZhciBvYmplY3RQcm90byA9IE9iamVjdC5wcm90b3R5cGU7XG5cbi8qKlxuICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgbGlrZWx5IGEgcHJvdG90eXBlIG9iamVjdC5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBhIHByb3RvdHlwZSwgZWxzZSBgZmFsc2VgLlxuICovXG5mdW5jdGlvbiBpc1Byb3RvdHlwZSh2YWx1ZSkge1xuICB2YXIgQ3RvciA9IHZhbHVlICYmIHZhbHVlLmNvbnN0cnVjdG9yLFxuICAgICAgcHJvdG8gPSAodHlwZW9mIEN0b3IgPT0gJ2Z1bmN0aW9uJyAmJiBDdG9yLnByb3RvdHlwZSkgfHwgb2JqZWN0UHJvdG87XG5cbiAgcmV0dXJuIHZhbHVlID09PSBwcm90bztcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBpc1Byb3RvdHlwZTtcbiIsIi8qKlxuICogUmVtb3ZlcyBhbGwga2V5LXZhbHVlIGVudHJpZXMgZnJvbSB0aGUgbGlzdCBjYWNoZS5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQG5hbWUgY2xlYXJcbiAqIEBtZW1iZXJPZiBMaXN0Q2FjaGVcbiAqL1xuZnVuY3Rpb24gbGlzdENhY2hlQ2xlYXIoKSB7XG4gIHRoaXMuX19kYXRhX18gPSBbXTtcbiAgdGhpcy5zaXplID0gMDtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBsaXN0Q2FjaGVDbGVhcjtcbiIsInZhciBhc3NvY0luZGV4T2YgPSByZXF1aXJlKCcuL19hc3NvY0luZGV4T2YnKTtcblxuLyoqIFVzZWQgZm9yIGJ1aWx0LWluIG1ldGhvZCByZWZlcmVuY2VzLiAqL1xudmFyIGFycmF5UHJvdG8gPSBBcnJheS5wcm90b3R5cGU7XG5cbi8qKiBCdWlsdC1pbiB2YWx1ZSByZWZlcmVuY2VzLiAqL1xudmFyIHNwbGljZSA9IGFycmF5UHJvdG8uc3BsaWNlO1xuXG4vKipcbiAqIFJlbW92ZXMgYGtleWAgYW5kIGl0cyB2YWx1ZSBmcm9tIHRoZSBsaXN0IGNhY2hlLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAbmFtZSBkZWxldGVcbiAqIEBtZW1iZXJPZiBMaXN0Q2FjaGVcbiAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgVGhlIGtleSBvZiB0aGUgdmFsdWUgdG8gcmVtb3ZlLlxuICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIHRoZSBlbnRyeSB3YXMgcmVtb3ZlZCwgZWxzZSBgZmFsc2VgLlxuICovXG5mdW5jdGlvbiBsaXN0Q2FjaGVEZWxldGUoa2V5KSB7XG4gIHZhciBkYXRhID0gdGhpcy5fX2RhdGFfXyxcbiAgICAgIGluZGV4ID0gYXNzb2NJbmRleE9mKGRhdGEsIGtleSk7XG5cbiAgaWYgKGluZGV4IDwgMCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICB2YXIgbGFzdEluZGV4ID0gZGF0YS5sZW5ndGggLSAxO1xuICBpZiAoaW5kZXggPT0gbGFzdEluZGV4KSB7XG4gICAgZGF0YS5wb3AoKTtcbiAgfSBlbHNlIHtcbiAgICBzcGxpY2UuY2FsbChkYXRhLCBpbmRleCwgMSk7XG4gIH1cbiAgLS10aGlzLnNpemU7XG4gIHJldHVybiB0cnVlO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGxpc3RDYWNoZURlbGV0ZTtcbiIsInZhciBhc3NvY0luZGV4T2YgPSByZXF1aXJlKCcuL19hc3NvY0luZGV4T2YnKTtcblxuLyoqXG4gKiBHZXRzIHRoZSBsaXN0IGNhY2hlIHZhbHVlIGZvciBga2V5YC5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQG5hbWUgZ2V0XG4gKiBAbWVtYmVyT2YgTGlzdENhY2hlXG4gKiBAcGFyYW0ge3N0cmluZ30ga2V5IFRoZSBrZXkgb2YgdGhlIHZhbHVlIHRvIGdldC5cbiAqIEByZXR1cm5zIHsqfSBSZXR1cm5zIHRoZSBlbnRyeSB2YWx1ZS5cbiAqL1xuZnVuY3Rpb24gbGlzdENhY2hlR2V0KGtleSkge1xuICB2YXIgZGF0YSA9IHRoaXMuX19kYXRhX18sXG4gICAgICBpbmRleCA9IGFzc29jSW5kZXhPZihkYXRhLCBrZXkpO1xuXG4gIHJldHVybiBpbmRleCA8IDAgPyB1bmRlZmluZWQgOiBkYXRhW2luZGV4XVsxXTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBsaXN0Q2FjaGVHZXQ7XG4iLCJ2YXIgYXNzb2NJbmRleE9mID0gcmVxdWlyZSgnLi9fYXNzb2NJbmRleE9mJyk7XG5cbi8qKlxuICogQ2hlY2tzIGlmIGEgbGlzdCBjYWNoZSB2YWx1ZSBmb3IgYGtleWAgZXhpc3RzLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAbmFtZSBoYXNcbiAqIEBtZW1iZXJPZiBMaXN0Q2FjaGVcbiAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgVGhlIGtleSBvZiB0aGUgZW50cnkgdG8gY2hlY2suXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYW4gZW50cnkgZm9yIGBrZXlgIGV4aXN0cywgZWxzZSBgZmFsc2VgLlxuICovXG5mdW5jdGlvbiBsaXN0Q2FjaGVIYXMoa2V5KSB7XG4gIHJldHVybiBhc3NvY0luZGV4T2YodGhpcy5fX2RhdGFfXywga2V5KSA+IC0xO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGxpc3RDYWNoZUhhcztcbiIsInZhciBhc3NvY0luZGV4T2YgPSByZXF1aXJlKCcuL19hc3NvY0luZGV4T2YnKTtcblxuLyoqXG4gKiBTZXRzIHRoZSBsaXN0IGNhY2hlIGBrZXlgIHRvIGB2YWx1ZWAuXG4gKlxuICogQHByaXZhdGVcbiAqIEBuYW1lIHNldFxuICogQG1lbWJlck9mIExpc3RDYWNoZVxuICogQHBhcmFtIHtzdHJpbmd9IGtleSBUaGUga2V5IG9mIHRoZSB2YWx1ZSB0byBzZXQuXG4gKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBzZXQuXG4gKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIHRoZSBsaXN0IGNhY2hlIGluc3RhbmNlLlxuICovXG5mdW5jdGlvbiBsaXN0Q2FjaGVTZXQoa2V5LCB2YWx1ZSkge1xuICB2YXIgZGF0YSA9IHRoaXMuX19kYXRhX18sXG4gICAgICBpbmRleCA9IGFzc29jSW5kZXhPZihkYXRhLCBrZXkpO1xuXG4gIGlmIChpbmRleCA8IDApIHtcbiAgICArK3RoaXMuc2l6ZTtcbiAgICBkYXRhLnB1c2goW2tleSwgdmFsdWVdKTtcbiAgfSBlbHNlIHtcbiAgICBkYXRhW2luZGV4XVsxXSA9IHZhbHVlO1xuICB9XG4gIHJldHVybiB0aGlzO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGxpc3RDYWNoZVNldDtcbiIsInZhciBIYXNoID0gcmVxdWlyZSgnLi9fSGFzaCcpLFxuICAgIExpc3RDYWNoZSA9IHJlcXVpcmUoJy4vX0xpc3RDYWNoZScpLFxuICAgIE1hcCA9IHJlcXVpcmUoJy4vX01hcCcpO1xuXG4vKipcbiAqIFJlbW92ZXMgYWxsIGtleS12YWx1ZSBlbnRyaWVzIGZyb20gdGhlIG1hcC5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQG5hbWUgY2xlYXJcbiAqIEBtZW1iZXJPZiBNYXBDYWNoZVxuICovXG5mdW5jdGlvbiBtYXBDYWNoZUNsZWFyKCkge1xuICB0aGlzLnNpemUgPSAwO1xuICB0aGlzLl9fZGF0YV9fID0ge1xuICAgICdoYXNoJzogbmV3IEhhc2gsXG4gICAgJ21hcCc6IG5ldyAoTWFwIHx8IExpc3RDYWNoZSksXG4gICAgJ3N0cmluZyc6IG5ldyBIYXNoXG4gIH07XG59XG5cbm1vZHVsZS5leHBvcnRzID0gbWFwQ2FjaGVDbGVhcjtcbiIsInZhciBnZXRNYXBEYXRhID0gcmVxdWlyZSgnLi9fZ2V0TWFwRGF0YScpO1xuXG4vKipcbiAqIFJlbW92ZXMgYGtleWAgYW5kIGl0cyB2YWx1ZSBmcm9tIHRoZSBtYXAuXG4gKlxuICogQHByaXZhdGVcbiAqIEBuYW1lIGRlbGV0ZVxuICogQG1lbWJlck9mIE1hcENhY2hlXG4gKiBAcGFyYW0ge3N0cmluZ30ga2V5IFRoZSBrZXkgb2YgdGhlIHZhbHVlIHRvIHJlbW92ZS5cbiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgZW50cnkgd2FzIHJlbW92ZWQsIGVsc2UgYGZhbHNlYC5cbiAqL1xuZnVuY3Rpb24gbWFwQ2FjaGVEZWxldGUoa2V5KSB7XG4gIHZhciByZXN1bHQgPSBnZXRNYXBEYXRhKHRoaXMsIGtleSlbJ2RlbGV0ZSddKGtleSk7XG4gIHRoaXMuc2l6ZSAtPSByZXN1bHQgPyAxIDogMDtcbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBtYXBDYWNoZURlbGV0ZTtcbiIsInZhciBnZXRNYXBEYXRhID0gcmVxdWlyZSgnLi9fZ2V0TWFwRGF0YScpO1xuXG4vKipcbiAqIEdldHMgdGhlIG1hcCB2YWx1ZSBmb3IgYGtleWAuXG4gKlxuICogQHByaXZhdGVcbiAqIEBuYW1lIGdldFxuICogQG1lbWJlck9mIE1hcENhY2hlXG4gKiBAcGFyYW0ge3N0cmluZ30ga2V5IFRoZSBrZXkgb2YgdGhlIHZhbHVlIHRvIGdldC5cbiAqIEByZXR1cm5zIHsqfSBSZXR1cm5zIHRoZSBlbnRyeSB2YWx1ZS5cbiAqL1xuZnVuY3Rpb24gbWFwQ2FjaGVHZXQoa2V5KSB7XG4gIHJldHVybiBnZXRNYXBEYXRhKHRoaXMsIGtleSkuZ2V0KGtleSk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gbWFwQ2FjaGVHZXQ7XG4iLCJ2YXIgZ2V0TWFwRGF0YSA9IHJlcXVpcmUoJy4vX2dldE1hcERhdGEnKTtcblxuLyoqXG4gKiBDaGVja3MgaWYgYSBtYXAgdmFsdWUgZm9yIGBrZXlgIGV4aXN0cy5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQG5hbWUgaGFzXG4gKiBAbWVtYmVyT2YgTWFwQ2FjaGVcbiAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgVGhlIGtleSBvZiB0aGUgZW50cnkgdG8gY2hlY2suXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYW4gZW50cnkgZm9yIGBrZXlgIGV4aXN0cywgZWxzZSBgZmFsc2VgLlxuICovXG5mdW5jdGlvbiBtYXBDYWNoZUhhcyhrZXkpIHtcbiAgcmV0dXJuIGdldE1hcERhdGEodGhpcywga2V5KS5oYXMoa2V5KTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBtYXBDYWNoZUhhcztcbiIsInZhciBnZXRNYXBEYXRhID0gcmVxdWlyZSgnLi9fZ2V0TWFwRGF0YScpO1xuXG4vKipcbiAqIFNldHMgdGhlIG1hcCBga2V5YCB0byBgdmFsdWVgLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAbmFtZSBzZXRcbiAqIEBtZW1iZXJPZiBNYXBDYWNoZVxuICogQHBhcmFtIHtzdHJpbmd9IGtleSBUaGUga2V5IG9mIHRoZSB2YWx1ZSB0byBzZXQuXG4gKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBzZXQuXG4gKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIHRoZSBtYXAgY2FjaGUgaW5zdGFuY2UuXG4gKi9cbmZ1bmN0aW9uIG1hcENhY2hlU2V0KGtleSwgdmFsdWUpIHtcbiAgdmFyIGRhdGEgPSBnZXRNYXBEYXRhKHRoaXMsIGtleSksXG4gICAgICBzaXplID0gZGF0YS5zaXplO1xuXG4gIGRhdGEuc2V0KGtleSwgdmFsdWUpO1xuICB0aGlzLnNpemUgKz0gZGF0YS5zaXplID09IHNpemUgPyAwIDogMTtcbiAgcmV0dXJuIHRoaXM7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gbWFwQ2FjaGVTZXQ7XG4iLCJ2YXIgZ2V0TmF0aXZlID0gcmVxdWlyZSgnLi9fZ2V0TmF0aXZlJyk7XG5cbi8qIEJ1aWx0LWluIG1ldGhvZCByZWZlcmVuY2VzIHRoYXQgYXJlIHZlcmlmaWVkIHRvIGJlIG5hdGl2ZS4gKi9cbnZhciBuYXRpdmVDcmVhdGUgPSBnZXROYXRpdmUoT2JqZWN0LCAnY3JlYXRlJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gbmF0aXZlQ3JlYXRlO1xuIiwiLyoqXG4gKiBUaGlzIGZ1bmN0aW9uIGlzIGxpa2VcbiAqIFtgT2JqZWN0LmtleXNgXShodHRwOi8vZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi83LjAvI3NlYy1vYmplY3Qua2V5cylcbiAqIGV4Y2VwdCB0aGF0IGl0IGluY2x1ZGVzIGluaGVyaXRlZCBlbnVtZXJhYmxlIHByb3BlcnRpZXMuXG4gKlxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBxdWVyeS5cbiAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgYXJyYXkgb2YgcHJvcGVydHkgbmFtZXMuXG4gKi9cbmZ1bmN0aW9uIG5hdGl2ZUtleXNJbihvYmplY3QpIHtcbiAgdmFyIHJlc3VsdCA9IFtdO1xuICBpZiAob2JqZWN0ICE9IG51bGwpIHtcbiAgICBmb3IgKHZhciBrZXkgaW4gT2JqZWN0KG9iamVjdCkpIHtcbiAgICAgIHJlc3VsdC5wdXNoKGtleSk7XG4gICAgfVxuICB9XG4gIHJldHVybiByZXN1bHQ7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gbmF0aXZlS2V5c0luO1xuIiwidmFyIGZyZWVHbG9iYWwgPSByZXF1aXJlKCcuL19mcmVlR2xvYmFsJyk7XG5cbi8qKiBEZXRlY3QgZnJlZSB2YXJpYWJsZSBgZXhwb3J0c2AuICovXG52YXIgZnJlZUV4cG9ydHMgPSB0eXBlb2YgZXhwb3J0cyA9PSAnb2JqZWN0JyAmJiBleHBvcnRzICYmICFleHBvcnRzLm5vZGVUeXBlICYmIGV4cG9ydHM7XG5cbi8qKiBEZXRlY3QgZnJlZSB2YXJpYWJsZSBgbW9kdWxlYC4gKi9cbnZhciBmcmVlTW9kdWxlID0gZnJlZUV4cG9ydHMgJiYgdHlwZW9mIG1vZHVsZSA9PSAnb2JqZWN0JyAmJiBtb2R1bGUgJiYgIW1vZHVsZS5ub2RlVHlwZSAmJiBtb2R1bGU7XG5cbi8qKiBEZXRlY3QgdGhlIHBvcHVsYXIgQ29tbW9uSlMgZXh0ZW5zaW9uIGBtb2R1bGUuZXhwb3J0c2AuICovXG52YXIgbW9kdWxlRXhwb3J0cyA9IGZyZWVNb2R1bGUgJiYgZnJlZU1vZHVsZS5leHBvcnRzID09PSBmcmVlRXhwb3J0cztcblxuLyoqIERldGVjdCBmcmVlIHZhcmlhYmxlIGBwcm9jZXNzYCBmcm9tIE5vZGUuanMuICovXG52YXIgZnJlZVByb2Nlc3MgPSBtb2R1bGVFeHBvcnRzICYmIGZyZWVHbG9iYWwucHJvY2VzcztcblxuLyoqIFVzZWQgdG8gYWNjZXNzIGZhc3RlciBOb2RlLmpzIGhlbHBlcnMuICovXG52YXIgbm9kZVV0aWwgPSAoZnVuY3Rpb24oKSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIGZyZWVQcm9jZXNzICYmIGZyZWVQcm9jZXNzLmJpbmRpbmcgJiYgZnJlZVByb2Nlc3MuYmluZGluZygndXRpbCcpO1xuICB9IGNhdGNoIChlKSB7fVxufSgpKTtcblxubW9kdWxlLmV4cG9ydHMgPSBub2RlVXRpbDtcbiIsIi8qKiBVc2VkIGZvciBidWlsdC1pbiBtZXRob2QgcmVmZXJlbmNlcy4gKi9cbnZhciBvYmplY3RQcm90byA9IE9iamVjdC5wcm90b3R5cGU7XG5cbi8qKlxuICogVXNlZCB0byByZXNvbHZlIHRoZVxuICogW2B0b1N0cmluZ1RhZ2BdKGh0dHA6Ly9lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzcuMC8jc2VjLW9iamVjdC5wcm90b3R5cGUudG9zdHJpbmcpXG4gKiBvZiB2YWx1ZXMuXG4gKi9cbnZhciBuYXRpdmVPYmplY3RUb1N0cmluZyA9IG9iamVjdFByb3RvLnRvU3RyaW5nO1xuXG4vKipcbiAqIENvbnZlcnRzIGB2YWx1ZWAgdG8gYSBzdHJpbmcgdXNpbmcgYE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmdgLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjb252ZXJ0LlxuICogQHJldHVybnMge3N0cmluZ30gUmV0dXJucyB0aGUgY29udmVydGVkIHN0cmluZy5cbiAqL1xuZnVuY3Rpb24gb2JqZWN0VG9TdHJpbmcodmFsdWUpIHtcbiAgcmV0dXJuIG5hdGl2ZU9iamVjdFRvU3RyaW5nLmNhbGwodmFsdWUpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IG9iamVjdFRvU3RyaW5nO1xuIiwiLyoqXG4gKiBDcmVhdGVzIGEgdW5hcnkgZnVuY3Rpb24gdGhhdCBpbnZva2VzIGBmdW5jYCB3aXRoIGl0cyBhcmd1bWVudCB0cmFuc2Zvcm1lZC5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuYyBUaGUgZnVuY3Rpb24gdG8gd3JhcC5cbiAqIEBwYXJhbSB7RnVuY3Rpb259IHRyYW5zZm9ybSBUaGUgYXJndW1lbnQgdHJhbnNmb3JtLlxuICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgZnVuY3Rpb24uXG4gKi9cbmZ1bmN0aW9uIG92ZXJBcmcoZnVuYywgdHJhbnNmb3JtKSB7XG4gIHJldHVybiBmdW5jdGlvbihhcmcpIHtcbiAgICByZXR1cm4gZnVuYyh0cmFuc2Zvcm0oYXJnKSk7XG4gIH07XG59XG5cbm1vZHVsZS5leHBvcnRzID0gb3ZlckFyZztcbiIsInZhciBhcHBseSA9IHJlcXVpcmUoJy4vX2FwcGx5Jyk7XG5cbi8qIEJ1aWx0LWluIG1ldGhvZCByZWZlcmVuY2VzIGZvciB0aG9zZSB3aXRoIHRoZSBzYW1lIG5hbWUgYXMgb3RoZXIgYGxvZGFzaGAgbWV0aG9kcy4gKi9cbnZhciBuYXRpdmVNYXggPSBNYXRoLm1heDtcblxuLyoqXG4gKiBBIHNwZWNpYWxpemVkIHZlcnNpb24gb2YgYGJhc2VSZXN0YCB3aGljaCB0cmFuc2Zvcm1zIHRoZSByZXN0IGFycmF5LlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBmdW5jIFRoZSBmdW5jdGlvbiB0byBhcHBseSBhIHJlc3QgcGFyYW1ldGVyIHRvLlxuICogQHBhcmFtIHtudW1iZXJ9IFtzdGFydD1mdW5jLmxlbmd0aC0xXSBUaGUgc3RhcnQgcG9zaXRpb24gb2YgdGhlIHJlc3QgcGFyYW1ldGVyLlxuICogQHBhcmFtIHtGdW5jdGlvbn0gdHJhbnNmb3JtIFRoZSByZXN0IGFycmF5IHRyYW5zZm9ybS5cbiAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgbmV3IGZ1bmN0aW9uLlxuICovXG5mdW5jdGlvbiBvdmVyUmVzdChmdW5jLCBzdGFydCwgdHJhbnNmb3JtKSB7XG4gIHN0YXJ0ID0gbmF0aXZlTWF4KHN0YXJ0ID09PSB1bmRlZmluZWQgPyAoZnVuYy5sZW5ndGggLSAxKSA6IHN0YXJ0LCAwKTtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHZhciBhcmdzID0gYXJndW1lbnRzLFxuICAgICAgICBpbmRleCA9IC0xLFxuICAgICAgICBsZW5ndGggPSBuYXRpdmVNYXgoYXJncy5sZW5ndGggLSBzdGFydCwgMCksXG4gICAgICAgIGFycmF5ID0gQXJyYXkobGVuZ3RoKTtcblxuICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICBhcnJheVtpbmRleF0gPSBhcmdzW3N0YXJ0ICsgaW5kZXhdO1xuICAgIH1cbiAgICBpbmRleCA9IC0xO1xuICAgIHZhciBvdGhlckFyZ3MgPSBBcnJheShzdGFydCArIDEpO1xuICAgIHdoaWxlICgrK2luZGV4IDwgc3RhcnQpIHtcbiAgICAgIG90aGVyQXJnc1tpbmRleF0gPSBhcmdzW2luZGV4XTtcbiAgICB9XG4gICAgb3RoZXJBcmdzW3N0YXJ0XSA9IHRyYW5zZm9ybShhcnJheSk7XG4gICAgcmV0dXJuIGFwcGx5KGZ1bmMsIHRoaXMsIG90aGVyQXJncyk7XG4gIH07XG59XG5cbm1vZHVsZS5leHBvcnRzID0gb3ZlclJlc3Q7XG4iLCJ2YXIgZnJlZUdsb2JhbCA9IHJlcXVpcmUoJy4vX2ZyZWVHbG9iYWwnKTtcblxuLyoqIERldGVjdCBmcmVlIHZhcmlhYmxlIGBzZWxmYC4gKi9cbnZhciBmcmVlU2VsZiA9IHR5cGVvZiBzZWxmID09ICdvYmplY3QnICYmIHNlbGYgJiYgc2VsZi5PYmplY3QgPT09IE9iamVjdCAmJiBzZWxmO1xuXG4vKiogVXNlZCBhcyBhIHJlZmVyZW5jZSB0byB0aGUgZ2xvYmFsIG9iamVjdC4gKi9cbnZhciByb290ID0gZnJlZUdsb2JhbCB8fCBmcmVlU2VsZiB8fCBGdW5jdGlvbigncmV0dXJuIHRoaXMnKSgpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHJvb3Q7XG4iLCIvKipcbiAqIEdldHMgdGhlIHZhbHVlIGF0IGBrZXlgLCB1bmxlc3MgYGtleWAgaXMgXCJfX3Byb3RvX19cIi5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIHF1ZXJ5LlxuICogQHBhcmFtIHtzdHJpbmd9IGtleSBUaGUga2V5IG9mIHRoZSBwcm9wZXJ0eSB0byBnZXQuXG4gKiBAcmV0dXJucyB7Kn0gUmV0dXJucyB0aGUgcHJvcGVydHkgdmFsdWUuXG4gKi9cbmZ1bmN0aW9uIHNhZmVHZXQob2JqZWN0LCBrZXkpIHtcbiAgcmV0dXJuIGtleSA9PSAnX19wcm90b19fJ1xuICAgID8gdW5kZWZpbmVkXG4gICAgOiBvYmplY3Rba2V5XTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBzYWZlR2V0O1xuIiwidmFyIGJhc2VTZXRUb1N0cmluZyA9IHJlcXVpcmUoJy4vX2Jhc2VTZXRUb1N0cmluZycpLFxuICAgIHNob3J0T3V0ID0gcmVxdWlyZSgnLi9fc2hvcnRPdXQnKTtcblxuLyoqXG4gKiBTZXRzIHRoZSBgdG9TdHJpbmdgIG1ldGhvZCBvZiBgZnVuY2AgdG8gcmV0dXJuIGBzdHJpbmdgLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBmdW5jIFRoZSBmdW5jdGlvbiB0byBtb2RpZnkuXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBzdHJpbmcgVGhlIGB0b1N0cmluZ2AgcmVzdWx0LlxuICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIGBmdW5jYC5cbiAqL1xudmFyIHNldFRvU3RyaW5nID0gc2hvcnRPdXQoYmFzZVNldFRvU3RyaW5nKTtcblxubW9kdWxlLmV4cG9ydHMgPSBzZXRUb1N0cmluZztcbiIsIi8qKiBVc2VkIHRvIGRldGVjdCBob3QgZnVuY3Rpb25zIGJ5IG51bWJlciBvZiBjYWxscyB3aXRoaW4gYSBzcGFuIG9mIG1pbGxpc2Vjb25kcy4gKi9cbnZhciBIT1RfQ09VTlQgPSA4MDAsXG4gICAgSE9UX1NQQU4gPSAxNjtcblxuLyogQnVpbHQtaW4gbWV0aG9kIHJlZmVyZW5jZXMgZm9yIHRob3NlIHdpdGggdGhlIHNhbWUgbmFtZSBhcyBvdGhlciBgbG9kYXNoYCBtZXRob2RzLiAqL1xudmFyIG5hdGl2ZU5vdyA9IERhdGUubm93O1xuXG4vKipcbiAqIENyZWF0ZXMgYSBmdW5jdGlvbiB0aGF0J2xsIHNob3J0IG91dCBhbmQgaW52b2tlIGBpZGVudGl0eWAgaW5zdGVhZFxuICogb2YgYGZ1bmNgIHdoZW4gaXQncyBjYWxsZWQgYEhPVF9DT1VOVGAgb3IgbW9yZSB0aW1lcyBpbiBgSE9UX1NQQU5gXG4gKiBtaWxsaXNlY29uZHMuXG4gKlxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmMgVGhlIGZ1bmN0aW9uIHRvIHJlc3RyaWN0LlxuICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgc2hvcnRhYmxlIGZ1bmN0aW9uLlxuICovXG5mdW5jdGlvbiBzaG9ydE91dChmdW5jKSB7XG4gIHZhciBjb3VudCA9IDAsXG4gICAgICBsYXN0Q2FsbGVkID0gMDtcblxuICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHN0YW1wID0gbmF0aXZlTm93KCksXG4gICAgICAgIHJlbWFpbmluZyA9IEhPVF9TUEFOIC0gKHN0YW1wIC0gbGFzdENhbGxlZCk7XG5cbiAgICBsYXN0Q2FsbGVkID0gc3RhbXA7XG4gICAgaWYgKHJlbWFpbmluZyA+IDApIHtcbiAgICAgIGlmICgrK2NvdW50ID49IEhPVF9DT1VOVCkge1xuICAgICAgICByZXR1cm4gYXJndW1lbnRzWzBdO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBjb3VudCA9IDA7XG4gICAgfVxuICAgIHJldHVybiBmdW5jLmFwcGx5KHVuZGVmaW5lZCwgYXJndW1lbnRzKTtcbiAgfTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBzaG9ydE91dDtcbiIsInZhciBMaXN0Q2FjaGUgPSByZXF1aXJlKCcuL19MaXN0Q2FjaGUnKTtcblxuLyoqXG4gKiBSZW1vdmVzIGFsbCBrZXktdmFsdWUgZW50cmllcyBmcm9tIHRoZSBzdGFjay5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQG5hbWUgY2xlYXJcbiAqIEBtZW1iZXJPZiBTdGFja1xuICovXG5mdW5jdGlvbiBzdGFja0NsZWFyKCkge1xuICB0aGlzLl9fZGF0YV9fID0gbmV3IExpc3RDYWNoZTtcbiAgdGhpcy5zaXplID0gMDtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBzdGFja0NsZWFyO1xuIiwiLyoqXG4gKiBSZW1vdmVzIGBrZXlgIGFuZCBpdHMgdmFsdWUgZnJvbSB0aGUgc3RhY2suXG4gKlxuICogQHByaXZhdGVcbiAqIEBuYW1lIGRlbGV0ZVxuICogQG1lbWJlck9mIFN0YWNrXG4gKiBAcGFyYW0ge3N0cmluZ30ga2V5IFRoZSBrZXkgb2YgdGhlIHZhbHVlIHRvIHJlbW92ZS5cbiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgZW50cnkgd2FzIHJlbW92ZWQsIGVsc2UgYGZhbHNlYC5cbiAqL1xuZnVuY3Rpb24gc3RhY2tEZWxldGUoa2V5KSB7XG4gIHZhciBkYXRhID0gdGhpcy5fX2RhdGFfXyxcbiAgICAgIHJlc3VsdCA9IGRhdGFbJ2RlbGV0ZSddKGtleSk7XG5cbiAgdGhpcy5zaXplID0gZGF0YS5zaXplO1xuICByZXR1cm4gcmVzdWx0O1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHN0YWNrRGVsZXRlO1xuIiwiLyoqXG4gKiBHZXRzIHRoZSBzdGFjayB2YWx1ZSBmb3IgYGtleWAuXG4gKlxuICogQHByaXZhdGVcbiAqIEBuYW1lIGdldFxuICogQG1lbWJlck9mIFN0YWNrXG4gKiBAcGFyYW0ge3N0cmluZ30ga2V5IFRoZSBrZXkgb2YgdGhlIHZhbHVlIHRvIGdldC5cbiAqIEByZXR1cm5zIHsqfSBSZXR1cm5zIHRoZSBlbnRyeSB2YWx1ZS5cbiAqL1xuZnVuY3Rpb24gc3RhY2tHZXQoa2V5KSB7XG4gIHJldHVybiB0aGlzLl9fZGF0YV9fLmdldChrZXkpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHN0YWNrR2V0O1xuIiwiLyoqXG4gKiBDaGVja3MgaWYgYSBzdGFjayB2YWx1ZSBmb3IgYGtleWAgZXhpc3RzLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAbmFtZSBoYXNcbiAqIEBtZW1iZXJPZiBTdGFja1xuICogQHBhcmFtIHtzdHJpbmd9IGtleSBUaGUga2V5IG9mIHRoZSBlbnRyeSB0byBjaGVjay5cbiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBhbiBlbnRyeSBmb3IgYGtleWAgZXhpc3RzLCBlbHNlIGBmYWxzZWAuXG4gKi9cbmZ1bmN0aW9uIHN0YWNrSGFzKGtleSkge1xuICByZXR1cm4gdGhpcy5fX2RhdGFfXy5oYXMoa2V5KTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBzdGFja0hhcztcbiIsInZhciBMaXN0Q2FjaGUgPSByZXF1aXJlKCcuL19MaXN0Q2FjaGUnKSxcbiAgICBNYXAgPSByZXF1aXJlKCcuL19NYXAnKSxcbiAgICBNYXBDYWNoZSA9IHJlcXVpcmUoJy4vX01hcENhY2hlJyk7XG5cbi8qKiBVc2VkIGFzIHRoZSBzaXplIHRvIGVuYWJsZSBsYXJnZSBhcnJheSBvcHRpbWl6YXRpb25zLiAqL1xudmFyIExBUkdFX0FSUkFZX1NJWkUgPSAyMDA7XG5cbi8qKlxuICogU2V0cyB0aGUgc3RhY2sgYGtleWAgdG8gYHZhbHVlYC5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQG5hbWUgc2V0XG4gKiBAbWVtYmVyT2YgU3RhY2tcbiAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgVGhlIGtleSBvZiB0aGUgdmFsdWUgdG8gc2V0LlxuICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gc2V0LlxuICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyB0aGUgc3RhY2sgY2FjaGUgaW5zdGFuY2UuXG4gKi9cbmZ1bmN0aW9uIHN0YWNrU2V0KGtleSwgdmFsdWUpIHtcbiAgdmFyIGRhdGEgPSB0aGlzLl9fZGF0YV9fO1xuICBpZiAoZGF0YSBpbnN0YW5jZW9mIExpc3RDYWNoZSkge1xuICAgIHZhciBwYWlycyA9IGRhdGEuX19kYXRhX187XG4gICAgaWYgKCFNYXAgfHwgKHBhaXJzLmxlbmd0aCA8IExBUkdFX0FSUkFZX1NJWkUgLSAxKSkge1xuICAgICAgcGFpcnMucHVzaChba2V5LCB2YWx1ZV0pO1xuICAgICAgdGhpcy5zaXplID0gKytkYXRhLnNpemU7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgZGF0YSA9IHRoaXMuX19kYXRhX18gPSBuZXcgTWFwQ2FjaGUocGFpcnMpO1xuICB9XG4gIGRhdGEuc2V0KGtleSwgdmFsdWUpO1xuICB0aGlzLnNpemUgPSBkYXRhLnNpemU7XG4gIHJldHVybiB0aGlzO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHN0YWNrU2V0O1xuIiwiLyoqIFVzZWQgZm9yIGJ1aWx0LWluIG1ldGhvZCByZWZlcmVuY2VzLiAqL1xudmFyIGZ1bmNQcm90byA9IEZ1bmN0aW9uLnByb3RvdHlwZTtcblxuLyoqIFVzZWQgdG8gcmVzb2x2ZSB0aGUgZGVjb21waWxlZCBzb3VyY2Ugb2YgZnVuY3Rpb25zLiAqL1xudmFyIGZ1bmNUb1N0cmluZyA9IGZ1bmNQcm90by50b1N0cmluZztcblxuLyoqXG4gKiBDb252ZXJ0cyBgZnVuY2AgdG8gaXRzIHNvdXJjZSBjb2RlLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBmdW5jIFRoZSBmdW5jdGlvbiB0byBjb252ZXJ0LlxuICogQHJldHVybnMge3N0cmluZ30gUmV0dXJucyB0aGUgc291cmNlIGNvZGUuXG4gKi9cbmZ1bmN0aW9uIHRvU291cmNlKGZ1bmMpIHtcbiAgaWYgKGZ1bmMgIT0gbnVsbCkge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gZnVuY1RvU3RyaW5nLmNhbGwoZnVuYyk7XG4gICAgfSBjYXRjaCAoZSkge31cbiAgICB0cnkge1xuICAgICAgcmV0dXJuIChmdW5jICsgJycpO1xuICAgIH0gY2F0Y2ggKGUpIHt9XG4gIH1cbiAgcmV0dXJuICcnO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHRvU291cmNlO1xuIiwiLyoqXG4gKiBDcmVhdGVzIGEgZnVuY3Rpb24gdGhhdCByZXR1cm5zIGB2YWx1ZWAuXG4gKlxuICogQHN0YXRpY1xuICogQG1lbWJlck9mIF9cbiAqIEBzaW5jZSAyLjQuMFxuICogQGNhdGVnb3J5IFV0aWxcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIHJldHVybiBmcm9tIHRoZSBuZXcgZnVuY3Rpb24uXG4gKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyBjb25zdGFudCBmdW5jdGlvbi5cbiAqIEBleGFtcGxlXG4gKlxuICogdmFyIG9iamVjdHMgPSBfLnRpbWVzKDIsIF8uY29uc3RhbnQoeyAnYSc6IDEgfSkpO1xuICpcbiAqIGNvbnNvbGUubG9nKG9iamVjdHMpO1xuICogLy8gPT4gW3sgJ2EnOiAxIH0sIHsgJ2EnOiAxIH1dXG4gKlxuICogY29uc29sZS5sb2cob2JqZWN0c1swXSA9PT0gb2JqZWN0c1sxXSk7XG4gKiAvLyA9PiB0cnVlXG4gKi9cbmZ1bmN0aW9uIGNvbnN0YW50KHZhbHVlKSB7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdmFsdWU7XG4gIH07XG59XG5cbm1vZHVsZS5leHBvcnRzID0gY29uc3RhbnQ7XG4iLCIvKipcbiAqIFBlcmZvcm1zIGFcbiAqIFtgU2FtZVZhbHVlWmVyb2BdKGh0dHA6Ly9lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzcuMC8jc2VjLXNhbWV2YWx1ZXplcm8pXG4gKiBjb21wYXJpc29uIGJldHdlZW4gdHdvIHZhbHVlcyB0byBkZXRlcm1pbmUgaWYgdGhleSBhcmUgZXF1aXZhbGVudC5cbiAqXG4gKiBAc3RhdGljXG4gKiBAbWVtYmVyT2YgX1xuICogQHNpbmNlIDQuMC4wXG4gKiBAY2F0ZWdvcnkgTGFuZ1xuICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY29tcGFyZS5cbiAqIEBwYXJhbSB7Kn0gb3RoZXIgVGhlIG90aGVyIHZhbHVlIHRvIGNvbXBhcmUuXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIHZhbHVlcyBhcmUgZXF1aXZhbGVudCwgZWxzZSBgZmFsc2VgLlxuICogQGV4YW1wbGVcbiAqXG4gKiB2YXIgb2JqZWN0ID0geyAnYSc6IDEgfTtcbiAqIHZhciBvdGhlciA9IHsgJ2EnOiAxIH07XG4gKlxuICogXy5lcShvYmplY3QsIG9iamVjdCk7XG4gKiAvLyA9PiB0cnVlXG4gKlxuICogXy5lcShvYmplY3QsIG90aGVyKTtcbiAqIC8vID0+IGZhbHNlXG4gKlxuICogXy5lcSgnYScsICdhJyk7XG4gKiAvLyA9PiB0cnVlXG4gKlxuICogXy5lcSgnYScsIE9iamVjdCgnYScpKTtcbiAqIC8vID0+IGZhbHNlXG4gKlxuICogXy5lcShOYU4sIE5hTik7XG4gKiAvLyA9PiB0cnVlXG4gKi9cbmZ1bmN0aW9uIGVxKHZhbHVlLCBvdGhlcikge1xuICByZXR1cm4gdmFsdWUgPT09IG90aGVyIHx8ICh2YWx1ZSAhPT0gdmFsdWUgJiYgb3RoZXIgIT09IG90aGVyKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBlcTtcbiIsIi8qKlxuICogVGhpcyBtZXRob2QgcmV0dXJucyB0aGUgZmlyc3QgYXJndW1lbnQgaXQgcmVjZWl2ZXMuXG4gKlxuICogQHN0YXRpY1xuICogQHNpbmNlIDAuMS4wXG4gKiBAbWVtYmVyT2YgX1xuICogQGNhdGVnb3J5IFV0aWxcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgQW55IHZhbHVlLlxuICogQHJldHVybnMgeyp9IFJldHVybnMgYHZhbHVlYC5cbiAqIEBleGFtcGxlXG4gKlxuICogdmFyIG9iamVjdCA9IHsgJ2EnOiAxIH07XG4gKlxuICogY29uc29sZS5sb2coXy5pZGVudGl0eShvYmplY3QpID09PSBvYmplY3QpO1xuICogLy8gPT4gdHJ1ZVxuICovXG5mdW5jdGlvbiBpZGVudGl0eSh2YWx1ZSkge1xuICByZXR1cm4gdmFsdWU7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gaWRlbnRpdHk7XG4iLCJ2YXIgYmFzZUlzQXJndW1lbnRzID0gcmVxdWlyZSgnLi9fYmFzZUlzQXJndW1lbnRzJyksXG4gICAgaXNPYmplY3RMaWtlID0gcmVxdWlyZSgnLi9pc09iamVjdExpa2UnKTtcblxuLyoqIFVzZWQgZm9yIGJ1aWx0LWluIG1ldGhvZCByZWZlcmVuY2VzLiAqL1xudmFyIG9iamVjdFByb3RvID0gT2JqZWN0LnByb3RvdHlwZTtcblxuLyoqIFVzZWQgdG8gY2hlY2sgb2JqZWN0cyBmb3Igb3duIHByb3BlcnRpZXMuICovXG52YXIgaGFzT3duUHJvcGVydHkgPSBvYmplY3RQcm90by5oYXNPd25Qcm9wZXJ0eTtcblxuLyoqIEJ1aWx0LWluIHZhbHVlIHJlZmVyZW5jZXMuICovXG52YXIgcHJvcGVydHlJc0VudW1lcmFibGUgPSBvYmplY3RQcm90by5wcm9wZXJ0eUlzRW51bWVyYWJsZTtcblxuLyoqXG4gKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBsaWtlbHkgYW4gYGFyZ3VtZW50c2Agb2JqZWN0LlxuICpcbiAqIEBzdGF0aWNcbiAqIEBtZW1iZXJPZiBfXG4gKiBAc2luY2UgMC4xLjBcbiAqIEBjYXRlZ29yeSBMYW5nXG4gKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlzIGFuIGBhcmd1bWVudHNgIG9iamVjdCxcbiAqICBlbHNlIGBmYWxzZWAuXG4gKiBAZXhhbXBsZVxuICpcbiAqIF8uaXNBcmd1bWVudHMoZnVuY3Rpb24oKSB7IHJldHVybiBhcmd1bWVudHM7IH0oKSk7XG4gKiAvLyA9PiB0cnVlXG4gKlxuICogXy5pc0FyZ3VtZW50cyhbMSwgMiwgM10pO1xuICogLy8gPT4gZmFsc2VcbiAqL1xudmFyIGlzQXJndW1lbnRzID0gYmFzZUlzQXJndW1lbnRzKGZ1bmN0aW9uKCkgeyByZXR1cm4gYXJndW1lbnRzOyB9KCkpID8gYmFzZUlzQXJndW1lbnRzIDogZnVuY3Rpb24odmFsdWUpIHtcbiAgcmV0dXJuIGlzT2JqZWN0TGlrZSh2YWx1ZSkgJiYgaGFzT3duUHJvcGVydHkuY2FsbCh2YWx1ZSwgJ2NhbGxlZScpICYmXG4gICAgIXByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwodmFsdWUsICdjYWxsZWUnKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gaXNBcmd1bWVudHM7XG4iLCIvKipcbiAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGNsYXNzaWZpZWQgYXMgYW4gYEFycmF5YCBvYmplY3QuXG4gKlxuICogQHN0YXRpY1xuICogQG1lbWJlck9mIF9cbiAqIEBzaW5jZSAwLjEuMFxuICogQGNhdGVnb3J5IExhbmdcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgYW4gYXJyYXksIGVsc2UgYGZhbHNlYC5cbiAqIEBleGFtcGxlXG4gKlxuICogXy5pc0FycmF5KFsxLCAyLCAzXSk7XG4gKiAvLyA9PiB0cnVlXG4gKlxuICogXy5pc0FycmF5KGRvY3VtZW50LmJvZHkuY2hpbGRyZW4pO1xuICogLy8gPT4gZmFsc2VcbiAqXG4gKiBfLmlzQXJyYXkoJ2FiYycpO1xuICogLy8gPT4gZmFsc2VcbiAqXG4gKiBfLmlzQXJyYXkoXy5ub29wKTtcbiAqIC8vID0+IGZhbHNlXG4gKi9cbnZhciBpc0FycmF5ID0gQXJyYXkuaXNBcnJheTtcblxubW9kdWxlLmV4cG9ydHMgPSBpc0FycmF5O1xuIiwidmFyIGlzRnVuY3Rpb24gPSByZXF1aXJlKCcuL2lzRnVuY3Rpb24nKSxcbiAgICBpc0xlbmd0aCA9IHJlcXVpcmUoJy4vaXNMZW5ndGgnKTtcblxuLyoqXG4gKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBhcnJheS1saWtlLiBBIHZhbHVlIGlzIGNvbnNpZGVyZWQgYXJyYXktbGlrZSBpZiBpdCdzXG4gKiBub3QgYSBmdW5jdGlvbiBhbmQgaGFzIGEgYHZhbHVlLmxlbmd0aGAgdGhhdCdzIGFuIGludGVnZXIgZ3JlYXRlciB0aGFuIG9yXG4gKiBlcXVhbCB0byBgMGAgYW5kIGxlc3MgdGhhbiBvciBlcXVhbCB0byBgTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVJgLlxuICpcbiAqIEBzdGF0aWNcbiAqIEBtZW1iZXJPZiBfXG4gKiBAc2luY2UgNC4wLjBcbiAqIEBjYXRlZ29yeSBMYW5nXG4gKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlzIGFycmF5LWxpa2UsIGVsc2UgYGZhbHNlYC5cbiAqIEBleGFtcGxlXG4gKlxuICogXy5pc0FycmF5TGlrZShbMSwgMiwgM10pO1xuICogLy8gPT4gdHJ1ZVxuICpcbiAqIF8uaXNBcnJheUxpa2UoZG9jdW1lbnQuYm9keS5jaGlsZHJlbik7XG4gKiAvLyA9PiB0cnVlXG4gKlxuICogXy5pc0FycmF5TGlrZSgnYWJjJyk7XG4gKiAvLyA9PiB0cnVlXG4gKlxuICogXy5pc0FycmF5TGlrZShfLm5vb3ApO1xuICogLy8gPT4gZmFsc2VcbiAqL1xuZnVuY3Rpb24gaXNBcnJheUxpa2UodmFsdWUpIHtcbiAgcmV0dXJuIHZhbHVlICE9IG51bGwgJiYgaXNMZW5ndGgodmFsdWUubGVuZ3RoKSAmJiAhaXNGdW5jdGlvbih2YWx1ZSk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gaXNBcnJheUxpa2U7XG4iLCJ2YXIgaXNBcnJheUxpa2UgPSByZXF1aXJlKCcuL2lzQXJyYXlMaWtlJyksXG4gICAgaXNPYmplY3RMaWtlID0gcmVxdWlyZSgnLi9pc09iamVjdExpa2UnKTtcblxuLyoqXG4gKiBUaGlzIG1ldGhvZCBpcyBsaWtlIGBfLmlzQXJyYXlMaWtlYCBleGNlcHQgdGhhdCBpdCBhbHNvIGNoZWNrcyBpZiBgdmFsdWVgXG4gKiBpcyBhbiBvYmplY3QuXG4gKlxuICogQHN0YXRpY1xuICogQG1lbWJlck9mIF9cbiAqIEBzaW5jZSA0LjAuMFxuICogQGNhdGVnb3J5IExhbmdcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgYW4gYXJyYXktbGlrZSBvYmplY3QsXG4gKiAgZWxzZSBgZmFsc2VgLlxuICogQGV4YW1wbGVcbiAqXG4gKiBfLmlzQXJyYXlMaWtlT2JqZWN0KFsxLCAyLCAzXSk7XG4gKiAvLyA9PiB0cnVlXG4gKlxuICogXy5pc0FycmF5TGlrZU9iamVjdChkb2N1bWVudC5ib2R5LmNoaWxkcmVuKTtcbiAqIC8vID0+IHRydWVcbiAqXG4gKiBfLmlzQXJyYXlMaWtlT2JqZWN0KCdhYmMnKTtcbiAqIC8vID0+IGZhbHNlXG4gKlxuICogXy5pc0FycmF5TGlrZU9iamVjdChfLm5vb3ApO1xuICogLy8gPT4gZmFsc2VcbiAqL1xuZnVuY3Rpb24gaXNBcnJheUxpa2VPYmplY3QodmFsdWUpIHtcbiAgcmV0dXJuIGlzT2JqZWN0TGlrZSh2YWx1ZSkgJiYgaXNBcnJheUxpa2UodmFsdWUpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGlzQXJyYXlMaWtlT2JqZWN0O1xuIiwidmFyIHJvb3QgPSByZXF1aXJlKCcuL19yb290JyksXG4gICAgc3R1YkZhbHNlID0gcmVxdWlyZSgnLi9zdHViRmFsc2UnKTtcblxuLyoqIERldGVjdCBmcmVlIHZhcmlhYmxlIGBleHBvcnRzYC4gKi9cbnZhciBmcmVlRXhwb3J0cyA9IHR5cGVvZiBleHBvcnRzID09ICdvYmplY3QnICYmIGV4cG9ydHMgJiYgIWV4cG9ydHMubm9kZVR5cGUgJiYgZXhwb3J0cztcblxuLyoqIERldGVjdCBmcmVlIHZhcmlhYmxlIGBtb2R1bGVgLiAqL1xudmFyIGZyZWVNb2R1bGUgPSBmcmVlRXhwb3J0cyAmJiB0eXBlb2YgbW9kdWxlID09ICdvYmplY3QnICYmIG1vZHVsZSAmJiAhbW9kdWxlLm5vZGVUeXBlICYmIG1vZHVsZTtcblxuLyoqIERldGVjdCB0aGUgcG9wdWxhciBDb21tb25KUyBleHRlbnNpb24gYG1vZHVsZS5leHBvcnRzYC4gKi9cbnZhciBtb2R1bGVFeHBvcnRzID0gZnJlZU1vZHVsZSAmJiBmcmVlTW9kdWxlLmV4cG9ydHMgPT09IGZyZWVFeHBvcnRzO1xuXG4vKiogQnVpbHQtaW4gdmFsdWUgcmVmZXJlbmNlcy4gKi9cbnZhciBCdWZmZXIgPSBtb2R1bGVFeHBvcnRzID8gcm9vdC5CdWZmZXIgOiB1bmRlZmluZWQ7XG5cbi8qIEJ1aWx0LWluIG1ldGhvZCByZWZlcmVuY2VzIGZvciB0aG9zZSB3aXRoIHRoZSBzYW1lIG5hbWUgYXMgb3RoZXIgYGxvZGFzaGAgbWV0aG9kcy4gKi9cbnZhciBuYXRpdmVJc0J1ZmZlciA9IEJ1ZmZlciA/IEJ1ZmZlci5pc0J1ZmZlciA6IHVuZGVmaW5lZDtcblxuLyoqXG4gKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBhIGJ1ZmZlci5cbiAqXG4gKiBAc3RhdGljXG4gKiBAbWVtYmVyT2YgX1xuICogQHNpbmNlIDQuMy4wXG4gKiBAY2F0ZWdvcnkgTGFuZ1xuICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBhIGJ1ZmZlciwgZWxzZSBgZmFsc2VgLlxuICogQGV4YW1wbGVcbiAqXG4gKiBfLmlzQnVmZmVyKG5ldyBCdWZmZXIoMikpO1xuICogLy8gPT4gdHJ1ZVxuICpcbiAqIF8uaXNCdWZmZXIobmV3IFVpbnQ4QXJyYXkoMikpO1xuICogLy8gPT4gZmFsc2VcbiAqL1xudmFyIGlzQnVmZmVyID0gbmF0aXZlSXNCdWZmZXIgfHwgc3R1YkZhbHNlO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGlzQnVmZmVyO1xuIiwidmFyIGJhc2VHZXRUYWcgPSByZXF1aXJlKCcuL19iYXNlR2V0VGFnJyksXG4gICAgaXNPYmplY3QgPSByZXF1aXJlKCcuL2lzT2JqZWN0Jyk7XG5cbi8qKiBgT2JqZWN0I3RvU3RyaW5nYCByZXN1bHQgcmVmZXJlbmNlcy4gKi9cbnZhciBhc3luY1RhZyA9ICdbb2JqZWN0IEFzeW5jRnVuY3Rpb25dJyxcbiAgICBmdW5jVGFnID0gJ1tvYmplY3QgRnVuY3Rpb25dJyxcbiAgICBnZW5UYWcgPSAnW29iamVjdCBHZW5lcmF0b3JGdW5jdGlvbl0nLFxuICAgIHByb3h5VGFnID0gJ1tvYmplY3QgUHJveHldJztcblxuLyoqXG4gKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBjbGFzc2lmaWVkIGFzIGEgYEZ1bmN0aW9uYCBvYmplY3QuXG4gKlxuICogQHN0YXRpY1xuICogQG1lbWJlck9mIF9cbiAqIEBzaW5jZSAwLjEuMFxuICogQGNhdGVnb3J5IExhbmdcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgYSBmdW5jdGlvbiwgZWxzZSBgZmFsc2VgLlxuICogQGV4YW1wbGVcbiAqXG4gKiBfLmlzRnVuY3Rpb24oXyk7XG4gKiAvLyA9PiB0cnVlXG4gKlxuICogXy5pc0Z1bmN0aW9uKC9hYmMvKTtcbiAqIC8vID0+IGZhbHNlXG4gKi9cbmZ1bmN0aW9uIGlzRnVuY3Rpb24odmFsdWUpIHtcbiAgaWYgKCFpc09iamVjdCh2YWx1ZSkpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgLy8gVGhlIHVzZSBvZiBgT2JqZWN0I3RvU3RyaW5nYCBhdm9pZHMgaXNzdWVzIHdpdGggdGhlIGB0eXBlb2ZgIG9wZXJhdG9yXG4gIC8vIGluIFNhZmFyaSA5IHdoaWNoIHJldHVybnMgJ29iamVjdCcgZm9yIHR5cGVkIGFycmF5cyBhbmQgb3RoZXIgY29uc3RydWN0b3JzLlxuICB2YXIgdGFnID0gYmFzZUdldFRhZyh2YWx1ZSk7XG4gIHJldHVybiB0YWcgPT0gZnVuY1RhZyB8fCB0YWcgPT0gZ2VuVGFnIHx8IHRhZyA9PSBhc3luY1RhZyB8fCB0YWcgPT0gcHJveHlUYWc7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gaXNGdW5jdGlvbjtcbiIsIi8qKiBVc2VkIGFzIHJlZmVyZW5jZXMgZm9yIHZhcmlvdXMgYE51bWJlcmAgY29uc3RhbnRzLiAqL1xudmFyIE1BWF9TQUZFX0lOVEVHRVIgPSA5MDA3MTk5MjU0NzQwOTkxO1xuXG4vKipcbiAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGEgdmFsaWQgYXJyYXktbGlrZSBsZW5ndGguXG4gKlxuICogKipOb3RlOioqIFRoaXMgbWV0aG9kIGlzIGxvb3NlbHkgYmFzZWQgb25cbiAqIFtgVG9MZW5ndGhgXShodHRwOi8vZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi83LjAvI3NlYy10b2xlbmd0aCkuXG4gKlxuICogQHN0YXRpY1xuICogQG1lbWJlck9mIF9cbiAqIEBzaW5jZSA0LjAuMFxuICogQGNhdGVnb3J5IExhbmdcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgYSB2YWxpZCBsZW5ndGgsIGVsc2UgYGZhbHNlYC5cbiAqIEBleGFtcGxlXG4gKlxuICogXy5pc0xlbmd0aCgzKTtcbiAqIC8vID0+IHRydWVcbiAqXG4gKiBfLmlzTGVuZ3RoKE51bWJlci5NSU5fVkFMVUUpO1xuICogLy8gPT4gZmFsc2VcbiAqXG4gKiBfLmlzTGVuZ3RoKEluZmluaXR5KTtcbiAqIC8vID0+IGZhbHNlXG4gKlxuICogXy5pc0xlbmd0aCgnMycpO1xuICogLy8gPT4gZmFsc2VcbiAqL1xuZnVuY3Rpb24gaXNMZW5ndGgodmFsdWUpIHtcbiAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PSAnbnVtYmVyJyAmJlxuICAgIHZhbHVlID4gLTEgJiYgdmFsdWUgJSAxID09IDAgJiYgdmFsdWUgPD0gTUFYX1NBRkVfSU5URUdFUjtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBpc0xlbmd0aDtcbiIsIi8qKlxuICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgdGhlXG4gKiBbbGFuZ3VhZ2UgdHlwZV0oaHR0cDovL3d3dy5lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzcuMC8jc2VjLWVjbWFzY3JpcHQtbGFuZ3VhZ2UtdHlwZXMpXG4gKiBvZiBgT2JqZWN0YC4gKGUuZy4gYXJyYXlzLCBmdW5jdGlvbnMsIG9iamVjdHMsIHJlZ2V4ZXMsIGBuZXcgTnVtYmVyKDApYCwgYW5kIGBuZXcgU3RyaW5nKCcnKWApXG4gKlxuICogQHN0YXRpY1xuICogQG1lbWJlck9mIF9cbiAqIEBzaW5jZSAwLjEuMFxuICogQGNhdGVnb3J5IExhbmdcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgYW4gb2JqZWN0LCBlbHNlIGBmYWxzZWAuXG4gKiBAZXhhbXBsZVxuICpcbiAqIF8uaXNPYmplY3Qoe30pO1xuICogLy8gPT4gdHJ1ZVxuICpcbiAqIF8uaXNPYmplY3QoWzEsIDIsIDNdKTtcbiAqIC8vID0+IHRydWVcbiAqXG4gKiBfLmlzT2JqZWN0KF8ubm9vcCk7XG4gKiAvLyA9PiB0cnVlXG4gKlxuICogXy5pc09iamVjdChudWxsKTtcbiAqIC8vID0+IGZhbHNlXG4gKi9cbmZ1bmN0aW9uIGlzT2JqZWN0KHZhbHVlKSB7XG4gIHZhciB0eXBlID0gdHlwZW9mIHZhbHVlO1xuICByZXR1cm4gdmFsdWUgIT0gbnVsbCAmJiAodHlwZSA9PSAnb2JqZWN0JyB8fCB0eXBlID09ICdmdW5jdGlvbicpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGlzT2JqZWN0O1xuIiwiLyoqXG4gKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBvYmplY3QtbGlrZS4gQSB2YWx1ZSBpcyBvYmplY3QtbGlrZSBpZiBpdCdzIG5vdCBgbnVsbGBcbiAqIGFuZCBoYXMgYSBgdHlwZW9mYCByZXN1bHQgb2YgXCJvYmplY3RcIi5cbiAqXG4gKiBAc3RhdGljXG4gKiBAbWVtYmVyT2YgX1xuICogQHNpbmNlIDQuMC4wXG4gKiBAY2F0ZWdvcnkgTGFuZ1xuICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBvYmplY3QtbGlrZSwgZWxzZSBgZmFsc2VgLlxuICogQGV4YW1wbGVcbiAqXG4gKiBfLmlzT2JqZWN0TGlrZSh7fSk7XG4gKiAvLyA9PiB0cnVlXG4gKlxuICogXy5pc09iamVjdExpa2UoWzEsIDIsIDNdKTtcbiAqIC8vID0+IHRydWVcbiAqXG4gKiBfLmlzT2JqZWN0TGlrZShfLm5vb3ApO1xuICogLy8gPT4gZmFsc2VcbiAqXG4gKiBfLmlzT2JqZWN0TGlrZShudWxsKTtcbiAqIC8vID0+IGZhbHNlXG4gKi9cbmZ1bmN0aW9uIGlzT2JqZWN0TGlrZSh2YWx1ZSkge1xuICByZXR1cm4gdmFsdWUgIT0gbnVsbCAmJiB0eXBlb2YgdmFsdWUgPT0gJ29iamVjdCc7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gaXNPYmplY3RMaWtlO1xuIiwidmFyIGJhc2VHZXRUYWcgPSByZXF1aXJlKCcuL19iYXNlR2V0VGFnJyksXG4gICAgZ2V0UHJvdG90eXBlID0gcmVxdWlyZSgnLi9fZ2V0UHJvdG90eXBlJyksXG4gICAgaXNPYmplY3RMaWtlID0gcmVxdWlyZSgnLi9pc09iamVjdExpa2UnKTtcblxuLyoqIGBPYmplY3QjdG9TdHJpbmdgIHJlc3VsdCByZWZlcmVuY2VzLiAqL1xudmFyIG9iamVjdFRhZyA9ICdbb2JqZWN0IE9iamVjdF0nO1xuXG4vKiogVXNlZCBmb3IgYnVpbHQtaW4gbWV0aG9kIHJlZmVyZW5jZXMuICovXG52YXIgZnVuY1Byb3RvID0gRnVuY3Rpb24ucHJvdG90eXBlLFxuICAgIG9iamVjdFByb3RvID0gT2JqZWN0LnByb3RvdHlwZTtcblxuLyoqIFVzZWQgdG8gcmVzb2x2ZSB0aGUgZGVjb21waWxlZCBzb3VyY2Ugb2YgZnVuY3Rpb25zLiAqL1xudmFyIGZ1bmNUb1N0cmluZyA9IGZ1bmNQcm90by50b1N0cmluZztcblxuLyoqIFVzZWQgdG8gY2hlY2sgb2JqZWN0cyBmb3Igb3duIHByb3BlcnRpZXMuICovXG52YXIgaGFzT3duUHJvcGVydHkgPSBvYmplY3RQcm90by5oYXNPd25Qcm9wZXJ0eTtcblxuLyoqIFVzZWQgdG8gaW5mZXIgdGhlIGBPYmplY3RgIGNvbnN0cnVjdG9yLiAqL1xudmFyIG9iamVjdEN0b3JTdHJpbmcgPSBmdW5jVG9TdHJpbmcuY2FsbChPYmplY3QpO1xuXG4vKipcbiAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGEgcGxhaW4gb2JqZWN0LCB0aGF0IGlzLCBhbiBvYmplY3QgY3JlYXRlZCBieSB0aGVcbiAqIGBPYmplY3RgIGNvbnN0cnVjdG9yIG9yIG9uZSB3aXRoIGEgYFtbUHJvdG90eXBlXV1gIG9mIGBudWxsYC5cbiAqXG4gKiBAc3RhdGljXG4gKiBAbWVtYmVyT2YgX1xuICogQHNpbmNlIDAuOC4wXG4gKiBAY2F0ZWdvcnkgTGFuZ1xuICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBhIHBsYWluIG9iamVjdCwgZWxzZSBgZmFsc2VgLlxuICogQGV4YW1wbGVcbiAqXG4gKiBmdW5jdGlvbiBGb28oKSB7XG4gKiAgIHRoaXMuYSA9IDE7XG4gKiB9XG4gKlxuICogXy5pc1BsYWluT2JqZWN0KG5ldyBGb28pO1xuICogLy8gPT4gZmFsc2VcbiAqXG4gKiBfLmlzUGxhaW5PYmplY3QoWzEsIDIsIDNdKTtcbiAqIC8vID0+IGZhbHNlXG4gKlxuICogXy5pc1BsYWluT2JqZWN0KHsgJ3gnOiAwLCAneSc6IDAgfSk7XG4gKiAvLyA9PiB0cnVlXG4gKlxuICogXy5pc1BsYWluT2JqZWN0KE9iamVjdC5jcmVhdGUobnVsbCkpO1xuICogLy8gPT4gdHJ1ZVxuICovXG5mdW5jdGlvbiBpc1BsYWluT2JqZWN0KHZhbHVlKSB7XG4gIGlmICghaXNPYmplY3RMaWtlKHZhbHVlKSB8fCBiYXNlR2V0VGFnKHZhbHVlKSAhPSBvYmplY3RUYWcpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgdmFyIHByb3RvID0gZ2V0UHJvdG90eXBlKHZhbHVlKTtcbiAgaWYgKHByb3RvID09PSBudWxsKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgdmFyIEN0b3IgPSBoYXNPd25Qcm9wZXJ0eS5jYWxsKHByb3RvLCAnY29uc3RydWN0b3InKSAmJiBwcm90by5jb25zdHJ1Y3RvcjtcbiAgcmV0dXJuIHR5cGVvZiBDdG9yID09ICdmdW5jdGlvbicgJiYgQ3RvciBpbnN0YW5jZW9mIEN0b3IgJiZcbiAgICBmdW5jVG9TdHJpbmcuY2FsbChDdG9yKSA9PSBvYmplY3RDdG9yU3RyaW5nO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGlzUGxhaW5PYmplY3Q7XG4iLCJ2YXIgYmFzZUlzVHlwZWRBcnJheSA9IHJlcXVpcmUoJy4vX2Jhc2VJc1R5cGVkQXJyYXknKSxcbiAgICBiYXNlVW5hcnkgPSByZXF1aXJlKCcuL19iYXNlVW5hcnknKSxcbiAgICBub2RlVXRpbCA9IHJlcXVpcmUoJy4vX25vZGVVdGlsJyk7XG5cbi8qIE5vZGUuanMgaGVscGVyIHJlZmVyZW5jZXMuICovXG52YXIgbm9kZUlzVHlwZWRBcnJheSA9IG5vZGVVdGlsICYmIG5vZGVVdGlsLmlzVHlwZWRBcnJheTtcblxuLyoqXG4gKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBjbGFzc2lmaWVkIGFzIGEgdHlwZWQgYXJyYXkuXG4gKlxuICogQHN0YXRpY1xuICogQG1lbWJlck9mIF9cbiAqIEBzaW5jZSAzLjAuMFxuICogQGNhdGVnb3J5IExhbmdcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgYSB0eXBlZCBhcnJheSwgZWxzZSBgZmFsc2VgLlxuICogQGV4YW1wbGVcbiAqXG4gKiBfLmlzVHlwZWRBcnJheShuZXcgVWludDhBcnJheSk7XG4gKiAvLyA9PiB0cnVlXG4gKlxuICogXy5pc1R5cGVkQXJyYXkoW10pO1xuICogLy8gPT4gZmFsc2VcbiAqL1xudmFyIGlzVHlwZWRBcnJheSA9IG5vZGVJc1R5cGVkQXJyYXkgPyBiYXNlVW5hcnkobm9kZUlzVHlwZWRBcnJheSkgOiBiYXNlSXNUeXBlZEFycmF5O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGlzVHlwZWRBcnJheTtcbiIsInZhciBhcnJheUxpa2VLZXlzID0gcmVxdWlyZSgnLi9fYXJyYXlMaWtlS2V5cycpLFxuICAgIGJhc2VLZXlzSW4gPSByZXF1aXJlKCcuL19iYXNlS2V5c0luJyksXG4gICAgaXNBcnJheUxpa2UgPSByZXF1aXJlKCcuL2lzQXJyYXlMaWtlJyk7XG5cbi8qKlxuICogQ3JlYXRlcyBhbiBhcnJheSBvZiB0aGUgb3duIGFuZCBpbmhlcml0ZWQgZW51bWVyYWJsZSBwcm9wZXJ0eSBuYW1lcyBvZiBgb2JqZWN0YC5cbiAqXG4gKiAqKk5vdGU6KiogTm9uLW9iamVjdCB2YWx1ZXMgYXJlIGNvZXJjZWQgdG8gb2JqZWN0cy5cbiAqXG4gKiBAc3RhdGljXG4gKiBAbWVtYmVyT2YgX1xuICogQHNpbmNlIDMuMC4wXG4gKiBAY2F0ZWdvcnkgT2JqZWN0XG4gKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gcXVlcnkuXG4gKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgdGhlIGFycmF5IG9mIHByb3BlcnR5IG5hbWVzLlxuICogQGV4YW1wbGVcbiAqXG4gKiBmdW5jdGlvbiBGb28oKSB7XG4gKiAgIHRoaXMuYSA9IDE7XG4gKiAgIHRoaXMuYiA9IDI7XG4gKiB9XG4gKlxuICogRm9vLnByb3RvdHlwZS5jID0gMztcbiAqXG4gKiBfLmtleXNJbihuZXcgRm9vKTtcbiAqIC8vID0+IFsnYScsICdiJywgJ2MnXSAoaXRlcmF0aW9uIG9yZGVyIGlzIG5vdCBndWFyYW50ZWVkKVxuICovXG5mdW5jdGlvbiBrZXlzSW4ob2JqZWN0KSB7XG4gIHJldHVybiBpc0FycmF5TGlrZShvYmplY3QpID8gYXJyYXlMaWtlS2V5cyhvYmplY3QsIHRydWUpIDogYmFzZUtleXNJbihvYmplY3QpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGtleXNJbjtcbiIsInZhciBiYXNlTWVyZ2UgPSByZXF1aXJlKCcuL19iYXNlTWVyZ2UnKSxcbiAgICBjcmVhdGVBc3NpZ25lciA9IHJlcXVpcmUoJy4vX2NyZWF0ZUFzc2lnbmVyJyk7XG5cbi8qKlxuICogVGhpcyBtZXRob2QgaXMgbGlrZSBgXy5hc3NpZ25gIGV4Y2VwdCB0aGF0IGl0IHJlY3Vyc2l2ZWx5IG1lcmdlcyBvd24gYW5kXG4gKiBpbmhlcml0ZWQgZW51bWVyYWJsZSBzdHJpbmcga2V5ZWQgcHJvcGVydGllcyBvZiBzb3VyY2Ugb2JqZWN0cyBpbnRvIHRoZVxuICogZGVzdGluYXRpb24gb2JqZWN0LiBTb3VyY2UgcHJvcGVydGllcyB0aGF0IHJlc29sdmUgdG8gYHVuZGVmaW5lZGAgYXJlXG4gKiBza2lwcGVkIGlmIGEgZGVzdGluYXRpb24gdmFsdWUgZXhpc3RzLiBBcnJheSBhbmQgcGxhaW4gb2JqZWN0IHByb3BlcnRpZXNcbiAqIGFyZSBtZXJnZWQgcmVjdXJzaXZlbHkuIE90aGVyIG9iamVjdHMgYW5kIHZhbHVlIHR5cGVzIGFyZSBvdmVycmlkZGVuIGJ5XG4gKiBhc3NpZ25tZW50LiBTb3VyY2Ugb2JqZWN0cyBhcmUgYXBwbGllZCBmcm9tIGxlZnQgdG8gcmlnaHQuIFN1YnNlcXVlbnRcbiAqIHNvdXJjZXMgb3ZlcndyaXRlIHByb3BlcnR5IGFzc2lnbm1lbnRzIG9mIHByZXZpb3VzIHNvdXJjZXMuXG4gKlxuICogKipOb3RlOioqIFRoaXMgbWV0aG9kIG11dGF0ZXMgYG9iamVjdGAuXG4gKlxuICogQHN0YXRpY1xuICogQG1lbWJlck9mIF9cbiAqIEBzaW5jZSAwLjUuMFxuICogQGNhdGVnb3J5IE9iamVjdFxuICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgZGVzdGluYXRpb24gb2JqZWN0LlxuICogQHBhcmFtIHsuLi5PYmplY3R9IFtzb3VyY2VzXSBUaGUgc291cmNlIG9iamVjdHMuXG4gKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIGBvYmplY3RgLlxuICogQGV4YW1wbGVcbiAqXG4gKiB2YXIgb2JqZWN0ID0ge1xuICogICAnYSc6IFt7ICdiJzogMiB9LCB7ICdkJzogNCB9XVxuICogfTtcbiAqXG4gKiB2YXIgb3RoZXIgPSB7XG4gKiAgICdhJzogW3sgJ2MnOiAzIH0sIHsgJ2UnOiA1IH1dXG4gKiB9O1xuICpcbiAqIF8ubWVyZ2Uob2JqZWN0LCBvdGhlcik7XG4gKiAvLyA9PiB7ICdhJzogW3sgJ2InOiAyLCAnYyc6IDMgfSwgeyAnZCc6IDQsICdlJzogNSB9XSB9XG4gKi9cbnZhciBtZXJnZSA9IGNyZWF0ZUFzc2lnbmVyKGZ1bmN0aW9uKG9iamVjdCwgc291cmNlLCBzcmNJbmRleCkge1xuICBiYXNlTWVyZ2Uob2JqZWN0LCBzb3VyY2UsIHNyY0luZGV4KTtcbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1lcmdlO1xuIiwiLyoqXG4gKiBUaGlzIG1ldGhvZCByZXR1cm5zIGBmYWxzZWAuXG4gKlxuICogQHN0YXRpY1xuICogQG1lbWJlck9mIF9cbiAqIEBzaW5jZSA0LjEzLjBcbiAqIEBjYXRlZ29yeSBVdGlsXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgZmFsc2VgLlxuICogQGV4YW1wbGVcbiAqXG4gKiBfLnRpbWVzKDIsIF8uc3R1YkZhbHNlKTtcbiAqIC8vID0+IFtmYWxzZSwgZmFsc2VdXG4gKi9cbmZ1bmN0aW9uIHN0dWJGYWxzZSgpIHtcbiAgcmV0dXJuIGZhbHNlO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHN0dWJGYWxzZTtcbiIsInZhciBjb3B5T2JqZWN0ID0gcmVxdWlyZSgnLi9fY29weU9iamVjdCcpLFxuICAgIGtleXNJbiA9IHJlcXVpcmUoJy4va2V5c0luJyk7XG5cbi8qKlxuICogQ29udmVydHMgYHZhbHVlYCB0byBhIHBsYWluIG9iamVjdCBmbGF0dGVuaW5nIGluaGVyaXRlZCBlbnVtZXJhYmxlIHN0cmluZ1xuICoga2V5ZWQgcHJvcGVydGllcyBvZiBgdmFsdWVgIHRvIG93biBwcm9wZXJ0aWVzIG9mIHRoZSBwbGFpbiBvYmplY3QuXG4gKlxuICogQHN0YXRpY1xuICogQG1lbWJlck9mIF9cbiAqIEBzaW5jZSAzLjAuMFxuICogQGNhdGVnb3J5IExhbmdcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNvbnZlcnQuXG4gKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIHRoZSBjb252ZXJ0ZWQgcGxhaW4gb2JqZWN0LlxuICogQGV4YW1wbGVcbiAqXG4gKiBmdW5jdGlvbiBGb28oKSB7XG4gKiAgIHRoaXMuYiA9IDI7XG4gKiB9XG4gKlxuICogRm9vLnByb3RvdHlwZS5jID0gMztcbiAqXG4gKiBfLmFzc2lnbih7ICdhJzogMSB9LCBuZXcgRm9vKTtcbiAqIC8vID0+IHsgJ2EnOiAxLCAnYic6IDIgfVxuICpcbiAqIF8uYXNzaWduKHsgJ2EnOiAxIH0sIF8udG9QbGFpbk9iamVjdChuZXcgRm9vKSk7XG4gKiAvLyA9PiB7ICdhJzogMSwgJ2InOiAyLCAnYyc6IDMgfVxuICovXG5mdW5jdGlvbiB0b1BsYWluT2JqZWN0KHZhbHVlKSB7XG4gIHJldHVybiBjb3B5T2JqZWN0KHZhbHVlLCBrZXlzSW4odmFsdWUpKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB0b1BsYWluT2JqZWN0O1xuIiwiO3ZhciBNWElfREVCVUcgPSB0cnVlO1xuLyoqXG4gKiBtT3hpZSAtIG11bHRpLXJ1bnRpbWUgRmlsZSBBUEkgJiBYTUxIdHRwUmVxdWVzdCBMMiBQb2x5ZmlsbFxuICogdjEuNS43XG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICpcbiAqIERhdGU6IDIwMTctMTEtMDNcbiAqL1xuOyhmdW5jdGlvbiAoZ2xvYmFsLCBmYWN0b3J5KSB7XG5cdHZhciBleHRyYWN0ID0gZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGN0eCA9IHt9O1xuXHRcdGZhY3RvcnkuYXBwbHkoY3R4LCBhcmd1bWVudHMpO1xuXHRcdHJldHVybiBjdHgubW94aWU7XG5cdH07XG5cdFxuXHRpZiAodHlwZW9mIGRlZmluZSA9PT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQpIHtcblx0XHRkZWZpbmUoXCJtb3hpZVwiLCBbXSwgZXh0cmFjdCk7XG5cdH0gZWxzZSBpZiAodHlwZW9mIG1vZHVsZSA9PT0gXCJvYmplY3RcIiAmJiBtb2R1bGUuZXhwb3J0cykge1xuXHRcdG1vZHVsZS5leHBvcnRzID0gZXh0cmFjdCgpO1xuXHR9IGVsc2Uge1xuXHRcdGdsb2JhbC5tb3hpZSA9IGV4dHJhY3QoKTtcblx0fVxufSh0aGlzIHx8IHdpbmRvdywgZnVuY3Rpb24oKSB7XG4vKipcbiAqIENvbXBpbGVkIGlubGluZSB2ZXJzaW9uLiAoTGlicmFyeSBtb2RlKVxuICovXG5cbi8qanNoaW50IHNtYXJ0dGFiczp0cnVlLCB1bmRlZjp0cnVlLCBsYXRlZGVmOnRydWUsIGN1cmx5OnRydWUsIGJpdHdpc2U6dHJ1ZSwgY2FtZWxjYXNlOnRydWUgKi9cbi8qZ2xvYmFscyAkY29kZSAqL1xuXG4oZnVuY3Rpb24oZXhwb3J0cywgdW5kZWZpbmVkKSB7XG5cdFwidXNlIHN0cmljdFwiO1xuXG5cdHZhciBtb2R1bGVzID0ge307XG5cblx0ZnVuY3Rpb24gcmVxdWlyZShpZHMsIGNhbGxiYWNrKSB7XG5cdFx0dmFyIG1vZHVsZSwgZGVmcyA9IFtdO1xuXG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBpZHMubGVuZ3RoOyArK2kpIHtcblx0XHRcdG1vZHVsZSA9IG1vZHVsZXNbaWRzW2ldXSB8fCByZXNvbHZlKGlkc1tpXSk7XG5cdFx0XHRpZiAoIW1vZHVsZSkge1xuXHRcdFx0XHR0aHJvdyAnbW9kdWxlIGRlZmluaXRpb24gZGVwZW5kZWN5IG5vdCBmb3VuZDogJyArIGlkc1tpXTtcblx0XHRcdH1cblxuXHRcdFx0ZGVmcy5wdXNoKG1vZHVsZSk7XG5cdFx0fVxuXG5cdFx0Y2FsbGJhY2suYXBwbHkobnVsbCwgZGVmcyk7XG5cdH1cblxuXHRmdW5jdGlvbiBkZWZpbmUoaWQsIGRlcGVuZGVuY2llcywgZGVmaW5pdGlvbikge1xuXHRcdGlmICh0eXBlb2YgaWQgIT09ICdzdHJpbmcnKSB7XG5cdFx0XHR0aHJvdyAnaW52YWxpZCBtb2R1bGUgZGVmaW5pdGlvbiwgbW9kdWxlIGlkIG11c3QgYmUgZGVmaW5lZCBhbmQgYmUgYSBzdHJpbmcnO1xuXHRcdH1cblxuXHRcdGlmIChkZXBlbmRlbmNpZXMgPT09IHVuZGVmaW5lZCkge1xuXHRcdFx0dGhyb3cgJ2ludmFsaWQgbW9kdWxlIGRlZmluaXRpb24sIGRlcGVuZGVuY2llcyBtdXN0IGJlIHNwZWNpZmllZCc7XG5cdFx0fVxuXG5cdFx0aWYgKGRlZmluaXRpb24gPT09IHVuZGVmaW5lZCkge1xuXHRcdFx0dGhyb3cgJ2ludmFsaWQgbW9kdWxlIGRlZmluaXRpb24sIGRlZmluaXRpb24gZnVuY3Rpb24gbXVzdCBiZSBzcGVjaWZpZWQnO1xuXHRcdH1cblxuXHRcdHJlcXVpcmUoZGVwZW5kZW5jaWVzLCBmdW5jdGlvbigpIHtcblx0XHRcdG1vZHVsZXNbaWRdID0gZGVmaW5pdGlvbi5hcHBseShudWxsLCBhcmd1bWVudHMpO1xuXHRcdH0pO1xuXHR9XG5cblx0ZnVuY3Rpb24gZGVmaW5lZChpZCkge1xuXHRcdHJldHVybiAhIW1vZHVsZXNbaWRdO1xuXHR9XG5cblx0ZnVuY3Rpb24gcmVzb2x2ZShpZCkge1xuXHRcdHZhciB0YXJnZXQgPSBleHBvcnRzO1xuXHRcdHZhciBmcmFnbWVudHMgPSBpZC5zcGxpdCgvWy5cXC9dLyk7XG5cblx0XHRmb3IgKHZhciBmaSA9IDA7IGZpIDwgZnJhZ21lbnRzLmxlbmd0aDsgKytmaSkge1xuXHRcdFx0aWYgKCF0YXJnZXRbZnJhZ21lbnRzW2ZpXV0pIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHR0YXJnZXQgPSB0YXJnZXRbZnJhZ21lbnRzW2ZpXV07XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRhcmdldDtcblx0fVxuXG5cdGZ1bmN0aW9uIGV4cG9zZShpZHMpIHtcblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGlkcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0dmFyIHRhcmdldCA9IGV4cG9ydHM7XG5cdFx0XHR2YXIgaWQgPSBpZHNbaV07XG5cdFx0XHR2YXIgZnJhZ21lbnRzID0gaWQuc3BsaXQoL1suXFwvXS8pO1xuXG5cdFx0XHRmb3IgKHZhciBmaSA9IDA7IGZpIDwgZnJhZ21lbnRzLmxlbmd0aCAtIDE7ICsrZmkpIHtcblx0XHRcdFx0aWYgKHRhcmdldFtmcmFnbWVudHNbZmldXSA9PT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdFx0dGFyZ2V0W2ZyYWdtZW50c1tmaV1dID0ge307XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR0YXJnZXQgPSB0YXJnZXRbZnJhZ21lbnRzW2ZpXV07XG5cdFx0XHR9XG5cblx0XHRcdHRhcmdldFtmcmFnbWVudHNbZnJhZ21lbnRzLmxlbmd0aCAtIDFdXSA9IG1vZHVsZXNbaWRdO1xuXHRcdH1cblx0fVxuXG4vLyBJbmNsdWRlZCBmcm9tOiBzcmMvamF2YXNjcmlwdC9jb3JlL3V0aWxzL0Jhc2ljLmpzXG5cbi8qKlxuICogQmFzaWMuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuLyoqXG5AY2xhc3MgbW94aWUvY29yZS91dGlscy9CYXNpY1xuQHB1YmxpY1xuQHN0YXRpY1xuKi9cblxuZGVmaW5lKCdtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljJywgW10sIGZ1bmN0aW9uKCkge1xuXHQvKipcblx0R2V0cyB0aGUgdHJ1ZSB0eXBlIG9mIHRoZSBidWlsdC1pbiBvYmplY3QgKGJldHRlciB2ZXJzaW9uIG9mIHR5cGVvZikuXG5cdEBhdXRob3IgQW5ndXMgQ3JvbGwgKGh0dHA6Ly9qYXZhc2NyaXB0d2VibG9nLndvcmRwcmVzcy5jb20vKVxuXG5cdEBtZXRob2QgdHlwZU9mXG5cdEBzdGF0aWNcblx0QHBhcmFtIHtPYmplY3R9IG8gT2JqZWN0IHRvIGNoZWNrLlxuXHRAcmV0dXJuIHtTdHJpbmd9IE9iamVjdCBbW0NsYXNzXV1cblx0Ki9cblx0ZnVuY3Rpb24gdHlwZU9mKG8pIHtcblx0XHR2YXIgdW5kZWY7XG5cblx0XHRpZiAobyA9PT0gdW5kZWYpIHtcblx0XHRcdHJldHVybiAndW5kZWZpbmVkJztcblx0XHR9IGVsc2UgaWYgKG8gPT09IG51bGwpIHtcblx0XHRcdHJldHVybiAnbnVsbCc7XG5cdFx0fSBlbHNlIGlmIChvLm5vZGVUeXBlKSB7XG5cdFx0XHRyZXR1cm4gJ25vZGUnO1xuXHRcdH1cblxuXHRcdC8vIHRoZSBzbmlwcGV0IGJlbG93IGlzIGF3ZXNvbWUsIGhvd2V2ZXIgaXQgZmFpbHMgdG8gZGV0ZWN0IG51bGwsIHVuZGVmaW5lZCBhbmQgYXJndW1lbnRzIHR5cGVzIGluIElFIGx0ZSA4XG5cdFx0cmV0dXJuICh7fSkudG9TdHJpbmcuY2FsbChvKS5tYXRjaCgvXFxzKFthLXp8QS1aXSspLylbMV0udG9Mb3dlckNhc2UoKTtcblx0fVxuXG5cdC8qKlxuXHRFeHRlbmRzIHRoZSBzcGVjaWZpZWQgb2JqZWN0IHdpdGggYW5vdGhlciBvYmplY3QocykuXG5cblx0QG1ldGhvZCBleHRlbmRcblx0QHN0YXRpY1xuXHRAcGFyYW0ge09iamVjdH0gdGFyZ2V0IE9iamVjdCB0byBleHRlbmQuXG5cdEBwYXJhbSB7T2JqZWN0fSBbb2JqXSogTXVsdGlwbGUgb2JqZWN0cyB0byBleHRlbmQgd2l0aC5cblx0QHJldHVybiB7T2JqZWN0fSBTYW1lIGFzIHRhcmdldCwgdGhlIGV4dGVuZGVkIG9iamVjdC5cblx0Ki9cblx0ZnVuY3Rpb24gZXh0ZW5kKCkge1xuXHRcdHJldHVybiBtZXJnZShmYWxzZSwgZmFsc2UsIGFyZ3VtZW50cyk7XG5cdH1cblxuXG5cdC8qKlxuXHRFeHRlbmRzIHRoZSBzcGVjaWZpZWQgb2JqZWN0IHdpdGggYW5vdGhlciBvYmplY3QocyksIGJ1dCBvbmx5IGlmIHRoZSBwcm9wZXJ0eSBleGlzdHMgaW4gdGhlIHRhcmdldC5cblxuXHRAbWV0aG9kIGV4dGVuZElmXG5cdEBzdGF0aWNcblx0QHBhcmFtIHtPYmplY3R9IHRhcmdldCBPYmplY3QgdG8gZXh0ZW5kLlxuXHRAcGFyYW0ge09iamVjdH0gW29ial0qIE11bHRpcGxlIG9iamVjdHMgdG8gZXh0ZW5kIHdpdGguXG5cdEByZXR1cm4ge09iamVjdH0gU2FtZSBhcyB0YXJnZXQsIHRoZSBleHRlbmRlZCBvYmplY3QuXG5cdCovXG5cdGZ1bmN0aW9uIGV4dGVuZElmKCkge1xuXHRcdHJldHVybiBtZXJnZSh0cnVlLCBmYWxzZSwgYXJndW1lbnRzKTtcblx0fVxuXG5cblx0ZnVuY3Rpb24gZXh0ZW5kSW1tdXRhYmxlKCkge1xuXHRcdHJldHVybiBtZXJnZShmYWxzZSwgdHJ1ZSwgYXJndW1lbnRzKTtcblx0fVxuXG5cblx0ZnVuY3Rpb24gZXh0ZW5kSW1tdXRhYmxlSWYoKSB7XG5cdFx0cmV0dXJuIG1lcmdlKHRydWUsIHRydWUsIGFyZ3VtZW50cyk7XG5cdH1cblxuXG5cdGZ1bmN0aW9uIGNsb25lKHZhbHVlKSB7XG5cdFx0c3dpdGNoICh0eXBlT2YodmFsdWUpKSB7XG5cdFx0XHRjYXNlICdhcnJheSc6XG5cdFx0XHRcdHJldHVybiBtZXJnZShmYWxzZSwgdHJ1ZSwgW1tdLCB2YWx1ZV0pO1xuXG5cdFx0XHRjYXNlICdvYmplY3QnOlxuXHRcdFx0XHRyZXR1cm4gbWVyZ2UoZmFsc2UsIHRydWUsIFt7fSwgdmFsdWVdKTtcblxuXHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0cmV0dXJuIHZhbHVlO1xuXHRcdH1cblx0fVxuXG5cblx0ZnVuY3Rpb24gc2hhbGxvd0NvcHkob2JqKSB7XG5cdFx0c3dpdGNoICh0eXBlT2Yob2JqKSkge1xuXHRcdFx0Y2FzZSAnYXJyYXknOlxuXHRcdFx0XHRyZXR1cm4gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwob2JqKTtcblxuXHRcdFx0Y2FzZSAnb2JqZWN0Jzpcblx0XHRcdFx0cmV0dXJuIGV4dGVuZCh7fSwgb2JqKTtcblx0XHR9XG5cdFx0cmV0dXJuIG9iajtcblx0fVxuXG5cblx0ZnVuY3Rpb24gbWVyZ2Uoc3RyaWN0LCBpbW11dGFibGUsIGFyZ3MpIHtcblx0XHR2YXIgdW5kZWY7XG5cdFx0dmFyIHRhcmdldCA9IGFyZ3NbMF07XG5cblx0XHRlYWNoKGFyZ3MsIGZ1bmN0aW9uKGFyZywgaSkge1xuXHRcdFx0aWYgKGkgPiAwKSB7XG5cdFx0XHRcdGVhY2goYXJnLCBmdW5jdGlvbih2YWx1ZSwga2V5KSB7XG5cdFx0XHRcdFx0dmFyIGlzQ29tcGxleCA9IGluQXJyYXkodHlwZU9mKHZhbHVlKSwgWydhcnJheScsICdvYmplY3QnXSkgIT09IC0xO1xuXG5cdFx0XHRcdFx0aWYgKHZhbHVlID09PSB1bmRlZiB8fCBzdHJpY3QgJiYgdGFyZ2V0W2tleV0gPT09IHVuZGVmKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpZiAoaXNDb21wbGV4ICYmIGltbXV0YWJsZSkge1xuXHRcdFx0XHRcdFx0dmFsdWUgPSBzaGFsbG93Q29weSh2YWx1ZSk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKHR5cGVPZih0YXJnZXRba2V5XSkgPT09IHR5cGVPZih2YWx1ZSkgJiYgaXNDb21wbGV4KSB7XG5cdFx0XHRcdFx0XHRtZXJnZShzdHJpY3QsIGltbXV0YWJsZSwgW3RhcmdldFtrZXldLCB2YWx1ZV0pO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHR0YXJnZXRba2V5XSA9IHZhbHVlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRyZXR1cm4gdGFyZ2V0O1xuXHR9XG5cblxuXHQvKipcblx0QSB3YXkgdG8gaW5oZXJpdCBvbmUgYGNsYXNzYCBmcm9tIGFub3RoZXIgaW4gYSBjb25zaXNzdGVudCB3YXkgKG1vcmUgb3IgbGVzcylcblxuXHRAbWV0aG9kIGluaGVyaXRcblx0QHN0YXRpY1xuXHRAc2luY2UgPjEuNC4xXG5cdEBwYXJhbSB7RnVuY3Rpb259IGNoaWxkXG5cdEBwYXJhbSB7RnVuY3Rpb259IHBhcmVudFxuXHRAcmV0dXJuIHtGdW5jdGlvbn0gUHJlcGFyZWQgY29uc3RydWN0b3Jcblx0Ki9cblx0ZnVuY3Rpb24gaW5oZXJpdChjaGlsZCwgcGFyZW50KSB7XG5cdFx0Ly8gY29weSBvdmVyIGFsbCBwYXJlbnQgcHJvcGVydGllc1xuXHRcdGZvciAodmFyIGtleSBpbiBwYXJlbnQpIHtcblx0XHRcdGlmICh7fS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHBhcmVudCwga2V5KSkge1xuXHRcdFx0XHRjaGlsZFtrZXldID0gcGFyZW50W2tleV07XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gZ2l2ZSBjaGlsZCBgY2xhc3NgIGEgcGxhY2UgdG8gZGVmaW5lIGl0cyBvd24gbWV0aG9kc1xuXHRcdGZ1bmN0aW9uIGN0b3IoKSB7XG5cdFx0XHR0aGlzLmNvbnN0cnVjdG9yID0gY2hpbGQ7XG5cblx0XHRcdGlmIChNWElfREVCVUcpIHtcblx0XHRcdFx0dmFyIGdldEN0b3JOYW1lID0gZnVuY3Rpb24oZm4pIHtcblx0XHRcdFx0XHR2YXIgbSA9IGZuLnRvU3RyaW5nKCkubWF0Y2goL15mdW5jdGlvblxccyhbXlxcKFxcc10rKS8pO1xuXHRcdFx0XHRcdHJldHVybiBtID8gbVsxXSA6IGZhbHNlO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdHRoaXMuY3Rvck5hbWUgPSBnZXRDdG9yTmFtZShjaGlsZCk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGN0b3IucHJvdG90eXBlID0gcGFyZW50LnByb3RvdHlwZTtcblx0XHRjaGlsZC5wcm90b3R5cGUgPSBuZXcgY3RvcigpO1xuXG5cdFx0Ly8ga2VlcCBhIHdheSB0byByZWZlcmVuY2UgcGFyZW50IG1ldGhvZHNcblx0XHRjaGlsZC5wYXJlbnQgPSBwYXJlbnQucHJvdG90eXBlO1xuXHRcdHJldHVybiBjaGlsZDtcblx0fVxuXG5cblx0LyoqXG5cdEV4ZWN1dGVzIHRoZSBjYWxsYmFjayBmdW5jdGlvbiBmb3IgZWFjaCBpdGVtIGluIGFycmF5L29iamVjdC4gSWYgeW91IHJldHVybiBmYWxzZSBpbiB0aGVcblx0Y2FsbGJhY2sgaXQgd2lsbCBicmVhayB0aGUgbG9vcC5cblxuXHRAbWV0aG9kIGVhY2hcblx0QHN0YXRpY1xuXHRAcGFyYW0ge09iamVjdH0gb2JqIE9iamVjdCB0byBpdGVyYXRlLlxuXHRAcGFyYW0ge2Z1bmN0aW9ufSBjYWxsYmFjayBDYWxsYmFjayBmdW5jdGlvbiB0byBleGVjdXRlIGZvciBlYWNoIGl0ZW0uXG5cdCovXG5cdGZ1bmN0aW9uIGVhY2gob2JqLCBjYWxsYmFjaykge1xuXHRcdHZhciBsZW5ndGgsIGtleSwgaSwgdW5kZWY7XG5cblx0XHRpZiAob2JqKSB7XG5cdFx0XHR0cnkge1xuXHRcdFx0XHRsZW5ndGggPSBvYmoubGVuZ3RoO1xuXHRcdFx0fSBjYXRjaChleCkge1xuXHRcdFx0XHRsZW5ndGggPSB1bmRlZjtcblx0XHRcdH1cblxuXHRcdFx0aWYgKGxlbmd0aCA9PT0gdW5kZWYgfHwgdHlwZW9mKGxlbmd0aCkgIT09ICdudW1iZXInKSB7XG5cdFx0XHRcdC8vIExvb3Agb2JqZWN0IGl0ZW1zXG5cdFx0XHRcdGZvciAoa2V5IGluIG9iaikge1xuXHRcdFx0XHRcdGlmIChvYmouaGFzT3duUHJvcGVydHkoa2V5KSkge1xuXHRcdFx0XHRcdFx0aWYgKGNhbGxiYWNrKG9ialtrZXldLCBrZXkpID09PSBmYWxzZSkge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBMb29wIGFycmF5IGl0ZW1zXG5cdFx0XHRcdGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdGlmIChjYWxsYmFjayhvYmpbaV0sIGkpID09PSBmYWxzZSkge1xuXHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHRDaGVja3MgaWYgb2JqZWN0IGlzIGVtcHR5LlxuXG5cdEBtZXRob2QgaXNFbXB0eU9ialxuXHRAc3RhdGljXG5cdEBwYXJhbSB7T2JqZWN0fSBvIE9iamVjdCB0byBjaGVjay5cblx0QHJldHVybiB7Qm9vbGVhbn1cblx0Ki9cblx0ZnVuY3Rpb24gaXNFbXB0eU9iaihvYmopIHtcblx0XHR2YXIgcHJvcDtcblxuXHRcdGlmICghb2JqIHx8IHR5cGVPZihvYmopICE9PSAnb2JqZWN0Jykge1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXG5cdFx0Zm9yIChwcm9wIGluIG9iaikge1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblxuXHRcdHJldHVybiB0cnVlO1xuXHR9XG5cblx0LyoqXG5cdFJlY2lldmUgYW4gYXJyYXkgb2YgZnVuY3Rpb25zICh1c3VhbGx5IGFzeW5jKSB0byBjYWxsIGluIHNlcXVlbmNlLCBlYWNoICBmdW5jdGlvblxuXHRyZWNlaXZlcyBhIGNhbGxiYWNrIGFzIGZpcnN0IGFyZ3VtZW50IHRoYXQgaXQgc2hvdWxkIGNhbGwsIHdoZW4gaXQgY29tcGxldGVzLiBGaW5hbGx5LFxuXHRhZnRlciBldmVyeXRoaW5nIGlzIGNvbXBsZXRlLCBtYWluIGNhbGxiYWNrIGlzIGNhbGxlZC4gUGFzc2luZyB0cnV0aHkgdmFsdWUgdG8gdGhlXG5cdGNhbGxiYWNrIGFzIGEgZmlyc3QgYXJndW1lbnQgd2lsbCBpbnRlcnJ1cHQgdGhlIHNlcXVlbmNlIGFuZCBpbnZva2UgbWFpbiBjYWxsYmFja1xuXHRpbW1lZGlhdGVseS5cblxuXHRAbWV0aG9kIGluU2VyaWVzXG5cdEBzdGF0aWNcblx0QHBhcmFtIHtBcnJheX0gcXVldWUgQXJyYXkgb2YgZnVuY3Rpb25zIHRvIGNhbGwgaW4gc2VxdWVuY2Vcblx0QHBhcmFtIHtGdW5jdGlvbn0gY2IgTWFpbiBjYWxsYmFjayB0aGF0IGlzIGNhbGxlZCBpbiB0aGUgZW5kLCBvciBpbiBjYXNlIG9mIGVycm9yXG5cdCovXG5cdGZ1bmN0aW9uIGluU2VyaWVzKHF1ZXVlLCBjYikge1xuXHRcdHZhciBpID0gMCwgbGVuZ3RoID0gcXVldWUubGVuZ3RoO1xuXG5cdFx0aWYgKHR5cGVPZihjYikgIT09ICdmdW5jdGlvbicpIHtcblx0XHRcdGNiID0gZnVuY3Rpb24oKSB7fTtcblx0XHR9XG5cblx0XHRpZiAoIXF1ZXVlIHx8ICFxdWV1ZS5sZW5ndGgpIHtcblx0XHRcdGNiKCk7XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gY2FsbE5leHQoaSkge1xuXHRcdFx0aWYgKHR5cGVPZihxdWV1ZVtpXSkgPT09ICdmdW5jdGlvbicpIHtcblx0XHRcdFx0cXVldWVbaV0oZnVuY3Rpb24oZXJyb3IpIHtcblx0XHRcdFx0XHQvKmpzaGludCBleHByOnRydWUgKi9cblx0XHRcdFx0XHQrK2kgPCBsZW5ndGggJiYgIWVycm9yID8gY2FsbE5leHQoaSkgOiBjYihlcnJvcik7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRjYWxsTmV4dChpKTtcblx0fVxuXG5cblx0LyoqXG5cdFJlY2lldmUgYW4gYXJyYXkgb2YgZnVuY3Rpb25zICh1c3VhbGx5IGFzeW5jKSB0byBjYWxsIGluIHBhcmFsbGVsLCBlYWNoICBmdW5jdGlvblxuXHRyZWNlaXZlcyBhIGNhbGxiYWNrIGFzIGZpcnN0IGFyZ3VtZW50IHRoYXQgaXQgc2hvdWxkIGNhbGwsIHdoZW4gaXQgY29tcGxldGVzLiBBZnRlclxuXHRldmVyeXRoaW5nIGlzIGNvbXBsZXRlLCBtYWluIGNhbGxiYWNrIGlzIGNhbGxlZC4gUGFzc2luZyB0cnV0aHkgdmFsdWUgdG8gdGhlXG5cdGNhbGxiYWNrIGFzIGEgZmlyc3QgYXJndW1lbnQgd2lsbCBpbnRlcnJ1cHQgdGhlIHByb2Nlc3MgYW5kIGludm9rZSBtYWluIGNhbGxiYWNrXG5cdGltbWVkaWF0ZWx5LlxuXG5cdEBtZXRob2QgaW5QYXJhbGxlbFxuXHRAc3RhdGljXG5cdEBwYXJhbSB7QXJyYXl9IHF1ZXVlIEFycmF5IG9mIGZ1bmN0aW9ucyB0byBjYWxsIGluIHNlcXVlbmNlXG5cdEBwYXJhbSB7RnVuY3Rpb259IGNiIE1haW4gY2FsbGJhY2sgdGhhdCBpcyBjYWxsZWQgaW4gdGhlIGVuZCwgb3IgaW4gY2FzZSBvZiBlcnJvXG5cdCovXG5cdGZ1bmN0aW9uIGluUGFyYWxsZWwocXVldWUsIGNiKSB7XG5cdFx0dmFyIGNvdW50ID0gMCwgbnVtID0gcXVldWUubGVuZ3RoLCBjYkFyZ3MgPSBuZXcgQXJyYXkobnVtKTtcblxuXHRcdGVhY2gocXVldWUsIGZ1bmN0aW9uKGZuLCBpKSB7XG5cdFx0XHRmbihmdW5jdGlvbihlcnJvcikge1xuXHRcdFx0XHRpZiAoZXJyb3IpIHtcblx0XHRcdFx0XHRyZXR1cm4gY2IoZXJyb3IpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0dmFyIGFyZ3MgPSBbXS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7XG5cdFx0XHRcdGFyZ3Muc2hpZnQoKTsgLy8gc3RyaXAgZXJyb3IgLSB1bmRlZmluZWQgb3Igbm90XG5cblx0XHRcdFx0Y2JBcmdzW2ldID0gYXJncztcblx0XHRcdFx0Y291bnQrKztcblxuXHRcdFx0XHRpZiAoY291bnQgPT09IG51bSkge1xuXHRcdFx0XHRcdGNiQXJncy51bnNoaWZ0KG51bGwpO1xuXHRcdFx0XHRcdGNiLmFwcGx5KHRoaXMsIGNiQXJncyk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH0pO1xuXHR9XG5cblxuXHQvKipcblx0RmluZCBhbiBlbGVtZW50IGluIGFycmF5IGFuZCByZXR1cm4gaXQncyBpbmRleCBpZiBwcmVzZW50LCBvdGhlcndpc2UgcmV0dXJuIC0xLlxuXG5cdEBtZXRob2QgaW5BcnJheVxuXHRAc3RhdGljXG5cdEBwYXJhbSB7TWl4ZWR9IG5lZWRsZSBFbGVtZW50IHRvIGZpbmRcblx0QHBhcmFtIHtBcnJheX0gYXJyYXlcblx0QHJldHVybiB7SW50fSBJbmRleCBvZiB0aGUgZWxlbWVudCwgb3IgLTEgaWYgbm90IGZvdW5kXG5cdCovXG5cdGZ1bmN0aW9uIGluQXJyYXkobmVlZGxlLCBhcnJheSkge1xuXHRcdGlmIChhcnJheSkge1xuXHRcdFx0aWYgKEFycmF5LnByb3RvdHlwZS5pbmRleE9mKSB7XG5cdFx0XHRcdHJldHVybiBBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKGFycmF5LCBuZWVkbGUpO1xuXHRcdFx0fVxuXG5cdFx0XHRmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0gYXJyYXkubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0aWYgKGFycmF5W2ldID09PSBuZWVkbGUpIHtcblx0XHRcdFx0XHRyZXR1cm4gaTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gLTE7XG5cdH1cblxuXG5cdC8qKlxuXHRSZXR1cm5zIGVsZW1lbnRzIG9mIGZpcnN0IGFycmF5IGlmIHRoZXkgYXJlIG5vdCBwcmVzZW50IGluIHNlY29uZC4gQW5kIGZhbHNlIC0gb3RoZXJ3aXNlLlxuXG5cdEBwcml2YXRlXG5cdEBtZXRob2QgYXJyYXlEaWZmXG5cdEBwYXJhbSB7QXJyYXl9IG5lZWRsZXNcblx0QHBhcmFtIHtBcnJheX0gYXJyYXlcblx0QHJldHVybiB7QXJyYXl8Qm9vbGVhbn1cblx0Ki9cblx0ZnVuY3Rpb24gYXJyYXlEaWZmKG5lZWRsZXMsIGFycmF5KSB7XG5cdFx0dmFyIGRpZmYgPSBbXTtcblxuXHRcdGlmICh0eXBlT2YobmVlZGxlcykgIT09ICdhcnJheScpIHtcblx0XHRcdG5lZWRsZXMgPSBbbmVlZGxlc107XG5cdFx0fVxuXG5cdFx0aWYgKHR5cGVPZihhcnJheSkgIT09ICdhcnJheScpIHtcblx0XHRcdGFycmF5ID0gW2FycmF5XTtcblx0XHR9XG5cblx0XHRmb3IgKHZhciBpIGluIG5lZWRsZXMpIHtcblx0XHRcdGlmIChpbkFycmF5KG5lZWRsZXNbaV0sIGFycmF5KSA9PT0gLTEpIHtcblx0XHRcdFx0ZGlmZi5wdXNoKG5lZWRsZXNbaV0pO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gZGlmZi5sZW5ndGggPyBkaWZmIDogZmFsc2U7XG5cdH1cblxuXG5cdC8qKlxuXHRGaW5kIGludGVyc2VjdGlvbiBvZiB0d28gYXJyYXlzLlxuXG5cdEBwcml2YXRlXG5cdEBtZXRob2QgYXJyYXlJbnRlcnNlY3Rcblx0QHBhcmFtIHtBcnJheX0gYXJyYXkxXG5cdEBwYXJhbSB7QXJyYXl9IGFycmF5MlxuXHRAcmV0dXJuIHtBcnJheX0gSW50ZXJzZWN0aW9uIG9mIHR3byBhcnJheXMgb3IgbnVsbCBpZiB0aGVyZSBpcyBub25lXG5cdCovXG5cdGZ1bmN0aW9uIGFycmF5SW50ZXJzZWN0KGFycmF5MSwgYXJyYXkyKSB7XG5cdFx0dmFyIHJlc3VsdCA9IFtdO1xuXHRcdGVhY2goYXJyYXkxLCBmdW5jdGlvbihpdGVtKSB7XG5cdFx0XHRpZiAoaW5BcnJheShpdGVtLCBhcnJheTIpICE9PSAtMSkge1xuXHRcdFx0XHRyZXN1bHQucHVzaChpdGVtKTtcblx0XHRcdH1cblx0XHR9KTtcblx0XHRyZXR1cm4gcmVzdWx0Lmxlbmd0aCA/IHJlc3VsdCA6IG51bGw7XG5cdH1cblxuXG5cdC8qKlxuXHRGb3JjZXMgYW55dGhpbmcgaW50byBhbiBhcnJheS5cblxuXHRAbWV0aG9kIHRvQXJyYXlcblx0QHN0YXRpY1xuXHRAcGFyYW0ge09iamVjdH0gb2JqIE9iamVjdCB3aXRoIGxlbmd0aCBmaWVsZC5cblx0QHJldHVybiB7QXJyYXl9IEFycmF5IG9iamVjdCBjb250YWluaW5nIGFsbCBpdGVtcy5cblx0Ki9cblx0ZnVuY3Rpb24gdG9BcnJheShvYmopIHtcblx0XHR2YXIgaSwgYXJyID0gW107XG5cblx0XHRmb3IgKGkgPSAwOyBpIDwgb2JqLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRhcnJbaV0gPSBvYmpbaV07XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGFycjtcblx0fVxuXG5cblx0LyoqXG5cdEdlbmVyYXRlcyBhbiB1bmlxdWUgSUQuIFRoZSBvbmx5IHdheSBhIHVzZXIgd291bGQgYmUgYWJsZSB0byBnZXQgdGhlIHNhbWUgSUQgaXMgaWYgdGhlIHR3byBwZXJzb25zXG5cdGF0IHRoZSBzYW1lIGV4YWN0IG1pbGxpc2Vjb25kIG1hbmFnZSB0byBnZXQgdGhlIHNhbWUgNSByYW5kb20gbnVtYmVycyBiZXR3ZWVuIDAtNjU1MzU7IGl0IGFsc28gdXNlc1xuXHRhIGNvdW50ZXIgc28gZWFjaCBJRCBpcyBndWFyYW50ZWVkIHRvIGJlIHVuaXF1ZSBmb3IgdGhlIGdpdmVuIHBhZ2UuIEl0IGlzIG1vcmUgcHJvYmFibGUgZm9yIHRoZSBlYXJ0aFxuXHR0byBiZSBoaXQgd2l0aCBhbiBhc3Rlcm9pZC5cblxuXHRAbWV0aG9kIGd1aWRcblx0QHN0YXRpY1xuXHRAcGFyYW0ge1N0cmluZ30gcHJlZml4IHRvIHByZXBlbmQgKGJ5IGRlZmF1bHQgJ28nIHdpbGwgYmUgcHJlcGVuZGVkKS5cblx0QG1ldGhvZCBndWlkXG5cdEByZXR1cm4ge1N0cmluZ30gVmlydHVhbGx5IHVuaXF1ZSBpZC5cblx0Ki9cblx0dmFyIGd1aWQgPSAoZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGNvdW50ZXIgPSAwO1xuXG5cdFx0cmV0dXJuIGZ1bmN0aW9uKHByZWZpeCkge1xuXHRcdFx0dmFyIGd1aWQgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKS50b1N0cmluZygzMiksIGk7XG5cblx0XHRcdGZvciAoaSA9IDA7IGkgPCA1OyBpKyspIHtcblx0XHRcdFx0Z3VpZCArPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA2NTUzNSkudG9TdHJpbmcoMzIpO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gKHByZWZpeCB8fCAnb18nKSArIGd1aWQgKyAoY291bnRlcisrKS50b1N0cmluZygzMik7XG5cdFx0fTtcblx0fSgpKTtcblxuXG5cdC8qKlxuXHRUcmltcyB3aGl0ZSBzcGFjZXMgYXJvdW5kIHRoZSBzdHJpbmdcblxuXHRAbWV0aG9kIHRyaW1cblx0QHN0YXRpY1xuXHRAcGFyYW0ge1N0cmluZ30gc3RyXG5cdEByZXR1cm4ge1N0cmluZ31cblx0Ki9cblx0ZnVuY3Rpb24gdHJpbShzdHIpIHtcblx0XHRpZiAoIXN0cikge1xuXHRcdFx0cmV0dXJuIHN0cjtcblx0XHR9XG5cdFx0cmV0dXJuIFN0cmluZy5wcm90b3R5cGUudHJpbSA/IFN0cmluZy5wcm90b3R5cGUudHJpbS5jYWxsKHN0cikgOiBzdHIudG9TdHJpbmcoKS5yZXBsYWNlKC9eXFxzKi8sICcnKS5yZXBsYWNlKC9cXHMqJC8sICcnKTtcblx0fVxuXG5cblx0LyoqXG5cdFBhcnNlcyB0aGUgc3BlY2lmaWVkIHNpemUgc3RyaW5nIGludG8gYSBieXRlIHZhbHVlLiBGb3IgZXhhbXBsZSAxMGtiIGJlY29tZXMgMTAyNDAuXG5cblx0QG1ldGhvZCBwYXJzZVNpemVTdHJcblx0QHN0YXRpY1xuXHRAcGFyYW0ge1N0cmluZy9OdW1iZXJ9IHNpemUgU3RyaW5nIHRvIHBhcnNlIG9yIG51bWJlciB0byBqdXN0IHBhc3MgdGhyb3VnaC5cblx0QHJldHVybiB7TnVtYmVyfSBTaXplIGluIGJ5dGVzLlxuXHQqL1xuXHRmdW5jdGlvbiBwYXJzZVNpemVTdHIoc2l6ZSkge1xuXHRcdGlmICh0eXBlb2Yoc2l6ZSkgIT09ICdzdHJpbmcnKSB7XG5cdFx0XHRyZXR1cm4gc2l6ZTtcblx0XHR9XG5cblx0XHR2YXIgbXVscyA9IHtcblx0XHRcdFx0dDogMTA5OTUxMTYyNzc3Nixcblx0XHRcdFx0ZzogMTA3Mzc0MTgyNCxcblx0XHRcdFx0bTogMTA0ODU3Nixcblx0XHRcdFx0azogMTAyNFxuXHRcdFx0fSxcblx0XHRcdG11bDtcblxuXHRcdHNpemUgPSAvXihbMC05XFwuXSspKFt0bWdrXT8pJC8uZXhlYyhzaXplLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvW14wLTlcXC50bWtnXS9nLCAnJykpO1xuXHRcdG11bCA9IHNpemVbMl07XG5cdFx0c2l6ZSA9ICtzaXplWzFdO1xuXG5cdFx0aWYgKG11bHMuaGFzT3duUHJvcGVydHkobXVsKSkge1xuXHRcdFx0c2l6ZSAqPSBtdWxzW211bF07XG5cdFx0fVxuXHRcdHJldHVybiBNYXRoLmZsb29yKHNpemUpO1xuXHR9XG5cblxuXHQvKipcblx0ICogUHNldWRvIHNwcmludGYgaW1wbGVtZW50YXRpb24gLSBzaW1wbGUgd2F5IHRvIHJlcGxhY2UgdG9rZW5zIHdpdGggc3BlY2lmaWVkIHZhbHVlcy5cblx0ICpcblx0ICogQHBhcmFtIHtTdHJpbmd9IHN0ciBTdHJpbmcgd2l0aCB0b2tlbnNcblx0ICogQHJldHVybiB7U3RyaW5nfSBTdHJpbmcgd2l0aCByZXBsYWNlZCB0b2tlbnNcblx0ICovXG5cdGZ1bmN0aW9uIHNwcmludGYoc3RyKSB7XG5cdFx0dmFyIGFyZ3MgPSBbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7XG5cblx0XHRyZXR1cm4gc3RyLnJlcGxhY2UoLyUoW2Etel0pL2csIGZ1bmN0aW9uKCQwLCAkMSkge1xuXHRcdFx0dmFyIHZhbHVlID0gYXJncy5zaGlmdCgpO1xuXG5cdFx0XHRzd2l0Y2ggKCQxKSB7XG5cdFx0XHRcdGNhc2UgJ3MnOlxuXHRcdFx0XHRcdHJldHVybiB2YWx1ZSArICcnO1xuXG5cdFx0XHRcdGNhc2UgJ2QnOlxuXHRcdFx0XHRcdHJldHVybiBwYXJzZUludCh2YWx1ZSwgMTApO1xuXG5cdFx0XHRcdGNhc2UgJ2YnOlxuXHRcdFx0XHRcdHJldHVybiBwYXJzZUZsb2F0KHZhbHVlKTtcblxuXHRcdFx0XHRjYXNlICdjJzpcblx0XHRcdFx0XHRyZXR1cm4gJyc7XG5cblx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0XHRyZXR1cm4gdmFsdWU7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXG5cblx0ZnVuY3Rpb24gZGVsYXkoY2IsIHRpbWVvdXQpIHtcblx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cdFx0c2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0XHRcdGNiLmNhbGwoc2VsZik7XG5cdFx0fSwgdGltZW91dCB8fCAxKTtcblx0fVxuXG5cblx0cmV0dXJuIHtcblx0XHRndWlkOiBndWlkLFxuXHRcdHR5cGVPZjogdHlwZU9mLFxuXHRcdGV4dGVuZDogZXh0ZW5kLFxuXHRcdGV4dGVuZElmOiBleHRlbmRJZixcblx0XHRleHRlbmRJbW11dGFibGU6IGV4dGVuZEltbXV0YWJsZSxcblx0XHRleHRlbmRJbW11dGFibGVJZjogZXh0ZW5kSW1tdXRhYmxlSWYsXG5cdFx0Y2xvbmU6IGNsb25lLFxuXHRcdGluaGVyaXQ6IGluaGVyaXQsXG5cdFx0ZWFjaDogZWFjaCxcblx0XHRpc0VtcHR5T2JqOiBpc0VtcHR5T2JqLFxuXHRcdGluU2VyaWVzOiBpblNlcmllcyxcblx0XHRpblBhcmFsbGVsOiBpblBhcmFsbGVsLFxuXHRcdGluQXJyYXk6IGluQXJyYXksXG5cdFx0YXJyYXlEaWZmOiBhcnJheURpZmYsXG5cdFx0YXJyYXlJbnRlcnNlY3Q6IGFycmF5SW50ZXJzZWN0LFxuXHRcdHRvQXJyYXk6IHRvQXJyYXksXG5cdFx0dHJpbTogdHJpbSxcblx0XHRzcHJpbnRmOiBzcHJpbnRmLFxuXHRcdHBhcnNlU2l6ZVN0cjogcGFyc2VTaXplU3RyLFxuXHRcdGRlbGF5OiBkZWxheVxuXHR9O1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L2NvcmUvdXRpbHMvRW5jb2RlLmpzXG5cbi8qKlxuICogRW5jb2RlLmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG5cbi8qKlxuQGNsYXNzIG1veGllL2NvcmUvdXRpbHMvRW5jb2RlXG5AcHVibGljXG5Ac3RhdGljXG4qL1xuXG5kZWZpbmUoJ21veGllL2NvcmUvdXRpbHMvRW5jb2RlJywgW10sIGZ1bmN0aW9uKCkge1xuXG5cdC8qKlxuXHRFbmNvZGUgc3RyaW5nIHdpdGggVVRGLThcblxuXHRAbWV0aG9kIHV0ZjhfZW5jb2RlXG5cdEBzdGF0aWNcblx0QHBhcmFtIHtTdHJpbmd9IHN0ciBTdHJpbmcgdG8gZW5jb2RlXG5cdEByZXR1cm4ge1N0cmluZ30gVVRGLTggZW5jb2RlZCBzdHJpbmdcblx0Ki9cblx0dmFyIHV0ZjhfZW5jb2RlID0gZnVuY3Rpb24oc3RyKSB7XG5cdFx0cmV0dXJuIHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChzdHIpKTtcblx0fTtcblx0XG5cdC8qKlxuXHREZWNvZGUgVVRGLTggZW5jb2RlZCBzdHJpbmdcblxuXHRAbWV0aG9kIHV0ZjhfZGVjb2RlXG5cdEBzdGF0aWNcblx0QHBhcmFtIHtTdHJpbmd9IHN0ciBTdHJpbmcgdG8gZGVjb2RlXG5cdEByZXR1cm4ge1N0cmluZ30gRGVjb2RlZCBzdHJpbmdcblx0Ki9cblx0dmFyIHV0ZjhfZGVjb2RlID0gZnVuY3Rpb24oc3RyX2RhdGEpIHtcblx0XHRyZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KGVzY2FwZShzdHJfZGF0YSkpO1xuXHR9O1xuXHRcblx0LyoqXG5cdERlY29kZSBCYXNlNjQgZW5jb2RlZCBzdHJpbmcgKHVzZXMgYnJvd3NlcidzIGRlZmF1bHQgbWV0aG9kIGlmIGF2YWlsYWJsZSksXG5cdGZyb206IGh0dHBzOi8vcmF3LmdpdGh1Yi5jb20va3Z6L3BocGpzL21hc3Rlci9mdW5jdGlvbnMvdXJsL2Jhc2U2NF9kZWNvZGUuanNcblxuXHRAbWV0aG9kIGF0b2Jcblx0QHN0YXRpY1xuXHRAcGFyYW0ge1N0cmluZ30gZGF0YSBTdHJpbmcgdG8gZGVjb2RlXG5cdEByZXR1cm4ge1N0cmluZ30gRGVjb2RlZCBzdHJpbmdcblx0Ki9cblx0dmFyIGF0b2IgPSBmdW5jdGlvbihkYXRhLCB1dGY4KSB7XG5cdFx0aWYgKHR5cGVvZih3aW5kb3cuYXRvYikgPT09ICdmdW5jdGlvbicpIHtcblx0XHRcdHJldHVybiB1dGY4ID8gdXRmOF9kZWNvZGUod2luZG93LmF0b2IoZGF0YSkpIDogd2luZG93LmF0b2IoZGF0YSk7XG5cdFx0fVxuXG5cdFx0Ly8gaHR0cDovL2tldmluLnZhbnpvbm5ldmVsZC5uZXRcblx0XHQvLyArICAgb3JpZ2luYWwgYnk6IFR5bGVyIEFraW5zIChodHRwOi8vcnVta2luLmNvbSlcblx0XHQvLyArICAgaW1wcm92ZWQgYnk6IFRodW5kZXIubVxuXHRcdC8vICsgICAgICBpbnB1dCBieTogQW1hbiBHdXB0YVxuXHRcdC8vICsgICBpbXByb3ZlZCBieTogS2V2aW4gdmFuIFpvbm5ldmVsZCAoaHR0cDovL2tldmluLnZhbnpvbm5ldmVsZC5uZXQpXG5cdFx0Ly8gKyAgIGJ1Z2ZpeGVkIGJ5OiBPbm5vIE1hcnNtYW5cblx0XHQvLyArICAgYnVnZml4ZWQgYnk6IFBlbGxlbnRlc3F1ZSBNYWxlc3VhZGFcblx0XHQvLyArICAgaW1wcm92ZWQgYnk6IEtldmluIHZhbiBab25uZXZlbGQgKGh0dHA6Ly9rZXZpbi52YW56b25uZXZlbGQubmV0KVxuXHRcdC8vICsgICAgICBpbnB1dCBieTogQnJldHQgWmFtaXIgKGh0dHA6Ly9icmV0dC16YW1pci5tZSlcblx0XHQvLyArICAgYnVnZml4ZWQgYnk6IEtldmluIHZhbiBab25uZXZlbGQgKGh0dHA6Ly9rZXZpbi52YW56b25uZXZlbGQubmV0KVxuXHRcdC8vICogICAgIGV4YW1wbGUgMTogYmFzZTY0X2RlY29kZSgnUzJWMmFXNGdkbUZ1SUZwdmJtNWxkbVZzWkE9PScpO1xuXHRcdC8vICogICAgIHJldHVybnMgMTogJ0tldmluIHZhbiBab25uZXZlbGQnXG5cdFx0Ly8gbW96aWxsYSBoYXMgdGhpcyBuYXRpdmVcblx0XHQvLyAtIGJ1dCBicmVha3MgaW4gMi4wLjAuMTIhXG5cdFx0Ly9pZiAodHlwZW9mIHRoaXMud2luZG93LmF0b2IgPT0gJ2Z1bmN0aW9uJykge1xuXHRcdC8vICAgIHJldHVybiBhdG9iKGRhdGEpO1xuXHRcdC8vfVxuXHRcdHZhciBiNjQgPSBcIkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky89XCI7XG5cdFx0dmFyIG8xLCBvMiwgbzMsIGgxLCBoMiwgaDMsIGg0LCBiaXRzLCBpID0gMCxcblx0XHRcdGFjID0gMCxcblx0XHRcdGRlYyA9IFwiXCIsXG5cdFx0XHR0bXBfYXJyID0gW107XG5cblx0XHRpZiAoIWRhdGEpIHtcblx0XHRcdHJldHVybiBkYXRhO1xuXHRcdH1cblxuXHRcdGRhdGEgKz0gJyc7XG5cblx0XHRkbyB7IC8vIHVucGFjayBmb3VyIGhleGV0cyBpbnRvIHRocmVlIG9jdGV0cyB1c2luZyBpbmRleCBwb2ludHMgaW4gYjY0XG5cdFx0XHRoMSA9IGI2NC5pbmRleE9mKGRhdGEuY2hhckF0KGkrKykpO1xuXHRcdFx0aDIgPSBiNjQuaW5kZXhPZihkYXRhLmNoYXJBdChpKyspKTtcblx0XHRcdGgzID0gYjY0LmluZGV4T2YoZGF0YS5jaGFyQXQoaSsrKSk7XG5cdFx0XHRoNCA9IGI2NC5pbmRleE9mKGRhdGEuY2hhckF0KGkrKykpO1xuXG5cdFx0XHRiaXRzID0gaDEgPDwgMTggfCBoMiA8PCAxMiB8IGgzIDw8IDYgfCBoNDtcblxuXHRcdFx0bzEgPSBiaXRzID4+IDE2ICYgMHhmZjtcblx0XHRcdG8yID0gYml0cyA+PiA4ICYgMHhmZjtcblx0XHRcdG8zID0gYml0cyAmIDB4ZmY7XG5cblx0XHRcdGlmIChoMyA9PSA2NCkge1xuXHRcdFx0XHR0bXBfYXJyW2FjKytdID0gU3RyaW5nLmZyb21DaGFyQ29kZShvMSk7XG5cdFx0XHR9IGVsc2UgaWYgKGg0ID09IDY0KSB7XG5cdFx0XHRcdHRtcF9hcnJbYWMrK10gPSBTdHJpbmcuZnJvbUNoYXJDb2RlKG8xLCBvMik7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0bXBfYXJyW2FjKytdID0gU3RyaW5nLmZyb21DaGFyQ29kZShvMSwgbzIsIG8zKTtcblx0XHRcdH1cblx0XHR9IHdoaWxlIChpIDwgZGF0YS5sZW5ndGgpO1xuXG5cdFx0ZGVjID0gdG1wX2Fyci5qb2luKCcnKTtcblxuXHRcdHJldHVybiB1dGY4ID8gdXRmOF9kZWNvZGUoZGVjKSA6IGRlYztcblx0fTtcblx0XG5cdC8qKlxuXHRCYXNlNjQgZW5jb2RlIHN0cmluZyAodXNlcyBicm93c2VyJ3MgZGVmYXVsdCBtZXRob2QgaWYgYXZhaWxhYmxlKSxcblx0ZnJvbTogaHR0cHM6Ly9yYXcuZ2l0aHViLmNvbS9rdnovcGhwanMvbWFzdGVyL2Z1bmN0aW9ucy91cmwvYmFzZTY0X2VuY29kZS5qc1xuXG5cdEBtZXRob2QgYnRvYVxuXHRAc3RhdGljXG5cdEBwYXJhbSB7U3RyaW5nfSBkYXRhIFN0cmluZyB0byBlbmNvZGVcblx0QHJldHVybiB7U3RyaW5nfSBCYXNlNjQgZW5jb2RlZCBzdHJpbmdcblx0Ki9cblx0dmFyIGJ0b2EgPSBmdW5jdGlvbihkYXRhLCB1dGY4KSB7XG5cdFx0aWYgKHV0ZjgpIHtcblx0XHRcdGRhdGEgPSB1dGY4X2VuY29kZShkYXRhKTtcblx0XHR9XG5cblx0XHRpZiAodHlwZW9mKHdpbmRvdy5idG9hKSA9PT0gJ2Z1bmN0aW9uJykge1xuXHRcdFx0cmV0dXJuIHdpbmRvdy5idG9hKGRhdGEpO1xuXHRcdH1cblxuXHRcdC8vIGh0dHA6Ly9rZXZpbi52YW56b25uZXZlbGQubmV0XG5cdFx0Ly8gKyAgIG9yaWdpbmFsIGJ5OiBUeWxlciBBa2lucyAoaHR0cDovL3J1bWtpbi5jb20pXG5cdFx0Ly8gKyAgIGltcHJvdmVkIGJ5OiBCYXlyb24gR3VldmFyYVxuXHRcdC8vICsgICBpbXByb3ZlZCBieTogVGh1bmRlci5tXG5cdFx0Ly8gKyAgIGltcHJvdmVkIGJ5OiBLZXZpbiB2YW4gWm9ubmV2ZWxkIChodHRwOi8va2V2aW4udmFuem9ubmV2ZWxkLm5ldClcblx0XHQvLyArICAgYnVnZml4ZWQgYnk6IFBlbGxlbnRlc3F1ZSBNYWxlc3VhZGFcblx0XHQvLyArICAgaW1wcm92ZWQgYnk6IEtldmluIHZhbiBab25uZXZlbGQgKGh0dHA6Ly9rZXZpbi52YW56b25uZXZlbGQubmV0KVxuXHRcdC8vICsgICBpbXByb3ZlZCBieTogUmFmYcWCIEt1a2F3c2tpIChodHRwOi8va3VrYXdza2kucGwpXG5cdFx0Ly8gKiAgICAgZXhhbXBsZSAxOiBiYXNlNjRfZW5jb2RlKCdLZXZpbiB2YW4gWm9ubmV2ZWxkJyk7XG5cdFx0Ly8gKiAgICAgcmV0dXJucyAxOiAnUzJWMmFXNGdkbUZ1SUZwdmJtNWxkbVZzWkE9PSdcblx0XHQvLyBtb3ppbGxhIGhhcyB0aGlzIG5hdGl2ZVxuXHRcdC8vIC0gYnV0IGJyZWFrcyBpbiAyLjAuMC4xMiFcblx0XHR2YXIgYjY0ID0gXCJBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvPVwiO1xuXHRcdHZhciBvMSwgbzIsIG8zLCBoMSwgaDIsIGgzLCBoNCwgYml0cywgaSA9IDAsXG5cdFx0XHRhYyA9IDAsXG5cdFx0XHRlbmMgPSBcIlwiLFxuXHRcdFx0dG1wX2FyciA9IFtdO1xuXG5cdFx0aWYgKCFkYXRhKSB7XG5cdFx0XHRyZXR1cm4gZGF0YTtcblx0XHR9XG5cblx0XHRkbyB7IC8vIHBhY2sgdGhyZWUgb2N0ZXRzIGludG8gZm91ciBoZXhldHNcblx0XHRcdG8xID0gZGF0YS5jaGFyQ29kZUF0KGkrKyk7XG5cdFx0XHRvMiA9IGRhdGEuY2hhckNvZGVBdChpKyspO1xuXHRcdFx0bzMgPSBkYXRhLmNoYXJDb2RlQXQoaSsrKTtcblxuXHRcdFx0Yml0cyA9IG8xIDw8IDE2IHwgbzIgPDwgOCB8IG8zO1xuXG5cdFx0XHRoMSA9IGJpdHMgPj4gMTggJiAweDNmO1xuXHRcdFx0aDIgPSBiaXRzID4+IDEyICYgMHgzZjtcblx0XHRcdGgzID0gYml0cyA+PiA2ICYgMHgzZjtcblx0XHRcdGg0ID0gYml0cyAmIDB4M2Y7XG5cblx0XHRcdC8vIHVzZSBoZXhldHMgdG8gaW5kZXggaW50byBiNjQsIGFuZCBhcHBlbmQgcmVzdWx0IHRvIGVuY29kZWQgc3RyaW5nXG5cdFx0XHR0bXBfYXJyW2FjKytdID0gYjY0LmNoYXJBdChoMSkgKyBiNjQuY2hhckF0KGgyKSArIGI2NC5jaGFyQXQoaDMpICsgYjY0LmNoYXJBdChoNCk7XG5cdFx0fSB3aGlsZSAoaSA8IGRhdGEubGVuZ3RoKTtcblxuXHRcdGVuYyA9IHRtcF9hcnIuam9pbignJyk7XG5cblx0XHR2YXIgciA9IGRhdGEubGVuZ3RoICUgMztcblxuXHRcdHJldHVybiAociA/IGVuYy5zbGljZSgwLCByIC0gMykgOiBlbmMpICsgJz09PScuc2xpY2UociB8fCAzKTtcblx0fTtcblxuXG5cdHJldHVybiB7XG5cdFx0dXRmOF9lbmNvZGU6IHV0ZjhfZW5jb2RlLFxuXHRcdHV0ZjhfZGVjb2RlOiB1dGY4X2RlY29kZSxcblx0XHRhdG9iOiBhdG9iLFxuXHRcdGJ0b2E6IGJ0b2Fcblx0fTtcbn0pO1xuXG4vLyBJbmNsdWRlZCBmcm9tOiBzcmMvamF2YXNjcmlwdC9jb3JlL3V0aWxzL0Vudi5qc1xuXG4vKipcbiAqIEVudi5qc1xuICpcbiAqIENvcHlyaWdodCAyMDEzLCBNb3hpZWNvZGUgU3lzdGVtcyBBQlxuICogUmVsZWFzZWQgdW5kZXIgR1BMIExpY2Vuc2UuXG4gKlxuICogTGljZW5zZTogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vbGljZW5zZVxuICogQ29udHJpYnV0aW5nOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9jb250cmlidXRpbmdcbiAqL1xuXG4vKipcbkBjbGFzcyBtb3hpZS9jb3JlL3V0aWxzL0VudlxuQHB1YmxpY1xuQHN0YXRpY1xuKi9cblxuZGVmaW5lKFwibW94aWUvY29yZS91dGlscy9FbnZcIiwgW1xuXHRcIm1veGllL2NvcmUvdXRpbHMvQmFzaWNcIlxuXSwgZnVuY3Rpb24oQmFzaWMpIHtcblxuXHQvKipcblx0ICogVUFQYXJzZXIuanMgdjAuNy43XG5cdCAqIExpZ2h0d2VpZ2h0IEphdmFTY3JpcHQtYmFzZWQgVXNlci1BZ2VudCBzdHJpbmcgcGFyc2VyXG5cdCAqIGh0dHBzOi8vZ2l0aHViLmNvbS9mYWlzYWxtYW4vdWEtcGFyc2VyLWpzXG5cdCAqXG5cdCAqIENvcHlyaWdodCDCqSAyMDEyLTIwMTUgRmFpc2FsIFNhbG1hbiA8Znl6bG1hbkBnbWFpbC5jb20+XG5cdCAqIER1YWwgbGljZW5zZWQgdW5kZXIgR1BMdjIgJiBNSVRcblx0ICovXG5cdHZhciBVQVBhcnNlciA9IChmdW5jdGlvbiAodW5kZWZpbmVkKSB7XG5cblx0ICAgIC8vLy8vLy8vLy8vLy8vXG5cdCAgICAvLyBDb25zdGFudHNcblx0ICAgIC8vLy8vLy8vLy8vLy9cblxuXG5cdCAgICB2YXIgRU1QVFkgICAgICAgPSAnJyxcblx0ICAgICAgICBVTktOT1dOICAgICA9ICc/Jyxcblx0ICAgICAgICBGVU5DX1RZUEUgICA9ICdmdW5jdGlvbicsXG5cdCAgICAgICAgVU5ERUZfVFlQRSAgPSAndW5kZWZpbmVkJyxcblx0ICAgICAgICBPQkpfVFlQRSAgICA9ICdvYmplY3QnLFxuXHQgICAgICAgIE1BSk9SICAgICAgID0gJ21ham9yJyxcblx0ICAgICAgICBNT0RFTCAgICAgICA9ICdtb2RlbCcsXG5cdCAgICAgICAgTkFNRSAgICAgICAgPSAnbmFtZScsXG5cdCAgICAgICAgVFlQRSAgICAgICAgPSAndHlwZScsXG5cdCAgICAgICAgVkVORE9SICAgICAgPSAndmVuZG9yJyxcblx0ICAgICAgICBWRVJTSU9OICAgICA9ICd2ZXJzaW9uJyxcblx0ICAgICAgICBBUkNISVRFQ1RVUkU9ICdhcmNoaXRlY3R1cmUnLFxuXHQgICAgICAgIENPTlNPTEUgICAgID0gJ2NvbnNvbGUnLFxuXHQgICAgICAgIE1PQklMRSAgICAgID0gJ21vYmlsZScsXG5cdCAgICAgICAgVEFCTEVUICAgICAgPSAndGFibGV0JztcblxuXG5cdCAgICAvLy8vLy8vLy8vL1xuXHQgICAgLy8gSGVscGVyXG5cdCAgICAvLy8vLy8vLy8vXG5cblxuXHQgICAgdmFyIHV0aWwgPSB7XG5cdCAgICAgICAgaGFzIDogZnVuY3Rpb24gKHN0cjEsIHN0cjIpIHtcblx0ICAgICAgICAgICAgcmV0dXJuIHN0cjIudG9Mb3dlckNhc2UoKS5pbmRleE9mKHN0cjEudG9Mb3dlckNhc2UoKSkgIT09IC0xO1xuXHQgICAgICAgIH0sXG5cdCAgICAgICAgbG93ZXJpemUgOiBmdW5jdGlvbiAoc3RyKSB7XG5cdCAgICAgICAgICAgIHJldHVybiBzdHIudG9Mb3dlckNhc2UoKTtcblx0ICAgICAgICB9XG5cdCAgICB9O1xuXG5cblx0ICAgIC8vLy8vLy8vLy8vLy8vL1xuXHQgICAgLy8gTWFwIGhlbHBlclxuXHQgICAgLy8vLy8vLy8vLy8vLy9cblxuXG5cdCAgICB2YXIgbWFwcGVyID0ge1xuXG5cdCAgICAgICAgcmd4IDogZnVuY3Rpb24gKCkge1xuXG5cdCAgICAgICAgICAgIC8vIGxvb3AgdGhyb3VnaCBhbGwgcmVnZXhlcyBtYXBzXG5cdCAgICAgICAgICAgIGZvciAodmFyIHJlc3VsdCwgaSA9IDAsIGosIGssIHAsIHEsIG1hdGNoZXMsIG1hdGNoLCBhcmdzID0gYXJndW1lbnRzOyBpIDwgYXJncy5sZW5ndGg7IGkgKz0gMikge1xuXG5cdCAgICAgICAgICAgICAgICB2YXIgcmVnZXggPSBhcmdzW2ldLCAgICAgICAvLyBldmVuIHNlcXVlbmNlICgwLDIsNCwuLilcblx0ICAgICAgICAgICAgICAgICAgICBwcm9wcyA9IGFyZ3NbaSArIDFdOyAgIC8vIG9kZCBzZXF1ZW5jZSAoMSwzLDUsLi4pXG5cblx0ICAgICAgICAgICAgICAgIC8vIGNvbnN0cnVjdCBvYmplY3QgYmFyZWJvbmVzXG5cdCAgICAgICAgICAgICAgICBpZiAodHlwZW9mKHJlc3VsdCkgPT09IFVOREVGX1RZUEUpIHtcblx0ICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSB7fTtcblx0ICAgICAgICAgICAgICAgICAgICBmb3IgKHAgaW4gcHJvcHMpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgcSA9IHByb3BzW3BdO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mKHEpID09PSBPQkpfVFlQRSkge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0W3FbMF1dID0gdW5kZWZpbmVkO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0W3FdID0gdW5kZWZpbmVkO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgfVxuXG5cdCAgICAgICAgICAgICAgICAvLyB0cnkgbWF0Y2hpbmcgdWFzdHJpbmcgd2l0aCByZWdleGVzXG5cdCAgICAgICAgICAgICAgICBmb3IgKGogPSBrID0gMDsgaiA8IHJlZ2V4Lmxlbmd0aDsgaisrKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgbWF0Y2hlcyA9IHJlZ2V4W2pdLmV4ZWModGhpcy5nZXRVQSgpKTtcblx0ICAgICAgICAgICAgICAgICAgICBpZiAoISFtYXRjaGVzKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIGZvciAocCA9IDA7IHAgPCBwcm9wcy5sZW5ndGg7IHArKykge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2ggPSBtYXRjaGVzWysra107XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICBxID0gcHJvcHNbcF07XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBpZiBnaXZlbiBwcm9wZXJ0eSBpcyBhY3R1YWxseSBhcnJheVxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZihxKSA9PT0gT0JKX1RZUEUgJiYgcS5sZW5ndGggPiAwKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHEubGVuZ3RoID09IDIpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZihxWzFdKSA9PSBGVU5DX1RZUEUpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFzc2lnbiBtb2RpZmllZCBtYXRjaFxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0W3FbMF1dID0gcVsxXS5jYWxsKHRoaXMsIG1hdGNoKTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFzc2lnbiBnaXZlbiB2YWx1ZSwgaWdub3JlIHJlZ2V4IG1hdGNoXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRbcVswXV0gPSBxWzFdO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChxLmxlbmd0aCA9PSAzKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIHdoZXRoZXIgZnVuY3Rpb24gb3IgcmVnZXhcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZihxWzFdKSA9PT0gRlVOQ19UWVBFICYmICEocVsxXS5leGVjICYmIHFbMV0udGVzdCkpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNhbGwgZnVuY3Rpb24gKHVzdWFsbHkgc3RyaW5nIG1hcHBlcilcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFtxWzBdXSA9IG1hdGNoID8gcVsxXS5jYWxsKHRoaXMsIG1hdGNoLCBxWzJdKSA6IHVuZGVmaW5lZDtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNhbml0aXplIG1hdGNoIHVzaW5nIGdpdmVuIHJlZ2V4XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRbcVswXV0gPSBtYXRjaCA/IG1hdGNoLnJlcGxhY2UocVsxXSwgcVsyXSkgOiB1bmRlZmluZWQ7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHEubGVuZ3RoID09IDQpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFtxWzBdXSA9IG1hdGNoID8gcVszXS5jYWxsKHRoaXMsIG1hdGNoLnJlcGxhY2UocVsxXSwgcVsyXSkpIDogdW5kZWZpbmVkO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0W3FdID0gbWF0Y2ggPyBtYXRjaCA6IHVuZGVmaW5lZDtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblx0ICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICB9XG5cblx0ICAgICAgICAgICAgICAgIGlmKCEhbWF0Y2hlcykgYnJlYWs7IC8vIGJyZWFrIHRoZSBsb29wIGltbWVkaWF0ZWx5IGlmIG1hdGNoIGZvdW5kXG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcblx0ICAgICAgICB9LFxuXG5cdCAgICAgICAgc3RyIDogZnVuY3Rpb24gKHN0ciwgbWFwKSB7XG5cblx0ICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBtYXApIHtcblx0ICAgICAgICAgICAgICAgIC8vIGNoZWNrIGlmIGFycmF5XG5cdCAgICAgICAgICAgICAgICBpZiAodHlwZW9mKG1hcFtpXSkgPT09IE9CSl9UWVBFICYmIG1hcFtpXS5sZW5ndGggPiAwKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBtYXBbaV0ubGVuZ3RoOyBqKyspIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHV0aWwuaGFzKG1hcFtpXVtqXSwgc3RyKSkge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChpID09PSBVTktOT1dOKSA/IHVuZGVmaW5lZCA6IGk7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHV0aWwuaGFzKG1hcFtpXSwgc3RyKSkge1xuXHQgICAgICAgICAgICAgICAgICAgIHJldHVybiAoaSA9PT0gVU5LTk9XTikgPyB1bmRlZmluZWQgOiBpO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIHJldHVybiBzdHI7XG5cdCAgICAgICAgfVxuXHQgICAgfTtcblxuXG5cdCAgICAvLy8vLy8vLy8vLy8vLy9cblx0ICAgIC8vIFN0cmluZyBtYXBcblx0ICAgIC8vLy8vLy8vLy8vLy8vXG5cblxuXHQgICAgdmFyIG1hcHMgPSB7XG5cblx0ICAgICAgICBicm93c2VyIDoge1xuXHQgICAgICAgICAgICBvbGRzYWZhcmkgOiB7XG5cdCAgICAgICAgICAgICAgICBtYWpvciA6IHtcblx0ICAgICAgICAgICAgICAgICAgICAnMScgOiBbJy84JywgJy8xJywgJy8zJ10sXG5cdCAgICAgICAgICAgICAgICAgICAgJzInIDogJy80Jyxcblx0ICAgICAgICAgICAgICAgICAgICAnPycgOiAnLydcblx0ICAgICAgICAgICAgICAgIH0sXG5cdCAgICAgICAgICAgICAgICB2ZXJzaW9uIDoge1xuXHQgICAgICAgICAgICAgICAgICAgICcxLjAnICAgOiAnLzgnLFxuXHQgICAgICAgICAgICAgICAgICAgICcxLjInICAgOiAnLzEnLFxuXHQgICAgICAgICAgICAgICAgICAgICcxLjMnICAgOiAnLzMnLFxuXHQgICAgICAgICAgICAgICAgICAgICcyLjAnICAgOiAnLzQxMicsXG5cdCAgICAgICAgICAgICAgICAgICAgJzIuMC4yJyA6ICcvNDE2Jyxcblx0ICAgICAgICAgICAgICAgICAgICAnMi4wLjMnIDogJy80MTcnLFxuXHQgICAgICAgICAgICAgICAgICAgICcyLjAuNCcgOiAnLzQxOScsXG5cdCAgICAgICAgICAgICAgICAgICAgJz8nICAgICA6ICcvJ1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfSxcblxuXHQgICAgICAgIGRldmljZSA6IHtcblx0ICAgICAgICAgICAgc3ByaW50IDoge1xuXHQgICAgICAgICAgICAgICAgbW9kZWwgOiB7XG5cdCAgICAgICAgICAgICAgICAgICAgJ0V2byBTaGlmdCA0RycgOiAnNzM3M0tUJ1xuXHQgICAgICAgICAgICAgICAgfSxcblx0ICAgICAgICAgICAgICAgIHZlbmRvciA6IHtcblx0ICAgICAgICAgICAgICAgICAgICAnSFRDJyAgICAgICA6ICdBUEEnLFxuXHQgICAgICAgICAgICAgICAgICAgICdTcHJpbnQnICAgIDogJ1NwcmludCdcblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgIH0sXG5cblx0ICAgICAgICBvcyA6IHtcblx0ICAgICAgICAgICAgd2luZG93cyA6IHtcblx0ICAgICAgICAgICAgICAgIHZlcnNpb24gOiB7XG5cdCAgICAgICAgICAgICAgICAgICAgJ01FJyAgICAgICAgOiAnNC45MCcsXG5cdCAgICAgICAgICAgICAgICAgICAgJ05UIDMuMTEnICAgOiAnTlQzLjUxJyxcblx0ICAgICAgICAgICAgICAgICAgICAnTlQgNC4wJyAgICA6ICdOVDQuMCcsXG5cdCAgICAgICAgICAgICAgICAgICAgJzIwMDAnICAgICAgOiAnTlQgNS4wJyxcblx0ICAgICAgICAgICAgICAgICAgICAnWFAnICAgICAgICA6IFsnTlQgNS4xJywgJ05UIDUuMiddLFxuXHQgICAgICAgICAgICAgICAgICAgICdWaXN0YScgICAgIDogJ05UIDYuMCcsXG5cdCAgICAgICAgICAgICAgICAgICAgJzcnICAgICAgICAgOiAnTlQgNi4xJyxcblx0ICAgICAgICAgICAgICAgICAgICAnOCcgICAgICAgICA6ICdOVCA2LjInLFxuXHQgICAgICAgICAgICAgICAgICAgICc4LjEnICAgICAgIDogJ05UIDYuMycsXG5cdCAgICAgICAgICAgICAgICAgICAgJ1JUJyAgICAgICAgOiAnQVJNJ1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgICAgfTtcblxuXG5cdCAgICAvLy8vLy8vLy8vLy8vL1xuXHQgICAgLy8gUmVnZXggbWFwXG5cdCAgICAvLy8vLy8vLy8vLy8vXG5cblxuXHQgICAgdmFyIHJlZ2V4ZXMgPSB7XG5cblx0ICAgICAgICBicm93c2VyIDogW1tcblxuXHQgICAgICAgICAgICAvLyBQcmVzdG8gYmFzZWRcblx0ICAgICAgICAgICAgLyhvcGVyYVxcc21pbmkpXFwvKFtcXHdcXC4tXSspL2ksICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gT3BlcmEgTWluaVxuXHQgICAgICAgICAgICAvKG9wZXJhXFxzW21vYmlsZXRhYl0rKS4rdmVyc2lvblxcLyhbXFx3XFwuLV0rKS9pLCAgICAgICAgICAgICAgICAgICAgICAvLyBPcGVyYSBNb2JpL1RhYmxldFxuXHQgICAgICAgICAgICAvKG9wZXJhKS4rdmVyc2lvblxcLyhbXFx3XFwuXSspL2ksICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE9wZXJhID4gOS44MFxuXHQgICAgICAgICAgICAvKG9wZXJhKVtcXC9cXHNdKyhbXFx3XFwuXSspL2kgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBPcGVyYSA8IDkuODBcblxuXHQgICAgICAgICAgICBdLCBbTkFNRSwgVkVSU0lPTl0sIFtcblxuXHQgICAgICAgICAgICAvXFxzKG9wcilcXC8oW1xcd1xcLl0rKS9pICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBPcGVyYSBXZWJraXRcblx0ICAgICAgICAgICAgXSwgW1tOQU1FLCAnT3BlcmEnXSwgVkVSU0lPTl0sIFtcblxuXHQgICAgICAgICAgICAvLyBNaXhlZFxuXHQgICAgICAgICAgICAvKGtpbmRsZSlcXC8oW1xcd1xcLl0rKS9pLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEtpbmRsZVxuXHQgICAgICAgICAgICAvKGx1bmFzY2FwZXxtYXh0aG9ufG5ldGZyb250fGphc21pbmV8YmxhemVyKVtcXC9cXHNdPyhbXFx3XFwuXSspKi9pLFxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEx1bmFzY2FwZS9NYXh0aG9uL05ldGZyb250L0phc21pbmUvQmxhemVyXG5cblx0ICAgICAgICAgICAgLy8gVHJpZGVudCBiYXNlZFxuXHQgICAgICAgICAgICAvKGF2YW50XFxzfGllbW9iaWxlfHNsaW18YmFpZHUpKD86YnJvd3Nlcik/W1xcL1xcc10/KFtcXHdcXC5dKikvaSxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBBdmFudC9JRU1vYmlsZS9TbGltQnJvd3Nlci9CYWlkdVxuXHQgICAgICAgICAgICAvKD86bXN8XFwoKShpZSlcXHMoW1xcd1xcLl0rKS9pLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJbnRlcm5ldCBFeHBsb3JlclxuXG5cdCAgICAgICAgICAgIC8vIFdlYmtpdC9LSFRNTCBiYXNlZFxuXHQgICAgICAgICAgICAvKHJla29ucSlcXC8oW1xcd1xcLl0rKSovaSwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJla29ucVxuXHQgICAgICAgICAgICAvKGNocm9taXVtfGZsb2NrfHJvY2ttZWx0fG1pZG9yaXxlcGlwaGFueXxzaWxrfHNreWZpcmV8b3ZpYnJvd3Nlcnxib2x0fGlyb258dml2YWxkaSlcXC8oW1xcd1xcLi1dKykvaVxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIENocm9taXVtL0Zsb2NrL1JvY2tNZWx0L01pZG9yaS9FcGlwaGFueS9TaWxrL1NreWZpcmUvQm9sdC9Jcm9uXG5cdCAgICAgICAgICAgIF0sIFtOQU1FLCBWRVJTSU9OXSwgW1xuXG5cdCAgICAgICAgICAgIC8odHJpZGVudCkuK3J2WzpcXHNdKFtcXHdcXC5dKykuK2xpa2VcXHNnZWNrby9pICAgICAgICAgICAgICAgICAgICAgICAgIC8vIElFMTFcblx0ICAgICAgICAgICAgXSwgW1tOQU1FLCAnSUUnXSwgVkVSU0lPTl0sIFtcblxuXHQgICAgICAgICAgICAvKGVkZ2UpXFwvKChcXGQrKT9bXFx3XFwuXSspL2kgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBNaWNyb3NvZnQgRWRnZVxuXHQgICAgICAgICAgICBdLCBbTkFNRSwgVkVSU0lPTl0sIFtcblxuXHQgICAgICAgICAgICAvKHlhYnJvd3NlcilcXC8oW1xcd1xcLl0rKS9pICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFlhbmRleFxuXHQgICAgICAgICAgICBdLCBbW05BTUUsICdZYW5kZXgnXSwgVkVSU0lPTl0sIFtcblxuXHQgICAgICAgICAgICAvKGNvbW9kb19kcmFnb24pXFwvKFtcXHdcXC5dKykvaSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIENvbW9kbyBEcmFnb25cblx0ICAgICAgICAgICAgXSwgW1tOQU1FLCAvXy9nLCAnICddLCBWRVJTSU9OXSwgW1xuXG5cdCAgICAgICAgICAgIC8oY2hyb21lfG9tbml3ZWJ8YXJvcmF8W3RpemVub2thXXs1fVxccz9icm93c2VyKVxcL3Y/KFtcXHdcXC5dKykvaSxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBDaHJvbWUvT21uaVdlYi9Bcm9yYS9UaXplbi9Ob2tpYVxuXHQgICAgICAgICAgICAvKHVjXFxzP2Jyb3dzZXJ8cXFicm93c2VyKVtcXC9cXHNdPyhbXFx3XFwuXSspL2lcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBVQ0Jyb3dzZXIvUVFCcm93c2VyXG5cdCAgICAgICAgICAgIF0sIFtOQU1FLCBWRVJTSU9OXSwgW1xuXG5cdCAgICAgICAgICAgIC8oZG9sZmluKVxcLyhbXFx3XFwuXSspL2kgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRG9scGhpblxuXHQgICAgICAgICAgICBdLCBbW05BTUUsICdEb2xwaGluJ10sIFZFUlNJT05dLCBbXG5cblx0ICAgICAgICAgICAgLygoPzphbmRyb2lkLispY3Jtb3xjcmlvcylcXC8oW1xcd1xcLl0rKS9pICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBDaHJvbWUgZm9yIEFuZHJvaWQvaU9TXG5cdCAgICAgICAgICAgIF0sIFtbTkFNRSwgJ0Nocm9tZSddLCBWRVJTSU9OXSwgW1xuXG5cdCAgICAgICAgICAgIC9YaWFvTWlcXC9NaXVpQnJvd3NlclxcLyhbXFx3XFwuXSspL2kgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1JVUkgQnJvd3NlclxuXHQgICAgICAgICAgICBdLCBbVkVSU0lPTiwgW05BTUUsICdNSVVJIEJyb3dzZXInXV0sIFtcblxuXHQgICAgICAgICAgICAvYW5kcm9pZC4rdmVyc2lvblxcLyhbXFx3XFwuXSspXFxzKyg/Om1vYmlsZVxccz9zYWZhcml8c2FmYXJpKS9pICAgICAgICAgLy8gQW5kcm9pZCBCcm93c2VyXG5cdCAgICAgICAgICAgIF0sIFtWRVJTSU9OLCBbTkFNRSwgJ0FuZHJvaWQgQnJvd3NlciddXSwgW1xuXG5cdCAgICAgICAgICAgIC9GQkFWXFwvKFtcXHdcXC5dKyk7L2kgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmFjZWJvb2sgQXBwIGZvciBpT1Ncblx0ICAgICAgICAgICAgXSwgW1ZFUlNJT04sIFtOQU1FLCAnRmFjZWJvb2snXV0sIFtcblxuXHQgICAgICAgICAgICAvdmVyc2lvblxcLyhbXFx3XFwuXSspLis/bW9iaWxlXFwvXFx3K1xccyhzYWZhcmkpL2kgICAgICAgICAgICAgICAgICAgICAgIC8vIE1vYmlsZSBTYWZhcmlcblx0ICAgICAgICAgICAgXSwgW1ZFUlNJT04sIFtOQU1FLCAnTW9iaWxlIFNhZmFyaSddXSwgW1xuXG5cdCAgICAgICAgICAgIC92ZXJzaW9uXFwvKFtcXHdcXC5dKykuKz8obW9iaWxlXFxzP3NhZmFyaXxzYWZhcmkpL2kgICAgICAgICAgICAgICAgICAgIC8vIFNhZmFyaSAmIFNhZmFyaSBNb2JpbGVcblx0ICAgICAgICAgICAgXSwgW1ZFUlNJT04sIE5BTUVdLCBbXG5cblx0ICAgICAgICAgICAgL3dlYmtpdC4rPyhtb2JpbGVcXHM/c2FmYXJpfHNhZmFyaSkoXFwvW1xcd1xcLl0rKS9pICAgICAgICAgICAgICAgICAgICAgLy8gU2FmYXJpIDwgMy4wXG5cdCAgICAgICAgICAgIF0sIFtOQU1FLCBbVkVSU0lPTiwgbWFwcGVyLnN0ciwgbWFwcy5icm93c2VyLm9sZHNhZmFyaS52ZXJzaW9uXV0sIFtcblxuXHQgICAgICAgICAgICAvKGtvbnF1ZXJvcilcXC8oW1xcd1xcLl0rKS9pLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEtvbnF1ZXJvclxuXHQgICAgICAgICAgICAvKHdlYmtpdHxraHRtbClcXC8oW1xcd1xcLl0rKS9pXG5cdCAgICAgICAgICAgIF0sIFtOQU1FLCBWRVJTSU9OXSwgW1xuXG5cdCAgICAgICAgICAgIC8vIEdlY2tvIGJhc2VkXG5cdCAgICAgICAgICAgIC8obmF2aWdhdG9yfG5ldHNjYXBlKVxcLyhbXFx3XFwuLV0rKS9pICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTmV0c2NhcGVcblx0ICAgICAgICAgICAgXSwgW1tOQU1FLCAnTmV0c2NhcGUnXSwgVkVSU0lPTl0sIFtcblx0ICAgICAgICAgICAgLyhzd2lmdGZveCkvaSwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTd2lmdGZveFxuXHQgICAgICAgICAgICAvKGljZWRyYWdvbnxpY2V3ZWFzZWx8Y2FtaW5vfGNoaW1lcmF8ZmVubmVjfG1hZW1vXFxzYnJvd3NlcnxtaW5pbW98Y29ua2Vyb3IpW1xcL1xcc10/KFtcXHdcXC5cXCtdKykvaSxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJY2VEcmFnb24vSWNld2Vhc2VsL0NhbWluby9DaGltZXJhL0Zlbm5lYy9NYWVtby9NaW5pbW8vQ29ua2Vyb3Jcblx0ICAgICAgICAgICAgLyhmaXJlZm94fHNlYW1vbmtleXxrLW1lbGVvbnxpY2VjYXR8aWNlYXBlfGZpcmViaXJkfHBob2VuaXgpXFwvKFtcXHdcXC4tXSspL2ksXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmlyZWZveC9TZWFNb25rZXkvSy1NZWxlb24vSWNlQ2F0L0ljZUFwZS9GaXJlYmlyZC9QaG9lbml4XG5cdCAgICAgICAgICAgIC8obW96aWxsYSlcXC8oW1xcd1xcLl0rKS4rcnZcXDouK2dlY2tvXFwvXFxkKy9pLCAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTW96aWxsYVxuXG5cdCAgICAgICAgICAgIC8vIE90aGVyXG5cdCAgICAgICAgICAgIC8ocG9sYXJpc3xseW54fGRpbGxvfGljYWJ8ZG9yaXN8YW1heWF8dzNtfG5ldHN1cmYpW1xcL1xcc10/KFtcXHdcXC5dKykvaSxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBQb2xhcmlzL0x5bngvRGlsbG8vaUNhYi9Eb3Jpcy9BbWF5YS93M20vTmV0U3VyZlxuXHQgICAgICAgICAgICAvKGxpbmtzKVxcc1xcKChbXFx3XFwuXSspL2ksICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBMaW5rc1xuXHQgICAgICAgICAgICAvKGdvYnJvd3NlcilcXC8/KFtcXHdcXC5dKykqL2ksICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEdvQnJvd3NlclxuXHQgICAgICAgICAgICAvKGljZVxccz9icm93c2VyKVxcL3Y/KFtcXHdcXC5fXSspL2ksICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJQ0UgQnJvd3NlclxuXHQgICAgICAgICAgICAvKG1vc2FpYylbXFwvXFxzXShbXFx3XFwuXSspL2kgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBNb3NhaWNcblx0ICAgICAgICAgICAgXSwgW05BTUUsIFZFUlNJT05dXG5cdCAgICAgICAgXSxcblxuXHQgICAgICAgIGVuZ2luZSA6IFtbXG5cblx0ICAgICAgICAgICAgL3dpbmRvd3MuK1xcc2VkZ2VcXC8oW1xcd1xcLl0rKS9pICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRWRnZUhUTUxcblx0ICAgICAgICAgICAgXSwgW1ZFUlNJT04sIFtOQU1FLCAnRWRnZUhUTUwnXV0sIFtcblxuXHQgICAgICAgICAgICAvKHByZXN0bylcXC8oW1xcd1xcLl0rKS9pLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFByZXN0b1xuXHQgICAgICAgICAgICAvKHdlYmtpdHx0cmlkZW50fG5ldGZyb250fG5ldHN1cmZ8YW1heWF8bHlueHx3M20pXFwvKFtcXHdcXC5dKykvaSwgICAgIC8vIFdlYktpdC9UcmlkZW50L05ldEZyb250L05ldFN1cmYvQW1heWEvTHlueC93M21cblx0ICAgICAgICAgICAgLyhraHRtbHx0YXNtYW58bGlua3MpW1xcL1xcc11cXCg/KFtcXHdcXC5dKykvaSwgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEtIVE1ML1Rhc21hbi9MaW5rc1xuXHQgICAgICAgICAgICAvKGljYWIpW1xcL1xcc10oWzIzXVxcLltcXGRcXC5dKykvaSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaUNhYlxuXHQgICAgICAgICAgICBdLCBbTkFNRSwgVkVSU0lPTl0sIFtcblxuXHQgICAgICAgICAgICAvcnZcXDooW1xcd1xcLl0rKS4qKGdlY2tvKS9pICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEdlY2tvXG5cdCAgICAgICAgICAgIF0sIFtWRVJTSU9OLCBOQU1FXVxuXHQgICAgICAgIF0sXG5cblx0ICAgICAgICBvcyA6IFtbXG5cblx0ICAgICAgICAgICAgLy8gV2luZG93cyBiYXNlZFxuXHQgICAgICAgICAgICAvbWljcm9zb2Z0XFxzKHdpbmRvd3MpXFxzKHZpc3RhfHhwKS9pICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gV2luZG93cyAoaVR1bmVzKVxuXHQgICAgICAgICAgICBdLCBbTkFNRSwgVkVSU0lPTl0sIFtcblx0ICAgICAgICAgICAgLyh3aW5kb3dzKVxcc250XFxzNlxcLjI7XFxzKGFybSkvaSwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gV2luZG93cyBSVFxuXHQgICAgICAgICAgICAvKHdpbmRvd3NcXHNwaG9uZSg/Olxcc29zKSp8d2luZG93c1xcc21vYmlsZXx3aW5kb3dzKVtcXHNcXC9dPyhbbnRjZVxcZFxcLlxcc10rXFx3KS9pXG5cdCAgICAgICAgICAgIF0sIFtOQU1FLCBbVkVSU0lPTiwgbWFwcGVyLnN0ciwgbWFwcy5vcy53aW5kb3dzLnZlcnNpb25dXSwgW1xuXHQgICAgICAgICAgICAvKHdpbig/PTN8OXxuKXx3aW5cXHM5eFxccykoW250XFxkXFwuXSspL2lcblx0ICAgICAgICAgICAgXSwgW1tOQU1FLCAnV2luZG93cyddLCBbVkVSU0lPTiwgbWFwcGVyLnN0ciwgbWFwcy5vcy53aW5kb3dzLnZlcnNpb25dXSwgW1xuXG5cdCAgICAgICAgICAgIC8vIE1vYmlsZS9FbWJlZGRlZCBPU1xuXHQgICAgICAgICAgICAvXFwoKGJiKSgxMCk7L2kgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBCbGFja0JlcnJ5IDEwXG5cdCAgICAgICAgICAgIF0sIFtbTkFNRSwgJ0JsYWNrQmVycnknXSwgVkVSU0lPTl0sIFtcblx0ICAgICAgICAgICAgLyhibGFja2JlcnJ5KVxcdypcXC8/KFtcXHdcXC5dKykqL2ksICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQmxhY2tiZXJyeVxuXHQgICAgICAgICAgICAvKHRpemVuKVtcXC9cXHNdKFtcXHdcXC5dKykvaSwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaXplblxuXHQgICAgICAgICAgICAvKGFuZHJvaWR8d2Vib3N8cGFsbVxcb3N8cW54fGJhZGF8cmltXFxzdGFibGV0XFxzb3N8bWVlZ298Y29udGlraSlbXFwvXFxzLV0/KFtcXHdcXC5dKykqL2ksXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQW5kcm9pZC9XZWJPUy9QYWxtL1FOWC9CYWRhL1JJTS9NZWVHby9Db250aWtpXG5cdCAgICAgICAgICAgIC9saW51eDsuKyhzYWlsZmlzaCk7L2kgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2FpbGZpc2ggT1Ncblx0ICAgICAgICAgICAgXSwgW05BTUUsIFZFUlNJT05dLCBbXG5cdCAgICAgICAgICAgIC8oc3ltYmlhblxccz9vc3xzeW1ib3N8czYwKD89OykpW1xcL1xccy1dPyhbXFx3XFwuXSspKi9pICAgICAgICAgICAgICAgICAvLyBTeW1iaWFuXG5cdCAgICAgICAgICAgIF0sIFtbTkFNRSwgJ1N5bWJpYW4nXSwgVkVSU0lPTl0sIFtcblx0ICAgICAgICAgICAgL1xcKChzZXJpZXM0MCk7L2kgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2VyaWVzIDQwXG5cdCAgICAgICAgICAgIF0sIFtOQU1FXSwgW1xuXHQgICAgICAgICAgICAvbW96aWxsYS4rXFwobW9iaWxlOy4rZ2Vja28uK2ZpcmVmb3gvaSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBGaXJlZm94IE9TXG5cdCAgICAgICAgICAgIF0sIFtbTkFNRSwgJ0ZpcmVmb3ggT1MnXSwgVkVSU0lPTl0sIFtcblxuXHQgICAgICAgICAgICAvLyBDb25zb2xlXG5cdCAgICAgICAgICAgIC8obmludGVuZG98cGxheXN0YXRpb24pXFxzKFt3aWRzM3BvcnRhYmxldnVdKykvaSwgICAgICAgICAgICAgICAgICAgIC8vIE5pbnRlbmRvL1BsYXlzdGF0aW9uXG5cblx0ICAgICAgICAgICAgLy8gR05VL0xpbnV4IGJhc2VkXG5cdCAgICAgICAgICAgIC8obWludClbXFwvXFxzXFwoXT8oXFx3KykqL2ksICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1pbnRcblx0ICAgICAgICAgICAgLyhtYWdlaWF8dmVjdG9ybGludXgpWztcXHNdL2ksICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTWFnZWlhL1ZlY3RvckxpbnV4XG5cdCAgICAgICAgICAgIC8oam9saXxba3hsbl0/dWJ1bnR1fGRlYmlhbnxbb3Blbl0qc3VzZXxnZW50b298YXJjaHxzbGFja3dhcmV8ZmVkb3JhfG1hbmRyaXZhfGNlbnRvc3xwY2xpbnV4b3N8cmVkaGF0fHplbndhbGt8bGlucHVzKVtcXC9cXHMtXT8oW1xcd1xcLi1dKykqL2ksXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSm9saS9VYnVudHUvRGViaWFuL1NVU0UvR2VudG9vL0FyY2gvU2xhY2t3YXJlXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmVkb3JhL01hbmRyaXZhL0NlbnRPUy9QQ0xpbnV4T1MvUmVkSGF0L1plbndhbGsvTGlucHVzXG5cdCAgICAgICAgICAgIC8oaHVyZHxsaW51eClcXHM/KFtcXHdcXC5dKykqL2ksICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSHVyZC9MaW51eFxuXHQgICAgICAgICAgICAvKGdudSlcXHM/KFtcXHdcXC5dKykqL2kgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEdOVVxuXHQgICAgICAgICAgICBdLCBbTkFNRSwgVkVSU0lPTl0sIFtcblxuXHQgICAgICAgICAgICAvKGNyb3MpXFxzW1xcd10rXFxzKFtcXHdcXC5dK1xcdykvaSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIENocm9taXVtIE9TXG5cdCAgICAgICAgICAgIF0sIFtbTkFNRSwgJ0Nocm9taXVtIE9TJ10sIFZFUlNJT05dLFtcblxuXHQgICAgICAgICAgICAvLyBTb2xhcmlzXG5cdCAgICAgICAgICAgIC8oc3Vub3MpXFxzPyhbXFx3XFwuXStcXGQpKi9pICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNvbGFyaXNcblx0ICAgICAgICAgICAgXSwgW1tOQU1FLCAnU29sYXJpcyddLCBWRVJTSU9OXSwgW1xuXG5cdCAgICAgICAgICAgIC8vIEJTRCBiYXNlZFxuXHQgICAgICAgICAgICAvXFxzKFtmcmVudG9wYy1dezAsNH1ic2R8ZHJhZ29uZmx5KVxccz8oW1xcd1xcLl0rKSovaSAgICAgICAgICAgICAgICAgICAvLyBGcmVlQlNEL05ldEJTRC9PcGVuQlNEL1BDLUJTRC9EcmFnb25GbHlcblx0ICAgICAgICAgICAgXSwgW05BTUUsIFZFUlNJT05dLFtcblxuXHQgICAgICAgICAgICAvKGlwW2hvbmVhZF0rKSg/Oi4qb3NcXHMqKFtcXHddKykqXFxzbGlrZVxcc21hY3w7XFxzb3BlcmEpL2kgICAgICAgICAgICAgLy8gaU9TXG5cdCAgICAgICAgICAgIF0sIFtbTkFNRSwgJ2lPUyddLCBbVkVSU0lPTiwgL18vZywgJy4nXV0sIFtcblxuXHQgICAgICAgICAgICAvKG1hY1xcc29zXFxzeClcXHM/KFtcXHdcXHNcXC5dK1xcdykqL2ksXG5cdCAgICAgICAgICAgIC8obWFjaW50b3NofG1hYyg/PV9wb3dlcnBjKVxccykvaSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1hYyBPU1xuXHQgICAgICAgICAgICBdLCBbW05BTUUsICdNYWMgT1MnXSwgW1ZFUlNJT04sIC9fL2csICcuJ11dLCBbXG5cblx0ICAgICAgICAgICAgLy8gT3RoZXJcblx0ICAgICAgICAgICAgLygoPzpvcGVuKT9zb2xhcmlzKVtcXC9cXHMtXT8oW1xcd1xcLl0rKSovaSwgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU29sYXJpc1xuXHQgICAgICAgICAgICAvKGhhaWt1KVxccyhcXHcrKS9pLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSGFpa3Vcblx0ICAgICAgICAgICAgLyhhaXgpXFxzKChcXGQpKD89XFwufFxcKXxcXHMpW1xcd1xcLl0qKSovaSwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQUlYXG5cdCAgICAgICAgICAgIC8ocGxhblxcczl8bWluaXh8YmVvc3xvc1xcLzJ8YW1pZ2Fvc3xtb3JwaG9zfHJpc2NcXHNvc3xvcGVudm1zKS9pLFxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFBsYW45L01pbml4L0JlT1MvT1MyL0FtaWdhT1MvTW9ycGhPUy9SSVNDT1MvT3BlblZNU1xuXHQgICAgICAgICAgICAvKHVuaXgpXFxzPyhbXFx3XFwuXSspKi9pICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVOSVhcblx0ICAgICAgICAgICAgXSwgW05BTUUsIFZFUlNJT05dXG5cdCAgICAgICAgXVxuXHQgICAgfTtcblxuXG5cdCAgICAvLy8vLy8vLy8vLy8vLy8vL1xuXHQgICAgLy8gQ29uc3RydWN0b3Jcblx0ICAgIC8vLy8vLy8vLy8vLy8vLy9cblxuXG5cdCAgICB2YXIgVUFQYXJzZXIgPSBmdW5jdGlvbiAodWFzdHJpbmcpIHtcblxuXHQgICAgICAgIHZhciB1YSA9IHVhc3RyaW5nIHx8ICgod2luZG93ICYmIHdpbmRvdy5uYXZpZ2F0b3IgJiYgd2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQpID8gd2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQgOiBFTVBUWSk7XG5cblx0ICAgICAgICB0aGlzLmdldEJyb3dzZXIgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgIHJldHVybiBtYXBwZXIucmd4LmFwcGx5KHRoaXMsIHJlZ2V4ZXMuYnJvd3Nlcik7XG5cdCAgICAgICAgfTtcblx0ICAgICAgICB0aGlzLmdldEVuZ2luZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgcmV0dXJuIG1hcHBlci5yZ3guYXBwbHkodGhpcywgcmVnZXhlcy5lbmdpbmUpO1xuXHQgICAgICAgIH07XG5cdCAgICAgICAgdGhpcy5nZXRPUyA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgcmV0dXJuIG1hcHBlci5yZ3guYXBwbHkodGhpcywgcmVnZXhlcy5vcyk7XG5cdCAgICAgICAgfTtcblx0ICAgICAgICB0aGlzLmdldFJlc3VsdCA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgICByZXR1cm4ge1xuXHQgICAgICAgICAgICAgICAgdWEgICAgICA6IHRoaXMuZ2V0VUEoKSxcblx0ICAgICAgICAgICAgICAgIGJyb3dzZXIgOiB0aGlzLmdldEJyb3dzZXIoKSxcblx0ICAgICAgICAgICAgICAgIGVuZ2luZSAgOiB0aGlzLmdldEVuZ2luZSgpLFxuXHQgICAgICAgICAgICAgICAgb3MgICAgICA6IHRoaXMuZ2V0T1MoKVxuXHQgICAgICAgICAgICB9O1xuXHQgICAgICAgIH07XG5cdCAgICAgICAgdGhpcy5nZXRVQSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgcmV0dXJuIHVhO1xuXHQgICAgICAgIH07XG5cdCAgICAgICAgdGhpcy5zZXRVQSA9IGZ1bmN0aW9uICh1YXN0cmluZykge1xuXHQgICAgICAgICAgICB1YSA9IHVhc3RyaW5nO1xuXHQgICAgICAgICAgICByZXR1cm4gdGhpcztcblx0ICAgICAgICB9O1xuXHQgICAgICAgIHRoaXMuc2V0VUEodWEpO1xuXHQgICAgfTtcblxuXHQgICAgcmV0dXJuIFVBUGFyc2VyO1xuXHR9KSgpO1xuXG5cblx0ZnVuY3Rpb24gdmVyc2lvbl9jb21wYXJlKHYxLCB2Miwgb3BlcmF0b3IpIHtcblx0ICAvLyBGcm9tOiBodHRwOi8vcGhwanMub3JnL2Z1bmN0aW9uc1xuXHQgIC8vICsgICAgICBvcmlnaW5hbCBieTogUGhpbGlwcGUgSmF1c2lvbnMgKGh0dHA6Ly9wZWFyLnBocC5uZXQvdXNlci9qYXVzaW9ucylcblx0ICAvLyArICAgICAgb3JpZ2luYWwgYnk6IEFpZGFuIExpc3RlciAoaHR0cDovL2FpZGFubGlzdGVyLmNvbS8pXG5cdCAgLy8gKyByZWltcGxlbWVudGVkIGJ5OiBLYW5rcmVsdW5lIChodHRwOi8vd3d3LndlYmZha3RvcnkuaW5mby8pXG5cdCAgLy8gKyAgICAgIGltcHJvdmVkIGJ5OiBCcmV0dCBaYW1pciAoaHR0cDovL2JyZXR0LXphbWlyLm1lKVxuXHQgIC8vICsgICAgICBpbXByb3ZlZCBieTogU2NvdHQgQmFrZXJcblx0ICAvLyArICAgICAgaW1wcm92ZWQgYnk6IFRoZXJpYXVsdFxuXHQgIC8vICogICAgICAgIGV4YW1wbGUgMTogdmVyc2lvbl9jb21wYXJlKCc4LjIuNXJjJywgJzguMi41YScpO1xuXHQgIC8vICogICAgICAgIHJldHVybnMgMTogMVxuXHQgIC8vICogICAgICAgIGV4YW1wbGUgMjogdmVyc2lvbl9jb21wYXJlKCc4LjIuNTAnLCAnOC4yLjUyJywgJzwnKTtcblx0ICAvLyAqICAgICAgICByZXR1cm5zIDI6IHRydWVcblx0ICAvLyAqICAgICAgICBleGFtcGxlIDM6IHZlcnNpb25fY29tcGFyZSgnNS4zLjAtZGV2JywgJzUuMy4wJyk7XG5cdCAgLy8gKiAgICAgICAgcmV0dXJucyAzOiAtMVxuXHQgIC8vICogICAgICAgIGV4YW1wbGUgNDogdmVyc2lvbl9jb21wYXJlKCc0LjEuMC41MicsJzQuMDEuMC41MScpO1xuXHQgIC8vICogICAgICAgIHJldHVybnMgNDogMVxuXG5cdCAgLy8gSW1wb3J0YW50OiBjb21wYXJlIG11c3QgYmUgaW5pdGlhbGl6ZWQgYXQgMC5cblx0ICB2YXIgaSA9IDAsXG5cdCAgICB4ID0gMCxcblx0ICAgIGNvbXBhcmUgPSAwLFxuXHQgICAgLy8gdm0gbWFwcyB0ZXh0dWFsIFBIUCB2ZXJzaW9ucyB0byBuZWdhdGl2ZXMgc28gdGhleSdyZSBsZXNzIHRoYW4gMC5cblx0ICAgIC8vIFBIUCBjdXJyZW50bHkgZGVmaW5lcyB0aGVzZSBhcyBDQVNFLVNFTlNJVElWRS4gSXQgaXMgaW1wb3J0YW50IHRvXG5cdCAgICAvLyBsZWF2ZSB0aGVzZSBhcyBuZWdhdGl2ZXMgc28gdGhhdCB0aGV5IGNhbiBjb21lIGJlZm9yZSBudW1lcmljYWwgdmVyc2lvbnNcblx0ICAgIC8vIGFuZCBhcyBpZiBubyBsZXR0ZXJzIHdlcmUgdGhlcmUgdG8gYmVnaW4gd2l0aC5cblx0ICAgIC8vICgxYWxwaGEgaXMgPCAxIGFuZCA8IDEuMSBidXQgPiAxZGV2MSlcblx0ICAgIC8vIElmIGEgbm9uLW51bWVyaWNhbCB2YWx1ZSBjYW4ndCBiZSBtYXBwZWQgdG8gdGhpcyB0YWJsZSwgaXQgcmVjZWl2ZXNcblx0ICAgIC8vIC03IGFzIGl0cyB2YWx1ZS5cblx0ICAgIHZtID0ge1xuXHQgICAgICAnZGV2JzogLTYsXG5cdCAgICAgICdhbHBoYSc6IC01LFxuXHQgICAgICAnYSc6IC01LFxuXHQgICAgICAnYmV0YSc6IC00LFxuXHQgICAgICAnYic6IC00LFxuXHQgICAgICAnUkMnOiAtMyxcblx0ICAgICAgJ3JjJzogLTMsXG5cdCAgICAgICcjJzogLTIsXG5cdCAgICAgICdwJzogMSxcblx0ICAgICAgJ3BsJzogMVxuXHQgICAgfSxcblx0ICAgIC8vIFRoaXMgZnVuY3Rpb24gd2lsbCBiZSBjYWxsZWQgdG8gcHJlcGFyZSBlYWNoIHZlcnNpb24gYXJndW1lbnQuXG5cdCAgICAvLyBJdCByZXBsYWNlcyBldmVyeSBfLCAtLCBhbmQgKyB3aXRoIGEgZG90LlxuXHQgICAgLy8gSXQgc3Vycm91bmRzIGFueSBub25zZXF1ZW5jZSBvZiBudW1iZXJzL2RvdHMgd2l0aCBkb3RzLlxuXHQgICAgLy8gSXQgcmVwbGFjZXMgc2VxdWVuY2VzIG9mIGRvdHMgd2l0aCBhIHNpbmdsZSBkb3QuXG5cdCAgICAvLyAgICB2ZXJzaW9uX2NvbXBhcmUoJzQuLjAnLCAnNC4wJykgPT0gMFxuXHQgICAgLy8gSW1wb3J0YW50OiBBIHN0cmluZyBvZiAwIGxlbmd0aCBuZWVkcyB0byBiZSBjb252ZXJ0ZWQgaW50byBhIHZhbHVlXG5cdCAgICAvLyBldmVuIGxlc3MgdGhhbiBhbiB1bmV4aXN0aW5nIHZhbHVlIGluIHZtICgtNyksIGhlbmNlIFstOF0uXG5cdCAgICAvLyBJdCdzIGFsc28gaW1wb3J0YW50IHRvIG5vdCBzdHJpcCBzcGFjZXMgYmVjYXVzZSBvZiB0aGlzLlxuXHQgICAgLy8gICB2ZXJzaW9uX2NvbXBhcmUoJycsICcgJykgPT0gMVxuXHQgICAgcHJlcFZlcnNpb24gPSBmdW5jdGlvbiAodikge1xuXHQgICAgICB2ID0gKCcnICsgdikucmVwbGFjZSgvW19cXC0rXS9nLCAnLicpO1xuXHQgICAgICB2ID0gdi5yZXBsYWNlKC8oW14uXFxkXSspL2csICcuJDEuJykucmVwbGFjZSgvXFwuezIsfS9nLCAnLicpO1xuXHQgICAgICByZXR1cm4gKCF2Lmxlbmd0aCA/IFstOF0gOiB2LnNwbGl0KCcuJykpO1xuXHQgICAgfSxcblx0ICAgIC8vIFRoaXMgY29udmVydHMgYSB2ZXJzaW9uIGNvbXBvbmVudCB0byBhIG51bWJlci5cblx0ICAgIC8vIEVtcHR5IGNvbXBvbmVudCBiZWNvbWVzIDAuXG5cdCAgICAvLyBOb24tbnVtZXJpY2FsIGNvbXBvbmVudCBiZWNvbWVzIGEgbmVnYXRpdmUgbnVtYmVyLlxuXHQgICAgLy8gTnVtZXJpY2FsIGNvbXBvbmVudCBiZWNvbWVzIGl0c2VsZiBhcyBhbiBpbnRlZ2VyLlxuXHQgICAgbnVtVmVyc2lvbiA9IGZ1bmN0aW9uICh2KSB7XG5cdCAgICAgIHJldHVybiAhdiA/IDAgOiAoaXNOYU4odikgPyB2bVt2XSB8fCAtNyA6IHBhcnNlSW50KHYsIDEwKSk7XG5cdCAgICB9O1xuXG5cdCAgdjEgPSBwcmVwVmVyc2lvbih2MSk7XG5cdCAgdjIgPSBwcmVwVmVyc2lvbih2Mik7XG5cdCAgeCA9IE1hdGgubWF4KHYxLmxlbmd0aCwgdjIubGVuZ3RoKTtcblx0ICBmb3IgKGkgPSAwOyBpIDwgeDsgaSsrKSB7XG5cdCAgICBpZiAodjFbaV0gPT0gdjJbaV0pIHtcblx0ICAgICAgY29udGludWU7XG5cdCAgICB9XG5cdCAgICB2MVtpXSA9IG51bVZlcnNpb24odjFbaV0pO1xuXHQgICAgdjJbaV0gPSBudW1WZXJzaW9uKHYyW2ldKTtcblx0ICAgIGlmICh2MVtpXSA8IHYyW2ldKSB7XG5cdCAgICAgIGNvbXBhcmUgPSAtMTtcblx0ICAgICAgYnJlYWs7XG5cdCAgICB9IGVsc2UgaWYgKHYxW2ldID4gdjJbaV0pIHtcblx0ICAgICAgY29tcGFyZSA9IDE7XG5cdCAgICAgIGJyZWFrO1xuXHQgICAgfVxuXHQgIH1cblx0ICBpZiAoIW9wZXJhdG9yKSB7XG5cdCAgICByZXR1cm4gY29tcGFyZTtcblx0ICB9XG5cblx0ICAvLyBJbXBvcnRhbnQ6IG9wZXJhdG9yIGlzIENBU0UtU0VOU0lUSVZFLlxuXHQgIC8vIFwiTm8gb3BlcmF0b3JcIiBzZWVtcyB0byBiZSB0cmVhdGVkIGFzIFwiPC5cIlxuXHQgIC8vIEFueSBvdGhlciB2YWx1ZXMgc2VlbSB0byBtYWtlIHRoZSBmdW5jdGlvbiByZXR1cm4gbnVsbC5cblx0ICBzd2l0Y2ggKG9wZXJhdG9yKSB7XG5cdCAgY2FzZSAnPic6XG5cdCAgY2FzZSAnZ3QnOlxuXHQgICAgcmV0dXJuIChjb21wYXJlID4gMCk7XG5cdCAgY2FzZSAnPj0nOlxuXHQgIGNhc2UgJ2dlJzpcblx0ICAgIHJldHVybiAoY29tcGFyZSA+PSAwKTtcblx0ICBjYXNlICc8PSc6XG5cdCAgY2FzZSAnbGUnOlxuXHQgICAgcmV0dXJuIChjb21wYXJlIDw9IDApO1xuXHQgIGNhc2UgJz09Jzpcblx0ICBjYXNlICc9Jzpcblx0ICBjYXNlICdlcSc6XG5cdCAgICByZXR1cm4gKGNvbXBhcmUgPT09IDApO1xuXHQgIGNhc2UgJzw+Jzpcblx0ICBjYXNlICchPSc6XG5cdCAgY2FzZSAnbmUnOlxuXHQgICAgcmV0dXJuIChjb21wYXJlICE9PSAwKTtcblx0ICBjYXNlICcnOlxuXHQgIGNhc2UgJzwnOlxuXHQgIGNhc2UgJ2x0Jzpcblx0ICAgIHJldHVybiAoY29tcGFyZSA8IDApO1xuXHQgIGRlZmF1bHQ6XG5cdCAgICByZXR1cm4gbnVsbDtcblx0ICB9XG5cdH1cblxuXG5cdHZhciBjYW4gPSAoZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGNhcHMgPSB7XG5cdFx0XHRhY2Nlc3NfZ2xvYmFsX25zOiBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdHJldHVybiAhIXdpbmRvdy5tb3hpZTtcblx0XHRcdH0sXG5cblx0XHRcdGRlZmluZV9wcm9wZXJ0eTogKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHQvKiAvLyBjdXJyZW50bHkgdG9vIG11Y2ggZXh0cmEgY29kZSByZXF1aXJlZCwgbm90IGV4YWN0bHkgd29ydGggaXRcblx0XHRcdFx0dHJ5IHsgLy8gYXMgb2YgSUU4LCBnZXR0ZXJzL3NldHRlcnMgYXJlIHN1cHBvcnRlZCBvbmx5IG9uIERPTSBlbGVtZW50c1xuXHRcdFx0XHRcdHZhciBvYmogPSB7fTtcblx0XHRcdFx0XHRpZiAoT2JqZWN0LmRlZmluZVByb3BlcnR5KSB7XG5cdFx0XHRcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCAncHJvcCcsIHtcblx0XHRcdFx0XHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcblx0XHRcdFx0XHRcdFx0Y29uZmlndXJhYmxlOiB0cnVlXG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSBjYXRjaChleCkge31cblxuXHRcdFx0XHRpZiAoT2JqZWN0LnByb3RvdHlwZS5fX2RlZmluZUdldHRlcl9fICYmIE9iamVjdC5wcm90b3R5cGUuX19kZWZpbmVTZXR0ZXJfXykge1xuXHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHR9Ki9cblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fSgpKSxcblxuXHRcdFx0Y3JlYXRlX2NhbnZhczogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdC8vIE9uIHRoZSBTNjAgYW5kIEJCIFN0b3JtLCBnZXRDb250ZXh0IGV4aXN0cywgYnV0IGFsd2F5cyByZXR1cm5zIHVuZGVmaW5lZFxuXHRcdFx0XHQvLyBzbyB3ZSBhY3R1YWxseSBoYXZlIHRvIGNhbGwgZ2V0Q29udGV4dCgpIHRvIHZlcmlmeVxuXHRcdFx0XHQvLyBnaXRodWIuY29tL01vZGVybml6ci9Nb2Rlcm5penIvaXNzdWVzL2lzc3VlLzk3L1xuXHRcdFx0XHR2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcblx0XHRcdFx0dmFyIGlzU3VwcG9ydGVkID0gISEoZWwuZ2V0Q29udGV4dCAmJiBlbC5nZXRDb250ZXh0KCcyZCcpKTtcblx0XHRcdFx0Y2Fwcy5jcmVhdGVfY2FudmFzID0gaXNTdXBwb3J0ZWQ7XG5cdFx0XHRcdHJldHVybiBpc1N1cHBvcnRlZDtcblx0XHRcdH0sXG5cblx0XHRcdHJldHVybl9yZXNwb25zZV90eXBlOiBmdW5jdGlvbihyZXNwb25zZVR5cGUpIHtcblx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRpZiAoQmFzaWMuaW5BcnJheShyZXNwb25zZVR5cGUsIFsnJywgJ3RleHQnLCAnZG9jdW1lbnQnXSkgIT09IC0xKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0XHR9IGVsc2UgaWYgKHdpbmRvdy5YTUxIdHRwUmVxdWVzdCkge1xuXHRcdFx0XHRcdFx0dmFyIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuXHRcdFx0XHRcdFx0eGhyLm9wZW4oJ2dldCcsICcvJyk7IC8vIG90aGVyd2lzZSBHZWNrbyB0aHJvd3MgYW4gZXhjZXB0aW9uXG5cdFx0XHRcdFx0XHRpZiAoJ3Jlc3BvbnNlVHlwZScgaW4geGhyKSB7XG5cdFx0XHRcdFx0XHRcdHhoci5yZXNwb25zZVR5cGUgPSByZXNwb25zZVR5cGU7XG5cdFx0XHRcdFx0XHRcdC8vIGFzIG9mIDIzLjAuMTI3MS42NCwgQ2hyb21lIHN3aXRjaGVkIGZyb20gdGhyb3dpbmcgZXhjZXB0aW9uIHRvIG1lcmVseSBsb2dnaW5nIGl0IHRvIHRoZSBjb25zb2xlICh3aHk/IG8gd2h5Pylcblx0XHRcdFx0XHRcdFx0aWYgKHhoci5yZXNwb25zZVR5cGUgIT09IHJlc3BvbnNlVHlwZSkge1xuXHRcdFx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gY2F0Y2ggKGV4KSB7fVxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9LFxuXG5cdFx0XHR1c2VfYmxvYl91cmk6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR2YXIgVVJMID0gd2luZG93LlVSTDtcblx0XHRcdFx0Y2Fwcy51c2VfYmxvYl91cmkgPSAoVVJMICYmXG5cdFx0XHRcdFx0J2NyZWF0ZU9iamVjdFVSTCcgaW4gVVJMICYmXG5cdFx0XHRcdFx0J3Jldm9rZU9iamVjdFVSTCcgaW4gVVJMICYmXG5cdFx0XHRcdFx0KEVudi5icm93c2VyICE9PSAnSUUnIHx8IEVudi52ZXJDb21wKEVudi52ZXJzaW9uLCAnMTEuMC40NicsICc+PScpKSAvLyBJRSBzdXBwb3J0cyBjcmVhdGVPYmplY3RVUkwsIGJ1dCBub3QgZnVsbHksIGZvciBleGFtcGxlIGl0IGZhaWxzIHRvIHVzZSBpdCBhcyBhIHNyYyBmb3IgdGhlIGltYWdlXG5cdFx0XHRcdCk7XG5cdFx0XHRcdHJldHVybiBjYXBzLnVzZV9ibG9iX3VyaTtcblx0XHRcdH0sXG5cblx0XHRcdC8vIGlkZWFzIGZvciB0aGlzIGhlYXZpbHkgY29tZSBmcm9tIE1vZGVybml6ciAoaHR0cDovL21vZGVybml6ci5jb20vKVxuXHRcdFx0dXNlX2RhdGFfdXJpOiAoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciBkdSA9IG5ldyBJbWFnZSgpO1xuXG5cdFx0XHRcdGR1Lm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdGNhcHMudXNlX2RhdGFfdXJpID0gKGR1LndpZHRoID09PSAxICYmIGR1LmhlaWdodCA9PT0gMSk7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0c2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRkdS5zcmMgPSBcImRhdGE6aW1hZ2UvZ2lmO2Jhc2U2NCxSMGxHT0RsaEFRQUJBSUFBQVA4QUFBQUFBQ0g1QkFBQUFBQUFMQUFBQUFBQkFBRUFBQUlDUkFFQU93PT1cIjtcblx0XHRcdFx0fSwgMSk7XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH0oKSksXG5cblx0XHRcdHVzZV9kYXRhX3VyaV9vdmVyMzJrYjogZnVuY3Rpb24oKSB7IC8vIElFOFxuXHRcdFx0XHRyZXR1cm4gY2Fwcy51c2VfZGF0YV91cmkgJiYgKEVudi5icm93c2VyICE9PSAnSUUnIHx8IEVudi52ZXJzaW9uID49IDkpO1xuXHRcdFx0fSxcblxuXHRcdFx0dXNlX2RhdGFfdXJpX29mOiBmdW5jdGlvbihieXRlcykge1xuXHRcdFx0XHRyZXR1cm4gKGNhcHMudXNlX2RhdGFfdXJpICYmIGJ5dGVzIDwgMzMwMDAgfHwgY2Fwcy51c2VfZGF0YV91cmlfb3ZlcjMya2IoKSk7XG5cdFx0XHR9LFxuXG5cdFx0XHR1c2VfZmlsZWlucHV0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0aWYgKG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goLyhBbmRyb2lkICgxLjB8MS4xfDEuNXwxLjZ8Mi4wfDIuMSkpfChXaW5kb3dzIFBob25lIChPUyA3fDguMCkpfChYQkxXUCl8KFp1bmVXUCl8KHcoZWIpP09TQnJvd3Nlcil8KHdlYk9TKXwoS2luZGxlXFwvKDEuMHwyLjB8Mi41fDMuMCkpLykpIHtcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuXHRcdFx0XHRlbC5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAnZmlsZScpO1xuXHRcdFx0XHRyZXR1cm4gY2Fwcy51c2VfZmlsZWlucHV0ID0gIWVsLmRpc2FibGVkO1xuXHRcdFx0fSxcblxuXHRcdFx0dXNlX3dlYmdsOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xuXHRcdFx0XHR2YXIgZ2wgPSBudWxsLCBpc1N1cHBvcnRlZDtcblx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRnbCA9IGNhbnZhcy5nZXRDb250ZXh0KFwid2ViZ2xcIikgfHwgY2FudmFzLmdldENvbnRleHQoXCJleHBlcmltZW50YWwtd2ViZ2xcIik7XG5cdFx0XHRcdH1cblx0XHRcdFx0Y2F0Y2goZSkge31cblxuXHRcdFx0XHRpZiAoIWdsKSB7IC8vIGl0IHNlZW1zIHRoYXQgc29tZXRpbWVzIGl0IGRvZXNuJ3QgdGhyb3cgZXhjZXB0aW9uLCBidXQgc3RpbGwgZmFpbHMgdG8gZ2V0IGNvbnRleHRcblx0XHRcdFx0XHRnbCA9IG51bGw7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpc1N1cHBvcnRlZCA9ICEhZ2w7XG5cdFx0XHRcdGNhcHMudXNlX3dlYmdsID0gaXNTdXBwb3J0ZWQ7IC8vIHNhdmUgcmVzdWx0IG9mIG91ciBjaGVja1xuXHRcdFx0XHRjYW52YXMgPSB1bmRlZmluZWQ7XG5cdFx0XHRcdHJldHVybiBpc1N1cHBvcnRlZDtcblx0XHRcdH1cblx0XHR9O1xuXG5cdFx0cmV0dXJuIGZ1bmN0aW9uKGNhcCkge1xuXHRcdFx0dmFyIGFyZ3MgPSBbXS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7XG5cdFx0XHRhcmdzLnNoaWZ0KCk7IC8vIHNoaWZ0IG9mIGNhcFxuXHRcdFx0cmV0dXJuIEJhc2ljLnR5cGVPZihjYXBzW2NhcF0pID09PSAnZnVuY3Rpb24nID8gY2Fwc1tjYXBdLmFwcGx5KHRoaXMsIGFyZ3MpIDogISFjYXBzW2NhcF07XG5cdFx0fTtcblx0fSgpKTtcblxuXG5cdHZhciB1YVJlc3VsdCA9IG5ldyBVQVBhcnNlcigpLmdldFJlc3VsdCgpO1xuXG5cblx0dmFyIEVudiA9IHtcblx0XHRjYW46IGNhbixcblxuXHRcdHVhUGFyc2VyOiBVQVBhcnNlcixcblxuXHRcdGJyb3dzZXI6IHVhUmVzdWx0LmJyb3dzZXIubmFtZSxcblx0XHR2ZXJzaW9uOiB1YVJlc3VsdC5icm93c2VyLnZlcnNpb24sXG5cdFx0b3M6IHVhUmVzdWx0Lm9zLm5hbWUsIC8vIGV2ZXJ5Ym9keSBpbnR1aXRpdmVseSB0eXBlcyBpdCBpbiBhIGxvd2VyY2FzZSBmb3Igc29tZSByZWFzb25cblx0XHRvc1ZlcnNpb246IHVhUmVzdWx0Lm9zLnZlcnNpb24sXG5cblx0XHR2ZXJDb21wOiB2ZXJzaW9uX2NvbXBhcmUsXG5cblx0XHRzd2ZfdXJsOiBcIi4uL2ZsYXNoL01veGllLnN3ZlwiLFxuXHRcdHhhcF91cmw6IFwiLi4vc2lsdmVybGlnaHQvTW94aWUueGFwXCIsXG5cdFx0Z2xvYmFsX2V2ZW50X2Rpc3BhdGNoZXI6IFwibW94aWUuY29yZS5FdmVudFRhcmdldC5pbnN0YW5jZS5kaXNwYXRjaEV2ZW50XCJcblx0fTtcblxuXHQvLyBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eVxuXHQvLyBAZGVwcmVjYXRlZCBVc2UgYEVudi5vc2AgaW5zdGVhZFxuXHRFbnYuT1MgPSBFbnYub3M7XG5cblx0aWYgKE1YSV9ERUJVRykge1xuXHRcdEVudi5kZWJ1ZyA9IHtcblx0XHRcdHJ1bnRpbWU6IHRydWUsXG5cdFx0XHRldmVudHM6IGZhbHNlXG5cdFx0fTtcblxuXHRcdEVudi5sb2cgPSBmdW5jdGlvbigpIHtcblxuXHRcdFx0ZnVuY3Rpb24gbG9nT2JqKGRhdGEpIHtcblx0XHRcdFx0Ly8gVE9ETzogdGhpcyBzaG91bGQgcmVjdXJzaXZlbHkgcHJpbnQgb3V0IHRoZSBvYmplY3QgaW4gYSBwcmV0dHkgd2F5XG5cdFx0XHRcdGNvbnNvbGUuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoZGF0YSArIFwiXFxuXCIpKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gaWYgZGVidWdnZXIgcHJlc2VudCwgSUU4IG1pZ2h0IGhhdmUgd2luZG93LmNvbnNvbGUubG9nIG1ldGhvZCwgYnV0IG5vdCBiZSBhYmxlIHRvIGFwcGx5IG9uIGl0ICh3aHkuLi4pXG5cdFx0XHRpZiAod2luZG93ICYmIHdpbmRvdy5jb25zb2xlICYmIHdpbmRvdy5jb25zb2xlLmxvZyAmJiB3aW5kb3cuY29uc29sZS5sb2cuYXBwbHkpIHtcblx0XHRcdFx0d2luZG93LmNvbnNvbGUubG9nLmFwcGx5KHdpbmRvdy5jb25zb2xlLCBhcmd1bWVudHMpO1xuXHRcdFx0fSBlbHNlIGlmIChkb2N1bWVudCkge1xuXHRcdFx0XHR2YXIgY29uc29sZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb3hpZS1jb25zb2xlJyk7XG5cdFx0XHRcdGlmICghY29uc29sZSkge1xuXHRcdFx0XHRcdGNvbnNvbGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwcmUnKTtcblx0XHRcdFx0XHRjb25zb2xlLmlkID0gJ21veGllLWNvbnNvbGUnO1xuXHRcdFx0XHRcdC8vY29uc29sZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0XHRcdGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoY29uc29sZSk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR2YXIgZGF0YSA9IGFyZ3VtZW50c1swXTtcblx0XHRcdFx0aWYgKEJhc2ljLnR5cGVPZihkYXRhKSA9PT0gJ3N0cmluZycpIHtcblx0XHRcdFx0XHRkYXRhID0gQmFzaWMuc3ByaW50Zi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdFx0XHR9IGVsc2UgaWYgKEJhc2ljLmluQXJyYXkoQmFzaWMudHlwZU9mKGRhdGEpLCBbJ29iamVjdCcsICdhcnJheSddKSAhPT0gLTEpIHtcblx0XHRcdFx0XHRsb2dPYmooZGF0YSk7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Y29uc29sZS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShkYXRhICsgXCJcXG5cIikpO1xuXHRcdFx0fVxuXHRcdH07XG5cdH1cblxuXHRyZXR1cm4gRW52O1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L2NvcmUvRXhjZXB0aW9ucy5qc1xuXG4vKipcbiAqIEV4Y2VwdGlvbnMuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuZGVmaW5lKCdtb3hpZS9jb3JlL0V4Y2VwdGlvbnMnLCBbXG5cdCdtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljJ1xuXSwgZnVuY3Rpb24oQmFzaWMpIHtcblx0XG5cdGZ1bmN0aW9uIF9maW5kS2V5KG9iaiwgdmFsdWUpIHtcblx0XHR2YXIga2V5O1xuXHRcdGZvciAoa2V5IGluIG9iaikge1xuXHRcdFx0aWYgKG9ialtrZXldID09PSB2YWx1ZSkge1xuXHRcdFx0XHRyZXR1cm4ga2V5O1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gbnVsbDtcblx0fVxuXG5cdC8qKlxuXHRAY2xhc3MgbW94aWUvY29yZS9FeGNlcHRpb25cblx0Ki9cblx0cmV0dXJuIHtcblx0XHRSdW50aW1lRXJyb3I6IChmdW5jdGlvbigpIHtcblx0XHRcdHZhciBuYW1lY29kZXMgPSB7XG5cdFx0XHRcdE5PVF9JTklUX0VSUjogMSxcblx0XHRcdFx0RVhDRVBUSU9OX0VSUjogMyxcblx0XHRcdFx0Tk9UX1NVUFBPUlRFRF9FUlI6IDksXG5cdFx0XHRcdEpTX0VSUjogNFxuXHRcdFx0fTtcblxuXHRcdFx0ZnVuY3Rpb24gUnVudGltZUVycm9yKGNvZGUsIG1lc3NhZ2UpIHtcblx0XHRcdFx0dGhpcy5jb2RlID0gY29kZTtcblx0XHRcdFx0dGhpcy5uYW1lID0gX2ZpbmRLZXkobmFtZWNvZGVzLCBjb2RlKTtcblx0XHRcdFx0dGhpcy5tZXNzYWdlID0gdGhpcy5uYW1lICsgKG1lc3NhZ2UgfHwgXCI6IFJ1bnRpbWVFcnJvciBcIiArIHRoaXMuY29kZSk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdEJhc2ljLmV4dGVuZChSdW50aW1lRXJyb3IsIG5hbWVjb2Rlcyk7XG5cdFx0XHRSdW50aW1lRXJyb3IucHJvdG90eXBlID0gRXJyb3IucHJvdG90eXBlO1xuXHRcdFx0cmV0dXJuIFJ1bnRpbWVFcnJvcjtcblx0XHR9KCkpLFxuXHRcdFxuXHRcdE9wZXJhdGlvbk5vdEFsbG93ZWRFeGNlcHRpb246IChmdW5jdGlvbigpIHtcblx0XHRcdFxuXHRcdFx0ZnVuY3Rpb24gT3BlcmF0aW9uTm90QWxsb3dlZEV4Y2VwdGlvbihjb2RlKSB7XG5cdFx0XHRcdHRoaXMuY29kZSA9IGNvZGU7XG5cdFx0XHRcdHRoaXMubmFtZSA9ICdPcGVyYXRpb25Ob3RBbGxvd2VkRXhjZXB0aW9uJztcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0QmFzaWMuZXh0ZW5kKE9wZXJhdGlvbk5vdEFsbG93ZWRFeGNlcHRpb24sIHtcblx0XHRcdFx0Tk9UX0FMTE9XRURfRVJSOiAxXG5cdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0T3BlcmF0aW9uTm90QWxsb3dlZEV4Y2VwdGlvbi5wcm90b3R5cGUgPSBFcnJvci5wcm90b3R5cGU7XG5cdFx0XHRcblx0XHRcdHJldHVybiBPcGVyYXRpb25Ob3RBbGxvd2VkRXhjZXB0aW9uO1xuXHRcdH0oKSksXG5cblx0XHRJbWFnZUVycm9yOiAoZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgbmFtZWNvZGVzID0ge1xuXHRcdFx0XHRXUk9OR19GT1JNQVQ6IDEsXG5cdFx0XHRcdE1BWF9SRVNPTFVUSU9OX0VSUjogMixcblx0XHRcdFx0SU5WQUxJRF9NRVRBX0VSUjogM1xuXHRcdFx0fTtcblxuXHRcdFx0ZnVuY3Rpb24gSW1hZ2VFcnJvcihjb2RlKSB7XG5cdFx0XHRcdHRoaXMuY29kZSA9IGNvZGU7XG5cdFx0XHRcdHRoaXMubmFtZSA9IF9maW5kS2V5KG5hbWVjb2RlcywgY29kZSk7XG5cdFx0XHRcdHRoaXMubWVzc2FnZSA9IHRoaXMubmFtZSArIFwiOiBJbWFnZUVycm9yIFwiICsgdGhpcy5jb2RlO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRCYXNpYy5leHRlbmQoSW1hZ2VFcnJvciwgbmFtZWNvZGVzKTtcblx0XHRcdEltYWdlRXJyb3IucHJvdG90eXBlID0gRXJyb3IucHJvdG90eXBlO1xuXG5cdFx0XHRyZXR1cm4gSW1hZ2VFcnJvcjtcblx0XHR9KCkpLFxuXG5cdFx0RmlsZUV4Y2VwdGlvbjogKGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIG5hbWVjb2RlcyA9IHtcblx0XHRcdFx0Tk9UX0ZPVU5EX0VSUjogMSxcblx0XHRcdFx0U0VDVVJJVFlfRVJSOiAyLFxuXHRcdFx0XHRBQk9SVF9FUlI6IDMsXG5cdFx0XHRcdE5PVF9SRUFEQUJMRV9FUlI6IDQsXG5cdFx0XHRcdEVOQ09ESU5HX0VSUjogNSxcblx0XHRcdFx0Tk9fTU9ESUZJQ0FUSU9OX0FMTE9XRURfRVJSOiA2LFxuXHRcdFx0XHRJTlZBTElEX1NUQVRFX0VSUjogNyxcblx0XHRcdFx0U1lOVEFYX0VSUjogOFxuXHRcdFx0fTtcblxuXHRcdFx0ZnVuY3Rpb24gRmlsZUV4Y2VwdGlvbihjb2RlKSB7XG5cdFx0XHRcdHRoaXMuY29kZSA9IGNvZGU7XG5cdFx0XHRcdHRoaXMubmFtZSA9IF9maW5kS2V5KG5hbWVjb2RlcywgY29kZSk7XG5cdFx0XHRcdHRoaXMubWVzc2FnZSA9IHRoaXMubmFtZSArIFwiOiBGaWxlRXhjZXB0aW9uIFwiICsgdGhpcy5jb2RlO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRCYXNpYy5leHRlbmQoRmlsZUV4Y2VwdGlvbiwgbmFtZWNvZGVzKTtcblx0XHRcdEZpbGVFeGNlcHRpb24ucHJvdG90eXBlID0gRXJyb3IucHJvdG90eXBlO1xuXHRcdFx0cmV0dXJuIEZpbGVFeGNlcHRpb247XG5cdFx0fSgpKSxcblx0XHRcblx0XHRET01FeGNlcHRpb246IChmdW5jdGlvbigpIHtcblx0XHRcdHZhciBuYW1lY29kZXMgPSB7XG5cdFx0XHRcdElOREVYX1NJWkVfRVJSOiAxLFxuXHRcdFx0XHRET01TVFJJTkdfU0laRV9FUlI6IDIsXG5cdFx0XHRcdEhJRVJBUkNIWV9SRVFVRVNUX0VSUjogMyxcblx0XHRcdFx0V1JPTkdfRE9DVU1FTlRfRVJSOiA0LFxuXHRcdFx0XHRJTlZBTElEX0NIQVJBQ1RFUl9FUlI6IDUsXG5cdFx0XHRcdE5PX0RBVEFfQUxMT1dFRF9FUlI6IDYsXG5cdFx0XHRcdE5PX01PRElGSUNBVElPTl9BTExPV0VEX0VSUjogNyxcblx0XHRcdFx0Tk9UX0ZPVU5EX0VSUjogOCxcblx0XHRcdFx0Tk9UX1NVUFBPUlRFRF9FUlI6IDksXG5cdFx0XHRcdElOVVNFX0FUVFJJQlVURV9FUlI6IDEwLFxuXHRcdFx0XHRJTlZBTElEX1NUQVRFX0VSUjogMTEsXG5cdFx0XHRcdFNZTlRBWF9FUlI6IDEyLFxuXHRcdFx0XHRJTlZBTElEX01PRElGSUNBVElPTl9FUlI6IDEzLFxuXHRcdFx0XHROQU1FU1BBQ0VfRVJSOiAxNCxcblx0XHRcdFx0SU5WQUxJRF9BQ0NFU1NfRVJSOiAxNSxcblx0XHRcdFx0VkFMSURBVElPTl9FUlI6IDE2LFxuXHRcdFx0XHRUWVBFX01JU01BVENIX0VSUjogMTcsXG5cdFx0XHRcdFNFQ1VSSVRZX0VSUjogMTgsXG5cdFx0XHRcdE5FVFdPUktfRVJSOiAxOSxcblx0XHRcdFx0QUJPUlRfRVJSOiAyMCxcblx0XHRcdFx0VVJMX01JU01BVENIX0VSUjogMjEsXG5cdFx0XHRcdFFVT1RBX0VYQ0VFREVEX0VSUjogMjIsXG5cdFx0XHRcdFRJTUVPVVRfRVJSOiAyMyxcblx0XHRcdFx0SU5WQUxJRF9OT0RFX1RZUEVfRVJSOiAyNCxcblx0XHRcdFx0REFUQV9DTE9ORV9FUlI6IDI1XG5cdFx0XHR9O1xuXG5cdFx0XHRmdW5jdGlvbiBET01FeGNlcHRpb24oY29kZSkge1xuXHRcdFx0XHR0aGlzLmNvZGUgPSBjb2RlO1xuXHRcdFx0XHR0aGlzLm5hbWUgPSBfZmluZEtleShuYW1lY29kZXMsIGNvZGUpO1xuXHRcdFx0XHR0aGlzLm1lc3NhZ2UgPSB0aGlzLm5hbWUgKyBcIjogRE9NRXhjZXB0aW9uIFwiICsgdGhpcy5jb2RlO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRCYXNpYy5leHRlbmQoRE9NRXhjZXB0aW9uLCBuYW1lY29kZXMpO1xuXHRcdFx0RE9NRXhjZXB0aW9uLnByb3RvdHlwZSA9IEVycm9yLnByb3RvdHlwZTtcblx0XHRcdHJldHVybiBET01FeGNlcHRpb247XG5cdFx0fSgpKSxcblx0XHRcblx0XHRFdmVudEV4Y2VwdGlvbjogKGZ1bmN0aW9uKCkge1xuXHRcdFx0ZnVuY3Rpb24gRXZlbnRFeGNlcHRpb24oY29kZSkge1xuXHRcdFx0XHR0aGlzLmNvZGUgPSBjb2RlO1xuXHRcdFx0XHR0aGlzLm5hbWUgPSAnRXZlbnRFeGNlcHRpb24nO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRCYXNpYy5leHRlbmQoRXZlbnRFeGNlcHRpb24sIHtcblx0XHRcdFx0VU5TUEVDSUZJRURfRVZFTlRfVFlQRV9FUlI6IDBcblx0XHRcdH0pO1xuXHRcdFx0XG5cdFx0XHRFdmVudEV4Y2VwdGlvbi5wcm90b3R5cGUgPSBFcnJvci5wcm90b3R5cGU7XG5cdFx0XHRcblx0XHRcdHJldHVybiBFdmVudEV4Y2VwdGlvbjtcblx0XHR9KCkpXG5cdH07XG59KTtcblxuLy8gSW5jbHVkZWQgZnJvbTogc3JjL2phdmFzY3JpcHQvY29yZS91dGlscy9Eb20uanNcblxuLyoqXG4gKiBEb20uanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuLyoqXG5AY2xhc3MgbW94aWUvY29yZS91dGlscy9Eb21cbkBwdWJsaWNcbkBzdGF0aWNcbiovXG5cbmRlZmluZSgnbW94aWUvY29yZS91dGlscy9Eb20nLCBbJ21veGllL2NvcmUvdXRpbHMvRW52J10sIGZ1bmN0aW9uKEVudikge1xuXG5cdC8qKlxuXHRHZXQgRE9NIEVsZW1lbnQgYnkgaXQncyBpZC5cblxuXHRAbWV0aG9kIGdldFxuXHRAcGFyYW0ge1N0cmluZ30gaWQgSWRlbnRpZmllciBvZiB0aGUgRE9NIEVsZW1lbnRcblx0QHJldHVybiB7RE9NRWxlbWVudH1cblx0Ki9cblx0dmFyIGdldCA9IGZ1bmN0aW9uKGlkKSB7XG5cdFx0aWYgKHR5cGVvZiBpZCAhPT0gJ3N0cmluZycpIHtcblx0XHRcdHJldHVybiBpZDtcblx0XHR9XG5cdFx0cmV0dXJuIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTtcblx0fTtcblxuXHQvKipcblx0Q2hlY2tzIGlmIHNwZWNpZmllZCBET00gZWxlbWVudCBoYXMgc3BlY2lmaWVkIGNsYXNzLlxuXG5cdEBtZXRob2QgaGFzQ2xhc3Ncblx0QHN0YXRpY1xuXHRAcGFyYW0ge09iamVjdH0gb2JqIERPTSBlbGVtZW50IGxpa2Ugb2JqZWN0IHRvIGFkZCBoYW5kbGVyIHRvLlxuXHRAcGFyYW0ge1N0cmluZ30gbmFtZSBDbGFzcyBuYW1lXG5cdCovXG5cdHZhciBoYXNDbGFzcyA9IGZ1bmN0aW9uKG9iaiwgbmFtZSkge1xuXHRcdGlmICghb2JqLmNsYXNzTmFtZSkge1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblxuXHRcdHZhciByZWdFeHAgPSBuZXcgUmVnRXhwKFwiKF58XFxcXHMrKVwiK25hbWUrXCIoXFxcXHMrfCQpXCIpO1xuXHRcdHJldHVybiByZWdFeHAudGVzdChvYmouY2xhc3NOYW1lKTtcblx0fTtcblxuXHQvKipcblx0QWRkcyBzcGVjaWZpZWQgY2xhc3NOYW1lIHRvIHNwZWNpZmllZCBET00gZWxlbWVudC5cblxuXHRAbWV0aG9kIGFkZENsYXNzXG5cdEBzdGF0aWNcblx0QHBhcmFtIHtPYmplY3R9IG9iaiBET00gZWxlbWVudCBsaWtlIG9iamVjdCB0byBhZGQgaGFuZGxlciB0by5cblx0QHBhcmFtIHtTdHJpbmd9IG5hbWUgQ2xhc3MgbmFtZVxuXHQqL1xuXHR2YXIgYWRkQ2xhc3MgPSBmdW5jdGlvbihvYmosIG5hbWUpIHtcblx0XHRpZiAoIWhhc0NsYXNzKG9iaiwgbmFtZSkpIHtcblx0XHRcdG9iai5jbGFzc05hbWUgPSAhb2JqLmNsYXNzTmFtZSA/IG5hbWUgOiBvYmouY2xhc3NOYW1lLnJlcGxhY2UoL1xccyskLywgJycpICsgJyAnICsgbmFtZTtcblx0XHR9XG5cdH07XG5cblx0LyoqXG5cdFJlbW92ZXMgc3BlY2lmaWVkIGNsYXNzTmFtZSBmcm9tIHNwZWNpZmllZCBET00gZWxlbWVudC5cblxuXHRAbWV0aG9kIHJlbW92ZUNsYXNzXG5cdEBzdGF0aWNcblx0QHBhcmFtIHtPYmplY3R9IG9iaiBET00gZWxlbWVudCBsaWtlIG9iamVjdCB0byBhZGQgaGFuZGxlciB0by5cblx0QHBhcmFtIHtTdHJpbmd9IG5hbWUgQ2xhc3MgbmFtZVxuXHQqL1xuXHR2YXIgcmVtb3ZlQ2xhc3MgPSBmdW5jdGlvbihvYmosIG5hbWUpIHtcblx0XHRpZiAob2JqLmNsYXNzTmFtZSkge1xuXHRcdFx0dmFyIHJlZ0V4cCA9IG5ldyBSZWdFeHAoXCIoXnxcXFxccyspXCIrbmFtZStcIihcXFxccyt8JClcIik7XG5cdFx0XHRvYmouY2xhc3NOYW1lID0gb2JqLmNsYXNzTmFtZS5yZXBsYWNlKHJlZ0V4cCwgZnVuY3Rpb24oJDAsICQxLCAkMikge1xuXHRcdFx0XHRyZXR1cm4gJDEgPT09ICcgJyAmJiAkMiA9PT0gJyAnID8gJyAnIDogJyc7XG5cdFx0XHR9KTtcblx0XHR9XG5cdH07XG5cblx0LyoqXG5cdFJldHVybnMgYSBnaXZlbiBjb21wdXRlZCBzdHlsZSBvZiBhIERPTSBlbGVtZW50LlxuXG5cdEBtZXRob2QgZ2V0U3R5bGVcblx0QHN0YXRpY1xuXHRAcGFyYW0ge09iamVjdH0gb2JqIERPTSBlbGVtZW50IGxpa2Ugb2JqZWN0LlxuXHRAcGFyYW0ge1N0cmluZ30gbmFtZSBTdHlsZSB5b3Ugd2FudCB0byBnZXQgZnJvbSB0aGUgRE9NIGVsZW1lbnRcblx0Ki9cblx0dmFyIGdldFN0eWxlID0gZnVuY3Rpb24ob2JqLCBuYW1lKSB7XG5cdFx0aWYgKG9iai5jdXJyZW50U3R5bGUpIHtcblx0XHRcdHJldHVybiBvYmouY3VycmVudFN0eWxlW25hbWVdO1xuXHRcdH0gZWxzZSBpZiAod2luZG93LmdldENvbXB1dGVkU3R5bGUpIHtcblx0XHRcdHJldHVybiB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShvYmosIG51bGwpW25hbWVdO1xuXHRcdH1cblx0fTtcblxuXG5cdC8qKlxuXHRSZXR1cm5zIHRoZSBhYnNvbHV0ZSB4LCB5IHBvc2l0aW9uIG9mIGFuIEVsZW1lbnQuIFRoZSBwb3NpdGlvbiB3aWxsIGJlIHJldHVybmVkIGluIGEgb2JqZWN0IHdpdGggeCwgeSBmaWVsZHMuXG5cblx0QG1ldGhvZCBnZXRQb3Ncblx0QHN0YXRpY1xuXHRAcGFyYW0ge0VsZW1lbnR9IG5vZGUgSFRNTCBlbGVtZW50IG9yIGVsZW1lbnQgaWQgdG8gZ2V0IHgsIHkgcG9zaXRpb24gZnJvbS5cblx0QHBhcmFtIHtFbGVtZW50fSByb290IE9wdGlvbmFsIHJvb3QgZWxlbWVudCB0byBzdG9wIGNhbGN1bGF0aW9ucyBhdC5cblx0QHJldHVybiB7b2JqZWN0fSBBYnNvbHV0ZSBwb3NpdGlvbiBvZiB0aGUgc3BlY2lmaWVkIGVsZW1lbnQgb2JqZWN0IHdpdGggeCwgeSBmaWVsZHMuXG5cdCovXG5cdHZhciBnZXRQb3MgPSBmdW5jdGlvbihub2RlLCByb290KSB7XG5cdFx0dmFyIHggPSAwLCB5ID0gMCwgcGFyZW50LCBkb2MgPSBkb2N1bWVudCwgbm9kZVJlY3QsIHJvb3RSZWN0O1xuXG5cdFx0bm9kZSA9IG5vZGU7XG5cdFx0cm9vdCA9IHJvb3QgfHwgZG9jLmJvZHk7XG5cblx0XHQvLyBSZXR1cm5zIHRoZSB4LCB5IGNvcmRpbmF0ZSBmb3IgYW4gZWxlbWVudCBvbiBJRSA2IGFuZCBJRSA3XG5cdFx0ZnVuY3Rpb24gZ2V0SUVQb3Mobm9kZSkge1xuXHRcdFx0dmFyIGJvZHlFbG0sIHJlY3QsIHggPSAwLCB5ID0gMDtcblxuXHRcdFx0aWYgKG5vZGUpIHtcblx0XHRcdFx0cmVjdCA9IG5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cdFx0XHRcdGJvZHlFbG0gPSBkb2MuY29tcGF0TW9kZSA9PT0gXCJDU1MxQ29tcGF0XCIgPyBkb2MuZG9jdW1lbnRFbGVtZW50IDogZG9jLmJvZHk7XG5cdFx0XHRcdHggPSByZWN0LmxlZnQgKyBib2R5RWxtLnNjcm9sbExlZnQ7XG5cdFx0XHRcdHkgPSByZWN0LnRvcCArIGJvZHlFbG0uc2Nyb2xsVG9wO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHR4IDogeCxcblx0XHRcdFx0eSA6IHlcblx0XHRcdH07XG5cdFx0fVxuXG5cdFx0Ly8gVXNlIGdldEJvdW5kaW5nQ2xpZW50UmVjdCBvbiBJRSA2IGFuZCBJRSA3IGJ1dCBub3Qgb24gSUUgOCBpbiBzdGFuZGFyZHMgbW9kZVxuXHRcdGlmIChub2RlICYmIG5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0ICYmIEVudi5icm93c2VyID09PSAnSUUnICYmICghZG9jLmRvY3VtZW50TW9kZSB8fCBkb2MuZG9jdW1lbnRNb2RlIDwgOCkpIHtcblx0XHRcdG5vZGVSZWN0ID0gZ2V0SUVQb3Mobm9kZSk7XG5cdFx0XHRyb290UmVjdCA9IGdldElFUG9zKHJvb3QpO1xuXG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHR4IDogbm9kZVJlY3QueCAtIHJvb3RSZWN0LngsXG5cdFx0XHRcdHkgOiBub2RlUmVjdC55IC0gcm9vdFJlY3QueVxuXHRcdFx0fTtcblx0XHR9XG5cblx0XHRwYXJlbnQgPSBub2RlO1xuXHRcdHdoaWxlIChwYXJlbnQgJiYgcGFyZW50ICE9IHJvb3QgJiYgcGFyZW50Lm5vZGVUeXBlKSB7XG5cdFx0XHR4ICs9IHBhcmVudC5vZmZzZXRMZWZ0IHx8IDA7XG5cdFx0XHR5ICs9IHBhcmVudC5vZmZzZXRUb3AgfHwgMDtcblx0XHRcdHBhcmVudCA9IHBhcmVudC5vZmZzZXRQYXJlbnQ7XG5cdFx0fVxuXG5cdFx0cGFyZW50ID0gbm9kZS5wYXJlbnROb2RlO1xuXHRcdHdoaWxlIChwYXJlbnQgJiYgcGFyZW50ICE9IHJvb3QgJiYgcGFyZW50Lm5vZGVUeXBlKSB7XG5cdFx0XHR4IC09IHBhcmVudC5zY3JvbGxMZWZ0IHx8IDA7XG5cdFx0XHR5IC09IHBhcmVudC5zY3JvbGxUb3AgfHwgMDtcblx0XHRcdHBhcmVudCA9IHBhcmVudC5wYXJlbnROb2RlO1xuXHRcdH1cblxuXHRcdHJldHVybiB7XG5cdFx0XHR4IDogeCxcblx0XHRcdHkgOiB5XG5cdFx0fTtcblx0fTtcblxuXHQvKipcblx0UmV0dXJucyB0aGUgc2l6ZSBvZiB0aGUgc3BlY2lmaWVkIG5vZGUgaW4gcGl4ZWxzLlxuXG5cdEBtZXRob2QgZ2V0U2l6ZVxuXHRAc3RhdGljXG5cdEBwYXJhbSB7Tm9kZX0gbm9kZSBOb2RlIHRvIGdldCB0aGUgc2l6ZSBvZi5cblx0QHJldHVybiB7T2JqZWN0fSBPYmplY3Qgd2l0aCBhIHcgYW5kIGggcHJvcGVydHkuXG5cdCovXG5cdHZhciBnZXRTaXplID0gZnVuY3Rpb24obm9kZSkge1xuXHRcdHJldHVybiB7XG5cdFx0XHR3IDogbm9kZS5vZmZzZXRXaWR0aCB8fCBub2RlLmNsaWVudFdpZHRoLFxuXHRcdFx0aCA6IG5vZGUub2Zmc2V0SGVpZ2h0IHx8IG5vZGUuY2xpZW50SGVpZ2h0XG5cdFx0fTtcblx0fTtcblxuXHRyZXR1cm4ge1xuXHRcdGdldDogZ2V0LFxuXHRcdGhhc0NsYXNzOiBoYXNDbGFzcyxcblx0XHRhZGRDbGFzczogYWRkQ2xhc3MsXG5cdFx0cmVtb3ZlQ2xhc3M6IHJlbW92ZUNsYXNzLFxuXHRcdGdldFN0eWxlOiBnZXRTdHlsZSxcblx0XHRnZXRQb3M6IGdldFBvcyxcblx0XHRnZXRTaXplOiBnZXRTaXplXG5cdH07XG59KTtcblxuLy8gSW5jbHVkZWQgZnJvbTogc3JjL2phdmFzY3JpcHQvY29yZS9FdmVudFRhcmdldC5qc1xuXG4vKipcbiAqIEV2ZW50VGFyZ2V0LmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG5cbmRlZmluZSgnbW94aWUvY29yZS9FdmVudFRhcmdldCcsIFtcblx0J21veGllL2NvcmUvdXRpbHMvRW52Jyxcblx0J21veGllL2NvcmUvRXhjZXB0aW9ucycsXG5cdCdtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljJ1xuXSwgZnVuY3Rpb24oRW52LCB4LCBCYXNpYykge1xuXG5cdC8vIGhhc2ggb2YgZXZlbnQgbGlzdGVuZXJzIGJ5IG9iamVjdCB1aWRcblx0dmFyIGV2ZW50cG9vbCA9IHt9O1xuXG5cdC8qKlxuXHRQYXJlbnQgb2JqZWN0IGZvciBhbGwgZXZlbnQgZGlzcGF0Y2hpbmcgY29tcG9uZW50cyBhbmQgb2JqZWN0c1xuXG5cdEBjbGFzcyBtb3hpZS9jb3JlL0V2ZW50VGFyZ2V0XG5cdEBjb25zdHJ1Y3RvciBFdmVudFRhcmdldFxuXHQqL1xuXHRmdW5jdGlvbiBFdmVudFRhcmdldCgpIHtcblx0XHQvKipcblx0XHRVbmlxdWUgaWQgb2YgdGhlIGV2ZW50IGRpc3BhdGNoZXIsIHVzdWFsbHkgb3ZlcnJpZGVuIGJ5IGNoaWxkcmVuXG5cblx0XHRAcHJvcGVydHkgdWlkXG5cdFx0QHR5cGUgU3RyaW5nXG5cdFx0Ki9cblx0XHR0aGlzLnVpZCA9IEJhc2ljLmd1aWQoKTtcblx0fVxuXG5cblx0QmFzaWMuZXh0ZW5kKEV2ZW50VGFyZ2V0LnByb3RvdHlwZSwge1xuXG5cdFx0LyoqXG5cdFx0Q2FuIGJlIGNhbGxlZCBmcm9tIHdpdGhpbiBhIGNoaWxkICBpbiBvcmRlciB0byBhY3F1aXJlIHVuaXFpZSBpZCBpbiBhdXRvbWF0ZWQgbWFubmVyXG5cblx0XHRAbWV0aG9kIGluaXRcblx0XHQqL1xuXHRcdGluaXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0aWYgKCF0aGlzLnVpZCkge1xuXHRcdFx0XHR0aGlzLnVpZCA9IEJhc2ljLmd1aWQoJ3VpZF8nKTtcblx0XHRcdH1cblx0XHR9LFxuXG5cdFx0LyoqXG5cdFx0UmVnaXN0ZXIgYSBoYW5kbGVyIHRvIGEgc3BlY2lmaWMgZXZlbnQgZGlzcGF0Y2hlZCBieSB0aGUgb2JqZWN0XG5cblx0XHRAbWV0aG9kIGFkZEV2ZW50TGlzdGVuZXJcblx0XHRAcGFyYW0ge1N0cmluZ30gdHlwZSBUeXBlIG9yIGJhc2ljYWxseSBhIG5hbWUgb2YgdGhlIGV2ZW50IHRvIHN1YnNjcmliZSB0b1xuXHRcdEBwYXJhbSB7RnVuY3Rpb259IGZuIENhbGxiYWNrIGZ1bmN0aW9uIHRoYXQgd2lsbCBiZSBjYWxsZWQgd2hlbiBldmVudCBoYXBwZW5zXG5cdFx0QHBhcmFtIHtOdW1iZXJ9IFtwcmlvcml0eT0wXSBQcmlvcml0eSBvZiB0aGUgZXZlbnQgaGFuZGxlciAtIGhhbmRsZXJzIHdpdGggaGlnaGVyIHByaW9yaXRpZXMgd2lsbCBiZSBjYWxsZWQgZmlyc3Rcblx0XHRAcGFyYW0ge09iamVjdH0gW3Njb3BlPXRoaXNdIEEgc2NvcGUgdG8gaW52b2tlIGV2ZW50IGhhbmRsZXIgaW5cblx0XHQqL1xuXHRcdGFkZEV2ZW50TGlzdGVuZXI6IGZ1bmN0aW9uKHR5cGUsIGZuLCBwcmlvcml0eSwgc2NvcGUpIHtcblx0XHRcdHZhciBzZWxmID0gdGhpcywgbGlzdDtcblxuXHRcdFx0Ly8gd2l0aG91dCB1aWQgbm8gZXZlbnQgaGFuZGxlcnMgY2FuIGJlIGFkZGVkLCBzbyBtYWtlIHN1cmUgd2UgZ290IG9uZVxuXHRcdFx0aWYgKCF0aGlzLmhhc093blByb3BlcnR5KCd1aWQnKSkge1xuXHRcdFx0XHR0aGlzLnVpZCA9IEJhc2ljLmd1aWQoJ3VpZF8nKTtcblx0XHRcdH1cblxuXHRcdFx0dHlwZSA9IEJhc2ljLnRyaW0odHlwZSk7XG5cblx0XHRcdGlmICgvXFxzLy50ZXN0KHR5cGUpKSB7XG5cdFx0XHRcdC8vIG11bHRpcGxlIGV2ZW50IHR5cGVzIHdlcmUgcGFzc2VkIGZvciBvbmUgaGFuZGxlclxuXHRcdFx0XHRCYXNpYy5lYWNoKHR5cGUuc3BsaXQoL1xccysvKSwgZnVuY3Rpb24odHlwZSkge1xuXHRcdFx0XHRcdHNlbGYuYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCBmbiwgcHJpb3JpdHksIHNjb3BlKTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0dHlwZSA9IHR5cGUudG9Mb3dlckNhc2UoKTtcblx0XHRcdHByaW9yaXR5ID0gcGFyc2VJbnQocHJpb3JpdHksIDEwKSB8fCAwO1xuXG5cdFx0XHRsaXN0ID0gZXZlbnRwb29sW3RoaXMudWlkXSAmJiBldmVudHBvb2xbdGhpcy51aWRdW3R5cGVdIHx8IFtdO1xuXHRcdFx0bGlzdC5wdXNoKHtmbiA6IGZuLCBwcmlvcml0eSA6IHByaW9yaXR5LCBzY29wZSA6IHNjb3BlIHx8IHRoaXN9KTtcblxuXHRcdFx0aWYgKCFldmVudHBvb2xbdGhpcy51aWRdKSB7XG5cdFx0XHRcdGV2ZW50cG9vbFt0aGlzLnVpZF0gPSB7fTtcblx0XHRcdH1cblx0XHRcdGV2ZW50cG9vbFt0aGlzLnVpZF1bdHlwZV0gPSBsaXN0O1xuXHRcdH0sXG5cblx0XHQvKipcblx0XHRDaGVjayBpZiBhbnkgaGFuZGxlcnMgd2VyZSByZWdpc3RlcmVkIHRvIHRoZSBzcGVjaWZpZWQgZXZlbnRcblxuXHRcdEBtZXRob2QgaGFzRXZlbnRMaXN0ZW5lclxuXHRcdEBwYXJhbSB7U3RyaW5nfSBbdHlwZV0gVHlwZSBvciBiYXNpY2FsbHkgYSBuYW1lIG9mIHRoZSBldmVudCB0byBjaGVja1xuXHRcdEByZXR1cm4ge01peGVkfSBSZXR1cm5zIGEgaGFuZGxlciBpZiBpdCB3YXMgZm91bmQgYW5kIGZhbHNlLCBpZiAtIG5vdFxuXHRcdCovXG5cdFx0aGFzRXZlbnRMaXN0ZW5lcjogZnVuY3Rpb24odHlwZSkge1xuXHRcdFx0dmFyIGxpc3Q7XG5cdFx0XHRpZiAodHlwZSkge1xuXHRcdFx0XHR0eXBlID0gdHlwZS50b0xvd2VyQ2FzZSgpO1xuXHRcdFx0XHRsaXN0ID0gZXZlbnRwb29sW3RoaXMudWlkXSAmJiBldmVudHBvb2xbdGhpcy51aWRdW3R5cGVdO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0bGlzdCA9IGV2ZW50cG9vbFt0aGlzLnVpZF07XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gbGlzdCA/IGxpc3QgOiBmYWxzZTtcblx0XHR9LFxuXG5cdFx0LyoqXG5cdFx0VW5yZWdpc3RlciB0aGUgaGFuZGxlciBmcm9tIHRoZSBldmVudCwgb3IgaWYgZm9ybWVyIHdhcyBub3Qgc3BlY2lmaWVkIC0gdW5yZWdpc3RlciBhbGwgaGFuZGxlcnNcblxuXHRcdEBtZXRob2QgcmVtb3ZlRXZlbnRMaXN0ZW5lclxuXHRcdEBwYXJhbSB7U3RyaW5nfSB0eXBlIFR5cGUgb3IgYmFzaWNhbGx5IGEgbmFtZSBvZiB0aGUgZXZlbnRcblx0XHRAcGFyYW0ge0Z1bmN0aW9ufSBbZm5dIEhhbmRsZXIgdG8gdW5yZWdpc3RlclxuXHRcdCovXG5cdFx0cmVtb3ZlRXZlbnRMaXN0ZW5lcjogZnVuY3Rpb24odHlwZSwgZm4pIHtcblx0XHRcdHZhciBzZWxmID0gdGhpcywgbGlzdCwgaTtcblxuXHRcdFx0dHlwZSA9IHR5cGUudG9Mb3dlckNhc2UoKTtcblxuXHRcdFx0aWYgKC9cXHMvLnRlc3QodHlwZSkpIHtcblx0XHRcdFx0Ly8gbXVsdGlwbGUgZXZlbnQgdHlwZXMgd2VyZSBwYXNzZWQgZm9yIG9uZSBoYW5kbGVyXG5cdFx0XHRcdEJhc2ljLmVhY2godHlwZS5zcGxpdCgvXFxzKy8pLCBmdW5jdGlvbih0eXBlKSB7XG5cdFx0XHRcdFx0c2VsZi5yZW1vdmVFdmVudExpc3RlbmVyKHR5cGUsIGZuKTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0bGlzdCA9IGV2ZW50cG9vbFt0aGlzLnVpZF0gJiYgZXZlbnRwb29sW3RoaXMudWlkXVt0eXBlXTtcblxuXHRcdFx0aWYgKGxpc3QpIHtcblx0XHRcdFx0aWYgKGZuKSB7XG5cdFx0XHRcdFx0Zm9yIChpID0gbGlzdC5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuXHRcdFx0XHRcdFx0aWYgKGxpc3RbaV0uZm4gPT09IGZuKSB7XG5cdFx0XHRcdFx0XHRcdGxpc3Quc3BsaWNlKGksIDEpO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0bGlzdCA9IFtdO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gZGVsZXRlIGV2ZW50IGxpc3QgaWYgaXQgaGFzIGJlY29tZSBlbXB0eVxuXHRcdFx0XHRpZiAoIWxpc3QubGVuZ3RoKSB7XG5cdFx0XHRcdFx0ZGVsZXRlIGV2ZW50cG9vbFt0aGlzLnVpZF1bdHlwZV07XG5cblx0XHRcdFx0XHQvLyBhbmQgb2JqZWN0IHNwZWNpZmljIGVudHJ5IGluIGEgaGFzaCBpZiBpdCBoYXMgbm8gbW9yZSBsaXN0ZW5lcnMgYXR0YWNoZWRcblx0XHRcdFx0XHRpZiAoQmFzaWMuaXNFbXB0eU9iaihldmVudHBvb2xbdGhpcy51aWRdKSkge1xuXHRcdFx0XHRcdFx0ZGVsZXRlIGV2ZW50cG9vbFt0aGlzLnVpZF07XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSxcblxuXHRcdC8qKlxuXHRcdFJlbW92ZSBhbGwgZXZlbnQgaGFuZGxlcnMgZnJvbSB0aGUgb2JqZWN0XG5cblx0XHRAbWV0aG9kIHJlbW92ZUFsbEV2ZW50TGlzdGVuZXJzXG5cdFx0Ki9cblx0XHRyZW1vdmVBbGxFdmVudExpc3RlbmVyczogZnVuY3Rpb24oKSB7XG5cdFx0XHRpZiAoZXZlbnRwb29sW3RoaXMudWlkXSkge1xuXHRcdFx0XHRkZWxldGUgZXZlbnRwb29sW3RoaXMudWlkXTtcblx0XHRcdH1cblx0XHR9LFxuXG5cdFx0LyoqXG5cdFx0RGlzcGF0Y2ggdGhlIGV2ZW50XG5cblx0XHRAbWV0aG9kIGRpc3BhdGNoRXZlbnRcblx0XHRAcGFyYW0ge1N0cmluZy9PYmplY3R9IFR5cGUgb2YgZXZlbnQgb3IgZXZlbnQgb2JqZWN0IHRvIGRpc3BhdGNoXG5cdFx0QHBhcmFtIHtNaXhlZH0gWy4uLl0gVmFyaWFibGUgbnVtYmVyIG9mIGFyZ3VtZW50cyB0byBiZSBwYXNzZWQgdG8gYSBoYW5kbGVyc1xuXHRcdEByZXR1cm4ge0Jvb2xlYW59IHRydWUgYnkgZGVmYXVsdCBhbmQgZmFsc2UgaWYgYW55IGhhbmRsZXIgcmV0dXJuZWQgZmFsc2Vcblx0XHQqL1xuXHRcdGRpc3BhdGNoRXZlbnQ6IGZ1bmN0aW9uKHR5cGUpIHtcblx0XHRcdHZhciB1aWQsIGxpc3QsIGFyZ3MsIHRtcEV2dCwgZXZ0ID0ge30sIHJlc3VsdCA9IHRydWUsIHVuZGVmO1xuXG5cdFx0XHRpZiAoQmFzaWMudHlwZU9mKHR5cGUpICE9PSAnc3RyaW5nJykge1xuXHRcdFx0XHQvLyB3ZSBjYW4ndCB1c2Ugb3JpZ2luYWwgb2JqZWN0IGRpcmVjdGx5IChiZWNhdXNlIG9mIFNpbHZlcmxpZ2h0KVxuXHRcdFx0XHR0bXBFdnQgPSB0eXBlO1xuXG5cdFx0XHRcdGlmIChCYXNpYy50eXBlT2YodG1wRXZ0LnR5cGUpID09PSAnc3RyaW5nJykge1xuXHRcdFx0XHRcdHR5cGUgPSB0bXBFdnQudHlwZTtcblxuXHRcdFx0XHRcdGlmICh0bXBFdnQudG90YWwgIT09IHVuZGVmICYmIHRtcEV2dC5sb2FkZWQgIT09IHVuZGVmKSB7IC8vIHByb2dyZXNzIGV2ZW50XG5cdFx0XHRcdFx0XHRldnQudG90YWwgPSB0bXBFdnQudG90YWw7XG5cdFx0XHRcdFx0XHRldnQubG9hZGVkID0gdG1wRXZ0LmxvYWRlZDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0ZXZ0LmFzeW5jID0gdG1wRXZ0LmFzeW5jIHx8IGZhbHNlO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHRocm93IG5ldyB4LkV2ZW50RXhjZXB0aW9uKHguRXZlbnRFeGNlcHRpb24uVU5TUEVDSUZJRURfRVZFTlRfVFlQRV9FUlIpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8vIGNoZWNrIGlmIGV2ZW50IGlzIG1lYW50IHRvIGJlIGRpc3BhdGNoZWQgb24gYW4gb2JqZWN0IGhhdmluZyBzcGVjaWZpYyB1aWRcblx0XHRcdGlmICh0eXBlLmluZGV4T2YoJzo6JykgIT09IC0xKSB7XG5cdFx0XHRcdChmdW5jdGlvbihhcnIpIHtcblx0XHRcdFx0XHR1aWQgPSBhcnJbMF07XG5cdFx0XHRcdFx0dHlwZSA9IGFyclsxXTtcblx0XHRcdFx0fSh0eXBlLnNwbGl0KCc6OicpKSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR1aWQgPSB0aGlzLnVpZDtcblx0XHRcdH1cblxuXHRcdFx0dHlwZSA9IHR5cGUudG9Mb3dlckNhc2UoKTtcblxuXHRcdFx0bGlzdCA9IGV2ZW50cG9vbFt1aWRdICYmIGV2ZW50cG9vbFt1aWRdW3R5cGVdO1xuXG5cdFx0XHRpZiAobGlzdCkge1xuXHRcdFx0XHQvLyBzb3J0IGV2ZW50IGxpc3QgYnkgcHJvcml0eVxuXHRcdFx0XHRsaXN0LnNvcnQoZnVuY3Rpb24oYSwgYikgeyByZXR1cm4gYi5wcmlvcml0eSAtIGEucHJpb3JpdHk7IH0pO1xuXG5cdFx0XHRcdGFyZ3MgPSBbXS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7XG5cblx0XHRcdFx0Ly8gZmlyc3QgYXJndW1lbnQgd2lsbCBiZSBwc2V1ZG8tZXZlbnQgb2JqZWN0XG5cdFx0XHRcdGFyZ3Muc2hpZnQoKTtcblx0XHRcdFx0ZXZ0LnR5cGUgPSB0eXBlO1xuXHRcdFx0XHRhcmdzLnVuc2hpZnQoZXZ0KTtcblxuXHRcdFx0XHRpZiAoTVhJX0RFQlVHICYmIEVudi5kZWJ1Zy5ldmVudHMpIHtcblx0XHRcdFx0XHRFbnYubG9nKFwiJWNFdmVudCAnJXMnIGZpcmVkIG9uICVzXCIsICdjb2xvcjogIzk5OTsnLCBldnQudHlwZSwgKHRoaXMuY3Rvck5hbWUgPyB0aGlzLmN0b3JOYW1lICsgJzo6JyA6ICcnKSArIHVpZCk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBEaXNwYXRjaCBldmVudCB0byBhbGwgbGlzdGVuZXJzXG5cdFx0XHRcdHZhciBxdWV1ZSA9IFtdO1xuXHRcdFx0XHRCYXNpYy5lYWNoKGxpc3QsIGZ1bmN0aW9uKGhhbmRsZXIpIHtcblx0XHRcdFx0XHQvLyBleHBsaWNpdGx5IHNldCB0aGUgdGFyZ2V0LCBvdGhlcndpc2UgZXZlbnRzIGZpcmVkIGZyb20gc2hpbXMgZG8gbm90IGdldCBpdFxuXHRcdFx0XHRcdGFyZ3NbMF0udGFyZ2V0ID0gaGFuZGxlci5zY29wZTtcblx0XHRcdFx0XHQvLyBpZiBldmVudCBpcyBtYXJrZWQgYXMgYXN5bmMsIGRldGFjaCB0aGUgaGFuZGxlclxuXHRcdFx0XHRcdGlmIChldnQuYXN5bmMpIHtcblx0XHRcdFx0XHRcdHF1ZXVlLnB1c2goZnVuY3Rpb24oY2IpIHtcblx0XHRcdFx0XHRcdFx0c2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFx0XHRjYihoYW5kbGVyLmZuLmFwcGx5KGhhbmRsZXIuc2NvcGUsIGFyZ3MpID09PSBmYWxzZSk7XG5cdFx0XHRcdFx0XHRcdH0sIDEpO1xuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHF1ZXVlLnB1c2goZnVuY3Rpb24oY2IpIHtcblx0XHRcdFx0XHRcdFx0Y2IoaGFuZGxlci5mbi5hcHBseShoYW5kbGVyLnNjb3BlLCBhcmdzKSA9PT0gZmFsc2UpOyAvLyBpZiBoYW5kbGVyIHJldHVybnMgZmFsc2Ugc3RvcCBwcm9wYWdhdGlvblxuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdFx0aWYgKHF1ZXVlLmxlbmd0aCkge1xuXHRcdFx0XHRcdEJhc2ljLmluU2VyaWVzKHF1ZXVlLCBmdW5jdGlvbihlcnIpIHtcblx0XHRcdFx0XHRcdHJlc3VsdCA9ICFlcnI7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdHJldHVybiByZXN1bHQ7XG5cdFx0fSxcblxuXHRcdC8qKlxuXHRcdFJlZ2lzdGVyIGEgaGFuZGxlciB0byB0aGUgZXZlbnQgdHlwZSB0aGF0IHdpbGwgcnVuIG9ubHkgb25jZVxuXG5cdFx0QG1ldGhvZCBiaW5kT25jZVxuXHRcdEBzaW5jZSA+MS40LjFcblx0XHRAcGFyYW0ge1N0cmluZ30gdHlwZSBUeXBlIG9yIGJhc2ljYWxseSBhIG5hbWUgb2YgdGhlIGV2ZW50IHRvIHN1YnNjcmliZSB0b1xuXHRcdEBwYXJhbSB7RnVuY3Rpb259IGZuIENhbGxiYWNrIGZ1bmN0aW9uIHRoYXQgd2lsbCBiZSBjYWxsZWQgd2hlbiBldmVudCBoYXBwZW5zXG5cdFx0QHBhcmFtIHtOdW1iZXJ9IFtwcmlvcml0eT0wXSBQcmlvcml0eSBvZiB0aGUgZXZlbnQgaGFuZGxlciAtIGhhbmRsZXJzIHdpdGggaGlnaGVyIHByaW9yaXRpZXMgd2lsbCBiZSBjYWxsZWQgZmlyc3Rcblx0XHRAcGFyYW0ge09iamVjdH0gW3Njb3BlPXRoaXNdIEEgc2NvcGUgdG8gaW52b2tlIGV2ZW50IGhhbmRsZXIgaW5cblx0XHQqL1xuXHRcdGJpbmRPbmNlOiBmdW5jdGlvbih0eXBlLCBmbiwgcHJpb3JpdHksIHNjb3BlKSB7XG5cdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cdFx0XHRzZWxmLmJpbmQuY2FsbCh0aGlzLCB0eXBlLCBmdW5jdGlvbiBjYigpIHtcblx0XHRcdFx0c2VsZi51bmJpbmQodHlwZSwgY2IpO1xuXHRcdFx0XHRyZXR1cm4gZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRcdH0sIHByaW9yaXR5LCBzY29wZSk7XG5cdFx0fSxcblxuXHRcdC8qKlxuXHRcdEFsaWFzIGZvciBhZGRFdmVudExpc3RlbmVyXG5cblx0XHRAbWV0aG9kIGJpbmRcblx0XHRAcHJvdGVjdGVkXG5cdFx0Ki9cblx0XHRiaW5kOiBmdW5jdGlvbigpIHtcblx0XHRcdHRoaXMuYWRkRXZlbnRMaXN0ZW5lci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdH0sXG5cblx0XHQvKipcblx0XHRBbGlhcyBmb3IgcmVtb3ZlRXZlbnRMaXN0ZW5lclxuXG5cdFx0QG1ldGhvZCB1bmJpbmRcblx0XHRAcHJvdGVjdGVkXG5cdFx0Ki9cblx0XHR1bmJpbmQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0dGhpcy5yZW1vdmVFdmVudExpc3RlbmVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0fSxcblxuXHRcdC8qKlxuXHRcdEFsaWFzIGZvciByZW1vdmVBbGxFdmVudExpc3RlbmVyc1xuXG5cdFx0QG1ldGhvZCB1bmJpbmRBbGxcblx0XHRAcHJvdGVjdGVkXG5cdFx0Ki9cblx0XHR1bmJpbmRBbGw6IGZ1bmN0aW9uKCkge1xuXHRcdFx0dGhpcy5yZW1vdmVBbGxFdmVudExpc3RlbmVycy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdH0sXG5cblx0XHQvKipcblx0XHRBbGlhcyBmb3IgZGlzcGF0Y2hFdmVudFxuXG5cdFx0QG1ldGhvZCB0cmlnZ2VyXG5cdFx0QHByb3RlY3RlZFxuXHRcdCovXG5cdFx0dHJpZ2dlcjogZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5kaXNwYXRjaEV2ZW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0fSxcblxuXG5cdFx0LyoqXG5cdFx0SGFuZGxlIHByb3BlcnRpZXMgb2Ygb25bZXZlbnRdIHR5cGUuXG5cblx0XHRAbWV0aG9kIGhhbmRsZUV2ZW50UHJvcHNcblx0XHRAcHJpdmF0ZVxuXHRcdCovXG5cdFx0aGFuZGxlRXZlbnRQcm9wczogZnVuY3Rpb24oZGlzcGF0Y2hlcykge1xuXHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXG5cdFx0XHR0aGlzLmJpbmQoZGlzcGF0Y2hlcy5qb2luKCcgJyksIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0dmFyIHByb3AgPSAnb24nICsgZS50eXBlLnRvTG93ZXJDYXNlKCk7XG5cdFx0XHRcdGlmIChCYXNpYy50eXBlT2YodGhpc1twcm9wXSkgPT09ICdmdW5jdGlvbicpIHtcblx0XHRcdFx0XHR0aGlzW3Byb3BdLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHQvLyBvYmplY3QgbXVzdCBoYXZlIGRlZmluZWQgZXZlbnQgcHJvcGVydGllcywgZXZlbiBpZiBpdCBkb2Vzbid0IG1ha2UgdXNlIG9mIHRoZW1cblx0XHRcdEJhc2ljLmVhY2goZGlzcGF0Y2hlcywgZnVuY3Rpb24ocHJvcCkge1xuXHRcdFx0XHRwcm9wID0gJ29uJyArIHByb3AudG9Mb3dlckNhc2UocHJvcCk7XG5cdFx0XHRcdGlmIChCYXNpYy50eXBlT2Yoc2VsZltwcm9wXSkgPT09ICd1bmRlZmluZWQnKSB7XG5cdFx0XHRcdFx0c2VsZltwcm9wXSA9IG51bGw7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH1cblxuXHR9KTtcblxuXG5cdEV2ZW50VGFyZ2V0Lmluc3RhbmNlID0gbmV3IEV2ZW50VGFyZ2V0KCk7XG5cblx0cmV0dXJuIEV2ZW50VGFyZ2V0O1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L3J1bnRpbWUvUnVudGltZS5qc1xuXG4vKipcbiAqIFJ1bnRpbWUuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuZGVmaW5lKCdtb3hpZS9ydW50aW1lL1J1bnRpbWUnLCBbXG5cdFwibW94aWUvY29yZS91dGlscy9FbnZcIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCIsXG5cdFwibW94aWUvY29yZS91dGlscy9Eb21cIixcblx0XCJtb3hpZS9jb3JlL0V2ZW50VGFyZ2V0XCJcbl0sIGZ1bmN0aW9uKEVudiwgQmFzaWMsIERvbSwgRXZlbnRUYXJnZXQpIHtcblx0dmFyIHJ1bnRpbWVDb25zdHJ1Y3RvcnMgPSB7fSwgcnVudGltZXMgPSB7fTtcblxuXHQvKipcblx0Q29tbW9uIHNldCBvZiBtZXRob2RzIGFuZCBwcm9wZXJ0aWVzIGZvciBldmVyeSBydW50aW1lIGluc3RhbmNlXG5cblx0QGNsYXNzIG1veGllL3J1bnRpbWUvUnVudGltZVxuXG5cdEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zXG5cdEBwYXJhbSB7U3RyaW5nfSB0eXBlIFNhbml0aXplZCBuYW1lIG9mIHRoZSBydW50aW1lXG5cdEBwYXJhbSB7T2JqZWN0fSBbY2Fwc10gU2V0IG9mIGNhcGFiaWxpdGllcyB0aGF0IGRpZmZlcmVudGlhdGUgc3BlY2lmaWVkIHJ1bnRpbWVcblx0QHBhcmFtIHtPYmplY3R9IFttb2RlQ2Fwc10gU2V0IG9mIGNhcGFiaWxpdGllcyB0aGF0IGRvIHJlcXVpcmUgc3BlY2lmaWMgb3BlcmF0aW9uYWwgbW9kZVxuXHRAcGFyYW0ge1N0cmluZ30gW3ByZWZlcnJlZE1vZGU9J2Jyb3dzZXInXSBQcmVmZXJyZWQgb3BlcmF0aW9uYWwgbW9kZSB0byBjaG9vc2UgaWYgbm8gcmVxdWlyZWQgY2FwYWJpbGl0aWVzIHdlcmUgcmVxdWVzdGVkXG5cdCovXG5cdGZ1bmN0aW9uIFJ1bnRpbWUob3B0aW9ucywgdHlwZSwgY2FwcywgbW9kZUNhcHMsIHByZWZlcnJlZE1vZGUpIHtcblx0XHQvKipcblx0XHREaXNwYXRjaGVkIHdoZW4gcnVudGltZSBpcyBpbml0aWFsaXplZCBhbmQgcmVhZHkuXG5cdFx0UmVzdWx0cyBpbiBSdW50aW1lSW5pdCBvbiBhIGNvbm5lY3RlZCBjb21wb25lbnQuXG5cblx0XHRAZXZlbnQgSW5pdFxuXHRcdCovXG5cblx0XHQvKipcblx0XHREaXNwYXRjaGVkIHdoZW4gcnVudGltZSBmYWlscyB0byBpbml0aWFsaXplLlxuXHRcdFJlc3VsdHMgaW4gUnVudGltZUVycm9yIG9uIGEgY29ubmVjdGVkIGNvbXBvbmVudC5cblxuXHRcdEBldmVudCBFcnJvclxuXHRcdCovXG5cblx0XHR2YXIgc2VsZiA9IHRoaXNcblx0XHQsIF9zaGltXG5cdFx0LCBfdWlkID0gQmFzaWMuZ3VpZCh0eXBlICsgJ18nKVxuXHRcdCwgZGVmYXVsdE1vZGUgPSBwcmVmZXJyZWRNb2RlIHx8ICdicm93c2VyJ1xuXHRcdDtcblxuXHRcdG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuXG5cdFx0Ly8gcmVnaXN0ZXIgcnVudGltZSBpbiBwcml2YXRlIGhhc2hcblx0XHRydW50aW1lc1tfdWlkXSA9IHRoaXM7XG5cblx0XHQvKipcblx0XHREZWZhdWx0IHNldCBvZiBjYXBhYmlsaXRpZXMsIHdoaWNoIGNhbiBiZSByZWRpZmluZWQgbGF0ZXIgYnkgc3BlY2lmaWMgcnVudGltZVxuXG5cdFx0QHByaXZhdGVcblx0XHRAcHJvcGVydHkgY2Fwc1xuXHRcdEB0eXBlIE9iamVjdFxuXHRcdCovXG5cdFx0Y2FwcyA9IEJhc2ljLmV4dGVuZCh7XG5cdFx0XHQvLyBSdW50aW1lIGNhbjogXG5cdFx0XHQvLyBwcm92aWRlIGFjY2VzcyB0byByYXcgYmluYXJ5IGRhdGEgb2YgdGhlIGZpbGVcblx0XHRcdGFjY2Vzc19iaW5hcnk6IGZhbHNlLFxuXHRcdFx0Ly8gcHJvdmlkZSBhY2Nlc3MgdG8gcmF3IGJpbmFyeSBkYXRhIG9mIHRoZSBpbWFnZSAoaW1hZ2UgZXh0ZW5zaW9uIGlzIG9wdGlvbmFsKSBcblx0XHRcdGFjY2Vzc19pbWFnZV9iaW5hcnk6IGZhbHNlLFxuXHRcdFx0Ly8gZGlzcGxheSBiaW5hcnkgZGF0YSBhcyB0aHVtYnMgZm9yIGV4YW1wbGVcblx0XHRcdGRpc3BsYXlfbWVkaWE6IGZhbHNlLFxuXHRcdFx0Ly8gbWFrZSBjcm9zcy1kb21haW4gcmVxdWVzdHNcblx0XHRcdGRvX2NvcnM6IGZhbHNlLFxuXHRcdFx0Ly8gYWNjZXB0IGZpbGVzIGRyYWdnZWQgYW5kIGRyb3BwZWQgZnJvbSB0aGUgZGVza3RvcFxuXHRcdFx0ZHJhZ19hbmRfZHJvcDogZmFsc2UsXG5cdFx0XHQvLyBmaWx0ZXIgZmlsZXMgaW4gc2VsZWN0aW9uIGRpYWxvZyBieSB0aGVpciBleHRlbnNpb25zXG5cdFx0XHRmaWx0ZXJfYnlfZXh0ZW5zaW9uOiB0cnVlLFxuXHRcdFx0Ly8gcmVzaXplIGltYWdlIChhbmQgbWFuaXB1bGF0ZSBpdCByYXcgZGF0YSBvZiBhbnkgZmlsZSBpbiBnZW5lcmFsKVxuXHRcdFx0cmVzaXplX2ltYWdlOiBmYWxzZSxcblx0XHRcdC8vIHBlcmlvZGljYWxseSByZXBvcnQgaG93IG1hbnkgYnl0ZXMgb2YgdG90YWwgaW4gdGhlIGZpbGUgd2VyZSB1cGxvYWRlZCAobG9hZGVkKVxuXHRcdFx0cmVwb3J0X3VwbG9hZF9wcm9ncmVzczogZmFsc2UsXG5cdFx0XHQvLyBwcm92aWRlIGFjY2VzcyB0byB0aGUgaGVhZGVycyBvZiBodHRwIHJlc3BvbnNlIFxuXHRcdFx0cmV0dXJuX3Jlc3BvbnNlX2hlYWRlcnM6IGZhbHNlLFxuXHRcdFx0Ly8gc3VwcG9ydCByZXNwb25zZSBvZiBzcGVjaWZpYyB0eXBlLCB3aGljaCBzaG91bGQgYmUgcGFzc2VkIGFzIGFuIGFyZ3VtZW50XG5cdFx0XHQvLyBlLmcuIHJ1bnRpbWUuY2FuKCdyZXR1cm5fcmVzcG9uc2VfdHlwZScsICdibG9iJylcblx0XHRcdHJldHVybl9yZXNwb25zZV90eXBlOiBmYWxzZSxcblx0XHRcdC8vIHJldHVybiBodHRwIHN0YXR1cyBjb2RlIG9mIHRoZSByZXNwb25zZVxuXHRcdFx0cmV0dXJuX3N0YXR1c19jb2RlOiB0cnVlLFxuXHRcdFx0Ly8gc2VuZCBjdXN0b20gaHR0cCBoZWFkZXIgd2l0aCB0aGUgcmVxdWVzdFxuXHRcdFx0c2VuZF9jdXN0b21faGVhZGVyczogZmFsc2UsXG5cdFx0XHQvLyBwaWNrIHVwIHRoZSBmaWxlcyBmcm9tIGEgZGlhbG9nXG5cdFx0XHRzZWxlY3RfZmlsZTogZmFsc2UsXG5cdFx0XHQvLyBzZWxlY3Qgd2hvbGUgZm9sZGVyIGluIGZpbGUgYnJvd3NlIGRpYWxvZ1xuXHRcdFx0c2VsZWN0X2ZvbGRlcjogZmFsc2UsXG5cdFx0XHQvLyBzZWxlY3QgbXVsdGlwbGUgZmlsZXMgYXQgb25jZSBpbiBmaWxlIGJyb3dzZSBkaWFsb2dcblx0XHRcdHNlbGVjdF9tdWx0aXBsZTogdHJ1ZSxcblx0XHRcdC8vIHNlbmQgcmF3IGJpbmFyeSBkYXRhLCB0aGF0IGlzIGdlbmVyYXRlZCBhZnRlciBpbWFnZSByZXNpemluZyBvciBtYW5pcHVsYXRpb24gb2Ygb3RoZXIga2luZFxuXHRcdFx0c2VuZF9iaW5hcnlfc3RyaW5nOiBmYWxzZSxcblx0XHRcdC8vIHNlbmQgY29va2llcyB3aXRoIGh0dHAgcmVxdWVzdCBhbmQgdGhlcmVmb3JlIHJldGFpbiBzZXNzaW9uXG5cdFx0XHRzZW5kX2Jyb3dzZXJfY29va2llczogdHJ1ZSxcblx0XHRcdC8vIHNlbmQgZGF0YSBmb3JtYXR0ZWQgYXMgbXVsdGlwYXJ0L2Zvcm0tZGF0YVxuXHRcdFx0c2VuZF9tdWx0aXBhcnQ6IHRydWUsXG5cdFx0XHQvLyBzbGljZSB0aGUgZmlsZSBvciBibG9iIHRvIHNtYWxsZXIgcGFydHNcblx0XHRcdHNsaWNlX2Jsb2I6IGZhbHNlLFxuXHRcdFx0Ly8gdXBsb2FkIGZpbGUgd2l0aG91dCBwcmVsb2FkaW5nIGl0IHRvIG1lbW9yeSwgc3RyZWFtIGl0IG91dCBkaXJlY3RseSBmcm9tIGRpc2tcblx0XHRcdHN0cmVhbV91cGxvYWQ6IGZhbHNlLFxuXHRcdFx0Ly8gcHJvZ3JhbW1hdGljYWxseSB0cmlnZ2VyIGZpbGUgYnJvd3NlIGRpYWxvZ1xuXHRcdFx0c3VtbW9uX2ZpbGVfZGlhbG9nOiBmYWxzZSxcblx0XHRcdC8vIHVwbG9hZCBmaWxlIG9mIHNwZWNpZmljIHNpemUsIHNpemUgc2hvdWxkIGJlIHBhc3NlZCBhcyBhcmd1bWVudFxuXHRcdFx0Ly8gZS5nLiBydW50aW1lLmNhbigndXBsb2FkX2ZpbGVzaXplJywgJzUwMG1iJylcblx0XHRcdHVwbG9hZF9maWxlc2l6ZTogdHJ1ZSxcblx0XHRcdC8vIGluaXRpYXRlIGh0dHAgcmVxdWVzdCB3aXRoIHNwZWNpZmljIGh0dHAgbWV0aG9kLCBtZXRob2Qgc2hvdWxkIGJlIHBhc3NlZCBhcyBhcmd1bWVudFxuXHRcdFx0Ly8gZS5nLiBydW50aW1lLmNhbigndXNlX2h0dHBfbWV0aG9kJywgJ3B1dCcpXG5cdFx0XHR1c2VfaHR0cF9tZXRob2Q6IHRydWVcblx0XHR9LCBjYXBzKTtcblx0XHRcdFxuXHRcblx0XHQvLyBkZWZhdWx0IHRvIHRoZSBtb2RlIHRoYXQgaXMgY29tcGF0aWJsZSB3aXRoIHByZWZlcnJlZCBjYXBzXG5cdFx0aWYgKG9wdGlvbnMucHJlZmVycmVkX2NhcHMpIHtcblx0XHRcdGRlZmF1bHRNb2RlID0gUnVudGltZS5nZXRNb2RlKG1vZGVDYXBzLCBvcHRpb25zLnByZWZlcnJlZF9jYXBzLCBkZWZhdWx0TW9kZSk7XG5cdFx0fVxuXG5cdFx0aWYgKE1YSV9ERUJVRyAmJiBFbnYuZGVidWcucnVudGltZSkge1xuXHRcdFx0RW52LmxvZyhcIlxcdGRlZmF1bHQgbW9kZTogJXNcIiwgZGVmYXVsdE1vZGUpO1x0XG5cdFx0fVxuXHRcdFxuXHRcdC8vIHNtYWxsIGV4dGVuc2lvbiBmYWN0b3J5IGhlcmUgKGlzIG1lYW50IHRvIGJlIGV4dGVuZGVkIHdpdGggYWN0dWFsIGV4dGVuc2lvbnMgY29uc3RydWN0b3JzKVxuXHRcdF9zaGltID0gKGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIG9ianBvb2wgPSB7fTtcblx0XHRcdHJldHVybiB7XG5cdFx0XHRcdGV4ZWM6IGZ1bmN0aW9uKHVpZCwgY29tcCwgZm4sIGFyZ3MpIHtcblx0XHRcdFx0XHRpZiAoX3NoaW1bY29tcF0pIHtcblx0XHRcdFx0XHRcdGlmICghb2JqcG9vbFt1aWRdKSB7XG5cdFx0XHRcdFx0XHRcdG9ianBvb2xbdWlkXSA9IHtcblx0XHRcdFx0XHRcdFx0XHRjb250ZXh0OiB0aGlzLFxuXHRcdFx0XHRcdFx0XHRcdGluc3RhbmNlOiBuZXcgX3NoaW1bY29tcF0oKVxuXHRcdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0aWYgKG9ianBvb2xbdWlkXS5pbnN0YW5jZVtmbl0pIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIG9ianBvb2xbdWlkXS5pbnN0YW5jZVtmbl0uYXBwbHkodGhpcywgYXJncyk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9LFxuXG5cdFx0XHRcdHJlbW92ZUluc3RhbmNlOiBmdW5jdGlvbih1aWQpIHtcblx0XHRcdFx0XHRkZWxldGUgb2JqcG9vbFt1aWRdO1xuXHRcdFx0XHR9LFxuXG5cdFx0XHRcdHJlbW92ZUFsbEluc3RhbmNlczogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdFx0XHRcdEJhc2ljLmVhY2gob2JqcG9vbCwgZnVuY3Rpb24ob2JqLCB1aWQpIHtcblx0XHRcdFx0XHRcdGlmIChCYXNpYy50eXBlT2Yob2JqLmluc3RhbmNlLmRlc3Ryb3kpID09PSAnZnVuY3Rpb24nKSB7XG5cdFx0XHRcdFx0XHRcdG9iai5pbnN0YW5jZS5kZXN0cm95LmNhbGwob2JqLmNvbnRleHQpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0c2VsZi5yZW1vdmVJbnN0YW5jZSh1aWQpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9O1xuXHRcdH0oKSk7XG5cblxuXHRcdC8vIHB1YmxpYyBtZXRob2RzXG5cdFx0QmFzaWMuZXh0ZW5kKHRoaXMsIHtcblx0XHRcdC8qKlxuXHRcdFx0U3BlY2lmaWVzIHdoZXRoZXIgcnVudGltZSBpbnN0YW5jZSB3YXMgaW5pdGlhbGl6ZWQgb3Igbm90XG5cblx0XHRcdEBwcm9wZXJ0eSBpbml0aWFsaXplZFxuXHRcdFx0QHR5cGUge0Jvb2xlYW59XG5cdFx0XHRAZGVmYXVsdCBmYWxzZVxuXHRcdFx0Ki9cblx0XHRcdGluaXRpYWxpemVkOiBmYWxzZSwgLy8gc2hpbXMgcmVxdWlyZSB0aGlzIGZsYWcgdG8gc3RvcCBpbml0aWFsaXphdGlvbiByZXRyaWVzXG5cblx0XHRcdC8qKlxuXHRcdFx0VW5pcXVlIElEIG9mIHRoZSBydW50aW1lXG5cblx0XHRcdEBwcm9wZXJ0eSB1aWRcblx0XHRcdEB0eXBlIHtTdHJpbmd9XG5cdFx0XHQqL1xuXHRcdFx0dWlkOiBfdWlkLFxuXG5cdFx0XHQvKipcblx0XHRcdFJ1bnRpbWUgdHlwZSAoZS5nLiBmbGFzaCwgaHRtbDUsIGV0YylcblxuXHRcdFx0QHByb3BlcnR5IHR5cGVcblx0XHRcdEB0eXBlIHtTdHJpbmd9XG5cdFx0XHQqL1xuXHRcdFx0dHlwZTogdHlwZSxcblxuXHRcdFx0LyoqXG5cdFx0XHRSdW50aW1lIChub3QgbmF0aXZlIG9uZSkgbWF5IG9wZXJhdGUgaW4gYnJvd3NlciBvciBjbGllbnQgbW9kZS5cblxuXHRcdFx0QHByb3BlcnR5IG1vZGVcblx0XHRcdEBwcml2YXRlXG5cdFx0XHRAdHlwZSB7U3RyaW5nfEJvb2xlYW59IGN1cnJlbnQgbW9kZSBvciBmYWxzZSwgaWYgbm9uZSBwb3NzaWJsZVxuXHRcdFx0Ki9cblx0XHRcdG1vZGU6IFJ1bnRpbWUuZ2V0TW9kZShtb2RlQ2FwcywgKG9wdGlvbnMucmVxdWlyZWRfY2FwcyksIGRlZmF1bHRNb2RlKSxcblxuXHRcdFx0LyoqXG5cdFx0XHRpZCBvZiB0aGUgRE9NIGNvbnRhaW5lciBmb3IgdGhlIHJ1bnRpbWUgKGlmIGF2YWlsYWJsZSlcblxuXHRcdFx0QHByb3BlcnR5IHNoaW1pZFxuXHRcdFx0QHR5cGUge1N0cmluZ31cblx0XHRcdCovXG5cdFx0XHRzaGltaWQ6IF91aWQgKyAnX2NvbnRhaW5lcicsXG5cblx0XHRcdC8qKlxuXHRcdFx0TnVtYmVyIG9mIGNvbm5lY3RlZCBjbGllbnRzLiBJZiBlcXVhbCB0byB6ZXJvLCBydW50aW1lIGNhbiBiZSBkZXN0cm95ZWRcblxuXHRcdFx0QHByb3BlcnR5IGNsaWVudHNcblx0XHRcdEB0eXBlIHtOdW1iZXJ9XG5cdFx0XHQqL1xuXHRcdFx0Y2xpZW50czogMCxcblxuXHRcdFx0LyoqXG5cdFx0XHRSdW50aW1lIGluaXRpYWxpemF0aW9uIG9wdGlvbnNcblxuXHRcdFx0QHByb3BlcnR5IG9wdGlvbnNcblx0XHRcdEB0eXBlIHtPYmplY3R9XG5cdFx0XHQqL1xuXHRcdFx0b3B0aW9uczogb3B0aW9ucyxcblxuXHRcdFx0LyoqXG5cdFx0XHRDaGVja3MgaWYgdGhlIHJ1bnRpbWUgaGFzIHNwZWNpZmljIGNhcGFiaWxpdHlcblxuXHRcdFx0QG1ldGhvZCBjYW5cblx0XHRcdEBwYXJhbSB7U3RyaW5nfSBjYXAgTmFtZSBvZiBjYXBhYmlsaXR5IHRvIGNoZWNrXG5cdFx0XHRAcGFyYW0ge01peGVkfSBbdmFsdWVdIElmIHBhc3NlZCwgY2FwYWJpbGl0eSBzaG91bGQgc29tZWhvdyBjb3JyZWxhdGUgdG8gdGhlIHZhbHVlXG5cdFx0XHRAcGFyYW0ge09iamVjdH0gW3JlZkNhcHNdIFNldCBvZiBjYXBhYmlsaXRpZXMgdG8gY2hlY2sgdGhlIHNwZWNpZmllZCBjYXAgYWdhaW5zdCAoZGVmYXVsdHMgdG8gaW50ZXJuYWwgc2V0KVxuXHRcdFx0QHJldHVybiB7Qm9vbGVhbn0gdHJ1ZSBpZiBydW50aW1lIGhhcyBzdWNoIGNhcGFiaWxpdHkgYW5kIGZhbHNlLCBpZiAtIG5vdFxuXHRcdFx0Ki9cblx0XHRcdGNhbjogZnVuY3Rpb24oY2FwLCB2YWx1ZSkge1xuXHRcdFx0XHR2YXIgcmVmQ2FwcyA9IGFyZ3VtZW50c1syXSB8fCBjYXBzO1xuXG5cdFx0XHRcdC8vIGlmIGNhcCB2YXIgaXMgYSBjb21tYS1zZXBhcmF0ZWQgbGlzdCBvZiBjYXBzLCBjb252ZXJ0IGl0IHRvIG9iamVjdCAoa2V5L3ZhbHVlKVxuXHRcdFx0XHRpZiAoQmFzaWMudHlwZU9mKGNhcCkgPT09ICdzdHJpbmcnICYmIEJhc2ljLnR5cGVPZih2YWx1ZSkgPT09ICd1bmRlZmluZWQnKSB7XG5cdFx0XHRcdFx0Y2FwID0gUnVudGltZS5wYXJzZUNhcHMoY2FwKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmIChCYXNpYy50eXBlT2YoY2FwKSA9PT0gJ29iamVjdCcpIHtcblx0XHRcdFx0XHRmb3IgKHZhciBrZXkgaW4gY2FwKSB7XG5cdFx0XHRcdFx0XHRpZiAoIXRoaXMuY2FuKGtleSwgY2FwW2tleV0sIHJlZkNhcHMpKSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBjaGVjayB0aGUgaW5kaXZpZHVhbCBjYXBcblx0XHRcdFx0aWYgKEJhc2ljLnR5cGVPZihyZWZDYXBzW2NhcF0pID09PSAnZnVuY3Rpb24nKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHJlZkNhcHNbY2FwXS5jYWxsKHRoaXMsIHZhbHVlKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRyZXR1cm4gKHZhbHVlID09PSByZWZDYXBzW2NhcF0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXG5cdFx0XHQvKipcblx0XHRcdFJldHVybnMgY29udGFpbmVyIGZvciB0aGUgcnVudGltZSBhcyBET00gZWxlbWVudFxuXG5cdFx0XHRAbWV0aG9kIGdldFNoaW1Db250YWluZXJcblx0XHRcdEByZXR1cm4ge0RPTUVsZW1lbnR9XG5cdFx0XHQqL1xuXHRcdFx0Z2V0U2hpbUNvbnRhaW5lcjogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciBjb250YWluZXIsIHNoaW1Db250YWluZXIgPSBEb20uZ2V0KHRoaXMuc2hpbWlkKTtcblxuXHRcdFx0XHQvLyBpZiBubyBjb250YWluZXIgZm9yIHNoaW0sIGNyZWF0ZSBvbmVcblx0XHRcdFx0aWYgKCFzaGltQ29udGFpbmVyKSB7XG5cdFx0XHRcdFx0Y29udGFpbmVyID0gRG9tLmdldCh0aGlzLm9wdGlvbnMuY29udGFpbmVyKSB8fCBkb2N1bWVudC5ib2R5O1xuXG5cdFx0XHRcdFx0Ly8gY3JlYXRlIHNoaW0gY29udGFpbmVyIGFuZCBpbnNlcnQgaXQgYXQgYW4gYWJzb2x1dGUgcG9zaXRpb24gaW50byB0aGUgb3V0ZXIgY29udGFpbmVyXG5cdFx0XHRcdFx0c2hpbUNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXHRcdFx0XHRcdHNoaW1Db250YWluZXIuaWQgPSB0aGlzLnNoaW1pZDtcblx0XHRcdFx0XHRzaGltQ29udGFpbmVyLmNsYXNzTmFtZSA9ICdtb3hpZS1zaGltIG1veGllLXNoaW0tJyArIHRoaXMudHlwZTtcblxuXHRcdFx0XHRcdEJhc2ljLmV4dGVuZChzaGltQ29udGFpbmVyLnN0eWxlLCB7XG5cdFx0XHRcdFx0XHRwb3NpdGlvbjogJ2Fic29sdXRlJyxcblx0XHRcdFx0XHRcdHRvcDogJzBweCcsXG5cdFx0XHRcdFx0XHRsZWZ0OiAnMHB4Jyxcblx0XHRcdFx0XHRcdHdpZHRoOiAnMXB4Jyxcblx0XHRcdFx0XHRcdGhlaWdodDogJzFweCcsXG5cdFx0XHRcdFx0XHRvdmVyZmxvdzogJ2hpZGRlbidcblx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHRcdGNvbnRhaW5lci5hcHBlbmRDaGlsZChzaGltQ29udGFpbmVyKTtcblx0XHRcdFx0XHRjb250YWluZXIgPSBudWxsO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0cmV0dXJuIHNoaW1Db250YWluZXI7XG5cdFx0XHR9LFxuXG5cdFx0XHQvKipcblx0XHRcdFJldHVybnMgcnVudGltZSBhcyBET00gZWxlbWVudCAoaWYgYXBwcm9wcmlhdGUpXG5cblx0XHRcdEBtZXRob2QgZ2V0U2hpbVxuXHRcdFx0QHJldHVybiB7RE9NRWxlbWVudH1cblx0XHRcdCovXG5cdFx0XHRnZXRTaGltOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIF9zaGltO1xuXHRcdFx0fSxcblxuXHRcdFx0LyoqXG5cdFx0XHRJbnZva2VzIGEgbWV0aG9kIHdpdGhpbiB0aGUgcnVudGltZSBpdHNlbGYgKG1pZ2h0IGRpZmZlciBhY3Jvc3MgdGhlIHJ1bnRpbWVzKVxuXG5cdFx0XHRAbWV0aG9kIHNoaW1FeGVjXG5cdFx0XHRAcGFyYW0ge01peGVkfSBbXVxuXHRcdFx0QHByb3RlY3RlZFxuXHRcdFx0QHJldHVybiB7TWl4ZWR9IERlcGVuZHMgb24gdGhlIGFjdGlvbiBhbmQgY29tcG9uZW50XG5cdFx0XHQqL1xuXHRcdFx0c2hpbUV4ZWM6IGZ1bmN0aW9uKGNvbXBvbmVudCwgYWN0aW9uKSB7XG5cdFx0XHRcdHZhciBhcmdzID0gW10uc2xpY2UuY2FsbChhcmd1bWVudHMsIDIpO1xuXHRcdFx0XHRyZXR1cm4gc2VsZi5nZXRTaGltKCkuZXhlYy5jYWxsKHRoaXMsIHRoaXMudWlkLCBjb21wb25lbnQsIGFjdGlvbiwgYXJncyk7XG5cdFx0XHR9LFxuXG5cdFx0XHQvKipcblx0XHRcdE9wZXJhaW9uYWwgaW50ZXJmYWNlIHRoYXQgaXMgdXNlZCBieSBjb21wb25lbnRzIHRvIGludm9rZSBzcGVjaWZpYyBhY3Rpb25zIG9uIHRoZSBydW50aW1lXG5cdFx0XHQoaXMgaW52b2tlZCBpbiB0aGUgc2NvcGUgb2YgY29tcG9uZW50KVxuXG5cdFx0XHRAbWV0aG9kIGV4ZWNcblx0XHRcdEBwYXJhbSB7TWl4ZWR9IFtdKlxuXHRcdFx0QHByb3RlY3RlZFxuXHRcdFx0QHJldHVybiB7TWl4ZWR9IERlcGVuZHMgb24gdGhlIGFjdGlvbiBhbmQgY29tcG9uZW50XG5cdFx0XHQqL1xuXHRcdFx0ZXhlYzogZnVuY3Rpb24oY29tcG9uZW50LCBhY3Rpb24pIHsgLy8gdGhpcyBpcyBjYWxsZWQgaW4gdGhlIGNvbnRleHQgb2YgY29tcG9uZW50LCBub3QgcnVudGltZVxuXHRcdFx0XHR2YXIgYXJncyA9IFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAyKTtcblxuXHRcdFx0XHRpZiAoc2VsZltjb21wb25lbnRdICYmIHNlbGZbY29tcG9uZW50XVthY3Rpb25dKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHNlbGZbY29tcG9uZW50XVthY3Rpb25dLmFwcGx5KHRoaXMsIGFyZ3MpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiBzZWxmLnNoaW1FeGVjLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0XHR9LFxuXG5cdFx0XHQvKipcblx0XHRcdERlc3Ryb3lzIHRoZSBydW50aW1lIChyZW1vdmVzIGFsbCBldmVudHMgYW5kIGRlbGV0ZXMgRE9NIHN0cnVjdHVyZXMpXG5cblx0XHRcdEBtZXRob2QgZGVzdHJveVxuXHRcdFx0Ki9cblx0XHRcdGRlc3Ryb3k6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRpZiAoIXNlbGYpIHtcblx0XHRcdFx0XHRyZXR1cm47IC8vIG9idmlvdXNseSBhbHJlYWR5IGRlc3Ryb3llZFxuXHRcdFx0XHR9XG5cblx0XHRcdFx0dmFyIHNoaW1Db250YWluZXIgPSBEb20uZ2V0KHRoaXMuc2hpbWlkKTtcblx0XHRcdFx0aWYgKHNoaW1Db250YWluZXIpIHtcblx0XHRcdFx0XHRzaGltQ29udGFpbmVyLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoc2hpbUNvbnRhaW5lcik7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoX3NoaW0pIHtcblx0XHRcdFx0XHRfc2hpbS5yZW1vdmVBbGxJbnN0YW5jZXMoKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHRoaXMudW5iaW5kQWxsKCk7XG5cdFx0XHRcdGRlbGV0ZSBydW50aW1lc1t0aGlzLnVpZF07XG5cdFx0XHRcdHRoaXMudWlkID0gbnVsbDsgLy8gbWFyayB0aGlzIHJ1bnRpbWUgYXMgZGVzdHJveWVkXG5cdFx0XHRcdF91aWQgPSBzZWxmID0gX3NoaW0gPSBzaGltQ29udGFpbmVyID0gbnVsbDtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdC8vIG9uY2Ugd2UgZ290IHRoZSBtb2RlLCB0ZXN0IGFnYWluc3QgYWxsIGNhcHNcblx0XHRpZiAodGhpcy5tb2RlICYmIG9wdGlvbnMucmVxdWlyZWRfY2FwcyAmJiAhdGhpcy5jYW4ob3B0aW9ucy5yZXF1aXJlZF9jYXBzKSkge1xuXHRcdFx0dGhpcy5tb2RlID0gZmFsc2U7XG5cdFx0fVx0XG5cdH1cblxuXG5cdC8qKlxuXHREZWZhdWx0IG9yZGVyIHRvIHRyeSBkaWZmZXJlbnQgcnVudGltZSB0eXBlc1xuXG5cdEBwcm9wZXJ0eSBvcmRlclxuXHRAdHlwZSBTdHJpbmdcblx0QHN0YXRpY1xuXHQqL1xuXHRSdW50aW1lLm9yZGVyID0gJ2h0bWw1LGZsYXNoLHNpbHZlcmxpZ2h0LGh0bWw0JztcblxuXG5cdC8qKlxuXHRSZXRyaWV2ZXMgcnVudGltZSBmcm9tIHByaXZhdGUgaGFzaCBieSBpdCdzIHVpZFxuXG5cdEBtZXRob2QgZ2V0UnVudGltZVxuXHRAcHJpdmF0ZVxuXHRAc3RhdGljXG5cdEBwYXJhbSB7U3RyaW5nfSB1aWQgVW5pcXVlIGlkZW50aWZpZXIgb2YgdGhlIHJ1bnRpbWVcblx0QHJldHVybiB7UnVudGltZXxCb29sZWFufSBSZXR1cm5zIHJ1bnRpbWUsIGlmIGl0IGV4aXN0cyBhbmQgZmFsc2UsIGlmIC0gbm90XG5cdCovXG5cdFJ1bnRpbWUuZ2V0UnVudGltZSA9IGZ1bmN0aW9uKHVpZCkge1xuXHRcdHJldHVybiBydW50aW1lc1t1aWRdID8gcnVudGltZXNbdWlkXSA6IGZhbHNlO1xuXHR9O1xuXG5cblx0LyoqXG5cdFJlZ2lzdGVyIGNvbnN0cnVjdG9yIGZvciB0aGUgUnVudGltZSBvZiBuZXcgKG9yIHBlcmhhcHMgbW9kaWZpZWQpIHR5cGVcblxuXHRAbWV0aG9kIGFkZENvbnN0cnVjdG9yXG5cdEBzdGF0aWNcblx0QHBhcmFtIHtTdHJpbmd9IHR5cGUgUnVudGltZSB0eXBlIChlLmcuIGZsYXNoLCBodG1sNSwgZXRjKVxuXHRAcGFyYW0ge0Z1bmN0aW9ufSBjb25zdHJ1Y3QgQ29uc3RydWN0b3IgZm9yIHRoZSBSdW50aW1lIHR5cGVcblx0Ki9cblx0UnVudGltZS5hZGRDb25zdHJ1Y3RvciA9IGZ1bmN0aW9uKHR5cGUsIGNvbnN0cnVjdG9yKSB7XG5cdFx0Y29uc3RydWN0b3IucHJvdG90eXBlID0gRXZlbnRUYXJnZXQuaW5zdGFuY2U7XG5cdFx0cnVudGltZUNvbnN0cnVjdG9yc1t0eXBlXSA9IGNvbnN0cnVjdG9yO1xuXHR9O1xuXG5cblx0LyoqXG5cdEdldCB0aGUgY29uc3RydWN0b3IgZm9yIHRoZSBzcGVjaWZpZWQgdHlwZS5cblxuXHRtZXRob2QgZ2V0Q29uc3RydWN0b3Jcblx0QHN0YXRpY1xuXHRAcGFyYW0ge1N0cmluZ30gdHlwZSBSdW50aW1lIHR5cGUgKGUuZy4gZmxhc2gsIGh0bWw1LCBldGMpXG5cdEByZXR1cm4ge0Z1bmN0aW9ufSBDb25zdHJ1Y3RvciBmb3IgdGhlIFJ1bnRpbWUgdHlwZVxuXHQqL1xuXHRSdW50aW1lLmdldENvbnN0cnVjdG9yID0gZnVuY3Rpb24odHlwZSkge1xuXHRcdHJldHVybiBydW50aW1lQ29uc3RydWN0b3JzW3R5cGVdIHx8IG51bGw7XG5cdH07XG5cblxuXHQvKipcblx0R2V0IGluZm8gYWJvdXQgdGhlIHJ1bnRpbWUgKHVpZCwgdHlwZSwgY2FwYWJpbGl0aWVzKVxuXG5cdEBtZXRob2QgZ2V0SW5mb1xuXHRAc3RhdGljXG5cdEBwYXJhbSB7U3RyaW5nfSB1aWQgVW5pcXVlIGlkZW50aWZpZXIgb2YgdGhlIHJ1bnRpbWVcblx0QHJldHVybiB7TWl4ZWR9IEluZm8gb2JqZWN0IG9yIG51bGwgaWYgcnVudGltZSBkb2Vzbid0IGV4aXN0XG5cdCovXG5cdFJ1bnRpbWUuZ2V0SW5mbyA9IGZ1bmN0aW9uKHVpZCkge1xuXHRcdHZhciBydW50aW1lID0gUnVudGltZS5nZXRSdW50aW1lKHVpZCk7XG5cblx0XHRpZiAocnVudGltZSkge1xuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0dWlkOiBydW50aW1lLnVpZCxcblx0XHRcdFx0dHlwZTogcnVudGltZS50eXBlLFxuXHRcdFx0XHRtb2RlOiBydW50aW1lLm1vZGUsXG5cdFx0XHRcdGNhbjogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHJ1bnRpbWUuY2FuLmFwcGx5KHJ1bnRpbWUsIGFyZ3VtZW50cyk7XG5cdFx0XHRcdH1cblx0XHRcdH07XG5cdFx0fVxuXHRcdHJldHVybiBudWxsO1xuXHR9O1xuXG5cblx0LyoqXG5cdENvbnZlcnQgY2FwcyByZXByZXNlbnRlZCBieSBhIGNvbW1hLXNlcGFyYXRlZCBzdHJpbmcgdG8gdGhlIG9iamVjdCByZXByZXNlbnRhdGlvbi5cblxuXHRAbWV0aG9kIHBhcnNlQ2Fwc1xuXHRAc3RhdGljXG5cdEBwYXJhbSB7U3RyaW5nfSBjYXBTdHIgQ29tbWEtc2VwYXJhdGVkIGxpc3Qgb2YgY2FwYWJpbGl0aWVzXG5cdEByZXR1cm4ge09iamVjdH1cblx0Ki9cblx0UnVudGltZS5wYXJzZUNhcHMgPSBmdW5jdGlvbihjYXBTdHIpIHtcblx0XHR2YXIgY2FwT2JqID0ge307XG5cblx0XHRpZiAoQmFzaWMudHlwZU9mKGNhcFN0cikgIT09ICdzdHJpbmcnKSB7XG5cdFx0XHRyZXR1cm4gY2FwU3RyIHx8IHt9O1xuXHRcdH1cblxuXHRcdEJhc2ljLmVhY2goY2FwU3RyLnNwbGl0KCcsJyksIGZ1bmN0aW9uKGtleSkge1xuXHRcdFx0Y2FwT2JqW2tleV0gPSB0cnVlOyAvLyB3ZSBhc3N1bWUgaXQgdG8gYmUgLSB0cnVlXG5cdFx0fSk7XG5cblx0XHRyZXR1cm4gY2FwT2JqO1xuXHR9O1xuXG5cdC8qKlxuXHRUZXN0IHRoZSBzcGVjaWZpZWQgcnVudGltZSBmb3Igc3BlY2lmaWMgY2FwYWJpbGl0aWVzLlxuXG5cdEBtZXRob2QgY2FuXG5cdEBzdGF0aWNcblx0QHBhcmFtIHtTdHJpbmd9IHR5cGUgUnVudGltZSB0eXBlIChlLmcuIGZsYXNoLCBodG1sNSwgZXRjKVxuXHRAcGFyYW0ge1N0cmluZ3xPYmplY3R9IGNhcHMgU2V0IG9mIGNhcGFiaWxpdGllcyB0byBjaGVja1xuXHRAcmV0dXJuIHtCb29sZWFufSBSZXN1bHQgb2YgdGhlIHRlc3Rcblx0Ki9cblx0UnVudGltZS5jYW4gPSBmdW5jdGlvbih0eXBlLCBjYXBzKSB7XG5cdFx0dmFyIHJ1bnRpbWVcblx0XHQsIGNvbnN0cnVjdG9yID0gUnVudGltZS5nZXRDb25zdHJ1Y3Rvcih0eXBlKVxuXHRcdCwgbW9kZVxuXHRcdDtcblx0XHRpZiAoY29uc3RydWN0b3IpIHtcblx0XHRcdHJ1bnRpbWUgPSBuZXcgY29uc3RydWN0b3Ioe1xuXHRcdFx0XHRyZXF1aXJlZF9jYXBzOiBjYXBzXG5cdFx0XHR9KTtcblx0XHRcdG1vZGUgPSBydW50aW1lLm1vZGU7XG5cdFx0XHRydW50aW1lLmRlc3Ryb3koKTtcblx0XHRcdHJldHVybiAhIW1vZGU7XG5cdFx0fVxuXHRcdHJldHVybiBmYWxzZTtcblx0fTtcblxuXG5cdC8qKlxuXHRGaWd1cmUgb3V0IGEgcnVudGltZSB0aGF0IHN1cHBvcnRzIHNwZWNpZmllZCBjYXBhYmlsaXRpZXMuXG5cblx0QG1ldGhvZCB0aGF0Q2FuXG5cdEBzdGF0aWNcblx0QHBhcmFtIHtTdHJpbmd8T2JqZWN0fSBjYXBzIFNldCBvZiBjYXBhYmlsaXRpZXMgdG8gY2hlY2tcblx0QHBhcmFtIHtTdHJpbmd9IFtydW50aW1lT3JkZXJdIENvbW1hLXNlcGFyYXRlZCBsaXN0IG9mIHJ1bnRpbWVzIHRvIGNoZWNrIGFnYWluc3Rcblx0QHJldHVybiB7U3RyaW5nfSBVc2FibGUgcnVudGltZSBpZGVudGlmaWVyIG9yIG51bGxcblx0Ki9cblx0UnVudGltZS50aGF0Q2FuID0gZnVuY3Rpb24oY2FwcywgcnVudGltZU9yZGVyKSB7XG5cdFx0dmFyIHR5cGVzID0gKHJ1bnRpbWVPcmRlciB8fCBSdW50aW1lLm9yZGVyKS5zcGxpdCgvXFxzKixcXHMqLyk7XG5cdFx0Zm9yICh2YXIgaSBpbiB0eXBlcykge1xuXHRcdFx0aWYgKFJ1bnRpbWUuY2FuKHR5cGVzW2ldLCBjYXBzKSkge1xuXHRcdFx0XHRyZXR1cm4gdHlwZXNbaV07XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiBudWxsO1xuXHR9O1xuXG5cblx0LyoqXG5cdEZpZ3VyZSBvdXQgYW4gb3BlcmF0aW9uYWwgbW9kZSBmb3IgdGhlIHNwZWNpZmllZCBzZXQgb2YgY2FwYWJpbGl0aWVzLlxuXG5cdEBtZXRob2QgZ2V0TW9kZVxuXHRAc3RhdGljXG5cdEBwYXJhbSB7T2JqZWN0fSBtb2RlQ2FwcyBTZXQgb2YgY2FwYWJpbGl0aWVzIHRoYXQgZGVwZW5kIG9uIHBhcnRpY3VsYXIgcnVudGltZSBtb2RlXG5cdEBwYXJhbSB7T2JqZWN0fSBbcmVxdWlyZWRDYXBzXSBTdXBwbGllZCBzZXQgb2YgY2FwYWJpbGl0aWVzIHRvIGZpbmQgb3BlcmF0aW9uYWwgbW9kZSBmb3Jcblx0QHBhcmFtIHtTdHJpbmd8Qm9vbGVhbn0gW2RlZmF1bHRNb2RlPSdicm93c2VyJ10gRGVmYXVsdCBtb2RlIHRvIHVzZSBcblx0QHJldHVybiB7U3RyaW5nfEJvb2xlYW59IENvbXBhdGlibGUgb3BlcmF0aW9uYWwgbW9kZVxuXHQqL1xuXHRSdW50aW1lLmdldE1vZGUgPSBmdW5jdGlvbihtb2RlQ2FwcywgcmVxdWlyZWRDYXBzLCBkZWZhdWx0TW9kZSkge1xuXHRcdHZhciBtb2RlID0gbnVsbDtcblxuXHRcdGlmIChCYXNpYy50eXBlT2YoZGVmYXVsdE1vZGUpID09PSAndW5kZWZpbmVkJykgeyAvLyBvbmx5IGlmIG5vdCBzcGVjaWZpZWRcblx0XHRcdGRlZmF1bHRNb2RlID0gJ2Jyb3dzZXInO1xuXHRcdH1cblxuXHRcdGlmIChyZXF1aXJlZENhcHMgJiYgIUJhc2ljLmlzRW1wdHlPYmoobW9kZUNhcHMpKSB7XG5cdFx0XHQvLyBsb29wIG92ZXIgcmVxdWlyZWQgY2FwcyBhbmQgY2hlY2sgaWYgdGhleSBkbyByZXF1aXJlIHRoZSBzYW1lIG1vZGVcblx0XHRcdEJhc2ljLmVhY2gocmVxdWlyZWRDYXBzLCBmdW5jdGlvbih2YWx1ZSwgY2FwKSB7XG5cdFx0XHRcdGlmIChtb2RlQ2Fwcy5oYXNPd25Qcm9wZXJ0eShjYXApKSB7XG5cdFx0XHRcdFx0dmFyIGNhcE1vZGUgPSBtb2RlQ2Fwc1tjYXBdKHZhbHVlKTtcblxuXHRcdFx0XHRcdC8vIG1ha2Ugc3VyZSB3ZSBhbHdheXMgaGF2ZSBhbiBhcnJheVxuXHRcdFx0XHRcdGlmICh0eXBlb2YoY2FwTW9kZSkgPT09ICdzdHJpbmcnKSB7XG5cdFx0XHRcdFx0XHRjYXBNb2RlID0gW2NhcE1vZGVdO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZiAoIW1vZGUpIHtcblx0XHRcdFx0XHRcdG1vZGUgPSBjYXBNb2RlO1x0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdH0gZWxzZSBpZiAoIShtb2RlID0gQmFzaWMuYXJyYXlJbnRlcnNlY3QobW9kZSwgY2FwTW9kZSkpKSB7XG5cdFx0XHRcdFx0XHQvLyBpZiBjYXAgcmVxdWlyZXMgY29uZmxpY3RpbmcgbW9kZSAtIHJ1bnRpbWUgY2Fubm90IGZ1bGZpbGwgcmVxdWlyZWQgY2Fwc1xuXG5cdFx0XHRcdFx0XHRpZiAoTVhJX0RFQlVHICYmIEVudi5kZWJ1Zy5ydW50aW1lKSB7XG5cdFx0XHRcdFx0XHRcdEVudi5sb2coXCJcXHRcXHQlczogJXMgKGNvbmZsaWN0aW5nIG1vZGUgcmVxdWVzdGVkOiAlcylcIiwgY2FwLCB2YWx1ZSwgY2FwTW9kZSk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHJldHVybiAobW9kZSA9IGZhbHNlKTtcblx0XHRcdFx0XHR9XHRcdFx0XHRcdFxuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKE1YSV9ERUJVRyAmJiBFbnYuZGVidWcucnVudGltZSkge1xuXHRcdFx0XHRcdEVudi5sb2coXCJcXHRcXHQlczogJXMgKGNvbXBhdGlibGUgbW9kZXM6ICVzKVwiLCBjYXAsIHZhbHVlLCBtb2RlKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdGlmIChtb2RlKSB7XG5cdFx0XHRcdHJldHVybiBCYXNpYy5pbkFycmF5KGRlZmF1bHRNb2RlLCBtb2RlKSAhPT0gLTEgPyBkZWZhdWx0TW9kZSA6IG1vZGVbMF07XG5cdFx0XHR9IGVsc2UgaWYgKG1vZGUgPT09IGZhbHNlKSB7XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIGRlZmF1bHRNb2RlOyBcblx0fTtcblxuXG5cdC8qKlxuXHQgKiBUaGlyZCBwYXJ0eSBzaGltcyAoRmxhc2ggYW5kIFNpbHZlcmxpZ2h0KSByZXF1aXJlIGdsb2JhbCBldmVudCB0YXJnZXQgYWdhaW5zdCB3aGljaCB0aGV5XG5cdCAqIHdpbGwgZmlyZSB0aGVpciBldmVudHMuIEhvd2V2ZXIgd2hlbiBtb3hpZSBpcyBub3QgbG9hZGVkIHRvIGdsb2JhbCBuYW1lc3BhY2UsIGRlZmF1bHRcblx0ICogZXZlbnQgdGFyZ2V0IGlzIG5vdCBhY2Nlc3NpYmxlIGFuZCB3ZSBoYXZlIHRvIGNyZWF0ZSBhcnRpZmljaWFsIG9uZXMuXG5cdCAqXG5cdCAqIEBtZXRob2QgZ2V0R2xvYmFsRXZlbnRUYXJnZXRcblx0ICogQHN0YXRpY1xuXHQgKiBAcmV0dXJuIHtTdHJpbmd9IE5hbWUgb2YgdGhlIGdsb2JhbCBldmVudCB0YXJnZXRcblx0ICovXG5cdFJ1bnRpbWUuZ2V0R2xvYmFsRXZlbnRUYXJnZXQgPSBmdW5jdGlvbigpIHtcblx0XHRpZiAoL15tb3hpZVxcLi8udGVzdChFbnYuZ2xvYmFsX2V2ZW50X2Rpc3BhdGNoZXIpICYmICFFbnYuY2FuKCdhY2Nlc3NfZ2xvYmFsX25zJykpIHtcblx0XHRcdHZhciB1bmlxdWVDYWxsYmFja05hbWUgPSBCYXNpYy5ndWlkKCdtb3hpZV9ldmVudF90YXJnZXRfJyk7XG5cblx0XHRcdHdpbmRvd1t1bmlxdWVDYWxsYmFja05hbWVdID0gZnVuY3Rpb24oZSwgZGF0YSkge1xuXHRcdFx0XHRFdmVudFRhcmdldC5pbnN0YW5jZS5kaXNwYXRjaEV2ZW50KGUsIGRhdGEpO1xuXHRcdFx0fTtcblxuXHRcdFx0RW52Lmdsb2JhbF9ldmVudF9kaXNwYXRjaGVyID0gdW5pcXVlQ2FsbGJhY2tOYW1lO1xuXHRcdH1cblxuXHRcdHJldHVybiBFbnYuZ2xvYmFsX2V2ZW50X2Rpc3BhdGNoZXI7XG5cdH07XG5cblxuXHQvKipcblx0Q2FwYWJpbGl0eSBjaGVjayB0aGF0IGFsd2F5cyByZXR1cm5zIHRydWVcblxuXHRAcHJpdmF0ZVxuXHRAc3RhdGljXG5cdEByZXR1cm4ge1RydWV9XG5cdCovXG5cdFJ1bnRpbWUuY2FwVHJ1ZSA9IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiB0cnVlO1xuXHR9O1xuXG5cdC8qKlxuXHRDYXBhYmlsaXR5IGNoZWNrIHRoYXQgYWx3YXlzIHJldHVybnMgZmFsc2VcblxuXHRAcHJpdmF0ZVxuXHRAc3RhdGljXG5cdEByZXR1cm4ge0ZhbHNlfVxuXHQqL1xuXHRSdW50aW1lLmNhcEZhbHNlID0gZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9O1xuXG5cdC8qKlxuXHRFdmFsdWF0ZSB0aGUgZXhwcmVzc2lvbiB0byBib29sZWFuIHZhbHVlIGFuZCBjcmVhdGUgYSBmdW5jdGlvbiB0aGF0IGFsd2F5cyByZXR1cm5zIGl0LlxuXG5cdEBwcml2YXRlXG5cdEBzdGF0aWNcblx0QHBhcmFtIHtNaXhlZH0gZXhwciBFeHByZXNzaW9uIHRvIGV2YWx1YXRlXG5cdEByZXR1cm4ge0Z1bmN0aW9ufSBGdW5jdGlvbiByZXR1cm5pbmcgdGhlIHJlc3VsdCBvZiBldmFsdWF0aW9uXG5cdCovXG5cdFJ1bnRpbWUuY2FwVGVzdCA9IGZ1bmN0aW9uKGV4cHIpIHtcblx0XHRyZXR1cm4gZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gISFleHByO1xuXHRcdH07XG5cdH07XG5cblx0cmV0dXJuIFJ1bnRpbWU7XG59KTtcblxuLy8gSW5jbHVkZWQgZnJvbTogc3JjL2phdmFzY3JpcHQvcnVudGltZS9SdW50aW1lQ2xpZW50LmpzXG5cbi8qKlxuICogUnVudGltZUNsaWVudC5qc1xuICpcbiAqIENvcHlyaWdodCAyMDEzLCBNb3hpZWNvZGUgU3lzdGVtcyBBQlxuICogUmVsZWFzZWQgdW5kZXIgR1BMIExpY2Vuc2UuXG4gKlxuICogTGljZW5zZTogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vbGljZW5zZVxuICogQ29udHJpYnV0aW5nOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9jb250cmlidXRpbmdcbiAqL1xuXG5kZWZpbmUoJ21veGllL3J1bnRpbWUvUnVudGltZUNsaWVudCcsIFtcblx0J21veGllL2NvcmUvdXRpbHMvRW52Jyxcblx0J21veGllL2NvcmUvRXhjZXB0aW9ucycsXG5cdCdtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljJyxcblx0J21veGllL3J1bnRpbWUvUnVudGltZSdcbl0sIGZ1bmN0aW9uKEVudiwgeCwgQmFzaWMsIFJ1bnRpbWUpIHtcblx0LyoqXG5cdFNldCBvZiBtZXRob2RzIGFuZCBwcm9wZXJ0aWVzLCByZXF1aXJlZCBieSBhIGNvbXBvbmVudCB0byBhY3F1aXJlIGFiaWxpdHkgdG8gY29ubmVjdCB0byBhIHJ1bnRpbWVcblxuXHRAY2xhc3MgbW94aWUvcnVudGltZS9SdW50aW1lQ2xpZW50XG5cdCovXG5cdHJldHVybiBmdW5jdGlvbiBSdW50aW1lQ2xpZW50KCkge1xuXHRcdHZhciBydW50aW1lO1xuXG5cdFx0QmFzaWMuZXh0ZW5kKHRoaXMsIHtcblx0XHRcdC8qKlxuXHRcdFx0Q29ubmVjdHMgdG8gdGhlIHJ1bnRpbWUgc3BlY2lmaWVkIGJ5IHRoZSBvcHRpb25zLiBXaWxsIGVpdGhlciBjb25uZWN0IHRvIGV4aXN0aW5nIHJ1bnRpbWUgb3IgY3JlYXRlIGEgbmV3IG9uZS5cblx0XHRcdEluY3JlbWVudHMgbnVtYmVyIG9mIGNsaWVudHMgY29ubmVjdGVkIHRvIHRoZSBzcGVjaWZpZWQgcnVudGltZS5cblxuXHRcdFx0QHByaXZhdGVcblx0XHRcdEBtZXRob2QgY29ubmVjdFJ1bnRpbWVcblx0XHRcdEBwYXJhbSB7TWl4ZWR9IG9wdGlvbnMgQ2FuIGJlIGEgcnVudG1lIHVpZCBvciBhIHNldCBvZiBrZXktdmFsdWUgcGFpcnMgZGVmaW5pbmcgcmVxdWlyZW1lbnRzIGFuZCBwcmUtcmVxdWlzaXRlc1xuXHRcdFx0Ki9cblx0XHRcdGNvbm5lY3RSdW50aW1lOiBmdW5jdGlvbihvcHRpb25zKSB7XG5cdFx0XHRcdHZhciBjb21wID0gdGhpcywgcnVpZDtcblxuXHRcdFx0XHRmdW5jdGlvbiBpbml0aWFsaXplKGl0ZW1zKSB7XG5cdFx0XHRcdFx0dmFyIHR5cGUsIGNvbnN0cnVjdG9yO1xuXG5cdFx0XHRcdFx0Ly8gaWYgd2UgcmFuIG91dCBvZiBydW50aW1lc1xuXHRcdFx0XHRcdGlmICghaXRlbXMubGVuZ3RoKSB7XG5cdFx0XHRcdFx0XHRjb21wLnRyaWdnZXIoJ1J1bnRpbWVFcnJvcicsIG5ldyB4LlJ1bnRpbWVFcnJvcih4LlJ1bnRpbWVFcnJvci5OT1RfSU5JVF9FUlIpKTtcblx0XHRcdFx0XHRcdHJ1bnRpbWUgPSBudWxsO1xuXHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHR5cGUgPSBpdGVtcy5zaGlmdCgpLnRvTG93ZXJDYXNlKCk7XG5cdFx0XHRcdFx0Y29uc3RydWN0b3IgPSBSdW50aW1lLmdldENvbnN0cnVjdG9yKHR5cGUpO1xuXHRcdFx0XHRcdGlmICghY29uc3RydWN0b3IpIHtcblx0XHRcdFx0XHRcdGlmIChNWElfREVCVUcgJiYgRW52LmRlYnVnLnJ1bnRpbWUpIHtcblx0XHRcdFx0XHRcdFx0RW52LmxvZyhcIkNvbnN0cnVjdG9yIGZvciAnJXMnIHJ1bnRpbWUgaXMgbm90IGF2YWlsYWJsZS5cIiwgdHlwZSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRpbml0aWFsaXplKGl0ZW1zKTtcblx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpZiAoTVhJX0RFQlVHICYmIEVudi5kZWJ1Zy5ydW50aW1lKSB7XG5cdFx0XHRcdFx0XHRFbnYubG9nKFwiVHJ5aW5nIHJ1bnRpbWU6ICVzXCIsIHR5cGUpO1xuXHRcdFx0XHRcdFx0RW52LmxvZyhvcHRpb25zKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQvLyB0cnkgaW5pdGlhbGl6aW5nIHRoZSBydW50aW1lXG5cdFx0XHRcdFx0cnVudGltZSA9IG5ldyBjb25zdHJ1Y3RvcihvcHRpb25zKTtcblxuXHRcdFx0XHRcdHJ1bnRpbWUuYmluZCgnSW5pdCcsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0Ly8gbWFyayBydW50aW1lIGFzIGluaXRpYWxpemVkXG5cdFx0XHRcdFx0XHRydW50aW1lLmluaXRpYWxpemVkID0gdHJ1ZTtcblxuXHRcdFx0XHRcdFx0aWYgKE1YSV9ERUJVRyAmJiBFbnYuZGVidWcucnVudGltZSkge1xuXHRcdFx0XHRcdFx0XHRFbnYubG9nKFwiUnVudGltZSAnJXMnIGluaXRpYWxpemVkXCIsIHJ1bnRpbWUudHlwZSk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdC8vIGphaWxicmVhayAuLi5cblx0XHRcdFx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRcdHJ1bnRpbWUuY2xpZW50cysrO1xuXHRcdFx0XHRcdFx0XHRjb21wLnJ1aWQgPSBydW50aW1lLnVpZDtcblx0XHRcdFx0XHRcdFx0Ly8gdGhpcyB3aWxsIGJlIHRyaWdnZXJlZCBvbiBjb21wb25lbnRcblx0XHRcdFx0XHRcdFx0Y29tcC50cmlnZ2VyKCdSdW50aW1lSW5pdCcsIHJ1bnRpbWUpO1xuXHRcdFx0XHRcdFx0fSwgMSk7XG5cdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0XHRydW50aW1lLmJpbmQoJ0Vycm9yJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRpZiAoTVhJX0RFQlVHICYmIEVudi5kZWJ1Zy5ydW50aW1lKSB7XG5cdFx0XHRcdFx0XHRcdEVudi5sb2coXCJSdW50aW1lICclcycgZmFpbGVkIHRvIGluaXRpYWxpemVcIiwgcnVudGltZS50eXBlKTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0cnVudGltZS5kZXN0cm95KCk7IC8vIHJ1bnRpbWUgY2Fubm90IGRlc3Ryb3kgaXRzZWxmIGZyb20gaW5zaWRlIGF0IGEgcmlnaHQgbW9tZW50LCB0aHVzIHdlIGRvIGl0IGhlcmVcblx0XHRcdFx0XHRcdGluaXRpYWxpemUoaXRlbXMpO1xuXHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdFx0cnVudGltZS5iaW5kKCdFeGNlcHRpb24nLCBmdW5jdGlvbihlLCBlcnIpIHtcblx0XHRcdFx0XHRcdHZhciBtZXNzYWdlID0gZXJyLm5hbWUgKyBcIigjXCIgKyBlcnIuY29kZSArIFwiKVwiICsgKGVyci5tZXNzYWdlID8gXCIsIGZyb206IFwiICsgZXJyLm1lc3NhZ2UgOiAnJyk7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdGlmIChNWElfREVCVUcgJiYgRW52LmRlYnVnLnJ1bnRpbWUpIHtcblx0XHRcdFx0XHRcdFx0RW52LmxvZyhcIlJ1bnRpbWUgJyVzJyBoYXMgdGhyb3duIGFuIGV4Y2VwdGlvbjogJXNcIiwgdGhpcy50eXBlLCBtZXNzYWdlKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGNvbXAudHJpZ2dlcignUnVudGltZUVycm9yJywgbmV3IHguUnVudGltZUVycm9yKHguUnVudGltZUVycm9yLkVYQ0VQVElPTl9FUlIsIG1lc3NhZ2UpKTtcblx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHRcdGlmIChNWElfREVCVUcgJiYgRW52LmRlYnVnLnJ1bnRpbWUpIHtcblx0XHRcdFx0XHRcdEVudi5sb2coXCJcXHRzZWxlY3RlZCBtb2RlOiAlc1wiLCBydW50aW1lLm1vZGUpO1x0XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Ly8gY2hlY2sgaWYgcnVudGltZSBtYW5hZ2VkIHRvIHBpY2stdXAgb3BlcmF0aW9uYWwgbW9kZVxuXHRcdFx0XHRcdGlmICghcnVudGltZS5tb2RlKSB7XG5cdFx0XHRcdFx0XHRydW50aW1lLnRyaWdnZXIoJ0Vycm9yJyk7XG5cdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0cnVudGltZS5pbml0KCk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBjaGVjayBpZiBhIHBhcnRpY3VsYXIgcnVudGltZSB3YXMgcmVxdWVzdGVkXG5cdFx0XHRcdGlmIChCYXNpYy50eXBlT2Yob3B0aW9ucykgPT09ICdzdHJpbmcnKSB7XG5cdFx0XHRcdFx0cnVpZCA9IG9wdGlvbnM7XG5cdFx0XHRcdH0gZWxzZSBpZiAoQmFzaWMudHlwZU9mKG9wdGlvbnMucnVpZCkgPT09ICdzdHJpbmcnKSB7XG5cdFx0XHRcdFx0cnVpZCA9IG9wdGlvbnMucnVpZDtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmIChydWlkKSB7XG5cdFx0XHRcdFx0cnVudGltZSA9IFJ1bnRpbWUuZ2V0UnVudGltZShydWlkKTtcblx0XHRcdFx0XHRpZiAocnVudGltZSkge1xuXHRcdFx0XHRcdFx0Y29tcC5ydWlkID0gcnVpZDtcblx0XHRcdFx0XHRcdHJ1bnRpbWUuY2xpZW50cysrO1xuXHRcdFx0XHRcdFx0cmV0dXJuIHJ1bnRpbWU7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdC8vIHRoZXJlIHNob3VsZCBiZSBhIHJ1bnRpbWUgYW5kIHRoZXJlJ3Mgbm9uZSAtIHdlaXJkIGNhc2Vcblx0XHRcdFx0XHRcdHRocm93IG5ldyB4LlJ1bnRpbWVFcnJvcih4LlJ1bnRpbWVFcnJvci5OT1RfSU5JVF9FUlIpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIGluaXRpYWxpemUgYSBmcmVzaCBvbmUsIHRoYXQgZml0cyBydW50aW1lIGxpc3QgYW5kIHJlcXVpcmVkIGZlYXR1cmVzIGJlc3Rcblx0XHRcdFx0aW5pdGlhbGl6ZSgob3B0aW9ucy5ydW50aW1lX29yZGVyIHx8IFJ1bnRpbWUub3JkZXIpLnNwbGl0KC9cXHMqLFxccyovKSk7XG5cdFx0XHR9LFxuXG5cblx0XHRcdC8qKlxuXHRcdFx0RGlzY29ubmVjdHMgZnJvbSB0aGUgcnVudGltZS4gRGVjcmVtZW50cyBudW1iZXIgb2YgY2xpZW50cyBjb25uZWN0ZWQgdG8gdGhlIHNwZWNpZmllZCBydW50aW1lLlxuXG5cdFx0XHRAcHJpdmF0ZVxuXHRcdFx0QG1ldGhvZCBkaXNjb25uZWN0UnVudGltZVxuXHRcdFx0Ki9cblx0XHRcdGRpc2Nvbm5lY3RSdW50aW1lOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0aWYgKHJ1bnRpbWUgJiYgLS1ydW50aW1lLmNsaWVudHMgPD0gMCkge1xuXHRcdFx0XHRcdHJ1bnRpbWUuZGVzdHJveSgpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gb25jZSB0aGUgY29tcG9uZW50IGlzIGRpc2Nvbm5lY3RlZCwgaXQgc2hvdWxkbid0IGhhdmUgYWNjZXNzIHRvIHRoZSBydW50aW1lXG5cdFx0XHRcdHJ1bnRpbWUgPSBudWxsO1xuXHRcdFx0fSxcblxuXG5cdFx0XHQvKipcblx0XHRcdFJldHVybnMgdGhlIHJ1bnRpbWUgdG8gd2hpY2ggdGhlIGNsaWVudCBpcyBjdXJyZW50bHkgY29ubmVjdGVkLlxuXG5cdFx0XHRAbWV0aG9kIGdldFJ1bnRpbWVcblx0XHRcdEByZXR1cm4ge1J1bnRpbWV9IFJ1bnRpbWUgb3IgbnVsbCBpZiBjbGllbnQgaXMgbm90IGNvbm5lY3RlZFxuXHRcdFx0Ki9cblx0XHRcdGdldFJ1bnRpbWU6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRpZiAocnVudGltZSAmJiBydW50aW1lLnVpZCkge1xuXHRcdFx0XHRcdHJldHVybiBydW50aW1lO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiBydW50aW1lID0gbnVsbDsgLy8gbWFrZSBzdXJlIHdlIGRvIG5vdCBsZWF2ZSB6b21iaWVzIHJhbWJsaW5nIGFyb3VuZFxuXHRcdFx0fSxcblxuXG5cdFx0XHQvKipcblx0XHRcdEhhbmR5IHNob3J0Y3V0IHRvIHNhZmVseSBpbnZva2UgcnVudGltZSBleHRlbnNpb24gbWV0aG9kcy5cblx0XHRcdFxuXHRcdFx0QHByaXZhdGVcblx0XHRcdEBtZXRob2QgZXhlY1xuXHRcdFx0QHJldHVybiB7TWl4ZWR9IFdoYXRldmVyIHJ1bnRpbWUgZXh0ZW5zaW9uIG1ldGhvZCByZXR1cm5zXG5cdFx0XHQqL1xuXHRcdFx0ZXhlYzogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiBydW50aW1lID8gcnVudGltZS5leGVjLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgOiBudWxsO1xuXHRcdFx0fSxcblxuXG5cdFx0XHQvKipcblx0XHRcdFRlc3QgcnVudGltZSBjbGllbnQgZm9yIHNwZWNpZmljIGNhcGFiaWxpdHlcblx0XHRcdFxuXHRcdFx0QG1ldGhvZCBjYW5cblx0XHRcdEBwYXJhbSB7U3RyaW5nfSBjYXBcblx0XHRcdEByZXR1cm4ge0Jvb2x9XG5cdFx0XHQqL1xuXHRcdFx0Y2FuOiBmdW5jdGlvbihjYXApIHtcblx0XHRcdFx0cmV0dXJuIHJ1bnRpbWUgPyBydW50aW1lLmNhbihjYXApIDogZmFsc2U7XG5cdFx0XHR9XG5cblx0XHR9KTtcblx0fTtcblxuXG59KTtcblxuLy8gSW5jbHVkZWQgZnJvbTogc3JjL2phdmFzY3JpcHQvZmlsZS9CbG9iLmpzXG5cbi8qKlxuICogQmxvYi5qc1xuICpcbiAqIENvcHlyaWdodCAyMDEzLCBNb3hpZWNvZGUgU3lzdGVtcyBBQlxuICogUmVsZWFzZWQgdW5kZXIgR1BMIExpY2Vuc2UuXG4gKlxuICogTGljZW5zZTogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vbGljZW5zZVxuICogQ29udHJpYnV0aW5nOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9jb250cmlidXRpbmdcbiAqL1xuXG5kZWZpbmUoJ21veGllL2ZpbGUvQmxvYicsIFtcblx0J21veGllL2NvcmUvdXRpbHMvQmFzaWMnLFxuXHQnbW94aWUvY29yZS91dGlscy9FbmNvZGUnLFxuXHQnbW94aWUvcnVudGltZS9SdW50aW1lQ2xpZW50J1xuXSwgZnVuY3Rpb24oQmFzaWMsIEVuY29kZSwgUnVudGltZUNsaWVudCkge1xuXHRcblx0dmFyIGJsb2Jwb29sID0ge307XG5cblx0LyoqXG5cdEBjbGFzcyBtb3hpZS9maWxlL0Jsb2Jcblx0QGNvbnN0cnVjdG9yXG5cdEBwYXJhbSB7U3RyaW5nfSBydWlkIFVuaXF1ZSBpZCBvZiB0aGUgcnVudGltZSwgdG8gd2hpY2ggdGhpcyBibG9iIGJlbG9uZ3MgdG9cblx0QHBhcmFtIHtPYmplY3R9IGJsb2IgT2JqZWN0IFwiTmF0aXZlXCIgYmxvYiBvYmplY3QsIGFzIGl0IGlzIHJlcHJlc2VudGVkIGluIHRoZSBydW50aW1lXG5cdCovXG5cdGZ1bmN0aW9uIEJsb2IocnVpZCwgYmxvYikge1xuXG5cdFx0ZnVuY3Rpb24gX3NsaWNlRGV0YWNoZWQoc3RhcnQsIGVuZCwgdHlwZSkge1xuXHRcdFx0dmFyIGJsb2IsIGRhdGEgPSBibG9icG9vbFt0aGlzLnVpZF07XG5cblx0XHRcdGlmIChCYXNpYy50eXBlT2YoZGF0YSkgIT09ICdzdHJpbmcnIHx8ICFkYXRhLmxlbmd0aCkge1xuXHRcdFx0XHRyZXR1cm4gbnVsbDsgLy8gb3IgdGhyb3cgZXhjZXB0aW9uXG5cdFx0XHR9XG5cblx0XHRcdGJsb2IgPSBuZXcgQmxvYihudWxsLCB7XG5cdFx0XHRcdHR5cGU6IHR5cGUsXG5cdFx0XHRcdHNpemU6IGVuZCAtIHN0YXJ0XG5cdFx0XHR9KTtcblx0XHRcdGJsb2IuZGV0YWNoKGRhdGEuc3Vic3RyKHN0YXJ0LCBibG9iLnNpemUpKTtcblxuXHRcdFx0cmV0dXJuIGJsb2I7XG5cdFx0fVxuXG5cdFx0UnVudGltZUNsaWVudC5jYWxsKHRoaXMpO1xuXG5cdFx0aWYgKHJ1aWQpIHtcdFxuXHRcdFx0dGhpcy5jb25uZWN0UnVudGltZShydWlkKTtcblx0XHR9XG5cblx0XHRpZiAoIWJsb2IpIHtcblx0XHRcdGJsb2IgPSB7fTtcblx0XHR9IGVsc2UgaWYgKEJhc2ljLnR5cGVPZihibG9iKSA9PT0gJ3N0cmluZycpIHsgLy8gZGF0YVVybCBvciBiaW5hcnkgc3RyaW5nXG5cdFx0XHRibG9iID0geyBkYXRhOiBibG9iIH07XG5cdFx0fVxuXG5cdFx0QmFzaWMuZXh0ZW5kKHRoaXMsIHtcblx0XHRcdFxuXHRcdFx0LyoqXG5cdFx0XHRVbmlxdWUgaWQgb2YgdGhlIGNvbXBvbmVudFxuXG5cdFx0XHRAcHJvcGVydHkgdWlkXG5cdFx0XHRAdHlwZSB7U3RyaW5nfVxuXHRcdFx0Ki9cblx0XHRcdHVpZDogYmxvYi51aWQgfHwgQmFzaWMuZ3VpZCgndWlkXycpLFxuXHRcdFx0XG5cdFx0XHQvKipcblx0XHRcdFVuaXF1ZSBpZCBvZiB0aGUgY29ubmVjdGVkIHJ1bnRpbWUsIGlmIGZhbHN5LCB0aGVuIHJ1bnRpbWUgd2lsbCBoYXZlIHRvIGJlIGluaXRpYWxpemVkIFxuXHRcdFx0YmVmb3JlIHRoaXMgQmxvYiBjYW4gYmUgdXNlZCwgbW9kaWZpZWQgb3Igc2VudFxuXG5cdFx0XHRAcHJvcGVydHkgcnVpZFxuXHRcdFx0QHR5cGUge1N0cmluZ31cblx0XHRcdCovXG5cdFx0XHRydWlkOiBydWlkLFxuXHRcblx0XHRcdC8qKlxuXHRcdFx0U2l6ZSBvZiBibG9iXG5cblx0XHRcdEBwcm9wZXJ0eSBzaXplXG5cdFx0XHRAdHlwZSB7TnVtYmVyfVxuXHRcdFx0QGRlZmF1bHQgMFxuXHRcdFx0Ki9cblx0XHRcdHNpemU6IGJsb2Iuc2l6ZSB8fCAwLFxuXHRcdFx0XG5cdFx0XHQvKipcblx0XHRcdE1pbWUgdHlwZSBvZiBibG9iXG5cblx0XHRcdEBwcm9wZXJ0eSB0eXBlXG5cdFx0XHRAdHlwZSB7U3RyaW5nfVxuXHRcdFx0QGRlZmF1bHQgJydcblx0XHRcdCovXG5cdFx0XHR0eXBlOiBibG9iLnR5cGUgfHwgJycsXG5cdFx0XHRcblx0XHRcdC8qKlxuXHRcdFx0QG1ldGhvZCBzbGljZVxuXHRcdFx0QHBhcmFtIHtOdW1iZXJ9IFtzdGFydD0wXVxuXHRcdFx0Ki9cblx0XHRcdHNsaWNlOiBmdW5jdGlvbihzdGFydCwgZW5kLCB0eXBlKSB7XHRcdFxuXHRcdFx0XHRpZiAodGhpcy5pc0RldGFjaGVkKCkpIHtcblx0XHRcdFx0XHRyZXR1cm4gX3NsaWNlRGV0YWNoZWQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gdGhpcy5nZXRSdW50aW1lKCkuZXhlYy5jYWxsKHRoaXMsICdCbG9iJywgJ3NsaWNlJywgdGhpcy5nZXRTb3VyY2UoKSwgc3RhcnQsIGVuZCwgdHlwZSk7XG5cdFx0XHR9LFxuXG5cdFx0XHQvKipcblx0XHRcdFJldHVybnMgXCJuYXRpdmVcIiBibG9iIG9iamVjdCAoYXMgaXQgaXMgcmVwcmVzZW50ZWQgaW4gY29ubmVjdGVkIHJ1bnRpbWUpIG9yIG51bGwgaWYgbm90IGZvdW5kXG5cblx0XHRcdEBtZXRob2QgZ2V0U291cmNlXG5cdFx0XHRAcmV0dXJuIHtCbG9ifSBSZXR1cm5zIFwibmF0aXZlXCIgYmxvYiBvYmplY3Qgb3IgbnVsbCBpZiBub3QgZm91bmRcblx0XHRcdCovXG5cdFx0XHRnZXRTb3VyY2U6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRpZiAoIWJsb2Jwb29sW3RoaXMudWlkXSkge1xuXHRcdFx0XHRcdHJldHVybiBudWxsO1x0XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIGJsb2Jwb29sW3RoaXMudWlkXTtcblx0XHRcdH0sXG5cblx0XHRcdC8qKiBcblx0XHRcdERldGFjaGVzIGJsb2IgZnJvbSBhbnkgcnVudGltZSB0aGF0IGl0IGRlcGVuZHMgb24gYW5kIGluaXRpYWxpemUgd2l0aCBzdGFuZGFsb25lIHZhbHVlXG5cblx0XHRcdEBtZXRob2QgZGV0YWNoXG5cdFx0XHRAcHJvdGVjdGVkXG5cdFx0XHRAcGFyYW0ge0RPTVN0cmluZ30gW2RhdGE9JyddIFN0YW5kYWxvbmUgdmFsdWVcblx0XHRcdCovXG5cdFx0XHRkZXRhY2g6IGZ1bmN0aW9uKGRhdGEpIHtcblx0XHRcdFx0aWYgKHRoaXMucnVpZCkge1xuXHRcdFx0XHRcdHRoaXMuZ2V0UnVudGltZSgpLmV4ZWMuY2FsbCh0aGlzLCAnQmxvYicsICdkZXN0cm95Jyk7XG5cdFx0XHRcdFx0dGhpcy5kaXNjb25uZWN0UnVudGltZSgpO1xuXHRcdFx0XHRcdHRoaXMucnVpZCA9IG51bGw7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRkYXRhID0gZGF0YSB8fCAnJztcblxuXHRcdFx0XHQvLyBpZiBkYXRhVXJsLCBjb252ZXJ0IHRvIGJpbmFyeSBzdHJpbmdcblx0XHRcdFx0aWYgKGRhdGEuc3Vic3RyKDAsIDUpID09ICdkYXRhOicpIHtcblx0XHRcdFx0XHR2YXIgYmFzZTY0T2Zmc2V0ID0gZGF0YS5pbmRleE9mKCc7YmFzZTY0LCcpO1xuXHRcdFx0XHRcdHRoaXMudHlwZSA9IGRhdGEuc3Vic3RyaW5nKDUsIGJhc2U2NE9mZnNldCk7XG5cdFx0XHRcdFx0ZGF0YSA9IEVuY29kZS5hdG9iKGRhdGEuc3Vic3RyaW5nKGJhc2U2NE9mZnNldCArIDgpKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHRoaXMuc2l6ZSA9IGRhdGEubGVuZ3RoO1xuXG5cdFx0XHRcdGJsb2Jwb29sW3RoaXMudWlkXSA9IGRhdGE7XG5cdFx0XHR9LFxuXG5cdFx0XHQvKipcblx0XHRcdENoZWNrcyBpZiBibG9iIGlzIHN0YW5kYWxvbmUgKGRldGFjaGVkIG9mIGFueSBydW50aW1lKVxuXHRcdFx0XG5cdFx0XHRAbWV0aG9kIGlzRGV0YWNoZWRcblx0XHRcdEBwcm90ZWN0ZWRcblx0XHRcdEByZXR1cm4ge0Jvb2xlYW59XG5cdFx0XHQqL1xuXHRcdFx0aXNEZXRhY2hlZDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiAhdGhpcy5ydWlkICYmIEJhc2ljLnR5cGVPZihibG9icG9vbFt0aGlzLnVpZF0pID09PSAnc3RyaW5nJztcblx0XHRcdH0sXG5cdFx0XHRcblx0XHRcdC8qKiBcblx0XHRcdERlc3Ryb3kgQmxvYiBhbmQgZnJlZSBhbnkgcmVzb3VyY2VzIGl0IHdhcyB1c2luZ1xuXG5cdFx0XHRAbWV0aG9kIGRlc3Ryb3lcblx0XHRcdCovXG5cdFx0XHRkZXN0cm95OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0dGhpcy5kZXRhY2goKTtcblx0XHRcdFx0ZGVsZXRlIGJsb2Jwb29sW3RoaXMudWlkXTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdFxuXHRcdGlmIChibG9iLmRhdGEpIHtcblx0XHRcdHRoaXMuZGV0YWNoKGJsb2IuZGF0YSk7IC8vIGF1dG8tZGV0YWNoIGlmIHBheWxvYWQgaGFzIGJlZW4gcGFzc2VkXG5cdFx0fSBlbHNlIHtcblx0XHRcdGJsb2Jwb29sW3RoaXMudWlkXSA9IGJsb2I7XHRcblx0XHR9XG5cdH1cblx0XG5cdHJldHVybiBCbG9iO1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L2NvcmUvSTE4bi5qc1xuXG4vKipcbiAqIEkxOG4uanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuZGVmaW5lKFwibW94aWUvY29yZS9JMThuXCIsIFtcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCJcbl0sIGZ1bmN0aW9uKEJhc2ljKSB7XG5cdHZhciBpMThuID0ge307XG5cblx0LyoqXG5cdEBjbGFzcyBtb3hpZS9jb3JlL0kxOG5cblx0Ki9cblx0cmV0dXJuIHtcblx0XHQvKipcblx0XHQgKiBFeHRlbmRzIHRoZSBsYW5ndWFnZSBwYWNrIG9iamVjdCB3aXRoIG5ldyBpdGVtcy5cblx0XHQgKlxuXHRcdCAqIEBwYXJhbSB7T2JqZWN0fSBwYWNrIExhbmd1YWdlIHBhY2sgaXRlbXMgdG8gYWRkLlxuXHRcdCAqIEByZXR1cm4ge09iamVjdH0gRXh0ZW5kZWQgbGFuZ3VhZ2UgcGFjayBvYmplY3QuXG5cdFx0ICovXG5cdFx0YWRkSTE4bjogZnVuY3Rpb24ocGFjaykge1xuXHRcdFx0cmV0dXJuIEJhc2ljLmV4dGVuZChpMThuLCBwYWNrKTtcblx0XHR9LFxuXG5cdFx0LyoqXG5cdFx0ICogVHJhbnNsYXRlcyB0aGUgc3BlY2lmaWVkIHN0cmluZyBieSBjaGVja2luZyBmb3IgdGhlIGVuZ2xpc2ggc3RyaW5nIGluIHRoZSBsYW5ndWFnZSBwYWNrIGxvb2t1cC5cblx0XHQgKlxuXHRcdCAqIEBwYXJhbSB7U3RyaW5nfSBzdHIgU3RyaW5nIHRvIGxvb2sgZm9yLlxuXHRcdCAqIEByZXR1cm4ge1N0cmluZ30gVHJhbnNsYXRlZCBzdHJpbmcgb3IgdGhlIGlucHV0IHN0cmluZyBpZiBpdCB3YXNuJ3QgZm91bmQuXG5cdFx0ICovXG5cdFx0dHJhbnNsYXRlOiBmdW5jdGlvbihzdHIpIHtcblx0XHRcdHJldHVybiBpMThuW3N0cl0gfHwgc3RyO1xuXHRcdH0sXG5cblx0XHQvKipcblx0XHQgKiBTaG9ydGN1dCBmb3IgdHJhbnNsYXRlIGZ1bmN0aW9uXG5cdFx0ICpcblx0XHQgKiBAcGFyYW0ge1N0cmluZ30gc3RyIFN0cmluZyB0byBsb29rIGZvci5cblx0XHQgKiBAcmV0dXJuIHtTdHJpbmd9IFRyYW5zbGF0ZWQgc3RyaW5nIG9yIHRoZSBpbnB1dCBzdHJpbmcgaWYgaXQgd2Fzbid0IGZvdW5kLlxuXHRcdCAqL1xuXHRcdF86IGZ1bmN0aW9uKHN0cikge1xuXHRcdFx0cmV0dXJuIHRoaXMudHJhbnNsYXRlKHN0cik7XG5cdFx0fSxcblxuXHRcdC8qKlxuXHRcdCAqIFBzZXVkbyBzcHJpbnRmIGltcGxlbWVudGF0aW9uIC0gc2ltcGxlIHdheSB0byByZXBsYWNlIHRva2VucyB3aXRoIHNwZWNpZmllZCB2YWx1ZXMuXG5cdFx0ICpcblx0XHQgKiBAcGFyYW0ge1N0cmluZ30gc3RyIFN0cmluZyB3aXRoIHRva2Vuc1xuXHRcdCAqIEByZXR1cm4ge1N0cmluZ30gU3RyaW5nIHdpdGggcmVwbGFjZWQgdG9rZW5zXG5cdFx0ICovXG5cdFx0c3ByaW50ZjogZnVuY3Rpb24oc3RyKSB7XG5cdFx0XHR2YXIgYXJncyA9IFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKTtcblxuXHRcdFx0cmV0dXJuIHN0ci5yZXBsYWNlKC8lW2Etel0vZywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciB2YWx1ZSA9IGFyZ3Muc2hpZnQoKTtcblx0XHRcdFx0cmV0dXJuIEJhc2ljLnR5cGVPZih2YWx1ZSkgIT09ICd1bmRlZmluZWQnID8gdmFsdWUgOiAnJztcblx0XHRcdH0pO1xuXHRcdH1cblx0fTtcbn0pO1xuXG4vLyBJbmNsdWRlZCBmcm9tOiBzcmMvamF2YXNjcmlwdC9jb3JlL3V0aWxzL01pbWUuanNcblxuLyoqXG4gKiBNaW1lLmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG5cbi8qKlxuQGNsYXNzIG1veGllL2NvcmUvdXRpbHMvTWltZVxuQHB1YmxpY1xuQHN0YXRpY1xuKi9cblxuZGVmaW5lKFwibW94aWUvY29yZS91dGlscy9NaW1lXCIsIFtcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCIsXG5cdFwibW94aWUvY29yZS9JMThuXCJcbl0sIGZ1bmN0aW9uKEJhc2ljLCBJMThuKSB7XG5cblx0dmFyIG1pbWVEYXRhID0gXCJcIiArXG5cdFx0XCJhcHBsaWNhdGlvbi9tc3dvcmQsZG9jIGRvdCxcIiArXG5cdFx0XCJhcHBsaWNhdGlvbi9wZGYscGRmLFwiICtcblx0XHRcImFwcGxpY2F0aW9uL3BncC1zaWduYXR1cmUscGdwLFwiICtcblx0XHRcImFwcGxpY2F0aW9uL3Bvc3RzY3JpcHQscHMgYWkgZXBzLFwiICtcblx0XHRcImFwcGxpY2F0aW9uL3J0ZixydGYsXCIgK1xuXHRcdFwiYXBwbGljYXRpb24vdm5kLm1zLWV4Y2VsLHhscyB4bGIgeGx0IHhsYSxcIiArXG5cdFx0XCJhcHBsaWNhdGlvbi92bmQubXMtcG93ZXJwb2ludCxwcHQgcHBzIHBvdCBwcGEsXCIgK1xuXHRcdFwiYXBwbGljYXRpb24vemlwLHppcCxcIiArXG5cdFx0XCJhcHBsaWNhdGlvbi94LXNob2Nrd2F2ZS1mbGFzaCxzd2Ygc3dmbCxcIiArXG5cdFx0XCJhcHBsaWNhdGlvbi92bmQub3BlbnhtbGZvcm1hdHMtb2ZmaWNlZG9jdW1lbnQud29yZHByb2Nlc3NpbmdtbC5kb2N1bWVudCxkb2N4LFwiICtcblx0XHRcImFwcGxpY2F0aW9uL3ZuZC5vcGVueG1sZm9ybWF0cy1vZmZpY2Vkb2N1bWVudC53b3JkcHJvY2Vzc2luZ21sLnRlbXBsYXRlLGRvdHgsXCIgK1xuXHRcdFwiYXBwbGljYXRpb24vdm5kLm9wZW54bWxmb3JtYXRzLW9mZmljZWRvY3VtZW50LnNwcmVhZHNoZWV0bWwuc2hlZXQseGxzeCxcIiArXG5cdFx0XCJhcHBsaWNhdGlvbi92bmQub3BlbnhtbGZvcm1hdHMtb2ZmaWNlZG9jdW1lbnQucHJlc2VudGF0aW9ubWwucHJlc2VudGF0aW9uLHBwdHgsXCIgK1xuXHRcdFwiYXBwbGljYXRpb24vdm5kLm9wZW54bWxmb3JtYXRzLW9mZmljZWRvY3VtZW50LnByZXNlbnRhdGlvbm1sLnRlbXBsYXRlLHBvdHgsXCIgK1xuXHRcdFwiYXBwbGljYXRpb24vdm5kLm9wZW54bWxmb3JtYXRzLW9mZmljZWRvY3VtZW50LnByZXNlbnRhdGlvbm1sLnNsaWRlc2hvdyxwcHN4LFwiICtcblx0XHRcImFwcGxpY2F0aW9uL3gtamF2YXNjcmlwdCxqcyxcIiArXG5cdFx0XCJhcHBsaWNhdGlvbi9qc29uLGpzb24sXCIgK1xuXHRcdFwiYXVkaW8vbXBlZyxtcDMgbXBnYSBtcGVnYSBtcDIsXCIgK1xuXHRcdFwiYXVkaW8veC13YXYsd2F2LFwiICtcblx0XHRcImF1ZGlvL3gtbTRhLG00YSxcIiArXG5cdFx0XCJhdWRpby9vZ2csb2dhIG9nZyxcIiArXG5cdFx0XCJhdWRpby9haWZmLGFpZmYgYWlmLFwiICtcblx0XHRcImF1ZGlvL2ZsYWMsZmxhYyxcIiArXG5cdFx0XCJhdWRpby9hYWMsYWFjLFwiICtcblx0XHRcImF1ZGlvL2FjMyxhYzMsXCIgK1xuXHRcdFwiYXVkaW8veC1tcy13bWEsd21hLFwiICtcblx0XHRcImltYWdlL2JtcCxibXAsXCIgK1xuXHRcdFwiaW1hZ2UvZ2lmLGdpZixcIiArXG5cdFx0XCJpbWFnZS9qcGVnLGpwZyBqcGVnIGpwZSxcIiArXG5cdFx0XCJpbWFnZS9waG90b3Nob3AscHNkLFwiICtcblx0XHRcImltYWdlL3BuZyxwbmcsXCIgK1xuXHRcdFwiaW1hZ2Uvc3ZnK3htbCxzdmcgc3ZneixcIiArXG5cdFx0XCJpbWFnZS90aWZmLHRpZmYgdGlmLFwiICtcblx0XHRcInRleHQvcGxhaW4sYXNjIHR4dCB0ZXh0IGRpZmYgbG9nLFwiICtcblx0XHRcInRleHQvaHRtbCxodG0gaHRtbCB4aHRtbCxcIiArXG5cdFx0XCJ0ZXh0L2Nzcyxjc3MsXCIgK1xuXHRcdFwidGV4dC9jc3YsY3N2LFwiICtcblx0XHRcInRleHQvcnRmLHJ0ZixcIiArXG5cdFx0XCJ2aWRlby9tcGVnLG1wZWcgbXBnIG1wZSBtMnYsXCIgK1xuXHRcdFwidmlkZW8vcXVpY2t0aW1lLHF0IG1vdixcIiArXG5cdFx0XCJ2aWRlby9tcDQsbXA0LFwiICtcblx0XHRcInZpZGVvL3gtbTR2LG00dixcIiArXG5cdFx0XCJ2aWRlby94LWZsdixmbHYsXCIgK1xuXHRcdFwidmlkZW8veC1tcy13bXYsd212LFwiICtcblx0XHRcInZpZGVvL2F2aSxhdmksXCIgK1xuXHRcdFwidmlkZW8vd2VibSx3ZWJtLFwiICtcblx0XHRcInZpZGVvLzNncHAsM2dwcCAzZ3AsXCIgK1xuXHRcdFwidmlkZW8vM2dwcDIsM2cyLFwiICtcblx0XHRcInZpZGVvL3ZuZC5ybi1yZWFsdmlkZW8scnYsXCIgK1xuXHRcdFwidmlkZW8vb2dnLG9ndixcIiArXG5cdFx0XCJ2aWRlby94LW1hdHJvc2thLG1rdixcIiArXG5cdFx0XCJhcHBsaWNhdGlvbi92bmQub2FzaXMub3BlbmRvY3VtZW50LmZvcm11bGEtdGVtcGxhdGUsb3RmLFwiICtcblx0XHRcImFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbSxleGVcIjtcblxuXG5cdC8qKlxuXHQgKiBNYXAgb2YgbWltZXMgdG8gZXh0ZW5zaW9uc1xuXHQgKlxuXHQgKiBAcHJvcGVydHkgbWltZXNcblx0ICogQHR5cGUge09iamVjdH1cblx0ICovXG5cdHZhciBtaW1lcyA9IHt9O1xuXG5cdC8qKlxuXHQgKiBNYXAgb2YgZXh0ZW5zaW9ucyB0byBtaW1lc1xuXHQgKlxuXHQgKiBAcHJvcGVydHkgZXh0ZW5zaW9uc1xuXHQgKiBAdHlwZSB7T2JqZWN0fVxuXHQgKi9cblx0dmFyIGV4dGVuc2lvbnMgPSB7fTtcblxuXG5cdC8qKlxuXHQqIFBhcnNlcyBtaW1lRGF0YSBzdHJpbmcgaW50byBhIG1pbWVzIGFuZCBleHRlbnNpb25zIGxvb2t1cCBtYXBzLiBTdHJpbmcgc2hvdWxkIGhhdmUgdGhlXG5cdCogZm9sbG93aW5nIGZvcm1hdDpcblx0KlxuXHQqIGFwcGxpY2F0aW9uL21zd29yZCxkb2MgZG90LGFwcGxpY2F0aW9uL3BkZixwZGYsIC4uLlxuXHQqXG5cdCogc28gbWltZS10eXBlIGZvbGxvd2VkIGJ5IGNvbW1hIGFuZCBmb2xsb3dlZCBieSBzcGFjZS1zZXBhcmF0ZWQgbGlzdCBvZiBhc3NvY2lhdGVkIGV4dGVuc2lvbnMsXG5cdCogdGhlbiBjb21tYSBhZ2FpbiBhbmQgdGhlbiBhbm90aGVyIG1pbWUtdHlwZSwgZXRjLlxuXHQqXG5cdCogSWYgaW52b2tlZCBleHRlcm5hbGx5IHdpbGwgcmVwbGFjZSBvdmVycmlkZSBpbnRlcm5hbCBsb29rdXAgbWFwcyB3aXRoIHVzZXItcHJvdmlkZWQgZGF0YS5cblx0KlxuXHQqIEBtZXRob2QgYWRkTWltZVR5cGVcblx0KiBAcGFyYW0ge1N0cmluZ30gbWltZURhdGFcblx0Ki9cblx0dmFyIGFkZE1pbWVUeXBlID0gZnVuY3Rpb24gKG1pbWVEYXRhKSB7XG5cdFx0dmFyIGl0ZW1zID0gbWltZURhdGEuc3BsaXQoLywvKSwgaSwgaWksIGV4dDtcblxuXHRcdGZvciAoaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkgKz0gMikge1xuXHRcdFx0ZXh0ID0gaXRlbXNbaSArIDFdLnNwbGl0KC8gLyk7XG5cblx0XHRcdC8vIGV4dGVuc2lvbiB0byBtaW1lIGxvb2t1cFxuXHRcdFx0Zm9yIChpaSA9IDA7IGlpIDwgZXh0Lmxlbmd0aDsgaWkrKykge1xuXHRcdFx0XHRtaW1lc1tleHRbaWldXSA9IGl0ZW1zW2ldO1xuXHRcdFx0fVxuXHRcdFx0Ly8gbWltZSB0byBleHRlbnNpb24gbG9va3VwXG5cdFx0XHRleHRlbnNpb25zW2l0ZW1zW2ldXSA9IGV4dDtcblx0XHR9XG5cdH07XG5cblxuXHR2YXIgZXh0TGlzdDJtaW1lcyA9IGZ1bmN0aW9uIChmaWx0ZXJzLCBhZGRNaXNzaW5nRXh0ZW5zaW9ucykge1xuXHRcdHZhciBleHQsIGksIGlpLCB0eXBlLCBtaW1lcyA9IFtdO1xuXG5cdFx0Ly8gY29udmVydCBleHRlbnNpb25zIHRvIG1pbWUgdHlwZXMgbGlzdFxuXHRcdGZvciAoaSA9IDA7IGkgPCBmaWx0ZXJzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRleHQgPSBmaWx0ZXJzW2ldLmV4dGVuc2lvbnMudG9Mb3dlckNhc2UoKS5zcGxpdCgvXFxzKixcXHMqLyk7XG5cblx0XHRcdGZvciAoaWkgPSAwOyBpaSA8IGV4dC5sZW5ndGg7IGlpKyspIHtcblxuXHRcdFx0XHQvLyBpZiB0aGVyZSdzIGFuIGFzdGVyaXNrIGluIHRoZSBsaXN0LCB0aGVuIGFjY2VwdCBhdHRyaWJ1dGUgaXMgbm90IHJlcXVpcmVkXG5cdFx0XHRcdGlmIChleHRbaWldID09PSAnKicpIHtcblx0XHRcdFx0XHRyZXR1cm4gW107XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR0eXBlID0gbWltZXNbZXh0W2lpXV07XG5cblx0XHRcdFx0Ly8gZnV0dXJlIGJyb3dzZXJzIHNob3VsZCBmaWx0ZXIgYnkgZXh0ZW5zaW9uLCBmaW5hbGx5XG5cdFx0XHRcdGlmIChhZGRNaXNzaW5nRXh0ZW5zaW9ucyAmJiAvXlxcdyskLy50ZXN0KGV4dFtpaV0pKSB7XG5cdFx0XHRcdFx0bWltZXMucHVzaCgnLicgKyBleHRbaWldKTtcblx0XHRcdFx0fSBlbHNlIGlmICh0eXBlICYmIEJhc2ljLmluQXJyYXkodHlwZSwgbWltZXMpID09PSAtMSkge1xuXHRcdFx0XHRcdG1pbWVzLnB1c2godHlwZSk7XG5cdFx0XHRcdH0gZWxzZSBpZiAoIXR5cGUpIHtcblx0XHRcdFx0XHQvLyBpZiB3ZSBoYXZlIG5vIHR5cGUgaW4gb3VyIG1hcCwgdGhlbiBhY2NlcHQgYWxsXG5cdFx0XHRcdFx0cmV0dXJuIFtdO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiBtaW1lcztcblx0fTtcblxuXG5cdHZhciBtaW1lczJleHRzID0gZnVuY3Rpb24obWltZXMpIHtcblx0XHR2YXIgZXh0cyA9IFtdO1xuXG5cdFx0QmFzaWMuZWFjaChtaW1lcywgZnVuY3Rpb24obWltZSkge1xuXHRcdFx0bWltZSA9IG1pbWUudG9Mb3dlckNhc2UoKTtcblxuXHRcdFx0aWYgKG1pbWUgPT09ICcqJykge1xuXHRcdFx0XHRleHRzID0gW107XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gY2hlY2sgaWYgdGhpcyB0aGluZyBsb29rcyBsaWtlIG1pbWUgdHlwZVxuXHRcdFx0dmFyIG0gPSBtaW1lLm1hdGNoKC9eKFxcdyspXFwvKFxcKnxcXHcrKSQvKTtcblx0XHRcdGlmIChtKSB7XG5cdFx0XHRcdGlmIChtWzJdID09PSAnKicpIHtcblx0XHRcdFx0XHQvLyB3aWxkY2FyZCBtaW1lIHR5cGUgZGV0ZWN0ZWRcblx0XHRcdFx0XHRCYXNpYy5lYWNoKGV4dGVuc2lvbnMsIGZ1bmN0aW9uKGFyciwgbWltZSkge1xuXHRcdFx0XHRcdFx0aWYgKChuZXcgUmVnRXhwKCdeJyArIG1bMV0gKyAnLycpKS50ZXN0KG1pbWUpKSB7XG5cdFx0XHRcdFx0XHRcdFtdLnB1c2guYXBwbHkoZXh0cywgZXh0ZW5zaW9uc1ttaW1lXSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH0gZWxzZSBpZiAoZXh0ZW5zaW9uc1ttaW1lXSkge1xuXHRcdFx0XHRcdFtdLnB1c2guYXBwbHkoZXh0cywgZXh0ZW5zaW9uc1ttaW1lXSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblx0XHRyZXR1cm4gZXh0cztcblx0fTtcblxuXG5cdHZhciBtaW1lczJleHRMaXN0ID0gZnVuY3Rpb24obWltZXMpIHtcblx0XHR2YXIgYWNjZXB0ID0gW10sIGV4dHMgPSBbXTtcblxuXHRcdGlmIChCYXNpYy50eXBlT2YobWltZXMpID09PSAnc3RyaW5nJykge1xuXHRcdFx0bWltZXMgPSBCYXNpYy50cmltKG1pbWVzKS5zcGxpdCgvXFxzKixcXHMqLyk7XG5cdFx0fVxuXG5cdFx0ZXh0cyA9IG1pbWVzMmV4dHMobWltZXMpO1xuXG5cdFx0YWNjZXB0LnB1c2goe1xuXHRcdFx0dGl0bGU6IEkxOG4udHJhbnNsYXRlKCdGaWxlcycpLFxuXHRcdFx0ZXh0ZW5zaW9uczogZXh0cy5sZW5ndGggPyBleHRzLmpvaW4oJywnKSA6ICcqJ1xuXHRcdH0pO1xuXG5cdFx0cmV0dXJuIGFjY2VwdDtcblx0fTtcblxuXHQvKipcblx0ICogRXh0cmFjdCBleHRlbnNpb24gZnJvbSB0aGUgZ2l2ZW4gZmlsZW5hbWVcblx0ICpcblx0ICogQG1ldGhvZCBnZXRGaWxlRXh0ZW5zaW9uXG5cdCAqIEBwYXJhbSB7U3RyaW5nfSBmaWxlTmFtZVxuXHQgKiBAcmV0dXJuIHtTdHJpbmd9IEZpbGUgZXh0ZW5zaW9uXG5cdCAqL1xuXHR2YXIgZ2V0RmlsZUV4dGVuc2lvbiA9IGZ1bmN0aW9uKGZpbGVOYW1lKSB7XG5cdFx0dmFyIG1hdGNoZXMgPSBmaWxlTmFtZSAmJiBmaWxlTmFtZS5tYXRjaCgvXFwuKFteLl0rKSQvKTtcblx0XHRpZiAobWF0Y2hlcykge1xuXHRcdFx0cmV0dXJuIG1hdGNoZXNbMV0udG9Mb3dlckNhc2UoKTtcblx0XHR9XG5cdFx0cmV0dXJuICcnO1xuXHR9O1xuXG5cblx0LyoqXG5cdCAqIEdldCBmaWxlIG1pbWUtdHlwZSBmcm9tIGl0J3MgZmlsZW5hbWUgLSB3aWxsIHRyeSB0byBtYXRjaCB0aGUgZXh0ZW5zaW9uXG5cdCAqIGFnYWluc3QgaW50ZXJuYWwgbWltZS10eXBlIGxvb2t1cCBtYXBcblx0ICpcblx0ICogQG1ldGhvZCBnZXRGaWxlTWltZVxuXHQgKiBAcGFyYW0ge1N0cmluZ30gZmlsZU5hbWVcblx0ICogQHJldHVybiBGaWxlIG1pbWUtdHlwZSBpZiBmb3VuZCBvciBhbiBlbXB0eSBzdHJpbmcgaWYgbm90XG5cdCAqL1xuXHR2YXIgZ2V0RmlsZU1pbWUgPSBmdW5jdGlvbihmaWxlTmFtZSkge1xuXHRcdHJldHVybiBtaW1lc1tnZXRGaWxlRXh0ZW5zaW9uKGZpbGVOYW1lKV0gfHwgJyc7XG5cdH07XG5cblxuXHRhZGRNaW1lVHlwZShtaW1lRGF0YSk7XG5cblx0cmV0dXJuIHtcblx0XHRtaW1lczogbWltZXMsXG5cdFx0ZXh0ZW5zaW9uczogZXh0ZW5zaW9ucyxcblx0XHRhZGRNaW1lVHlwZTogYWRkTWltZVR5cGUsXG5cdFx0ZXh0TGlzdDJtaW1lczogZXh0TGlzdDJtaW1lcyxcblx0XHRtaW1lczJleHRzOiBtaW1lczJleHRzLFxuXHRcdG1pbWVzMmV4dExpc3Q6IG1pbWVzMmV4dExpc3QsXG5cdFx0Z2V0RmlsZUV4dGVuc2lvbjogZ2V0RmlsZUV4dGVuc2lvbixcblx0XHRnZXRGaWxlTWltZTogZ2V0RmlsZU1pbWVcblx0fVxufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L2ZpbGUvRmlsZUlucHV0LmpzXG5cbi8qKlxuICogRmlsZUlucHV0LmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG5cbmRlZmluZSgnbW94aWUvZmlsZS9GaWxlSW5wdXQnLCBbXG5cdCdtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljJyxcblx0J21veGllL2NvcmUvdXRpbHMvRW52Jyxcblx0J21veGllL2NvcmUvdXRpbHMvTWltZScsXG5cdCdtb3hpZS9jb3JlL3V0aWxzL0RvbScsXG5cdCdtb3hpZS9jb3JlL0V4Y2VwdGlvbnMnLFxuXHQnbW94aWUvY29yZS9FdmVudFRhcmdldCcsXG5cdCdtb3hpZS9jb3JlL0kxOG4nLFxuXHQnbW94aWUvcnVudGltZS9SdW50aW1lJyxcblx0J21veGllL3J1bnRpbWUvUnVudGltZUNsaWVudCdcbl0sIGZ1bmN0aW9uKEJhc2ljLCBFbnYsIE1pbWUsIERvbSwgeCwgRXZlbnRUYXJnZXQsIEkxOG4sIFJ1bnRpbWUsIFJ1bnRpbWVDbGllbnQpIHtcblx0LyoqXG5cdFByb3ZpZGVzIGEgY29udmVuaWVudCB3YXkgdG8gY3JlYXRlIGNyb3NzLWJyb3dzZXIgZmlsZS1waWNrZXIuIEdlbmVyYXRlcyBmaWxlIHNlbGVjdGlvbiBkaWFsb2cgb24gY2xpY2ssXG5cdGNvbnZlcnRzIHNlbGVjdGVkIGZpbGVzIHRvIF9GaWxlXyBvYmplY3RzLCB0byBiZSB1c2VkIGluIGNvbmp1bmN0aW9uIHdpdGggX0ltYWdlXywgcHJlbG9hZGVkIGluIG1lbW9yeVxuXHR3aXRoIF9GaWxlUmVhZGVyXyBvciB1cGxvYWRlZCB0byBhIHNlcnZlciB0aHJvdWdoIF9YTUxIdHRwUmVxdWVzdF8uXG5cblx0QGNsYXNzIG1veGllL2ZpbGUvRmlsZUlucHV0XG5cdEBjb25zdHJ1Y3RvclxuXHRAZXh0ZW5kcyBFdmVudFRhcmdldFxuXHRAdXNlcyBSdW50aW1lQ2xpZW50XG5cdEBwYXJhbSB7T2JqZWN0fFN0cmluZ3xET01FbGVtZW50fSBvcHRpb25zIElmIG9wdGlvbnMgaXMgc3RyaW5nIG9yIG5vZGUsIGFyZ3VtZW50IGlzIGNvbnNpZGVyZWQgYXMgX2Jyb3dzZVxcX2J1dHRvbl8uXG5cdFx0QHBhcmFtIHtTdHJpbmd8RE9NRWxlbWVudH0gb3B0aW9ucy5icm93c2VfYnV0dG9uIERPTSBFbGVtZW50IHRvIHR1cm4gaW50byBmaWxlIHBpY2tlci5cblx0XHRAcGFyYW0ge0FycmF5fSBbb3B0aW9ucy5hY2NlcHRdIEFycmF5IG9mIG1pbWUgdHlwZXMgdG8gYWNjZXB0LiBCeSBkZWZhdWx0IGFjY2VwdHMgYWxsLlxuXHRcdEBwYXJhbSB7Qm9vbGVhbn0gW29wdGlvbnMubXVsdGlwbGU9ZmFsc2VdIEVuYWJsZSBzZWxlY3Rpb24gb2YgbXVsdGlwbGUgZmlsZXMuXG5cdFx0QHBhcmFtIHtCb29sZWFufSBbb3B0aW9ucy5kaXJlY3Rvcnk9ZmFsc2VdIFR1cm4gZmlsZSBpbnB1dCBpbnRvIHRoZSBmb2xkZXIgaW5wdXQgKGNhbm5vdCBiZSBib3RoIGF0IHRoZSBzYW1lIHRpbWUpLlxuXHRcdEBwYXJhbSB7U3RyaW5nfERPTUVsZW1lbnR9IFtvcHRpb25zLmNvbnRhaW5lcl0gRE9NIEVsZW1lbnQgdG8gdXNlIGFzIGEgY29udGFpbmVyIGZvciBmaWxlLXBpY2tlci4gRGVmYXVsdHMgdG8gcGFyZW50Tm9kZVxuXHRcdGZvciBfYnJvd3NlXFxfYnV0dG9uXy5cblx0XHRAcGFyYW0ge09iamVjdHxTdHJpbmd9IFtvcHRpb25zLnJlcXVpcmVkX2NhcHNdIFNldCBvZiByZXF1aXJlZCBjYXBhYmlsaXRpZXMsIHRoYXQgY2hvc2VuIHJ1bnRpbWUgbXVzdCBzdXBwb3J0LlxuXG5cdEBleGFtcGxlXG5cdFx0PGRpdiBpZD1cImNvbnRhaW5lclwiPlxuXHRcdFx0PGEgaWQ9XCJmaWxlLXBpY2tlclwiIGhyZWY9XCJqYXZhc2NyaXB0OjtcIj5Ccm93c2UuLi48L2E+XG5cdFx0PC9kaXY+XG5cblx0XHQ8c2NyaXB0PlxuXHRcdFx0dmFyIGZpbGVJbnB1dCA9IG5ldyBtb3hpZS5maWxlLkZpbGVJbnB1dCh7XG5cdFx0XHRcdGJyb3dzZV9idXR0b246ICdmaWxlLXBpY2tlcicsIC8vIG9yIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWxlLXBpY2tlcicpXG5cdFx0XHRcdGNvbnRhaW5lcjogJ2NvbnRhaW5lcicsXG5cdFx0XHRcdGFjY2VwdDogW1xuXHRcdFx0XHRcdHt0aXRsZTogXCJJbWFnZSBmaWxlc1wiLCBleHRlbnNpb25zOiBcImpwZyxnaWYscG5nXCJ9IC8vIGFjY2VwdCBvbmx5IGltYWdlc1xuXHRcdFx0XHRdLFxuXHRcdFx0XHRtdWx0aXBsZTogdHJ1ZSAvLyBhbGxvdyBtdWx0aXBsZSBmaWxlIHNlbGVjdGlvblxuXHRcdFx0fSk7XG5cblx0XHRcdGZpbGVJbnB1dC5vbmNoYW5nZSA9IGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0Ly8gZG8gc29tZXRoaW5nIHRvIGZpbGVzIGFycmF5XG5cdFx0XHRcdGNvbnNvbGUuaW5mbyhlLnRhcmdldC5maWxlcyk7IC8vIG9yIHRoaXMuZmlsZXMgb3IgZmlsZUlucHV0LmZpbGVzXG5cdFx0XHR9O1xuXG5cdFx0XHRmaWxlSW5wdXQuaW5pdCgpOyAvLyBpbml0aWFsaXplXG5cdFx0PC9zY3JpcHQ+XG5cdCovXG5cdHZhciBkaXNwYXRjaGVzID0gW1xuXHRcdC8qKlxuXHRcdERpc3BhdGNoZWQgd2hlbiBydW50aW1lIGlzIGNvbm5lY3RlZCBhbmQgZmlsZS1waWNrZXIgaXMgcmVhZHkgdG8gYmUgdXNlZC5cblxuXHRcdEBldmVudCByZWFkeVxuXHRcdEBwYXJhbSB7T2JqZWN0fSBldmVudFxuXHRcdCovXG5cdFx0J3JlYWR5JyxcblxuXHRcdC8qKlxuXHRcdERpc3BhdGNoZWQgcmlnaHQgYWZ0ZXIgW3JlYWR5XSgjZXZlbnRfcmVhZHkpIGV2ZW50LCBhbmQgd2hlbmV2ZXIgW3JlZnJlc2goKV0oI21ldGhvZF9yZWZyZXNoKSBpcyBpbnZva2VkLlxuXHRcdENoZWNrIFtjb3JyZXNwb25kaW5nIGRvY3VtZW50YXRpb24gZW50cnldKCNtZXRob2RfcmVmcmVzaCkgZm9yIG1vcmUgaW5mby5cblxuXHRcdEBldmVudCByZWZyZXNoXG5cdFx0QHBhcmFtIHtPYmplY3R9IGV2ZW50XG5cdFx0Ki9cblxuXHRcdC8qKlxuXHRcdERpc3BhdGNoZWQgd2hlbiBzZWxlY3Rpb24gb2YgZmlsZXMgaW4gdGhlIGRpYWxvZyBpcyBjb21wbGV0ZS5cblxuXHRcdEBldmVudCBjaGFuZ2Vcblx0XHRAcGFyYW0ge09iamVjdH0gZXZlbnRcblx0XHQqL1xuXHRcdCdjaGFuZ2UnLFxuXG5cdFx0J2NhbmNlbCcsIC8vIFRPRE86IG1pZ2h0IGJlIHVzZWZ1bFxuXG5cdFx0LyoqXG5cdFx0RGlzcGF0Y2hlZCB3aGVuIG1vdXNlIGN1cnNvciBlbnRlcnMgZmlsZS1waWNrZXIgYXJlYS4gQ2FuIGJlIHVzZWQgdG8gc3R5bGUgZWxlbWVudFxuXHRcdGFjY29yZGluZ2x5LlxuXG5cdFx0QGV2ZW50IG1vdXNlZW50ZXJcblx0XHRAcGFyYW0ge09iamVjdH0gZXZlbnRcblx0XHQqL1xuXHRcdCdtb3VzZWVudGVyJyxcblxuXHRcdC8qKlxuXHRcdERpc3BhdGNoZWQgd2hlbiBtb3VzZSBjdXJzb3IgbGVhdmVzIGZpbGUtcGlja2VyIGFyZWEuIENhbiBiZSB1c2VkIHRvIHN0eWxlIGVsZW1lbnRcblx0XHRhY2NvcmRpbmdseS5cblxuXHRcdEBldmVudCBtb3VzZWxlYXZlXG5cdFx0QHBhcmFtIHtPYmplY3R9IGV2ZW50XG5cdFx0Ki9cblx0XHQnbW91c2VsZWF2ZScsXG5cblx0XHQvKipcblx0XHREaXNwYXRjaGVkIHdoZW4gZnVuY3Rpb25hbCBtb3VzZSBidXR0b24gaXMgcHJlc3NlZCBvbiB0b3Agb2YgZmlsZS1waWNrZXIgYXJlYS5cblxuXHRcdEBldmVudCBtb3VzZWRvd25cblx0XHRAcGFyYW0ge09iamVjdH0gZXZlbnRcblx0XHQqL1xuXHRcdCdtb3VzZWRvd24nLFxuXG5cdFx0LyoqXG5cdFx0RGlzcGF0Y2hlZCB3aGVuIGZ1bmN0aW9uYWwgbW91c2UgYnV0dG9uIGlzIHJlbGVhc2VkIG9uIHRvcCBvZiBmaWxlLXBpY2tlciBhcmVhLlxuXG5cdFx0QGV2ZW50IG1vdXNldXBcblx0XHRAcGFyYW0ge09iamVjdH0gZXZlbnRcblx0XHQqL1xuXHRcdCdtb3VzZXVwJ1xuXHRdO1xuXG5cdGZ1bmN0aW9uIEZpbGVJbnB1dChvcHRpb25zKSB7XG5cdFx0aWYgKE1YSV9ERUJVRykge1xuXHRcdFx0RW52LmxvZyhcIkluc3RhbnRpYXRpbmcgRmlsZUlucHV0Li4uXCIpO1xuXHRcdH1cblxuXHRcdHZhciBjb250YWluZXIsIGJyb3dzZUJ1dHRvbiwgZGVmYXVsdHM7XG5cblx0XHQvLyBpZiBmbGF0IGFyZ3VtZW50IHBhc3NlZCBpdCBzaG91bGQgYmUgYnJvd3NlX2J1dHRvbiBpZFxuXHRcdGlmIChCYXNpYy5pbkFycmF5KEJhc2ljLnR5cGVPZihvcHRpb25zKSwgWydzdHJpbmcnLCAnbm9kZSddKSAhPT0gLTEpIHtcblx0XHRcdG9wdGlvbnMgPSB7IGJyb3dzZV9idXR0b24gOiBvcHRpb25zIH07XG5cdFx0fVxuXG5cdFx0Ly8gdGhpcyB3aWxsIGhlbHAgdXMgdG8gZmluZCBwcm9wZXIgZGVmYXVsdCBjb250YWluZXJcblx0XHRicm93c2VCdXR0b24gPSBEb20uZ2V0KG9wdGlvbnMuYnJvd3NlX2J1dHRvbik7XG5cdFx0aWYgKCFicm93c2VCdXR0b24pIHtcblx0XHRcdC8vIGJyb3dzZSBidXR0b24gaXMgcmVxdWlyZWRcblx0XHRcdHRocm93IG5ldyB4LkRPTUV4Y2VwdGlvbih4LkRPTUV4Y2VwdGlvbi5OT1RfRk9VTkRfRVJSKTtcblx0XHR9XG5cblx0XHQvLyBmaWd1cmUgb3V0IHRoZSBvcHRpb25zXG5cdFx0ZGVmYXVsdHMgPSB7XG5cdFx0XHRhY2NlcHQ6IFt7XG5cdFx0XHRcdHRpdGxlOiBJMThuLnRyYW5zbGF0ZSgnQWxsIEZpbGVzJyksXG5cdFx0XHRcdGV4dGVuc2lvbnM6ICcqJ1xuXHRcdFx0fV0sXG5cdFx0XHRtdWx0aXBsZTogZmFsc2UsXG5cdFx0XHRyZXF1aXJlZF9jYXBzOiBmYWxzZSxcblx0XHRcdGNvbnRhaW5lcjogYnJvd3NlQnV0dG9uLnBhcmVudE5vZGUgfHwgZG9jdW1lbnQuYm9keVxuXHRcdH07XG5cblx0XHRvcHRpb25zID0gQmFzaWMuZXh0ZW5kKHt9LCBkZWZhdWx0cywgb3B0aW9ucyk7XG5cblx0XHQvLyBjb252ZXJ0IHRvIG9iamVjdCByZXByZXNlbnRhdGlvblxuXHRcdGlmICh0eXBlb2Yob3B0aW9ucy5yZXF1aXJlZF9jYXBzKSA9PT0gJ3N0cmluZycpIHtcblx0XHRcdG9wdGlvbnMucmVxdWlyZWRfY2FwcyA9IFJ1bnRpbWUucGFyc2VDYXBzKG9wdGlvbnMucmVxdWlyZWRfY2Fwcyk7XG5cdFx0fVxuXG5cdFx0Ly8gbm9ybWFsaXplIGFjY2VwdCBvcHRpb24gKGNvdWxkIGJlIGxpc3Qgb2YgbWltZSB0eXBlcyBvciBhcnJheSBvZiB0aXRsZS9leHRlbnNpb25zIHBhaXJzKVxuXHRcdGlmICh0eXBlb2Yob3B0aW9ucy5hY2NlcHQpID09PSAnc3RyaW5nJykge1xuXHRcdFx0b3B0aW9ucy5hY2NlcHQgPSBNaW1lLm1pbWVzMmV4dExpc3Qob3B0aW9ucy5hY2NlcHQpO1xuXHRcdH1cblxuXHRcdGNvbnRhaW5lciA9IERvbS5nZXQob3B0aW9ucy5jb250YWluZXIpO1xuXHRcdC8vIG1ha2Ugc3VyZSB3ZSBoYXZlIGNvbnRhaW5lclxuXHRcdGlmICghY29udGFpbmVyKSB7XG5cdFx0XHRjb250YWluZXIgPSBkb2N1bWVudC5ib2R5O1xuXHRcdH1cblxuXHRcdC8vIG1ha2UgY29udGFpbmVyIHJlbGF0aXZlLCBpZiBpdCdzIG5vdFxuXHRcdGlmIChEb20uZ2V0U3R5bGUoY29udGFpbmVyLCAncG9zaXRpb24nKSA9PT0gJ3N0YXRpYycpIHtcblx0XHRcdGNvbnRhaW5lci5zdHlsZS5wb3NpdGlvbiA9ICdyZWxhdGl2ZSc7XG5cdFx0fVxuXG5cdFx0Y29udGFpbmVyID0gYnJvd3NlQnV0dG9uID0gbnVsbDsgLy8gSUVcblxuXHRcdFJ1bnRpbWVDbGllbnQuY2FsbCh0aGlzKTtcblxuXHRcdEJhc2ljLmV4dGVuZCh0aGlzLCB7XG5cdFx0XHQvKipcblx0XHRcdFVuaXF1ZSBpZCBvZiB0aGUgY29tcG9uZW50XG5cblx0XHRcdEBwcm9wZXJ0eSB1aWRcblx0XHRcdEBwcm90ZWN0ZWRcblx0XHRcdEByZWFkT25seVxuXHRcdFx0QHR5cGUge1N0cmluZ31cblx0XHRcdEBkZWZhdWx0IFVJRFxuXHRcdFx0Ki9cblx0XHRcdHVpZDogQmFzaWMuZ3VpZCgndWlkXycpLFxuXG5cdFx0XHQvKipcblx0XHRcdFVuaXF1ZSBpZCBvZiB0aGUgY29ubmVjdGVkIHJ1bnRpbWUsIGlmIGFueS5cblxuXHRcdFx0QHByb3BlcnR5IHJ1aWRcblx0XHRcdEBwcm90ZWN0ZWRcblx0XHRcdEB0eXBlIHtTdHJpbmd9XG5cdFx0XHQqL1xuXHRcdFx0cnVpZDogbnVsbCxcblxuXHRcdFx0LyoqXG5cdFx0XHRVbmlxdWUgaWQgb2YgdGhlIHJ1bnRpbWUgY29udGFpbmVyLiBVc2VmdWwgdG8gZ2V0IGhvbGQgb2YgaXQgZm9yIHZhcmlvdXMgbWFuaXB1bGF0aW9ucy5cblxuXHRcdFx0QHByb3BlcnR5IHNoaW1pZFxuXHRcdFx0QHByb3RlY3RlZFxuXHRcdFx0QHR5cGUge1N0cmluZ31cblx0XHRcdCovXG5cdFx0XHRzaGltaWQ6IG51bGwsXG5cblx0XHRcdC8qKlxuXHRcdFx0QXJyYXkgb2Ygc2VsZWN0ZWQgbW94aWUuZmlsZS5GaWxlIG9iamVjdHNcblxuXHRcdFx0QHByb3BlcnR5IGZpbGVzXG5cdFx0XHRAdHlwZSB7QXJyYXl9XG5cdFx0XHRAZGVmYXVsdCBudWxsXG5cdFx0XHQqL1xuXHRcdFx0ZmlsZXM6IG51bGwsXG5cblx0XHRcdC8qKlxuXHRcdFx0SW5pdGlhbGl6ZXMgdGhlIGZpbGUtcGlja2VyLCBjb25uZWN0cyBpdCB0byBydW50aW1lIGFuZCBkaXNwYXRjaGVzIGV2ZW50IHJlYWR5IHdoZW4gZG9uZS5cblxuXHRcdFx0QG1ldGhvZCBpbml0XG5cdFx0XHQqL1xuXHRcdFx0aW5pdDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciBzZWxmID0gdGhpcztcblxuXHRcdFx0XHRzZWxmLmJpbmQoJ1J1bnRpbWVJbml0JywgZnVuY3Rpb24oZSwgcnVudGltZSkge1xuXHRcdFx0XHRcdHNlbGYucnVpZCA9IHJ1bnRpbWUudWlkO1xuXHRcdFx0XHRcdHNlbGYuc2hpbWlkID0gcnVudGltZS5zaGltaWQ7XG5cblx0XHRcdFx0XHRzZWxmLmJpbmQoXCJSZWFkeVwiLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdHNlbGYudHJpZ2dlcihcIlJlZnJlc2hcIik7XG5cdFx0XHRcdFx0fSwgOTk5KTtcblxuXHRcdFx0XHRcdC8vIHJlLXBvc2l0aW9uIGFuZCByZXNpemUgc2hpbSBjb250YWluZXJcblx0XHRcdFx0XHRzZWxmLmJpbmQoJ1JlZnJlc2gnLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdHZhciBwb3MsIHNpemUsIGJyb3dzZUJ1dHRvbiwgc2hpbUNvbnRhaW5lciwgekluZGV4O1xuXG5cdFx0XHRcdFx0XHRicm93c2VCdXR0b24gPSBEb20uZ2V0KG9wdGlvbnMuYnJvd3NlX2J1dHRvbik7XG5cdFx0XHRcdFx0XHRzaGltQ29udGFpbmVyID0gRG9tLmdldChydW50aW1lLnNoaW1pZCk7IC8vIGRvIG5vdCB1c2UgcnVudGltZS5nZXRTaGltQ29udGFpbmVyKCksIHNpbmNlIGl0IHdpbGwgY3JlYXRlIGNvbnRhaW5lciBpZiBpdCBkb2Vzbid0IGV4aXN0XG5cblx0XHRcdFx0XHRcdGlmIChicm93c2VCdXR0b24pIHtcblx0XHRcdFx0XHRcdFx0cG9zID0gRG9tLmdldFBvcyhicm93c2VCdXR0b24sIERvbS5nZXQob3B0aW9ucy5jb250YWluZXIpKTtcblx0XHRcdFx0XHRcdFx0c2l6ZSA9IERvbS5nZXRTaXplKGJyb3dzZUJ1dHRvbik7XG5cdFx0XHRcdFx0XHRcdHpJbmRleCA9IHBhcnNlSW50KERvbS5nZXRTdHlsZShicm93c2VCdXR0b24sICd6LWluZGV4JyksIDEwKSB8fCAwO1xuXG5cdFx0XHRcdFx0XHRcdGlmIChzaGltQ29udGFpbmVyKSB7XG5cdFx0XHRcdFx0XHRcdFx0QmFzaWMuZXh0ZW5kKHNoaW1Db250YWluZXIuc3R5bGUsIHtcblx0XHRcdFx0XHRcdFx0XHRcdHRvcDogcG9zLnkgKyAncHgnLFxuXHRcdFx0XHRcdFx0XHRcdFx0bGVmdDogcG9zLnggKyAncHgnLFxuXHRcdFx0XHRcdFx0XHRcdFx0d2lkdGg6IHNpemUudyArICdweCcsXG5cdFx0XHRcdFx0XHRcdFx0XHRoZWlnaHQ6IHNpemUuaCArICdweCcsXG5cdFx0XHRcdFx0XHRcdFx0XHR6SW5kZXg6IHpJbmRleCArIDFcblx0XHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0c2hpbUNvbnRhaW5lciA9IGJyb3dzZUJ1dHRvbiA9IG51bGw7XG5cdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0XHRydW50aW1lLmV4ZWMuY2FsbChzZWxmLCAnRmlsZUlucHV0JywgJ2luaXQnLCBvcHRpb25zKTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0Ly8gcnVudGltZSBuZWVkczogb3B0aW9ucy5yZXF1aXJlZF9mZWF0dXJlcywgb3B0aW9ucy5ydW50aW1lX29yZGVyIGFuZCBvcHRpb25zLmNvbnRhaW5lclxuXHRcdFx0XHRzZWxmLmNvbm5lY3RSdW50aW1lKEJhc2ljLmV4dGVuZCh7fSwgb3B0aW9ucywge1xuXHRcdFx0XHRcdHJlcXVpcmVkX2NhcHM6IHtcblx0XHRcdFx0XHRcdHNlbGVjdF9maWxlOiB0cnVlXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KSk7XG5cdFx0XHR9LFxuXG5cblx0XHRcdC8qKlxuXHRcdFx0ICogR2V0IGN1cnJlbnQgb3B0aW9uIHZhbHVlIGJ5IGl0cyBuYW1lXG5cdFx0XHQgKlxuXHRcdFx0ICogQG1ldGhvZCBnZXRPcHRpb25cblx0XHRcdCAqIEBwYXJhbSBuYW1lXG5cdFx0XHQgKiBAcmV0dXJuIHtNaXhlZH1cblx0XHRcdCAqL1xuXHRcdFx0Z2V0T3B0aW9uOiBmdW5jdGlvbihuYW1lKSB7XG5cdFx0XHRcdHJldHVybiBvcHRpb25zW25hbWVdO1xuXHRcdFx0fSxcblxuXG5cdFx0XHQvKipcblx0XHRcdCAqIFNldHMgYSBuZXcgdmFsdWUgZm9yIHRoZSBvcHRpb24gc3BlY2lmaWVkIGJ5IG5hbWVcblx0XHRcdCAqXG5cdFx0XHQgKiBAbWV0aG9kIHNldE9wdGlvblxuXHRcdFx0ICogQHBhcmFtIG5hbWVcblx0XHRcdCAqIEBwYXJhbSB2YWx1ZVxuXHRcdFx0ICovXG5cdFx0XHRzZXRPcHRpb246IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7XG5cdFx0XHRcdGlmICghb3B0aW9ucy5oYXNPd25Qcm9wZXJ0eShuYW1lKSkge1xuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHZhciBvbGRWYWx1ZSA9IG9wdGlvbnNbbmFtZV07XG5cblx0XHRcdFx0c3dpdGNoIChuYW1lKSB7XG5cdFx0XHRcdFx0Y2FzZSAnYWNjZXB0Jzpcblx0XHRcdFx0XHRcdGlmICh0eXBlb2YodmFsdWUpID09PSAnc3RyaW5nJykge1xuXHRcdFx0XHRcdFx0XHR2YWx1ZSA9IE1pbWUubWltZXMyZXh0TGlzdCh2YWx1ZSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRcdGNhc2UgJ2NvbnRhaW5lcic6XG5cdFx0XHRcdFx0Y2FzZSAncmVxdWlyZWRfY2Fwcyc6XG5cdFx0XHRcdFx0XHR0aHJvdyBuZXcgeC5GaWxlRXhjZXB0aW9uKHguRmlsZUV4Y2VwdGlvbi5OT19NT0RJRklDQVRJT05fQUxMT1dFRF9FUlIpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0b3B0aW9uc1tuYW1lXSA9IHZhbHVlO1xuXHRcdFx0XHR0aGlzLmV4ZWMoJ0ZpbGVJbnB1dCcsICdzZXRPcHRpb24nLCBuYW1lLCB2YWx1ZSk7XG5cblx0XHRcdFx0dGhpcy50cmlnZ2VyKCdPcHRpb25DaGFuZ2VkJywgbmFtZSwgdmFsdWUsIG9sZFZhbHVlKTtcblx0XHRcdH0sXG5cblx0XHRcdC8qKlxuXHRcdFx0RGlzYWJsZXMgZmlsZS1waWNrZXIgZWxlbWVudCwgc28gdGhhdCBpdCBkb2Vzbid0IHJlYWN0IHRvIG1vdXNlIGNsaWNrcy5cblxuXHRcdFx0QG1ldGhvZCBkaXNhYmxlXG5cdFx0XHRAcGFyYW0ge0Jvb2xlYW59IFtzdGF0ZT10cnVlXSBEaXNhYmxlIGNvbXBvbmVudCBpZiAtIHRydWUsIGVuYWJsZSBpZiAtIGZhbHNlXG5cdFx0XHQqL1xuXHRcdFx0ZGlzYWJsZTogZnVuY3Rpb24oc3RhdGUpIHtcblx0XHRcdFx0dmFyIHJ1bnRpbWUgPSB0aGlzLmdldFJ1bnRpbWUoKTtcblx0XHRcdFx0aWYgKHJ1bnRpbWUpIHtcblx0XHRcdFx0XHR0aGlzLmV4ZWMoJ0ZpbGVJbnB1dCcsICdkaXNhYmxlJywgQmFzaWMudHlwZU9mKHN0YXRlKSA9PT0gJ3VuZGVmaW5lZCcgPyB0cnVlIDogc3RhdGUpO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXG5cblx0XHRcdC8qKlxuXHRcdFx0UmVwb3NpdGlvbiBhbmQgcmVzaXplIGRpYWxvZyB0cmlnZ2VyIHRvIG1hdGNoIHRoZSBwb3NpdGlvbiBhbmQgc2l6ZSBvZiBicm93c2VfYnV0dG9uIGVsZW1lbnQuXG5cblx0XHRcdEBtZXRob2QgcmVmcmVzaFxuXHRcdFx0Ki9cblx0XHRcdHJlZnJlc2g6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR0aGlzLnRyaWdnZXIoXCJSZWZyZXNoXCIpO1xuXHRcdFx0fSxcblxuXG5cdFx0XHQvKipcblx0XHRcdERlc3Ryb3kgY29tcG9uZW50LlxuXG5cdFx0XHRAbWV0aG9kIGRlc3Ryb3lcblx0XHRcdCovXG5cdFx0XHRkZXN0cm95OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIHJ1bnRpbWUgPSB0aGlzLmdldFJ1bnRpbWUoKTtcblx0XHRcdFx0aWYgKHJ1bnRpbWUpIHtcblx0XHRcdFx0XHRydW50aW1lLmV4ZWMuY2FsbCh0aGlzLCAnRmlsZUlucHV0JywgJ2Rlc3Ryb3knKTtcblx0XHRcdFx0XHR0aGlzLmRpc2Nvbm5lY3RSdW50aW1lKCk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoQmFzaWMudHlwZU9mKHRoaXMuZmlsZXMpID09PSAnYXJyYXknKSB7XG5cdFx0XHRcdFx0Ly8gbm8gc2Vuc2UgaW4gbGVhdmluZyBhc3NvY2lhdGVkIGZpbGVzIGJlaGluZFxuXHRcdFx0XHRcdEJhc2ljLmVhY2godGhpcy5maWxlcywgZnVuY3Rpb24oZmlsZSkge1xuXHRcdFx0XHRcdFx0ZmlsZS5kZXN0cm95KCk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0dGhpcy5maWxlcyA9IG51bGw7XG5cblx0XHRcdFx0dGhpcy51bmJpbmRBbGwoKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHRoaXMuaGFuZGxlRXZlbnRQcm9wcyhkaXNwYXRjaGVzKTtcblx0fVxuXG5cdEZpbGVJbnB1dC5wcm90b3R5cGUgPSBFdmVudFRhcmdldC5pbnN0YW5jZTtcblxuXHRyZXR1cm4gRmlsZUlucHV0O1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L2ZpbGUvRmlsZS5qc1xuXG4vKipcbiAqIEZpbGUuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuZGVmaW5lKCdtb3hpZS9maWxlL0ZpbGUnLCBbXG5cdCdtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljJyxcblx0J21veGllL2NvcmUvdXRpbHMvTWltZScsXG5cdCdtb3hpZS9maWxlL0Jsb2InXG5dLCBmdW5jdGlvbihCYXNpYywgTWltZSwgQmxvYikge1xuXHQvKipcblx0QGNsYXNzIG1veGllL2ZpbGUvRmlsZVxuXHRAZXh0ZW5kcyBCbG9iXG5cdEBjb25zdHJ1Y3RvclxuXHRAcGFyYW0ge1N0cmluZ30gcnVpZCBVbmlxdWUgaWQgb2YgdGhlIHJ1bnRpbWUsIHRvIHdoaWNoIHRoaXMgYmxvYiBiZWxvbmdzIHRvXG5cdEBwYXJhbSB7T2JqZWN0fSBmaWxlIE9iamVjdCBcIk5hdGl2ZVwiIGZpbGUgb2JqZWN0LCBhcyBpdCBpcyByZXByZXNlbnRlZCBpbiB0aGUgcnVudGltZVxuXHQqL1xuXHRmdW5jdGlvbiBGaWxlKHJ1aWQsIGZpbGUpIHtcblx0XHRpZiAoIWZpbGUpIHsgLy8gYXZvaWQgZXh0cmEgZXJyb3JzIGluIGNhc2Ugd2Ugb3Zlcmxvb2tlZCBzb21ldGhpbmdcblx0XHRcdGZpbGUgPSB7fTtcblx0XHR9XG5cblx0XHRCbG9iLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cblx0XHRpZiAoIXRoaXMudHlwZSkge1xuXHRcdFx0dGhpcy50eXBlID0gTWltZS5nZXRGaWxlTWltZShmaWxlLm5hbWUpO1xuXHRcdH1cblxuXHRcdC8vIHNhbml0aXplIGZpbGUgbmFtZSBvciBnZW5lcmF0ZSBuZXcgb25lXG5cdFx0dmFyIG5hbWU7XG5cdFx0aWYgKGZpbGUubmFtZSkge1xuXHRcdFx0bmFtZSA9IGZpbGUubmFtZS5yZXBsYWNlKC9cXFxcL2csICcvJyk7XG5cdFx0XHRuYW1lID0gbmFtZS5zdWJzdHIobmFtZS5sYXN0SW5kZXhPZignLycpICsgMSk7XG5cdFx0fSBlbHNlIGlmICh0aGlzLnR5cGUpIHtcblx0XHRcdHZhciBwcmVmaXggPSB0aGlzLnR5cGUuc3BsaXQoJy8nKVswXTtcblx0XHRcdG5hbWUgPSBCYXNpYy5ndWlkKChwcmVmaXggIT09ICcnID8gcHJlZml4IDogJ2ZpbGUnKSArICdfJyk7XG5cdFx0XHRcblx0XHRcdGlmIChNaW1lLmV4dGVuc2lvbnNbdGhpcy50eXBlXSkge1xuXHRcdFx0XHRuYW1lICs9ICcuJyArIE1pbWUuZXh0ZW5zaW9uc1t0aGlzLnR5cGVdWzBdOyAvLyBhcHBlbmQgcHJvcGVyIGV4dGVuc2lvbiBpZiBwb3NzaWJsZVxuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHRcblx0XHRCYXNpYy5leHRlbmQodGhpcywge1xuXHRcdFx0LyoqXG5cdFx0XHRGaWxlIG5hbWVcblxuXHRcdFx0QHByb3BlcnR5IG5hbWVcblx0XHRcdEB0eXBlIHtTdHJpbmd9XG5cdFx0XHRAZGVmYXVsdCBVSURcblx0XHRcdCovXG5cdFx0XHRuYW1lOiBuYW1lIHx8IEJhc2ljLmd1aWQoJ2ZpbGVfJyksXG5cblx0XHRcdC8qKlxuXHRcdFx0UmVsYXRpdmUgcGF0aCB0byB0aGUgZmlsZSBpbnNpZGUgYSBkaXJlY3RvcnlcblxuXHRcdFx0QHByb3BlcnR5IHJlbGF0aXZlUGF0aFxuXHRcdFx0QHR5cGUge1N0cmluZ31cblx0XHRcdEBkZWZhdWx0ICcnXG5cdFx0XHQqL1xuXHRcdFx0cmVsYXRpdmVQYXRoOiAnJyxcblx0XHRcdFxuXHRcdFx0LyoqXG5cdFx0XHREYXRlIG9mIGxhc3QgbW9kaWZpY2F0aW9uXG5cblx0XHRcdEBwcm9wZXJ0eSBsYXN0TW9kaWZpZWREYXRlXG5cdFx0XHRAdHlwZSB7U3RyaW5nfVxuXHRcdFx0QGRlZmF1bHQgbm93XG5cdFx0XHQqL1xuXHRcdFx0bGFzdE1vZGlmaWVkRGF0ZTogZmlsZS5sYXN0TW9kaWZpZWREYXRlIHx8IChuZXcgRGF0ZSgpKS50b0xvY2FsZVN0cmluZygpIC8vIFRodSBBdWcgMjMgMjAxMiAxOTo0MDowMCBHTVQrMDQwMCAoR0VUKVxuXHRcdH0pO1xuXHR9XG5cblx0RmlsZS5wcm90b3R5cGUgPSBCbG9iLnByb3RvdHlwZTtcblxuXHRyZXR1cm4gRmlsZTtcbn0pO1xuXG4vLyBJbmNsdWRlZCBmcm9tOiBzcmMvamF2YXNjcmlwdC9maWxlL0ZpbGVEcm9wLmpzXG5cbi8qKlxuICogRmlsZURyb3AuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuZGVmaW5lKCdtb3hpZS9maWxlL0ZpbGVEcm9wJywgW1xuXHQnbW94aWUvY29yZS9JMThuJyxcblx0J21veGllL2NvcmUvdXRpbHMvRG9tJyxcblx0J21veGllL2NvcmUvRXhjZXB0aW9ucycsXG5cdCdtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljJyxcblx0J21veGllL2NvcmUvdXRpbHMvRW52Jyxcblx0J21veGllL2ZpbGUvRmlsZScsXG5cdCdtb3hpZS9ydW50aW1lL1J1bnRpbWVDbGllbnQnLFxuXHQnbW94aWUvY29yZS9FdmVudFRhcmdldCcsXG5cdCdtb3hpZS9jb3JlL3V0aWxzL01pbWUnXG5dLCBmdW5jdGlvbihJMThuLCBEb20sIHgsIEJhc2ljLCBFbnYsIEZpbGUsIFJ1bnRpbWVDbGllbnQsIEV2ZW50VGFyZ2V0LCBNaW1lKSB7XG5cdC8qKlxuXHRUdXJuIGFyYml0cmFyeSBET00gZWxlbWVudCB0byBhIGRyb3Agem9uZSBhY2NlcHRpbmcgZmlsZXMuIENvbnZlcnRzIHNlbGVjdGVkIGZpbGVzIHRvIF9GaWxlXyBvYmplY3RzLCB0byBiZSB1c2VkIFxuXHRpbiBjb25qdW5jdGlvbiB3aXRoIF9JbWFnZV8sIHByZWxvYWRlZCBpbiBtZW1vcnkgd2l0aCBfRmlsZVJlYWRlcl8gb3IgdXBsb2FkZWQgdG8gYSBzZXJ2ZXIgdGhyb3VnaCBcblx0X1hNTEh0dHBSZXF1ZXN0Xy5cblxuXHRAZXhhbXBsZVxuXHRcdDxkaXYgaWQ9XCJkcm9wX3pvbmVcIj5cblx0XHRcdERyb3AgZmlsZXMgaGVyZVxuXHRcdDwvZGl2PlxuXHRcdDxiciAvPlxuXHRcdDxkaXYgaWQ9XCJmaWxlbGlzdFwiPjwvZGl2PlxuXG5cdFx0PHNjcmlwdCB0eXBlPVwidGV4dC9qYXZhc2NyaXB0XCI+XG5cdFx0XHR2YXIgZmlsZURyb3AgPSBuZXcgbW94aWUuZmlsZS5GaWxlRHJvcCgnZHJvcF96b25lJyksIGZpbGVMaXN0ID0gbW94aWUudXRpbHMuRG9tLmdldCgnZmlsZWxpc3QnKTtcblxuXHRcdFx0ZmlsZURyb3Aub25kcm9wID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdG1veGllLnV0aWxzLkJhc2ljLmVhY2godGhpcy5maWxlcywgZnVuY3Rpb24oZmlsZSkge1xuXHRcdFx0XHRcdGZpbGVMaXN0LmlubmVySFRNTCArPSAnPGRpdj4nICsgZmlsZS5uYW1lICsgJzwvZGl2Pic7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fTtcblxuXHRcdFx0ZmlsZURyb3AuaW5pdCgpO1xuXHRcdDwvc2NyaXB0PlxuXG5cdEBjbGFzcyBtb3hpZS9maWxlL0ZpbGVEcm9wXG5cdEBjb25zdHJ1Y3RvclxuXHRAZXh0ZW5kcyBFdmVudFRhcmdldFxuXHRAdXNlcyBSdW50aW1lQ2xpZW50XG5cdEBwYXJhbSB7T2JqZWN0fFN0cmluZ30gb3B0aW9ucyBJZiBvcHRpb25zIGhhcyB0eXBlb2Ygc3RyaW5nLCBhcmd1bWVudCBpcyBjb25zaWRlcmVkIGFzIG9wdGlvbnMuZHJvcF96b25lXG5cdFx0QHBhcmFtIHtTdHJpbmd8RE9NRWxlbWVudH0gb3B0aW9ucy5kcm9wX3pvbmUgRE9NIEVsZW1lbnQgdG8gdHVybiBpbnRvIGEgZHJvcCB6b25lXG5cdFx0QHBhcmFtIHtBcnJheX0gW29wdGlvbnMuYWNjZXB0XSBBcnJheSBvZiBtaW1lIHR5cGVzIHRvIGFjY2VwdC4gQnkgZGVmYXVsdCBhY2NlcHRzIGFsbFxuXHRcdEBwYXJhbSB7T2JqZWN0fFN0cmluZ30gW29wdGlvbnMucmVxdWlyZWRfY2Fwc10gU2V0IG9mIHJlcXVpcmVkIGNhcGFiaWxpdGllcywgdGhhdCBjaG9zZW4gcnVudGltZSBtdXN0IHN1cHBvcnRcblx0Ki9cblx0dmFyIGRpc3BhdGNoZXMgPSBbXG5cdFx0LyoqXG5cdFx0RGlzcGF0Y2hlZCB3aGVuIHJ1bnRpbWUgaXMgY29ubmVjdGVkIGFuZCBkcm9wIHpvbmUgaXMgcmVhZHkgdG8gYWNjZXB0IGZpbGVzLlxuXG5cdFx0QGV2ZW50IHJlYWR5XG5cdFx0QHBhcmFtIHtPYmplY3R9IGV2ZW50XG5cdFx0Ki9cblx0XHQncmVhZHknLCBcblxuXHRcdC8qKlxuXHRcdERpc3BhdGNoZWQgd2hlbiBkcmFnZ2luZyBjdXJzb3IgZW50ZXJzIHRoZSBkcm9wIHpvbmUuXG5cblx0XHRAZXZlbnQgZHJhZ2VudGVyXG5cdFx0QHBhcmFtIHtPYmplY3R9IGV2ZW50XG5cdFx0Ki9cblx0XHQnZHJhZ2VudGVyJyxcblxuXHRcdC8qKlxuXHRcdERpc3BhdGNoZWQgd2hlbiBkcmFnZ2luZyBjdXJzb3IgbGVhdmVzIHRoZSBkcm9wIHpvbmUuXG5cblx0XHRAZXZlbnQgZHJhZ2xlYXZlXG5cdFx0QHBhcmFtIHtPYmplY3R9IGV2ZW50XG5cdFx0Ki9cblx0XHQnZHJhZ2xlYXZlJywgXG5cblx0XHQvKipcblx0XHREaXNwYXRjaGVkIHdoZW4gZmlsZSBpcyBkcm9wcGVkIG9udG8gdGhlIGRyb3Agem9uZS5cblxuXHRcdEBldmVudCBkcm9wXG5cdFx0QHBhcmFtIHtPYmplY3R9IGV2ZW50XG5cdFx0Ki9cblx0XHQnZHJvcCcsIFxuXG5cdFx0LyoqXG5cdFx0RGlzcGF0Y2hlZCBpZiBlcnJvciBvY2N1cnMuXG5cblx0XHRAZXZlbnQgZXJyb3Jcblx0XHRAcGFyYW0ge09iamVjdH0gZXZlbnRcblx0XHQqL1xuXHRcdCdlcnJvcidcblx0XTtcblxuXHRmdW5jdGlvbiBGaWxlRHJvcChvcHRpb25zKSB7XG5cdFx0aWYgKE1YSV9ERUJVRykge1xuXHRcdFx0RW52LmxvZyhcIkluc3RhbnRpYXRpbmcgRmlsZURyb3AuLi5cIik7XHRcblx0XHR9XG5cblx0XHR2YXIgc2VsZiA9IHRoaXMsIGRlZmF1bHRzO1xuXG5cdFx0Ly8gaWYgZmxhdCBhcmd1bWVudCBwYXNzZWQgaXQgc2hvdWxkIGJlIGRyb3Bfem9uZSBpZFxuXHRcdGlmICh0eXBlb2Yob3B0aW9ucykgPT09ICdzdHJpbmcnKSB7XG5cdFx0XHRvcHRpb25zID0geyBkcm9wX3pvbmUgOiBvcHRpb25zIH07XG5cdFx0fVxuXG5cdFx0Ly8gZmlndXJlIG91dCB0aGUgb3B0aW9uc1xuXHRcdGRlZmF1bHRzID0ge1xuXHRcdFx0YWNjZXB0OiBbe1xuXHRcdFx0XHR0aXRsZTogSTE4bi50cmFuc2xhdGUoJ0FsbCBGaWxlcycpLFxuXHRcdFx0XHRleHRlbnNpb25zOiAnKidcblx0XHRcdH1dLFxuXHRcdFx0cmVxdWlyZWRfY2Fwczoge1xuXHRcdFx0XHRkcmFnX2FuZF9kcm9wOiB0cnVlXG5cdFx0XHR9XG5cdFx0fTtcblx0XHRcblx0XHRvcHRpb25zID0gdHlwZW9mKG9wdGlvbnMpID09PSAnb2JqZWN0JyA/IEJhc2ljLmV4dGVuZCh7fSwgZGVmYXVsdHMsIG9wdGlvbnMpIDogZGVmYXVsdHM7XG5cblx0XHQvLyB0aGlzIHdpbGwgaGVscCB1cyB0byBmaW5kIHByb3BlciBkZWZhdWx0IGNvbnRhaW5lclxuXHRcdG9wdGlvbnMuY29udGFpbmVyID0gRG9tLmdldChvcHRpb25zLmRyb3Bfem9uZSkgfHwgZG9jdW1lbnQuYm9keTtcblxuXHRcdC8vIG1ha2UgY29udGFpbmVyIHJlbGF0aXZlLCBpZiBpdCBpcyBub3Rcblx0XHRpZiAoRG9tLmdldFN0eWxlKG9wdGlvbnMuY29udGFpbmVyLCAncG9zaXRpb24nKSA9PT0gJ3N0YXRpYycpIHtcblx0XHRcdG9wdGlvbnMuY29udGFpbmVyLnN0eWxlLnBvc2l0aW9uID0gJ3JlbGF0aXZlJztcblx0XHR9XG5cdFx0XHRcdFx0XG5cdFx0Ly8gbm9ybWFsaXplIGFjY2VwdCBvcHRpb24gKGNvdWxkIGJlIGxpc3Qgb2YgbWltZSB0eXBlcyBvciBhcnJheSBvZiB0aXRsZS9leHRlbnNpb25zIHBhaXJzKVxuXHRcdGlmICh0eXBlb2Yob3B0aW9ucy5hY2NlcHQpID09PSAnc3RyaW5nJykge1xuXHRcdFx0b3B0aW9ucy5hY2NlcHQgPSBNaW1lLm1pbWVzMmV4dExpc3Qob3B0aW9ucy5hY2NlcHQpO1xuXHRcdH1cblxuXHRcdFJ1bnRpbWVDbGllbnQuY2FsbChzZWxmKTtcblxuXHRcdEJhc2ljLmV4dGVuZChzZWxmLCB7XG5cdFx0XHR1aWQ6IEJhc2ljLmd1aWQoJ3VpZF8nKSxcblxuXHRcdFx0cnVpZDogbnVsbCxcblxuXHRcdFx0ZmlsZXM6IG51bGwsXG5cblx0XHRcdGluaXQ6IGZ1bmN0aW9uKCkge1x0XHRcblx0XHRcdFx0c2VsZi5iaW5kKCdSdW50aW1lSW5pdCcsIGZ1bmN0aW9uKGUsIHJ1bnRpbWUpIHtcblx0XHRcdFx0XHRzZWxmLnJ1aWQgPSBydW50aW1lLnVpZDtcblx0XHRcdFx0XHRydW50aW1lLmV4ZWMuY2FsbChzZWxmLCAnRmlsZURyb3AnLCAnaW5pdCcsIG9wdGlvbnMpO1xuXHRcdFx0XHRcdHNlbGYuZGlzcGF0Y2hFdmVudCgncmVhZHknKTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRcdFxuXHRcdFx0XHQvLyBydW50aW1lIG5lZWRzOiBvcHRpb25zLnJlcXVpcmVkX2ZlYXR1cmVzLCBvcHRpb25zLnJ1bnRpbWVfb3JkZXIgYW5kIG9wdGlvbnMuY29udGFpbmVyXG5cdFx0XHRcdHNlbGYuY29ubmVjdFJ1bnRpbWUob3B0aW9ucyk7IC8vIHRocm93cyBSdW50aW1lRXJyb3Jcblx0XHRcdH0sXG5cblx0XHRcdGRlc3Ryb3k6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR2YXIgcnVudGltZSA9IHRoaXMuZ2V0UnVudGltZSgpO1xuXHRcdFx0XHRpZiAocnVudGltZSkge1xuXHRcdFx0XHRcdHJ1bnRpbWUuZXhlYy5jYWxsKHRoaXMsICdGaWxlRHJvcCcsICdkZXN0cm95Jyk7XG5cdFx0XHRcdFx0dGhpcy5kaXNjb25uZWN0UnVudGltZSgpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHRoaXMuZmlsZXMgPSBudWxsO1xuXHRcdFx0XHRcblx0XHRcdFx0dGhpcy51bmJpbmRBbGwoKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHRoaXMuaGFuZGxlRXZlbnRQcm9wcyhkaXNwYXRjaGVzKTtcblx0fVxuXG5cdEZpbGVEcm9wLnByb3RvdHlwZSA9IEV2ZW50VGFyZ2V0Lmluc3RhbmNlO1xuXG5cdHJldHVybiBGaWxlRHJvcDtcbn0pO1xuXG4vLyBJbmNsdWRlZCBmcm9tOiBzcmMvamF2YXNjcmlwdC9maWxlL0ZpbGVSZWFkZXIuanNcblxuLyoqXG4gKiBGaWxlUmVhZGVyLmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG5cbmRlZmluZSgnbW94aWUvZmlsZS9GaWxlUmVhZGVyJywgW1xuXHQnbW94aWUvY29yZS91dGlscy9CYXNpYycsXG5cdCdtb3hpZS9jb3JlL3V0aWxzL0VuY29kZScsXG5cdCdtb3hpZS9jb3JlL0V4Y2VwdGlvbnMnLFxuXHQnbW94aWUvY29yZS9FdmVudFRhcmdldCcsXG5cdCdtb3hpZS9maWxlL0Jsb2InLFxuXHQnbW94aWUvcnVudGltZS9SdW50aW1lQ2xpZW50J1xuXSwgZnVuY3Rpb24oQmFzaWMsIEVuY29kZSwgeCwgRXZlbnRUYXJnZXQsIEJsb2IsIFJ1bnRpbWVDbGllbnQpIHtcblx0LyoqXG5cdFV0aWxpdHkgZm9yIHByZWxvYWRpbmcgby5CbG9iL28uRmlsZSBvYmplY3RzIGluIG1lbW9yeS4gQnkgZGVzaWduIGNsb3NlbHkgZm9sbG93cyBbVzNDIEZpbGVSZWFkZXJdKGh0dHA6Ly93d3cudzMub3JnL1RSL0ZpbGVBUEkvI2Rmbi1maWxlcmVhZGVyKVxuXHRpbnRlcmZhY2UuIFdoZXJlIHBvc3NpYmxlIHVzZXMgbmF0aXZlIEZpbGVSZWFkZXIsIHdoZXJlIC0gbm90IGZhbGxzIGJhY2sgdG8gc2hpbXMuXG5cblx0QGNsYXNzIG1veGllL2ZpbGUvRmlsZVJlYWRlclxuXHRAY29uc3RydWN0b3IgRmlsZVJlYWRlclxuXHRAZXh0ZW5kcyBFdmVudFRhcmdldFxuXHRAdXNlcyBSdW50aW1lQ2xpZW50XG5cdCovXG5cdHZhciBkaXNwYXRjaGVzID0gW1xuXG5cdFx0LyoqIFxuXHRcdERpc3BhdGNoZWQgd2hlbiB0aGUgcmVhZCBzdGFydHMuXG5cblx0XHRAZXZlbnQgbG9hZHN0YXJ0XG5cdFx0QHBhcmFtIHtPYmplY3R9IGV2ZW50XG5cdFx0Ki9cblx0XHQnbG9hZHN0YXJ0JywgXG5cblx0XHQvKiogXG5cdFx0RGlzcGF0Y2hlZCB3aGlsZSByZWFkaW5nIChhbmQgZGVjb2RpbmcpIGJsb2IsIGFuZCByZXBvcnRpbmcgcGFydGlhbCBCbG9iIGRhdGEgKHByb2dlc3MubG9hZGVkL3Byb2dyZXNzLnRvdGFsKS5cblxuXHRcdEBldmVudCBwcm9ncmVzc1xuXHRcdEBwYXJhbSB7T2JqZWN0fSBldmVudFxuXHRcdCovXG5cdFx0J3Byb2dyZXNzJywgXG5cblx0XHQvKiogXG5cdFx0RGlzcGF0Y2hlZCB3aGVuIHRoZSByZWFkIGhhcyBzdWNjZXNzZnVsbHkgY29tcGxldGVkLlxuXG5cdFx0QGV2ZW50IGxvYWRcblx0XHRAcGFyYW0ge09iamVjdH0gZXZlbnRcblx0XHQqL1xuXHRcdCdsb2FkJywgXG5cblx0XHQvKiogXG5cdFx0RGlzcGF0Y2hlZCB3aGVuIHRoZSByZWFkIGhhcyBiZWVuIGFib3J0ZWQuIEZvciBpbnN0YW5jZSwgYnkgaW52b2tpbmcgdGhlIGFib3J0KCkgbWV0aG9kLlxuXG5cdFx0QGV2ZW50IGFib3J0XG5cdFx0QHBhcmFtIHtPYmplY3R9IGV2ZW50XG5cdFx0Ki9cblx0XHQnYWJvcnQnLCBcblxuXHRcdC8qKiBcblx0XHREaXNwYXRjaGVkIHdoZW4gdGhlIHJlYWQgaGFzIGZhaWxlZC5cblxuXHRcdEBldmVudCBlcnJvclxuXHRcdEBwYXJhbSB7T2JqZWN0fSBldmVudFxuXHRcdCovXG5cdFx0J2Vycm9yJywgXG5cblx0XHQvKiogXG5cdFx0RGlzcGF0Y2hlZCB3aGVuIHRoZSByZXF1ZXN0IGhhcyBjb21wbGV0ZWQgKGVpdGhlciBpbiBzdWNjZXNzIG9yIGZhaWx1cmUpLlxuXG5cdFx0QGV2ZW50IGxvYWRlbmRcblx0XHRAcGFyYW0ge09iamVjdH0gZXZlbnRcblx0XHQqL1xuXHRcdCdsb2FkZW5kJ1xuXHRdO1xuXHRcblx0ZnVuY3Rpb24gRmlsZVJlYWRlcigpIHtcblxuXHRcdFJ1bnRpbWVDbGllbnQuY2FsbCh0aGlzKTtcblxuXHRcdEJhc2ljLmV4dGVuZCh0aGlzLCB7XG5cdFx0XHQvKipcblx0XHRcdFVJRCBvZiB0aGUgY29tcG9uZW50IGluc3RhbmNlLlxuXG5cdFx0XHRAcHJvcGVydHkgdWlkXG5cdFx0XHRAdHlwZSB7U3RyaW5nfVxuXHRcdFx0Ki9cblx0XHRcdHVpZDogQmFzaWMuZ3VpZCgndWlkXycpLFxuXG5cdFx0XHQvKipcblx0XHRcdENvbnRhaW5zIGN1cnJlbnQgc3RhdGUgb2YgRmlsZVJlYWRlciBvYmplY3QuIENhbiB0YWtlIHZhbHVlcyBvZiBGaWxlUmVhZGVyLkVNUFRZLCBGaWxlUmVhZGVyLkxPQURJTkdcblx0XHRcdGFuZCBGaWxlUmVhZGVyLkRPTkUuXG5cblx0XHRcdEBwcm9wZXJ0eSByZWFkeVN0YXRlXG5cdFx0XHRAdHlwZSB7TnVtYmVyfVxuXHRcdFx0QGRlZmF1bHQgRmlsZVJlYWRlci5FTVBUWVxuXHRcdFx0Ki9cblx0XHRcdHJlYWR5U3RhdGU6IEZpbGVSZWFkZXIuRU1QVFksXG5cdFx0XHRcblx0XHRcdC8qKlxuXHRcdFx0UmVzdWx0IG9mIHRoZSBzdWNjZXNzZnVsIHJlYWQgb3BlcmF0aW9uLlxuXG5cdFx0XHRAcHJvcGVydHkgcmVzdWx0XG5cdFx0XHRAdHlwZSB7U3RyaW5nfVxuXHRcdFx0Ki9cblx0XHRcdHJlc3VsdDogbnVsbCxcblx0XHRcdFxuXHRcdFx0LyoqXG5cdFx0XHRTdG9yZXMgdGhlIGVycm9yIG9mIGZhaWxlZCBhc3luY2hyb25vdXMgcmVhZCBvcGVyYXRpb24uXG5cblx0XHRcdEBwcm9wZXJ0eSBlcnJvclxuXHRcdFx0QHR5cGUge0RPTUVycm9yfVxuXHRcdFx0Ki9cblx0XHRcdGVycm9yOiBudWxsLFxuXHRcdFx0XG5cdFx0XHQvKipcblx0XHRcdEluaXRpYXRlcyByZWFkaW5nIG9mIEZpbGUvQmxvYiBvYmplY3QgY29udGVudHMgdG8gYmluYXJ5IHN0cmluZy5cblxuXHRcdFx0QG1ldGhvZCByZWFkQXNCaW5hcnlTdHJpbmdcblx0XHRcdEBwYXJhbSB7QmxvYnxGaWxlfSBibG9iIE9iamVjdCB0byBwcmVsb2FkXG5cdFx0XHQqL1xuXHRcdFx0cmVhZEFzQmluYXJ5U3RyaW5nOiBmdW5jdGlvbihibG9iKSB7XG5cdFx0XHRcdF9yZWFkLmNhbGwodGhpcywgJ3JlYWRBc0JpbmFyeVN0cmluZycsIGJsb2IpO1xuXHRcdFx0fSxcblx0XHRcdFxuXHRcdFx0LyoqXG5cdFx0XHRJbml0aWF0ZXMgcmVhZGluZyBvZiBGaWxlL0Jsb2Igb2JqZWN0IGNvbnRlbnRzIHRvIGRhdGFVUkwgc3RyaW5nLlxuXG5cdFx0XHRAbWV0aG9kIHJlYWRBc0RhdGFVUkxcblx0XHRcdEBwYXJhbSB7QmxvYnxGaWxlfSBibG9iIE9iamVjdCB0byBwcmVsb2FkXG5cdFx0XHQqL1xuXHRcdFx0cmVhZEFzRGF0YVVSTDogZnVuY3Rpb24oYmxvYikge1xuXHRcdFx0XHRfcmVhZC5jYWxsKHRoaXMsICdyZWFkQXNEYXRhVVJMJywgYmxvYik7XG5cdFx0XHR9LFxuXHRcdFx0XG5cdFx0XHQvKipcblx0XHRcdEluaXRpYXRlcyByZWFkaW5nIG9mIEZpbGUvQmxvYiBvYmplY3QgY29udGVudHMgdG8gc3RyaW5nLlxuXG5cdFx0XHRAbWV0aG9kIHJlYWRBc1RleHRcblx0XHRcdEBwYXJhbSB7QmxvYnxGaWxlfSBibG9iIE9iamVjdCB0byBwcmVsb2FkXG5cdFx0XHQqL1xuXHRcdFx0cmVhZEFzVGV4dDogZnVuY3Rpb24oYmxvYikge1xuXHRcdFx0XHRfcmVhZC5jYWxsKHRoaXMsICdyZWFkQXNUZXh0JywgYmxvYik7XG5cdFx0XHR9LFxuXHRcdFx0XG5cdFx0XHQvKipcblx0XHRcdEFib3J0cyBwcmVsb2FkaW5nIHByb2Nlc3MuXG5cblx0XHRcdEBtZXRob2QgYWJvcnRcblx0XHRcdCovXG5cdFx0XHRhYm9ydDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHRoaXMucmVzdWx0ID0gbnVsbDtcblx0XHRcdFx0XG5cdFx0XHRcdGlmIChCYXNpYy5pbkFycmF5KHRoaXMucmVhZHlTdGF0ZSwgW0ZpbGVSZWFkZXIuRU1QVFksIEZpbGVSZWFkZXIuRE9ORV0pICE9PSAtMSkge1xuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fSBlbHNlIGlmICh0aGlzLnJlYWR5U3RhdGUgPT09IEZpbGVSZWFkZXIuTE9BRElORykge1xuXHRcdFx0XHRcdHRoaXMucmVhZHlTdGF0ZSA9IEZpbGVSZWFkZXIuRE9ORTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHRoaXMuZXhlYygnRmlsZVJlYWRlcicsICdhYm9ydCcpO1xuXHRcdFx0XHRcblx0XHRcdFx0dGhpcy50cmlnZ2VyKCdhYm9ydCcpO1xuXHRcdFx0XHR0aGlzLnRyaWdnZXIoJ2xvYWRlbmQnKTtcblx0XHRcdH0sXG5cblx0XHRcdC8qKlxuXHRcdFx0RGVzdHJveSBjb21wb25lbnQgYW5kIHJlbGVhc2UgcmVzb3VyY2VzLlxuXG5cdFx0XHRAbWV0aG9kIGRlc3Ryb3lcblx0XHRcdCovXG5cdFx0XHRkZXN0cm95OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0dGhpcy5hYm9ydCgpO1xuXHRcdFx0XHR0aGlzLmV4ZWMoJ0ZpbGVSZWFkZXInLCAnZGVzdHJveScpO1xuXHRcdFx0XHR0aGlzLmRpc2Nvbm5lY3RSdW50aW1lKCk7XG5cdFx0XHRcdHRoaXMudW5iaW5kQWxsKCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHQvLyB1aWQgbXVzdCBhbHJlYWR5IGJlIGFzc2lnbmVkXG5cdFx0dGhpcy5oYW5kbGVFdmVudFByb3BzKGRpc3BhdGNoZXMpO1xuXG5cdFx0dGhpcy5iaW5kKCdFcnJvcicsIGZ1bmN0aW9uKGUsIGVycikge1xuXHRcdFx0dGhpcy5yZWFkeVN0YXRlID0gRmlsZVJlYWRlci5ET05FO1xuXHRcdFx0dGhpcy5lcnJvciA9IGVycjtcblx0XHR9LCA5OTkpO1xuXHRcdFxuXHRcdHRoaXMuYmluZCgnTG9hZCcsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdHRoaXMucmVhZHlTdGF0ZSA9IEZpbGVSZWFkZXIuRE9ORTtcblx0XHR9LCA5OTkpO1xuXG5cdFx0XG5cdFx0ZnVuY3Rpb24gX3JlYWQob3AsIGJsb2IpIHtcblx0XHRcdHZhciBzZWxmID0gdGhpcztcdFx0XHRcblxuXHRcdFx0dGhpcy50cmlnZ2VyKCdsb2Fkc3RhcnQnKTtcblxuXHRcdFx0aWYgKHRoaXMucmVhZHlTdGF0ZSA9PT0gRmlsZVJlYWRlci5MT0FESU5HKSB7XG5cdFx0XHRcdHRoaXMudHJpZ2dlcignZXJyb3InLCBuZXcgeC5ET01FeGNlcHRpb24oeC5ET01FeGNlcHRpb24uSU5WQUxJRF9TVEFURV9FUlIpKTtcblx0XHRcdFx0dGhpcy50cmlnZ2VyKCdsb2FkZW5kJyk7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0Ly8gaWYgc291cmNlIGlzIG5vdCBvLkJsb2Ivby5GaWxlXG5cdFx0XHRpZiAoIShibG9iIGluc3RhbmNlb2YgQmxvYikpIHtcblx0XHRcdFx0dGhpcy50cmlnZ2VyKCdlcnJvcicsIG5ldyB4LkRPTUV4Y2VwdGlvbih4LkRPTUV4Y2VwdGlvbi5OT1RfRk9VTkRfRVJSKSk7XG5cdFx0XHRcdHRoaXMudHJpZ2dlcignbG9hZGVuZCcpO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMucmVzdWx0ID0gbnVsbDtcblx0XHRcdHRoaXMucmVhZHlTdGF0ZSA9IEZpbGVSZWFkZXIuTE9BRElORztcblx0XHRcdFxuXHRcdFx0aWYgKGJsb2IuaXNEZXRhY2hlZCgpKSB7XG5cdFx0XHRcdHZhciBzcmMgPSBibG9iLmdldFNvdXJjZSgpO1xuXHRcdFx0XHRzd2l0Y2ggKG9wKSB7XG5cdFx0XHRcdFx0Y2FzZSAncmVhZEFzVGV4dCc6XG5cdFx0XHRcdFx0Y2FzZSAncmVhZEFzQmluYXJ5U3RyaW5nJzpcblx0XHRcdFx0XHRcdHRoaXMucmVzdWx0ID0gc3JjO1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0Y2FzZSAncmVhZEFzRGF0YVVSTCc6XG5cdFx0XHRcdFx0XHR0aGlzLnJlc3VsdCA9ICdkYXRhOicgKyBibG9iLnR5cGUgKyAnO2Jhc2U2NCwnICsgRW5jb2RlLmJ0b2Eoc3JjKTtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHRoaXMucmVhZHlTdGF0ZSA9IEZpbGVSZWFkZXIuRE9ORTtcblx0XHRcdFx0dGhpcy50cmlnZ2VyKCdsb2FkJyk7XG5cdFx0XHRcdHRoaXMudHJpZ2dlcignbG9hZGVuZCcpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5jb25uZWN0UnVudGltZShibG9iLnJ1aWQpO1xuXHRcdFx0XHR0aGlzLmV4ZWMoJ0ZpbGVSZWFkZXInLCAncmVhZCcsIG9wLCBibG9iKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblx0XG5cdC8qKlxuXHRJbml0aWFsIEZpbGVSZWFkZXIgc3RhdGVcblxuXHRAcHJvcGVydHkgRU1QVFlcblx0QHR5cGUge051bWJlcn1cblx0QGZpbmFsXG5cdEBzdGF0aWNcblx0QGRlZmF1bHQgMFxuXHQqL1xuXHRGaWxlUmVhZGVyLkVNUFRZID0gMDtcblxuXHQvKipcblx0RmlsZVJlYWRlciBzd2l0Y2hlcyB0byB0aGlzIHN0YXRlIHdoZW4gaXQgaXMgcHJlbG9hZGluZyB0aGUgc291cmNlXG5cblx0QHByb3BlcnR5IExPQURJTkdcblx0QHR5cGUge051bWJlcn1cblx0QGZpbmFsXG5cdEBzdGF0aWNcblx0QGRlZmF1bHQgMVxuXHQqL1xuXHRGaWxlUmVhZGVyLkxPQURJTkcgPSAxO1xuXG5cdC8qKlxuXHRQcmVsb2FkaW5nIGlzIGNvbXBsZXRlLCB0aGlzIGlzIGEgZmluYWwgc3RhdGVcblxuXHRAcHJvcGVydHkgRE9ORVxuXHRAdHlwZSB7TnVtYmVyfVxuXHRAZmluYWxcblx0QHN0YXRpY1xuXHRAZGVmYXVsdCAyXG5cdCovXG5cdEZpbGVSZWFkZXIuRE9ORSA9IDI7XG5cblx0RmlsZVJlYWRlci5wcm90b3R5cGUgPSBFdmVudFRhcmdldC5pbnN0YW5jZTtcblxuXHRyZXR1cm4gRmlsZVJlYWRlcjtcbn0pO1xuXG4vLyBJbmNsdWRlZCBmcm9tOiBzcmMvamF2YXNjcmlwdC9jb3JlL3V0aWxzL1VybC5qc1xuXG4vKipcbiAqIFVybC5qc1xuICpcbiAqIENvcHlyaWdodCAyMDEzLCBNb3hpZWNvZGUgU3lzdGVtcyBBQlxuICogUmVsZWFzZWQgdW5kZXIgR1BMIExpY2Vuc2UuXG4gKlxuICogTGljZW5zZTogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vbGljZW5zZVxuICogQ29udHJpYnV0aW5nOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9jb250cmlidXRpbmdcbiAqL1xuXG4vKipcbkBjbGFzcyBtb3hpZS9jb3JlL3V0aWxzL1VybFxuQHB1YmxpY1xuQHN0YXRpY1xuKi9cblxuZGVmaW5lKCdtb3hpZS9jb3JlL3V0aWxzL1VybCcsIFtcblx0J21veGllL2NvcmUvdXRpbHMvQmFzaWMnXG5dLCBmdW5jdGlvbihCYXNpYykge1xuXHQvKipcblx0UGFyc2UgdXJsIGludG8gc2VwYXJhdGUgY29tcG9uZW50cyBhbmQgZmlsbCBpbiBhYnNlbnQgcGFydHMgd2l0aCBwYXJ0cyBmcm9tIGN1cnJlbnQgdXJsLFxuXHRiYXNlZCBvbiBodHRwczovL3Jhdy5naXRodWIuY29tL2t2ei9waHBqcy9tYXN0ZXIvZnVuY3Rpb25zL3VybC9wYXJzZV91cmwuanNcblxuXHRAbWV0aG9kIHBhcnNlVXJsXG5cdEBzdGF0aWNcblx0QHBhcmFtIHtTdHJpbmd9IHVybCBVcmwgdG8gcGFyc2UgKGRlZmF1bHRzIHRvIGVtcHR5IHN0cmluZyBpZiB1bmRlZmluZWQpXG5cdEByZXR1cm4ge09iamVjdH0gSGFzaCBjb250YWluaW5nIGV4dHJhY3RlZCB1cmkgY29tcG9uZW50c1xuXHQqL1xuXHR2YXIgcGFyc2VVcmwgPSBmdW5jdGlvbih1cmwsIGN1cnJlbnRVcmwpIHtcblx0XHR2YXIga2V5ID0gWydzb3VyY2UnLCAnc2NoZW1lJywgJ2F1dGhvcml0eScsICd1c2VySW5mbycsICd1c2VyJywgJ3Bhc3MnLCAnaG9zdCcsICdwb3J0JywgJ3JlbGF0aXZlJywgJ3BhdGgnLCAnZGlyZWN0b3J5JywgJ2ZpbGUnLCAncXVlcnknLCAnZnJhZ21lbnQnXVxuXHRcdCwgaSA9IGtleS5sZW5ndGhcblx0XHQsIHBvcnRzID0ge1xuXHRcdFx0aHR0cDogODAsXG5cdFx0XHRodHRwczogNDQzXG5cdFx0fVxuXHRcdCwgdXJpID0ge31cblx0XHQsIHJlZ2V4ID0gL14oPzooW146XFwvPyNdKyk6KT8oPzpcXC9cXC8oKSg/Oig/OigpKD86KFteOkBcXC9dKik6PyhbXjpAXFwvXSopKT9AKT8oXFxbW1xcZGEtZkEtRjpdK1xcXXxbXjpcXC8/I10qKSg/OjooXFxkKikpPykpPygpKD86KCgpKD86KD86W14/I1xcL10qXFwvKSopKCkoPzpbXj8jXSopKSg/OlxcXFw/KFteI10qKSk/KD86IyguKikpPykvXG5cdFx0LCBtID0gcmVnZXguZXhlYyh1cmwgfHwgJycpXG5cdFx0LCBpc1JlbGF0aXZlXG5cdFx0LCBpc1NjaGVtZUxlc3MgPSAvXlxcL1xcL1xcdy8udGVzdCh1cmwpXG5cdFx0O1xuXG5cdFx0c3dpdGNoIChCYXNpYy50eXBlT2YoY3VycmVudFVybCkpIHtcblx0XHRcdGNhc2UgJ3VuZGVmaW5lZCc6XG5cdFx0XHRcdGN1cnJlbnRVcmwgPSBwYXJzZVVybChkb2N1bWVudC5sb2NhdGlvbi5ocmVmLCBmYWxzZSk7XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlICdzdHJpbmcnOlxuXHRcdFx0XHRjdXJyZW50VXJsID0gcGFyc2VVcmwoY3VycmVudFVybCwgZmFsc2UpO1xuXHRcdFx0XHRicmVhaztcblx0XHR9XG5cblx0XHR3aGlsZSAoaS0tKSB7XG5cdFx0XHRpZiAobVtpXSkge1xuXHRcdFx0XHR1cmlba2V5W2ldXSA9IG1baV07XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aXNSZWxhdGl2ZSA9ICFpc1NjaGVtZUxlc3MgJiYgIXVyaS5zY2hlbWU7XG5cblx0XHRpZiAoaXNTY2hlbWVMZXNzIHx8IGlzUmVsYXRpdmUpIHtcblx0XHRcdHVyaS5zY2hlbWUgPSBjdXJyZW50VXJsLnNjaGVtZTtcblx0XHR9XG5cblx0XHQvLyB3aGVuIHVybCBpcyByZWxhdGl2ZSwgd2Ugc2V0IHRoZSBvcmlnaW4gYW5kIHRoZSBwYXRoIG91cnNlbHZlc1xuXHRcdGlmIChpc1JlbGF0aXZlKSB7XG5cdFx0XHR1cmkuaG9zdCA9IGN1cnJlbnRVcmwuaG9zdDtcblx0XHRcdHVyaS5wb3J0ID0gY3VycmVudFVybC5wb3J0O1xuXG5cdFx0XHR2YXIgcGF0aCA9ICcnO1xuXHRcdFx0Ly8gZm9yIHVybHMgd2l0aG91dCB0cmFpbGluZyBzbGFzaCB3ZSBuZWVkIHRvIGZpZ3VyZSBvdXQgdGhlIHBhdGhcblx0XHRcdGlmICgvXlteXFwvXS8udGVzdCh1cmkucGF0aCkpIHtcblx0XHRcdFx0cGF0aCA9IGN1cnJlbnRVcmwucGF0aDtcblx0XHRcdFx0Ly8gaWYgcGF0aCBlbmRzIHdpdGggYSBmaWxlbmFtZSwgc3RyaXAgaXRcblx0XHRcdFx0aWYgKC9cXC9bXlxcL10qXFwuW15cXC9dKiQvLnRlc3QocGF0aCkpIHtcblx0XHRcdFx0XHRwYXRoID0gcGF0aC5yZXBsYWNlKC9cXC9bXlxcL10rJC8sICcvJyk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Ly8gYXZvaWQgZG91YmxlIHNsYXNoIGF0IHRoZSBlbmQgKHNlZSAjMTI3KVxuXHRcdFx0XHRcdHBhdGggPSBwYXRoLnJlcGxhY2UoL1xcLz8kLywgJy8nKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0dXJpLnBhdGggPSBwYXRoICsgKHVyaS5wYXRoIHx8ICcnKTsgLy8gc2l0ZSBtYXkgcmVzaWRlIGF0IGRvbWFpbi5jb20gb3IgZG9tYWluLmNvbS9zdWJkaXJcblx0XHR9XG5cblx0XHRpZiAoIXVyaS5wb3J0KSB7XG5cdFx0XHR1cmkucG9ydCA9IHBvcnRzW3VyaS5zY2hlbWVdIHx8IDgwO1xuXHRcdH1cblxuXHRcdHVyaS5wb3J0ID0gcGFyc2VJbnQodXJpLnBvcnQsIDEwKTtcblxuXHRcdGlmICghdXJpLnBhdGgpIHtcblx0XHRcdHVyaS5wYXRoID0gXCIvXCI7XG5cdFx0fVxuXG5cdFx0ZGVsZXRlIHVyaS5zb3VyY2U7XG5cblx0XHRyZXR1cm4gdXJpO1xuXHR9O1xuXG5cdC8qKlxuXHRSZXNvbHZlIHVybCAtIGFtb25nIG90aGVyIHRoaW5ncyB3aWxsIHR1cm4gcmVsYXRpdmUgdXJsIHRvIGFic29sdXRlXG5cblx0QG1ldGhvZCByZXNvbHZlVXJsXG5cdEBzdGF0aWNcblx0QHBhcmFtIHtTdHJpbmd8T2JqZWN0fSB1cmwgRWl0aGVyIGFic29sdXRlIG9yIHJlbGF0aXZlLCBvciBhIHJlc3VsdCBvZiBwYXJzZVVybCBjYWxsXG5cdEByZXR1cm4ge1N0cmluZ30gUmVzb2x2ZWQsIGFic29sdXRlIHVybFxuXHQqL1xuXHR2YXIgcmVzb2x2ZVVybCA9IGZ1bmN0aW9uKHVybCkge1xuXHRcdHZhciBwb3J0cyA9IHsgLy8gd2UgaWdub3JlIGRlZmF1bHQgcG9ydHNcblx0XHRcdGh0dHA6IDgwLFxuXHRcdFx0aHR0cHM6IDQ0M1xuXHRcdH1cblx0XHQsIHVybHAgPSB0eXBlb2YodXJsKSA9PT0gJ29iamVjdCcgPyB1cmwgOiBwYXJzZVVybCh1cmwpO1xuXHRcdDtcblxuXHRcdHJldHVybiB1cmxwLnNjaGVtZSArICc6Ly8nICsgdXJscC5ob3N0ICsgKHVybHAucG9ydCAhPT0gcG9ydHNbdXJscC5zY2hlbWVdID8gJzonICsgdXJscC5wb3J0IDogJycpICsgdXJscC5wYXRoICsgKHVybHAucXVlcnkgPyB1cmxwLnF1ZXJ5IDogJycpO1xuXHR9O1xuXG5cdC8qKlxuXHRDaGVjayBpZiBzcGVjaWZpZWQgdXJsIGhhcyB0aGUgc2FtZSBvcmlnaW4gYXMgdGhlIGN1cnJlbnQgZG9jdW1lbnRcblxuXHRAbWV0aG9kIGhhc1NhbWVPcmlnaW5cblx0QHN0YXRpY1xuXHRAcGFyYW0ge1N0cmluZ3xPYmplY3R9IHVybFxuXHRAcmV0dXJuIHtCb29sZWFufVxuXHQqL1xuXHR2YXIgaGFzU2FtZU9yaWdpbiA9IGZ1bmN0aW9uKHVybCkge1xuXHRcdGZ1bmN0aW9uIG9yaWdpbih1cmwpIHtcblx0XHRcdHJldHVybiBbdXJsLnNjaGVtZSwgdXJsLmhvc3QsIHVybC5wb3J0XS5qb2luKCcvJyk7XG5cdFx0fVxuXG5cdFx0aWYgKHR5cGVvZiB1cmwgPT09ICdzdHJpbmcnKSB7XG5cdFx0XHR1cmwgPSBwYXJzZVVybCh1cmwpO1xuXHRcdH1cblxuXHRcdHJldHVybiBvcmlnaW4ocGFyc2VVcmwoKSkgPT09IG9yaWdpbih1cmwpO1xuXHR9O1xuXG5cdHJldHVybiB7XG5cdFx0cGFyc2VVcmw6IHBhcnNlVXJsLFxuXHRcdHJlc29sdmVVcmw6IHJlc29sdmVVcmwsXG5cdFx0aGFzU2FtZU9yaWdpbjogaGFzU2FtZU9yaWdpblxuXHR9O1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L3J1bnRpbWUvUnVudGltZVRhcmdldC5qc1xuXG4vKipcbiAqIFJ1bnRpbWVUYXJnZXQuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuZGVmaW5lKCdtb3hpZS9ydW50aW1lL1J1bnRpbWVUYXJnZXQnLCBbXG5cdCdtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljJyxcblx0J21veGllL3J1bnRpbWUvUnVudGltZUNsaWVudCcsXG5cdFwibW94aWUvY29yZS9FdmVudFRhcmdldFwiXG5dLCBmdW5jdGlvbihCYXNpYywgUnVudGltZUNsaWVudCwgRXZlbnRUYXJnZXQpIHtcblx0LyoqXG5cdEluc3RhbmNlIG9mIHRoaXMgY2xhc3MgY2FuIGJlIHVzZWQgYXMgYSB0YXJnZXQgZm9yIHRoZSBldmVudHMgZGlzcGF0Y2hlZCBieSBzaGltcyxcblx0d2hlbiBhbGxvd2luZyB0aGVtIG9udG8gY29tcG9uZW50cyBpcyBmb3IgZWl0aGVyIHJlYXNvbiBpbmFwcHJvcHJpYXRlXG5cblx0QGNsYXNzIG1veGllL3J1bnRpbWUvUnVudGltZVRhcmdldFxuXHRAY29uc3RydWN0b3Jcblx0QHByb3RlY3RlZFxuXHRAZXh0ZW5kcyBFdmVudFRhcmdldFxuXHQqL1xuXHRmdW5jdGlvbiBSdW50aW1lVGFyZ2V0KCkge1xuXHRcdHRoaXMudWlkID0gQmFzaWMuZ3VpZCgndWlkXycpO1xuXHRcdFxuXHRcdFJ1bnRpbWVDbGllbnQuY2FsbCh0aGlzKTtcblxuXHRcdHRoaXMuZGVzdHJveSA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0dGhpcy5kaXNjb25uZWN0UnVudGltZSgpO1xuXHRcdFx0dGhpcy51bmJpbmRBbGwoKTtcblx0XHR9O1xuXHR9XG5cblx0UnVudGltZVRhcmdldC5wcm90b3R5cGUgPSBFdmVudFRhcmdldC5pbnN0YW5jZTtcblxuXHRyZXR1cm4gUnVudGltZVRhcmdldDtcbn0pO1xuXG4vLyBJbmNsdWRlZCBmcm9tOiBzcmMvamF2YXNjcmlwdC9maWxlL0ZpbGVSZWFkZXJTeW5jLmpzXG5cbi8qKlxuICogRmlsZVJlYWRlclN5bmMuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuZGVmaW5lKCdtb3hpZS9maWxlL0ZpbGVSZWFkZXJTeW5jJywgW1xuXHQnbW94aWUvY29yZS91dGlscy9CYXNpYycsXG5cdCdtb3hpZS9ydW50aW1lL1J1bnRpbWVDbGllbnQnLFxuXHQnbW94aWUvY29yZS91dGlscy9FbmNvZGUnXG5dLCBmdW5jdGlvbihCYXNpYywgUnVudGltZUNsaWVudCwgRW5jb2RlKSB7XG5cdC8qKlxuXHRTeW5jaHJvbm91cyBGaWxlUmVhZGVyIGltcGxlbWVudGF0aW9uLiBTb21ldGhpbmcgbGlrZSB0aGlzIGlzIGF2YWlsYWJsZSBpbiBXZWJXb3JrZXJzIGVudmlyb25tZW50LCBoZXJlXG5cdGl0IGNhbiBiZSB1c2VkIHRvIHJlYWQgb25seSBwcmVsb2FkZWQgYmxvYnMvZmlsZXMgYW5kIG9ubHkgYmVsb3cgY2VydGFpbiBzaXplIChub3QgeWV0IHN1cmUgd2hhdCB0aGF0J2QgYmUsXG5cdGJ1dCBwcm9iYWJseSA8IDFtYikuIE5vdCBtZWFudCB0byBiZSB1c2VkIGRpcmVjdGx5IGJ5IHVzZXIuXG5cblx0QGNsYXNzIG1veGllL2ZpbGUvRmlsZVJlYWRlclN5bmNcblx0QHByaXZhdGVcblx0QGNvbnN0cnVjdG9yXG5cdCovXG5cdHJldHVybiBmdW5jdGlvbigpIHtcblx0XHRSdW50aW1lQ2xpZW50LmNhbGwodGhpcyk7XG5cblx0XHRCYXNpYy5leHRlbmQodGhpcywge1xuXHRcdFx0dWlkOiBCYXNpYy5ndWlkKCd1aWRfJyksXG5cblx0XHRcdHJlYWRBc0JpbmFyeVN0cmluZzogZnVuY3Rpb24oYmxvYikge1xuXHRcdFx0XHRyZXR1cm4gX3JlYWQuY2FsbCh0aGlzLCAncmVhZEFzQmluYXJ5U3RyaW5nJywgYmxvYik7XG5cdFx0XHR9LFxuXHRcdFx0XG5cdFx0XHRyZWFkQXNEYXRhVVJMOiBmdW5jdGlvbihibG9iKSB7XG5cdFx0XHRcdHJldHVybiBfcmVhZC5jYWxsKHRoaXMsICdyZWFkQXNEYXRhVVJMJywgYmxvYik7XG5cdFx0XHR9LFxuXHRcdFx0XG5cdFx0XHQvKnJlYWRBc0FycmF5QnVmZmVyOiBmdW5jdGlvbihibG9iKSB7XG5cdFx0XHRcdHJldHVybiBfcmVhZC5jYWxsKHRoaXMsICdyZWFkQXNBcnJheUJ1ZmZlcicsIGJsb2IpO1xuXHRcdFx0fSwqL1xuXHRcdFx0XG5cdFx0XHRyZWFkQXNUZXh0OiBmdW5jdGlvbihibG9iKSB7XG5cdFx0XHRcdHJldHVybiBfcmVhZC5jYWxsKHRoaXMsICdyZWFkQXNUZXh0JywgYmxvYik7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRmdW5jdGlvbiBfcmVhZChvcCwgYmxvYikge1xuXHRcdFx0aWYgKGJsb2IuaXNEZXRhY2hlZCgpKSB7XG5cdFx0XHRcdHZhciBzcmMgPSBibG9iLmdldFNvdXJjZSgpO1xuXHRcdFx0XHRzd2l0Y2ggKG9wKSB7XG5cdFx0XHRcdFx0Y2FzZSAncmVhZEFzQmluYXJ5U3RyaW5nJzpcblx0XHRcdFx0XHRcdHJldHVybiBzcmM7XG5cdFx0XHRcdFx0Y2FzZSAncmVhZEFzRGF0YVVSTCc6XG5cdFx0XHRcdFx0XHRyZXR1cm4gJ2RhdGE6JyArIGJsb2IudHlwZSArICc7YmFzZTY0LCcgKyBFbmNvZGUuYnRvYShzcmMpO1xuXHRcdFx0XHRcdGNhc2UgJ3JlYWRBc1RleHQnOlxuXHRcdFx0XHRcdFx0dmFyIHR4dCA9ICcnO1xuXHRcdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDAsIGxlbmd0aCA9IHNyYy5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0XHR0eHQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShzcmNbaV0pO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0cmV0dXJuIHR4dDtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dmFyIHJlc3VsdCA9IHRoaXMuY29ubmVjdFJ1bnRpbWUoYmxvYi5ydWlkKS5leGVjLmNhbGwodGhpcywgJ0ZpbGVSZWFkZXJTeW5jJywgJ3JlYWQnLCBvcCwgYmxvYik7XG5cdFx0XHRcdHRoaXMuZGlzY29ubmVjdFJ1bnRpbWUoKTtcblx0XHRcdFx0cmV0dXJuIHJlc3VsdDtcblx0XHRcdH1cblx0XHR9XG5cdH07XG59KTtcblxuLy8gSW5jbHVkZWQgZnJvbTogc3JjL2phdmFzY3JpcHQveGhyL0Zvcm1EYXRhLmpzXG5cbi8qKlxuICogRm9ybURhdGEuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuZGVmaW5lKFwibW94aWUveGhyL0Zvcm1EYXRhXCIsIFtcblx0XCJtb3hpZS9jb3JlL0V4Y2VwdGlvbnNcIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCIsXG5cdFwibW94aWUvZmlsZS9CbG9iXCJcbl0sIGZ1bmN0aW9uKHgsIEJhc2ljLCBCbG9iKSB7XG5cdC8qKlxuXHRGb3JtRGF0YVxuXG5cdEBjbGFzcyBtb3hpZS94aHIvRm9ybURhdGFcblx0QGNvbnN0cnVjdG9yXG5cdCovXG5cdGZ1bmN0aW9uIEZvcm1EYXRhKCkge1xuXHRcdHZhciBfYmxvYiwgX2ZpZWxkcyA9IFtdO1xuXG5cdFx0QmFzaWMuZXh0ZW5kKHRoaXMsIHtcblx0XHRcdC8qKlxuXHRcdFx0QXBwZW5kIGFub3RoZXIga2V5LXZhbHVlIHBhaXIgdG8gdGhlIEZvcm1EYXRhIG9iamVjdFxuXG5cdFx0XHRAbWV0aG9kIGFwcGVuZFxuXHRcdFx0QHBhcmFtIHtTdHJpbmd9IG5hbWUgTmFtZSBmb3IgdGhlIG5ldyBmaWVsZFxuXHRcdFx0QHBhcmFtIHtTdHJpbmd8QmxvYnxBcnJheXxPYmplY3R9IHZhbHVlIFZhbHVlIGZvciB0aGUgZmllbGRcblx0XHRcdCovXG5cdFx0XHRhcHBlbmQ6IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7XG5cdFx0XHRcdHZhciBzZWxmID0gdGhpcywgdmFsdWVUeXBlID0gQmFzaWMudHlwZU9mKHZhbHVlKTtcblxuXHRcdFx0XHQvLyBhY2NvcmRpbmcgdG8gc3BlY3MgdmFsdWUgbWlnaHQgYmUgZWl0aGVyIEJsb2Igb3IgU3RyaW5nXG5cdFx0XHRcdGlmICh2YWx1ZSBpbnN0YW5jZW9mIEJsb2IpIHtcblx0XHRcdFx0XHRfYmxvYiA9IHtcblx0XHRcdFx0XHRcdG5hbWU6IG5hbWUsXG5cdFx0XHRcdFx0XHR2YWx1ZTogdmFsdWUgLy8gdW5mb3J0dW5hdGVseSB3ZSBjYW4gb25seSBzZW5kIHNpbmdsZSBCbG9iIGluIG9uZSBGb3JtRGF0YVxuXHRcdFx0XHRcdH07XG5cdFx0XHRcdH0gZWxzZSBpZiAoJ2FycmF5JyA9PT0gdmFsdWVUeXBlKSB7XG5cdFx0XHRcdFx0bmFtZSArPSAnW10nO1xuXG5cdFx0XHRcdFx0QmFzaWMuZWFjaCh2YWx1ZSwgZnVuY3Rpb24odmFsdWUpIHtcblx0XHRcdFx0XHRcdHNlbGYuYXBwZW5kKG5hbWUsIHZhbHVlKTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fSBlbHNlIGlmICgnb2JqZWN0JyA9PT0gdmFsdWVUeXBlKSB7XG5cdFx0XHRcdFx0QmFzaWMuZWFjaCh2YWx1ZSwgZnVuY3Rpb24odmFsdWUsIGtleSkge1xuXHRcdFx0XHRcdFx0c2VsZi5hcHBlbmQobmFtZSArICdbJyArIGtleSArICddJywgdmFsdWUpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9IGVsc2UgaWYgKCdudWxsJyA9PT0gdmFsdWVUeXBlIHx8ICd1bmRlZmluZWQnID09PSB2YWx1ZVR5cGUgfHwgJ251bWJlcicgPT09IHZhbHVlVHlwZSAmJiBpc05hTih2YWx1ZSkpIHtcblx0XHRcdFx0XHRzZWxmLmFwcGVuZChuYW1lLCBcImZhbHNlXCIpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdF9maWVsZHMucHVzaCh7XG5cdFx0XHRcdFx0XHRuYW1lOiBuYW1lLFxuXHRcdFx0XHRcdFx0dmFsdWU6IHZhbHVlLnRvU3RyaW5nKClcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXHRcdFx0fSxcblxuXHRcdFx0LyoqXG5cdFx0XHRDaGVja3MgaWYgRm9ybURhdGEgY29udGFpbnMgQmxvYi5cblxuXHRcdFx0QG1ldGhvZCBoYXNCbG9iXG5cdFx0XHRAcmV0dXJuIHtCb29sZWFufVxuXHRcdFx0Ki9cblx0XHRcdGhhc0Jsb2I6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gISF0aGlzLmdldEJsb2IoKTtcblx0XHRcdH0sXG5cblx0XHRcdC8qKlxuXHRcdFx0UmV0cmlldmVzIGJsb2IuXG5cblx0XHRcdEBtZXRob2QgZ2V0QmxvYlxuXHRcdFx0QHJldHVybiB7T2JqZWN0fSBFaXRoZXIgQmxvYiBpZiBmb3VuZCBvciBudWxsXG5cdFx0XHQqL1xuXHRcdFx0Z2V0QmxvYjogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiBfYmxvYiAmJiBfYmxvYi52YWx1ZSB8fCBudWxsO1xuXHRcdFx0fSxcblxuXHRcdFx0LyoqXG5cdFx0XHRSZXRyaWV2ZXMgYmxvYiBmaWVsZCBuYW1lLlxuXG5cdFx0XHRAbWV0aG9kIGdldEJsb2JOYW1lXG5cdFx0XHRAcmV0dXJuIHtTdHJpbmd9IEVpdGhlciBCbG9iIGZpZWxkIG5hbWUgb3IgbnVsbFxuXHRcdFx0Ki9cblx0XHRcdGdldEJsb2JOYW1lOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIF9ibG9iICYmIF9ibG9iLm5hbWUgfHwgbnVsbDtcblx0XHRcdH0sXG5cblx0XHRcdC8qKlxuXHRcdFx0TG9vcCBvdmVyIHRoZSBmaWVsZHMgaW4gRm9ybURhdGEgYW5kIGludm9rZSB0aGUgY2FsbGJhY2sgZm9yIGVhY2ggb2YgdGhlbS5cblxuXHRcdFx0QG1ldGhvZCBlYWNoXG5cdFx0XHRAcGFyYW0ge0Z1bmN0aW9ufSBjYiBDYWxsYmFjayB0byBjYWxsIGZvciBlYWNoIGZpZWxkXG5cdFx0XHQqL1xuXHRcdFx0ZWFjaDogZnVuY3Rpb24oY2IpIHtcblx0XHRcdFx0QmFzaWMuZWFjaChfZmllbGRzLCBmdW5jdGlvbihmaWVsZCkge1xuXHRcdFx0XHRcdGNiKGZpZWxkLnZhbHVlLCBmaWVsZC5uYW1lKTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0aWYgKF9ibG9iKSB7XG5cdFx0XHRcdFx0Y2IoX2Jsb2IudmFsdWUsIF9ibG9iLm5hbWUpO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXG5cdFx0XHRkZXN0cm95OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0X2Jsb2IgPSBudWxsO1xuXHRcdFx0XHRfZmllbGRzID0gW107XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHRyZXR1cm4gRm9ybURhdGE7XG59KTtcblxuLy8gSW5jbHVkZWQgZnJvbTogc3JjL2phdmFzY3JpcHQveGhyL1hNTEh0dHBSZXF1ZXN0LmpzXG5cbi8qKlxuICogWE1MSHR0cFJlcXVlc3QuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuZGVmaW5lKFwibW94aWUveGhyL1hNTEh0dHBSZXF1ZXN0XCIsIFtcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCIsXG5cdFwibW94aWUvY29yZS9FeGNlcHRpb25zXCIsXG5cdFwibW94aWUvY29yZS9FdmVudFRhcmdldFwiLFxuXHRcIm1veGllL2NvcmUvdXRpbHMvRW5jb2RlXCIsXG5cdFwibW94aWUvY29yZS91dGlscy9VcmxcIixcblx0XCJtb3hpZS9ydW50aW1lL1J1bnRpbWVcIixcblx0XCJtb3hpZS9ydW50aW1lL1J1bnRpbWVUYXJnZXRcIixcblx0XCJtb3hpZS9maWxlL0Jsb2JcIixcblx0XCJtb3hpZS9maWxlL0ZpbGVSZWFkZXJTeW5jXCIsXG5cdFwibW94aWUveGhyL0Zvcm1EYXRhXCIsXG5cdFwibW94aWUvY29yZS91dGlscy9FbnZcIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL01pbWVcIlxuXSwgZnVuY3Rpb24oQmFzaWMsIHgsIEV2ZW50VGFyZ2V0LCBFbmNvZGUsIFVybCwgUnVudGltZSwgUnVudGltZVRhcmdldCwgQmxvYiwgRmlsZVJlYWRlclN5bmMsIEZvcm1EYXRhLCBFbnYsIE1pbWUpIHtcblxuXHR2YXIgaHR0cENvZGUgPSB7XG5cdFx0MTAwOiAnQ29udGludWUnLFxuXHRcdDEwMTogJ1N3aXRjaGluZyBQcm90b2NvbHMnLFxuXHRcdDEwMjogJ1Byb2Nlc3NpbmcnLFxuXG5cdFx0MjAwOiAnT0snLFxuXHRcdDIwMTogJ0NyZWF0ZWQnLFxuXHRcdDIwMjogJ0FjY2VwdGVkJyxcblx0XHQyMDM6ICdOb24tQXV0aG9yaXRhdGl2ZSBJbmZvcm1hdGlvbicsXG5cdFx0MjA0OiAnTm8gQ29udGVudCcsXG5cdFx0MjA1OiAnUmVzZXQgQ29udGVudCcsXG5cdFx0MjA2OiAnUGFydGlhbCBDb250ZW50Jyxcblx0XHQyMDc6ICdNdWx0aS1TdGF0dXMnLFxuXHRcdDIyNjogJ0lNIFVzZWQnLFxuXG5cdFx0MzAwOiAnTXVsdGlwbGUgQ2hvaWNlcycsXG5cdFx0MzAxOiAnTW92ZWQgUGVybWFuZW50bHknLFxuXHRcdDMwMjogJ0ZvdW5kJyxcblx0XHQzMDM6ICdTZWUgT3RoZXInLFxuXHRcdDMwNDogJ05vdCBNb2RpZmllZCcsXG5cdFx0MzA1OiAnVXNlIFByb3h5Jyxcblx0XHQzMDY6ICdSZXNlcnZlZCcsXG5cdFx0MzA3OiAnVGVtcG9yYXJ5IFJlZGlyZWN0JyxcblxuXHRcdDQwMDogJ0JhZCBSZXF1ZXN0Jyxcblx0XHQ0MDE6ICdVbmF1dGhvcml6ZWQnLFxuXHRcdDQwMjogJ1BheW1lbnQgUmVxdWlyZWQnLFxuXHRcdDQwMzogJ0ZvcmJpZGRlbicsXG5cdFx0NDA0OiAnTm90IEZvdW5kJyxcblx0XHQ0MDU6ICdNZXRob2QgTm90IEFsbG93ZWQnLFxuXHRcdDQwNjogJ05vdCBBY2NlcHRhYmxlJyxcblx0XHQ0MDc6ICdQcm94eSBBdXRoZW50aWNhdGlvbiBSZXF1aXJlZCcsXG5cdFx0NDA4OiAnUmVxdWVzdCBUaW1lb3V0Jyxcblx0XHQ0MDk6ICdDb25mbGljdCcsXG5cdFx0NDEwOiAnR29uZScsXG5cdFx0NDExOiAnTGVuZ3RoIFJlcXVpcmVkJyxcblx0XHQ0MTI6ICdQcmVjb25kaXRpb24gRmFpbGVkJyxcblx0XHQ0MTM6ICdSZXF1ZXN0IEVudGl0eSBUb28gTGFyZ2UnLFxuXHRcdDQxNDogJ1JlcXVlc3QtVVJJIFRvbyBMb25nJyxcblx0XHQ0MTU6ICdVbnN1cHBvcnRlZCBNZWRpYSBUeXBlJyxcblx0XHQ0MTY6ICdSZXF1ZXN0ZWQgUmFuZ2UgTm90IFNhdGlzZmlhYmxlJyxcblx0XHQ0MTc6ICdFeHBlY3RhdGlvbiBGYWlsZWQnLFxuXHRcdDQyMjogJ1VucHJvY2Vzc2FibGUgRW50aXR5Jyxcblx0XHQ0MjM6ICdMb2NrZWQnLFxuXHRcdDQyNDogJ0ZhaWxlZCBEZXBlbmRlbmN5Jyxcblx0XHQ0MjY6ICdVcGdyYWRlIFJlcXVpcmVkJyxcblxuXHRcdDUwMDogJ0ludGVybmFsIFNlcnZlciBFcnJvcicsXG5cdFx0NTAxOiAnTm90IEltcGxlbWVudGVkJyxcblx0XHQ1MDI6ICdCYWQgR2F0ZXdheScsXG5cdFx0NTAzOiAnU2VydmljZSBVbmF2YWlsYWJsZScsXG5cdFx0NTA0OiAnR2F0ZXdheSBUaW1lb3V0Jyxcblx0XHQ1MDU6ICdIVFRQIFZlcnNpb24gTm90IFN1cHBvcnRlZCcsXG5cdFx0NTA2OiAnVmFyaWFudCBBbHNvIE5lZ290aWF0ZXMnLFxuXHRcdDUwNzogJ0luc3VmZmljaWVudCBTdG9yYWdlJyxcblx0XHQ1MTA6ICdOb3QgRXh0ZW5kZWQnXG5cdH07XG5cblx0ZnVuY3Rpb24gWE1MSHR0cFJlcXVlc3RVcGxvYWQoKSB7XG5cdFx0dGhpcy51aWQgPSBCYXNpYy5ndWlkKCd1aWRfJyk7XG5cdH1cblxuXHRYTUxIdHRwUmVxdWVzdFVwbG9hZC5wcm90b3R5cGUgPSBFdmVudFRhcmdldC5pbnN0YW5jZTtcblxuXHQvKipcblx0SW1wbGVtZW50YXRpb24gb2YgWE1MSHR0cFJlcXVlc3RcblxuXHRAY2xhc3MgbW94aWUveGhyL1hNTEh0dHBSZXF1ZXN0XG5cdEBjb25zdHJ1Y3RvclxuXHRAdXNlcyBSdW50aW1lQ2xpZW50XG5cdEBleHRlbmRzIEV2ZW50VGFyZ2V0XG5cdCovXG5cdHZhciBkaXNwYXRjaGVzID0gW1xuXHRcdCdsb2Fkc3RhcnQnLFxuXG5cdFx0J3Byb2dyZXNzJyxcblxuXHRcdCdhYm9ydCcsXG5cblx0XHQnZXJyb3InLFxuXG5cdFx0J2xvYWQnLFxuXG5cdFx0J3RpbWVvdXQnLFxuXG5cdFx0J2xvYWRlbmQnXG5cblx0XHQvLyByZWFkeXN0YXRlY2hhbmdlIChmb3IgaGlzdG9yaWNhbCByZWFzb25zKVxuXHRdO1xuXG5cdHZhciBOQVRJVkUgPSAxLCBSVU5USU1FID0gMjtcblxuXHRmdW5jdGlvbiBYTUxIdHRwUmVxdWVzdCgpIHtcblx0XHR2YXIgc2VsZiA9IHRoaXMsXG5cdFx0XHQvLyB0aGlzICh0b2dldGhlciB3aXRoIF9wKCkgQHNlZSBiZWxvdykgaXMgaGVyZSB0byBncmFjZWZ1bGx5IHVwZ3JhZGUgdG8gc2V0dGVyL2dldHRlciBzeW50YXggd2hlcmUgcG9zc2libGVcblx0XHRcdHByb3BzID0ge1xuXHRcdFx0XHQvKipcblx0XHRcdFx0VGhlIGFtb3VudCBvZiBtaWxsaXNlY29uZHMgYSByZXF1ZXN0IGNhbiB0YWtlIGJlZm9yZSBiZWluZyB0ZXJtaW5hdGVkLiBJbml0aWFsbHkgemVyby4gWmVybyBtZWFucyB0aGVyZSBpcyBubyB0aW1lb3V0LlxuXG5cdFx0XHRcdEBwcm9wZXJ0eSB0aW1lb3V0XG5cdFx0XHRcdEB0eXBlIE51bWJlclxuXHRcdFx0XHRAZGVmYXVsdCAwXG5cdFx0XHRcdCovXG5cdFx0XHRcdHRpbWVvdXQ6IDAsXG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdEN1cnJlbnQgc3RhdGUsIGNhbiB0YWtlIGZvbGxvd2luZyB2YWx1ZXM6XG5cdFx0XHRcdFVOU0VOVCAobnVtZXJpYyB2YWx1ZSAwKVxuXHRcdFx0XHRUaGUgb2JqZWN0IGhhcyBiZWVuIGNvbnN0cnVjdGVkLlxuXG5cdFx0XHRcdE9QRU5FRCAobnVtZXJpYyB2YWx1ZSAxKVxuXHRcdFx0XHRUaGUgb3BlbigpIG1ldGhvZCBoYXMgYmVlbiBzdWNjZXNzZnVsbHkgaW52b2tlZC4gRHVyaW5nIHRoaXMgc3RhdGUgcmVxdWVzdCBoZWFkZXJzIGNhbiBiZSBzZXQgdXNpbmcgc2V0UmVxdWVzdEhlYWRlcigpIGFuZCB0aGUgcmVxdWVzdCBjYW4gYmUgbWFkZSB1c2luZyB0aGUgc2VuZCgpIG1ldGhvZC5cblxuXHRcdFx0XHRIRUFERVJTX1JFQ0VJVkVEIChudW1lcmljIHZhbHVlIDIpXG5cdFx0XHRcdEFsbCByZWRpcmVjdHMgKGlmIGFueSkgaGF2ZSBiZWVuIGZvbGxvd2VkIGFuZCBhbGwgSFRUUCBoZWFkZXJzIG9mIHRoZSBmaW5hbCByZXNwb25zZSBoYXZlIGJlZW4gcmVjZWl2ZWQuIFNldmVyYWwgcmVzcG9uc2UgbWVtYmVycyBvZiB0aGUgb2JqZWN0IGFyZSBub3cgYXZhaWxhYmxlLlxuXG5cdFx0XHRcdExPQURJTkcgKG51bWVyaWMgdmFsdWUgMylcblx0XHRcdFx0VGhlIHJlc3BvbnNlIGVudGl0eSBib2R5IGlzIGJlaW5nIHJlY2VpdmVkLlxuXG5cdFx0XHRcdERPTkUgKG51bWVyaWMgdmFsdWUgNClcblxuXHRcdFx0XHRAcHJvcGVydHkgcmVhZHlTdGF0ZVxuXHRcdFx0XHRAdHlwZSBOdW1iZXJcblx0XHRcdFx0QGRlZmF1bHQgMCAoVU5TRU5UKVxuXHRcdFx0XHQqL1xuXHRcdFx0XHRyZWFkeVN0YXRlOiBYTUxIdHRwUmVxdWVzdC5VTlNFTlQsXG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdFRydWUgd2hlbiB1c2VyIGNyZWRlbnRpYWxzIGFyZSB0byBiZSBpbmNsdWRlZCBpbiBhIGNyb3NzLW9yaWdpbiByZXF1ZXN0LiBGYWxzZSB3aGVuIHRoZXkgYXJlIHRvIGJlIGV4Y2x1ZGVkXG5cdFx0XHRcdGluIGEgY3Jvc3Mtb3JpZ2luIHJlcXVlc3QgYW5kIHdoZW4gY29va2llcyBhcmUgdG8gYmUgaWdub3JlZCBpbiBpdHMgcmVzcG9uc2UuIEluaXRpYWxseSBmYWxzZS5cblxuXHRcdFx0XHRAcHJvcGVydHkgd2l0aENyZWRlbnRpYWxzXG5cdFx0XHRcdEB0eXBlIEJvb2xlYW5cblx0XHRcdFx0QGRlZmF1bHQgZmFsc2Vcblx0XHRcdFx0Ki9cblx0XHRcdFx0d2l0aENyZWRlbnRpYWxzOiBmYWxzZSxcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0UmV0dXJucyB0aGUgSFRUUCBzdGF0dXMgY29kZS5cblxuXHRcdFx0XHRAcHJvcGVydHkgc3RhdHVzXG5cdFx0XHRcdEB0eXBlIE51bWJlclxuXHRcdFx0XHRAZGVmYXVsdCAwXG5cdFx0XHRcdCovXG5cdFx0XHRcdHN0YXR1czogMCxcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0UmV0dXJucyB0aGUgSFRUUCBzdGF0dXMgdGV4dC5cblxuXHRcdFx0XHRAcHJvcGVydHkgc3RhdHVzVGV4dFxuXHRcdFx0XHRAdHlwZSBTdHJpbmdcblx0XHRcdFx0Ki9cblx0XHRcdFx0c3RhdHVzVGV4dDogXCJcIixcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0UmV0dXJucyB0aGUgcmVzcG9uc2UgdHlwZS4gQ2FuIGJlIHNldCB0byBjaGFuZ2UgdGhlIHJlc3BvbnNlIHR5cGUuIFZhbHVlcyBhcmU6XG5cdFx0XHRcdHRoZSBlbXB0eSBzdHJpbmcgKGRlZmF1bHQpLCBcImFycmF5YnVmZmVyXCIsIFwiYmxvYlwiLCBcImRvY3VtZW50XCIsIFwianNvblwiLCBhbmQgXCJ0ZXh0XCIuXG5cblx0XHRcdFx0QHByb3BlcnR5IHJlc3BvbnNlVHlwZVxuXHRcdFx0XHRAdHlwZSBTdHJpbmdcblx0XHRcdFx0Ki9cblx0XHRcdFx0cmVzcG9uc2VUeXBlOiBcIlwiLFxuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHRSZXR1cm5zIHRoZSBkb2N1bWVudCByZXNwb25zZSBlbnRpdHkgYm9keS5cblxuXHRcdFx0XHRUaHJvd3MgYW4gXCJJbnZhbGlkU3RhdGVFcnJvclwiIGV4Y2VwdGlvbiBpZiByZXNwb25zZVR5cGUgaXMgbm90IHRoZSBlbXB0eSBzdHJpbmcgb3IgXCJkb2N1bWVudFwiLlxuXG5cdFx0XHRcdEBwcm9wZXJ0eSByZXNwb25zZVhNTFxuXHRcdFx0XHRAdHlwZSBEb2N1bWVudFxuXHRcdFx0XHQqL1xuXHRcdFx0XHRyZXNwb25zZVhNTDogbnVsbCxcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0UmV0dXJucyB0aGUgdGV4dCByZXNwb25zZSBlbnRpdHkgYm9keS5cblxuXHRcdFx0XHRUaHJvd3MgYW4gXCJJbnZhbGlkU3RhdGVFcnJvclwiIGV4Y2VwdGlvbiBpZiByZXNwb25zZVR5cGUgaXMgbm90IHRoZSBlbXB0eSBzdHJpbmcgb3IgXCJ0ZXh0XCIuXG5cblx0XHRcdFx0QHByb3BlcnR5IHJlc3BvbnNlVGV4dFxuXHRcdFx0XHRAdHlwZSBTdHJpbmdcblx0XHRcdFx0Ki9cblx0XHRcdFx0cmVzcG9uc2VUZXh0OiBudWxsLFxuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHRSZXR1cm5zIHRoZSByZXNwb25zZSBlbnRpdHkgYm9keSAoaHR0cDovL3d3dy53My5vcmcvVFIvWE1MSHR0cFJlcXVlc3QvI3Jlc3BvbnNlLWVudGl0eS1ib2R5KS5cblx0XHRcdFx0Q2FuIGJlY29tZTogQXJyYXlCdWZmZXIsIEJsb2IsIERvY3VtZW50LCBKU09OLCBUZXh0XG5cblx0XHRcdFx0QHByb3BlcnR5IHJlc3BvbnNlXG5cdFx0XHRcdEB0eXBlIE1peGVkXG5cdFx0XHRcdCovXG5cdFx0XHRcdHJlc3BvbnNlOiBudWxsXG5cdFx0XHR9LFxuXG5cdFx0XHRfYXN5bmMgPSB0cnVlLFxuXHRcdFx0X3VybCxcblx0XHRcdF9tZXRob2QsXG5cdFx0XHRfaGVhZGVycyA9IHt9LFxuXHRcdFx0X3VzZXIsXG5cdFx0XHRfcGFzc3dvcmQsXG5cdFx0XHRfZW5jb2RpbmcgPSBudWxsLFxuXHRcdFx0X21pbWVUeXBlID0gbnVsbCxcblxuXHRcdFx0Ly8gZmxhZ3Ncblx0XHRcdF9zeW5jX2ZsYWcgPSBmYWxzZSxcblx0XHRcdF9zZW5kX2ZsYWcgPSBmYWxzZSxcblx0XHRcdF91cGxvYWRfZXZlbnRzX2ZsYWcgPSBmYWxzZSxcblx0XHRcdF91cGxvYWRfY29tcGxldGVfZmxhZyA9IGZhbHNlLFxuXHRcdFx0X2Vycm9yX2ZsYWcgPSBmYWxzZSxcblx0XHRcdF9zYW1lX29yaWdpbl9mbGFnID0gZmFsc2UsXG5cblx0XHRcdC8vIHRpbWVzXG5cdFx0XHRfc3RhcnRfdGltZSxcblx0XHRcdF90aW1lb3V0c2V0X3RpbWUsXG5cblx0XHRcdF9maW5hbE1pbWUgPSBudWxsLFxuXHRcdFx0X2ZpbmFsQ2hhcnNldCA9IG51bGwsXG5cblx0XHRcdF9vcHRpb25zID0ge30sXG5cdFx0XHRfeGhyLFxuXHRcdFx0X3Jlc3BvbnNlSGVhZGVycyA9ICcnLFxuXHRcdFx0X3Jlc3BvbnNlSGVhZGVyc0JhZ1xuXHRcdFx0O1xuXG5cblx0XHRCYXNpYy5leHRlbmQodGhpcywgcHJvcHMsIHtcblx0XHRcdC8qKlxuXHRcdFx0VW5pcXVlIGlkIG9mIHRoZSBjb21wb25lbnRcblxuXHRcdFx0QHByb3BlcnR5IHVpZFxuXHRcdFx0QHR5cGUgU3RyaW5nXG5cdFx0XHQqL1xuXHRcdFx0dWlkOiBCYXNpYy5ndWlkKCd1aWRfJyksXG5cblx0XHRcdC8qKlxuXHRcdFx0VGFyZ2V0IGZvciBVcGxvYWQgZXZlbnRzXG5cblx0XHRcdEBwcm9wZXJ0eSB1cGxvYWRcblx0XHRcdEB0eXBlIFhNTEh0dHBSZXF1ZXN0VXBsb2FkXG5cdFx0XHQqL1xuXHRcdFx0dXBsb2FkOiBuZXcgWE1MSHR0cFJlcXVlc3RVcGxvYWQoKSxcblxuXG5cdFx0XHQvKipcblx0XHRcdFNldHMgdGhlIHJlcXVlc3QgbWV0aG9kLCByZXF1ZXN0IFVSTCwgc3luY2hyb25vdXMgZmxhZywgcmVxdWVzdCB1c2VybmFtZSwgYW5kIHJlcXVlc3QgcGFzc3dvcmQuXG5cblx0XHRcdFRocm93cyBhIFwiU3ludGF4RXJyb3JcIiBleGNlcHRpb24gaWYgb25lIG9mIHRoZSBmb2xsb3dpbmcgaXMgdHJ1ZTpcblxuXHRcdFx0bWV0aG9kIGlzIG5vdCBhIHZhbGlkIEhUVFAgbWV0aG9kLlxuXHRcdFx0dXJsIGNhbm5vdCBiZSByZXNvbHZlZC5cblx0XHRcdHVybCBjb250YWlucyB0aGUgXCJ1c2VyOnBhc3N3b3JkXCIgZm9ybWF0IGluIHRoZSB1c2VyaW5mbyBwcm9kdWN0aW9uLlxuXHRcdFx0VGhyb3dzIGEgXCJTZWN1cml0eUVycm9yXCIgZXhjZXB0aW9uIGlmIG1ldGhvZCBpcyBhIGNhc2UtaW5zZW5zaXRpdmUgbWF0Y2ggZm9yIENPTk5FQ1QsIFRSQUNFIG9yIFRSQUNLLlxuXG5cdFx0XHRUaHJvd3MgYW4gXCJJbnZhbGlkQWNjZXNzRXJyb3JcIiBleGNlcHRpb24gaWYgb25lIG9mIHRoZSBmb2xsb3dpbmcgaXMgdHJ1ZTpcblxuXHRcdFx0RWl0aGVyIHVzZXIgb3IgcGFzc3dvcmQgaXMgcGFzc2VkIGFzIGFyZ3VtZW50IGFuZCB0aGUgb3JpZ2luIG9mIHVybCBkb2VzIG5vdCBtYXRjaCB0aGUgWE1MSHR0cFJlcXVlc3Qgb3JpZ2luLlxuXHRcdFx0VGhlcmUgaXMgYW4gYXNzb2NpYXRlZCBYTUxIdHRwUmVxdWVzdCBkb2N1bWVudCBhbmQgZWl0aGVyIHRoZSB0aW1lb3V0IGF0dHJpYnV0ZSBpcyBub3QgemVybyxcblx0XHRcdHRoZSB3aXRoQ3JlZGVudGlhbHMgYXR0cmlidXRlIGlzIHRydWUsIG9yIHRoZSByZXNwb25zZVR5cGUgYXR0cmlidXRlIGlzIG5vdCB0aGUgZW1wdHkgc3RyaW5nLlxuXG5cblx0XHRcdEBtZXRob2Qgb3BlblxuXHRcdFx0QHBhcmFtIHtTdHJpbmd9IG1ldGhvZCBIVFRQIG1ldGhvZCB0byB1c2Ugb24gcmVxdWVzdFxuXHRcdFx0QHBhcmFtIHtTdHJpbmd9IHVybCBVUkwgdG8gcmVxdWVzdFxuXHRcdFx0QHBhcmFtIHtCb29sZWFufSBbYXN5bmM9dHJ1ZV0gSWYgZmFsc2UgcmVxdWVzdCB3aWxsIGJlIGRvbmUgaW4gc3luY2hyb25vdXMgbWFubmVyLiBBc3luY2hyb25vdXMgYnkgZGVmYXVsdC5cblx0XHRcdEBwYXJhbSB7U3RyaW5nfSBbdXNlcl0gVXNlcm5hbWUgdG8gdXNlIGluIEhUVFAgYXV0aGVudGljYXRpb24gcHJvY2VzcyBvbiBzZXJ2ZXItc2lkZVxuXHRcdFx0QHBhcmFtIHtTdHJpbmd9IFtwYXNzd29yZF0gUGFzc3dvcmQgdG8gdXNlIGluIEhUVFAgYXV0aGVudGljYXRpb24gcHJvY2VzcyBvbiBzZXJ2ZXItc2lkZVxuXHRcdFx0Ki9cblx0XHRcdG9wZW46IGZ1bmN0aW9uKG1ldGhvZCwgdXJsLCBhc3luYywgdXNlciwgcGFzc3dvcmQpIHtcblx0XHRcdFx0dmFyIHVybHA7XG5cblx0XHRcdFx0Ly8gZmlyc3QgdHdvIGFyZ3VtZW50cyBhcmUgcmVxdWlyZWRcblx0XHRcdFx0aWYgKCFtZXRob2QgfHwgIXVybCkge1xuXHRcdFx0XHRcdHRocm93IG5ldyB4LkRPTUV4Y2VwdGlvbih4LkRPTUV4Y2VwdGlvbi5TWU5UQVhfRVJSKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIDIgLSBjaGVjayBpZiBhbnkgY29kZSBwb2ludCBpbiBtZXRob2QgaXMgaGlnaGVyIHRoYW4gVSswMEZGIG9yIGFmdGVyIGRlZmxhdGluZyBtZXRob2QgaXQgZG9lcyBub3QgbWF0Y2ggdGhlIG1ldGhvZFxuXHRcdFx0XHRpZiAoL1tcXHUwMTAwLVxcdWZmZmZdLy50ZXN0KG1ldGhvZCkgfHwgRW5jb2RlLnV0ZjhfZW5jb2RlKG1ldGhvZCkgIT09IG1ldGhvZCkge1xuXHRcdFx0XHRcdHRocm93IG5ldyB4LkRPTUV4Y2VwdGlvbih4LkRPTUV4Y2VwdGlvbi5TWU5UQVhfRVJSKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIDNcblx0XHRcdFx0aWYgKCEhfkJhc2ljLmluQXJyYXkobWV0aG9kLnRvVXBwZXJDYXNlKCksIFsnQ09OTkVDVCcsICdERUxFVEUnLCAnR0VUJywgJ0hFQUQnLCAnT1BUSU9OUycsICdQT1NUJywgJ1BVVCcsICdUUkFDRScsICdUUkFDSyddKSkge1xuXHRcdFx0XHRcdF9tZXRob2QgPSBtZXRob2QudG9VcHBlckNhc2UoKTtcblx0XHRcdFx0fVxuXG5cblx0XHRcdFx0Ly8gNCAtIGFsbG93aW5nIHRoZXNlIG1ldGhvZHMgcG9zZXMgYSBzZWN1cml0eSByaXNrXG5cdFx0XHRcdGlmICghIX5CYXNpYy5pbkFycmF5KF9tZXRob2QsIFsnQ09OTkVDVCcsICdUUkFDRScsICdUUkFDSyddKSkge1xuXHRcdFx0XHRcdHRocm93IG5ldyB4LkRPTUV4Y2VwdGlvbih4LkRPTUV4Y2VwdGlvbi5TRUNVUklUWV9FUlIpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gNVxuXHRcdFx0XHR1cmwgPSBFbmNvZGUudXRmOF9lbmNvZGUodXJsKTtcblxuXHRcdFx0XHQvLyA2IC0gUmVzb2x2ZSB1cmwgcmVsYXRpdmUgdG8gdGhlIFhNTEh0dHBSZXF1ZXN0IGJhc2UgVVJMLiBJZiB0aGUgYWxnb3JpdGhtIHJldHVybnMgYW4gZXJyb3IsIHRocm93IGEgXCJTeW50YXhFcnJvclwiLlxuXHRcdFx0XHR1cmxwID0gVXJsLnBhcnNlVXJsKHVybCk7XG5cblx0XHRcdFx0X3NhbWVfb3JpZ2luX2ZsYWcgPSBVcmwuaGFzU2FtZU9yaWdpbih1cmxwKTtcblxuXHRcdFx0XHQvLyA3IC0gbWFudWFsbHkgYnVpbGQgdXAgYWJzb2x1dGUgdXJsXG5cdFx0XHRcdF91cmwgPSBVcmwucmVzb2x2ZVVybCh1cmwpO1xuXG5cdFx0XHRcdC8vIDktMTAsIDEyLTEzXG5cdFx0XHRcdGlmICgodXNlciB8fCBwYXNzd29yZCkgJiYgIV9zYW1lX29yaWdpbl9mbGFnKSB7XG5cdFx0XHRcdFx0dGhyb3cgbmV3IHguRE9NRXhjZXB0aW9uKHguRE9NRXhjZXB0aW9uLklOVkFMSURfQUNDRVNTX0VSUik7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRfdXNlciA9IHVzZXIgfHwgdXJscC51c2VyO1xuXHRcdFx0XHRfcGFzc3dvcmQgPSBwYXNzd29yZCB8fCB1cmxwLnBhc3M7XG5cblx0XHRcdFx0Ly8gMTFcblx0XHRcdFx0X2FzeW5jID0gYXN5bmMgfHwgdHJ1ZTtcblxuXHRcdFx0XHRpZiAoX2FzeW5jID09PSBmYWxzZSAmJiAoX3AoJ3RpbWVvdXQnKSB8fCBfcCgnd2l0aENyZWRlbnRpYWxzJykgfHwgX3AoJ3Jlc3BvbnNlVHlwZScpICE9PSBcIlwiKSkge1xuXHRcdFx0XHRcdHRocm93IG5ldyB4LkRPTUV4Y2VwdGlvbih4LkRPTUV4Y2VwdGlvbi5JTlZBTElEX0FDQ0VTU19FUlIpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gMTQgLSB0ZXJtaW5hdGUgYWJvcnQoKVxuXG5cdFx0XHRcdC8vIDE1IC0gdGVybWluYXRlIHNlbmQoKVxuXG5cdFx0XHRcdC8vIDE4XG5cdFx0XHRcdF9zeW5jX2ZsYWcgPSAhX2FzeW5jO1xuXHRcdFx0XHRfc2VuZF9mbGFnID0gZmFsc2U7XG5cdFx0XHRcdF9oZWFkZXJzID0ge307XG5cdFx0XHRcdF9yZXNldC5jYWxsKHRoaXMpO1xuXG5cdFx0XHRcdC8vIDE5XG5cdFx0XHRcdF9wKCdyZWFkeVN0YXRlJywgWE1MSHR0cFJlcXVlc3QuT1BFTkVEKTtcblxuXHRcdFx0XHQvLyAyMFxuXHRcdFx0XHR0aGlzLmRpc3BhdGNoRXZlbnQoJ3JlYWR5c3RhdGVjaGFuZ2UnKTtcblx0XHRcdH0sXG5cblx0XHRcdC8qKlxuXHRcdFx0QXBwZW5kcyBhbiBoZWFkZXIgdG8gdGhlIGxpc3Qgb2YgYXV0aG9yIHJlcXVlc3QgaGVhZGVycywgb3IgaWYgaGVhZGVyIGlzIGFscmVhZHlcblx0XHRcdGluIHRoZSBsaXN0IG9mIGF1dGhvciByZXF1ZXN0IGhlYWRlcnMsIGNvbWJpbmVzIGl0cyB2YWx1ZSB3aXRoIHZhbHVlLlxuXG5cdFx0XHRUaHJvd3MgYW4gXCJJbnZhbGlkU3RhdGVFcnJvclwiIGV4Y2VwdGlvbiBpZiB0aGUgc3RhdGUgaXMgbm90IE9QRU5FRCBvciBpZiB0aGUgc2VuZCgpIGZsYWcgaXMgc2V0LlxuXHRcdFx0VGhyb3dzIGEgXCJTeW50YXhFcnJvclwiIGV4Y2VwdGlvbiBpZiBoZWFkZXIgaXMgbm90IGEgdmFsaWQgSFRUUCBoZWFkZXIgZmllbGQgbmFtZSBvciBpZiB2YWx1ZVxuXHRcdFx0aXMgbm90IGEgdmFsaWQgSFRUUCBoZWFkZXIgZmllbGQgdmFsdWUuXG5cblx0XHRcdEBtZXRob2Qgc2V0UmVxdWVzdEhlYWRlclxuXHRcdFx0QHBhcmFtIHtTdHJpbmd9IGhlYWRlclxuXHRcdFx0QHBhcmFtIHtTdHJpbmd8TnVtYmVyfSB2YWx1ZVxuXHRcdFx0Ki9cblx0XHRcdHNldFJlcXVlc3RIZWFkZXI6IGZ1bmN0aW9uKGhlYWRlciwgdmFsdWUpIHtcblx0XHRcdFx0dmFyIHVhSGVhZGVycyA9IFsgLy8gdGhlc2UgaGVhZGVycyBhcmUgY29udHJvbGxlZCBieSB0aGUgdXNlciBhZ2VudFxuXHRcdFx0XHRcdFx0XCJhY2NlcHQtY2hhcnNldFwiLFxuXHRcdFx0XHRcdFx0XCJhY2NlcHQtZW5jb2RpbmdcIixcblx0XHRcdFx0XHRcdFwiYWNjZXNzLWNvbnRyb2wtcmVxdWVzdC1oZWFkZXJzXCIsXG5cdFx0XHRcdFx0XHRcImFjY2Vzcy1jb250cm9sLXJlcXVlc3QtbWV0aG9kXCIsXG5cdFx0XHRcdFx0XHRcImNvbm5lY3Rpb25cIixcblx0XHRcdFx0XHRcdFwiY29udGVudC1sZW5ndGhcIixcblx0XHRcdFx0XHRcdFwiY29va2llXCIsXG5cdFx0XHRcdFx0XHRcImNvb2tpZTJcIixcblx0XHRcdFx0XHRcdFwiY29udGVudC10cmFuc2Zlci1lbmNvZGluZ1wiLFxuXHRcdFx0XHRcdFx0XCJkYXRlXCIsXG5cdFx0XHRcdFx0XHRcImV4cGVjdFwiLFxuXHRcdFx0XHRcdFx0XCJob3N0XCIsXG5cdFx0XHRcdFx0XHRcImtlZXAtYWxpdmVcIixcblx0XHRcdFx0XHRcdFwib3JpZ2luXCIsXG5cdFx0XHRcdFx0XHRcInJlZmVyZXJcIixcblx0XHRcdFx0XHRcdFwidGVcIixcblx0XHRcdFx0XHRcdFwidHJhaWxlclwiLFxuXHRcdFx0XHRcdFx0XCJ0cmFuc2Zlci1lbmNvZGluZ1wiLFxuXHRcdFx0XHRcdFx0XCJ1cGdyYWRlXCIsXG5cdFx0XHRcdFx0XHRcInVzZXItYWdlbnRcIixcblx0XHRcdFx0XHRcdFwidmlhXCJcblx0XHRcdFx0XHRdO1xuXG5cdFx0XHRcdC8vIDEtMlxuXHRcdFx0XHRpZiAoX3AoJ3JlYWR5U3RhdGUnKSAhPT0gWE1MSHR0cFJlcXVlc3QuT1BFTkVEIHx8IF9zZW5kX2ZsYWcpIHtcblx0XHRcdFx0XHR0aHJvdyBuZXcgeC5ET01FeGNlcHRpb24oeC5ET01FeGNlcHRpb24uSU5WQUxJRF9TVEFURV9FUlIpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gM1xuXHRcdFx0XHRpZiAoL1tcXHUwMTAwLVxcdWZmZmZdLy50ZXN0KGhlYWRlcikgfHwgRW5jb2RlLnV0ZjhfZW5jb2RlKGhlYWRlcikgIT09IGhlYWRlcikge1xuXHRcdFx0XHRcdHRocm93IG5ldyB4LkRPTUV4Y2VwdGlvbih4LkRPTUV4Y2VwdGlvbi5TWU5UQVhfRVJSKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIDRcblx0XHRcdFx0LyogdGhpcyBzdGVwIGlzIHNlZW1pbmdseSBieXBhc3NlZCBpbiBicm93c2VycywgcHJvYmFibHkgdG8gYWxsb3cgdmFyaW91cyB1bmljb2RlIGNoYXJhY3RlcnMgaW4gaGVhZGVyIHZhbHVlc1xuXHRcdFx0XHRpZiAoL1tcXHUwMTAwLVxcdWZmZmZdLy50ZXN0KHZhbHVlKSB8fCBFbmNvZGUudXRmOF9lbmNvZGUodmFsdWUpICE9PSB2YWx1ZSkge1xuXHRcdFx0XHRcdHRocm93IG5ldyB4LkRPTUV4Y2VwdGlvbih4LkRPTUV4Y2VwdGlvbi5TWU5UQVhfRVJSKTtcblx0XHRcdFx0fSovXG5cblx0XHRcdFx0aGVhZGVyID0gQmFzaWMudHJpbShoZWFkZXIpLnRvTG93ZXJDYXNlKCk7XG5cblx0XHRcdFx0Ly8gc2V0dGluZyBvZiBwcm94eS0qIGFuZCBzZWMtKiBoZWFkZXJzIGlzIHByb2hpYml0ZWQgYnkgc3BlY1xuXHRcdFx0XHRpZiAoISF+QmFzaWMuaW5BcnJheShoZWFkZXIsIHVhSGVhZGVycykgfHwgL14ocHJveHlcXC18c2VjXFwtKS8udGVzdChoZWFkZXIpKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gY2FtZWxpemVcblx0XHRcdFx0Ly8gYnJvd3NlcnMgbG93ZXJjYXNlIGhlYWRlciBuYW1lcyAoYXQgbGVhc3QgZm9yIGN1c3RvbSBvbmVzKVxuXHRcdFx0XHQvLyBoZWFkZXIgPSBoZWFkZXIucmVwbGFjZSgvXFxiXFx3L2csIGZ1bmN0aW9uKCQxKSB7IHJldHVybiAkMS50b1VwcGVyQ2FzZSgpOyB9KTtcblxuXHRcdFx0XHRpZiAoIV9oZWFkZXJzW2hlYWRlcl0pIHtcblx0XHRcdFx0XHRfaGVhZGVyc1toZWFkZXJdID0gdmFsdWU7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Ly8gaHR0cDovL3Rvb2xzLmlldGYub3JnL2h0bWwvcmZjMjYxNiNzZWN0aW9uLTQuMiAobGFzdCBwYXJhZ3JhcGgpXG5cdFx0XHRcdFx0X2hlYWRlcnNbaGVhZGVyXSArPSAnLCAnICsgdmFsdWU7XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHR9LFxuXG5cdFx0XHQvKipcblx0XHRcdCAqIFRlc3QgaWYgdGhlIHNwZWNpZmllZCBoZWFkZXIgaXMgYWxyZWFkeSBzZXQgb24gdGhpcyByZXF1ZXN0LlxuXHRcdFx0ICogUmV0dXJucyBhIGhlYWRlciB2YWx1ZSBvciBib29sZWFuIGZhbHNlIGlmIGl0J3Mgbm90IHlldCBzZXQuXG5cdFx0XHQgKlxuXHRcdFx0ICogQG1ldGhvZCBoYXNSZXF1ZXN0SGVhZGVyXG5cdFx0XHQgKiBAcGFyYW0ge1N0cmluZ30gaGVhZGVyIE5hbWUgb2YgdGhlIGhlYWRlciB0byB0ZXN0XG5cdFx0XHQgKiBAcmV0dXJuIHtCb29sZWFufFN0cmluZ31cblx0XHRcdCAqL1xuXHRcdFx0aGFzUmVxdWVzdEhlYWRlcjogZnVuY3Rpb24oaGVhZGVyKSB7XG5cdFx0XHRcdHJldHVybiBoZWFkZXIgJiYgX2hlYWRlcnNbaGVhZGVyLnRvTG93ZXJDYXNlKCldIHx8IGZhbHNlO1xuXHRcdFx0fSxcblxuXHRcdFx0LyoqXG5cdFx0XHRSZXR1cm5zIGFsbCBoZWFkZXJzIGZyb20gdGhlIHJlc3BvbnNlLCB3aXRoIHRoZSBleGNlcHRpb24gb2YgdGhvc2Ugd2hvc2UgZmllbGQgbmFtZSBpcyBTZXQtQ29va2llIG9yIFNldC1Db29raWUyLlxuXG5cdFx0XHRAbWV0aG9kIGdldEFsbFJlc3BvbnNlSGVhZGVyc1xuXHRcdFx0QHJldHVybiB7U3RyaW5nfSByZXBvbnNlIGhlYWRlcnMgb3IgZW1wdHkgc3RyaW5nXG5cdFx0XHQqL1xuXHRcdFx0Z2V0QWxsUmVzcG9uc2VIZWFkZXJzOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIF9yZXNwb25zZUhlYWRlcnMgfHwgJyc7XG5cdFx0XHR9LFxuXG5cdFx0XHQvKipcblx0XHRcdFJldHVybnMgdGhlIGhlYWRlciBmaWVsZCB2YWx1ZSBmcm9tIHRoZSByZXNwb25zZSBvZiB3aGljaCB0aGUgZmllbGQgbmFtZSBtYXRjaGVzIGhlYWRlcixcblx0XHRcdHVubGVzcyB0aGUgZmllbGQgbmFtZSBpcyBTZXQtQ29va2llIG9yIFNldC1Db29raWUyLlxuXG5cdFx0XHRAbWV0aG9kIGdldFJlc3BvbnNlSGVhZGVyXG5cdFx0XHRAcGFyYW0ge1N0cmluZ30gaGVhZGVyXG5cdFx0XHRAcmV0dXJuIHtTdHJpbmd9IHZhbHVlKHMpIGZvciB0aGUgc3BlY2lmaWVkIGhlYWRlciBvciBudWxsXG5cdFx0XHQqL1xuXHRcdFx0Z2V0UmVzcG9uc2VIZWFkZXI6IGZ1bmN0aW9uKGhlYWRlcikge1xuXHRcdFx0XHRoZWFkZXIgPSBoZWFkZXIudG9Mb3dlckNhc2UoKTtcblxuXHRcdFx0XHRpZiAoX2Vycm9yX2ZsYWcgfHwgISF+QmFzaWMuaW5BcnJheShoZWFkZXIsIFsnc2V0LWNvb2tpZScsICdzZXQtY29va2llMiddKSkge1xuXHRcdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKF9yZXNwb25zZUhlYWRlcnMgJiYgX3Jlc3BvbnNlSGVhZGVycyAhPT0gJycpIHtcblx0XHRcdFx0XHQvLyBpZiB3ZSBkaWRuJ3QgcGFyc2UgcmVzcG9uc2UgaGVhZGVycyB1bnRpbCBub3csIGRvIGl0IGFuZCBrZWVwIGZvciBsYXRlclxuXHRcdFx0XHRcdGlmICghX3Jlc3BvbnNlSGVhZGVyc0JhZykge1xuXHRcdFx0XHRcdFx0X3Jlc3BvbnNlSGVhZGVyc0JhZyA9IHt9O1xuXHRcdFx0XHRcdFx0QmFzaWMuZWFjaChfcmVzcG9uc2VIZWFkZXJzLnNwbGl0KC9cXHJcXG4vKSwgZnVuY3Rpb24obGluZSkge1xuXHRcdFx0XHRcdFx0XHR2YXIgcGFpciA9IGxpbmUuc3BsaXQoLzpcXHMrLyk7XG5cdFx0XHRcdFx0XHRcdGlmIChwYWlyLmxlbmd0aCA9PT0gMikgeyAvLyBsYXN0IGxpbmUgbWlnaHQgYmUgZW1wdHksIG9taXRcblx0XHRcdFx0XHRcdFx0XHRwYWlyWzBdID0gQmFzaWMudHJpbShwYWlyWzBdKTsgLy8ganVzdCBpbiBjYXNlXG5cdFx0XHRcdFx0XHRcdFx0X3Jlc3BvbnNlSGVhZGVyc0JhZ1twYWlyWzBdLnRvTG93ZXJDYXNlKCldID0geyAvLyBzaW1wbHkgdG8gcmV0YWluIGhlYWRlciBuYW1lIGluIG9yaWdpbmFsIGZvcm1cblx0XHRcdFx0XHRcdFx0XHRcdGhlYWRlcjogcGFpclswXSxcblx0XHRcdFx0XHRcdFx0XHRcdHZhbHVlOiBCYXNpYy50cmltKHBhaXJbMV0pXG5cdFx0XHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGlmIChfcmVzcG9uc2VIZWFkZXJzQmFnLmhhc093blByb3BlcnR5KGhlYWRlcikpIHtcblx0XHRcdFx0XHRcdHJldHVybiBfcmVzcG9uc2VIZWFkZXJzQmFnW2hlYWRlcl0uaGVhZGVyICsgJzogJyArIF9yZXNwb25zZUhlYWRlcnNCYWdbaGVhZGVyXS52YWx1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9LFxuXG5cdFx0XHQvKipcblx0XHRcdFNldHMgdGhlIENvbnRlbnQtVHlwZSBoZWFkZXIgZm9yIHRoZSByZXNwb25zZSB0byBtaW1lLlxuXHRcdFx0VGhyb3dzIGFuIFwiSW52YWxpZFN0YXRlRXJyb3JcIiBleGNlcHRpb24gaWYgdGhlIHN0YXRlIGlzIExPQURJTkcgb3IgRE9ORS5cblx0XHRcdFRocm93cyBhIFwiU3ludGF4RXJyb3JcIiBleGNlcHRpb24gaWYgbWltZSBpcyBub3QgYSB2YWxpZCBtZWRpYSB0eXBlLlxuXG5cdFx0XHRAbWV0aG9kIG92ZXJyaWRlTWltZVR5cGVcblx0XHRcdEBwYXJhbSBTdHJpbmcgbWltZSBNaW1lIHR5cGUgdG8gc2V0XG5cdFx0XHQqL1xuXHRcdFx0b3ZlcnJpZGVNaW1lVHlwZTogZnVuY3Rpb24obWltZSkge1xuXHRcdFx0XHR2YXIgbWF0Y2hlcywgY2hhcnNldDtcblxuXHRcdFx0XHQvLyAxXG5cdFx0XHRcdGlmICghIX5CYXNpYy5pbkFycmF5KF9wKCdyZWFkeVN0YXRlJyksIFtYTUxIdHRwUmVxdWVzdC5MT0FESU5HLCBYTUxIdHRwUmVxdWVzdC5ET05FXSkpIHtcblx0XHRcdFx0XHR0aHJvdyBuZXcgeC5ET01FeGNlcHRpb24oeC5ET01FeGNlcHRpb24uSU5WQUxJRF9TVEFURV9FUlIpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gMlxuXHRcdFx0XHRtaW1lID0gQmFzaWMudHJpbShtaW1lLnRvTG93ZXJDYXNlKCkpO1xuXG5cdFx0XHRcdGlmICgvOy8udGVzdChtaW1lKSAmJiAobWF0Y2hlcyA9IG1pbWUubWF0Y2goL14oW147XSspKD86O1xcc2NoYXJzZXRcXD0pPyguKikkLykpKSB7XG5cdFx0XHRcdFx0bWltZSA9IG1hdGNoZXNbMV07XG5cdFx0XHRcdFx0aWYgKG1hdGNoZXNbMl0pIHtcblx0XHRcdFx0XHRcdGNoYXJzZXQgPSBtYXRjaGVzWzJdO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmICghTWltZS5taW1lc1ttaW1lXSkge1xuXHRcdFx0XHRcdHRocm93IG5ldyB4LkRPTUV4Y2VwdGlvbih4LkRPTUV4Y2VwdGlvbi5TWU5UQVhfRVJSKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIDMtNFxuXHRcdFx0XHRfZmluYWxNaW1lID0gbWltZTtcblx0XHRcdFx0X2ZpbmFsQ2hhcnNldCA9IGNoYXJzZXQ7XG5cdFx0XHR9LFxuXG5cdFx0XHQvKipcblx0XHRcdEluaXRpYXRlcyB0aGUgcmVxdWVzdC4gVGhlIG9wdGlvbmFsIGFyZ3VtZW50IHByb3ZpZGVzIHRoZSByZXF1ZXN0IGVudGl0eSBib2R5LlxuXHRcdFx0VGhlIGFyZ3VtZW50IGlzIGlnbm9yZWQgaWYgcmVxdWVzdCBtZXRob2QgaXMgR0VUIG9yIEhFQUQuXG5cblx0XHRcdFRocm93cyBhbiBcIkludmFsaWRTdGF0ZUVycm9yXCIgZXhjZXB0aW9uIGlmIHRoZSBzdGF0ZSBpcyBub3QgT1BFTkVEIG9yIGlmIHRoZSBzZW5kKCkgZmxhZyBpcyBzZXQuXG5cblx0XHRcdEBtZXRob2Qgc2VuZFxuXHRcdFx0QHBhcmFtIHtCbG9ifERvY3VtZW50fFN0cmluZ3xGb3JtRGF0YX0gW2RhdGFdIFJlcXVlc3QgZW50aXR5IGJvZHlcblx0XHRcdEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc10gU2V0IG9mIHJlcXVpcmVtZW50cyBhbmQgcHJlLXJlcXVpc2l0aWVzIGZvciBydW50aW1lIGluaXRpYWxpemF0aW9uXG5cdFx0XHQqL1xuXHRcdFx0c2VuZDogZnVuY3Rpb24oZGF0YSwgb3B0aW9ucykge1xuXHRcdFx0XHRpZiAoQmFzaWMudHlwZU9mKG9wdGlvbnMpID09PSAnc3RyaW5nJykge1xuXHRcdFx0XHRcdF9vcHRpb25zID0geyBydWlkOiBvcHRpb25zIH07XG5cdFx0XHRcdH0gZWxzZSBpZiAoIW9wdGlvbnMpIHtcblx0XHRcdFx0XHRfb3B0aW9ucyA9IHt9O1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdF9vcHRpb25zID0gb3B0aW9ucztcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIDEtMlxuXHRcdFx0XHRpZiAodGhpcy5yZWFkeVN0YXRlICE9PSBYTUxIdHRwUmVxdWVzdC5PUEVORUQgfHwgX3NlbmRfZmxhZykge1xuXHRcdFx0XHRcdHRocm93IG5ldyB4LkRPTUV4Y2VwdGlvbih4LkRPTUV4Y2VwdGlvbi5JTlZBTElEX1NUQVRFX0VSUik7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyAzXG5cdFx0XHRcdC8vIHNlbmRpbmcgQmxvYlxuXHRcdFx0XHRpZiAoZGF0YSBpbnN0YW5jZW9mIEJsb2IpIHtcblx0XHRcdFx0XHRfb3B0aW9ucy5ydWlkID0gZGF0YS5ydWlkO1xuXHRcdFx0XHRcdF9taW1lVHlwZSA9IGRhdGEudHlwZSB8fCAnYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtJztcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIEZvcm1EYXRhXG5cdFx0XHRcdGVsc2UgaWYgKGRhdGEgaW5zdGFuY2VvZiBGb3JtRGF0YSkge1xuXHRcdFx0XHRcdGlmIChkYXRhLmhhc0Jsb2IoKSkge1xuXHRcdFx0XHRcdFx0dmFyIGJsb2IgPSBkYXRhLmdldEJsb2IoKTtcblx0XHRcdFx0XHRcdF9vcHRpb25zLnJ1aWQgPSBibG9iLnJ1aWQ7XG5cdFx0XHRcdFx0XHRfbWltZVR5cGUgPSBibG9iLnR5cGUgfHwgJ2FwcGxpY2F0aW9uL29jdGV0LXN0cmVhbSc7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gRE9NU3RyaW5nXG5cdFx0XHRcdGVsc2UgaWYgKHR5cGVvZiBkYXRhID09PSAnc3RyaW5nJykge1xuXHRcdFx0XHRcdF9lbmNvZGluZyA9ICdVVEYtOCc7XG5cdFx0XHRcdFx0X21pbWVUeXBlID0gJ3RleHQvcGxhaW47Y2hhcnNldD1VVEYtOCc7XG5cblx0XHRcdFx0XHQvLyBkYXRhIHNob3VsZCBiZSBjb252ZXJ0ZWQgdG8gVW5pY29kZSBhbmQgZW5jb2RlZCBhcyBVVEYtOFxuXHRcdFx0XHRcdGRhdGEgPSBFbmNvZGUudXRmOF9lbmNvZGUoZGF0YSk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBpZiB3aXRoQ3JlZGVudGlhbHMgbm90IHNldCwgYnV0IHJlcXVlc3RlZCwgc2V0IGl0IGF1dG9tYXRpY2FsbHlcblx0XHRcdFx0aWYgKCF0aGlzLndpdGhDcmVkZW50aWFscykge1xuXHRcdFx0XHRcdHRoaXMud2l0aENyZWRlbnRpYWxzID0gKF9vcHRpb25zLnJlcXVpcmVkX2NhcHMgJiYgX29wdGlvbnMucmVxdWlyZWRfY2Fwcy5zZW5kX2Jyb3dzZXJfY29va2llcykgJiYgIV9zYW1lX29yaWdpbl9mbGFnO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gNCAtIHN0b3JhZ2UgbXV0ZXhcblx0XHRcdFx0Ly8gNVxuXHRcdFx0XHRfdXBsb2FkX2V2ZW50c19mbGFnID0gKCFfc3luY19mbGFnICYmIHRoaXMudXBsb2FkLmhhc0V2ZW50TGlzdGVuZXIoKSk7IC8vIERTQVBcblx0XHRcdFx0Ly8gNlxuXHRcdFx0XHRfZXJyb3JfZmxhZyA9IGZhbHNlO1xuXHRcdFx0XHQvLyA3XG5cdFx0XHRcdF91cGxvYWRfY29tcGxldGVfZmxhZyA9ICFkYXRhO1xuXHRcdFx0XHQvLyA4IC0gQXN5bmNocm9ub3VzIHN0ZXBzXG5cdFx0XHRcdGlmICghX3N5bmNfZmxhZykge1xuXHRcdFx0XHRcdC8vIDguMVxuXHRcdFx0XHRcdF9zZW5kX2ZsYWcgPSB0cnVlO1xuXHRcdFx0XHRcdC8vIDguMlxuXHRcdFx0XHRcdC8vIHRoaXMuZGlzcGF0Y2hFdmVudCgnbG9hZHN0YXJ0Jyk7IC8vIHdpbGwgYmUgZGlzcGF0Y2hlZCBlaXRoZXIgYnkgbmF0aXZlIG9yIHJ1bnRpbWUgeGhyXG5cdFx0XHRcdFx0Ly8gOC4zXG5cdFx0XHRcdFx0Ly9pZiAoIV91cGxvYWRfY29tcGxldGVfZmxhZykge1xuXHRcdFx0XHRcdFx0Ly8gdGhpcy51cGxvYWQuZGlzcGF0Y2hFdmVudCgnbG9hZHN0YXJ0Jyk7XHQvLyB3aWxsIGJlIGRpc3BhdGNoZWQgZWl0aGVyIGJ5IG5hdGl2ZSBvciBydW50aW1lIHhoclxuXHRcdFx0XHRcdC8vfVxuXHRcdFx0XHR9XG5cdFx0XHRcdC8vIDguNSAtIFJldHVybiB0aGUgc2VuZCgpIG1ldGhvZCBjYWxsLCBidXQgY29udGludWUgcnVubmluZyB0aGUgc3RlcHMgaW4gdGhpcyBhbGdvcml0aG0uXG5cdFx0XHRcdF9kb1hIUi5jYWxsKHRoaXMsIGRhdGEpO1xuXHRcdFx0fSxcblxuXHRcdFx0LyoqXG5cdFx0XHRDYW5jZWxzIGFueSBuZXR3b3JrIGFjdGl2aXR5LlxuXG5cdFx0XHRAbWV0aG9kIGFib3J0XG5cdFx0XHQqL1xuXHRcdFx0YWJvcnQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRfZXJyb3JfZmxhZyA9IHRydWU7XG5cdFx0XHRcdF9zeW5jX2ZsYWcgPSBmYWxzZTtcblxuXHRcdFx0XHRpZiAoIX5CYXNpYy5pbkFycmF5KF9wKCdyZWFkeVN0YXRlJyksIFtYTUxIdHRwUmVxdWVzdC5VTlNFTlQsIFhNTEh0dHBSZXF1ZXN0Lk9QRU5FRCwgWE1MSHR0cFJlcXVlc3QuRE9ORV0pKSB7XG5cdFx0XHRcdFx0X3AoJ3JlYWR5U3RhdGUnLCBYTUxIdHRwUmVxdWVzdC5ET05FKTtcblx0XHRcdFx0XHRfc2VuZF9mbGFnID0gZmFsc2U7XG5cblx0XHRcdFx0XHRpZiAoX3hocikge1xuXHRcdFx0XHRcdFx0X3hoci5nZXRSdW50aW1lKCkuZXhlYy5jYWxsKF94aHIsICdYTUxIdHRwUmVxdWVzdCcsICdhYm9ydCcsIF91cGxvYWRfY29tcGxldGVfZmxhZyk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHRocm93IG5ldyB4LkRPTUV4Y2VwdGlvbih4LkRPTUV4Y2VwdGlvbi5JTlZBTElEX1NUQVRFX0VSUik7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0X3VwbG9hZF9jb21wbGV0ZV9mbGFnID0gdHJ1ZTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRfcCgncmVhZHlTdGF0ZScsIFhNTEh0dHBSZXF1ZXN0LlVOU0VOVCk7XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cblx0XHRcdGRlc3Ryb3k6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRpZiAoX3hocikge1xuXHRcdFx0XHRcdGlmIChCYXNpYy50eXBlT2YoX3hoci5kZXN0cm95KSA9PT0gJ2Z1bmN0aW9uJykge1xuXHRcdFx0XHRcdFx0X3hoci5kZXN0cm95KCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdF94aHIgPSBudWxsO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0dGhpcy51bmJpbmRBbGwoKTtcblxuXHRcdFx0XHRpZiAodGhpcy51cGxvYWQpIHtcblx0XHRcdFx0XHR0aGlzLnVwbG9hZC51bmJpbmRBbGwoKTtcblx0XHRcdFx0XHR0aGlzLnVwbG9hZCA9IG51bGw7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHRoaXMuaGFuZGxlRXZlbnRQcm9wcyhkaXNwYXRjaGVzLmNvbmNhdChbJ3JlYWR5c3RhdGVjaGFuZ2UnXSkpOyAvLyBmb3IgaGlzdG9yaWNhbCByZWFzb25zXG5cdFx0dGhpcy51cGxvYWQuaGFuZGxlRXZlbnRQcm9wcyhkaXNwYXRjaGVzKTtcblxuXHRcdC8qIHRoaXMgaXMgbmljZSwgYnV0IG1heWJlIHRvbyBsZW5ndGh5XG5cblx0XHQvLyBpZiBzdXBwb3J0ZWQgYnkgSlMgdmVyc2lvbiwgc2V0IGdldHRlcnMvc2V0dGVycyBmb3Igc3BlY2lmaWMgcHJvcGVydGllc1xuXHRcdG8uZGVmaW5lUHJvcGVydHkodGhpcywgJ3JlYWR5U3RhdGUnLCB7XG5cdFx0XHRjb25maWd1cmFibGU6IGZhbHNlLFxuXG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gX3AoJ3JlYWR5U3RhdGUnKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdG8uZGVmaW5lUHJvcGVydHkodGhpcywgJ3RpbWVvdXQnLCB7XG5cdFx0XHRjb25maWd1cmFibGU6IGZhbHNlLFxuXG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gX3AoJ3RpbWVvdXQnKTtcblx0XHRcdH0sXG5cblx0XHRcdHNldDogZnVuY3Rpb24odmFsdWUpIHtcblxuXHRcdFx0XHRpZiAoX3N5bmNfZmxhZykge1xuXHRcdFx0XHRcdHRocm93IG5ldyB4LkRPTUV4Y2VwdGlvbih4LkRPTUV4Y2VwdGlvbi5JTlZBTElEX0FDQ0VTU19FUlIpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gdGltZW91dCBzdGlsbCBzaG91bGQgYmUgbWVhc3VyZWQgcmVsYXRpdmUgdG8gdGhlIHN0YXJ0IHRpbWUgb2YgcmVxdWVzdFxuXHRcdFx0XHRfdGltZW91dHNldF90aW1lID0gKG5ldyBEYXRlKS5nZXRUaW1lKCk7XG5cblx0XHRcdFx0X3AoJ3RpbWVvdXQnLCB2YWx1ZSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHQvLyB0aGUgd2l0aENyZWRlbnRpYWxzIGF0dHJpYnV0ZSBoYXMgbm8gZWZmZWN0IHdoZW4gZmV0Y2hpbmcgc2FtZS1vcmlnaW4gcmVzb3VyY2VzXG5cdFx0by5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAnd2l0aENyZWRlbnRpYWxzJywge1xuXHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcblxuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIF9wKCd3aXRoQ3JlZGVudGlhbHMnKTtcblx0XHRcdH0sXG5cblx0XHRcdHNldDogZnVuY3Rpb24odmFsdWUpIHtcblx0XHRcdFx0Ly8gMS0yXG5cdFx0XHRcdGlmICghfm8uaW5BcnJheShfcCgncmVhZHlTdGF0ZScpLCBbWE1MSHR0cFJlcXVlc3QuVU5TRU5ULCBYTUxIdHRwUmVxdWVzdC5PUEVORURdKSB8fCBfc2VuZF9mbGFnKSB7XG5cdFx0XHRcdFx0dGhyb3cgbmV3IHguRE9NRXhjZXB0aW9uKHguRE9NRXhjZXB0aW9uLklOVkFMSURfU1RBVEVfRVJSKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIDMtNFxuXHRcdFx0XHRpZiAoX2Fub255bW91c19mbGFnIHx8IF9zeW5jX2ZsYWcpIHtcblx0XHRcdFx0XHR0aHJvdyBuZXcgeC5ET01FeGNlcHRpb24oeC5ET01FeGNlcHRpb24uSU5WQUxJRF9BQ0NFU1NfRVJSKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIDVcblx0XHRcdFx0X3AoJ3dpdGhDcmVkZW50aWFscycsIHZhbHVlKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdG8uZGVmaW5lUHJvcGVydHkodGhpcywgJ3N0YXR1cycsIHtcblx0XHRcdGNvbmZpZ3VyYWJsZTogZmFsc2UsXG5cblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiBfcCgnc3RhdHVzJyk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRvLmRlZmluZVByb3BlcnR5KHRoaXMsICdzdGF0dXNUZXh0Jywge1xuXHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcblxuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIF9wKCdzdGF0dXNUZXh0Jyk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRvLmRlZmluZVByb3BlcnR5KHRoaXMsICdyZXNwb25zZVR5cGUnLCB7XG5cdFx0XHRjb25maWd1cmFibGU6IGZhbHNlLFxuXG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gX3AoJ3Jlc3BvbnNlVHlwZScpO1xuXHRcdFx0fSxcblxuXHRcdFx0c2V0OiBmdW5jdGlvbih2YWx1ZSkge1xuXHRcdFx0XHQvLyAxXG5cdFx0XHRcdGlmICghIX5vLmluQXJyYXkoX3AoJ3JlYWR5U3RhdGUnKSwgW1hNTEh0dHBSZXF1ZXN0LkxPQURJTkcsIFhNTEh0dHBSZXF1ZXN0LkRPTkVdKSkge1xuXHRcdFx0XHRcdHRocm93IG5ldyB4LkRPTUV4Y2VwdGlvbih4LkRPTUV4Y2VwdGlvbi5JTlZBTElEX1NUQVRFX0VSUik7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyAyXG5cdFx0XHRcdGlmIChfc3luY19mbGFnKSB7XG5cdFx0XHRcdFx0dGhyb3cgbmV3IHguRE9NRXhjZXB0aW9uKHguRE9NRXhjZXB0aW9uLklOVkFMSURfQUNDRVNTX0VSUik7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyAzXG5cdFx0XHRcdF9wKCdyZXNwb25zZVR5cGUnLCB2YWx1ZS50b0xvd2VyQ2FzZSgpKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdG8uZGVmaW5lUHJvcGVydHkodGhpcywgJ3Jlc3BvbnNlVGV4dCcsIHtcblx0XHRcdGNvbmZpZ3VyYWJsZTogZmFsc2UsXG5cblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdC8vIDFcblx0XHRcdFx0aWYgKCF+by5pbkFycmF5KF9wKCdyZXNwb25zZVR5cGUnKSwgWycnLCAndGV4dCddKSkge1xuXHRcdFx0XHRcdHRocm93IG5ldyB4LkRPTUV4Y2VwdGlvbih4LkRPTUV4Y2VwdGlvbi5JTlZBTElEX1NUQVRFX0VSUik7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyAyLTNcblx0XHRcdFx0aWYgKF9wKCdyZWFkeVN0YXRlJykgIT09IFhNTEh0dHBSZXF1ZXN0LkRPTkUgJiYgX3AoJ3JlYWR5U3RhdGUnKSAhPT0gWE1MSHR0cFJlcXVlc3QuTE9BRElORyB8fCBfZXJyb3JfZmxhZykge1xuXHRcdFx0XHRcdHRocm93IG5ldyB4LkRPTUV4Y2VwdGlvbih4LkRPTUV4Y2VwdGlvbi5JTlZBTElEX1NUQVRFX0VSUik7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXR1cm4gX3AoJ3Jlc3BvbnNlVGV4dCcpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0by5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAncmVzcG9uc2VYTUwnLCB7XG5cdFx0XHRjb25maWd1cmFibGU6IGZhbHNlLFxuXG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHQvLyAxXG5cdFx0XHRcdGlmICghfm8uaW5BcnJheShfcCgncmVzcG9uc2VUeXBlJyksIFsnJywgJ2RvY3VtZW50J10pKSB7XG5cdFx0XHRcdFx0dGhyb3cgbmV3IHguRE9NRXhjZXB0aW9uKHguRE9NRXhjZXB0aW9uLklOVkFMSURfU1RBVEVfRVJSKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIDItM1xuXHRcdFx0XHRpZiAoX3AoJ3JlYWR5U3RhdGUnKSAhPT0gWE1MSHR0cFJlcXVlc3QuRE9ORSB8fCBfZXJyb3JfZmxhZykge1xuXHRcdFx0XHRcdHRocm93IG5ldyB4LkRPTUV4Y2VwdGlvbih4LkRPTUV4Y2VwdGlvbi5JTlZBTElEX1NUQVRFX0VSUik7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXR1cm4gX3AoJ3Jlc3BvbnNlWE1MJyk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRvLmRlZmluZVByb3BlcnR5KHRoaXMsICdyZXNwb25zZScsIHtcblx0XHRcdGNvbmZpZ3VyYWJsZTogZmFsc2UsXG5cblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGlmICghIX5vLmluQXJyYXkoX3AoJ3Jlc3BvbnNlVHlwZScpLCBbJycsICd0ZXh0J10pKSB7XG5cdFx0XHRcdFx0aWYgKF9wKCdyZWFkeVN0YXRlJykgIT09IFhNTEh0dHBSZXF1ZXN0LkRPTkUgJiYgX3AoJ3JlYWR5U3RhdGUnKSAhPT0gWE1MSHR0cFJlcXVlc3QuTE9BRElORyB8fCBfZXJyb3JfZmxhZykge1xuXHRcdFx0XHRcdFx0cmV0dXJuICcnO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmIChfcCgncmVhZHlTdGF0ZScpICE9PSBYTUxIdHRwUmVxdWVzdC5ET05FIHx8IF9lcnJvcl9mbGFnKSB7XG5cdFx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXR1cm4gX3AoJ3Jlc3BvbnNlJyk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHQqL1xuXG5cdFx0ZnVuY3Rpb24gX3AocHJvcCwgdmFsdWUpIHtcblx0XHRcdGlmICghcHJvcHMuaGFzT3duUHJvcGVydHkocHJvcCkpIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXHRcdFx0aWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDEpIHsgLy8gZ2V0XG5cdFx0XHRcdHJldHVybiBFbnYuY2FuKCdkZWZpbmVfcHJvcGVydHknKSA/IHByb3BzW3Byb3BdIDogc2VsZltwcm9wXTtcblx0XHRcdH0gZWxzZSB7IC8vIHNldFxuXHRcdFx0XHRpZiAoRW52LmNhbignZGVmaW5lX3Byb3BlcnR5JykpIHtcblx0XHRcdFx0XHRwcm9wc1twcm9wXSA9IHZhbHVlO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHNlbGZbcHJvcF0gPSB2YWx1ZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8qXG5cdFx0ZnVuY3Rpb24gX3RvQVNDSUkoc3RyLCBBbGxvd1VuYXNzaWduZWQsIFVzZVNURDNBU0NJSVJ1bGVzKSB7XG5cdFx0XHQvLyBUT0RPOiBodHRwOi8vdG9vbHMuaWV0Zi5vcmcvaHRtbC9yZmMzNDkwI3NlY3Rpb24tNC4xXG5cdFx0XHRyZXR1cm4gc3RyLnRvTG93ZXJDYXNlKCk7XG5cdFx0fVxuXHRcdCovXG5cblxuXHRcdGZ1bmN0aW9uIF9kb1hIUihkYXRhKSB7XG5cdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cblx0XHRcdF9zdGFydF90aW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XG5cblx0XHRcdF94aHIgPSBuZXcgUnVudGltZVRhcmdldCgpO1xuXG5cdFx0XHRmdW5jdGlvbiBsb2FkRW5kKCkge1xuXHRcdFx0XHRpZiAoX3hocikgeyAvLyBpdCBjb3VsZCBoYXZlIGJlZW4gZGVzdHJveWVkIGJ5IG5vd1xuXHRcdFx0XHRcdF94aHIuZGVzdHJveSgpO1xuXHRcdFx0XHRcdF94aHIgPSBudWxsO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHNlbGYuZGlzcGF0Y2hFdmVudCgnbG9hZGVuZCcpO1xuXHRcdFx0XHRzZWxmID0gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0ZnVuY3Rpb24gZXhlYyhydW50aW1lKSB7XG5cdFx0XHRcdF94aHIuYmluZCgnTG9hZFN0YXJ0JywgZnVuY3Rpb24oZSkge1xuXHRcdFx0XHRcdF9wKCdyZWFkeVN0YXRlJywgWE1MSHR0cFJlcXVlc3QuTE9BRElORyk7XG5cdFx0XHRcdFx0c2VsZi5kaXNwYXRjaEV2ZW50KCdyZWFkeXN0YXRlY2hhbmdlJyk7XG5cblx0XHRcdFx0XHRzZWxmLmRpc3BhdGNoRXZlbnQoZSk7XG5cblx0XHRcdFx0XHRpZiAoX3VwbG9hZF9ldmVudHNfZmxhZykge1xuXHRcdFx0XHRcdFx0c2VsZi51cGxvYWQuZGlzcGF0Y2hFdmVudChlKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdF94aHIuYmluZCgnUHJvZ3Jlc3MnLCBmdW5jdGlvbihlKSB7XG5cdFx0XHRcdFx0aWYgKF9wKCdyZWFkeVN0YXRlJykgIT09IFhNTEh0dHBSZXF1ZXN0LkxPQURJTkcpIHtcblx0XHRcdFx0XHRcdF9wKCdyZWFkeVN0YXRlJywgWE1MSHR0cFJlcXVlc3QuTE9BRElORyk7IC8vIExvYWRTdGFydCB1bnJlbGlhYmxlIChpbiBGbGFzaCBmb3IgZXhhbXBsZSlcblx0XHRcdFx0XHRcdHNlbGYuZGlzcGF0Y2hFdmVudCgncmVhZHlzdGF0ZWNoYW5nZScpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRzZWxmLmRpc3BhdGNoRXZlbnQoZSk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdF94aHIuYmluZCgnVXBsb2FkUHJvZ3Jlc3MnLCBmdW5jdGlvbihlKSB7XG5cdFx0XHRcdFx0aWYgKF91cGxvYWRfZXZlbnRzX2ZsYWcpIHtcblx0XHRcdFx0XHRcdHNlbGYudXBsb2FkLmRpc3BhdGNoRXZlbnQoe1xuXHRcdFx0XHRcdFx0XHR0eXBlOiAncHJvZ3Jlc3MnLFxuXHRcdFx0XHRcdFx0XHRsZW5ndGhDb21wdXRhYmxlOiBmYWxzZSxcblx0XHRcdFx0XHRcdFx0dG90YWw6IGUudG90YWwsXG5cdFx0XHRcdFx0XHRcdGxvYWRlZDogZS5sb2FkZWRcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0X3hoci5iaW5kKCdMb2FkJywgZnVuY3Rpb24oZSkge1xuXHRcdFx0XHRcdF9wKCdyZWFkeVN0YXRlJywgWE1MSHR0cFJlcXVlc3QuRE9ORSk7XG5cdFx0XHRcdFx0X3AoJ3N0YXR1cycsIE51bWJlcihydW50aW1lLmV4ZWMuY2FsbChfeGhyLCAnWE1MSHR0cFJlcXVlc3QnLCAnZ2V0U3RhdHVzJykgfHwgMCkpO1xuXHRcdFx0XHRcdF9wKCdzdGF0dXNUZXh0JywgaHR0cENvZGVbX3AoJ3N0YXR1cycpXSB8fCBcIlwiKTtcblxuXHRcdFx0XHRcdF9wKCdyZXNwb25zZScsIHJ1bnRpbWUuZXhlYy5jYWxsKF94aHIsICdYTUxIdHRwUmVxdWVzdCcsICdnZXRSZXNwb25zZScsIF9wKCdyZXNwb25zZVR5cGUnKSkpO1xuXG5cdFx0XHRcdFx0aWYgKCEhfkJhc2ljLmluQXJyYXkoX3AoJ3Jlc3BvbnNlVHlwZScpLCBbJ3RleHQnLCAnJ10pKSB7XG5cdFx0XHRcdFx0XHRfcCgncmVzcG9uc2VUZXh0JywgX3AoJ3Jlc3BvbnNlJykpO1xuXHRcdFx0XHRcdH0gZWxzZSBpZiAoX3AoJ3Jlc3BvbnNlVHlwZScpID09PSAnZG9jdW1lbnQnKSB7XG5cdFx0XHRcdFx0XHRfcCgncmVzcG9uc2VYTUwnLCBfcCgncmVzcG9uc2UnKSk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0X3Jlc3BvbnNlSGVhZGVycyA9IHJ1bnRpbWUuZXhlYy5jYWxsKF94aHIsICdYTUxIdHRwUmVxdWVzdCcsICdnZXRBbGxSZXNwb25zZUhlYWRlcnMnKTtcblxuXHRcdFx0XHRcdHNlbGYuZGlzcGF0Y2hFdmVudCgncmVhZHlzdGF0ZWNoYW5nZScpO1xuXG5cdFx0XHRcdFx0aWYgKF9wKCdzdGF0dXMnKSA+IDApIHsgLy8gc3RhdHVzIDAgdXN1YWxseSBtZWFucyB0aGF0IHNlcnZlciBpcyB1bnJlYWNoYWJsZVxuXHRcdFx0XHRcdFx0aWYgKF91cGxvYWRfZXZlbnRzX2ZsYWcpIHtcblx0XHRcdFx0XHRcdFx0c2VsZi51cGxvYWQuZGlzcGF0Y2hFdmVudChlKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdHNlbGYuZGlzcGF0Y2hFdmVudChlKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0X2Vycm9yX2ZsYWcgPSB0cnVlO1xuXHRcdFx0XHRcdFx0c2VsZi5kaXNwYXRjaEV2ZW50KCdlcnJvcicpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRsb2FkRW5kKCk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdF94aHIuYmluZCgnQWJvcnQnLCBmdW5jdGlvbihlKSB7XG5cdFx0XHRcdFx0c2VsZi5kaXNwYXRjaEV2ZW50KGUpO1xuXHRcdFx0XHRcdGxvYWRFbmQoKTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0X3hoci5iaW5kKCdFcnJvcicsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0XHRfZXJyb3JfZmxhZyA9IHRydWU7XG5cdFx0XHRcdFx0X3AoJ3JlYWR5U3RhdGUnLCBYTUxIdHRwUmVxdWVzdC5ET05FKTtcblx0XHRcdFx0XHRzZWxmLmRpc3BhdGNoRXZlbnQoJ3JlYWR5c3RhdGVjaGFuZ2UnKTtcblx0XHRcdFx0XHRfdXBsb2FkX2NvbXBsZXRlX2ZsYWcgPSB0cnVlO1xuXHRcdFx0XHRcdHNlbGYuZGlzcGF0Y2hFdmVudChlKTtcblx0XHRcdFx0XHRsb2FkRW5kKCk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdHJ1bnRpbWUuZXhlYy5jYWxsKF94aHIsICdYTUxIdHRwUmVxdWVzdCcsICdzZW5kJywge1xuXHRcdFx0XHRcdHVybDogX3VybCxcblx0XHRcdFx0XHRtZXRob2Q6IF9tZXRob2QsXG5cdFx0XHRcdFx0YXN5bmM6IF9hc3luYyxcblx0XHRcdFx0XHR1c2VyOiBfdXNlcixcblx0XHRcdFx0XHRwYXNzd29yZDogX3Bhc3N3b3JkLFxuXHRcdFx0XHRcdGhlYWRlcnM6IF9oZWFkZXJzLFxuXHRcdFx0XHRcdG1pbWVUeXBlOiBfbWltZVR5cGUsXG5cdFx0XHRcdFx0ZW5jb2Rpbmc6IF9lbmNvZGluZyxcblx0XHRcdFx0XHRyZXNwb25zZVR5cGU6IHNlbGYucmVzcG9uc2VUeXBlLFxuXHRcdFx0XHRcdHdpdGhDcmVkZW50aWFsczogc2VsZi53aXRoQ3JlZGVudGlhbHMsXG5cdFx0XHRcdFx0b3B0aW9uczogX29wdGlvbnNcblx0XHRcdFx0fSwgZGF0YSk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIGNsYXJpZnkgb3VyIHJlcXVpcmVtZW50c1xuXHRcdFx0aWYgKHR5cGVvZihfb3B0aW9ucy5yZXF1aXJlZF9jYXBzKSA9PT0gJ3N0cmluZycpIHtcblx0XHRcdFx0X29wdGlvbnMucmVxdWlyZWRfY2FwcyA9IFJ1bnRpbWUucGFyc2VDYXBzKF9vcHRpb25zLnJlcXVpcmVkX2NhcHMpO1xuXHRcdFx0fVxuXG5cdFx0XHRfb3B0aW9ucy5yZXF1aXJlZF9jYXBzID0gQmFzaWMuZXh0ZW5kKHt9LCBfb3B0aW9ucy5yZXF1aXJlZF9jYXBzLCB7XG5cdFx0XHRcdHJldHVybl9yZXNwb25zZV90eXBlOiBzZWxmLnJlc3BvbnNlVHlwZVxuXHRcdFx0fSk7XG5cblx0XHRcdGlmIChkYXRhIGluc3RhbmNlb2YgRm9ybURhdGEpIHtcblx0XHRcdFx0X29wdGlvbnMucmVxdWlyZWRfY2Fwcy5zZW5kX211bHRpcGFydCA9IHRydWU7XG5cdFx0XHR9XG5cblx0XHRcdGlmICghQmFzaWMuaXNFbXB0eU9iaihfaGVhZGVycykpIHtcblx0XHRcdFx0X29wdGlvbnMucmVxdWlyZWRfY2Fwcy5zZW5kX2N1c3RvbV9oZWFkZXJzID0gdHJ1ZTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKCFfc2FtZV9vcmlnaW5fZmxhZykge1xuXHRcdFx0XHRfb3B0aW9ucy5yZXF1aXJlZF9jYXBzLmRvX2NvcnMgPSB0cnVlO1xuXHRcdFx0fVxuXG5cblx0XHRcdGlmIChfb3B0aW9ucy5ydWlkKSB7IC8vIHdlIGRvIG5vdCBuZWVkIHRvIHdhaXQgaWYgd2UgY2FuIGNvbm5lY3QgZGlyZWN0bHlcblx0XHRcdFx0ZXhlYyhfeGhyLmNvbm5lY3RSdW50aW1lKF9vcHRpb25zKSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRfeGhyLmJpbmQoJ1J1bnRpbWVJbml0JywgZnVuY3Rpb24oZSwgcnVudGltZSkge1xuXHRcdFx0XHRcdGV4ZWMocnVudGltZSk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRfeGhyLmJpbmQoJ1J1bnRpbWVFcnJvcicsIGZ1bmN0aW9uKGUsIGVycikge1xuXHRcdFx0XHRcdHNlbGYuZGlzcGF0Y2hFdmVudCgnUnVudGltZUVycm9yJywgZXJyKTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdF94aHIuY29ubmVjdFJ1bnRpbWUoX29wdGlvbnMpO1xuXHRcdFx0fVxuXHRcdH1cblxuXG5cdFx0ZnVuY3Rpb24gX3Jlc2V0KCkge1xuXHRcdFx0X3AoJ3Jlc3BvbnNlVGV4dCcsIFwiXCIpO1xuXHRcdFx0X3AoJ3Jlc3BvbnNlWE1MJywgbnVsbCk7XG5cdFx0XHRfcCgncmVzcG9uc2UnLCBudWxsKTtcblx0XHRcdF9wKCdzdGF0dXMnLCAwKTtcblx0XHRcdF9wKCdzdGF0dXNUZXh0JywgXCJcIik7XG5cdFx0XHRfc3RhcnRfdGltZSA9IF90aW1lb3V0c2V0X3RpbWUgPSBudWxsO1xuXHRcdH1cblx0fVxuXG5cdFhNTEh0dHBSZXF1ZXN0LlVOU0VOVCA9IDA7XG5cdFhNTEh0dHBSZXF1ZXN0Lk9QRU5FRCA9IDE7XG5cdFhNTEh0dHBSZXF1ZXN0LkhFQURFUlNfUkVDRUlWRUQgPSAyO1xuXHRYTUxIdHRwUmVxdWVzdC5MT0FESU5HID0gMztcblx0WE1MSHR0cFJlcXVlc3QuRE9ORSA9IDQ7XG5cblx0WE1MSHR0cFJlcXVlc3QucHJvdG90eXBlID0gRXZlbnRUYXJnZXQuaW5zdGFuY2U7XG5cblx0cmV0dXJuIFhNTEh0dHBSZXF1ZXN0O1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L3J1bnRpbWUvVHJhbnNwb3J0ZXIuanNcblxuLyoqXG4gKiBUcmFuc3BvcnRlci5qc1xuICpcbiAqIENvcHlyaWdodCAyMDEzLCBNb3hpZWNvZGUgU3lzdGVtcyBBQlxuICogUmVsZWFzZWQgdW5kZXIgR1BMIExpY2Vuc2UuXG4gKlxuICogTGljZW5zZTogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vbGljZW5zZVxuICogQ29udHJpYnV0aW5nOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9jb250cmlidXRpbmdcbiAqL1xuXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL1RyYW5zcG9ydGVyXCIsIFtcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCIsXG5cdFwibW94aWUvY29yZS91dGlscy9FbmNvZGVcIixcblx0XCJtb3hpZS9ydW50aW1lL1J1bnRpbWVDbGllbnRcIixcblx0XCJtb3hpZS9jb3JlL0V2ZW50VGFyZ2V0XCJcbl0sIGZ1bmN0aW9uKEJhc2ljLCBFbmNvZGUsIFJ1bnRpbWVDbGllbnQsIEV2ZW50VGFyZ2V0KSB7XG5cblx0LyoqXG5cdEBjbGFzcyBtb3hpZS9ydW50aW1lL1RyYW5zcG9ydGVyXG5cdEBwcml2YXRlXG5cdEBjb25zdHJ1Y3RvclxuXHQqL1xuXHRmdW5jdGlvbiBUcmFuc3BvcnRlcigpIHtcblx0XHR2YXIgbW9kLCBfcnVudGltZSwgX2RhdGEsIF9zaXplLCBfcG9zLCBfY2h1bmtfc2l6ZTtcblxuXHRcdFJ1bnRpbWVDbGllbnQuY2FsbCh0aGlzKTtcblxuXHRcdEJhc2ljLmV4dGVuZCh0aGlzLCB7XG5cdFx0XHR1aWQ6IEJhc2ljLmd1aWQoJ3VpZF8nKSxcblxuXHRcdFx0c3RhdGU6IFRyYW5zcG9ydGVyLklETEUsXG5cblx0XHRcdHJlc3VsdDogbnVsbCxcblxuXHRcdFx0dHJhbnNwb3J0OiBmdW5jdGlvbihkYXRhLCB0eXBlLCBvcHRpb25zKSB7XG5cdFx0XHRcdHZhciBzZWxmID0gdGhpcztcblxuXHRcdFx0XHRvcHRpb25zID0gQmFzaWMuZXh0ZW5kKHtcblx0XHRcdFx0XHRjaHVua19zaXplOiAyMDQ3OThcblx0XHRcdFx0fSwgb3B0aW9ucyk7XG5cblx0XHRcdFx0Ly8gc2hvdWxkIGRpdmlkZSBieSB0aHJlZSwgYmFzZTY0IHJlcXVpcmVzIHRoaXNcblx0XHRcdFx0aWYgKChtb2QgPSBvcHRpb25zLmNodW5rX3NpemUgJSAzKSkge1xuXHRcdFx0XHRcdG9wdGlvbnMuY2h1bmtfc2l6ZSArPSAzIC0gbW9kO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0X2NodW5rX3NpemUgPSBvcHRpb25zLmNodW5rX3NpemU7XG5cblx0XHRcdFx0X3Jlc2V0LmNhbGwodGhpcyk7XG5cdFx0XHRcdF9kYXRhID0gZGF0YTtcblx0XHRcdFx0X3NpemUgPSBkYXRhLmxlbmd0aDtcblxuXHRcdFx0XHRpZiAoQmFzaWMudHlwZU9mKG9wdGlvbnMpID09PSAnc3RyaW5nJyB8fCBvcHRpb25zLnJ1aWQpIHtcblx0XHRcdFx0XHRfcnVuLmNhbGwoc2VsZiwgdHlwZSwgdGhpcy5jb25uZWN0UnVudGltZShvcHRpb25zKSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Ly8gd2UgcmVxdWlyZSB0aGlzIHRvIHJ1biBvbmx5IG9uY2Vcblx0XHRcdFx0XHR2YXIgY2IgPSBmdW5jdGlvbihlLCBydW50aW1lKSB7XG5cdFx0XHRcdFx0XHRzZWxmLnVuYmluZChcIlJ1bnRpbWVJbml0XCIsIGNiKTtcblx0XHRcdFx0XHRcdF9ydW4uY2FsbChzZWxmLCB0eXBlLCBydW50aW1lKTtcblx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdHRoaXMuYmluZChcIlJ1bnRpbWVJbml0XCIsIGNiKTtcblx0XHRcdFx0XHR0aGlzLmNvbm5lY3RSdW50aW1lKG9wdGlvbnMpO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXG5cdFx0XHRhYm9ydDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciBzZWxmID0gdGhpcztcblxuXHRcdFx0XHRzZWxmLnN0YXRlID0gVHJhbnNwb3J0ZXIuSURMRTtcblx0XHRcdFx0aWYgKF9ydW50aW1lKSB7XG5cdFx0XHRcdFx0X3J1bnRpbWUuZXhlYy5jYWxsKHNlbGYsICdUcmFuc3BvcnRlcicsICdjbGVhcicpO1xuXHRcdFx0XHRcdHNlbGYudHJpZ2dlcihcIlRyYW5zcG9ydGluZ0Fib3J0ZWRcIik7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRfcmVzZXQuY2FsbChzZWxmKTtcblx0XHRcdH0sXG5cblxuXHRcdFx0ZGVzdHJveTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHRoaXMudW5iaW5kQWxsKCk7XG5cdFx0XHRcdF9ydW50aW1lID0gbnVsbDtcblx0XHRcdFx0dGhpcy5kaXNjb25uZWN0UnVudGltZSgpO1xuXHRcdFx0XHRfcmVzZXQuY2FsbCh0aGlzKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdGZ1bmN0aW9uIF9yZXNldCgpIHtcblx0XHRcdF9zaXplID0gX3BvcyA9IDA7XG5cdFx0XHRfZGF0YSA9IHRoaXMucmVzdWx0ID0gbnVsbDtcblx0XHR9XG5cblx0XHRmdW5jdGlvbiBfcnVuKHR5cGUsIHJ1bnRpbWUpIHtcblx0XHRcdHZhciBzZWxmID0gdGhpcztcblxuXHRcdFx0X3J1bnRpbWUgPSBydW50aW1lO1xuXG5cdFx0XHQvL3NlbGYudW5iaW5kKFwiUnVudGltZUluaXRcIik7XG5cblx0XHRcdHNlbGYuYmluZChcIlRyYW5zcG9ydGluZ1Byb2dyZXNzXCIsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0X3BvcyA9IGUubG9hZGVkO1xuXG5cdFx0XHRcdGlmIChfcG9zIDwgX3NpemUgJiYgQmFzaWMuaW5BcnJheShzZWxmLnN0YXRlLCBbVHJhbnNwb3J0ZXIuSURMRSwgVHJhbnNwb3J0ZXIuRE9ORV0pID09PSAtMSkge1xuXHRcdFx0XHRcdF90cmFuc3BvcnQuY2FsbChzZWxmKTtcblx0XHRcdFx0fVxuXHRcdFx0fSwgOTk5KTtcblxuXHRcdFx0c2VsZi5iaW5kKFwiVHJhbnNwb3J0aW5nQ29tcGxldGVcIiwgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdF9wb3MgPSBfc2l6ZTtcblx0XHRcdFx0c2VsZi5zdGF0ZSA9IFRyYW5zcG9ydGVyLkRPTkU7XG5cdFx0XHRcdF9kYXRhID0gbnVsbDsgLy8gY2xlYW4gYSBiaXRcblx0XHRcdFx0c2VsZi5yZXN1bHQgPSBfcnVudGltZS5leGVjLmNhbGwoc2VsZiwgJ1RyYW5zcG9ydGVyJywgJ2dldEFzQmxvYicsIHR5cGUgfHwgJycpO1xuXHRcdFx0fSwgOTk5KTtcblxuXHRcdFx0c2VsZi5zdGF0ZSA9IFRyYW5zcG9ydGVyLkJVU1k7XG5cdFx0XHRzZWxmLnRyaWdnZXIoXCJUcmFuc3BvcnRpbmdTdGFydGVkXCIpO1xuXHRcdFx0X3RyYW5zcG9ydC5jYWxsKHNlbGYpO1xuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIF90cmFuc3BvcnQoKSB7XG5cdFx0XHR2YXIgc2VsZiA9IHRoaXMsXG5cdFx0XHRcdGNodW5rLFxuXHRcdFx0XHRieXRlc0xlZnQgPSBfc2l6ZSAtIF9wb3M7XG5cblx0XHRcdGlmIChfY2h1bmtfc2l6ZSA+IGJ5dGVzTGVmdCkge1xuXHRcdFx0XHRfY2h1bmtfc2l6ZSA9IGJ5dGVzTGVmdDtcblx0XHRcdH1cblxuXHRcdFx0Y2h1bmsgPSBFbmNvZGUuYnRvYShfZGF0YS5zdWJzdHIoX3BvcywgX2NodW5rX3NpemUpKTtcblx0XHRcdF9ydW50aW1lLmV4ZWMuY2FsbChzZWxmLCAnVHJhbnNwb3J0ZXInLCAncmVjZWl2ZScsIGNodW5rLCBfc2l6ZSk7XG5cdFx0fVxuXHR9XG5cblx0VHJhbnNwb3J0ZXIuSURMRSA9IDA7XG5cdFRyYW5zcG9ydGVyLkJVU1kgPSAxO1xuXHRUcmFuc3BvcnRlci5ET05FID0gMjtcblxuXHRUcmFuc3BvcnRlci5wcm90b3R5cGUgPSBFdmVudFRhcmdldC5pbnN0YW5jZTtcblxuXHRyZXR1cm4gVHJhbnNwb3J0ZXI7XG59KTtcblxuLy8gSW5jbHVkZWQgZnJvbTogc3JjL2phdmFzY3JpcHQvaW1hZ2UvSW1hZ2UuanNcblxuLyoqXG4gKiBJbWFnZS5qc1xuICpcbiAqIENvcHlyaWdodCAyMDEzLCBNb3hpZWNvZGUgU3lzdGVtcyBBQlxuICogUmVsZWFzZWQgdW5kZXIgR1BMIExpY2Vuc2UuXG4gKlxuICogTGljZW5zZTogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vbGljZW5zZVxuICogQ29udHJpYnV0aW5nOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9jb250cmlidXRpbmdcbiAqL1xuXG5kZWZpbmUoXCJtb3hpZS9pbWFnZS9JbWFnZVwiLCBbXG5cdFwibW94aWUvY29yZS91dGlscy9CYXNpY1wiLFxuXHRcIm1veGllL2NvcmUvdXRpbHMvRG9tXCIsXG5cdFwibW94aWUvY29yZS9FeGNlcHRpb25zXCIsXG5cdFwibW94aWUvZmlsZS9GaWxlUmVhZGVyU3luY1wiLFxuXHRcIm1veGllL3hoci9YTUxIdHRwUmVxdWVzdFwiLFxuXHRcIm1veGllL3J1bnRpbWUvUnVudGltZVwiLFxuXHRcIm1veGllL3J1bnRpbWUvUnVudGltZUNsaWVudFwiLFxuXHRcIm1veGllL3J1bnRpbWUvVHJhbnNwb3J0ZXJcIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0VudlwiLFxuXHRcIm1veGllL2NvcmUvRXZlbnRUYXJnZXRcIixcblx0XCJtb3hpZS9maWxlL0Jsb2JcIixcblx0XCJtb3hpZS9maWxlL0ZpbGVcIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0VuY29kZVwiXG5dLCBmdW5jdGlvbihCYXNpYywgRG9tLCB4LCBGaWxlUmVhZGVyU3luYywgWE1MSHR0cFJlcXVlc3QsIFJ1bnRpbWUsIFJ1bnRpbWVDbGllbnQsIFRyYW5zcG9ydGVyLCBFbnYsIEV2ZW50VGFyZ2V0LCBCbG9iLCBGaWxlLCBFbmNvZGUpIHtcblx0LyoqXG5cdEltYWdlIHByZWxvYWRpbmcgYW5kIG1hbmlwdWxhdGlvbiB1dGlsaXR5LiBBZGRpdGlvbmFsbHkgaXQgcHJvdmlkZXMgYWNjZXNzIHRvIGltYWdlIG1ldGEgaW5mbyAoRXhpZiwgR1BTKSBhbmQgcmF3IGJpbmFyeSBkYXRhLlxuXG5cdEBjbGFzcyBtb3hpZS9pbWFnZS9JbWFnZVxuXHRAY29uc3RydWN0b3Jcblx0QGV4dGVuZHMgRXZlbnRUYXJnZXRcblx0Ki9cblx0dmFyIGRpc3BhdGNoZXMgPSBbXG5cdFx0J3Byb2dyZXNzJyxcblxuXHRcdC8qKlxuXHRcdERpc3BhdGNoZWQgd2hlbiBsb2FkaW5nIGlzIGNvbXBsZXRlLlxuXG5cdFx0QGV2ZW50IGxvYWRcblx0XHRAcGFyYW0ge09iamVjdH0gZXZlbnRcblx0XHQqL1xuXHRcdCdsb2FkJyxcblxuXHRcdCdlcnJvcicsXG5cblx0XHQvKipcblx0XHREaXNwYXRjaGVkIHdoZW4gcmVzaXplIG9wZXJhdGlvbiBpcyBjb21wbGV0ZS5cblxuXHRcdEBldmVudCByZXNpemVcblx0XHRAcGFyYW0ge09iamVjdH0gZXZlbnRcblx0XHQqL1xuXHRcdCdyZXNpemUnLFxuXG5cdFx0LyoqXG5cdFx0RGlzcGF0Y2hlZCB3aGVuIHZpc3VhbCByZXByZXNlbnRhdGlvbiBvZiB0aGUgaW1hZ2UgaXMgc3VjY2Vzc2Z1bGx5IGVtYmVkZGVkXG5cdFx0aW50byB0aGUgY29ycmVzcG9uc2luZyBjb250YWluZXIuXG5cblx0XHRAZXZlbnQgZW1iZWRkZWRcblx0XHRAcGFyYW0ge09iamVjdH0gZXZlbnRcblx0XHQqL1xuXHRcdCdlbWJlZGRlZCdcblx0XTtcblxuXHRmdW5jdGlvbiBJbWFnZSgpIHtcblxuXHRcdFJ1bnRpbWVDbGllbnQuY2FsbCh0aGlzKTtcblxuXHRcdEJhc2ljLmV4dGVuZCh0aGlzLCB7XG5cdFx0XHQvKipcblx0XHRcdFVuaXF1ZSBpZCBvZiB0aGUgY29tcG9uZW50XG5cblx0XHRcdEBwcm9wZXJ0eSB1aWRcblx0XHRcdEB0eXBlIHtTdHJpbmd9XG5cdFx0XHQqL1xuXHRcdFx0dWlkOiBCYXNpYy5ndWlkKCd1aWRfJyksXG5cblx0XHRcdC8qKlxuXHRcdFx0VW5pcXVlIGlkIG9mIHRoZSBjb25uZWN0ZWQgcnVudGltZSwgaWYgYW55LlxuXG5cdFx0XHRAcHJvcGVydHkgcnVpZFxuXHRcdFx0QHR5cGUge1N0cmluZ31cblx0XHRcdCovXG5cdFx0XHRydWlkOiBudWxsLFxuXG5cdFx0XHQvKipcblx0XHRcdE5hbWUgb2YgdGhlIGZpbGUsIHRoYXQgd2FzIHVzZWQgdG8gY3JlYXRlIGFuIGltYWdlLCBpZiBhdmFpbGFibGUuIElmIG5vdCBlcXVhbHMgdG8gZW1wdHkgc3RyaW5nLlxuXG5cdFx0XHRAcHJvcGVydHkgbmFtZVxuXHRcdFx0QHR5cGUge1N0cmluZ31cblx0XHRcdEBkZWZhdWx0IFwiXCJcblx0XHRcdCovXG5cdFx0XHRuYW1lOiBcIlwiLFxuXG5cdFx0XHQvKipcblx0XHRcdFNpemUgb2YgdGhlIGltYWdlIGluIGJ5dGVzLiBBY3R1YWwgdmFsdWUgaXMgc2V0IG9ubHkgYWZ0ZXIgaW1hZ2UgaXMgcHJlbG9hZGVkLlxuXG5cdFx0XHRAcHJvcGVydHkgc2l6ZVxuXHRcdFx0QHR5cGUge051bWJlcn1cblx0XHRcdEBkZWZhdWx0IDBcblx0XHRcdCovXG5cdFx0XHRzaXplOiAwLFxuXG5cdFx0XHQvKipcblx0XHRcdFdpZHRoIG9mIHRoZSBpbWFnZS4gQWN0dWFsIHZhbHVlIGlzIHNldCBvbmx5IGFmdGVyIGltYWdlIGlzIHByZWxvYWRlZC5cblxuXHRcdFx0QHByb3BlcnR5IHdpZHRoXG5cdFx0XHRAdHlwZSB7TnVtYmVyfVxuXHRcdFx0QGRlZmF1bHQgMFxuXHRcdFx0Ki9cblx0XHRcdHdpZHRoOiAwLFxuXG5cdFx0XHQvKipcblx0XHRcdEhlaWdodCBvZiB0aGUgaW1hZ2UuIEFjdHVhbCB2YWx1ZSBpcyBzZXQgb25seSBhZnRlciBpbWFnZSBpcyBwcmVsb2FkZWQuXG5cblx0XHRcdEBwcm9wZXJ0eSBoZWlnaHRcblx0XHRcdEB0eXBlIHtOdW1iZXJ9XG5cdFx0XHRAZGVmYXVsdCAwXG5cdFx0XHQqL1xuXHRcdFx0aGVpZ2h0OiAwLFxuXG5cdFx0XHQvKipcblx0XHRcdE1pbWUgdHlwZSBvZiB0aGUgaW1hZ2UuIEN1cnJlbnRseSBvbmx5IGltYWdlL2pwZWcgYW5kIGltYWdlL3BuZyBhcmUgc3VwcG9ydGVkLiBBY3R1YWwgdmFsdWUgaXMgc2V0IG9ubHkgYWZ0ZXIgaW1hZ2UgaXMgcHJlbG9hZGVkLlxuXG5cdFx0XHRAcHJvcGVydHkgdHlwZVxuXHRcdFx0QHR5cGUge1N0cmluZ31cblx0XHRcdEBkZWZhdWx0IFwiXCJcblx0XHRcdCovXG5cdFx0XHR0eXBlOiBcIlwiLFxuXG5cdFx0XHQvKipcblx0XHRcdEhvbGRzIG1ldGEgaW5mbyAoRXhpZiwgR1BTKS4gSXMgcG9wdWxhdGVkIG9ubHkgZm9yIGltYWdlL2pwZWcuIEFjdHVhbCB2YWx1ZSBpcyBzZXQgb25seSBhZnRlciBpbWFnZSBpcyBwcmVsb2FkZWQuXG5cblx0XHRcdEBwcm9wZXJ0eSBtZXRhXG5cdFx0XHRAdHlwZSB7T2JqZWN0fVxuXHRcdFx0QGRlZmF1bHQge31cblx0XHRcdCovXG5cdFx0XHRtZXRhOiB7fSxcblxuXHRcdFx0LyoqXG5cdFx0XHRBbGlhcyBmb3IgbG9hZCBtZXRob2QsIHRoYXQgdGFrZXMgYW5vdGhlciBtb3hpZS5pbWFnZS5JbWFnZSBvYmplY3QgYXMgYSBzb3VyY2UgKHNlZSBsb2FkKS5cblxuXHRcdFx0QG1ldGhvZCBjbG9uZVxuXHRcdFx0QHBhcmFtIHtJbWFnZX0gc3JjIFNvdXJjZSBmb3IgdGhlIGltYWdlXG5cdFx0XHRAcGFyYW0ge0Jvb2xlYW59IFtleGFjdD1mYWxzZV0gV2hldGhlciB0byBhY3RpdmF0ZSBpbi1kZXB0aCBjbG9uZSBtb2RlXG5cdFx0XHQqL1xuXHRcdFx0Y2xvbmU6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR0aGlzLmxvYWQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRcdH0sXG5cblx0XHRcdC8qKlxuXHRcdFx0TG9hZHMgaW1hZ2UgZnJvbSB2YXJpb3VzIHNvdXJjZXMuIEN1cnJlbnRseSB0aGUgc291cmNlIGZvciBuZXcgaW1hZ2UgY2FuIGJlOiBtb3hpZS5pbWFnZS5JbWFnZSxcblx0XHRcdG1veGllLmZpbGUuQmxvYi9tb3hpZS5maWxlLkZpbGUsIG5hdGl2ZSBCbG9iL0ZpbGUsIGRhdGFVcmwgb3IgVVJMLiBEZXBlbmRpbmcgb24gdGhlIHR5cGUgb2YgdGhlXG5cdFx0XHRzb3VyY2UsIGFyZ3VtZW50cyAtIGRpZmZlci4gV2hlbiBzb3VyY2UgaXMgVVJMLCBJbWFnZSB3aWxsIGJlIGRvd25sb2FkZWQgZnJvbSByZW1vdGUgZGVzdGluYXRpb25cblx0XHRcdGFuZCBsb2FkZWQgaW4gbWVtb3J5LlxuXG5cdFx0XHRAZXhhbXBsZVxuXHRcdFx0XHR2YXIgaW1nID0gbmV3IG1veGllLmltYWdlLkltYWdlKCk7XG5cdFx0XHRcdGltZy5vbmxvYWQgPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHR2YXIgYmxvYiA9IGltZy5nZXRBc0Jsb2IoKTtcblxuXHRcdFx0XHRcdHZhciBmb3JtRGF0YSA9IG5ldyBtb3hpZS54aHIuRm9ybURhdGEoKTtcblx0XHRcdFx0XHRmb3JtRGF0YS5hcHBlbmQoJ2ZpbGUnLCBibG9iKTtcblxuXHRcdFx0XHRcdHZhciB4aHIgPSBuZXcgbW94aWUueGhyLlhNTEh0dHBSZXF1ZXN0KCk7XG5cdFx0XHRcdFx0eGhyLm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0Ly8gdXBsb2FkIGNvbXBsZXRlXG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0XHR4aHIub3BlbigncG9zdCcsICd1cGxvYWQucGhwJyk7XG5cdFx0XHRcdFx0eGhyLnNlbmQoZm9ybURhdGEpO1xuXHRcdFx0XHR9O1xuXHRcdFx0XHRpbWcubG9hZChcImh0dHA6Ly93d3cubW94aWVjb2RlLmNvbS9pbWFnZXMvbW94LWxvZ28uanBnXCIpOyAvLyBub3RpY2UgZmlsZSBleHRlbnNpb24gKC5qcGcpXG5cblxuXHRcdFx0QG1ldGhvZCBsb2FkXG5cdFx0XHRAcGFyYW0ge0ltYWdlfEJsb2J8RmlsZXxTdHJpbmd9IHNyYyBTb3VyY2UgZm9yIHRoZSBpbWFnZVxuXHRcdFx0QHBhcmFtIHtCb29sZWFufE9iamVjdH0gW21peGVkXVxuXHRcdFx0Ki9cblx0XHRcdGxvYWQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRfbG9hZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdFx0fSxcblxuXG5cdFx0XHQvKipcblx0XHRcdFJlc2l6ZXMgdGhlIGltYWdlIHRvIGZpdCB0aGUgc3BlY2lmaWVkIHdpZHRoL2hlaWdodC4gSWYgY3JvcCBpcyBzcGVjaWZpZWQsIGltYWdlIHdpbGwgYWxzbyBiZVxuXHRcdFx0Y3JvcHBlZCB0byB0aGUgZXhhY3QgZGltZW5zaW9ucy5cblxuXHRcdFx0QG1ldGhvZCByZXNpemVcblx0XHRcdEBzaW5jZSAzLjBcblx0XHRcdEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zXG5cdFx0XHRcdEBwYXJhbSB7TnVtYmVyfSBvcHRpb25zLndpZHRoIFJlc3VsdGluZyB3aWR0aFxuXHRcdFx0XHRAcGFyYW0ge051bWJlcn0gW29wdGlvbnMuaGVpZ2h0PXdpZHRoXSBSZXN1bHRpbmcgaGVpZ2h0IChvcHRpb25hbCwgaWYgbm90IHN1cHBsaWVkIHdpbGwgZGVmYXVsdCB0byB3aWR0aClcblx0XHRcdFx0QHBhcmFtIHtTdHJpbmd9IFtvcHRpb25zLnR5cGU9J2ltYWdlL2pwZWcnXSBNSU1FIHR5cGUgb2YgdGhlIHJlc3VsdGluZyBpbWFnZVxuXHRcdFx0XHRAcGFyYW0ge051bWJlcn0gW29wdGlvbnMucXVhbGl0eT05MF0gSW4gdGhlIGNhc2Ugb2YgSlBFRywgY29udHJvbHMgdGhlIHF1YWxpdHkgb2YgcmVzdWx0aW5nIGltYWdlXG5cdFx0XHRcdEBwYXJhbSB7Qm9vbGVhbn0gW29wdGlvbnMuY3JvcD0nY2MnXSBJZiBub3QgZmFsc3ksIGltYWdlIHdpbGwgYmUgY3JvcHBlZCwgYnkgZGVmYXVsdCBmcm9tIGNlbnRlclxuXHRcdFx0XHRAcGFyYW0ge0Jvb2xlYW59IFtvcHRpb25zLmZpdD10cnVlXSBXaGV0aGVyIHRvIHVwc2NhbGUgdGhlIGltYWdlIHRvIGZpdCB0aGUgZXhhY3QgZGltZW5zaW9uc1xuXHRcdFx0XHRAcGFyYW0ge0Jvb2xlYW59IFtvcHRpb25zLnByZXNlcnZlSGVhZGVycz10cnVlXSBXaGV0aGVyIHRvIHByZXNlcnZlIG1ldGEgaGVhZGVycyAob24gSlBFR3MgYWZ0ZXIgcmVzaXplKVxuXHRcdFx0XHRAcGFyYW0ge1N0cmluZ30gW29wdGlvbnMucmVzYW1wbGU9J2RlZmF1bHQnXSBSZXNhbXBsaW5nIGFsZ29yaXRobSB0byB1c2UgZHVyaW5nIHJlc2l6ZVxuXHRcdFx0XHRAcGFyYW0ge0Jvb2xlYW59IFtvcHRpb25zLm11bHRpcGFzcz10cnVlXSBXaGV0aGVyIHRvIHNjYWxlIHRoZSBpbWFnZSBpbiBzdGVwcyAocmVzdWx0cyBpbiBiZXR0ZXIgcXVhbGl0eSlcblx0XHRcdCovXG5cdFx0XHRyZXNpemU6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdFx0XHR2YXIgb3JpZW50YXRpb247XG5cdFx0XHRcdHZhciBzY2FsZTtcblxuXHRcdFx0XHR2YXIgc3JjUmVjdCA9IHtcblx0XHRcdFx0XHR4OiAwLFxuXHRcdFx0XHRcdHk6IDAsXG5cdFx0XHRcdFx0d2lkdGg6IHNlbGYud2lkdGgsXG5cdFx0XHRcdFx0aGVpZ2h0OiBzZWxmLmhlaWdodFxuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdHZhciBvcHRzID0gQmFzaWMuZXh0ZW5kSWYoe1xuXHRcdFx0XHRcdHdpZHRoOiBzZWxmLndpZHRoLFxuXHRcdFx0XHRcdGhlaWdodDogc2VsZi5oZWlnaHQsXG5cdFx0XHRcdFx0dHlwZTogc2VsZi50eXBlIHx8ICdpbWFnZS9qcGVnJyxcblx0XHRcdFx0XHRxdWFsaXR5OiA5MCxcblx0XHRcdFx0XHRjcm9wOiBmYWxzZSxcblx0XHRcdFx0XHRmaXQ6IHRydWUsXG5cdFx0XHRcdFx0cHJlc2VydmVIZWFkZXJzOiB0cnVlLFxuXHRcdFx0XHRcdHJlc2FtcGxlOiAnZGVmYXVsdCcsXG5cdFx0XHRcdFx0bXVsdGlwYXNzOiB0cnVlXG5cdFx0XHRcdH0sIG9wdGlvbnMpO1xuXG5cdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0aWYgKCFzZWxmLnNpemUpIHsgLy8gb25seSBwcmVsb2FkZWQgaW1hZ2Ugb2JqZWN0cyBjYW4gYmUgdXNlZCBhcyBzb3VyY2Vcblx0XHRcdFx0XHRcdHRocm93IG5ldyB4LkRPTUV4Y2VwdGlvbih4LkRPTUV4Y2VwdGlvbi5JTlZBTElEX1NUQVRFX0VSUik7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Ly8gbm8gd2F5IHRvIHJlbGlhYmx5IGludGVyY2VwdCB0aGUgY3Jhc2ggZHVlIHRvIGhpZ2ggcmVzb2x1dGlvbiwgc28gd2Ugc2ltcGx5IGF2b2lkIGl0XG5cdFx0XHRcdFx0aWYgKHNlbGYud2lkdGggPiBJbWFnZS5NQVhfUkVTSVpFX1dJRFRIIHx8IHNlbGYuaGVpZ2h0ID4gSW1hZ2UuTUFYX1JFU0laRV9IRUlHSFQpIHtcblx0XHRcdFx0XHRcdHRocm93IG5ldyB4LkltYWdlRXJyb3IoeC5JbWFnZUVycm9yLk1BWF9SRVNPTFVUSU9OX0VSUik7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Ly8gdGFrZSBpbnRvIGFjY291bnQgb3JpZW50YXRpb24gdGFnXG5cdFx0XHRcdFx0b3JpZW50YXRpb24gPSAoc2VsZi5tZXRhICYmIHNlbGYubWV0YS50aWZmICYmIHNlbGYubWV0YS50aWZmLk9yaWVudGF0aW9uKSB8fCAxO1xuXG5cdFx0XHRcdFx0aWYgKEJhc2ljLmluQXJyYXkob3JpZW50YXRpb24sIFs1LDYsNyw4XSkgIT09IC0xKSB7IC8vIHZhbHVlcyB0aGF0IHJlcXVpcmUgOTAgZGVncmVlIHJvdGF0aW9uXG5cdFx0XHRcdFx0XHR2YXIgdG1wID0gb3B0cy53aWR0aDtcblx0XHRcdFx0XHRcdG9wdHMud2lkdGggPSBvcHRzLmhlaWdodDtcblx0XHRcdFx0XHRcdG9wdHMuaGVpZ2h0ID0gdG1wO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGlmIChvcHRzLmNyb3ApIHtcblx0XHRcdFx0XHRcdHNjYWxlID0gTWF0aC5tYXgob3B0cy53aWR0aC9zZWxmLndpZHRoLCBvcHRzLmhlaWdodC9zZWxmLmhlaWdodCk7XG5cblx0XHRcdFx0XHRcdGlmIChvcHRpb25zLmZpdCkge1xuXHRcdFx0XHRcdFx0XHQvLyBmaXJzdCBzY2FsZSBpdCB1cCBvciBkb3duIHRvIGZpdCB0aGUgb3JpZ2luYWwgaW1hZ2Vcblx0XHRcdFx0XHRcdFx0c3JjUmVjdC53aWR0aCA9IE1hdGgubWluKE1hdGguY2VpbChvcHRzLndpZHRoL3NjYWxlKSwgc2VsZi53aWR0aCk7XG5cdFx0XHRcdFx0XHRcdHNyY1JlY3QuaGVpZ2h0ID0gTWF0aC5taW4oTWF0aC5jZWlsKG9wdHMuaGVpZ2h0L3NjYWxlKSwgc2VsZi5oZWlnaHQpO1xuXG5cdFx0XHRcdFx0XHRcdC8vIHJlY2FsY3VsYXRlIHRoZSBzY2FsZSBmb3IgYWRhcHRlZCBkaW1lbnNpb25zXG5cdFx0XHRcdFx0XHRcdHNjYWxlID0gb3B0cy53aWR0aC9zcmNSZWN0LndpZHRoO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0c3JjUmVjdC53aWR0aCA9IE1hdGgubWluKG9wdHMud2lkdGgsIHNlbGYud2lkdGgpO1xuXHRcdFx0XHRcdFx0XHRzcmNSZWN0LmhlaWdodCA9IE1hdGgubWluKG9wdHMuaGVpZ2h0LCBzZWxmLmhlaWdodCk7XG5cblx0XHRcdFx0XHRcdFx0Ly8gbm93IHdlIGRvIG5vdCBuZWVkIHRvIHNjYWxlIGl0IGFueSBmdXJ0aGVyXG5cdFx0XHRcdFx0XHRcdHNjYWxlID0gMTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0aWYgKHR5cGVvZihvcHRzLmNyb3ApID09PSAnYm9vbGVhbicpIHtcblx0XHRcdFx0XHRcdFx0b3B0cy5jcm9wID0gJ2NjJztcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0c3dpdGNoIChvcHRzLmNyb3AudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9fLywgJy0nKSkge1xuXHRcdFx0XHRcdFx0XHRjYXNlICdyYic6XG5cdFx0XHRcdFx0XHRcdGNhc2UgJ3JpZ2h0LWJvdHRvbSc6XG5cdFx0XHRcdFx0XHRcdFx0c3JjUmVjdC54ID0gc2VsZi53aWR0aCAtIHNyY1JlY3Qud2lkdGg7XG5cdFx0XHRcdFx0XHRcdFx0c3JjUmVjdC55ID0gc2VsZi5oZWlnaHQgLSBzcmNSZWN0LmhlaWdodDtcblx0XHRcdFx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRcdFx0XHRjYXNlICdjYic6XG5cdFx0XHRcdFx0XHRcdGNhc2UgJ2NlbnRlci1ib3R0b20nOlxuXHRcdFx0XHRcdFx0XHRcdHNyY1JlY3QueCA9IE1hdGguZmxvb3IoKHNlbGYud2lkdGggLSBzcmNSZWN0LndpZHRoKSAvIDIpO1xuXHRcdFx0XHRcdFx0XHRcdHNyY1JlY3QueSA9IHNlbGYuaGVpZ2h0IC0gc3JjUmVjdC5oZWlnaHQ7XG5cdFx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0XHRcdFx0Y2FzZSAnbGInOlxuXHRcdFx0XHRcdFx0XHRjYXNlICdsZWZ0LWJvdHRvbSc6XG5cdFx0XHRcdFx0XHRcdFx0c3JjUmVjdC54ID0gMDtcblx0XHRcdFx0XHRcdFx0XHRzcmNSZWN0LnkgPSBzZWxmLmhlaWdodCAtIHNyY1JlY3QuaGVpZ2h0O1xuXHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdFx0XHRcdGNhc2UgJ2x0Jzpcblx0XHRcdFx0XHRcdFx0Y2FzZSAnbGVmdC10b3AnOlxuXHRcdFx0XHRcdFx0XHRcdHNyY1JlY3QueCA9IDA7XG5cdFx0XHRcdFx0XHRcdFx0c3JjUmVjdC55ID0gMDtcblx0XHRcdFx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRcdFx0XHRjYXNlICdjdCc6XG5cdFx0XHRcdFx0XHRcdGNhc2UgJ2NlbnRlci10b3AnOlxuXHRcdFx0XHRcdFx0XHRcdHNyY1JlY3QueCA9IE1hdGguZmxvb3IoKHNlbGYud2lkdGggLSBzcmNSZWN0LndpZHRoKSAvIDIpO1xuXHRcdFx0XHRcdFx0XHRcdHNyY1JlY3QueSA9IDA7XG5cdFx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0XHRcdFx0Y2FzZSAncnQnOlxuXHRcdFx0XHRcdFx0XHRjYXNlICdyaWdodC10b3AnOlxuXHRcdFx0XHRcdFx0XHRcdHNyY1JlY3QueCA9IHNlbGYud2lkdGggLSBzcmNSZWN0LndpZHRoO1xuXHRcdFx0XHRcdFx0XHRcdHNyY1JlY3QueSA9IDA7XG5cdFx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0XHRcdFx0Y2FzZSAncmMnOlxuXHRcdFx0XHRcdFx0XHRjYXNlICdyaWdodC1jZW50ZXInOlxuXHRcdFx0XHRcdFx0XHRjYXNlICdyaWdodC1taWRkbGUnOlxuXHRcdFx0XHRcdFx0XHRcdHNyY1JlY3QueCA9IHNlbGYud2lkdGggLSBzcmNSZWN0LndpZHRoO1xuXHRcdFx0XHRcdFx0XHRcdHNyY1JlY3QueSA9IE1hdGguZmxvb3IoKHNlbGYuaGVpZ2h0IC0gc3JjUmVjdC5oZWlnaHQpIC8gMik7XG5cdFx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cblxuXHRcdFx0XHRcdFx0XHRjYXNlICdsYyc6XG5cdFx0XHRcdFx0XHRcdGNhc2UgJ2xlZnQtY2VudGVyJzpcblx0XHRcdFx0XHRcdFx0Y2FzZSAnbGVmdC1taWRkbGUnOlxuXHRcdFx0XHRcdFx0XHRcdHNyY1JlY3QueCA9IDA7XG5cdFx0XHRcdFx0XHRcdFx0c3JjUmVjdC55ID0gTWF0aC5mbG9vcigoc2VsZi5oZWlnaHQgLSBzcmNSZWN0LmhlaWdodCkgLyAyKTtcblx0XHRcdFx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRcdFx0XHRjYXNlICdjYyc6XG5cdFx0XHRcdFx0XHRcdGNhc2UgJ2NlbnRlci1jZW50ZXInOlxuXHRcdFx0XHRcdFx0XHRjYXNlICdjZW50ZXItbWlkZGxlJzpcblx0XHRcdFx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0XHRcdFx0XHRzcmNSZWN0LnggPSBNYXRoLmZsb29yKChzZWxmLndpZHRoIC0gc3JjUmVjdC53aWR0aCkgLyAyKTtcblx0XHRcdFx0XHRcdFx0XHRzcmNSZWN0LnkgPSBNYXRoLmZsb29yKChzZWxmLmhlaWdodCAtIHNyY1JlY3QuaGVpZ2h0KSAvIDIpO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHQvLyBvcmlnaW5hbCBpbWFnZSBtaWdodCBiZSBzbWFsbGVyIHRoYW4gcmVxdWVzdGVkIGNyb3AsIHNvIC0gYXZvaWQgbmVnYXRpdmUgdmFsdWVzXG5cdFx0XHRcdFx0XHRzcmNSZWN0LnggPSBNYXRoLm1heChzcmNSZWN0LngsIDApO1xuXHRcdFx0XHRcdFx0c3JjUmVjdC55ID0gTWF0aC5tYXgoc3JjUmVjdC55LCAwKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0c2NhbGUgPSBNYXRoLm1pbihvcHRzLndpZHRoL3NlbGYud2lkdGgsIG9wdHMuaGVpZ2h0L3NlbGYuaGVpZ2h0KTtcblxuXHRcdFx0XHRcdFx0Ly8gZG8gbm90IHVwc2NhbGUgaWYgd2Ugd2VyZSBhc2tlZCB0byBub3QgZml0IGl0XG5cdFx0XHRcdFx0XHRpZiAoc2NhbGUgPiAxICYmICFvcHRzLmZpdCkge1xuXHRcdFx0XHRcdFx0XHRzY2FsZSA9IDE7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0dGhpcy5leGVjKCdJbWFnZScsICdyZXNpemUnLCBzcmNSZWN0LCBzY2FsZSwgb3B0cyk7XG5cdFx0XHRcdH0gY2F0Y2goZXgpIHtcblx0XHRcdFx0XHQvLyBmb3Igbm93IHNpbXBseSB0cmlnZ2VyIGVycm9yIGV2ZW50XG5cdFx0XHRcdFx0c2VsZi50cmlnZ2VyKCdlcnJvcicsIGV4LmNvZGUpO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXG5cdFx0XHQvKipcblx0XHRcdERvd25zaXplcyB0aGUgaW1hZ2UgdG8gZml0IHRoZSBzcGVjaWZpZWQgd2lkdGgvaGVpZ2h0LiBJZiBjcm9wIGlzIHN1cHBsaWVkLCBpbWFnZSB3aWxsIGJlIGNyb3BwZWQgdG8gZXhhY3QgZGltZW5zaW9ucy5cblxuXHRcdFx0QG1ldGhvZCBkb3duc2l6ZVxuXHRcdFx0QGRlcHJlY2F0ZWQgdXNlIHJlc2l6ZSgpXG5cdFx0XHQqL1xuXHRcdFx0ZG93bnNpemU6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHRcdFx0dmFyIGRlZmF1bHRzID0ge1xuXHRcdFx0XHRcdHdpZHRoOiB0aGlzLndpZHRoLFxuXHRcdFx0XHRcdGhlaWdodDogdGhpcy5oZWlnaHQsXG5cdFx0XHRcdFx0dHlwZTogdGhpcy50eXBlIHx8ICdpbWFnZS9qcGVnJyxcblx0XHRcdFx0XHRxdWFsaXR5OiA5MCxcblx0XHRcdFx0XHRjcm9wOiBmYWxzZSxcblx0XHRcdFx0XHRmaXQ6IGZhbHNlLFxuXHRcdFx0XHRcdHByZXNlcnZlSGVhZGVyczogdHJ1ZSxcblx0XHRcdFx0XHRyZXNhbXBsZTogJ2RlZmF1bHQnXG5cdFx0XHRcdH0sIG9wdHM7XG5cblx0XHRcdFx0aWYgKHR5cGVvZihvcHRpb25zKSA9PT0gJ29iamVjdCcpIHtcblx0XHRcdFx0XHRvcHRzID0gQmFzaWMuZXh0ZW5kKGRlZmF1bHRzLCBvcHRpb25zKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQvLyBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eVxuXHRcdFx0XHRcdG9wdHMgPSBCYXNpYy5leHRlbmQoZGVmYXVsdHMsIHtcblx0XHRcdFx0XHRcdHdpZHRoOiBhcmd1bWVudHNbMF0sXG5cdFx0XHRcdFx0XHRoZWlnaHQ6IGFyZ3VtZW50c1sxXSxcblx0XHRcdFx0XHRcdGNyb3A6IGFyZ3VtZW50c1syXSxcblx0XHRcdFx0XHRcdHByZXNlcnZlSGVhZGVyczogYXJndW1lbnRzWzNdXG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR0aGlzLnJlc2l6ZShvcHRzKTtcblx0XHRcdH0sXG5cblx0XHRcdC8qKlxuXHRcdFx0QWxpYXMgZm9yIGRvd25zaXplKHdpZHRoLCBoZWlnaHQsIHRydWUpLiAoc2VlIGRvd25zaXplKVxuXG5cdFx0XHRAbWV0aG9kIGNyb3Bcblx0XHRcdEBwYXJhbSB7TnVtYmVyfSB3aWR0aCBSZXN1bHRpbmcgd2lkdGhcblx0XHRcdEBwYXJhbSB7TnVtYmVyfSBbaGVpZ2h0PXdpZHRoXSBSZXN1bHRpbmcgaGVpZ2h0IChvcHRpb25hbCwgaWYgbm90IHN1cHBsaWVkIHdpbGwgZGVmYXVsdCB0byB3aWR0aClcblx0XHRcdEBwYXJhbSB7Qm9vbGVhbn0gW3ByZXNlcnZlSGVhZGVycz10cnVlXSBXaGV0aGVyIHRvIHByZXNlcnZlIG1ldGEgaGVhZGVycyAob24gSlBFR3MgYWZ0ZXIgcmVzaXplKVxuXHRcdFx0Ki9cblx0XHRcdGNyb3A6IGZ1bmN0aW9uKHdpZHRoLCBoZWlnaHQsIHByZXNlcnZlSGVhZGVycykge1xuXHRcdFx0XHR0aGlzLmRvd25zaXplKHdpZHRoLCBoZWlnaHQsIHRydWUsIHByZXNlcnZlSGVhZGVycyk7XG5cdFx0XHR9LFxuXG5cdFx0XHRnZXRBc0NhbnZhczogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGlmICghRW52LmNhbignY3JlYXRlX2NhbnZhcycpKSB7XG5cdFx0XHRcdFx0dGhyb3cgbmV3IHguUnVudGltZUVycm9yKHguUnVudGltZUVycm9yLk5PVF9TVVBQT1JURURfRVJSKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gdGhpcy5leGVjKCdJbWFnZScsICdnZXRBc0NhbnZhcycpO1xuXHRcdFx0fSxcblxuXHRcdFx0LyoqXG5cdFx0XHRSZXRyaWV2ZXMgaW1hZ2UgaW4gaXQncyBjdXJyZW50IHN0YXRlIGFzIG1veGllLmZpbGUuQmxvYiBvYmplY3QuIENhbm5vdCBiZSBydW4gb24gZW1wdHkgb3IgaW1hZ2UgaW4gcHJvZ3Jlc3MgKHRocm93c1xuXHRcdFx0RE9NRXhjZXB0aW9uLklOVkFMSURfU1RBVEVfRVJSKS5cblxuXHRcdFx0QG1ldGhvZCBnZXRBc0Jsb2Jcblx0XHRcdEBwYXJhbSB7U3RyaW5nfSBbdHlwZT1cImltYWdlL2pwZWdcIl0gTWltZSB0eXBlIG9mIHJlc3VsdGluZyBibG9iLiBDYW4gZWl0aGVyIGJlIGltYWdlL2pwZWcgb3IgaW1hZ2UvcG5nXG5cdFx0XHRAcGFyYW0ge051bWJlcn0gW3F1YWxpdHk9OTBdIEFwcGxpY2FibGUgb25seSB0b2dldGhlciB3aXRoIG1pbWUgdHlwZSBpbWFnZS9qcGVnXG5cdFx0XHRAcmV0dXJuIHtCbG9ifSBJbWFnZSBhcyBCbG9iXG5cdFx0XHQqL1xuXHRcdFx0Z2V0QXNCbG9iOiBmdW5jdGlvbih0eXBlLCBxdWFsaXR5KSB7XG5cdFx0XHRcdGlmICghdGhpcy5zaXplKSB7XG5cdFx0XHRcdFx0dGhyb3cgbmV3IHguRE9NRXhjZXB0aW9uKHguRE9NRXhjZXB0aW9uLklOVkFMSURfU1RBVEVfRVJSKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gdGhpcy5leGVjKCdJbWFnZScsICdnZXRBc0Jsb2InLCB0eXBlIHx8ICdpbWFnZS9qcGVnJywgcXVhbGl0eSB8fCA5MCk7XG5cdFx0XHR9LFxuXG5cdFx0XHQvKipcblx0XHRcdFJldHJpZXZlcyBpbWFnZSBpbiBpdCdzIGN1cnJlbnQgc3RhdGUgYXMgZGF0YVVSTCBzdHJpbmcuIENhbm5vdCBiZSBydW4gb24gZW1wdHkgb3IgaW1hZ2UgaW4gcHJvZ3Jlc3MgKHRocm93c1xuXHRcdFx0RE9NRXhjZXB0aW9uLklOVkFMSURfU1RBVEVfRVJSKS5cblxuXHRcdFx0QG1ldGhvZCBnZXRBc0RhdGFVUkxcblx0XHRcdEBwYXJhbSB7U3RyaW5nfSBbdHlwZT1cImltYWdlL2pwZWdcIl0gTWltZSB0eXBlIG9mIHJlc3VsdGluZyBibG9iLiBDYW4gZWl0aGVyIGJlIGltYWdlL2pwZWcgb3IgaW1hZ2UvcG5nXG5cdFx0XHRAcGFyYW0ge051bWJlcn0gW3F1YWxpdHk9OTBdIEFwcGxpY2FibGUgb25seSB0b2dldGhlciB3aXRoIG1pbWUgdHlwZSBpbWFnZS9qcGVnXG5cdFx0XHRAcmV0dXJuIHtTdHJpbmd9IEltYWdlIGFzIGRhdGFVUkwgc3RyaW5nXG5cdFx0XHQqL1xuXHRcdFx0Z2V0QXNEYXRhVVJMOiBmdW5jdGlvbih0eXBlLCBxdWFsaXR5KSB7XG5cdFx0XHRcdGlmICghdGhpcy5zaXplKSB7XG5cdFx0XHRcdFx0dGhyb3cgbmV3IHguRE9NRXhjZXB0aW9uKHguRE9NRXhjZXB0aW9uLklOVkFMSURfU1RBVEVfRVJSKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gdGhpcy5leGVjKCdJbWFnZScsICdnZXRBc0RhdGFVUkwnLCB0eXBlIHx8ICdpbWFnZS9qcGVnJywgcXVhbGl0eSB8fCA5MCk7XG5cdFx0XHR9LFxuXG5cdFx0XHQvKipcblx0XHRcdFJldHJpZXZlcyBpbWFnZSBpbiBpdCdzIGN1cnJlbnQgc3RhdGUgYXMgYmluYXJ5IHN0cmluZy4gQ2Fubm90IGJlIHJ1biBvbiBlbXB0eSBvciBpbWFnZSBpbiBwcm9ncmVzcyAodGhyb3dzXG5cdFx0XHRET01FeGNlcHRpb24uSU5WQUxJRF9TVEFURV9FUlIpLlxuXG5cdFx0XHRAbWV0aG9kIGdldEFzQmluYXJ5U3RyaW5nXG5cdFx0XHRAcGFyYW0ge1N0cmluZ30gW3R5cGU9XCJpbWFnZS9qcGVnXCJdIE1pbWUgdHlwZSBvZiByZXN1bHRpbmcgYmxvYi4gQ2FuIGVpdGhlciBiZSBpbWFnZS9qcGVnIG9yIGltYWdlL3BuZ1xuXHRcdFx0QHBhcmFtIHtOdW1iZXJ9IFtxdWFsaXR5PTkwXSBBcHBsaWNhYmxlIG9ubHkgdG9nZXRoZXIgd2l0aCBtaW1lIHR5cGUgaW1hZ2UvanBlZ1xuXHRcdFx0QHJldHVybiB7U3RyaW5nfSBJbWFnZSBhcyBiaW5hcnkgc3RyaW5nXG5cdFx0XHQqL1xuXHRcdFx0Z2V0QXNCaW5hcnlTdHJpbmc6IGZ1bmN0aW9uKHR5cGUsIHF1YWxpdHkpIHtcblx0XHRcdFx0dmFyIGRhdGFVcmwgPSB0aGlzLmdldEFzRGF0YVVSTCh0eXBlLCBxdWFsaXR5KTtcblx0XHRcdFx0cmV0dXJuIEVuY29kZS5hdG9iKGRhdGFVcmwuc3Vic3RyaW5nKGRhdGFVcmwuaW5kZXhPZignYmFzZTY0LCcpICsgNykpO1xuXHRcdFx0fSxcblxuXHRcdFx0LyoqXG5cdFx0XHRFbWJlZHMgYSB2aXN1YWwgcmVwcmVzZW50YXRpb24gb2YgdGhlIGltYWdlIGludG8gdGhlIHNwZWNpZmllZCBub2RlLiBEZXBlbmRpbmcgb24gdGhlIHJ1bnRpbWUsXG5cdFx0XHRpdCBtaWdodCBiZSBhIGNhbnZhcywgYW4gaW1nIG5vZGUgb3IgYSB0aHJpZCBwYXJ0eSBzaGltIG9iamVjdCAoRmxhc2ggb3IgU2lsdmVyTGlnaHQgLSB2ZXJ5IHJhcmUsXG5cdFx0XHRjYW4gYmUgdXNlZCBpbiBsZWdhY3kgYnJvd3NlcnMgdGhhdCBkbyBub3QgaGF2ZSBjYW52YXMgb3IgcHJvcGVyIGRhdGFVUkkgc3VwcG9ydCkuXG5cblx0XHRcdEBtZXRob2QgZW1iZWRcblx0XHRcdEBwYXJhbSB7RE9NRWxlbWVudH0gZWwgRE9NIGVsZW1lbnQgdG8gaW5zZXJ0IHRoZSBpbWFnZSBvYmplY3QgaW50b1xuXHRcdFx0QHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXVxuXHRcdFx0XHRAcGFyYW0ge051bWJlcn0gW29wdGlvbnMud2lkdGhdIFRoZSB3aWR0aCBvZiBhbiBlbWJlZCAoZGVmYXVsdHMgdG8gdGhlIGltYWdlIHdpZHRoKVxuXHRcdFx0XHRAcGFyYW0ge051bWJlcn0gW29wdGlvbnMuaGVpZ2h0XSBUaGUgaGVpZ2h0IG9mIGFuIGVtYmVkIChkZWZhdWx0cyB0byB0aGUgaW1hZ2UgaGVpZ2h0KVxuXHRcdFx0XHRAcGFyYW0ge1N0cmluZ30gW29wdGlvbnMudHlwZT1cImltYWdlL2pwZWdcIl0gTWltZSB0eXBlXG5cdFx0XHRcdEBwYXJhbSB7TnVtYmVyfSBbb3B0aW9ucy5xdWFsaXR5PTkwXSBRdWFsaXR5IG9mIGFuIGVtYmVkLCBpZiBtaW1lIHR5cGUgaXMgaW1hZ2UvanBlZ1xuXHRcdFx0XHRAcGFyYW0ge0Jvb2xlYW59IFtvcHRpb25zLmNyb3A9ZmFsc2VdIFdoZXRoZXIgdG8gY3JvcCBhbiBlbWJlZCB0byB0aGUgc3BlY2lmaWVkIGRpbWVuc2lvbnNcblx0XHRcdFx0QHBhcmFtIHtCb29sZWFufSBbb3B0aW9ucy5maXQ9dHJ1ZV0gQnkgZGVmYXVsdCB0aHVtYnMgd2lsbCBiZSB1cC0gb3IgZG93bnNjYWxlZCBhcyBuZWNlc3NhcnkgdG8gZml0IHRoZSBkaW1lbnNpb25zXG5cdFx0XHQqL1xuXHRcdFx0ZW1iZWQ6IGZ1bmN0aW9uKGVsLCBvcHRpb25zKSB7XG5cdFx0XHRcdHZhciBzZWxmID0gdGhpc1xuXHRcdFx0XHQsIHJ1bnRpbWUgLy8gdGhpcyBoYXMgdG8gYmUgb3V0c2lkZSBvZiBhbGwgdGhlIGNsb3N1cmVzIHRvIGNvbnRhaW4gcHJvcGVyIHJ1bnRpbWVcblx0XHRcdFx0O1xuXG5cdFx0XHRcdHZhciBvcHRzID0gQmFzaWMuZXh0ZW5kKHtcblx0XHRcdFx0XHR3aWR0aDogdGhpcy53aWR0aCxcblx0XHRcdFx0XHRoZWlnaHQ6IHRoaXMuaGVpZ2h0LFxuXHRcdFx0XHRcdHR5cGU6IHRoaXMudHlwZSB8fCAnaW1hZ2UvanBlZycsXG5cdFx0XHRcdFx0cXVhbGl0eTogOTAsXG5cdFx0XHRcdFx0Zml0OiB0cnVlLFxuXHRcdFx0XHRcdHJlc2FtcGxlOiAnbmVhcmVzdCdcblx0XHRcdFx0fSwgb3B0aW9ucyk7XG5cblxuXHRcdFx0XHRmdW5jdGlvbiByZW5kZXIodHlwZSwgcXVhbGl0eSkge1xuXHRcdFx0XHRcdHZhciBpbWcgPSB0aGlzO1xuXG5cdFx0XHRcdFx0Ly8gaWYgcG9zc2libGUsIGVtYmVkIGEgY2FudmFzIGVsZW1lbnQgZGlyZWN0bHlcblx0XHRcdFx0XHRpZiAoRW52LmNhbignY3JlYXRlX2NhbnZhcycpKSB7XG5cdFx0XHRcdFx0XHR2YXIgY2FudmFzID0gaW1nLmdldEFzQ2FudmFzKCk7XG5cdFx0XHRcdFx0XHRpZiAoY2FudmFzKSB7XG5cdFx0XHRcdFx0XHRcdGVsLmFwcGVuZENoaWxkKGNhbnZhcyk7XG5cdFx0XHRcdFx0XHRcdGNhbnZhcyA9IG51bGw7XG5cdFx0XHRcdFx0XHRcdGltZy5kZXN0cm95KCk7XG5cdFx0XHRcdFx0XHRcdHNlbGYudHJpZ2dlcignZW1iZWRkZWQnKTtcblx0XHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHZhciBkYXRhVXJsID0gaW1nLmdldEFzRGF0YVVSTCh0eXBlLCBxdWFsaXR5KTtcblx0XHRcdFx0XHRpZiAoIWRhdGFVcmwpIHtcblx0XHRcdFx0XHRcdHRocm93IG5ldyB4LkltYWdlRXJyb3IoeC5JbWFnZUVycm9yLldST05HX0ZPUk1BVCk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKEVudi5jYW4oJ3VzZV9kYXRhX3VyaV9vZicsIGRhdGFVcmwubGVuZ3RoKSkge1xuXHRcdFx0XHRcdFx0ZWwuaW5uZXJIVE1MID0gJzxpbWcgc3JjPVwiJyArIGRhdGFVcmwgKyAnXCIgd2lkdGg9XCInICsgaW1nLndpZHRoICsgJ1wiIGhlaWdodD1cIicgKyBpbWcuaGVpZ2h0ICsgJ1wiIGFsdD1cIlwiIC8+Jztcblx0XHRcdFx0XHRcdGltZy5kZXN0cm95KCk7XG5cdFx0XHRcdFx0XHRzZWxmLnRyaWdnZXIoJ2VtYmVkZGVkJyk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHZhciB0ciA9IG5ldyBUcmFuc3BvcnRlcigpO1xuXG5cdFx0XHRcdFx0XHR0ci5iaW5kKFwiVHJhbnNwb3J0aW5nQ29tcGxldGVcIiwgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRcdHJ1bnRpbWUgPSBzZWxmLmNvbm5lY3RSdW50aW1lKHRoaXMucmVzdWx0LnJ1aWQpO1xuXG5cdFx0XHRcdFx0XHRcdHNlbGYuYmluZChcIkVtYmVkZGVkXCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0XHRcdC8vIHBvc2l0aW9uIGFuZCBzaXplIHByb3Blcmx5XG5cdFx0XHRcdFx0XHRcdFx0QmFzaWMuZXh0ZW5kKHJ1bnRpbWUuZ2V0U2hpbUNvbnRhaW5lcigpLnN0eWxlLCB7XG5cdFx0XHRcdFx0XHRcdFx0XHQvL3Bvc2l0aW9uOiAncmVsYXRpdmUnLFxuXHRcdFx0XHRcdFx0XHRcdFx0dG9wOiAnMHB4Jyxcblx0XHRcdFx0XHRcdFx0XHRcdGxlZnQ6ICcwcHgnLFxuXHRcdFx0XHRcdFx0XHRcdFx0d2lkdGg6IGltZy53aWR0aCArICdweCcsXG5cdFx0XHRcdFx0XHRcdFx0XHRoZWlnaHQ6IGltZy5oZWlnaHQgKyAncHgnXG5cdFx0XHRcdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0XHRcdFx0XHQvLyBzb21lIHNoaW1zIChGbGFzaC9TaWx2ZXJMaWdodCkgcmVpbml0aWFsaXplLCBpZiBwYXJlbnQgZWxlbWVudCBpcyBoaWRkZW4sIHJlb3JkZXJlZCBvciBpdCdzXG5cdFx0XHRcdFx0XHRcdFx0Ly8gcG9zaXRpb24gdHlwZSBjaGFuZ2VzIChpbiBHZWNrbyksIGJ1dCBzaW5jZSB3ZSBiYXNpY2FsbHkgbmVlZCB0aGlzIG9ubHkgaW4gSUVzIDYvNyBhbmRcblx0XHRcdFx0XHRcdFx0XHQvLyBzb21ldGltZXMgOCBhbmQgdGhleSBkbyBub3QgaGF2ZSB0aGlzIHByb2JsZW0sIHdlIGNhbiBjb21tZW50IHRoaXMgZm9yIG5vd1xuXHRcdFx0XHRcdFx0XHRcdC8qdHIuYmluZChcIlJ1bnRpbWVJbml0XCIsIGZ1bmN0aW9uKGUsIHJ1bnRpbWUpIHtcblx0XHRcdFx0XHRcdFx0XHRcdHRyLmRlc3Ryb3koKTtcblx0XHRcdFx0XHRcdFx0XHRcdHJ1bnRpbWUuZGVzdHJveSgpO1xuXHRcdFx0XHRcdFx0XHRcdFx0b25SZXNpemUuY2FsbChzZWxmKTsgLy8gcmUtZmVlZCBvdXIgaW1hZ2UgZGF0YVxuXHRcdFx0XHRcdFx0XHRcdH0pOyovXG5cblx0XHRcdFx0XHRcdFx0XHRydW50aW1lID0gbnVsbDsgLy8gcmVsZWFzZVxuXHRcdFx0XHRcdFx0XHR9LCA5OTkpO1xuXG5cdFx0XHRcdFx0XHRcdHJ1bnRpbWUuZXhlYy5jYWxsKHNlbGYsIFwiSW1hZ2VWaWV3XCIsIFwiZGlzcGxheVwiLCB0aGlzLnJlc3VsdC51aWQsIHdpZHRoLCBoZWlnaHQpO1xuXHRcdFx0XHRcdFx0XHRpbWcuZGVzdHJveSgpO1xuXHRcdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0XHRcdHRyLnRyYW5zcG9ydChFbmNvZGUuYXRvYihkYXRhVXJsLnN1YnN0cmluZyhkYXRhVXJsLmluZGV4T2YoJ2Jhc2U2NCwnKSArIDcpKSwgdHlwZSwge1xuXHRcdFx0XHRcdFx0XHRyZXF1aXJlZF9jYXBzOiB7XG5cdFx0XHRcdFx0XHRcdFx0ZGlzcGxheV9tZWRpYTogdHJ1ZVxuXHRcdFx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdFx0XHRydW50aW1lX29yZGVyOiAnZmxhc2gsc2lsdmVybGlnaHQnLFxuXHRcdFx0XHRcdFx0XHRjb250YWluZXI6IGVsXG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdGlmICghKGVsID0gRG9tLmdldChlbCkpKSB7XG5cdFx0XHRcdFx0XHR0aHJvdyBuZXcgeC5ET01FeGNlcHRpb24oeC5ET01FeGNlcHRpb24uSU5WQUxJRF9OT0RFX1RZUEVfRVJSKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpZiAoIXRoaXMuc2l6ZSkgeyAvLyBvbmx5IHByZWxvYWRlZCBpbWFnZSBvYmplY3RzIGNhbiBiZSB1c2VkIGFzIHNvdXJjZVxuXHRcdFx0XHRcdFx0dGhyb3cgbmV3IHguRE9NRXhjZXB0aW9uKHguRE9NRXhjZXB0aW9uLklOVkFMSURfU1RBVEVfRVJSKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQvLyBoaWdoLXJlc29sdXRpb24gaW1hZ2VzIGNhbm5vdCBiZSBjb25zaXN0ZW50bHkgaGFuZGxlZCBhY3Jvc3MgdGhlIHJ1bnRpbWVzXG5cdFx0XHRcdFx0aWYgKHRoaXMud2lkdGggPiBJbWFnZS5NQVhfUkVTSVpFX1dJRFRIIHx8IHRoaXMuaGVpZ2h0ID4gSW1hZ2UuTUFYX1JFU0laRV9IRUlHSFQpIHtcblx0XHRcdFx0XHRcdC8vdGhyb3cgbmV3IHguSW1hZ2VFcnJvcih4LkltYWdlRXJyb3IuTUFYX1JFU09MVVRJT05fRVJSKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHR2YXIgaW1nQ29weSA9IG5ldyBJbWFnZSgpO1xuXG5cdFx0XHRcdFx0aW1nQ29weS5iaW5kKFwiUmVzaXplXCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0cmVuZGVyLmNhbGwodGhpcywgb3B0cy50eXBlLCBvcHRzLnF1YWxpdHkpO1xuXHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdFx0aW1nQ29weS5iaW5kKFwiTG9hZFwiLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdHRoaXMuZG93bnNpemUob3B0cyk7XG5cdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0XHQvLyBpZiBlbWJlZGRlZCB0aHVtYiBkYXRhIGlzIGF2YWlsYWJsZSBhbmQgZGltZW5zaW9ucyBhcmUgYmlnIGVub3VnaCwgdXNlIGl0XG5cdFx0XHRcdFx0aWYgKHRoaXMubWV0YS50aHVtYiAmJiB0aGlzLm1ldGEudGh1bWIud2lkdGggPj0gb3B0cy53aWR0aCAmJiB0aGlzLm1ldGEudGh1bWIuaGVpZ2h0ID49IG9wdHMuaGVpZ2h0KSB7XG5cdFx0XHRcdFx0XHRpbWdDb3B5LmxvYWQodGhpcy5tZXRhLnRodW1iLmRhdGEpO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRpbWdDb3B5LmNsb25lKHRoaXMsIGZhbHNlKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRyZXR1cm4gaW1nQ29weTtcblx0XHRcdFx0fSBjYXRjaChleCkge1xuXHRcdFx0XHRcdC8vIGZvciBub3cgc2ltcGx5IHRyaWdnZXIgZXJyb3IgZXZlbnRcblx0XHRcdFx0XHR0aGlzLnRyaWdnZXIoJ2Vycm9yJywgZXguY29kZSk7XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cblx0XHRcdC8qKlxuXHRcdFx0UHJvcGVybHkgZGVzdHJveXMgdGhlIGltYWdlIGFuZCBmcmVlcyByZXNvdXJjZXMgaW4gdXNlLiBJZiBhbnkuIFJlY29tbWVuZGVkIHdheSB0byBkaXNwb3NlXG5cdFx0XHRtb3hpZS5pbWFnZS5JbWFnZSBvYmplY3QuXG5cblx0XHRcdEBtZXRob2QgZGVzdHJveVxuXHRcdFx0Ki9cblx0XHRcdGRlc3Ryb3k6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRpZiAodGhpcy5ydWlkKSB7XG5cdFx0XHRcdFx0dGhpcy5nZXRSdW50aW1lKCkuZXhlYy5jYWxsKHRoaXMsICdJbWFnZScsICdkZXN0cm95Jyk7XG5cdFx0XHRcdFx0dGhpcy5kaXNjb25uZWN0UnVudGltZSgpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICh0aGlzLm1ldGEgJiYgdGhpcy5tZXRhLnRodW1iKSB7XG5cdFx0XHRcdFx0Ly8gdGh1bWIgaXMgYmxvYiwgbWFrZSBzdXJlIHdlIGRlc3Ryb3kgaXQgZmlyc3Rcblx0XHRcdFx0XHR0aGlzLm1ldGEudGh1bWIuZGF0YS5kZXN0cm95KCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0dGhpcy51bmJpbmRBbGwoKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXG5cdFx0Ly8gdGhpcyBpcyBoZXJlLCBiZWNhdXNlIGluIG9yZGVyIHRvIGJpbmQgcHJvcGVybHksIHdlIG5lZWQgdWlkLCB3aGljaCBpcyBjcmVhdGVkIGFib3ZlXG5cdFx0dGhpcy5oYW5kbGVFdmVudFByb3BzKGRpc3BhdGNoZXMpO1xuXG5cdFx0dGhpcy5iaW5kKCdMb2FkIFJlc2l6ZScsIGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIF91cGRhdGVJbmZvLmNhbGwodGhpcyk7IC8vIGlmIG9wZXJhdGlvbiBmYWlscyAoZS5nLiBpbWFnZSBpcyBuZWl0aGVyIFBORyBub3IgSlBFRykgY2FuY2VsIGFsbCBwZW5kaW5nIGV2ZW50c1xuXHRcdH0sIDk5OSk7XG5cblxuXHRcdGZ1bmN0aW9uIF91cGRhdGVJbmZvKGluZm8pIHtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdGlmICghaW5mbykge1xuXHRcdFx0XHRcdGluZm8gPSB0aGlzLmV4ZWMoJ0ltYWdlJywgJ2dldEluZm8nKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHRoaXMuc2l6ZSA9IGluZm8uc2l6ZTtcblx0XHRcdFx0dGhpcy53aWR0aCA9IGluZm8ud2lkdGg7XG5cdFx0XHRcdHRoaXMuaGVpZ2h0ID0gaW5mby5oZWlnaHQ7XG5cdFx0XHRcdHRoaXMudHlwZSA9IGluZm8udHlwZTtcblx0XHRcdFx0dGhpcy5tZXRhID0gaW5mby5tZXRhO1xuXG5cdFx0XHRcdC8vIHVwZGF0ZSBmaWxlIG5hbWUsIG9ubHkgaWYgZW1wdHlcblx0XHRcdFx0aWYgKHRoaXMubmFtZSA9PT0gJycpIHtcblx0XHRcdFx0XHR0aGlzLm5hbWUgPSBpbmZvLm5hbWU7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdH0gY2F0Y2goZXgpIHtcblx0XHRcdFx0dGhpcy50cmlnZ2VyKCdlcnJvcicsIGV4LmNvZGUpO1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cdFx0fVxuXG5cblx0XHRmdW5jdGlvbiBfbG9hZChzcmMpIHtcblx0XHRcdHZhciBzcmNUeXBlID0gQmFzaWMudHlwZU9mKHNyYyk7XG5cblx0XHRcdHRyeSB7XG5cdFx0XHRcdC8vIGlmIHNvdXJjZSBpcyBJbWFnZVxuXHRcdFx0XHRpZiAoc3JjIGluc3RhbmNlb2YgSW1hZ2UpIHtcblx0XHRcdFx0XHRpZiAoIXNyYy5zaXplKSB7IC8vIG9ubHkgcHJlbG9hZGVkIGltYWdlIG9iamVjdHMgY2FuIGJlIHVzZWQgYXMgc291cmNlXG5cdFx0XHRcdFx0XHR0aHJvdyBuZXcgeC5ET01FeGNlcHRpb24oeC5ET01FeGNlcHRpb24uSU5WQUxJRF9TVEFURV9FUlIpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRfbG9hZEZyb21JbWFnZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdC8vIGlmIHNvdXJjZSBpcyBvLkJsb2Ivby5GaWxlXG5cdFx0XHRcdGVsc2UgaWYgKHNyYyBpbnN0YW5jZW9mIEJsb2IpIHtcblx0XHRcdFx0XHRpZiAoIX5CYXNpYy5pbkFycmF5KHNyYy50eXBlLCBbJ2ltYWdlL2pwZWcnLCAnaW1hZ2UvcG5nJ10pKSB7XG5cdFx0XHRcdFx0XHR0aHJvdyBuZXcgeC5JbWFnZUVycm9yKHguSW1hZ2VFcnJvci5XUk9OR19GT1JNQVQpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRfbG9hZEZyb21CbG9iLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0XHRcdH1cblx0XHRcdFx0Ly8gaWYgbmF0aXZlIGJsb2IvZmlsZVxuXHRcdFx0XHRlbHNlIGlmIChCYXNpYy5pbkFycmF5KHNyY1R5cGUsIFsnYmxvYicsICdmaWxlJ10pICE9PSAtMSkge1xuXHRcdFx0XHRcdF9sb2FkLmNhbGwodGhpcywgbmV3IEZpbGUobnVsbCwgc3JjKSwgYXJndW1lbnRzWzFdKTtcblx0XHRcdFx0fVxuXHRcdFx0XHQvLyBpZiBTdHJpbmdcblx0XHRcdFx0ZWxzZSBpZiAoc3JjVHlwZSA9PT0gJ3N0cmluZycpIHtcblx0XHRcdFx0XHQvLyBpZiBkYXRhVXJsIFN0cmluZ1xuXHRcdFx0XHRcdGlmIChzcmMuc3Vic3RyKDAsIDUpID09PSAnZGF0YTonKSB7XG5cdFx0XHRcdFx0XHRfbG9hZC5jYWxsKHRoaXMsIG5ldyBCbG9iKG51bGwsIHsgZGF0YTogc3JjIH0pLCBhcmd1bWVudHNbMV0pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHQvLyBlbHNlIGFzc3VtZSBVcmwsIGVpdGhlciByZWxhdGl2ZSBvciBhYnNvbHV0ZVxuXHRcdFx0XHRcdGVsc2Uge1xuXHRcdFx0XHRcdFx0X2xvYWRGcm9tVXJsLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdC8vIGlmIHNvdXJjZSBzZWVtcyB0byBiZSBhbiBpbWcgbm9kZVxuXHRcdFx0XHRlbHNlIGlmIChzcmNUeXBlID09PSAnbm9kZScgJiYgc3JjLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICdpbWcnKSB7XG5cdFx0XHRcdFx0X2xvYWQuY2FsbCh0aGlzLCBzcmMuc3JjLCBhcmd1bWVudHNbMV0pO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGVsc2Uge1xuXHRcdFx0XHRcdHRocm93IG5ldyB4LkRPTUV4Y2VwdGlvbih4LkRPTUV4Y2VwdGlvbi5UWVBFX01JU01BVENIX0VSUik7XG5cdFx0XHRcdH1cblx0XHRcdH0gY2F0Y2goZXgpIHtcblx0XHRcdFx0Ly8gZm9yIG5vdyBzaW1wbHkgdHJpZ2dlciBlcnJvciBldmVudFxuXHRcdFx0XHR0aGlzLnRyaWdnZXIoJ2Vycm9yJywgZXguY29kZSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cblx0XHRmdW5jdGlvbiBfbG9hZEZyb21JbWFnZShpbWcsIGV4YWN0KSB7XG5cdFx0XHR2YXIgcnVudGltZSA9IHRoaXMuY29ubmVjdFJ1bnRpbWUoaW1nLnJ1aWQpO1xuXHRcdFx0dGhpcy5ydWlkID0gcnVudGltZS51aWQ7XG5cdFx0XHRydW50aW1lLmV4ZWMuY2FsbCh0aGlzLCAnSW1hZ2UnLCAnbG9hZEZyb21JbWFnZScsIGltZywgKEJhc2ljLnR5cGVPZihleGFjdCkgPT09ICd1bmRlZmluZWQnID8gdHJ1ZSA6IGV4YWN0KSk7XG5cdFx0fVxuXG5cblx0XHRmdW5jdGlvbiBfbG9hZEZyb21CbG9iKGJsb2IsIG9wdGlvbnMpIHtcblx0XHRcdHZhciBzZWxmID0gdGhpcztcblxuXHRcdFx0c2VsZi5uYW1lID0gYmxvYi5uYW1lIHx8ICcnO1xuXG5cdFx0XHRmdW5jdGlvbiBleGVjKHJ1bnRpbWUpIHtcblx0XHRcdFx0c2VsZi5ydWlkID0gcnVudGltZS51aWQ7XG5cdFx0XHRcdHJ1bnRpbWUuZXhlYy5jYWxsKHNlbGYsICdJbWFnZScsICdsb2FkRnJvbUJsb2InLCBibG9iKTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKGJsb2IuaXNEZXRhY2hlZCgpKSB7XG5cdFx0XHRcdHRoaXMuYmluZCgnUnVudGltZUluaXQnLCBmdW5jdGlvbihlLCBydW50aW1lKSB7XG5cdFx0XHRcdFx0ZXhlYyhydW50aW1lKTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0Ly8gY29udmVydCB0byBvYmplY3QgcmVwcmVzZW50YXRpb25cblx0XHRcdFx0aWYgKG9wdGlvbnMgJiYgdHlwZW9mKG9wdGlvbnMucmVxdWlyZWRfY2FwcykgPT09ICdzdHJpbmcnKSB7XG5cdFx0XHRcdFx0b3B0aW9ucy5yZXF1aXJlZF9jYXBzID0gUnVudGltZS5wYXJzZUNhcHMob3B0aW9ucy5yZXF1aXJlZF9jYXBzKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHRoaXMuY29ubmVjdFJ1bnRpbWUoQmFzaWMuZXh0ZW5kKHtcblx0XHRcdFx0XHRyZXF1aXJlZF9jYXBzOiB7XG5cdFx0XHRcdFx0XHRhY2Nlc3NfaW1hZ2VfYmluYXJ5OiB0cnVlLFxuXHRcdFx0XHRcdFx0cmVzaXplX2ltYWdlOiB0cnVlXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9LCBvcHRpb25zKSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRleGVjKHRoaXMuY29ubmVjdFJ1bnRpbWUoYmxvYi5ydWlkKSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cblx0XHRmdW5jdGlvbiBfbG9hZEZyb21VcmwodXJsLCBvcHRpb25zKSB7XG5cdFx0XHR2YXIgc2VsZiA9IHRoaXMsIHhocjtcblxuXHRcdFx0eGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG5cblx0XHRcdHhoci5vcGVuKCdnZXQnLCB1cmwpO1xuXHRcdFx0eGhyLnJlc3BvbnNlVHlwZSA9ICdibG9iJztcblxuXHRcdFx0eGhyLm9ucHJvZ3Jlc3MgPSBmdW5jdGlvbihlKSB7XG5cdFx0XHRcdHNlbGYudHJpZ2dlcihlKTtcblx0XHRcdH07XG5cblx0XHRcdHhoci5vbmxvYWQgPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0X2xvYWRGcm9tQmxvYi5jYWxsKHNlbGYsIHhoci5yZXNwb25zZSwgdHJ1ZSk7XG5cdFx0XHR9O1xuXG5cdFx0XHR4aHIub25lcnJvciA9IGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0c2VsZi50cmlnZ2VyKGUpO1xuXHRcdFx0fTtcblxuXHRcdFx0eGhyLm9ubG9hZGVuZCA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR4aHIuZGVzdHJveSgpO1xuXHRcdFx0fTtcblxuXHRcdFx0eGhyLmJpbmQoJ1J1bnRpbWVFcnJvcicsIGZ1bmN0aW9uKGUsIGVycikge1xuXHRcdFx0XHRzZWxmLnRyaWdnZXIoJ1J1bnRpbWVFcnJvcicsIGVycik7XG5cdFx0XHR9KTtcblxuXHRcdFx0eGhyLnNlbmQobnVsbCwgb3B0aW9ucyk7XG5cdFx0fVxuXHR9XG5cblx0Ly8gdmlydHVhbCB3b3JsZCB3aWxsIGNyYXNoIG9uIHlvdSBpZiBpbWFnZSBoYXMgYSByZXNvbHV0aW9uIGhpZ2hlciB0aGFuIHRoaXM6XG5cdEltYWdlLk1BWF9SRVNJWkVfV0lEVEggPSA4MTkyO1xuXHRJbWFnZS5NQVhfUkVTSVpFX0hFSUdIVCA9IDgxOTI7XG5cblx0SW1hZ2UucHJvdG90eXBlID0gRXZlbnRUYXJnZXQuaW5zdGFuY2U7XG5cblx0cmV0dXJuIEltYWdlO1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L3J1bnRpbWUvaHRtbDUvUnVudGltZS5qc1xuXG4vKipcbiAqIFJ1bnRpbWUuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuLypnbG9iYWwgRmlsZTp0cnVlICovXG5cbi8qKlxuRGVmaW5lcyBjb25zdHJ1Y3RvciBmb3IgSFRNTDUgcnVudGltZS5cblxuQGNsYXNzIG1veGllL3J1bnRpbWUvaHRtbDUvUnVudGltZVxuQHByaXZhdGVcbiovXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL2h0bWw1L1J1bnRpbWVcIiwgW1xuXHRcIm1veGllL2NvcmUvdXRpbHMvQmFzaWNcIixcblx0XCJtb3hpZS9jb3JlL0V4Y2VwdGlvbnNcIixcblx0XCJtb3hpZS9ydW50aW1lL1J1bnRpbWVcIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0VudlwiXG5dLCBmdW5jdGlvbihCYXNpYywgeCwgUnVudGltZSwgRW52KSB7XG5cdFxuXHR2YXIgdHlwZSA9IFwiaHRtbDVcIiwgZXh0ZW5zaW9ucyA9IHt9O1xuXHRcblx0ZnVuY3Rpb24gSHRtbDVSdW50aW1lKG9wdGlvbnMpIHtcblx0XHR2YXIgSSA9IHRoaXNcblx0XHQsIFRlc3QgPSBSdW50aW1lLmNhcFRlc3Rcblx0XHQsIFRydWUgPSBSdW50aW1lLmNhcFRydWVcblx0XHQ7XG5cblx0XHR2YXIgY2FwcyA9IEJhc2ljLmV4dGVuZCh7XG5cdFx0XHRcdGFjY2Vzc19iaW5hcnk6IFRlc3Qod2luZG93LkZpbGVSZWFkZXIgfHwgd2luZG93LkZpbGUgJiYgd2luZG93LkZpbGUuZ2V0QXNEYXRhVVJMKSxcblx0XHRcdFx0YWNjZXNzX2ltYWdlX2JpbmFyeTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0cmV0dXJuIEkuY2FuKCdhY2Nlc3NfYmluYXJ5JykgJiYgISFleHRlbnNpb25zLkltYWdlO1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRkaXNwbGF5X21lZGlhOiBUZXN0KFxuXHRcdFx0XHRcdChFbnYuY2FuKCdjcmVhdGVfY2FudmFzJykgfHwgRW52LmNhbigndXNlX2RhdGFfdXJpX292ZXIzMmtiJykpICYmIFxuXHRcdFx0XHRcdGRlZmluZWQoJ21veGllL2ltYWdlL0ltYWdlJylcblx0XHRcdFx0KSxcblx0XHRcdFx0ZG9fY29yczogVGVzdCh3aW5kb3cuWE1MSHR0cFJlcXVlc3QgJiYgJ3dpdGhDcmVkZW50aWFscycgaW4gbmV3IFhNTEh0dHBSZXF1ZXN0KCkpLFxuXHRcdFx0XHRkcmFnX2FuZF9kcm9wOiBUZXN0KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdC8vIHRoaXMgY29tZXMgZGlyZWN0bHkgZnJvbSBNb2Rlcm5penI6IGh0dHA6Ly93d3cubW9kZXJuaXpyLmNvbS9cblx0XHRcdFx0XHR2YXIgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0XHRcdFx0Ly8gSUUgaGFzIHN1cHBvcnQgZm9yIGRyYWcgYW5kIGRyb3Agc2luY2UgdmVyc2lvbiA1LCBidXQgZG9lc24ndCBzdXBwb3J0IGRyb3BwaW5nIGZpbGVzIGZyb20gZGVza3RvcFxuXHRcdFx0XHRcdHJldHVybiAoKCdkcmFnZ2FibGUnIGluIGRpdikgfHwgKCdvbmRyYWdzdGFydCcgaW4gZGl2ICYmICdvbmRyb3AnIGluIGRpdikpICYmIFxuXHRcdFx0XHRcdFx0KEVudi5icm93c2VyICE9PSAnSUUnIHx8IEVudi52ZXJDb21wKEVudi52ZXJzaW9uLCA5LCAnPicpKTtcblx0XHRcdFx0fSgpKSxcblx0XHRcdFx0ZmlsdGVyX2J5X2V4dGVuc2lvbjogVGVzdChmdW5jdGlvbigpIHsgLy8gaWYgeW91IGtub3cgaG93IHRvIGZlYXR1cmUtZGV0ZWN0IHRoaXMsIHBsZWFzZSBzdWdnZXN0XG5cdFx0XHRcdFx0cmV0dXJuICEoXG5cdFx0XHRcdFx0XHQoRW52LmJyb3dzZXIgPT09ICdDaHJvbWUnICYmIEVudi52ZXJDb21wKEVudi52ZXJzaW9uLCAyOCwgJzwnKSkgfHwgXG5cdFx0XHRcdFx0XHQoRW52LmJyb3dzZXIgPT09ICdJRScgJiYgRW52LnZlckNvbXAoRW52LnZlcnNpb24sIDEwLCAnPCcpKSB8fCBcblx0XHRcdFx0XHRcdChFbnYuYnJvd3NlciA9PT0gJ1NhZmFyaScgJiYgRW52LnZlckNvbXAoRW52LnZlcnNpb24sIDcsICc8JykpIHx8XG5cdFx0XHRcdFx0XHQoRW52LmJyb3dzZXIgPT09ICdGaXJlZm94JyAmJiBFbnYudmVyQ29tcChFbnYudmVyc2lvbiwgMzcsICc8JykpXG5cdFx0XHRcdFx0KTtcblx0XHRcdFx0fSgpKSxcblx0XHRcdFx0cmV0dXJuX3Jlc3BvbnNlX2hlYWRlcnM6IFRydWUsXG5cdFx0XHRcdHJldHVybl9yZXNwb25zZV90eXBlOiBmdW5jdGlvbihyZXNwb25zZVR5cGUpIHtcblx0XHRcdFx0XHRpZiAocmVzcG9uc2VUeXBlID09PSAnanNvbicgJiYgISF3aW5kb3cuSlNPTikgeyAvLyB3ZSBjYW4gZmFrZSB0aGlzIG9uZSBldmVuIGlmIGl0J3Mgbm90IHN1cHBvcnRlZFxuXHRcdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdFx0fSBcblx0XHRcdFx0XHRyZXR1cm4gRW52LmNhbigncmV0dXJuX3Jlc3BvbnNlX3R5cGUnLCByZXNwb25zZVR5cGUpO1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRyZXR1cm5fc3RhdHVzX2NvZGU6IFRydWUsXG5cdFx0XHRcdHJlcG9ydF91cGxvYWRfcHJvZ3Jlc3M6IFRlc3Qod2luZG93LlhNTEh0dHBSZXF1ZXN0ICYmIG5ldyBYTUxIdHRwUmVxdWVzdCgpLnVwbG9hZCksXG5cdFx0XHRcdHJlc2l6ZV9pbWFnZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0cmV0dXJuIEkuY2FuKCdhY2Nlc3NfYmluYXJ5JykgJiYgRW52LmNhbignY3JlYXRlX2NhbnZhcycpO1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRzZWxlY3RfZmlsZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0cmV0dXJuIEVudi5jYW4oJ3VzZV9maWxlaW5wdXQnKSAmJiB3aW5kb3cuRmlsZTtcblx0XHRcdFx0fSxcblx0XHRcdFx0c2VsZWN0X2ZvbGRlcjogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0cmV0dXJuIEkuY2FuKCdzZWxlY3RfZmlsZScpICYmIChcblx0XHRcdFx0XHRcdEVudi5icm93c2VyID09PSAnQ2hyb21lJyAmJiBFbnYudmVyQ29tcChFbnYudmVyc2lvbiwgMjEsICc+PScpIHx8XG5cdFx0XHRcdFx0XHRFbnYuYnJvd3NlciA9PT0gJ0ZpcmVmb3gnICYmIEVudi52ZXJDb21wKEVudi52ZXJzaW9uLCA0MiwgJz49JykgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvRmlyZWZveC9SZWxlYXNlcy80MlxuXHRcdFx0XHRcdCk7XG5cdFx0XHRcdH0sXG5cdFx0XHRcdHNlbGVjdF9tdWx0aXBsZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0Ly8gaXQgaXMgYnVnZ3kgb24gU2FmYXJpIFdpbmRvd3MgYW5kIGlPU1xuXHRcdFx0XHRcdHJldHVybiBJLmNhbignc2VsZWN0X2ZpbGUnKSAmJlxuXHRcdFx0XHRcdFx0IShFbnYuYnJvd3NlciA9PT0gJ1NhZmFyaScgJiYgRW52Lm9zID09PSAnV2luZG93cycpICYmXG5cdFx0XHRcdFx0XHQhKEVudi5vcyA9PT0gJ2lPUycgJiYgRW52LnZlckNvbXAoRW52Lm9zVmVyc2lvbiwgXCI3LjAuMFwiLCAnPicpICYmIEVudi52ZXJDb21wKEVudi5vc1ZlcnNpb24sIFwiOC4wLjBcIiwgJzwnKSk7XG5cdFx0XHRcdH0sXG5cdFx0XHRcdHNlbmRfYmluYXJ5X3N0cmluZzogVGVzdCh3aW5kb3cuWE1MSHR0cFJlcXVlc3QgJiYgKG5ldyBYTUxIdHRwUmVxdWVzdCgpLnNlbmRBc0JpbmFyeSB8fCAod2luZG93LlVpbnQ4QXJyYXkgJiYgd2luZG93LkFycmF5QnVmZmVyKSkpLFxuXHRcdFx0XHRzZW5kX2N1c3RvbV9oZWFkZXJzOiBUZXN0KHdpbmRvdy5YTUxIdHRwUmVxdWVzdCksXG5cdFx0XHRcdHNlbmRfbXVsdGlwYXJ0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRyZXR1cm4gISEod2luZG93LlhNTEh0dHBSZXF1ZXN0ICYmIG5ldyBYTUxIdHRwUmVxdWVzdCgpLnVwbG9hZCAmJiB3aW5kb3cuRm9ybURhdGEpIHx8IEkuY2FuKCdzZW5kX2JpbmFyeV9zdHJpbmcnKTtcblx0XHRcdFx0fSxcblx0XHRcdFx0c2xpY2VfYmxvYjogVGVzdCh3aW5kb3cuRmlsZSAmJiAoRmlsZS5wcm90b3R5cGUubW96U2xpY2UgfHwgRmlsZS5wcm90b3R5cGUud2Via2l0U2xpY2UgfHwgRmlsZS5wcm90b3R5cGUuc2xpY2UpKSxcblx0XHRcdFx0c3RyZWFtX3VwbG9hZDogZnVuY3Rpb24oKXtcblx0XHRcdFx0XHRyZXR1cm4gSS5jYW4oJ3NsaWNlX2Jsb2InKSAmJiBJLmNhbignc2VuZF9tdWx0aXBhcnQnKTtcblx0XHRcdFx0fSxcblx0XHRcdFx0c3VtbW9uX2ZpbGVfZGlhbG9nOiBmdW5jdGlvbigpIHsgLy8geWVhaC4uLiBzb21lIGRpcnR5IHNuaWZmaW5nIGhlcmUuLi5cblx0XHRcdFx0XHRyZXR1cm4gSS5jYW4oJ3NlbGVjdF9maWxlJykgJiYgIShcblx0XHRcdFx0XHRcdChFbnYuYnJvd3NlciA9PT0gJ0ZpcmVmb3gnICYmIEVudi52ZXJDb21wKEVudi52ZXJzaW9uLCA0LCAnPCcpKSB8fFxuXHRcdFx0XHRcdFx0KEVudi5icm93c2VyID09PSAnT3BlcmEnICYmIEVudi52ZXJDb21wKEVudi52ZXJzaW9uLCAxMiwgJzwnKSkgfHxcblx0XHRcdFx0XHRcdChFbnYuYnJvd3NlciA9PT0gJ0lFJyAmJiBFbnYudmVyQ29tcChFbnYudmVyc2lvbiwgMTAsICc8JykpXG5cdFx0XHRcdFx0KTtcblx0XHRcdFx0fSxcblx0XHRcdFx0dXBsb2FkX2ZpbGVzaXplOiBUcnVlLFxuXHRcdFx0XHR1c2VfaHR0cF9tZXRob2Q6IFRydWVcblx0XHRcdH0sIFxuXHRcdFx0YXJndW1lbnRzWzJdXG5cdFx0KTtcblxuXHRcdFJ1bnRpbWUuY2FsbCh0aGlzLCBvcHRpb25zLCAoYXJndW1lbnRzWzFdIHx8IHR5cGUpLCBjYXBzKTtcblxuXG5cdFx0QmFzaWMuZXh0ZW5kKHRoaXMsIHtcblxuXHRcdFx0aW5pdCA6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR0aGlzLnRyaWdnZXIoXCJJbml0XCIpO1xuXHRcdFx0fSxcblxuXHRcdFx0ZGVzdHJveTogKGZ1bmN0aW9uKGRlc3Ryb3kpIHsgLy8gZXh0ZW5kIGRlZmF1bHQgZGVzdHJveSBtZXRob2Rcblx0XHRcdFx0cmV0dXJuIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdGRlc3Ryb3kuY2FsbChJKTtcblx0XHRcdFx0XHRkZXN0cm95ID0gSSA9IG51bGw7XG5cdFx0XHRcdH07XG5cdFx0XHR9KHRoaXMuZGVzdHJveSkpXG5cdFx0fSk7XG5cblx0XHRCYXNpYy5leHRlbmQodGhpcy5nZXRTaGltKCksIGV4dGVuc2lvbnMpO1xuXHR9XG5cblx0UnVudGltZS5hZGRDb25zdHJ1Y3Rvcih0eXBlLCBIdG1sNVJ1bnRpbWUpO1xuXG5cdHJldHVybiBleHRlbnNpb25zO1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L3J1bnRpbWUvaHRtbDUvZmlsZS9CbG9iLmpzXG5cbi8qKlxuICogQmxvYi5qc1xuICpcbiAqIENvcHlyaWdodCAyMDEzLCBNb3hpZWNvZGUgU3lzdGVtcyBBQlxuICogUmVsZWFzZWQgdW5kZXIgR1BMIExpY2Vuc2UuXG4gKlxuICogTGljZW5zZTogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vbGljZW5zZVxuICogQ29udHJpYnV0aW5nOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9jb250cmlidXRpbmdcbiAqL1xuXG4vKipcbkBjbGFzcyBtb3hpZS9ydW50aW1lL2h0bWw1L2ZpbGUvQmxvYlxuQHByaXZhdGVcbiovXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL2h0bWw1L2ZpbGUvQmxvYlwiLCBbXG5cdFwibW94aWUvcnVudGltZS9odG1sNS9SdW50aW1lXCIsXG5cdFwibW94aWUvZmlsZS9CbG9iXCJcbl0sIGZ1bmN0aW9uKGV4dGVuc2lvbnMsIEJsb2IpIHtcblxuXHRmdW5jdGlvbiBIVE1MNUJsb2IoKSB7XG5cdFx0ZnVuY3Rpb24gdzNjQmxvYlNsaWNlKGJsb2IsIHN0YXJ0LCBlbmQpIHtcblx0XHRcdHZhciBibG9iU2xpY2U7XG5cblx0XHRcdGlmICh3aW5kb3cuRmlsZS5wcm90b3R5cGUuc2xpY2UpIHtcblx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRibG9iLnNsaWNlKCk7XHQvLyBkZXByaWNhdGVkIHZlcnNpb24gd2lsbCB0aHJvdyBXUk9OR19BUkdVTUVOVFNfRVJSIGV4Y2VwdGlvblxuXHRcdFx0XHRcdHJldHVybiBibG9iLnNsaWNlKHN0YXJ0LCBlbmQpO1xuXHRcdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdFx0Ly8gZGVwcmljYXRlZCBzbGljZSBtZXRob2Rcblx0XHRcdFx0XHRyZXR1cm4gYmxvYi5zbGljZShzdGFydCwgZW5kIC0gc3RhcnQpO1xuXHRcdFx0XHR9XG5cdFx0XHQvLyBzbGljZSBtZXRob2QgZ290IHByZWZpeGVkOiBodHRwczovL2J1Z3ppbGxhLm1vemlsbGEub3JnL3Nob3dfYnVnLmNnaT9pZD02NDk2NzJcblx0XHRcdH0gZWxzZSBpZiAoKGJsb2JTbGljZSA9IHdpbmRvdy5GaWxlLnByb3RvdHlwZS53ZWJraXRTbGljZSB8fCB3aW5kb3cuRmlsZS5wcm90b3R5cGUubW96U2xpY2UpKSB7XG5cdFx0XHRcdHJldHVybiBibG9iU2xpY2UuY2FsbChibG9iLCBzdGFydCwgZW5kKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHJldHVybiBudWxsOyAvLyBvciB0aHJvdyBzb21lIGV4Y2VwdGlvblxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHRoaXMuc2xpY2UgPSBmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiBuZXcgQmxvYih0aGlzLmdldFJ1bnRpbWUoKS51aWQsIHczY0Jsb2JTbGljZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTtcblx0XHR9O1xuXG5cdFx0dGhpcy5kZXN0cm95ID0gZnVuY3Rpb24oKSB7XG5cdFx0XHR0aGlzLmdldFJ1bnRpbWUoKS5nZXRTaGltKCkucmVtb3ZlSW5zdGFuY2UodGhpcy51aWQpO1xuXHRcdH07XG5cdH1cblxuXHRyZXR1cm4gKGV4dGVuc2lvbnMuQmxvYiA9IEhUTUw1QmxvYik7XG59KTtcblxuLy8gSW5jbHVkZWQgZnJvbTogc3JjL2phdmFzY3JpcHQvY29yZS91dGlscy9FdmVudHMuanNcblxuLyoqXG4gKiBFdmVudHMuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuLyoqXG5AY2xhc3MgbW94aWUvY29yZS91dGlscy9FdmVudHNcbkBwdWJsaWNcbkBzdGF0aWNcbiovXG5cbmRlZmluZSgnbW94aWUvY29yZS91dGlscy9FdmVudHMnLCBbXG5cdCdtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljJ1xuXSwgZnVuY3Rpb24oQmFzaWMpIHtcblx0dmFyIGV2ZW50aGFzaCA9IHt9LCB1aWQgPSAnbW94aWVfJyArIEJhc2ljLmd1aWQoKTtcblx0XG5cdC8vIElFIFczQyBsaWtlIGV2ZW50IGZ1bmNzXG5cdGZ1bmN0aW9uIHByZXZlbnREZWZhdWx0KCkge1xuXHRcdHRoaXMucmV0dXJuVmFsdWUgPSBmYWxzZTtcblx0fVxuXG5cdGZ1bmN0aW9uIHN0b3BQcm9wYWdhdGlvbigpIHtcblx0XHR0aGlzLmNhbmNlbEJ1YmJsZSA9IHRydWU7XG5cdH1cblxuXHQvKipcblx0QWRkcyBhbiBldmVudCBoYW5kbGVyIHRvIHRoZSBzcGVjaWZpZWQgb2JqZWN0IGFuZCBzdG9yZSByZWZlcmVuY2UgdG8gdGhlIGhhbmRsZXJcblx0aW4gb2JqZWN0cyBpbnRlcm5hbCBQbHVwbG9hZCByZWdpc3RyeSAoQHNlZSByZW1vdmVFdmVudCkuXG5cdFxuXHRAbWV0aG9kIGFkZEV2ZW50XG5cdEBzdGF0aWNcblx0QHBhcmFtIHtPYmplY3R9IG9iaiBET00gZWxlbWVudCBsaWtlIG9iamVjdCB0byBhZGQgaGFuZGxlciB0by5cblx0QHBhcmFtIHtTdHJpbmd9IG5hbWUgTmFtZSB0byBhZGQgZXZlbnQgbGlzdGVuZXIgdG8uXG5cdEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIEZ1bmN0aW9uIHRvIGNhbGwgd2hlbiBldmVudCBvY2N1cnMuXG5cdEBwYXJhbSB7U3RyaW5nfSBba2V5XSB0aGF0IG1pZ2h0IGJlIHVzZWQgdG8gYWRkIHNwZWNpZml0eSB0byB0aGUgZXZlbnQgcmVjb3JkLlxuXHQqL1xuXHR2YXIgYWRkRXZlbnQgPSBmdW5jdGlvbihvYmosIG5hbWUsIGNhbGxiYWNrLCBrZXkpIHtcblx0XHR2YXIgZnVuYywgZXZlbnRzO1xuXHRcdFx0XHRcdFxuXHRcdG5hbWUgPSBuYW1lLnRvTG93ZXJDYXNlKCk7XG5cblx0XHQvLyBBZGQgZXZlbnQgbGlzdGVuZXJcblx0XHRpZiAob2JqLmFkZEV2ZW50TGlzdGVuZXIpIHtcblx0XHRcdGZ1bmMgPSBjYWxsYmFjaztcblx0XHRcdFxuXHRcdFx0b2JqLmFkZEV2ZW50TGlzdGVuZXIobmFtZSwgZnVuYywgZmFsc2UpO1xuXHRcdH0gZWxzZSBpZiAob2JqLmF0dGFjaEV2ZW50KSB7XG5cdFx0XHRmdW5jID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciBldnQgPSB3aW5kb3cuZXZlbnQ7XG5cblx0XHRcdFx0aWYgKCFldnQudGFyZ2V0KSB7XG5cdFx0XHRcdFx0ZXZ0LnRhcmdldCA9IGV2dC5zcmNFbGVtZW50O1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0ZXZ0LnByZXZlbnREZWZhdWx0ID0gcHJldmVudERlZmF1bHQ7XG5cdFx0XHRcdGV2dC5zdG9wUHJvcGFnYXRpb24gPSBzdG9wUHJvcGFnYXRpb247XG5cblx0XHRcdFx0Y2FsbGJhY2soZXZ0KTtcblx0XHRcdH07XG5cblx0XHRcdG9iai5hdHRhY2hFdmVudCgnb24nICsgbmFtZSwgZnVuYyk7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIExvZyBldmVudCBoYW5kbGVyIHRvIG9iamVjdHMgaW50ZXJuYWwgbU94aWUgcmVnaXN0cnlcblx0XHRpZiAoIW9ialt1aWRdKSB7XG5cdFx0XHRvYmpbdWlkXSA9IEJhc2ljLmd1aWQoKTtcblx0XHR9XG5cdFx0XG5cdFx0aWYgKCFldmVudGhhc2guaGFzT3duUHJvcGVydHkob2JqW3VpZF0pKSB7XG5cdFx0XHRldmVudGhhc2hbb2JqW3VpZF1dID0ge307XG5cdFx0fVxuXHRcdFxuXHRcdGV2ZW50cyA9IGV2ZW50aGFzaFtvYmpbdWlkXV07XG5cdFx0XG5cdFx0aWYgKCFldmVudHMuaGFzT3duUHJvcGVydHkobmFtZSkpIHtcblx0XHRcdGV2ZW50c1tuYW1lXSA9IFtdO1xuXHRcdH1cblx0XHRcdFx0XG5cdFx0ZXZlbnRzW25hbWVdLnB1c2goe1xuXHRcdFx0ZnVuYzogZnVuYyxcblx0XHRcdG9yaWc6IGNhbGxiYWNrLCAvLyBzdG9yZSBvcmlnaW5hbCBjYWxsYmFjayBmb3IgSUVcblx0XHRcdGtleToga2V5XG5cdFx0fSk7XG5cdH07XG5cdFxuXHRcblx0LyoqXG5cdFJlbW92ZSBldmVudCBoYW5kbGVyIGZyb20gdGhlIHNwZWNpZmllZCBvYmplY3QuIElmIHRoaXJkIGFyZ3VtZW50IChjYWxsYmFjaylcblx0aXMgbm90IHNwZWNpZmllZCByZW1vdmUgYWxsIGV2ZW50cyB3aXRoIHRoZSBzcGVjaWZpZWQgbmFtZS5cblx0XG5cdEBtZXRob2QgcmVtb3ZlRXZlbnRcblx0QHN0YXRpY1xuXHRAcGFyYW0ge09iamVjdH0gb2JqIERPTSBlbGVtZW50IHRvIHJlbW92ZSBldmVudCBsaXN0ZW5lcihzKSBmcm9tLlxuXHRAcGFyYW0ge1N0cmluZ30gbmFtZSBOYW1lIG9mIGV2ZW50IGxpc3RlbmVyIHRvIHJlbW92ZS5cblx0QHBhcmFtIHtGdW5jdGlvbnxTdHJpbmd9IFtjYWxsYmFja10gbWlnaHQgYmUgYSBjYWxsYmFjayBvciB1bmlxdWUga2V5IHRvIG1hdGNoLlxuXHQqL1xuXHR2YXIgcmVtb3ZlRXZlbnQgPSBmdW5jdGlvbihvYmosIG5hbWUsIGNhbGxiYWNrKSB7XG5cdFx0dmFyIHR5cGUsIHVuZGVmO1xuXHRcdFxuXHRcdG5hbWUgPSBuYW1lLnRvTG93ZXJDYXNlKCk7XG5cdFx0XG5cdFx0aWYgKG9ialt1aWRdICYmIGV2ZW50aGFzaFtvYmpbdWlkXV0gJiYgZXZlbnRoYXNoW29ialt1aWRdXVtuYW1lXSkge1xuXHRcdFx0dHlwZSA9IGV2ZW50aGFzaFtvYmpbdWlkXV1bbmFtZV07XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0XHRcblx0XHRmb3IgKHZhciBpID0gdHlwZS5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuXHRcdFx0Ly8gdW5kZWZpbmVkIG9yIG5vdCwga2V5IHNob3VsZCBtYXRjaFxuXHRcdFx0aWYgKHR5cGVbaV0ub3JpZyA9PT0gY2FsbGJhY2sgfHwgdHlwZVtpXS5rZXkgPT09IGNhbGxiYWNrKSB7XG5cdFx0XHRcdGlmIChvYmoucmVtb3ZlRXZlbnRMaXN0ZW5lcikge1xuXHRcdFx0XHRcdG9iai5yZW1vdmVFdmVudExpc3RlbmVyKG5hbWUsIHR5cGVbaV0uZnVuYywgZmFsc2UpO1xuXHRcdFx0XHR9IGVsc2UgaWYgKG9iai5kZXRhY2hFdmVudCkge1xuXHRcdFx0XHRcdG9iai5kZXRhY2hFdmVudCgnb24nK25hbWUsIHR5cGVbaV0uZnVuYyk7XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdHR5cGVbaV0ub3JpZyA9IG51bGw7XG5cdFx0XHRcdHR5cGVbaV0uZnVuYyA9IG51bGw7XG5cdFx0XHRcdHR5cGUuc3BsaWNlKGksIDEpO1xuXHRcdFx0XHRcblx0XHRcdFx0Ly8gSWYgY2FsbGJhY2sgd2FzIHBhc3NlZCB3ZSBhcmUgZG9uZSBoZXJlLCBvdGhlcndpc2UgcHJvY2VlZFxuXHRcdFx0XHRpZiAoY2FsbGJhY2sgIT09IHVuZGVmKSB7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0Ly8gSWYgZXZlbnQgYXJyYXkgZ290IGVtcHR5LCByZW1vdmUgaXRcblx0XHRpZiAoIXR5cGUubGVuZ3RoKSB7XG5cdFx0XHRkZWxldGUgZXZlbnRoYXNoW29ialt1aWRdXVtuYW1lXTtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gSWYgbU94aWUgcmVnaXN0cnkgaGFzIGJlY29tZSBlbXB0eSwgcmVtb3ZlIGl0XG5cdFx0aWYgKEJhc2ljLmlzRW1wdHlPYmooZXZlbnRoYXNoW29ialt1aWRdXSkpIHtcblx0XHRcdGRlbGV0ZSBldmVudGhhc2hbb2JqW3VpZF1dO1xuXHRcdFx0XG5cdFx0XHQvLyBJRSBkb2Vzbid0IGxldCB5b3UgcmVtb3ZlIERPTSBvYmplY3QgcHJvcGVydHkgd2l0aCAtIGRlbGV0ZVxuXHRcdFx0dHJ5IHtcblx0XHRcdFx0ZGVsZXRlIG9ialt1aWRdO1xuXHRcdFx0fSBjYXRjaChlKSB7XG5cdFx0XHRcdG9ialt1aWRdID0gdW5kZWY7XG5cdFx0XHR9XG5cdFx0fVxuXHR9O1xuXHRcblx0XG5cdC8qKlxuXHRSZW1vdmUgYWxsIGtpbmQgb2YgZXZlbnRzIGZyb20gdGhlIHNwZWNpZmllZCBvYmplY3Rcblx0XG5cdEBtZXRob2QgcmVtb3ZlQWxsRXZlbnRzXG5cdEBzdGF0aWNcblx0QHBhcmFtIHtPYmplY3R9IG9iaiBET00gZWxlbWVudCB0byByZW1vdmUgZXZlbnQgbGlzdGVuZXJzIGZyb20uXG5cdEBwYXJhbSB7U3RyaW5nfSBba2V5XSB1bmlxdWUga2V5IHRvIG1hdGNoLCB3aGVuIHJlbW92aW5nIGV2ZW50cy5cblx0Ki9cblx0dmFyIHJlbW92ZUFsbEV2ZW50cyA9IGZ1bmN0aW9uKG9iaiwga2V5KSB7XHRcdFxuXHRcdGlmICghb2JqIHx8ICFvYmpbdWlkXSkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRcblx0XHRCYXNpYy5lYWNoKGV2ZW50aGFzaFtvYmpbdWlkXV0sIGZ1bmN0aW9uKGV2ZW50cywgbmFtZSkge1xuXHRcdFx0cmVtb3ZlRXZlbnQob2JqLCBuYW1lLCBrZXkpO1xuXHRcdH0pO1xuXHR9O1xuXG5cdHJldHVybiB7XG5cdFx0YWRkRXZlbnQ6IGFkZEV2ZW50LFxuXHRcdHJlbW92ZUV2ZW50OiByZW1vdmVFdmVudCxcblx0XHRyZW1vdmVBbGxFdmVudHM6IHJlbW92ZUFsbEV2ZW50c1xuXHR9O1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L3J1bnRpbWUvaHRtbDUvZmlsZS9GaWxlSW5wdXQuanNcblxuLyoqXG4gKiBGaWxlSW5wdXQuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuLyoqXG5AY2xhc3MgbW94aWUvcnVudGltZS9odG1sNS9maWxlL0ZpbGVJbnB1dFxuQHByaXZhdGVcbiovXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL2h0bWw1L2ZpbGUvRmlsZUlucHV0XCIsIFtcblx0XCJtb3hpZS9ydW50aW1lL2h0bWw1L1J1bnRpbWVcIixcblx0XCJtb3hpZS9maWxlL0ZpbGVcIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCIsXG5cdFwibW94aWUvY29yZS91dGlscy9Eb21cIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0V2ZW50c1wiLFxuXHRcIm1veGllL2NvcmUvdXRpbHMvTWltZVwiLFxuXHRcIm1veGllL2NvcmUvdXRpbHMvRW52XCJcbl0sIGZ1bmN0aW9uKGV4dGVuc2lvbnMsIEZpbGUsIEJhc2ljLCBEb20sIEV2ZW50cywgTWltZSwgRW52KSB7XG5cdFxuXHRmdW5jdGlvbiBGaWxlSW5wdXQoKSB7XG5cdFx0dmFyIF9vcHRpb25zLCBfYnJvd3NlQnRuWkluZGV4OyAvLyBzYXZlIG9yaWdpbmFsIHotaW5kZXhcblxuXHRcdEJhc2ljLmV4dGVuZCh0aGlzLCB7XG5cdFx0XHRpbml0OiBmdW5jdGlvbihvcHRpb25zKSB7XG5cdFx0XHRcdHZhciBjb21wID0gdGhpcywgSSA9IGNvbXAuZ2V0UnVudGltZSgpLCBpbnB1dCwgc2hpbUNvbnRhaW5lciwgbWltZXMsIGJyb3dzZUJ1dHRvbiwgekluZGV4LCB0b3A7XG5cblx0XHRcdFx0X29wdGlvbnMgPSBvcHRpb25zO1xuXG5cdFx0XHRcdC8vIGZpZ3VyZSBvdXQgYWNjZXB0IHN0cmluZ1xuXHRcdFx0XHRtaW1lcyA9IE1pbWUuZXh0TGlzdDJtaW1lcyhfb3B0aW9ucy5hY2NlcHQsIEkuY2FuKCdmaWx0ZXJfYnlfZXh0ZW5zaW9uJykpO1xuXG5cdFx0XHRcdHNoaW1Db250YWluZXIgPSBJLmdldFNoaW1Db250YWluZXIoKTtcblxuXHRcdFx0XHRzaGltQ29udGFpbmVyLmlubmVySFRNTCA9ICc8aW5wdXQgaWQ9XCInICsgSS51aWQgKydcIiB0eXBlPVwiZmlsZVwiIHN0eWxlPVwiZm9udC1zaXplOjk5OXB4O29wYWNpdHk6MDtcIicgK1xuXHRcdFx0XHRcdChfb3B0aW9ucy5tdWx0aXBsZSAmJiBJLmNhbignc2VsZWN0X211bHRpcGxlJykgPyAnbXVsdGlwbGUnIDogJycpICsgXG5cdFx0XHRcdFx0KF9vcHRpb25zLmRpcmVjdG9yeSAmJiBJLmNhbignc2VsZWN0X2ZvbGRlcicpID8gJ3dlYmtpdGRpcmVjdG9yeSBkaXJlY3RvcnknIDogJycpICsgLy8gQ2hyb21lIDExK1xuXHRcdFx0XHRcdChtaW1lcyA/ICcgYWNjZXB0PVwiJyArIG1pbWVzLmpvaW4oJywnKSArICdcIicgOiAnJykgKyAnIC8+JztcblxuXHRcdFx0XHRpbnB1dCA9IERvbS5nZXQoSS51aWQpO1xuXG5cdFx0XHRcdC8vIHByZXBhcmUgZmlsZSBpbnB1dCB0byBiZSBwbGFjZWQgdW5kZXJuZWF0aCB0aGUgYnJvd3NlX2J1dHRvbiBlbGVtZW50XG5cdFx0XHRcdEJhc2ljLmV4dGVuZChpbnB1dC5zdHlsZSwge1xuXHRcdFx0XHRcdHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuXHRcdFx0XHRcdHRvcDogMCxcblx0XHRcdFx0XHRsZWZ0OiAwLFxuXHRcdFx0XHRcdHdpZHRoOiAnMTAwJScsXG5cdFx0XHRcdFx0aGVpZ2h0OiAnMTAwJSdcblx0XHRcdFx0fSk7XG5cblxuXHRcdFx0XHRicm93c2VCdXR0b24gPSBEb20uZ2V0KF9vcHRpb25zLmJyb3dzZV9idXR0b24pO1xuXHRcdFx0XHRfYnJvd3NlQnRuWkluZGV4ID0gRG9tLmdldFN0eWxlKGJyb3dzZUJ1dHRvbiwgJ3otaW5kZXgnKSB8fCAnYXV0byc7XG5cblx0XHRcdFx0Ly8gUm91dGUgY2xpY2sgZXZlbnQgdG8gdGhlIGlucHV0W3R5cGU9ZmlsZV0gZWxlbWVudCBmb3IgYnJvd3NlcnMgdGhhdCBzdXBwb3J0IHN1Y2ggYmVoYXZpb3Jcblx0XHRcdFx0aWYgKEkuY2FuKCdzdW1tb25fZmlsZV9kaWFsb2cnKSkge1xuXHRcdFx0XHRcdGlmIChEb20uZ2V0U3R5bGUoYnJvd3NlQnV0dG9uLCAncG9zaXRpb24nKSA9PT0gJ3N0YXRpYycpIHtcblx0XHRcdFx0XHRcdGJyb3dzZUJ1dHRvbi5zdHlsZS5wb3NpdGlvbiA9ICdyZWxhdGl2ZSc7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0RXZlbnRzLmFkZEV2ZW50KGJyb3dzZUJ1dHRvbiwgJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuXHRcdFx0XHRcdFx0dmFyIGlucHV0ID0gRG9tLmdldChJLnVpZCk7XG5cdFx0XHRcdFx0XHRpZiAoaW5wdXQgJiYgIWlucHV0LmRpc2FibGVkKSB7IC8vIGZvciBzb21lIHJlYXNvbiBGRiAodXAgdG8gOC4wLjEgc28gZmFyKSBsZXRzIHRvIGNsaWNrIGRpc2FibGVkIGlucHV0W3R5cGU9ZmlsZV1cblx0XHRcdFx0XHRcdFx0aW5wdXQuY2xpY2soKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0XHR9LCBjb21wLnVpZCk7XG5cblx0XHRcdFx0XHRjb21wLmJpbmQoJ1JlZnJlc2gnLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdHpJbmRleCA9IHBhcnNlSW50KF9icm93c2VCdG5aSW5kZXgsIDEwKSB8fCAxO1xuXG5cdFx0XHRcdFx0XHREb20uZ2V0KF9vcHRpb25zLmJyb3dzZV9idXR0b24pLnN0eWxlLnpJbmRleCA9IHpJbmRleDtcblx0XHRcdFx0XHRcdHRoaXMuZ2V0UnVudGltZSgpLmdldFNoaW1Db250YWluZXIoKS5zdHlsZS56SW5kZXggPSB6SW5kZXggLSAxO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0LyogU2luY2Ugd2UgaGF2ZSB0byBwbGFjZSBpbnB1dFt0eXBlPWZpbGVdIG9uIHRvcCBvZiB0aGUgYnJvd3NlX2J1dHRvbiBmb3Igc29tZSBicm93c2Vycyxcblx0XHRcdFx0YnJvd3NlX2J1dHRvbiBsb3NlcyBpbnRlcmFjdGl2aXR5LCBzbyB3ZSByZXN0b3JlIGl0IGhlcmUgKi9cblx0XHRcdFx0dG9wID0gSS5jYW4oJ3N1bW1vbl9maWxlX2RpYWxvZycpID8gYnJvd3NlQnV0dG9uIDogc2hpbUNvbnRhaW5lcjtcblxuXHRcdFx0XHRFdmVudHMuYWRkRXZlbnQodG9wLCAnbW91c2VvdmVyJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0Y29tcC50cmlnZ2VyKCdtb3VzZWVudGVyJyk7XG5cdFx0XHRcdH0sIGNvbXAudWlkKTtcblxuXHRcdFx0XHRFdmVudHMuYWRkRXZlbnQodG9wLCAnbW91c2VvdXQnLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRjb21wLnRyaWdnZXIoJ21vdXNlbGVhdmUnKTtcblx0XHRcdFx0fSwgY29tcC51aWQpO1xuXG5cdFx0XHRcdEV2ZW50cy5hZGRFdmVudCh0b3AsICdtb3VzZWRvd24nLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRjb21wLnRyaWdnZXIoJ21vdXNlZG93bicpO1xuXHRcdFx0XHR9LCBjb21wLnVpZCk7XG5cblx0XHRcdFx0RXZlbnRzLmFkZEV2ZW50KERvbS5nZXQoX29wdGlvbnMuY29udGFpbmVyKSwgJ21vdXNldXAnLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRjb21wLnRyaWdnZXIoJ21vdXNldXAnKTtcblx0XHRcdFx0fSwgY29tcC51aWQpO1xuXG5cdFx0XHRcdC8vIGl0IHNob3VsZG4ndCBiZSBwb3NzaWJsZSB0byB0YWIgaW50byB0aGUgaGlkZGVuIGVsZW1lbnRcblx0XHRcdFx0KEkuY2FuKCdzdW1tb25fZmlsZV9kaWFsb2cnKSA/IGlucHV0IDogYnJvd3NlQnV0dG9uKS5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgLTEpO1xuXG5cdFx0XHRcdGlucHV0Lm9uY2hhbmdlID0gZnVuY3Rpb24gb25DaGFuZ2UoKSB7IC8vIHRoZXJlIHNob3VsZCBiZSBvbmx5IG9uZSBoYW5kbGVyIGZvciB0aGlzXG5cdFx0XHRcdFx0Y29tcC5maWxlcyA9IFtdO1xuXG5cdFx0XHRcdFx0QmFzaWMuZWFjaCh0aGlzLmZpbGVzLCBmdW5jdGlvbihmaWxlKSB7XG5cdFx0XHRcdFx0XHR2YXIgcmVsYXRpdmVQYXRoID0gJyc7XG5cblx0XHRcdFx0XHRcdGlmIChfb3B0aW9ucy5kaXJlY3RvcnkpIHtcblx0XHRcdFx0XHRcdFx0Ly8gZm9sZGVycyBhcmUgcmVwcmVzZW50ZWQgYnkgZG90cywgZmlsdGVyIHRoZW0gb3V0IChDaHJvbWUgMTErKVxuXHRcdFx0XHRcdFx0XHRpZiAoZmlsZS5uYW1lID09IFwiLlwiKSB7XG5cdFx0XHRcdFx0XHRcdFx0Ly8gaWYgaXQgbG9va3MgbGlrZSBhIGZvbGRlci4uLlxuXHRcdFx0XHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdGlmIChmaWxlLndlYmtpdFJlbGF0aXZlUGF0aCkge1xuXHRcdFx0XHRcdFx0XHRyZWxhdGl2ZVBhdGggPSAnLycgKyBmaWxlLndlYmtpdFJlbGF0aXZlUGF0aC5yZXBsYWNlKC9eXFwvLywgJycpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRmaWxlID0gbmV3IEZpbGUoSS51aWQsIGZpbGUpO1xuXHRcdFx0XHRcdFx0ZmlsZS5yZWxhdGl2ZVBhdGggPSByZWxhdGl2ZVBhdGg7XG5cblx0XHRcdFx0XHRcdGNvbXAuZmlsZXMucHVzaChmaWxlKTtcblx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHRcdC8vIGNsZWFyaW5nIHRoZSB2YWx1ZSBlbmFibGVzIHRoZSB1c2VyIHRvIHNlbGVjdCB0aGUgc2FtZSBmaWxlIGFnYWluIGlmIHRoZXkgd2FudCB0b1xuXHRcdFx0XHRcdGlmIChFbnYuYnJvd3NlciAhPT0gJ0lFJyAmJiBFbnYuYnJvd3NlciAhPT0gJ0lFTW9iaWxlJykge1xuXHRcdFx0XHRcdFx0dGhpcy52YWx1ZSA9ICcnO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHQvLyBpbiBJRSBpbnB1dFt0eXBlPVwiZmlsZVwiXSBpcyByZWFkLW9ubHkgc28gdGhlIG9ubHkgd2F5IHRvIHJlc2V0IGl0IGlzIHRvIHJlLWluc2VydCBpdFxuXHRcdFx0XHRcdFx0dmFyIGNsb25lID0gdGhpcy5jbG9uZU5vZGUodHJ1ZSk7XG5cdFx0XHRcdFx0XHR0aGlzLnBhcmVudE5vZGUucmVwbGFjZUNoaWxkKGNsb25lLCB0aGlzKTtcblx0XHRcdFx0XHRcdGNsb25lLm9uY2hhbmdlID0gb25DaGFuZ2U7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKGNvbXAuZmlsZXMubGVuZ3RoKSB7XG5cdFx0XHRcdFx0XHRjb21wLnRyaWdnZXIoJ2NoYW5nZScpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvLyByZWFkeSBldmVudCBpcyBwZXJmZWN0bHkgYXN5bmNocm9ub3VzXG5cdFx0XHRcdGNvbXAudHJpZ2dlcih7XG5cdFx0XHRcdFx0dHlwZTogJ3JlYWR5Jyxcblx0XHRcdFx0XHRhc3luYzogdHJ1ZVxuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHRzaGltQ29udGFpbmVyID0gbnVsbDtcblx0XHRcdH0sXG5cblxuXHRcdFx0c2V0T3B0aW9uOiBmdW5jdGlvbihuYW1lLCB2YWx1ZSkge1xuXHRcdFx0XHR2YXIgSSA9IHRoaXMuZ2V0UnVudGltZSgpO1xuXHRcdFx0XHR2YXIgaW5wdXQgPSBEb20uZ2V0KEkudWlkKTtcblxuXHRcdFx0XHRzd2l0Y2ggKG5hbWUpIHtcblx0XHRcdFx0XHRjYXNlICdhY2NlcHQnOlxuXHRcdFx0XHRcdFx0aWYgKHZhbHVlKSB7XG5cdFx0XHRcdFx0XHRcdHZhciBtaW1lcyA9IHZhbHVlLm1pbWVzIHx8IE1pbWUuZXh0TGlzdDJtaW1lcyh2YWx1ZSwgSS5jYW4oJ2ZpbHRlcl9ieV9leHRlbnNpb24nKSk7XG5cdFx0XHRcdFx0XHRcdGlucHV0LnNldEF0dHJpYnV0ZSgnYWNjZXB0JywgbWltZXMuam9pbignLCcpKTtcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdGlucHV0LnJlbW92ZUF0dHJpYnV0ZSgnYWNjZXB0Jyk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRcdGNhc2UgJ2RpcmVjdG9yeSc6XG5cdFx0XHRcdFx0XHRpZiAodmFsdWUgJiYgSS5jYW4oJ3NlbGVjdF9mb2xkZXInKSkge1xuXHRcdFx0XHRcdFx0XHRpbnB1dC5zZXRBdHRyaWJ1dGUoJ2RpcmVjdG9yeScsICcnKTtcblx0XHRcdFx0XHRcdFx0aW5wdXQuc2V0QXR0cmlidXRlKCd3ZWJraXRkaXJlY3RvcnknLCAnJyk7XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRpbnB1dC5yZW1vdmVBdHRyaWJ1dGUoJ2RpcmVjdG9yeScpO1xuXHRcdFx0XHRcdFx0XHRpbnB1dC5yZW1vdmVBdHRyaWJ1dGUoJ3dlYmtpdGRpcmVjdG9yeScpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0XHRjYXNlICdtdWx0aXBsZSc6XG5cdFx0XHRcdFx0XHRpZiAodmFsdWUgJiYgSS5jYW4oJ3NlbGVjdF9tdWx0aXBsZScpKSB7XG5cdFx0XHRcdFx0XHRcdGlucHV0LnNldEF0dHJpYnV0ZSgnbXVsdGlwbGUnLCAnJyk7XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRpbnB1dC5yZW1vdmVBdHRyaWJ1dGUoJ211bHRpcGxlJyk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0fVxuXHRcdFx0fSxcblxuXG5cdFx0XHRkaXNhYmxlOiBmdW5jdGlvbihzdGF0ZSkge1xuXHRcdFx0XHR2YXIgSSA9IHRoaXMuZ2V0UnVudGltZSgpLCBpbnB1dDtcblxuXHRcdFx0XHRpZiAoKGlucHV0ID0gRG9tLmdldChJLnVpZCkpKSB7XG5cdFx0XHRcdFx0aW5wdXQuZGlzYWJsZWQgPSAhIXN0YXRlO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXG5cdFx0XHRkZXN0cm95OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIEkgPSB0aGlzLmdldFJ1bnRpbWUoKVxuXHRcdFx0XHQsIHNoaW0gPSBJLmdldFNoaW0oKVxuXHRcdFx0XHQsIHNoaW1Db250YWluZXIgPSBJLmdldFNoaW1Db250YWluZXIoKVxuXHRcdFx0XHQsIGNvbnRhaW5lciA9IF9vcHRpb25zICYmIERvbS5nZXQoX29wdGlvbnMuY29udGFpbmVyKVxuXHRcdFx0XHQsIGJyb3dzZUJ1dHRvbiA9IF9vcHRpb25zICYmIERvbS5nZXQoX29wdGlvbnMuYnJvd3NlX2J1dHRvbilcblx0XHRcdFx0O1xuXHRcdFx0XHRcblx0XHRcdFx0aWYgKGNvbnRhaW5lcikge1xuXHRcdFx0XHRcdEV2ZW50cy5yZW1vdmVBbGxFdmVudHMoY29udGFpbmVyLCB0aGlzLnVpZCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdGlmIChicm93c2VCdXR0b24pIHtcblx0XHRcdFx0XHRFdmVudHMucmVtb3ZlQWxsRXZlbnRzKGJyb3dzZUJ1dHRvbiwgdGhpcy51aWQpO1xuXHRcdFx0XHRcdGJyb3dzZUJ1dHRvbi5zdHlsZS56SW5kZXggPSBfYnJvd3NlQnRuWkluZGV4OyAvLyByZXNldCB0byBvcmlnaW5hbCB2YWx1ZVxuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHRpZiAoc2hpbUNvbnRhaW5lcikge1xuXHRcdFx0XHRcdEV2ZW50cy5yZW1vdmVBbGxFdmVudHMoc2hpbUNvbnRhaW5lciwgdGhpcy51aWQpO1xuXHRcdFx0XHRcdHNoaW1Db250YWluZXIuaW5uZXJIVE1MID0gJyc7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRzaGltLnJlbW92ZUluc3RhbmNlKHRoaXMudWlkKTtcblxuXHRcdFx0XHRfb3B0aW9ucyA9IHNoaW1Db250YWluZXIgPSBjb250YWluZXIgPSBicm93c2VCdXR0b24gPSBzaGltID0gbnVsbDtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdHJldHVybiAoZXh0ZW5zaW9ucy5GaWxlSW5wdXQgPSBGaWxlSW5wdXQpO1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L3J1bnRpbWUvaHRtbDUvZmlsZS9GaWxlRHJvcC5qc1xuXG4vKipcbiAqIEZpbGVEcm9wLmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG5cbi8qKlxuQGNsYXNzIG1veGllL3J1bnRpbWUvaHRtbDUvZmlsZS9GaWxlRHJvcFxuQHByaXZhdGVcbiovXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL2h0bWw1L2ZpbGUvRmlsZURyb3BcIiwgW1xuXHRcIm1veGllL3J1bnRpbWUvaHRtbDUvUnVudGltZVwiLFxuXHQnbW94aWUvZmlsZS9GaWxlJyxcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCIsXG5cdFwibW94aWUvY29yZS91dGlscy9Eb21cIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0V2ZW50c1wiLFxuXHRcIm1veGllL2NvcmUvdXRpbHMvTWltZVwiXG5dLCBmdW5jdGlvbihleHRlbnNpb25zLCBGaWxlLCBCYXNpYywgRG9tLCBFdmVudHMsIE1pbWUpIHtcblx0XG5cdGZ1bmN0aW9uIEZpbGVEcm9wKCkge1xuXHRcdHZhciBfZmlsZXMgPSBbXSwgX2FsbG93ZWRFeHRzID0gW10sIF9vcHRpb25zLCBfcnVpZDtcblxuXHRcdEJhc2ljLmV4dGVuZCh0aGlzLCB7XG5cdFx0XHRpbml0OiBmdW5jdGlvbihvcHRpb25zKSB7XG5cdFx0XHRcdHZhciBjb21wID0gdGhpcywgZHJvcFpvbmU7XG5cblx0XHRcdFx0X29wdGlvbnMgPSBvcHRpb25zO1xuXHRcdFx0XHRfcnVpZCA9IGNvbXAucnVpZDsgLy8gZXZlcnkgZHJvcHBlZC1pbiBmaWxlIHNob3VsZCBoYXZlIGEgcmVmZXJlbmNlIHRvIHRoZSBydW50aW1lXG5cdFx0XHRcdF9hbGxvd2VkRXh0cyA9IF9leHRyYWN0RXh0cyhfb3B0aW9ucy5hY2NlcHQpO1xuXHRcdFx0XHRkcm9wWm9uZSA9IF9vcHRpb25zLmNvbnRhaW5lcjtcblxuXHRcdFx0XHRFdmVudHMuYWRkRXZlbnQoZHJvcFpvbmUsICdkcmFnb3ZlcicsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0XHRpZiAoIV9oYXNGaWxlcyhlKSkge1xuXHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdFx0ZS5kYXRhVHJhbnNmZXIuZHJvcEVmZmVjdCA9ICdjb3B5Jztcblx0XHRcdFx0fSwgY29tcC51aWQpO1xuXG5cdFx0XHRcdEV2ZW50cy5hZGRFdmVudChkcm9wWm9uZSwgJ2Ryb3AnLCBmdW5jdGlvbihlKSB7XG5cdFx0XHRcdFx0aWYgKCFfaGFzRmlsZXMoZSkpIHtcblx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0XHRcdFx0X2ZpbGVzID0gW107XG5cblx0XHRcdFx0XHQvLyBDaHJvbWUgMjErIGFjY2VwdHMgZm9sZGVycyB2aWEgRHJhZyduJ0Ryb3Bcblx0XHRcdFx0XHRpZiAoZS5kYXRhVHJhbnNmZXIuaXRlbXMgJiYgZS5kYXRhVHJhbnNmZXIuaXRlbXNbMF0ud2Via2l0R2V0QXNFbnRyeSkge1xuXHRcdFx0XHRcdFx0X3JlYWRJdGVtcyhlLmRhdGFUcmFuc2Zlci5pdGVtcywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRcdGNvbXAuZmlsZXMgPSBfZmlsZXM7XG5cdFx0XHRcdFx0XHRcdGNvbXAudHJpZ2dlcihcImRyb3BcIik7XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0QmFzaWMuZWFjaChlLmRhdGFUcmFuc2Zlci5maWxlcywgZnVuY3Rpb24oZmlsZSkge1xuXHRcdFx0XHRcdFx0XHRfYWRkRmlsZShmaWxlKTtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0Y29tcC5maWxlcyA9IF9maWxlcztcblx0XHRcdFx0XHRcdGNvbXAudHJpZ2dlcihcImRyb3BcIik7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9LCBjb21wLnVpZCk7XG5cblx0XHRcdFx0RXZlbnRzLmFkZEV2ZW50KGRyb3Bab25lLCAnZHJhZ2VudGVyJywgZnVuY3Rpb24oZSkge1xuXHRcdFx0XHRcdGNvbXAudHJpZ2dlcihcImRyYWdlbnRlclwiKTtcblx0XHRcdFx0fSwgY29tcC51aWQpO1xuXG5cdFx0XHRcdEV2ZW50cy5hZGRFdmVudChkcm9wWm9uZSwgJ2RyYWdsZWF2ZScsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0XHRjb21wLnRyaWdnZXIoXCJkcmFnbGVhdmVcIik7XG5cdFx0XHRcdH0sIGNvbXAudWlkKTtcblx0XHRcdH0sXG5cblx0XHRcdGRlc3Ryb3k6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRFdmVudHMucmVtb3ZlQWxsRXZlbnRzKF9vcHRpb25zICYmIERvbS5nZXQoX29wdGlvbnMuY29udGFpbmVyKSwgdGhpcy51aWQpO1xuXHRcdFx0XHRfcnVpZCA9IF9maWxlcyA9IF9hbGxvd2VkRXh0cyA9IF9vcHRpb25zID0gbnVsbDtcblx0XHRcdFx0dGhpcy5nZXRSdW50aW1lKCkuZ2V0U2hpbSgpLnJlbW92ZUluc3RhbmNlKHRoaXMudWlkKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXG5cdFx0ZnVuY3Rpb24gX2hhc0ZpbGVzKGUpIHtcblx0XHRcdGlmICghZS5kYXRhVHJhbnNmZXIgfHwgIWUuZGF0YVRyYW5zZmVyLnR5cGVzKSB7IC8vIGUuZGF0YVRyYW5zZmVyLmZpbGVzIGlzIG5vdCBhdmFpbGFibGUgaW4gR2Vja28gZHVyaW5nIGRyYWdvdmVyXG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH1cblxuXHRcdFx0dmFyIHR5cGVzID0gQmFzaWMudG9BcnJheShlLmRhdGFUcmFuc2Zlci50eXBlcyB8fCBbXSk7XG5cblx0XHRcdHJldHVybiBCYXNpYy5pbkFycmF5KFwiRmlsZXNcIiwgdHlwZXMpICE9PSAtMSB8fFxuXHRcdFx0XHRCYXNpYy5pbkFycmF5KFwicHVibGljLmZpbGUtdXJsXCIsIHR5cGVzKSAhPT0gLTEgfHwgLy8gU2FmYXJpIDwgNVxuXHRcdFx0XHRCYXNpYy5pbkFycmF5KFwiYXBwbGljYXRpb24veC1tb3otZmlsZVwiLCB0eXBlcykgIT09IC0xIC8vIEdlY2tvIDwgMS45LjIgKDwgRmlyZWZveCAzLjYpXG5cdFx0XHRcdDtcblx0XHR9XG5cblxuXHRcdGZ1bmN0aW9uIF9hZGRGaWxlKGZpbGUsIHJlbGF0aXZlUGF0aCkge1xuXHRcdFx0aWYgKF9pc0FjY2VwdGFibGUoZmlsZSkpIHtcblx0XHRcdFx0dmFyIGZpbGVPYmogPSBuZXcgRmlsZShfcnVpZCwgZmlsZSk7XG5cdFx0XHRcdGZpbGVPYmoucmVsYXRpdmVQYXRoID0gcmVsYXRpdmVQYXRoIHx8ICcnO1xuXHRcdFx0XHRfZmlsZXMucHVzaChmaWxlT2JqKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRcblx0XHRmdW5jdGlvbiBfZXh0cmFjdEV4dHMoYWNjZXB0KSB7XG5cdFx0XHR2YXIgZXh0cyA9IFtdO1xuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBhY2NlcHQubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0W10ucHVzaC5hcHBseShleHRzLCBhY2NlcHRbaV0uZXh0ZW5zaW9ucy5zcGxpdCgvXFxzKixcXHMqLykpO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIEJhc2ljLmluQXJyYXkoJyonLCBleHRzKSA9PT0gLTEgPyBleHRzIDogW107XG5cdFx0fVxuXG5cblx0XHRmdW5jdGlvbiBfaXNBY2NlcHRhYmxlKGZpbGUpIHtcblx0XHRcdGlmICghX2FsbG93ZWRFeHRzLmxlbmd0aCkge1xuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdH1cblx0XHRcdHZhciBleHQgPSBNaW1lLmdldEZpbGVFeHRlbnNpb24oZmlsZS5uYW1lKTtcblx0XHRcdHJldHVybiAhZXh0IHx8IEJhc2ljLmluQXJyYXkoZXh0LCBfYWxsb3dlZEV4dHMpICE9PSAtMTtcblx0XHR9XG5cblxuXHRcdGZ1bmN0aW9uIF9yZWFkSXRlbXMoaXRlbXMsIGNiKSB7XG5cdFx0XHR2YXIgZW50cmllcyA9IFtdO1xuXHRcdFx0QmFzaWMuZWFjaChpdGVtcywgZnVuY3Rpb24oaXRlbSkge1xuXHRcdFx0XHR2YXIgZW50cnkgPSBpdGVtLndlYmtpdEdldEFzRW50cnkoKTtcblx0XHRcdFx0Ly8gQWRkcmVzcyAjOTk4IChodHRwczovL2NvZGUuZ29vZ2xlLmNvbS9wL2Nocm9taXVtL2lzc3Vlcy9kZXRhaWw/aWQ9MzMyNTc5KVxuXHRcdFx0XHRpZiAoZW50cnkpIHtcblx0XHRcdFx0XHQvLyBmaWxlKCkgZmFpbHMgb24gT1NYIHdoZW4gdGhlIGZpbGVuYW1lIGNvbnRhaW5zIGEgc3BlY2lhbCBjaGFyYWN0ZXIgKGUuZy4gdW1sYXV0KTogc2VlICM2MVxuXHRcdFx0XHRcdGlmIChlbnRyeS5pc0ZpbGUpIHtcblx0XHRcdFx0XHRcdF9hZGRGaWxlKGl0ZW0uZ2V0QXNGaWxlKCksIGVudHJ5LmZ1bGxQYXRoKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0ZW50cmllcy5wdXNoKGVudHJ5KTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHRpZiAoZW50cmllcy5sZW5ndGgpIHtcblx0XHRcdFx0X3JlYWRFbnRyaWVzKGVudHJpZXMsIGNiKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNiKCk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cblx0XHRmdW5jdGlvbiBfcmVhZEVudHJpZXMoZW50cmllcywgY2IpIHtcblx0XHRcdHZhciBxdWV1ZSA9IFtdO1xuXHRcdFx0QmFzaWMuZWFjaChlbnRyaWVzLCBmdW5jdGlvbihlbnRyeSkge1xuXHRcdFx0XHRxdWV1ZS5wdXNoKGZ1bmN0aW9uKGNiY2IpIHtcblx0XHRcdFx0XHRfcmVhZEVudHJ5KGVudHJ5LCBjYmNiKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblx0XHRcdEJhc2ljLmluU2VyaWVzKHF1ZXVlLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0Y2IoKTtcblx0XHRcdH0pO1xuXHRcdH1cblxuXG5cdFx0ZnVuY3Rpb24gX3JlYWRFbnRyeShlbnRyeSwgY2IpIHtcblx0XHRcdGlmIChlbnRyeS5pc0ZpbGUpIHtcblx0XHRcdFx0ZW50cnkuZmlsZShmdW5jdGlvbihmaWxlKSB7XG5cdFx0XHRcdFx0X2FkZEZpbGUoZmlsZSwgZW50cnkuZnVsbFBhdGgpO1xuXHRcdFx0XHRcdGNiKCk7XG5cdFx0XHRcdH0sIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdC8vIGZpcmUgYW4gZXJyb3IgZXZlbnQgbWF5YmVcblx0XHRcdFx0XHRjYigpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0gZWxzZSBpZiAoZW50cnkuaXNEaXJlY3RvcnkpIHtcblx0XHRcdFx0X3JlYWREaXJFbnRyeShlbnRyeSwgY2IpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y2IoKTsgLy8gbm90IGZpbGUsIG5vdCBkaXJlY3Rvcnk/IHdoYXQgdGhlbj8uLlxuXHRcdFx0fVxuXHRcdH1cblxuXG5cdFx0ZnVuY3Rpb24gX3JlYWREaXJFbnRyeShkaXJFbnRyeSwgY2IpIHtcblx0XHRcdHZhciBlbnRyaWVzID0gW10sIGRpclJlYWRlciA9IGRpckVudHJ5LmNyZWF0ZVJlYWRlcigpO1xuXG5cdFx0XHQvLyBrZWVwIHF1ZXJpbmcgcmVjdXJzaXZlbHkgdGlsbCBubyBtb3JlIGVudHJpZXNcblx0XHRcdGZ1bmN0aW9uIGdldEVudHJpZXMoY2JjYikge1xuXHRcdFx0XHRkaXJSZWFkZXIucmVhZEVudHJpZXMoZnVuY3Rpb24obW9yZUVudHJpZXMpIHtcblx0XHRcdFx0XHRpZiAobW9yZUVudHJpZXMubGVuZ3RoKSB7XG5cdFx0XHRcdFx0XHRbXS5wdXNoLmFwcGx5KGVudHJpZXMsIG1vcmVFbnRyaWVzKTtcblx0XHRcdFx0XHRcdGdldEVudHJpZXMoY2JjYik7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdGNiY2IoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0sIGNiY2IpO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyAuLi5hbmQgeW91IHRob3VnaHQgRmlsZVJlYWRlciB3YXMgY3JhenkuLi5cblx0XHRcdGdldEVudHJpZXMoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdF9yZWFkRW50cmllcyhlbnRyaWVzLCBjYik7XG5cdFx0XHR9KTsgXG5cdFx0fVxuXHR9XG5cblx0cmV0dXJuIChleHRlbnNpb25zLkZpbGVEcm9wID0gRmlsZURyb3ApO1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L3J1bnRpbWUvaHRtbDUvZmlsZS9GaWxlUmVhZGVyLmpzXG5cbi8qKlxuICogRmlsZVJlYWRlci5qc1xuICpcbiAqIENvcHlyaWdodCAyMDEzLCBNb3hpZWNvZGUgU3lzdGVtcyBBQlxuICogUmVsZWFzZWQgdW5kZXIgR1BMIExpY2Vuc2UuXG4gKlxuICogTGljZW5zZTogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vbGljZW5zZVxuICogQ29udHJpYnV0aW5nOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9jb250cmlidXRpbmdcbiAqL1xuXG4vKipcbkBjbGFzcyBtb3hpZS9ydW50aW1lL2h0bWw1L2ZpbGUvRmlsZVJlYWRlclxuQHByaXZhdGVcbiovXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL2h0bWw1L2ZpbGUvRmlsZVJlYWRlclwiLCBbXG5cdFwibW94aWUvcnVudGltZS9odG1sNS9SdW50aW1lXCIsXG5cdFwibW94aWUvY29yZS91dGlscy9FbmNvZGVcIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCJcbl0sIGZ1bmN0aW9uKGV4dGVuc2lvbnMsIEVuY29kZSwgQmFzaWMpIHtcblx0XG5cdGZ1bmN0aW9uIEZpbGVSZWFkZXIoKSB7XG5cdFx0dmFyIF9mciwgX2NvbnZlcnRUb0JpbmFyeSA9IGZhbHNlO1xuXG5cdFx0QmFzaWMuZXh0ZW5kKHRoaXMsIHtcblxuXHRcdFx0cmVhZDogZnVuY3Rpb24ob3AsIGJsb2IpIHtcblx0XHRcdFx0dmFyIGNvbXAgPSB0aGlzO1xuXG5cdFx0XHRcdGNvbXAucmVzdWx0ID0gJyc7XG5cblx0XHRcdFx0X2ZyID0gbmV3IHdpbmRvdy5GaWxlUmVhZGVyKCk7XG5cblx0XHRcdFx0X2ZyLmFkZEV2ZW50TGlzdGVuZXIoJ3Byb2dyZXNzJywgZnVuY3Rpb24oZSkge1xuXHRcdFx0XHRcdGNvbXAudHJpZ2dlcihlKTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0X2ZyLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBmdW5jdGlvbihlKSB7XG5cdFx0XHRcdFx0Y29tcC5yZXN1bHQgPSBfY29udmVydFRvQmluYXJ5ID8gX3RvQmluYXJ5KF9mci5yZXN1bHQpIDogX2ZyLnJlc3VsdDtcblx0XHRcdFx0XHRjb21wLnRyaWdnZXIoZSk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdF9mci5hZGRFdmVudExpc3RlbmVyKCdlcnJvcicsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0XHRjb21wLnRyaWdnZXIoZSwgX2ZyLmVycm9yKTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0X2ZyLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWRlbmQnLCBmdW5jdGlvbihlKSB7XG5cdFx0XHRcdFx0X2ZyID0gbnVsbDtcblx0XHRcdFx0XHRjb21wLnRyaWdnZXIoZSk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdGlmIChCYXNpYy50eXBlT2YoX2ZyW29wXSkgPT09ICdmdW5jdGlvbicpIHtcblx0XHRcdFx0XHRfY29udmVydFRvQmluYXJ5ID0gZmFsc2U7XG5cdFx0XHRcdFx0X2ZyW29wXShibG9iLmdldFNvdXJjZSgpKTtcblx0XHRcdFx0fSBlbHNlIGlmIChvcCA9PT0gJ3JlYWRBc0JpbmFyeVN0cmluZycpIHsgLy8gcmVhZEFzQmluYXJ5U3RyaW5nIGlzIGRlcHJpY2F0ZWQgaW4gZ2VuZXJhbCBhbmQgbmV2ZXIgZXhpc3RlZCBpbiBJRTEwK1xuXHRcdFx0XHRcdF9jb252ZXJ0VG9CaW5hcnkgPSB0cnVlO1xuXHRcdFx0XHRcdF9mci5yZWFkQXNEYXRhVVJMKGJsb2IuZ2V0U291cmNlKCkpO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXG5cdFx0XHRhYm9ydDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGlmIChfZnIpIHtcblx0XHRcdFx0XHRfZnIuYWJvcnQoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSxcblxuXHRcdFx0ZGVzdHJveTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdF9mciA9IG51bGw7XG5cdFx0XHRcdHRoaXMuZ2V0UnVudGltZSgpLmdldFNoaW0oKS5yZW1vdmVJbnN0YW5jZSh0aGlzLnVpZCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRmdW5jdGlvbiBfdG9CaW5hcnkoc3RyKSB7XG5cdFx0XHRyZXR1cm4gRW5jb2RlLmF0b2Ioc3RyLnN1YnN0cmluZyhzdHIuaW5kZXhPZignYmFzZTY0LCcpICsgNykpO1xuXHRcdH1cblx0fVxuXG5cdHJldHVybiAoZXh0ZW5zaW9ucy5GaWxlUmVhZGVyID0gRmlsZVJlYWRlcik7XG59KTtcblxuLy8gSW5jbHVkZWQgZnJvbTogc3JjL2phdmFzY3JpcHQvcnVudGltZS9odG1sNS94aHIvWE1MSHR0cFJlcXVlc3QuanNcblxuLyoqXG4gKiBYTUxIdHRwUmVxdWVzdC5qc1xuICpcbiAqIENvcHlyaWdodCAyMDEzLCBNb3hpZWNvZGUgU3lzdGVtcyBBQlxuICogUmVsZWFzZWQgdW5kZXIgR1BMIExpY2Vuc2UuXG4gKlxuICogTGljZW5zZTogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vbGljZW5zZVxuICogQ29udHJpYnV0aW5nOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9jb250cmlidXRpbmdcbiAqL1xuXG4vKmdsb2JhbCBBY3RpdmVYT2JqZWN0OnRydWUgKi9cblxuLyoqXG5AY2xhc3MgbW94aWUvcnVudGltZS9odG1sNS94aHIvWE1MSHR0cFJlcXVlc3RcbkBwcml2YXRlXG4qL1xuZGVmaW5lKFwibW94aWUvcnVudGltZS9odG1sNS94aHIvWE1MSHR0cFJlcXVlc3RcIiwgW1xuXHRcIm1veGllL3J1bnRpbWUvaHRtbDUvUnVudGltZVwiLFxuXHRcIm1veGllL2NvcmUvdXRpbHMvQmFzaWNcIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL01pbWVcIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL1VybFwiLFxuXHRcIm1veGllL2ZpbGUvRmlsZVwiLFxuXHRcIm1veGllL2ZpbGUvQmxvYlwiLFxuXHRcIm1veGllL3hoci9Gb3JtRGF0YVwiLFxuXHRcIm1veGllL2NvcmUvRXhjZXB0aW9uc1wiLFxuXHRcIm1veGllL2NvcmUvdXRpbHMvRW52XCJcbl0sIGZ1bmN0aW9uKGV4dGVuc2lvbnMsIEJhc2ljLCBNaW1lLCBVcmwsIEZpbGUsIEJsb2IsIEZvcm1EYXRhLCB4LCBFbnYpIHtcblx0XG5cdGZ1bmN0aW9uIFhNTEh0dHBSZXF1ZXN0KCkge1xuXHRcdHZhciBzZWxmID0gdGhpc1xuXHRcdCwgX3hoclxuXHRcdCwgX2ZpbGVuYW1lXG5cdFx0O1xuXG5cdFx0QmFzaWMuZXh0ZW5kKHRoaXMsIHtcblx0XHRcdHNlbmQ6IGZ1bmN0aW9uKG1ldGEsIGRhdGEpIHtcblx0XHRcdFx0dmFyIHRhcmdldCA9IHRoaXNcblx0XHRcdFx0LCBpc0dlY2tvMl81XzYgPSAoRW52LmJyb3dzZXIgPT09ICdNb3ppbGxhJyAmJiBFbnYudmVyQ29tcChFbnYudmVyc2lvbiwgNCwgJz49JykgJiYgRW52LnZlckNvbXAoRW52LnZlcnNpb24sIDcsICc8JykpXG5cdFx0XHRcdCwgaXNBbmRyb2lkQnJvd3NlciA9IEVudi5icm93c2VyID09PSAnQW5kcm9pZCBCcm93c2VyJ1xuXHRcdFx0XHQsIG11c3RTZW5kQXNCaW5hcnkgPSBmYWxzZVxuXHRcdFx0XHQ7XG5cblx0XHRcdFx0Ly8gZXh0cmFjdCBmaWxlIG5hbWVcblx0XHRcdFx0X2ZpbGVuYW1lID0gbWV0YS51cmwucmVwbGFjZSgvXi4rP1xcLyhbXFx3XFwtXFwuXSspJC8sICckMScpLnRvTG93ZXJDYXNlKCk7XG5cblx0XHRcdFx0X3hociA9IF9nZXROYXRpdmVYSFIoKTtcblx0XHRcdFx0X3hoci5vcGVuKG1ldGEubWV0aG9kLCBtZXRhLnVybCwgbWV0YS5hc3luYywgbWV0YS51c2VyLCBtZXRhLnBhc3N3b3JkKTtcblxuXG5cdFx0XHRcdC8vIHByZXBhcmUgZGF0YSB0byBiZSBzZW50XG5cdFx0XHRcdGlmIChkYXRhIGluc3RhbmNlb2YgQmxvYikge1xuXHRcdFx0XHRcdGlmIChkYXRhLmlzRGV0YWNoZWQoKSkge1xuXHRcdFx0XHRcdFx0bXVzdFNlbmRBc0JpbmFyeSA9IHRydWU7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGRhdGEgPSBkYXRhLmdldFNvdXJjZSgpO1xuXHRcdFx0XHR9IGVsc2UgaWYgKGRhdGEgaW5zdGFuY2VvZiBGb3JtRGF0YSkge1xuXG5cdFx0XHRcdFx0aWYgKGRhdGEuaGFzQmxvYigpKSB7XG5cdFx0XHRcdFx0XHRpZiAoZGF0YS5nZXRCbG9iKCkuaXNEZXRhY2hlZCgpKSB7XG5cdFx0XHRcdFx0XHRcdGRhdGEgPSBfcHJlcGFyZU11bHRpcGFydC5jYWxsKHRhcmdldCwgZGF0YSk7IC8vIF94aHIgbXVzdCBiZSBpbnN0YW50aWF0ZWQgYW5kIGJlIGluIE9QRU5FRCBzdGF0ZVxuXHRcdFx0XHRcdFx0XHRtdXN0U2VuZEFzQmluYXJ5ID0gdHJ1ZTtcblx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoKGlzR2Vja28yXzVfNiB8fCBpc0FuZHJvaWRCcm93c2VyKSAmJiBCYXNpYy50eXBlT2YoZGF0YS5nZXRCbG9iKCkuZ2V0U291cmNlKCkpID09PSAnYmxvYicgJiYgd2luZG93LkZpbGVSZWFkZXIpIHtcblx0XHRcdFx0XHRcdFx0Ly8gR2Vja28gMi81LzYgY2FuJ3Qgc2VuZCBibG9iIGluIEZvcm1EYXRhOiBodHRwczovL2J1Z3ppbGxhLm1vemlsbGEub3JnL3Nob3dfYnVnLmNnaT9pZD02NDkxNTBcblx0XHRcdFx0XHRcdFx0Ly8gQW5kcm9pZCBicm93c2VycyAoZGVmYXVsdCBvbmUgYW5kIERvbHBoaW4pIHNlZW0gdG8gaGF2ZSB0aGUgc2FtZSBpc3N1ZSwgc2VlOiAjNjEzXG5cdFx0XHRcdFx0XHRcdF9wcmVsb2FkQW5kU2VuZC5jYWxsKHRhcmdldCwgbWV0YSwgZGF0YSk7XG5cdFx0XHRcdFx0XHRcdHJldHVybjsgLy8gX3ByZWxvYWRBbmRTZW5kIHdpbGwgcmVpbnZva2Ugc2VuZCgpIHdpdGggdHJhbnNtdXRhdGVkIEZvcm1EYXRhID0lRFxuXHRcdFx0XHRcdFx0fVx0XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Ly8gdHJhbnNmZXIgZmllbGRzIHRvIHJlYWwgRm9ybURhdGFcblx0XHRcdFx0XHRpZiAoZGF0YSBpbnN0YW5jZW9mIEZvcm1EYXRhKSB7IC8vIGlmIHN0aWxsIGEgRm9ybURhdGEsIGUuZy4gbm90IG1hbmdsZWQgYnkgX3ByZXBhcmVNdWx0aXBhcnQoKVxuXHRcdFx0XHRcdFx0dmFyIGZkID0gbmV3IHdpbmRvdy5Gb3JtRGF0YSgpO1xuXHRcdFx0XHRcdFx0ZGF0YS5lYWNoKGZ1bmN0aW9uKHZhbHVlLCBuYW1lKSB7XG5cdFx0XHRcdFx0XHRcdGlmICh2YWx1ZSBpbnN0YW5jZW9mIEJsb2IpIHtcblx0XHRcdFx0XHRcdFx0XHRmZC5hcHBlbmQobmFtZSwgdmFsdWUuZ2V0U291cmNlKCkpO1xuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdGZkLmFwcGVuZChuYW1lLCB2YWx1ZSk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0ZGF0YSA9IGZkO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cblx0XHRcdFx0Ly8gaWYgWEhSIEwyXG5cdFx0XHRcdGlmIChfeGhyLnVwbG9hZCkge1xuXHRcdFx0XHRcdGlmIChtZXRhLndpdGhDcmVkZW50aWFscykge1xuXHRcdFx0XHRcdFx0X3hoci53aXRoQ3JlZGVudGlhbHMgPSB0cnVlO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdF94aHIuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0XHRcdHRhcmdldC50cmlnZ2VyKGUpO1xuXHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdFx0X3hoci5hZGRFdmVudExpc3RlbmVyKCdlcnJvcicsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0XHRcdHRhcmdldC50cmlnZ2VyKGUpO1xuXHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdFx0Ly8gYWRkaXRpb25hbGx5IGxpc3RlbiB0byBwcm9ncmVzcyBldmVudHNcblx0XHRcdFx0XHRfeGhyLmFkZEV2ZW50TGlzdGVuZXIoJ3Byb2dyZXNzJywgZnVuY3Rpb24oZSkge1xuXHRcdFx0XHRcdFx0dGFyZ2V0LnRyaWdnZXIoZSk7XG5cdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0XHRfeGhyLnVwbG9hZC5hZGRFdmVudExpc3RlbmVyKCdwcm9ncmVzcycsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0XHRcdHRhcmdldC50cmlnZ2VyKHtcblx0XHRcdFx0XHRcdFx0dHlwZTogJ1VwbG9hZFByb2dyZXNzJyxcblx0XHRcdFx0XHRcdFx0bG9hZGVkOiBlLmxvYWRlZCxcblx0XHRcdFx0XHRcdFx0dG90YWw6IGUudG90YWxcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHQvLyAuLi4gb3RoZXJ3aXNlIHNpbXVsYXRlIFhIUiBMMlxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdF94aHIub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gb25SZWFkeVN0YXRlQ2hhbmdlKCkge1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHQvLyBmYWtlIExldmVsIDIgZXZlbnRzXG5cdFx0XHRcdFx0XHRzd2l0Y2ggKF94aHIucmVhZHlTdGF0ZSkge1xuXHRcdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdFx0Y2FzZSAxOiAvLyBYTUxIdHRwUmVxdWVzdC5PUEVORURcblx0XHRcdFx0XHRcdFx0XHQvLyByZWFkeXN0YXRlY2hhbmdlZCBpcyBmaXJlZCB0d2ljZSBmb3IgT1BFTkVEIHN0YXRlIChpbiBJRSBhbmQgTW96aWxsYSkgLSBuZXVcblx0XHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRcdC8vIGxvb2tzIGxpa2UgSEVBREVSU19SRUNFSVZFRCAoc3RhdGUgMikgaXMgbm90IHJlcG9ydGVkIGluIE9wZXJhIChvciBpdCdzIG9sZCB2ZXJzaW9ucykgLSBuZXVcblx0XHRcdFx0XHRcdFx0Y2FzZSAyOiAvLyBYTUxIdHRwUmVxdWVzdC5IRUFERVJTX1JFQ0VJVkVEXG5cdFx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRcdGNhc2UgMzogLy8gWE1MSHR0cFJlcXVlc3QuTE9BRElORyBcblx0XHRcdFx0XHRcdFx0XHQvLyB0cnkgdG8gZmlyZSBwcm9ncmVzcyBldmVudCBmb3Igbm90IFhIUiBMMlxuXHRcdFx0XHRcdFx0XHRcdHZhciB0b3RhbCwgbG9hZGVkO1xuXHRcdFx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAoVXJsLmhhc1NhbWVPcmlnaW4obWV0YS51cmwpKSB7IC8vIENvbnRlbnQtTGVuZ3RoIG5vdCBhY2Nlc3NpYmxlIGZvciBjcm9zcy1kb21haW4gb24gc29tZSBicm93c2Vyc1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR0b3RhbCA9IF94aHIuZ2V0UmVzcG9uc2VIZWFkZXIoJ0NvbnRlbnQtTGVuZ3RoJykgfHwgMDsgLy8gb2xkIFNhZmFyaSB0aHJvd3MgYW4gZXhjZXB0aW9uIGhlcmVcblx0XHRcdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKF94aHIucmVzcG9uc2VUZXh0KSB7IC8vIHJlc3BvbnNlVGV4dCB3YXMgaW50cm9kdWNlZCBpbiBJRTdcblx0XHRcdFx0XHRcdFx0XHRcdFx0bG9hZGVkID0gX3hoci5yZXNwb25zZVRleHQubGVuZ3RoO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdH0gY2F0Y2goZXgpIHtcblx0XHRcdFx0XHRcdFx0XHRcdHRvdGFsID0gbG9hZGVkID0gMDtcblx0XHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0XHR0YXJnZXQudHJpZ2dlcih7XG5cdFx0XHRcdFx0XHRcdFx0XHR0eXBlOiAncHJvZ3Jlc3MnLFxuXHRcdFx0XHRcdFx0XHRcdFx0bGVuZ3RoQ29tcHV0YWJsZTogISF0b3RhbCxcblx0XHRcdFx0XHRcdFx0XHRcdHRvdGFsOiBwYXJzZUludCh0b3RhbCwgMTApLFxuXHRcdFx0XHRcdFx0XHRcdFx0bG9hZGVkOiBsb2FkZWRcblx0XHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdFx0Y2FzZSA0OiAvLyBYTUxIdHRwUmVxdWVzdC5ET05FXG5cdFx0XHRcdFx0XHRcdFx0Ly8gcmVsZWFzZSByZWFkeXN0YXRlY2hhbmdlIGhhbmRsZXIgKG1vc3RseSBmb3IgSUUpXG5cdFx0XHRcdFx0XHRcdFx0X3hoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHt9O1xuXG5cdFx0XHRcdFx0XHRcdFx0Ly8gdXN1YWxseSBzdGF0dXMgMCBpcyByZXR1cm5lZCB3aGVuIHNlcnZlciBpcyB1bnJlYWNoYWJsZSwgYnV0IEZGIGFsc28gZmFpbHMgdG8gc3RhdHVzIDAgZm9yIDQwOCB0aW1lb3V0XG5cdFx0XHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0XHRcdGlmIChfeGhyLnN0YXR1cyA+PSAyMDAgJiYgX3hoci5zdGF0dXMgPCA0MDApIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0dGFyZ2V0LnRyaWdnZXIoJ2xvYWQnKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0fSBjYXRjaChleCkge31cblxuXHRcdFx0XHRcdFx0XHRcdHRhcmdldC50cmlnZ2VyKCdlcnJvcicpO1xuXHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH07XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cblx0XHRcdFx0Ly8gc2V0IHJlcXVlc3QgaGVhZGVyc1xuXHRcdFx0XHRpZiAoIUJhc2ljLmlzRW1wdHlPYmoobWV0YS5oZWFkZXJzKSkge1xuXHRcdFx0XHRcdEJhc2ljLmVhY2gobWV0YS5oZWFkZXJzLCBmdW5jdGlvbih2YWx1ZSwgaGVhZGVyKSB7XG5cdFx0XHRcdFx0XHRfeGhyLnNldFJlcXVlc3RIZWFkZXIoaGVhZGVyLCB2YWx1ZSk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyByZXF1ZXN0IHJlc3BvbnNlIHR5cGVcblx0XHRcdFx0aWYgKFwiXCIgIT09IG1ldGEucmVzcG9uc2VUeXBlICYmICdyZXNwb25zZVR5cGUnIGluIF94aHIpIHtcblx0XHRcdFx0XHRpZiAoJ2pzb24nID09PSBtZXRhLnJlc3BvbnNlVHlwZSAmJiAhRW52LmNhbigncmV0dXJuX3Jlc3BvbnNlX3R5cGUnLCAnanNvbicpKSB7IC8vIHdlIGNhbiBmYWtlIHRoaXMgb25lXG5cdFx0XHRcdFx0XHRfeGhyLnJlc3BvbnNlVHlwZSA9ICd0ZXh0Jztcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0X3hoci5yZXNwb25zZVR5cGUgPSBtZXRhLnJlc3BvbnNlVHlwZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBzZW5kIC4uLlxuXHRcdFx0XHRpZiAoIW11c3RTZW5kQXNCaW5hcnkpIHtcblx0XHRcdFx0XHRfeGhyLnNlbmQoZGF0YSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0aWYgKF94aHIuc2VuZEFzQmluYXJ5KSB7IC8vIEdlY2tvXG5cdFx0XHRcdFx0XHRfeGhyLnNlbmRBc0JpbmFyeShkYXRhKTtcblx0XHRcdFx0XHR9IGVsc2UgeyAvLyBvdGhlciBicm93c2VycyBoYXZpbmcgc3VwcG9ydCBmb3IgdHlwZWQgYXJyYXlzXG5cdFx0XHRcdFx0XHQoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRcdC8vIG1pbWljIEdlY2tvJ3Mgc2VuZEFzQmluYXJ5XG5cdFx0XHRcdFx0XHRcdHZhciB1aThhID0gbmV3IFVpbnQ4QXJyYXkoZGF0YS5sZW5ndGgpO1xuXHRcdFx0XHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdFx0XHR1aThhW2ldID0gKGRhdGEuY2hhckNvZGVBdChpKSAmIDB4ZmYpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdF94aHIuc2VuZCh1aThhLmJ1ZmZlcik7XG5cdFx0XHRcdFx0XHR9KCkpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdHRhcmdldC50cmlnZ2VyKCdsb2Fkc3RhcnQnKTtcblx0XHRcdH0sXG5cblx0XHRcdGdldFN0YXR1czogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdC8vIGFjY29yZGluZyB0byBXM0Mgc3BlYyBpdCBzaG91bGQgcmV0dXJuIDAgZm9yIHJlYWR5U3RhdGUgPCAzLCBidXQgaW5zdGVhZCBpdCB0aHJvd3MgYW4gZXhjZXB0aW9uXG5cdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0aWYgKF94aHIpIHtcblx0XHRcdFx0XHRcdHJldHVybiBfeGhyLnN0YXR1cztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gY2F0Y2goZXgpIHt9XG5cdFx0XHRcdHJldHVybiAwO1xuXHRcdFx0fSxcblxuXHRcdFx0Z2V0UmVzcG9uc2U6IGZ1bmN0aW9uKHJlc3BvbnNlVHlwZSkge1xuXHRcdFx0XHR2YXIgSSA9IHRoaXMuZ2V0UnVudGltZSgpO1xuXG5cdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0c3dpdGNoIChyZXNwb25zZVR5cGUpIHtcblx0XHRcdFx0XHRcdGNhc2UgJ2Jsb2InOlxuXHRcdFx0XHRcdFx0XHR2YXIgZmlsZSA9IG5ldyBGaWxlKEkudWlkLCBfeGhyLnJlc3BvbnNlKTtcblx0XHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRcdC8vIHRyeSB0byBleHRyYWN0IGZpbGUgbmFtZSBmcm9tIGNvbnRlbnQtZGlzcG9zaXRpb24gaWYgcG9zc2libGUgKG1pZ2h0IGJlIC0gbm90LCBpZiBDT1JTIGZvciBleGFtcGxlKVx0XG5cdFx0XHRcdFx0XHRcdHZhciBkaXNwb3NpdGlvbiA9IF94aHIuZ2V0UmVzcG9uc2VIZWFkZXIoJ0NvbnRlbnQtRGlzcG9zaXRpb24nKTtcblx0XHRcdFx0XHRcdFx0aWYgKGRpc3Bvc2l0aW9uKSB7XG5cdFx0XHRcdFx0XHRcdFx0Ly8gZXh0cmFjdCBmaWxlbmFtZSBmcm9tIHJlc3BvbnNlIGhlYWRlciBpZiBhdmFpbGFibGVcblx0XHRcdFx0XHRcdFx0XHR2YXIgbWF0Y2ggPSBkaXNwb3NpdGlvbi5tYXRjaCgvZmlsZW5hbWU9KFtcXCdcXFwiJ10pKFteXFwxXSspXFwxLyk7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKG1hdGNoKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRfZmlsZW5hbWUgPSBtYXRjaFsyXTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0ZmlsZS5uYW1lID0gX2ZpbGVuYW1lO1xuXG5cdFx0XHRcdFx0XHRcdC8vIHByZS13ZWJraXQgT3BlcmEgZG9lc24ndCBzZXQgdHlwZSBwcm9wZXJ0eSBvbiB0aGUgYmxvYiByZXNwb25zZVxuXHRcdFx0XHRcdFx0XHRpZiAoIWZpbGUudHlwZSkge1xuXHRcdFx0XHRcdFx0XHRcdGZpbGUudHlwZSA9IE1pbWUuZ2V0RmlsZU1pbWUoX2ZpbGVuYW1lKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gZmlsZTtcblxuXHRcdFx0XHRcdFx0Y2FzZSAnanNvbic6XG5cdFx0XHRcdFx0XHRcdGlmICghRW52LmNhbigncmV0dXJuX3Jlc3BvbnNlX3R5cGUnLCAnanNvbicpKSB7XG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuIF94aHIuc3RhdHVzID09PSAyMDAgJiYgISF3aW5kb3cuSlNPTiA/IEpTT04ucGFyc2UoX3hoci5yZXNwb25zZVRleHQpIDogbnVsbDtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gX3hoci5yZXNwb25zZTtcblxuXHRcdFx0XHRcdFx0Y2FzZSAnZG9jdW1lbnQnOlxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gX2dldERvY3VtZW50KF94aHIpO1xuXG5cdFx0XHRcdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gX3hoci5yZXNwb25zZVRleHQgIT09ICcnID8gX3hoci5yZXNwb25zZVRleHQgOiBudWxsOyAvLyBhZ2FpbnN0IHRoZSBzcGVjcywgYnV0IGZvciBjb25zaXN0ZW5jeSBhY3Jvc3MgdGhlIHJ1bnRpbWVzXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGNhdGNoKGV4KSB7XG5cdFx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHRcdH1cdFx0XHRcdFxuXHRcdFx0fSxcblxuXHRcdFx0Z2V0QWxsUmVzcG9uc2VIZWFkZXJzOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRyZXR1cm4gX3hoci5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKTtcblx0XHRcdFx0fSBjYXRjaChleCkge31cblx0XHRcdFx0cmV0dXJuICcnO1xuXHRcdFx0fSxcblxuXHRcdFx0YWJvcnQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRpZiAoX3hocikge1xuXHRcdFx0XHRcdF94aHIuYWJvcnQoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSxcblxuXHRcdFx0ZGVzdHJveTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHNlbGYgPSBfZmlsZW5hbWUgPSBudWxsO1xuXHRcdFx0XHR0aGlzLmdldFJ1bnRpbWUoKS5nZXRTaGltKCkucmVtb3ZlSW5zdGFuY2UodGhpcy51aWQpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cblx0XHQvLyBoZXJlIHdlIGdvLi4uIHVnbHkgZml4IGZvciB1Z2x5IGJ1Z1xuXHRcdGZ1bmN0aW9uIF9wcmVsb2FkQW5kU2VuZChtZXRhLCBkYXRhKSB7XG5cdFx0XHR2YXIgdGFyZ2V0ID0gdGhpcywgYmxvYiwgZnI7XG5cdFx0XHRcdFxuXHRcdFx0Ly8gZ2V0IG9yaWdpbmFsIGJsb2Jcblx0XHRcdGJsb2IgPSBkYXRhLmdldEJsb2IoKS5nZXRTb3VyY2UoKTtcblx0XHRcdFxuXHRcdFx0Ly8gcHJlbG9hZCBibG9iIGluIG1lbW9yeSB0byBiZSBzZW50IGFzIGJpbmFyeSBzdHJpbmdcblx0XHRcdGZyID0gbmV3IHdpbmRvdy5GaWxlUmVhZGVyKCk7XG5cdFx0XHRmci5vbmxvYWQgPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0Ly8gb3ZlcndyaXRlIG9yaWdpbmFsIGJsb2Jcblx0XHRcdFx0ZGF0YS5hcHBlbmQoZGF0YS5nZXRCbG9iTmFtZSgpLCBuZXcgQmxvYihudWxsLCB7XG5cdFx0XHRcdFx0dHlwZTogYmxvYi50eXBlLFxuXHRcdFx0XHRcdGRhdGE6IGZyLnJlc3VsdFxuXHRcdFx0XHR9KSk7XG5cdFx0XHRcdC8vIGludm9rZSBzZW5kIG9wZXJhdGlvbiBhZ2FpblxuXHRcdFx0XHRzZWxmLnNlbmQuY2FsbCh0YXJnZXQsIG1ldGEsIGRhdGEpO1xuXHRcdFx0fTtcblx0XHRcdGZyLnJlYWRBc0JpbmFyeVN0cmluZyhibG9iKTtcblx0XHR9XG5cblx0XHRcblx0XHRmdW5jdGlvbiBfZ2V0TmF0aXZlWEhSKCkge1xuXHRcdFx0aWYgKHdpbmRvdy5YTUxIdHRwUmVxdWVzdCAmJiAhKEVudi5icm93c2VyID09PSAnSUUnICYmIEVudi52ZXJDb21wKEVudi52ZXJzaW9uLCA4LCAnPCcpKSkgeyAvLyBJRTcgaGFzIG5hdGl2ZSBYSFIgYnV0IGl0J3MgYnVnZ3lcblx0XHRcdFx0cmV0dXJuIG5ldyB3aW5kb3cuWE1MSHR0cFJlcXVlc3QoKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHJldHVybiAoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0dmFyIHByb2dJRHMgPSBbJ01zeG1sMi5YTUxIVFRQLjYuMCcsICdNaWNyb3NvZnQuWE1MSFRUUCddOyAvLyBpZiA2LjAgYXZhaWxhYmxlLCB1c2UgaXQsIG90aGVyd2lzZSBmYWlsYmFjayB0byBkZWZhdWx0IDMuMFxuXHRcdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgcHJvZ0lEcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIG5ldyBBY3RpdmVYT2JqZWN0KHByb2dJRHNbaV0pO1xuXHRcdFx0XHRcdFx0fSBjYXRjaCAoZXgpIHt9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KSgpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHQvLyBAY3JlZGl0cyBTZXJnZXkgSWxpbnNreVx0KGh0dHA6Ly93d3cuaWxpbnNreS5jb20vKVxuXHRcdGZ1bmN0aW9uIF9nZXREb2N1bWVudCh4aHIpIHtcblx0XHRcdHZhciByWE1MID0geGhyLnJlc3BvbnNlWE1MO1xuXHRcdFx0dmFyIHJUZXh0ID0geGhyLnJlc3BvbnNlVGV4dDtcblx0XHRcdFxuXHRcdFx0Ly8gVHJ5IHBhcnNpbmcgcmVzcG9uc2VUZXh0IChAc2VlOiBodHRwOi8vd3d3LmlsaW5za3kuY29tL2FydGljbGVzL1hNTEh0dHBSZXF1ZXN0LyNidWdzLWllLXJlc3BvbnNlWE1MLWNvbnRlbnQtdHlwZSlcblx0XHRcdGlmIChFbnYuYnJvd3NlciA9PT0gJ0lFJyAmJiByVGV4dCAmJiByWE1MICYmICFyWE1MLmRvY3VtZW50RWxlbWVudCAmJiAvW15cXC9dK1xcL1teXFwrXStcXCt4bWwvLnRlc3QoeGhyLmdldFJlc3BvbnNlSGVhZGVyKFwiQ29udGVudC1UeXBlXCIpKSkge1xuXHRcdFx0XHRyWE1MID0gbmV3IHdpbmRvdy5BY3RpdmVYT2JqZWN0KFwiTWljcm9zb2Z0LlhNTERPTVwiKTtcblx0XHRcdFx0clhNTC5hc3luYyA9IGZhbHNlO1xuXHRcdFx0XHRyWE1MLnZhbGlkYXRlT25QYXJzZSA9IGZhbHNlO1xuXHRcdFx0XHRyWE1MLmxvYWRYTUwoclRleHQpO1xuXHRcdFx0fVxuXHRcblx0XHRcdC8vIENoZWNrIGlmIHRoZXJlIGlzIG5vIGVycm9yIGluIGRvY3VtZW50XG5cdFx0XHRpZiAoclhNTCkge1xuXHRcdFx0XHRpZiAoKEVudi5icm93c2VyID09PSAnSUUnICYmIHJYTUwucGFyc2VFcnJvciAhPT0gMCkgfHwgIXJYTUwuZG9jdW1lbnRFbGVtZW50IHx8IHJYTUwuZG9jdW1lbnRFbGVtZW50LnRhZ05hbWUgPT09IFwicGFyc2VyZXJyb3JcIikge1xuXHRcdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gclhNTDtcblx0XHR9XG5cblxuXHRcdGZ1bmN0aW9uIF9wcmVwYXJlTXVsdGlwYXJ0KGZkKSB7XG5cdFx0XHR2YXIgYm91bmRhcnkgPSAnLS0tLW1veGllYm91bmRhcnknICsgbmV3IERhdGUoKS5nZXRUaW1lKClcblx0XHRcdCwgZGFzaGRhc2ggPSAnLS0nXG5cdFx0XHQsIGNybGYgPSAnXFxyXFxuJ1xuXHRcdFx0LCBtdWx0aXBhcnQgPSAnJ1xuXHRcdFx0LCBJID0gdGhpcy5nZXRSdW50aW1lKClcblx0XHRcdDtcblxuXHRcdFx0aWYgKCFJLmNhbignc2VuZF9iaW5hcnlfc3RyaW5nJykpIHtcblx0XHRcdFx0dGhyb3cgbmV3IHguUnVudGltZUVycm9yKHguUnVudGltZUVycm9yLk5PVF9TVVBQT1JURURfRVJSKTtcblx0XHRcdH1cblxuXHRcdFx0X3hoci5zZXRSZXF1ZXN0SGVhZGVyKCdDb250ZW50LVR5cGUnLCAnbXVsdGlwYXJ0L2Zvcm0tZGF0YTsgYm91bmRhcnk9JyArIGJvdW5kYXJ5KTtcblxuXHRcdFx0Ly8gYXBwZW5kIG11bHRpcGFydCBwYXJhbWV0ZXJzXG5cdFx0XHRmZC5lYWNoKGZ1bmN0aW9uKHZhbHVlLCBuYW1lKSB7XG5cdFx0XHRcdC8vIEZpcmVmb3ggMy42IGZhaWxlZCB0byBjb252ZXJ0IG11bHRpYnl0ZSBjaGFyYWN0ZXJzIHRvIFVURi04IGluIHNlbmRBc0JpbmFyeSgpLCBcblx0XHRcdFx0Ly8gc28gd2UgdHJ5IGl0IGhlcmUgb3Vyc2VsdmVzIHdpdGg6IHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudCh2YWx1ZSkpXG5cdFx0XHRcdGlmICh2YWx1ZSBpbnN0YW5jZW9mIEJsb2IpIHtcblx0XHRcdFx0XHQvLyBCdWlsZCBSRkMyMzg4IGJsb2Jcblx0XHRcdFx0XHRtdWx0aXBhcnQgKz0gZGFzaGRhc2ggKyBib3VuZGFyeSArIGNybGYgK1xuXHRcdFx0XHRcdFx0J0NvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT1cIicgKyBuYW1lICsgJ1wiOyBmaWxlbmFtZT1cIicgKyB1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQodmFsdWUubmFtZSB8fCAnYmxvYicpKSArICdcIicgKyBjcmxmICtcblx0XHRcdFx0XHRcdCdDb250ZW50LVR5cGU6ICcgKyAodmFsdWUudHlwZSB8fCAnYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtJykgKyBjcmxmICsgY3JsZiArXG5cdFx0XHRcdFx0XHR2YWx1ZS5nZXRTb3VyY2UoKSArIGNybGY7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0bXVsdGlwYXJ0ICs9IGRhc2hkYXNoICsgYm91bmRhcnkgKyBjcmxmICtcblx0XHRcdFx0XHRcdCdDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9XCInICsgbmFtZSArICdcIicgKyBjcmxmICsgY3JsZiArXG5cdFx0XHRcdFx0XHR1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQodmFsdWUpKSArIGNybGY7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHRtdWx0aXBhcnQgKz0gZGFzaGRhc2ggKyBib3VuZGFyeSArIGRhc2hkYXNoICsgY3JsZjtcblxuXHRcdFx0cmV0dXJuIG11bHRpcGFydDtcblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gKGV4dGVuc2lvbnMuWE1MSHR0cFJlcXVlc3QgPSBYTUxIdHRwUmVxdWVzdCk7XG59KTtcblxuLy8gSW5jbHVkZWQgZnJvbTogc3JjL2phdmFzY3JpcHQvcnVudGltZS9odG1sNS91dGlscy9CaW5hcnlSZWFkZXIuanNcblxuLyoqXG4gKiBCaW5hcnlSZWFkZXIuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuLyoqXG5AY2xhc3MgbW94aWUvcnVudGltZS9odG1sNS91dGlscy9CaW5hcnlSZWFkZXJcbkBwcml2YXRlXG4qL1xuZGVmaW5lKFwibW94aWUvcnVudGltZS9odG1sNS91dGlscy9CaW5hcnlSZWFkZXJcIiwgW1xuXHRcIm1veGllL2NvcmUvdXRpbHMvQmFzaWNcIlxuXSwgZnVuY3Rpb24oQmFzaWMpIHtcblxuXHRcblx0ZnVuY3Rpb24gQmluYXJ5UmVhZGVyKGRhdGEpIHtcblx0XHRpZiAoZGF0YSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7XG5cdFx0XHRBcnJheUJ1ZmZlclJlYWRlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRVVEYxNlN0cmluZ1JlYWRlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdH1cblx0fVxuXG5cdEJhc2ljLmV4dGVuZChCaW5hcnlSZWFkZXIucHJvdG90eXBlLCB7XG5cdFx0XG5cdFx0bGl0dGxlRW5kaWFuOiBmYWxzZSxcblxuXG5cdFx0cmVhZDogZnVuY3Rpb24oaWR4LCBzaXplKSB7XG5cdFx0XHR2YXIgc3VtLCBtdiwgaTtcblxuXHRcdFx0aWYgKGlkeCArIHNpemUgPiB0aGlzLmxlbmd0aCgpKSB7XG5cdFx0XHRcdHRocm93IG5ldyBFcnJvcihcIllvdSBhcmUgdHJ5aW5nIHRvIHJlYWQgb3V0c2lkZSB0aGUgc291cmNlIGJvdW5kYXJpZXMuXCIpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRtdiA9IHRoaXMubGl0dGxlRW5kaWFuIFxuXHRcdFx0XHQ/IDAgXG5cdFx0XHRcdDogLTggKiAoc2l6ZSAtIDEpXG5cdFx0XHQ7XG5cblx0XHRcdGZvciAoaSA9IDAsIHN1bSA9IDA7IGkgPCBzaXplOyBpKyspIHtcblx0XHRcdFx0c3VtIHw9ICh0aGlzLnJlYWRCeXRlQXQoaWR4ICsgaSkgPDwgTWF0aC5hYnMobXYgKyBpKjgpKTtcblx0XHRcdH1cblx0XHRcdHJldHVybiBzdW07XG5cdFx0fSxcblxuXG5cdFx0d3JpdGU6IGZ1bmN0aW9uKGlkeCwgbnVtLCBzaXplKSB7XG5cdFx0XHR2YXIgbXYsIGksIHN0ciA9ICcnO1xuXG5cdFx0XHRpZiAoaWR4ID4gdGhpcy5sZW5ndGgoKSkge1xuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoXCJZb3UgYXJlIHRyeWluZyB0byB3cml0ZSBvdXRzaWRlIHRoZSBzb3VyY2UgYm91bmRhcmllcy5cIik7XG5cdFx0XHR9XG5cblx0XHRcdG12ID0gdGhpcy5saXR0bGVFbmRpYW4gXG5cdFx0XHRcdD8gMCBcblx0XHRcdFx0OiAtOCAqIChzaXplIC0gMSlcblx0XHRcdDtcblxuXHRcdFx0Zm9yIChpID0gMDsgaSA8IHNpemU7IGkrKykge1xuXHRcdFx0XHR0aGlzLndyaXRlQnl0ZUF0KGlkeCArIGksIChudW0gPj4gTWF0aC5hYnMobXYgKyBpKjgpKSAmIDI1NSk7XG5cdFx0XHR9XG5cdFx0fSxcblxuXG5cdFx0QllURTogZnVuY3Rpb24oaWR4KSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5yZWFkKGlkeCwgMSk7XG5cdFx0fSxcblxuXG5cdFx0U0hPUlQ6IGZ1bmN0aW9uKGlkeCkge1xuXHRcdFx0cmV0dXJuIHRoaXMucmVhZChpZHgsIDIpO1xuXHRcdH0sXG5cblxuXHRcdExPTkc6IGZ1bmN0aW9uKGlkeCkge1xuXHRcdFx0cmV0dXJuIHRoaXMucmVhZChpZHgsIDQpO1xuXHRcdH0sXG5cblxuXHRcdFNMT05HOiBmdW5jdGlvbihpZHgpIHsgLy8gMidzIGNvbXBsZW1lbnQgbm90YXRpb25cblx0XHRcdHZhciBudW0gPSB0aGlzLnJlYWQoaWR4LCA0KTtcblx0XHRcdHJldHVybiAobnVtID4gMjE0NzQ4MzY0NyA/IG51bSAtIDQyOTQ5NjcyOTYgOiBudW0pO1xuXHRcdH0sXG5cblxuXHRcdENIQVI6IGZ1bmN0aW9uKGlkeCkge1xuXHRcdFx0cmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUodGhpcy5yZWFkKGlkeCwgMSkpO1xuXHRcdH0sXG5cblxuXHRcdFNUUklORzogZnVuY3Rpb24oaWR4LCBjb3VudCkge1xuXHRcdFx0cmV0dXJuIHRoaXMuYXNBcnJheSgnQ0hBUicsIGlkeCwgY291bnQpLmpvaW4oJycpO1xuXHRcdH0sXG5cblxuXHRcdGFzQXJyYXk6IGZ1bmN0aW9uKHR5cGUsIGlkeCwgY291bnQpIHtcblx0XHRcdHZhciB2YWx1ZXMgPSBbXTtcblxuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7XG5cdFx0XHRcdHZhbHVlc1tpXSA9IHRoaXNbdHlwZV0oaWR4ICsgaSk7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gdmFsdWVzO1xuXHRcdH1cblx0fSk7XG5cblxuXHRmdW5jdGlvbiBBcnJheUJ1ZmZlclJlYWRlcihkYXRhKSB7XG5cdFx0dmFyIF9kdiA9IG5ldyBEYXRhVmlldyhkYXRhKTtcblxuXHRcdEJhc2ljLmV4dGVuZCh0aGlzLCB7XG5cdFx0XHRcblx0XHRcdHJlYWRCeXRlQXQ6IGZ1bmN0aW9uKGlkeCkge1xuXHRcdFx0XHRyZXR1cm4gX2R2LmdldFVpbnQ4KGlkeCk7XG5cdFx0XHR9LFxuXG5cblx0XHRcdHdyaXRlQnl0ZUF0OiBmdW5jdGlvbihpZHgsIHZhbHVlKSB7XG5cdFx0XHRcdF9kdi5zZXRVaW50OChpZHgsIHZhbHVlKTtcblx0XHRcdH0sXG5cdFx0XHRcblxuXHRcdFx0U0VHTUVOVDogZnVuY3Rpb24oaWR4LCBzaXplLCB2YWx1ZSkge1xuXHRcdFx0XHRzd2l0Y2ggKGFyZ3VtZW50cy5sZW5ndGgpIHtcblx0XHRcdFx0XHRjYXNlIDI6XG5cdFx0XHRcdFx0XHRyZXR1cm4gZGF0YS5zbGljZShpZHgsIGlkeCArIHNpemUpO1xuXG5cdFx0XHRcdFx0Y2FzZSAxOlxuXHRcdFx0XHRcdFx0cmV0dXJuIGRhdGEuc2xpY2UoaWR4KTtcblxuXHRcdFx0XHRcdGNhc2UgMzpcblx0XHRcdFx0XHRcdGlmICh2YWx1ZSA9PT0gbnVsbCkge1xuXHRcdFx0XHRcdFx0XHR2YWx1ZSA9IG5ldyBBcnJheUJ1ZmZlcigpO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRpZiAodmFsdWUgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikge1x0XHRcdFx0XHRcblx0XHRcdFx0XHRcdFx0dmFyIGFyciA9IG5ldyBVaW50OEFycmF5KHRoaXMubGVuZ3RoKCkgLSBzaXplICsgdmFsdWUuYnl0ZUxlbmd0aCk7XG5cdFx0XHRcdFx0XHRcdGlmIChpZHggPiAwKSB7XG5cdFx0XHRcdFx0XHRcdFx0YXJyLnNldChuZXcgVWludDhBcnJheShkYXRhLnNsaWNlKDAsIGlkeCkpLCAwKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRhcnIuc2V0KG5ldyBVaW50OEFycmF5KHZhbHVlKSwgaWR4KTtcblx0XHRcdFx0XHRcdFx0YXJyLnNldChuZXcgVWludDhBcnJheShkYXRhLnNsaWNlKGlkeCArIHNpemUpKSwgaWR4ICsgdmFsdWUuYnl0ZUxlbmd0aCk7XG5cblx0XHRcdFx0XHRcdFx0dGhpcy5jbGVhcigpO1xuXHRcdFx0XHRcdFx0XHRkYXRhID0gYXJyLmJ1ZmZlcjtcblx0XHRcdFx0XHRcdFx0X2R2ID0gbmV3IERhdGFWaWV3KGRhdGEpO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGRlZmF1bHQ6IHJldHVybiBkYXRhO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXG5cblx0XHRcdGxlbmd0aDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiBkYXRhID8gZGF0YS5ieXRlTGVuZ3RoIDogMDtcblx0XHRcdH0sXG5cblxuXHRcdFx0Y2xlYXI6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRfZHYgPSBkYXRhID0gbnVsbDtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cblx0ZnVuY3Rpb24gVVRGMTZTdHJpbmdSZWFkZXIoZGF0YSkge1xuXHRcdEJhc2ljLmV4dGVuZCh0aGlzLCB7XG5cdFx0XHRcblx0XHRcdHJlYWRCeXRlQXQ6IGZ1bmN0aW9uKGlkeCkge1xuXHRcdFx0XHRyZXR1cm4gZGF0YS5jaGFyQ29kZUF0KGlkeCk7XG5cdFx0XHR9LFxuXG5cblx0XHRcdHdyaXRlQnl0ZUF0OiBmdW5jdGlvbihpZHgsIHZhbHVlKSB7XG5cdFx0XHRcdHB1dHN0cihTdHJpbmcuZnJvbUNoYXJDb2RlKHZhbHVlKSwgaWR4LCAxKTtcblx0XHRcdH0sXG5cblxuXHRcdFx0U0VHTUVOVDogZnVuY3Rpb24oaWR4LCBsZW5ndGgsIHNlZ21lbnQpIHtcblx0XHRcdFx0c3dpdGNoIChhcmd1bWVudHMubGVuZ3RoKSB7XG5cdFx0XHRcdFx0Y2FzZSAxOlxuXHRcdFx0XHRcdFx0cmV0dXJuIGRhdGEuc3Vic3RyKGlkeCk7XG5cdFx0XHRcdFx0Y2FzZSAyOlxuXHRcdFx0XHRcdFx0cmV0dXJuIGRhdGEuc3Vic3RyKGlkeCwgbGVuZ3RoKTtcblx0XHRcdFx0XHRjYXNlIDM6XG5cdFx0XHRcdFx0XHRwdXRzdHIoc2VnbWVudCAhPT0gbnVsbCA/IHNlZ21lbnQgOiAnJywgaWR4LCBsZW5ndGgpO1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0ZGVmYXVsdDogcmV0dXJuIGRhdGE7XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cblxuXHRcdFx0bGVuZ3RoOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIGRhdGEgPyBkYXRhLmxlbmd0aCA6IDA7XG5cdFx0XHR9LCBcblxuXHRcdFx0Y2xlYXI6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRkYXRhID0gbnVsbDtcblx0XHRcdH1cblx0XHR9KTtcblxuXG5cdFx0ZnVuY3Rpb24gcHV0c3RyKHNlZ21lbnQsIGlkeCwgbGVuZ3RoKSB7XG5cdFx0XHRsZW5ndGggPSBhcmd1bWVudHMubGVuZ3RoID09PSAzID8gbGVuZ3RoIDogZGF0YS5sZW5ndGggLSBpZHggLSAxO1xuXHRcdFx0ZGF0YSA9IGRhdGEuc3Vic3RyKDAsIGlkeCkgKyBzZWdtZW50ICsgZGF0YS5zdWJzdHIobGVuZ3RoICsgaWR4KTtcblx0XHR9XG5cdH1cblxuXG5cdHJldHVybiBCaW5hcnlSZWFkZXI7XG59KTtcblxuLy8gSW5jbHVkZWQgZnJvbTogc3JjL2phdmFzY3JpcHQvcnVudGltZS9odG1sNS9pbWFnZS9KUEVHSGVhZGVycy5qc1xuXG4vKipcbiAqIEpQRUdIZWFkZXJzLmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG4gXG4vKipcbkBjbGFzcyBtb3hpZS9ydW50aW1lL2h0bWw1L2ltYWdlL0pQRUdIZWFkZXJzXG5AcHJpdmF0ZVxuKi9cbmRlZmluZShcIm1veGllL3J1bnRpbWUvaHRtbDUvaW1hZ2UvSlBFR0hlYWRlcnNcIiwgW1xuXHRcIm1veGllL3J1bnRpbWUvaHRtbDUvdXRpbHMvQmluYXJ5UmVhZGVyXCIsXG5cdFwibW94aWUvY29yZS9FeGNlcHRpb25zXCJcbl0sIGZ1bmN0aW9uKEJpbmFyeVJlYWRlciwgeCkge1xuXHRcblx0cmV0dXJuIGZ1bmN0aW9uIEpQRUdIZWFkZXJzKGRhdGEpIHtcblx0XHR2YXIgaGVhZGVycyA9IFtdLCBfYnIsIGlkeCwgbWFya2VyLCBsZW5ndGggPSAwO1xuXG5cdFx0X2JyID0gbmV3IEJpbmFyeVJlYWRlcihkYXRhKTtcblxuXHRcdC8vIENoZWNrIGlmIGRhdGEgaXMganBlZ1xuXHRcdGlmIChfYnIuU0hPUlQoMCkgIT09IDB4RkZEOCkge1xuXHRcdFx0X2JyLmNsZWFyKCk7XG5cdFx0XHR0aHJvdyBuZXcgeC5JbWFnZUVycm9yKHguSW1hZ2VFcnJvci5XUk9OR19GT1JNQVQpO1xuXHRcdH1cblxuXHRcdGlkeCA9IDI7XG5cblx0XHR3aGlsZSAoaWR4IDw9IF9ici5sZW5ndGgoKSkge1xuXHRcdFx0bWFya2VyID0gX2JyLlNIT1JUKGlkeCk7XG5cblx0XHRcdC8vIG9taXQgUlNUIChyZXN0YXJ0KSBtYXJrZXJzXG5cdFx0XHRpZiAobWFya2VyID49IDB4RkZEMCAmJiBtYXJrZXIgPD0gMHhGRkQ3KSB7XG5cdFx0XHRcdGlkeCArPSAyO1xuXHRcdFx0XHRjb250aW51ZTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gbm8gaGVhZGVycyBhbGxvd2VkIGFmdGVyIFNPUyBtYXJrZXJcblx0XHRcdGlmIChtYXJrZXIgPT09IDB4RkZEQSB8fCBtYXJrZXIgPT09IDB4RkZEOSkge1xuXHRcdFx0XHRicmVhaztcblx0XHRcdH1cblxuXHRcdFx0bGVuZ3RoID0gX2JyLlNIT1JUKGlkeCArIDIpICsgMjtcblxuXHRcdFx0Ly8gQVBQbiBtYXJrZXIgZGV0ZWN0ZWRcblx0XHRcdGlmIChtYXJrZXIgPj0gMHhGRkUxICYmIG1hcmtlciA8PSAweEZGRUYpIHtcblx0XHRcdFx0aGVhZGVycy5wdXNoKHtcblx0XHRcdFx0XHRoZXg6IG1hcmtlcixcblx0XHRcdFx0XHRuYW1lOiAnQVBQJyArIChtYXJrZXIgJiAweDAwMEYpLFxuXHRcdFx0XHRcdHN0YXJ0OiBpZHgsXG5cdFx0XHRcdFx0bGVuZ3RoOiBsZW5ndGgsXG5cdFx0XHRcdFx0c2VnbWVudDogX2JyLlNFR01FTlQoaWR4LCBsZW5ndGgpXG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXG5cdFx0XHRpZHggKz0gbGVuZ3RoO1xuXHRcdH1cblxuXHRcdF9ici5jbGVhcigpO1xuXG5cdFx0cmV0dXJuIHtcblx0XHRcdGhlYWRlcnM6IGhlYWRlcnMsXG5cblx0XHRcdHJlc3RvcmU6IGZ1bmN0aW9uKGRhdGEpIHtcblx0XHRcdFx0dmFyIG1heCwgaSwgYnI7XG5cblx0XHRcdFx0YnIgPSBuZXcgQmluYXJ5UmVhZGVyKGRhdGEpO1xuXG5cdFx0XHRcdGlkeCA9IGJyLlNIT1JUKDIpID09IDB4RkZFMCA/IDQgKyBici5TSE9SVCg0KSA6IDI7XG5cblx0XHRcdFx0Zm9yIChpID0gMCwgbWF4ID0gaGVhZGVycy5sZW5ndGg7IGkgPCBtYXg7IGkrKykge1xuXHRcdFx0XHRcdGJyLlNFR01FTlQoaWR4LCAwLCBoZWFkZXJzW2ldLnNlZ21lbnQpO1xuXHRcdFx0XHRcdGlkeCArPSBoZWFkZXJzW2ldLmxlbmd0aDtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGRhdGEgPSBici5TRUdNRU5UKCk7XG5cdFx0XHRcdGJyLmNsZWFyKCk7XG5cdFx0XHRcdHJldHVybiBkYXRhO1xuXHRcdFx0fSxcblxuXHRcdFx0c3RyaXA6IGZ1bmN0aW9uKGRhdGEpIHtcblx0XHRcdFx0dmFyIGJyLCBoZWFkZXJzLCBqcGVnSGVhZGVycywgaTtcblxuXHRcdFx0XHRqcGVnSGVhZGVycyA9IG5ldyBKUEVHSGVhZGVycyhkYXRhKTtcblx0XHRcdFx0aGVhZGVycyA9IGpwZWdIZWFkZXJzLmhlYWRlcnM7XG5cdFx0XHRcdGpwZWdIZWFkZXJzLnB1cmdlKCk7XG5cblx0XHRcdFx0YnIgPSBuZXcgQmluYXJ5UmVhZGVyKGRhdGEpO1xuXG5cdFx0XHRcdGkgPSBoZWFkZXJzLmxlbmd0aDtcblx0XHRcdFx0d2hpbGUgKGktLSkge1xuXHRcdFx0XHRcdGJyLlNFR01FTlQoaGVhZGVyc1tpXS5zdGFydCwgaGVhZGVyc1tpXS5sZW5ndGgsICcnKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0ZGF0YSA9IGJyLlNFR01FTlQoKTtcblx0XHRcdFx0YnIuY2xlYXIoKTtcblx0XHRcdFx0cmV0dXJuIGRhdGE7XG5cdFx0XHR9LFxuXG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKG5hbWUpIHtcblx0XHRcdFx0dmFyIGFycmF5ID0gW107XG5cblx0XHRcdFx0Zm9yICh2YXIgaSA9IDAsIG1heCA9IGhlYWRlcnMubGVuZ3RoOyBpIDwgbWF4OyBpKyspIHtcblx0XHRcdFx0XHRpZiAoaGVhZGVyc1tpXS5uYW1lID09PSBuYW1lLnRvVXBwZXJDYXNlKCkpIHtcblx0XHRcdFx0XHRcdGFycmF5LnB1c2goaGVhZGVyc1tpXS5zZWdtZW50KTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIGFycmF5O1xuXHRcdFx0fSxcblxuXHRcdFx0c2V0OiBmdW5jdGlvbihuYW1lLCBzZWdtZW50KSB7XG5cdFx0XHRcdHZhciBhcnJheSA9IFtdLCBpLCBpaSwgbWF4O1xuXG5cdFx0XHRcdGlmICh0eXBlb2Yoc2VnbWVudCkgPT09ICdzdHJpbmcnKSB7XG5cdFx0XHRcdFx0YXJyYXkucHVzaChzZWdtZW50KTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRhcnJheSA9IHNlZ21lbnQ7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRmb3IgKGkgPSBpaSA9IDAsIG1heCA9IGhlYWRlcnMubGVuZ3RoOyBpIDwgbWF4OyBpKyspIHtcblx0XHRcdFx0XHRpZiAoaGVhZGVyc1tpXS5uYW1lID09PSBuYW1lLnRvVXBwZXJDYXNlKCkpIHtcblx0XHRcdFx0XHRcdGhlYWRlcnNbaV0uc2VnbWVudCA9IGFycmF5W2lpXTtcblx0XHRcdFx0XHRcdGhlYWRlcnNbaV0ubGVuZ3RoID0gYXJyYXlbaWldLmxlbmd0aDtcblx0XHRcdFx0XHRcdGlpKys7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGlmIChpaSA+PSBhcnJheS5sZW5ndGgpIHtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fSxcblxuXHRcdFx0cHVyZ2U6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR0aGlzLmhlYWRlcnMgPSBoZWFkZXJzID0gW107XG5cdFx0XHR9XG5cdFx0fTtcblx0fTtcbn0pO1xuXG4vLyBJbmNsdWRlZCBmcm9tOiBzcmMvamF2YXNjcmlwdC9ydW50aW1lL2h0bWw1L2ltYWdlL0V4aWZQYXJzZXIuanNcblxuLyoqXG4gKiBFeGlmUGFyc2VyLmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG5cbi8qKlxuQGNsYXNzIG1veGllL3J1bnRpbWUvaHRtbDUvaW1hZ2UvRXhpZlBhcnNlclxuQHByaXZhdGVcbiovXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL2h0bWw1L2ltYWdlL0V4aWZQYXJzZXJcIiwgW1xuXHRcIm1veGllL2NvcmUvdXRpbHMvQmFzaWNcIixcblx0XCJtb3hpZS9ydW50aW1lL2h0bWw1L3V0aWxzL0JpbmFyeVJlYWRlclwiLFxuXHRcIm1veGllL2NvcmUvRXhjZXB0aW9uc1wiXG5dLCBmdW5jdGlvbihCYXNpYywgQmluYXJ5UmVhZGVyLCB4KSB7XG5cdFxuXHRmdW5jdGlvbiBFeGlmUGFyc2VyKGRhdGEpIHtcblx0XHR2YXIgX19zdXBlcl9fLCB0YWdzLCB0YWdEZXNjcywgb2Zmc2V0cywgaWR4LCBUaWZmO1xuXHRcdFxuXHRcdEJpbmFyeVJlYWRlci5jYWxsKHRoaXMsIGRhdGEpO1xuXG5cdFx0dGFncyA9IHtcblx0XHRcdHRpZmY6IHtcblx0XHRcdFx0Lypcblx0XHRcdFx0VGhlIGltYWdlIG9yaWVudGF0aW9uIHZpZXdlZCBpbiB0ZXJtcyBvZiByb3dzIGFuZCBjb2x1bW5zLlxuXG5cdFx0XHRcdDEgPSBUaGUgMHRoIHJvdyBpcyBhdCB0aGUgdmlzdWFsIHRvcCBvZiB0aGUgaW1hZ2UsIGFuZCB0aGUgMHRoIGNvbHVtbiBpcyB0aGUgdmlzdWFsIGxlZnQtaGFuZCBzaWRlLlxuXHRcdFx0XHQyID0gVGhlIDB0aCByb3cgaXMgYXQgdGhlIHZpc3VhbCB0b3Agb2YgdGhlIGltYWdlLCBhbmQgdGhlIDB0aCBjb2x1bW4gaXMgdGhlIHZpc3VhbCByaWdodC1oYW5kIHNpZGUuXG5cdFx0XHRcdDMgPSBUaGUgMHRoIHJvdyBpcyBhdCB0aGUgdmlzdWFsIGJvdHRvbSBvZiB0aGUgaW1hZ2UsIGFuZCB0aGUgMHRoIGNvbHVtbiBpcyB0aGUgdmlzdWFsIHJpZ2h0LWhhbmQgc2lkZS5cblx0XHRcdFx0NCA9IFRoZSAwdGggcm93IGlzIGF0IHRoZSB2aXN1YWwgYm90dG9tIG9mIHRoZSBpbWFnZSwgYW5kIHRoZSAwdGggY29sdW1uIGlzIHRoZSB2aXN1YWwgbGVmdC1oYW5kIHNpZGUuXG5cdFx0XHRcdDUgPSBUaGUgMHRoIHJvdyBpcyB0aGUgdmlzdWFsIGxlZnQtaGFuZCBzaWRlIG9mIHRoZSBpbWFnZSwgYW5kIHRoZSAwdGggY29sdW1uIGlzIHRoZSB2aXN1YWwgdG9wLlxuXHRcdFx0XHQ2ID0gVGhlIDB0aCByb3cgaXMgdGhlIHZpc3VhbCByaWdodC1oYW5kIHNpZGUgb2YgdGhlIGltYWdlLCBhbmQgdGhlIDB0aCBjb2x1bW4gaXMgdGhlIHZpc3VhbCB0b3AuXG5cdFx0XHRcdDcgPSBUaGUgMHRoIHJvdyBpcyB0aGUgdmlzdWFsIHJpZ2h0LWhhbmQgc2lkZSBvZiB0aGUgaW1hZ2UsIGFuZCB0aGUgMHRoIGNvbHVtbiBpcyB0aGUgdmlzdWFsIGJvdHRvbS5cblx0XHRcdFx0OCA9IFRoZSAwdGggcm93IGlzIHRoZSB2aXN1YWwgbGVmdC1oYW5kIHNpZGUgb2YgdGhlIGltYWdlLCBhbmQgdGhlIDB0aCBjb2x1bW4gaXMgdGhlIHZpc3VhbCBib3R0b20uXG5cdFx0XHRcdCovXG5cdFx0XHRcdDB4MDExMjogJ09yaWVudGF0aW9uJyxcblx0XHRcdFx0MHgwMTBFOiAnSW1hZ2VEZXNjcmlwdGlvbicsXG5cdFx0XHRcdDB4MDEwRjogJ01ha2UnLFxuXHRcdFx0XHQweDAxMTA6ICdNb2RlbCcsXG5cdFx0XHRcdDB4MDEzMTogJ1NvZnR3YXJlJyxcblx0XHRcdFx0MHg4NzY5OiAnRXhpZklGRFBvaW50ZXInLFxuXHRcdFx0XHQweDg4MjU6XHQnR1BTSW5mb0lGRFBvaW50ZXInXG5cdFx0XHR9LFxuXHRcdFx0ZXhpZjoge1xuXHRcdFx0XHQweDkwMDA6ICdFeGlmVmVyc2lvbicsXG5cdFx0XHRcdDB4QTAwMTogJ0NvbG9yU3BhY2UnLFxuXHRcdFx0XHQweEEwMDI6ICdQaXhlbFhEaW1lbnNpb24nLFxuXHRcdFx0XHQweEEwMDM6ICdQaXhlbFlEaW1lbnNpb24nLFxuXHRcdFx0XHQweDkwMDM6ICdEYXRlVGltZU9yaWdpbmFsJyxcblx0XHRcdFx0MHg4MjlBOiAnRXhwb3N1cmVUaW1lJyxcblx0XHRcdFx0MHg4MjlEOiAnRk51bWJlcicsXG5cdFx0XHRcdDB4ODgyNzogJ0lTT1NwZWVkUmF0aW5ncycsXG5cdFx0XHRcdDB4OTIwMTogJ1NodXR0ZXJTcGVlZFZhbHVlJyxcblx0XHRcdFx0MHg5MjAyOiAnQXBlcnR1cmVWYWx1ZSdcdCxcblx0XHRcdFx0MHg5MjA3OiAnTWV0ZXJpbmdNb2RlJyxcblx0XHRcdFx0MHg5MjA4OiAnTGlnaHRTb3VyY2UnLFxuXHRcdFx0XHQweDkyMDk6ICdGbGFzaCcsXG5cdFx0XHRcdDB4OTIwQTogJ0ZvY2FsTGVuZ3RoJyxcblx0XHRcdFx0MHhBNDAyOiAnRXhwb3N1cmVNb2RlJyxcblx0XHRcdFx0MHhBNDAzOiAnV2hpdGVCYWxhbmNlJyxcblx0XHRcdFx0MHhBNDA2OiAnU2NlbmVDYXB0dXJlVHlwZScsXG5cdFx0XHRcdDB4QTQwNDogJ0RpZ2l0YWxab29tUmF0aW8nLFxuXHRcdFx0XHQweEE0MDg6ICdDb250cmFzdCcsXG5cdFx0XHRcdDB4QTQwOTogJ1NhdHVyYXRpb24nLFxuXHRcdFx0XHQweEE0MEE6ICdTaGFycG5lc3MnXG5cdFx0XHR9LFxuXHRcdFx0Z3BzOiB7XG5cdFx0XHRcdDB4MDAwMDogJ0dQU1ZlcnNpb25JRCcsXG5cdFx0XHRcdDB4MDAwMTogJ0dQU0xhdGl0dWRlUmVmJyxcblx0XHRcdFx0MHgwMDAyOiAnR1BTTGF0aXR1ZGUnLFxuXHRcdFx0XHQweDAwMDM6ICdHUFNMb25naXR1ZGVSZWYnLFxuXHRcdFx0XHQweDAwMDQ6ICdHUFNMb25naXR1ZGUnXG5cdFx0XHR9LFxuXG5cdFx0XHR0aHVtYjoge1xuXHRcdFx0XHQweDAyMDE6ICdKUEVHSW50ZXJjaGFuZ2VGb3JtYXQnLFxuXHRcdFx0XHQweDAyMDI6ICdKUEVHSW50ZXJjaGFuZ2VGb3JtYXRMZW5ndGgnXG5cdFx0XHR9XG5cdFx0fTtcblxuXHRcdHRhZ0Rlc2NzID0ge1xuXHRcdFx0J0NvbG9yU3BhY2UnOiB7XG5cdFx0XHRcdDE6ICdzUkdCJyxcblx0XHRcdFx0MDogJ1VuY2FsaWJyYXRlZCdcblx0XHRcdH0sXG5cblx0XHRcdCdNZXRlcmluZ01vZGUnOiB7XG5cdFx0XHRcdDA6ICdVbmtub3duJyxcblx0XHRcdFx0MTogJ0F2ZXJhZ2UnLFxuXHRcdFx0XHQyOiAnQ2VudGVyV2VpZ2h0ZWRBdmVyYWdlJyxcblx0XHRcdFx0MzogJ1Nwb3QnLFxuXHRcdFx0XHQ0OiAnTXVsdGlTcG90Jyxcblx0XHRcdFx0NTogJ1BhdHRlcm4nLFxuXHRcdFx0XHQ2OiAnUGFydGlhbCcsXG5cdFx0XHRcdDI1NTogJ090aGVyJ1xuXHRcdFx0fSxcblxuXHRcdFx0J0xpZ2h0U291cmNlJzoge1xuXHRcdFx0XHQxOiAnRGF5bGlnaHQnLFxuXHRcdFx0XHQyOiAnRmxpb3Jlc2NlbnQnLFxuXHRcdFx0XHQzOiAnVHVuZ3N0ZW4nLFxuXHRcdFx0XHQ0OiAnRmxhc2gnLFxuXHRcdFx0XHQ5OiAnRmluZSB3ZWF0aGVyJyxcblx0XHRcdFx0MTA6ICdDbG91ZHkgd2VhdGhlcicsXG5cdFx0XHRcdDExOiAnU2hhZGUnLFxuXHRcdFx0XHQxMjogJ0RheWxpZ2h0IGZsdW9yZXNjZW50IChEIDU3MDAgLSA3MTAwSyknLFxuXHRcdFx0XHQxMzogJ0RheSB3aGl0ZSBmbHVvcmVzY2VudCAoTiA0NjAwIC01NDAwSyknLFxuXHRcdFx0XHQxNDogJ0Nvb2wgd2hpdGUgZmx1b3Jlc2NlbnQgKFcgMzkwMCAtIDQ1MDBLKScsXG5cdFx0XHRcdDE1OiAnV2hpdGUgZmx1b3Jlc2NlbnQgKFdXIDMyMDAgLSAzNzAwSyknLFxuXHRcdFx0XHQxNzogJ1N0YW5kYXJkIGxpZ2h0IEEnLFxuXHRcdFx0XHQxODogJ1N0YW5kYXJkIGxpZ2h0IEInLFxuXHRcdFx0XHQxOTogJ1N0YW5kYXJkIGxpZ2h0IEMnLFxuXHRcdFx0XHQyMDogJ0Q1NScsXG5cdFx0XHRcdDIxOiAnRDY1Jyxcblx0XHRcdFx0MjI6ICdENzUnLFxuXHRcdFx0XHQyMzogJ0Q1MCcsXG5cdFx0XHRcdDI0OiAnSVNPIHN0dWRpbyB0dW5nc3RlbicsXG5cdFx0XHRcdDI1NTogJ090aGVyJ1xuXHRcdFx0fSxcblxuXHRcdFx0J0ZsYXNoJzoge1xuXHRcdFx0XHQweDAwMDA6ICdGbGFzaCBkaWQgbm90IGZpcmUnLFxuXHRcdFx0XHQweDAwMDE6ICdGbGFzaCBmaXJlZCcsXG5cdFx0XHRcdDB4MDAwNTogJ1N0cm9iZSByZXR1cm4gbGlnaHQgbm90IGRldGVjdGVkJyxcblx0XHRcdFx0MHgwMDA3OiAnU3Ryb2JlIHJldHVybiBsaWdodCBkZXRlY3RlZCcsXG5cdFx0XHRcdDB4MDAwOTogJ0ZsYXNoIGZpcmVkLCBjb21wdWxzb3J5IGZsYXNoIG1vZGUnLFxuXHRcdFx0XHQweDAwMEQ6ICdGbGFzaCBmaXJlZCwgY29tcHVsc29yeSBmbGFzaCBtb2RlLCByZXR1cm4gbGlnaHQgbm90IGRldGVjdGVkJyxcblx0XHRcdFx0MHgwMDBGOiAnRmxhc2ggZmlyZWQsIGNvbXB1bHNvcnkgZmxhc2ggbW9kZSwgcmV0dXJuIGxpZ2h0IGRldGVjdGVkJyxcblx0XHRcdFx0MHgwMDEwOiAnRmxhc2ggZGlkIG5vdCBmaXJlLCBjb21wdWxzb3J5IGZsYXNoIG1vZGUnLFxuXHRcdFx0XHQweDAwMTg6ICdGbGFzaCBkaWQgbm90IGZpcmUsIGF1dG8gbW9kZScsXG5cdFx0XHRcdDB4MDAxOTogJ0ZsYXNoIGZpcmVkLCBhdXRvIG1vZGUnLFxuXHRcdFx0XHQweDAwMUQ6ICdGbGFzaCBmaXJlZCwgYXV0byBtb2RlLCByZXR1cm4gbGlnaHQgbm90IGRldGVjdGVkJyxcblx0XHRcdFx0MHgwMDFGOiAnRmxhc2ggZmlyZWQsIGF1dG8gbW9kZSwgcmV0dXJuIGxpZ2h0IGRldGVjdGVkJyxcblx0XHRcdFx0MHgwMDIwOiAnTm8gZmxhc2ggZnVuY3Rpb24nLFxuXHRcdFx0XHQweDAwNDE6ICdGbGFzaCBmaXJlZCwgcmVkLWV5ZSByZWR1Y3Rpb24gbW9kZScsXG5cdFx0XHRcdDB4MDA0NTogJ0ZsYXNoIGZpcmVkLCByZWQtZXllIHJlZHVjdGlvbiBtb2RlLCByZXR1cm4gbGlnaHQgbm90IGRldGVjdGVkJyxcblx0XHRcdFx0MHgwMDQ3OiAnRmxhc2ggZmlyZWQsIHJlZC1leWUgcmVkdWN0aW9uIG1vZGUsIHJldHVybiBsaWdodCBkZXRlY3RlZCcsXG5cdFx0XHRcdDB4MDA0OTogJ0ZsYXNoIGZpcmVkLCBjb21wdWxzb3J5IGZsYXNoIG1vZGUsIHJlZC1leWUgcmVkdWN0aW9uIG1vZGUnLFxuXHRcdFx0XHQweDAwNEQ6ICdGbGFzaCBmaXJlZCwgY29tcHVsc29yeSBmbGFzaCBtb2RlLCByZWQtZXllIHJlZHVjdGlvbiBtb2RlLCByZXR1cm4gbGlnaHQgbm90IGRldGVjdGVkJyxcblx0XHRcdFx0MHgwMDRGOiAnRmxhc2ggZmlyZWQsIGNvbXB1bHNvcnkgZmxhc2ggbW9kZSwgcmVkLWV5ZSByZWR1Y3Rpb24gbW9kZSwgcmV0dXJuIGxpZ2h0IGRldGVjdGVkJyxcblx0XHRcdFx0MHgwMDU5OiAnRmxhc2ggZmlyZWQsIGF1dG8gbW9kZSwgcmVkLWV5ZSByZWR1Y3Rpb24gbW9kZScsXG5cdFx0XHRcdDB4MDA1RDogJ0ZsYXNoIGZpcmVkLCBhdXRvIG1vZGUsIHJldHVybiBsaWdodCBub3QgZGV0ZWN0ZWQsIHJlZC1leWUgcmVkdWN0aW9uIG1vZGUnLFxuXHRcdFx0XHQweDAwNUY6ICdGbGFzaCBmaXJlZCwgYXV0byBtb2RlLCByZXR1cm4gbGlnaHQgZGV0ZWN0ZWQsIHJlZC1leWUgcmVkdWN0aW9uIG1vZGUnXG5cdFx0XHR9LFxuXG5cdFx0XHQnRXhwb3N1cmVNb2RlJzoge1xuXHRcdFx0XHQwOiAnQXV0byBleHBvc3VyZScsXG5cdFx0XHRcdDE6ICdNYW51YWwgZXhwb3N1cmUnLFxuXHRcdFx0XHQyOiAnQXV0byBicmFja2V0J1xuXHRcdFx0fSxcblxuXHRcdFx0J1doaXRlQmFsYW5jZSc6IHtcblx0XHRcdFx0MDogJ0F1dG8gd2hpdGUgYmFsYW5jZScsXG5cdFx0XHRcdDE6ICdNYW51YWwgd2hpdGUgYmFsYW5jZSdcblx0XHRcdH0sXG5cblx0XHRcdCdTY2VuZUNhcHR1cmVUeXBlJzoge1xuXHRcdFx0XHQwOiAnU3RhbmRhcmQnLFxuXHRcdFx0XHQxOiAnTGFuZHNjYXBlJyxcblx0XHRcdFx0MjogJ1BvcnRyYWl0Jyxcblx0XHRcdFx0MzogJ05pZ2h0IHNjZW5lJ1xuXHRcdFx0fSxcblxuXHRcdFx0J0NvbnRyYXN0Jzoge1xuXHRcdFx0XHQwOiAnTm9ybWFsJyxcblx0XHRcdFx0MTogJ1NvZnQnLFxuXHRcdFx0XHQyOiAnSGFyZCdcblx0XHRcdH0sXG5cblx0XHRcdCdTYXR1cmF0aW9uJzoge1xuXHRcdFx0XHQwOiAnTm9ybWFsJyxcblx0XHRcdFx0MTogJ0xvdyBzYXR1cmF0aW9uJyxcblx0XHRcdFx0MjogJ0hpZ2ggc2F0dXJhdGlvbidcblx0XHRcdH0sXG5cblx0XHRcdCdTaGFycG5lc3MnOiB7XG5cdFx0XHRcdDA6ICdOb3JtYWwnLFxuXHRcdFx0XHQxOiAnU29mdCcsXG5cdFx0XHRcdDI6ICdIYXJkJ1xuXHRcdFx0fSxcblxuXHRcdFx0Ly8gR1BTIHJlbGF0ZWRcblx0XHRcdCdHUFNMYXRpdHVkZVJlZic6IHtcblx0XHRcdFx0TjogJ05vcnRoIGxhdGl0dWRlJyxcblx0XHRcdFx0UzogJ1NvdXRoIGxhdGl0dWRlJ1xuXHRcdFx0fSxcblxuXHRcdFx0J0dQU0xvbmdpdHVkZVJlZic6IHtcblx0XHRcdFx0RTogJ0Vhc3QgbG9uZ2l0dWRlJyxcblx0XHRcdFx0VzogJ1dlc3QgbG9uZ2l0dWRlJ1xuXHRcdFx0fVxuXHRcdH07XG5cblx0XHRvZmZzZXRzID0ge1xuXHRcdFx0dGlmZkhlYWRlcjogMTBcblx0XHR9O1xuXHRcdFxuXHRcdGlkeCA9IG9mZnNldHMudGlmZkhlYWRlcjtcblxuXHRcdF9fc3VwZXJfXyA9IHtcblx0XHRcdGNsZWFyOiB0aGlzLmNsZWFyXG5cdFx0fTtcblxuXHRcdC8vIFB1YmxpYyBmdW5jdGlvbnNcblx0XHRCYXNpYy5leHRlbmQodGhpcywge1xuXHRcdFx0XG5cdFx0XHRyZWFkOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRyZXR1cm4gRXhpZlBhcnNlci5wcm90b3R5cGUucmVhZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdFx0XHR9IGNhdGNoIChleCkge1xuXHRcdFx0XHRcdHRocm93IG5ldyB4LkltYWdlRXJyb3IoeC5JbWFnZUVycm9yLklOVkFMSURfTUVUQV9FUlIpO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXG5cblx0XHRcdHdyaXRlOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRyZXR1cm4gRXhpZlBhcnNlci5wcm90b3R5cGUud3JpdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRcdFx0fSBjYXRjaCAoZXgpIHtcblx0XHRcdFx0XHR0aHJvdyBuZXcgeC5JbWFnZUVycm9yKHguSW1hZ2VFcnJvci5JTlZBTElEX01FVEFfRVJSKTtcblx0XHRcdFx0fVxuXHRcdFx0fSxcblxuXG5cdFx0XHRVTkRFRklORUQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5CWVRFLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0XHR9LFxuXG5cblx0XHRcdFJBVElPTkFMOiBmdW5jdGlvbihpZHgpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuTE9ORyhpZHgpIC8gdGhpcy5MT05HKGlkeCArIDQpXG5cdFx0XHR9LFxuXG5cblx0XHRcdFNSQVRJT05BTDogZnVuY3Rpb24oaWR4KSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLlNMT05HKGlkeCkgLyB0aGlzLlNMT05HKGlkeCArIDQpXG5cdFx0XHR9LFxuXG5cdFx0XHRBU0NJSTogZnVuY3Rpb24oaWR4KSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLkNIQVIoaWR4KTtcblx0XHRcdH0sXG5cblx0XHRcdFRJRkY6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gVGlmZiB8fCBudWxsO1xuXHRcdFx0fSxcblxuXG5cdFx0XHRFWElGOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIEV4aWYgPSBudWxsO1xuXG5cdFx0XHRcdGlmIChvZmZzZXRzLmV4aWZJRkQpIHtcblx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0RXhpZiA9IGV4dHJhY3RUYWdzLmNhbGwodGhpcywgb2Zmc2V0cy5leGlmSUZELCB0YWdzLmV4aWYpO1xuXHRcdFx0XHRcdH0gY2F0Y2goZXgpIHtcblx0XHRcdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8vIEZpeCBmb3JtYXR0aW5nIG9mIHNvbWUgdGFnc1xuXHRcdFx0XHRcdGlmIChFeGlmLkV4aWZWZXJzaW9uICYmIEJhc2ljLnR5cGVPZihFeGlmLkV4aWZWZXJzaW9uKSA9PT0gJ2FycmF5Jykge1xuXHRcdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDAsIGV4aWZWZXJzaW9uID0gJyc7IGkgPCBFeGlmLkV4aWZWZXJzaW9uLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRcdGV4aWZWZXJzaW9uICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoRXhpZi5FeGlmVmVyc2lvbltpXSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRFeGlmLkV4aWZWZXJzaW9uID0gZXhpZlZlcnNpb247XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0cmV0dXJuIEV4aWY7XG5cdFx0XHR9LFxuXG5cblx0XHRcdEdQUzogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciBHUFMgPSBudWxsO1xuXG5cdFx0XHRcdGlmIChvZmZzZXRzLmdwc0lGRCkge1xuXHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRHUFMgPSBleHRyYWN0VGFncy5jYWxsKHRoaXMsIG9mZnNldHMuZ3BzSUZELCB0YWdzLmdwcyk7XG5cdFx0XHRcdFx0fSBjYXRjaCAoZXgpIHtcblx0XHRcdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8vIGlPUyBkZXZpY2VzIChhbmQgcHJvYmFibHkgc29tZSBvdGhlcnMpIGRvIG5vdCBwdXQgaW4gR1BTVmVyc2lvbklEIHRhZyAod2h5Py4uKVxuXHRcdFx0XHRcdGlmIChHUFMuR1BTVmVyc2lvbklEICYmIEJhc2ljLnR5cGVPZihHUFMuR1BTVmVyc2lvbklEKSA9PT0gJ2FycmF5Jykge1xuXHRcdFx0XHRcdFx0R1BTLkdQU1ZlcnNpb25JRCA9IEdQUy5HUFNWZXJzaW9uSUQuam9pbignLicpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdHJldHVybiBHUFM7XG5cdFx0XHR9LFxuXG5cblx0XHRcdHRodW1iOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0aWYgKG9mZnNldHMuSUZEMSkge1xuXHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHR2YXIgSUZEMVRhZ3MgPSBleHRyYWN0VGFncy5jYWxsKHRoaXMsIG9mZnNldHMuSUZEMSwgdGFncy50aHVtYik7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdGlmICgnSlBFR0ludGVyY2hhbmdlRm9ybWF0JyBpbiBJRkQxVGFncykge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gdGhpcy5TRUdNRU5UKG9mZnNldHMudGlmZkhlYWRlciArIElGRDFUYWdzLkpQRUdJbnRlcmNoYW5nZUZvcm1hdCwgSUZEMVRhZ3MuSlBFR0ludGVyY2hhbmdlRm9ybWF0TGVuZ3RoKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9IGNhdGNoIChleCkge31cblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH0sXG5cblxuXHRcdFx0c2V0RXhpZjogZnVuY3Rpb24odGFnLCB2YWx1ZSkge1xuXHRcdFx0XHQvLyBSaWdodCBub3cgb25seSBzZXR0aW5nIG9mIHdpZHRoL2hlaWdodCBpcyBwb3NzaWJsZVxuXHRcdFx0XHRpZiAodGFnICE9PSAnUGl4ZWxYRGltZW5zaW9uJyAmJiB0YWcgIT09ICdQaXhlbFlEaW1lbnNpb24nKSB7IHJldHVybiBmYWxzZTsgfVxuXG5cdFx0XHRcdHJldHVybiBzZXRUYWcuY2FsbCh0aGlzLCAnZXhpZicsIHRhZywgdmFsdWUpO1xuXHRcdFx0fSxcblxuXG5cdFx0XHRjbGVhcjogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdF9fc3VwZXJfXy5jbGVhcigpO1xuXHRcdFx0XHRkYXRhID0gdGFncyA9IHRhZ0Rlc2NzID0gVGlmZiA9IG9mZnNldHMgPSBfX3N1cGVyX18gPSBudWxsO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cblx0XHQvLyBDaGVjayBpZiB0aGF0J3MgQVBQMSBhbmQgdGhhdCBpdCBoYXMgRVhJRlxuXHRcdGlmICh0aGlzLlNIT1JUKDApICE9PSAweEZGRTEgfHwgdGhpcy5TVFJJTkcoNCwgNSkudG9VcHBlckNhc2UoKSAhPT0gXCJFWElGXFwwXCIpIHtcblx0XHRcdHRocm93IG5ldyB4LkltYWdlRXJyb3IoeC5JbWFnZUVycm9yLklOVkFMSURfTUVUQV9FUlIpO1xuXHRcdH1cblxuXHRcdC8vIFNldCByZWFkIG9yZGVyIG9mIG11bHRpLWJ5dGUgZGF0YVxuXHRcdHRoaXMubGl0dGxlRW5kaWFuID0gKHRoaXMuU0hPUlQoaWR4KSA9PSAweDQ5NDkpO1xuXG5cdFx0Ly8gQ2hlY2sgaWYgYWx3YXlzIHByZXNlbnQgYnl0ZXMgYXJlIGluZGVlZCBwcmVzZW50XG5cdFx0aWYgKHRoaXMuU0hPUlQoaWR4Kz0yKSAhPT0gMHgwMDJBKSB7XG5cdFx0XHR0aHJvdyBuZXcgeC5JbWFnZUVycm9yKHguSW1hZ2VFcnJvci5JTlZBTElEX01FVEFfRVJSKTtcblx0XHR9XG5cblx0XHRvZmZzZXRzLklGRDAgPSBvZmZzZXRzLnRpZmZIZWFkZXIgKyB0aGlzLkxPTkcoaWR4ICs9IDIpO1xuXHRcdFRpZmYgPSBleHRyYWN0VGFncy5jYWxsKHRoaXMsIG9mZnNldHMuSUZEMCwgdGFncy50aWZmKTtcblxuXHRcdGlmICgnRXhpZklGRFBvaW50ZXInIGluIFRpZmYpIHtcblx0XHRcdG9mZnNldHMuZXhpZklGRCA9IG9mZnNldHMudGlmZkhlYWRlciArIFRpZmYuRXhpZklGRFBvaW50ZXI7XG5cdFx0XHRkZWxldGUgVGlmZi5FeGlmSUZEUG9pbnRlcjtcblx0XHR9XG5cblx0XHRpZiAoJ0dQU0luZm9JRkRQb2ludGVyJyBpbiBUaWZmKSB7XG5cdFx0XHRvZmZzZXRzLmdwc0lGRCA9IG9mZnNldHMudGlmZkhlYWRlciArIFRpZmYuR1BTSW5mb0lGRFBvaW50ZXI7XG5cdFx0XHRkZWxldGUgVGlmZi5HUFNJbmZvSUZEUG9pbnRlcjtcblx0XHR9XG5cblx0XHRpZiAoQmFzaWMuaXNFbXB0eU9iaihUaWZmKSkge1xuXHRcdFx0VGlmZiA9IG51bGw7XG5cdFx0fVxuXG5cdFx0Ly8gY2hlY2sgaWYgd2UgaGF2ZSBhIHRodW1iIGFzIHdlbGxcblx0XHR2YXIgSUZEMU9mZnNldCA9IHRoaXMuTE9ORyhvZmZzZXRzLklGRDAgKyB0aGlzLlNIT1JUKG9mZnNldHMuSUZEMCkgKiAxMiArIDIpO1xuXHRcdGlmIChJRkQxT2Zmc2V0KSB7XG5cdFx0XHRvZmZzZXRzLklGRDEgPSBvZmZzZXRzLnRpZmZIZWFkZXIgKyBJRkQxT2Zmc2V0O1xuXHRcdH1cblxuXG5cdFx0ZnVuY3Rpb24gZXh0cmFjdFRhZ3MoSUZEX29mZnNldCwgdGFnczJleHRyYWN0KSB7XG5cdFx0XHR2YXIgZGF0YSA9IHRoaXM7XG5cdFx0XHR2YXIgbGVuZ3RoLCBpLCB0YWcsIHR5cGUsIGNvdW50LCBzaXplLCBvZmZzZXQsIHZhbHVlLCB2YWx1ZXMgPSBbXSwgaGFzaCA9IHt9O1xuXHRcdFx0XG5cdFx0XHR2YXIgdHlwZXMgPSB7XG5cdFx0XHRcdDEgOiAnQllURScsXG5cdFx0XHRcdDcgOiAnVU5ERUZJTkVEJyxcblx0XHRcdFx0MiA6ICdBU0NJSScsXG5cdFx0XHRcdDMgOiAnU0hPUlQnLFxuXHRcdFx0XHQ0IDogJ0xPTkcnLFxuXHRcdFx0XHQ1IDogJ1JBVElPTkFMJyxcblx0XHRcdFx0OSA6ICdTTE9ORycsXG5cdFx0XHRcdDEwOiAnU1JBVElPTkFMJ1xuXHRcdFx0fTtcblxuXHRcdFx0dmFyIHNpemVzID0ge1xuXHRcdFx0XHQnQllURScgXHRcdDogMSxcblx0XHRcdFx0J1VOREVGSU5FRCdcdDogMSxcblx0XHRcdFx0J0FTQ0lJJ1x0XHQ6IDEsXG5cdFx0XHRcdCdTSE9SVCdcdFx0OiAyLFxuXHRcdFx0XHQnTE9ORycgXHRcdDogNCxcblx0XHRcdFx0J1JBVElPTkFMJyBcdDogOCxcblx0XHRcdFx0J1NMT05HJ1x0XHQ6IDQsXG5cdFx0XHRcdCdTUkFUSU9OQUwnXHQ6IDhcblx0XHRcdH07XG5cblx0XHRcdGxlbmd0aCA9IGRhdGEuU0hPUlQoSUZEX29mZnNldCk7XG5cblx0XHRcdC8vIFRoZSBzaXplIG9mIEFQUDEgaW5jbHVkaW5nIGFsbCB0aGVzZSBlbGVtZW50cyBzaGFsbCBub3QgZXhjZWVkIHRoZSA2NCBLYnl0ZXMgc3BlY2lmaWVkIGluIHRoZSBKUEVHIHN0YW5kYXJkLlxuXG5cdFx0XHRmb3IgKGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0dmFsdWVzID0gW107XG5cblx0XHRcdFx0Ly8gU2V0IGJpbmFyeSByZWFkZXIgcG9pbnRlciB0byBiZWdpbm5pbmcgb2YgdGhlIG5leHQgdGFnXG5cdFx0XHRcdG9mZnNldCA9IElGRF9vZmZzZXQgKyAyICsgaSoxMjtcblxuXHRcdFx0XHR0YWcgPSB0YWdzMmV4dHJhY3RbZGF0YS5TSE9SVChvZmZzZXQpXTtcblxuXHRcdFx0XHRpZiAodGFnID09PSB1bmRlZmluZWQpIHtcblx0XHRcdFx0XHRjb250aW51ZTsgLy8gTm90IHRoZSB0YWcgd2UgcmVxdWVzdGVkXG5cdFx0XHRcdH1cblxuXHRcdFx0XHR0eXBlID0gdHlwZXNbZGF0YS5TSE9SVChvZmZzZXQrPTIpXTtcblx0XHRcdFx0Y291bnQgPSBkYXRhLkxPTkcob2Zmc2V0Kz0yKTtcblx0XHRcdFx0c2l6ZSA9IHNpemVzW3R5cGVdO1xuXG5cdFx0XHRcdGlmICghc2l6ZSkge1xuXHRcdFx0XHRcdHRocm93IG5ldyB4LkltYWdlRXJyb3IoeC5JbWFnZUVycm9yLklOVkFMSURfTUVUQV9FUlIpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0b2Zmc2V0ICs9IDQ7XG5cblx0XHRcdFx0Ly8gdGFnIGNhbiBvbmx5IGZpdCA0IGJ5dGVzIG9mIGRhdGEsIGlmIGRhdGEgaXMgbGFyZ2VyIHdlIHNob3VsZCBsb29rIG91dHNpZGVcblx0XHRcdFx0aWYgKHNpemUgKiBjb3VudCA+IDQpIHtcblx0XHRcdFx0XHQvLyBpbnN0ZWFkIG9mIGRhdGEgdGFnIGNvbnRhaW5zIGFuIG9mZnNldCBvZiB0aGUgZGF0YVxuXHRcdFx0XHRcdG9mZnNldCA9IGRhdGEuTE9ORyhvZmZzZXQpICsgb2Zmc2V0cy50aWZmSGVhZGVyO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gaW4gY2FzZSB3ZSBsZWZ0IHRoZSBib3VuZGFyaWVzIG9mIGRhdGEgdGhyb3cgYW4gZWFybHkgZXhjZXB0aW9uXG5cdFx0XHRcdGlmIChvZmZzZXQgKyBzaXplICogY291bnQgPj0gdGhpcy5sZW5ndGgoKSkge1xuXHRcdFx0XHRcdHRocm93IG5ldyB4LkltYWdlRXJyb3IoeC5JbWFnZUVycm9yLklOVkFMSURfTUVUQV9FUlIpO1xuXHRcdFx0XHR9IFxuXG5cdFx0XHRcdC8vIHNwZWNpYWwgY2FyZSBmb3IgdGhlIHN0cmluZ1xuXHRcdFx0XHRpZiAodHlwZSA9PT0gJ0FTQ0lJJykge1xuXHRcdFx0XHRcdGhhc2hbdGFnXSA9IEJhc2ljLnRyaW0oZGF0YS5TVFJJTkcob2Zmc2V0LCBjb3VudCkucmVwbGFjZSgvXFwwJC8sICcnKSk7IC8vIHN0cmlwIHRyYWlsaW5nIE5VTExcblx0XHRcdFx0XHRjb250aW51ZTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHR2YWx1ZXMgPSBkYXRhLmFzQXJyYXkodHlwZSwgb2Zmc2V0LCBjb3VudCk7XG5cdFx0XHRcdFx0dmFsdWUgPSAoY291bnQgPT0gMSA/IHZhbHVlc1swXSA6IHZhbHVlcyk7XG5cblx0XHRcdFx0XHRpZiAodGFnRGVzY3MuaGFzT3duUHJvcGVydHkodGFnKSAmJiB0eXBlb2YgdmFsdWUgIT0gJ29iamVjdCcpIHtcblx0XHRcdFx0XHRcdGhhc2hbdGFnXSA9IHRhZ0Rlc2NzW3RhZ11bdmFsdWVdO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRoYXNoW3RhZ10gPSB2YWx1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIGhhc2g7XG5cdFx0fVxuXG5cdFx0Ly8gQXQgdGhlIG1vbWVudCBvbmx5IHNldHRpbmcgb2Ygc2ltcGxlIChMT05HKSB2YWx1ZXMsIHRoYXQgZG8gbm90IHJlcXVpcmUgb2Zmc2V0IHJlY2FsY3VsYXRpb24sIGlzIHN1cHBvcnRlZFxuXHRcdGZ1bmN0aW9uIHNldFRhZyhpZmQsIHRhZywgdmFsdWUpIHtcblx0XHRcdHZhciBvZmZzZXQsIGxlbmd0aCwgdGFnT2Zmc2V0LCB2YWx1ZU9mZnNldCA9IDA7XG5cblx0XHRcdC8vIElmIHRhZyBuYW1lIHBhc3NlZCB0cmFuc2xhdGUgaW50byBoZXgga2V5XG5cdFx0XHRpZiAodHlwZW9mKHRhZykgPT09ICdzdHJpbmcnKSB7XG5cdFx0XHRcdHZhciB0bXBUYWdzID0gdGFnc1tpZmQudG9Mb3dlckNhc2UoKV07XG5cdFx0XHRcdGZvciAodmFyIGhleCBpbiB0bXBUYWdzKSB7XG5cdFx0XHRcdFx0aWYgKHRtcFRhZ3NbaGV4XSA9PT0gdGFnKSB7XG5cdFx0XHRcdFx0XHR0YWcgPSBoZXg7XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdG9mZnNldCA9IG9mZnNldHNbaWZkLnRvTG93ZXJDYXNlKCkgKyAnSUZEJ107XG5cdFx0XHRsZW5ndGggPSB0aGlzLlNIT1JUKG9mZnNldCk7XG5cblx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0dGFnT2Zmc2V0ID0gb2Zmc2V0ICsgMTIgKiBpICsgMjtcblxuXHRcdFx0XHRpZiAodGhpcy5TSE9SVCh0YWdPZmZzZXQpID09IHRhZykge1xuXHRcdFx0XHRcdHZhbHVlT2Zmc2V0ID0gdGFnT2Zmc2V0ICsgODtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRpZiAoIXZhbHVlT2Zmc2V0KSB7XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH1cblxuXHRcdFx0dHJ5IHtcblx0XHRcdFx0dGhpcy53cml0ZSh2YWx1ZU9mZnNldCwgdmFsdWUsIDQpO1xuXHRcdFx0fSBjYXRjaChleCkge1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblx0fVxuXG5cdEV4aWZQYXJzZXIucHJvdG90eXBlID0gQmluYXJ5UmVhZGVyLnByb3RvdHlwZTtcblxuXHRyZXR1cm4gRXhpZlBhcnNlcjtcbn0pO1xuXG4vLyBJbmNsdWRlZCBmcm9tOiBzcmMvamF2YXNjcmlwdC9ydW50aW1lL2h0bWw1L2ltYWdlL0pQRUcuanNcblxuLyoqXG4gKiBKUEVHLmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG5cbi8qKlxuQGNsYXNzIG1veGllL3J1bnRpbWUvaHRtbDUvaW1hZ2UvSlBFR1xuQHByaXZhdGVcbiovXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL2h0bWw1L2ltYWdlL0pQRUdcIiwgW1xuXHRcIm1veGllL2NvcmUvdXRpbHMvQmFzaWNcIixcblx0XCJtb3hpZS9jb3JlL0V4Y2VwdGlvbnNcIixcblx0XCJtb3hpZS9ydW50aW1lL2h0bWw1L2ltYWdlL0pQRUdIZWFkZXJzXCIsXG5cdFwibW94aWUvcnVudGltZS9odG1sNS91dGlscy9CaW5hcnlSZWFkZXJcIixcblx0XCJtb3hpZS9ydW50aW1lL2h0bWw1L2ltYWdlL0V4aWZQYXJzZXJcIlxuXSwgZnVuY3Rpb24oQmFzaWMsIHgsIEpQRUdIZWFkZXJzLCBCaW5hcnlSZWFkZXIsIEV4aWZQYXJzZXIpIHtcblx0XG5cdGZ1bmN0aW9uIEpQRUcoZGF0YSkge1xuXHRcdHZhciBfYnIsIF9obSwgX2VwLCBfaW5mbztcblxuXHRcdF9iciA9IG5ldyBCaW5hcnlSZWFkZXIoZGF0YSk7XG5cblx0XHQvLyBjaGVjayBpZiBpdCBpcyBqcGVnXG5cdFx0aWYgKF9ici5TSE9SVCgwKSAhPT0gMHhGRkQ4KSB7XG5cdFx0XHR0aHJvdyBuZXcgeC5JbWFnZUVycm9yKHguSW1hZ2VFcnJvci5XUk9OR19GT1JNQVQpO1xuXHRcdH1cblxuXHRcdC8vIGJhY2t1cCBoZWFkZXJzXG5cdFx0X2htID0gbmV3IEpQRUdIZWFkZXJzKGRhdGEpO1xuXG5cdFx0Ly8gZXh0cmFjdCBleGlmIGluZm9cblx0XHR0cnkge1xuXHRcdFx0X2VwID0gbmV3IEV4aWZQYXJzZXIoX2htLmdldCgnYXBwMScpWzBdKTtcblx0XHR9IGNhdGNoKGV4KSB7fVxuXG5cdFx0Ly8gZ2V0IGRpbWVuc2lvbnNcblx0XHRfaW5mbyA9IF9nZXREaW1lbnNpb25zLmNhbGwodGhpcyk7XG5cblx0XHRCYXNpYy5leHRlbmQodGhpcywge1xuXHRcdFx0dHlwZTogJ2ltYWdlL2pwZWcnLFxuXG5cdFx0XHRzaXplOiBfYnIubGVuZ3RoKCksXG5cblx0XHRcdHdpZHRoOiBfaW5mbyAmJiBfaW5mby53aWR0aCB8fCAwLFxuXG5cdFx0XHRoZWlnaHQ6IF9pbmZvICYmIF9pbmZvLmhlaWdodCB8fCAwLFxuXG5cdFx0XHRzZXRFeGlmOiBmdW5jdGlvbih0YWcsIHZhbHVlKSB7XG5cdFx0XHRcdGlmICghX2VwKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlOyAvLyBvciB0aHJvdyBhbiBleGNlcHRpb25cblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmIChCYXNpYy50eXBlT2YodGFnKSA9PT0gJ29iamVjdCcpIHtcblx0XHRcdFx0XHRCYXNpYy5lYWNoKHRhZywgZnVuY3Rpb24odmFsdWUsIHRhZykge1xuXHRcdFx0XHRcdFx0X2VwLnNldEV4aWYodGFnLCB2YWx1ZSk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0X2VwLnNldEV4aWYodGFnLCB2YWx1ZSk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyB1cGRhdGUgaW50ZXJuYWwgaGVhZGVyc1xuXHRcdFx0XHRfaG0uc2V0KCdhcHAxJywgX2VwLlNFR01FTlQoKSk7XG5cdFx0XHR9LFxuXG5cdFx0XHR3cml0ZUhlYWRlcnM6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRpZiAoIWFyZ3VtZW50cy5sZW5ndGgpIHtcblx0XHRcdFx0XHQvLyBpZiBubyBhcmd1bWVudHMgcGFzc2VkLCB1cGRhdGUgaGVhZGVycyBpbnRlcm5hbGx5XG5cdFx0XHRcdFx0cmV0dXJuIF9obS5yZXN0b3JlKGRhdGEpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiBfaG0ucmVzdG9yZShhcmd1bWVudHNbMF0pO1xuXHRcdFx0fSxcblxuXHRcdFx0c3RyaXBIZWFkZXJzOiBmdW5jdGlvbihkYXRhKSB7XG5cdFx0XHRcdHJldHVybiBfaG0uc3RyaXAoZGF0YSk7XG5cdFx0XHR9LFxuXG5cdFx0XHRwdXJnZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdF9wdXJnZS5jYWxsKHRoaXMpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0aWYgKF9lcCkge1xuXHRcdFx0dGhpcy5tZXRhID0ge1xuXHRcdFx0XHR0aWZmOiBfZXAuVElGRigpLFxuXHRcdFx0XHRleGlmOiBfZXAuRVhJRigpLFxuXHRcdFx0XHRncHM6IF9lcC5HUFMoKSxcblx0XHRcdFx0dGh1bWI6IF9nZXRUaHVtYigpXG5cdFx0XHR9O1xuXHRcdH1cblxuXG5cdFx0ZnVuY3Rpb24gX2dldERpbWVuc2lvbnMoYnIpIHtcblx0XHRcdHZhciBpZHggPSAwXG5cdFx0XHQsIG1hcmtlclxuXHRcdFx0LCBsZW5ndGhcblx0XHRcdDtcblxuXHRcdFx0aWYgKCFicikge1xuXHRcdFx0XHRiciA9IF9icjtcblx0XHRcdH1cblxuXHRcdFx0Ly8gZXhhbWluZSBhbGwgdGhyb3VnaCB0aGUgZW5kLCBzaW5jZSBzb21lIGltYWdlcyBtaWdodCBoYXZlIHZlcnkgbGFyZ2UgQVBQIHNlZ21lbnRzXG5cdFx0XHR3aGlsZSAoaWR4IDw9IGJyLmxlbmd0aCgpKSB7XG5cdFx0XHRcdG1hcmtlciA9IGJyLlNIT1JUKGlkeCArPSAyKTtcblxuXHRcdFx0XHRpZiAobWFya2VyID49IDB4RkZDMCAmJiBtYXJrZXIgPD0gMHhGRkMzKSB7IC8vIFNPRm5cblx0XHRcdFx0XHRpZHggKz0gNTsgLy8gbWFya2VyICgyIGJ5dGVzKSArIGxlbmd0aCAoMiBieXRlcykgKyBTYW1wbGUgcHJlY2lzaW9uICgxIGJ5dGUpXG5cdFx0XHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0XHRcdGhlaWdodDogYnIuU0hPUlQoaWR4KSxcblx0XHRcdFx0XHRcdHdpZHRoOiBici5TSE9SVChpZHggKz0gMilcblx0XHRcdFx0XHR9O1xuXHRcdFx0XHR9XG5cdFx0XHRcdGxlbmd0aCA9IGJyLlNIT1JUKGlkeCArPSAyKTtcblx0XHRcdFx0aWR4ICs9IGxlbmd0aCAtIDI7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cblxuXHRcdGZ1bmN0aW9uIF9nZXRUaHVtYigpIHtcblx0XHRcdHZhciBkYXRhID0gIF9lcC50aHVtYigpXG5cdFx0XHQsIGJyXG5cdFx0XHQsIGluZm9cblx0XHRcdDtcblxuXHRcdFx0aWYgKGRhdGEpIHtcblx0XHRcdFx0YnIgPSBuZXcgQmluYXJ5UmVhZGVyKGRhdGEpO1xuXHRcdFx0XHRpbmZvID0gX2dldERpbWVuc2lvbnMoYnIpO1xuXHRcdFx0XHRici5jbGVhcigpO1xuXG5cdFx0XHRcdGlmIChpbmZvKSB7XG5cdFx0XHRcdFx0aW5mby5kYXRhID0gZGF0YTtcblx0XHRcdFx0XHRyZXR1cm4gaW5mbztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXG5cblx0XHRmdW5jdGlvbiBfcHVyZ2UoKSB7XG5cdFx0XHRpZiAoIV9lcCB8fCAhX2htIHx8ICFfYnIpIHsgXG5cdFx0XHRcdHJldHVybjsgLy8gaWdub3JlIGFueSByZXBlYXRpbmcgcHVyZ2UgcmVxdWVzdHNcblx0XHRcdH1cblx0XHRcdF9lcC5jbGVhcigpO1xuXHRcdFx0X2htLnB1cmdlKCk7XG5cdFx0XHRfYnIuY2xlYXIoKTtcblx0XHRcdF9pbmZvID0gX2htID0gX2VwID0gX2JyID0gbnVsbDtcblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gSlBFRztcbn0pO1xuXG4vLyBJbmNsdWRlZCBmcm9tOiBzcmMvamF2YXNjcmlwdC9ydW50aW1lL2h0bWw1L2ltYWdlL1BORy5qc1xuXG4vKipcbiAqIFBORy5qc1xuICpcbiAqIENvcHlyaWdodCAyMDEzLCBNb3hpZWNvZGUgU3lzdGVtcyBBQlxuICogUmVsZWFzZWQgdW5kZXIgR1BMIExpY2Vuc2UuXG4gKlxuICogTGljZW5zZTogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vbGljZW5zZVxuICogQ29udHJpYnV0aW5nOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9jb250cmlidXRpbmdcbiAqL1xuXG4vKipcbkBjbGFzcyBtb3hpZS9ydW50aW1lL2h0bWw1L2ltYWdlL1BOR1xuQHByaXZhdGVcbiovXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL2h0bWw1L2ltYWdlL1BOR1wiLCBbXG5cdFwibW94aWUvY29yZS9FeGNlcHRpb25zXCIsXG5cdFwibW94aWUvY29yZS91dGlscy9CYXNpY1wiLFxuXHRcIm1veGllL3J1bnRpbWUvaHRtbDUvdXRpbHMvQmluYXJ5UmVhZGVyXCJcbl0sIGZ1bmN0aW9uKHgsIEJhc2ljLCBCaW5hcnlSZWFkZXIpIHtcblx0XG5cdGZ1bmN0aW9uIFBORyhkYXRhKSB7XG5cdFx0dmFyIF9iciwgX2htLCBfZXAsIF9pbmZvO1xuXG5cdFx0X2JyID0gbmV3IEJpbmFyeVJlYWRlcihkYXRhKTtcblxuXHRcdC8vIGNoZWNrIGlmIGl0J3MgcG5nXG5cdFx0KGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIGlkeCA9IDAsIGkgPSAwXG5cdFx0XHQsIHNpZ25hdHVyZSA9IFsweDg5NTAsIDB4NEU0NywgMHgwRDBBLCAweDFBMEFdXG5cdFx0XHQ7XG5cblx0XHRcdGZvciAoaSA9IDA7IGkgPCBzaWduYXR1cmUubGVuZ3RoOyBpKyssIGlkeCArPSAyKSB7XG5cdFx0XHRcdGlmIChzaWduYXR1cmVbaV0gIT0gX2JyLlNIT1JUKGlkeCkpIHtcblx0XHRcdFx0XHR0aHJvdyBuZXcgeC5JbWFnZUVycm9yKHguSW1hZ2VFcnJvci5XUk9OR19GT1JNQVQpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSgpKTtcblxuXHRcdGZ1bmN0aW9uIF9nZXREaW1lbnNpb25zKCkge1xuXHRcdFx0dmFyIGNodW5rLCBpZHg7XG5cblx0XHRcdGNodW5rID0gX2dldENodW5rQXQuY2FsbCh0aGlzLCA4KTtcblxuXHRcdFx0aWYgKGNodW5rLnR5cGUgPT0gJ0lIRFInKSB7XG5cdFx0XHRcdGlkeCA9IGNodW5rLnN0YXJ0O1xuXHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdHdpZHRoOiBfYnIuTE9ORyhpZHgpLFxuXHRcdFx0XHRcdGhlaWdodDogX2JyLkxPTkcoaWR4ICs9IDQpXG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cblx0XHRmdW5jdGlvbiBfcHVyZ2UoKSB7XG5cdFx0XHRpZiAoIV9icikge1xuXHRcdFx0XHRyZXR1cm47IC8vIGlnbm9yZSBhbnkgcmVwZWF0aW5nIHB1cmdlIHJlcXVlc3RzXG5cdFx0XHR9XG5cdFx0XHRfYnIuY2xlYXIoKTtcblx0XHRcdGRhdGEgPSBfaW5mbyA9IF9obSA9IF9lcCA9IF9iciA9IG51bGw7XG5cdFx0fVxuXG5cdFx0X2luZm8gPSBfZ2V0RGltZW5zaW9ucy5jYWxsKHRoaXMpO1xuXG5cdFx0QmFzaWMuZXh0ZW5kKHRoaXMsIHtcblx0XHRcdHR5cGU6ICdpbWFnZS9wbmcnLFxuXG5cdFx0XHRzaXplOiBfYnIubGVuZ3RoKCksXG5cblx0XHRcdHdpZHRoOiBfaW5mby53aWR0aCxcblxuXHRcdFx0aGVpZ2h0OiBfaW5mby5oZWlnaHQsXG5cblx0XHRcdHB1cmdlOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0X3B1cmdlLmNhbGwodGhpcyk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHQvLyBmb3IgUE5HIHdlIGNhbiBzYWZlbHkgdHJpZ2dlciBwdXJnZSBhdXRvbWF0aWNhbGx5LCBhcyB3ZSBkbyBub3Qga2VlcCBhbnkgZGF0YSBmb3IgbGF0ZXJcblx0XHRfcHVyZ2UuY2FsbCh0aGlzKTtcblxuXHRcdGZ1bmN0aW9uIF9nZXRDaHVua0F0KGlkeCkge1xuXHRcdFx0dmFyIGxlbmd0aCwgdHlwZSwgc3RhcnQsIENSQztcblxuXHRcdFx0bGVuZ3RoID0gX2JyLkxPTkcoaWR4KTtcblx0XHRcdHR5cGUgPSBfYnIuU1RSSU5HKGlkeCArPSA0LCA0KTtcblx0XHRcdHN0YXJ0ID0gaWR4ICs9IDQ7XG5cdFx0XHRDUkMgPSBfYnIuTE9ORyhpZHggKyBsZW5ndGgpO1xuXG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRsZW5ndGg6IGxlbmd0aCxcblx0XHRcdFx0dHlwZTogdHlwZSxcblx0XHRcdFx0c3RhcnQ6IHN0YXJ0LFxuXHRcdFx0XHRDUkM6IENSQ1xuXHRcdFx0fTtcblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gUE5HO1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L3J1bnRpbWUvaHRtbDUvaW1hZ2UvSW1hZ2VJbmZvLmpzXG5cbi8qKlxuICogSW1hZ2VJbmZvLmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG5cbi8qKlxuT3B0aW9uYWwgaW1hZ2UgaW52ZXN0aWdhdGlvbiB0b29sIGZvciBIVE1MNSBydW50aW1lLiBQcm92aWRlcyB0aGUgZm9sbG93aW5nIGZlYXR1cmVzOlxuLSBhYmlsaXR5IHRvIGRpc3Rpbmd1aXNoIGltYWdlIHR5cGUgKEpQRUcgb3IgUE5HKSBieSBzaWduYXR1cmVcbi0gYWJpbGl0eSB0byBleHRyYWN0IGltYWdlIHdpZHRoL2hlaWdodCBkaXJlY3RseSBmcm9tIGl0J3MgaW50ZXJuYWxzLCB3aXRob3V0IHByZWxvYWRpbmcgaW4gbWVtb3J5IChmYXN0KVxuLSBhYmlsaXR5IHRvIGV4dHJhY3QgQVBQIGhlYWRlcnMgZnJvbSBKUEVHcyAoRXhpZiwgR1BTLCBldGMpXG4tIGFiaWxpdHkgdG8gcmVwbGFjZSB3aWR0aC9oZWlnaHQgdGFncyBpbiBleHRyYWN0ZWQgSlBFRyBoZWFkZXJzXG4tIGFiaWxpdHkgdG8gcmVzdG9yZSBBUFAgaGVhZGVycywgdGhhdCB3ZXJlIGZvciBleGFtcGxlIHN0cmlwcGVkIGR1cmluZyBpbWFnZSBtYW5pcHVsYXRpb25cblxuQGNsYXNzIG1veGllL3J1bnRpbWUvaHRtbDUvaW1hZ2UvSW1hZ2VJbmZvXG5AcHJpdmF0ZVxuQHBhcmFtIHtTdHJpbmd9IGRhdGEgSW1hZ2Ugc291cmNlIGFzIGJpbmFyeSBzdHJpbmdcbiovXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL2h0bWw1L2ltYWdlL0ltYWdlSW5mb1wiLCBbXG5cdFwibW94aWUvY29yZS91dGlscy9CYXNpY1wiLFxuXHRcIm1veGllL2NvcmUvRXhjZXB0aW9uc1wiLFxuXHRcIm1veGllL3J1bnRpbWUvaHRtbDUvaW1hZ2UvSlBFR1wiLFxuXHRcIm1veGllL3J1bnRpbWUvaHRtbDUvaW1hZ2UvUE5HXCJcbl0sIGZ1bmN0aW9uKEJhc2ljLCB4LCBKUEVHLCBQTkcpIHtcblxuXHRyZXR1cm4gZnVuY3Rpb24oZGF0YSkge1xuXHRcdHZhciBfY3MgPSBbSlBFRywgUE5HXSwgX2ltZztcblxuXHRcdC8vIGZpZ3VyZSBvdXQgdGhlIGZvcm1hdCwgdGhyb3c6IEltYWdlRXJyb3IuV1JPTkdfRk9STUFUIGlmIG5vdCBzdXBwb3J0ZWRcblx0XHRfaW1nID0gKGZ1bmN0aW9uKCkge1xuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBfY3MubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRyZXR1cm4gbmV3IF9jc1tpXShkYXRhKTtcblx0XHRcdFx0fSBjYXRjaCAoZXgpIHtcblx0XHRcdFx0XHQvLyBjb25zb2xlLmluZm8oZXgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHR0aHJvdyBuZXcgeC5JbWFnZUVycm9yKHguSW1hZ2VFcnJvci5XUk9OR19GT1JNQVQpO1xuXHRcdH0oKSk7XG5cblx0XHRCYXNpYy5leHRlbmQodGhpcywge1xuXHRcdFx0LyoqXG5cdFx0XHRJbWFnZSBNaW1lIFR5cGUgZXh0cmFjdGVkIGZyb20gaXQncyBkZXB0aHNcblxuXHRcdFx0QHByb3BlcnR5IHR5cGVcblx0XHRcdEB0eXBlIHtTdHJpbmd9XG5cdFx0XHRAZGVmYXVsdCAnJ1xuXHRcdFx0Ki9cblx0XHRcdHR5cGU6ICcnLFxuXG5cdFx0XHQvKipcblx0XHRcdEltYWdlIHNpemUgaW4gYnl0ZXNcblxuXHRcdFx0QHByb3BlcnR5IHNpemVcblx0XHRcdEB0eXBlIHtOdW1iZXJ9XG5cdFx0XHRAZGVmYXVsdCAwXG5cdFx0XHQqL1xuXHRcdFx0c2l6ZTogMCxcblxuXHRcdFx0LyoqXG5cdFx0XHRJbWFnZSB3aWR0aCBleHRyYWN0ZWQgZnJvbSBpbWFnZSBzb3VyY2VcblxuXHRcdFx0QHByb3BlcnR5IHdpZHRoXG5cdFx0XHRAdHlwZSB7TnVtYmVyfVxuXHRcdFx0QGRlZmF1bHQgMFxuXHRcdFx0Ki9cblx0XHRcdHdpZHRoOiAwLFxuXG5cdFx0XHQvKipcblx0XHRcdEltYWdlIGhlaWdodCBleHRyYWN0ZWQgZnJvbSBpbWFnZSBzb3VyY2VcblxuXHRcdFx0QHByb3BlcnR5IGhlaWdodFxuXHRcdFx0QHR5cGUge051bWJlcn1cblx0XHRcdEBkZWZhdWx0IDBcblx0XHRcdCovXG5cdFx0XHRoZWlnaHQ6IDAsXG5cblx0XHRcdC8qKlxuXHRcdFx0U2V0cyBFeGlmIHRhZy4gQ3VycmVudGx5IGFwcGxpY2FibGUgb25seSBmb3Igd2lkdGggYW5kIGhlaWdodCB0YWdzLiBPYnZpb3VzbHkgd29ya3Mgb25seSB3aXRoIEpQRUdzLlxuXG5cdFx0XHRAbWV0aG9kIHNldEV4aWZcblx0XHRcdEBwYXJhbSB7U3RyaW5nfSB0YWcgVGFnIHRvIHNldFxuXHRcdFx0QHBhcmFtIHtNaXhlZH0gdmFsdWUgVmFsdWUgdG8gYXNzaWduIHRvIHRoZSB0YWdcblx0XHRcdCovXG5cdFx0XHRzZXRFeGlmOiBmdW5jdGlvbigpIHt9LFxuXG5cdFx0XHQvKipcblx0XHRcdFJlc3RvcmVzIGhlYWRlcnMgdG8gdGhlIHNvdXJjZS5cblxuXHRcdFx0QG1ldGhvZCB3cml0ZUhlYWRlcnNcblx0XHRcdEBwYXJhbSB7U3RyaW5nfSBkYXRhIEltYWdlIHNvdXJjZSBhcyBiaW5hcnkgc3RyaW5nXG5cdFx0XHRAcmV0dXJuIHtTdHJpbmd9IFVwZGF0ZWQgYmluYXJ5IHN0cmluZ1xuXHRcdFx0Ki9cblx0XHRcdHdyaXRlSGVhZGVyczogZnVuY3Rpb24oZGF0YSkge1xuXHRcdFx0XHRyZXR1cm4gZGF0YTtcblx0XHRcdH0sXG5cblx0XHRcdC8qKlxuXHRcdFx0U3RyaXAgYWxsIGhlYWRlcnMgZnJvbSB0aGUgc291cmNlLlxuXG5cdFx0XHRAbWV0aG9kIHN0cmlwSGVhZGVyc1xuXHRcdFx0QHBhcmFtIHtTdHJpbmd9IGRhdGEgSW1hZ2Ugc291cmNlIGFzIGJpbmFyeSBzdHJpbmdcblx0XHRcdEByZXR1cm4ge1N0cmluZ30gVXBkYXRlZCBiaW5hcnkgc3RyaW5nXG5cdFx0XHQqL1xuXHRcdFx0c3RyaXBIZWFkZXJzOiBmdW5jdGlvbihkYXRhKSB7XG5cdFx0XHRcdHJldHVybiBkYXRhO1xuXHRcdFx0fSxcblxuXHRcdFx0LyoqXG5cdFx0XHREaXNwb3NlIHJlc291cmNlcy5cblxuXHRcdFx0QG1ldGhvZCBwdXJnZVxuXHRcdFx0Ki9cblx0XHRcdHB1cmdlOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0ZGF0YSA9IG51bGw7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRCYXNpYy5leHRlbmQodGhpcywgX2ltZyk7XG5cblx0XHR0aGlzLnB1cmdlID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRfaW1nLnB1cmdlKCk7XG5cdFx0XHRfaW1nID0gbnVsbDtcblx0XHR9O1xuXHR9O1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L3J1bnRpbWUvaHRtbDUvaW1hZ2UvUmVzaXplckNhbnZhcy5qc1xuXG4vKipcbiAqIFJlc2l6ZXJDYW52YXMuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuLyoqXG4gKiBSZXNpemVzIGltYWdlL2NhbnZhcyB1c2luZyBjYW52YXNcbiAqL1xuZGVmaW5lKFwibW94aWUvcnVudGltZS9odG1sNS9pbWFnZS9SZXNpemVyQ2FudmFzXCIsIFtdLCBmdW5jdGlvbigpIHtcblxuICAgIGZ1bmN0aW9uIHNjYWxlKGltYWdlLCByYXRpbywgcmVzYW1wbGUpIHtcbiAgICAgICAgdmFyIHNEID0gaW1hZ2Uud2lkdGggPiBpbWFnZS5oZWlnaHQgPyAnd2lkdGgnIDogJ2hlaWdodCc7IC8vIHRha2UgdGhlIGxhcmdlc3Qgc2lkZVxuICAgICAgICB2YXIgZEQgPSBNYXRoLnJvdW5kKGltYWdlW3NEXSAqIHJhdGlvKTtcbiAgICAgICAgdmFyIHNjYWxlQ2FwcGVkID0gZmFsc2U7XG5cbiAgICAgICAgaWYgKHJlc2FtcGxlICE9PSAnbmVhcmVzdCcgJiYgKHJhdGlvIDwgMC41IHx8IHJhdGlvID4gMikpIHtcbiAgICAgICAgICAgIHJhdGlvID0gcmF0aW8gPCAwLjUgPyAwLjUgOiAyO1xuICAgICAgICAgICAgc2NhbGVDYXBwZWQgPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHRDYW52YXMgPSBfc2NhbGUoaW1hZ2UsIHJhdGlvKTtcblxuICAgICAgICBpZiAoc2NhbGVDYXBwZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBzY2FsZSh0Q2FudmFzLCBkRCAvIHRDYW52YXNbc0RdLCByZXNhbXBsZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdENhbnZhcztcbiAgICAgICAgfVxuICAgIH1cblxuXG4gICAgZnVuY3Rpb24gX3NjYWxlKGltYWdlLCByYXRpbykge1xuICAgICAgICB2YXIgc1cgPSBpbWFnZS53aWR0aDtcbiAgICAgICAgdmFyIHNIID0gaW1hZ2UuaGVpZ2h0O1xuICAgICAgICB2YXIgZFcgPSBNYXRoLnJvdW5kKHNXICogcmF0aW8pO1xuICAgICAgICB2YXIgZEggPSBNYXRoLnJvdW5kKHNIICogcmF0aW8pO1xuXG4gICAgICAgIHZhciBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcbiAgICAgICAgY2FudmFzLndpZHRoID0gZFc7XG4gICAgICAgIGNhbnZhcy5oZWlnaHQgPSBkSDtcbiAgICAgICAgY2FudmFzLmdldENvbnRleHQoXCIyZFwiKS5kcmF3SW1hZ2UoaW1hZ2UsIDAsIDAsIHNXLCBzSCwgMCwgMCwgZFcsIGRIKTtcblxuICAgICAgICBpbWFnZSA9IG51bGw7IC8vIGp1c3QgaW4gY2FzZVxuICAgICAgICByZXR1cm4gY2FudmFzO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICAgIHNjYWxlOiBzY2FsZVxuICAgIH07XG5cbn0pO1xuXG4vLyBJbmNsdWRlZCBmcm9tOiBzcmMvamF2YXNjcmlwdC9ydW50aW1lL2h0bWw1L2ltYWdlL0ltYWdlLmpzXG5cbi8qKlxuICogSW1hZ2UuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuLyoqXG5AY2xhc3MgbW94aWUvcnVudGltZS9odG1sNS9pbWFnZS9JbWFnZVxuQHByaXZhdGVcbiovXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL2h0bWw1L2ltYWdlL0ltYWdlXCIsIFtcblx0XCJtb3hpZS9ydW50aW1lL2h0bWw1L1J1bnRpbWVcIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCIsXG5cdFwibW94aWUvY29yZS9FeGNlcHRpb25zXCIsXG5cdFwibW94aWUvY29yZS91dGlscy9FbmNvZGVcIixcblx0XCJtb3hpZS9maWxlL0Jsb2JcIixcblx0XCJtb3hpZS9maWxlL0ZpbGVcIixcblx0XCJtb3hpZS9ydW50aW1lL2h0bWw1L2ltYWdlL0ltYWdlSW5mb1wiLFxuXHRcIm1veGllL3J1bnRpbWUvaHRtbDUvaW1hZ2UvUmVzaXplckNhbnZhc1wiLFxuXHRcIm1veGllL2NvcmUvdXRpbHMvTWltZVwiLFxuXHRcIm1veGllL2NvcmUvdXRpbHMvRW52XCJcbl0sIGZ1bmN0aW9uKGV4dGVuc2lvbnMsIEJhc2ljLCB4LCBFbmNvZGUsIEJsb2IsIEZpbGUsIEltYWdlSW5mbywgUmVzaXplckNhbnZhcywgTWltZSwgRW52KSB7XG5cblx0ZnVuY3Rpb24gSFRNTDVJbWFnZSgpIHtcblx0XHR2YXIgbWUgPSB0aGlzXG5cdFx0LCBfaW1nLCBfaW1nSW5mbywgX2NhbnZhcywgX2JpblN0ciwgX2Jsb2Jcblx0XHQsIF9tb2RpZmllZCA9IGZhbHNlIC8vIGlzIHNldCB0cnVlIHdoZW5ldmVyIGltYWdlIGlzIG1vZGlmaWVkXG5cdFx0LCBfcHJlc2VydmVIZWFkZXJzID0gdHJ1ZVxuXHRcdDtcblxuXHRcdEJhc2ljLmV4dGVuZCh0aGlzLCB7XG5cdFx0XHRsb2FkRnJvbUJsb2I6IGZ1bmN0aW9uKGJsb2IpIHtcblx0XHRcdFx0dmFyIEkgPSB0aGlzLmdldFJ1bnRpbWUoKVxuXHRcdFx0XHQsIGFzQmluYXJ5ID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHNbMV0gOiB0cnVlXG5cdFx0XHRcdDtcblxuXHRcdFx0XHRpZiAoIUkuY2FuKCdhY2Nlc3NfYmluYXJ5JykpIHtcblx0XHRcdFx0XHR0aHJvdyBuZXcgeC5SdW50aW1lRXJyb3IoeC5SdW50aW1lRXJyb3IuTk9UX1NVUFBPUlRFRF9FUlIpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0X2Jsb2IgPSBibG9iO1xuXG5cdFx0XHRcdGlmIChibG9iLmlzRGV0YWNoZWQoKSkge1xuXHRcdFx0XHRcdF9iaW5TdHIgPSBibG9iLmdldFNvdXJjZSgpO1xuXHRcdFx0XHRcdF9wcmVsb2FkLmNhbGwodGhpcywgX2JpblN0cik7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdF9yZWFkQXNEYXRhVXJsLmNhbGwodGhpcywgYmxvYi5nZXRTb3VyY2UoKSwgZnVuY3Rpb24oZGF0YVVybCkge1xuXHRcdFx0XHRcdFx0aWYgKGFzQmluYXJ5KSB7XG5cdFx0XHRcdFx0XHRcdF9iaW5TdHIgPSBfdG9CaW5hcnkoZGF0YVVybCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRfcHJlbG9hZC5jYWxsKHRoaXMsIGRhdGFVcmwpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXG5cdFx0XHRsb2FkRnJvbUltYWdlOiBmdW5jdGlvbihpbWcsIGV4YWN0KSB7XG5cdFx0XHRcdHRoaXMubWV0YSA9IGltZy5tZXRhO1xuXG5cdFx0XHRcdF9ibG9iID0gbmV3IEZpbGUobnVsbCwge1xuXHRcdFx0XHRcdG5hbWU6IGltZy5uYW1lLFxuXHRcdFx0XHRcdHNpemU6IGltZy5zaXplLFxuXHRcdFx0XHRcdHR5cGU6IGltZy50eXBlXG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdF9wcmVsb2FkLmNhbGwodGhpcywgZXhhY3QgPyAoX2JpblN0ciA9IGltZy5nZXRBc0JpbmFyeVN0cmluZygpKSA6IGltZy5nZXRBc0RhdGFVUkwoKSk7XG5cdFx0XHR9LFxuXG5cdFx0XHRnZXRJbmZvOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIEkgPSB0aGlzLmdldFJ1bnRpbWUoKSwgaW5mbztcblxuXHRcdFx0XHRpZiAoIV9pbWdJbmZvICYmIF9iaW5TdHIgJiYgSS5jYW4oJ2FjY2Vzc19pbWFnZV9iaW5hcnknKSkge1xuXHRcdFx0XHRcdF9pbWdJbmZvID0gbmV3IEltYWdlSW5mbyhfYmluU3RyKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIHRoaXMgc3R1ZmYgYmVsb3cgaXMgZGVmaW5pdGVseSBoYXZpbmcgZnVuIHdpdGggaXRzZWxmXG5cdFx0XHRcdGluZm8gPSB7XG5cdFx0XHRcdFx0d2lkdGg6IF9nZXRJbWcoKS53aWR0aCB8fCAwLFxuXHRcdFx0XHRcdGhlaWdodDogX2dldEltZygpLmhlaWdodCB8fCAwLFxuXHRcdFx0XHRcdHR5cGU6IF9ibG9iLnR5cGUgfHwgTWltZS5nZXRGaWxlTWltZShfYmxvYi5uYW1lKSxcblx0XHRcdFx0XHRzaXplOiBfYmluU3RyICYmIF9iaW5TdHIubGVuZ3RoIHx8IF9ibG9iLnNpemUgfHwgMCxcblx0XHRcdFx0XHRuYW1lOiBfYmxvYi5uYW1lIHx8ICcnLFxuXHRcdFx0XHRcdG1ldGE6IG51bGxcblx0XHRcdFx0fTtcblxuXHRcdFx0XHRpZiAoX3ByZXNlcnZlSGVhZGVycykge1xuXHRcdFx0XHRcdGluZm8ubWV0YSA9IF9pbWdJbmZvICYmIF9pbWdJbmZvLm1ldGEgfHwgdGhpcy5tZXRhIHx8IHt9O1xuXG5cdFx0XHRcdFx0Ly8gaWYgZGF0YSB3YXMgdGFrZW4gZnJvbSBJbWFnZUluZm8gaXQgd2lsbCBiZSBhIGJpbmFyeSBzdHJpbmcsIHNvIHdlIGNvbnZlcnQgaXQgdG8gYmxvYlxuXHRcdFx0XHRcdGlmIChpbmZvLm1ldGEgJiYgaW5mby5tZXRhLnRodW1iICYmICEoaW5mby5tZXRhLnRodW1iLmRhdGEgaW5zdGFuY2VvZiBCbG9iKSkge1xuXHRcdFx0XHRcdFx0aW5mby5tZXRhLnRodW1iLmRhdGEgPSBuZXcgQmxvYihudWxsLCB7XG5cdFx0XHRcdFx0XHRcdHR5cGU6ICdpbWFnZS9qcGVnJyxcblx0XHRcdFx0XHRcdFx0ZGF0YTogaW5mby5tZXRhLnRodW1iLmRhdGFcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdHJldHVybiBpbmZvO1xuXHRcdFx0fSxcblxuXG5cdFx0XHRyZXNpemU6IGZ1bmN0aW9uKHJlY3QsIHJhdGlvLCBvcHRpb25zKSB7XG5cdFx0XHRcdHZhciBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcblx0XHRcdFx0Y2FudmFzLndpZHRoID0gcmVjdC53aWR0aDtcblx0XHRcdFx0Y2FudmFzLmhlaWdodCA9IHJlY3QuaGVpZ2h0O1xuXG5cdFx0XHRcdGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIikuZHJhd0ltYWdlKF9nZXRJbWcoKSwgcmVjdC54LCByZWN0LnksIHJlY3Qud2lkdGgsIHJlY3QuaGVpZ2h0LCAwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpO1xuXG5cdFx0XHRcdF9jYW52YXMgPSBSZXNpemVyQ2FudmFzLnNjYWxlKGNhbnZhcywgcmF0aW8pO1xuXG5cdFx0XHRcdF9wcmVzZXJ2ZUhlYWRlcnMgPSBvcHRpb25zLnByZXNlcnZlSGVhZGVycztcblxuXHRcdFx0XHQvLyByb3RhdGUgaWYgcmVxdWlyZWQsIGFjY29yZGluZyB0byBvcmllbnRhdGlvbiB0YWdcblx0XHRcdFx0aWYgKCFfcHJlc2VydmVIZWFkZXJzKSB7XG5cdFx0XHRcdFx0dmFyIG9yaWVudGF0aW9uID0gKHRoaXMubWV0YSAmJiB0aGlzLm1ldGEudGlmZiAmJiB0aGlzLm1ldGEudGlmZi5PcmllbnRhdGlvbikgfHwgMTtcblx0XHRcdFx0XHRfY2FudmFzID0gX3JvdGF0ZVRvT3JpZW50YWlvbihfY2FudmFzLCBvcmllbnRhdGlvbik7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR0aGlzLndpZHRoID0gX2NhbnZhcy53aWR0aDtcblx0XHRcdFx0dGhpcy5oZWlnaHQgPSBfY2FudmFzLmhlaWdodDtcblxuXHRcdFx0XHRfbW9kaWZpZWQgPSB0cnVlO1xuXG5cdFx0XHRcdHRoaXMudHJpZ2dlcignUmVzaXplJyk7XG5cdFx0XHR9LFxuXG5cdFx0XHRnZXRBc0NhbnZhczogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGlmICghX2NhbnZhcykge1xuXHRcdFx0XHRcdF9jYW52YXMgPSBfZ2V0Q2FudmFzKCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0X2NhbnZhcy5pZCA9IHRoaXMudWlkICsgJ19jYW52YXMnO1xuXHRcdFx0XHRyZXR1cm4gX2NhbnZhcztcblx0XHRcdH0sXG5cblx0XHRcdGdldEFzQmxvYjogZnVuY3Rpb24odHlwZSwgcXVhbGl0eSkge1xuXHRcdFx0XHRpZiAodHlwZSAhPT0gdGhpcy50eXBlKSB7XG5cdFx0XHRcdFx0X21vZGlmaWVkID0gdHJ1ZTsgLy8gcmVjb25zaWRlciB0aGUgc3RhdGVcblx0XHRcdFx0XHRyZXR1cm4gbmV3IEZpbGUobnVsbCwge1xuXHRcdFx0XHRcdFx0bmFtZTogX2Jsb2IubmFtZSB8fCAnJyxcblx0XHRcdFx0XHRcdHR5cGU6IHR5cGUsXG5cdFx0XHRcdFx0XHRkYXRhOiBtZS5nZXRBc0RhdGFVUkwodHlwZSwgcXVhbGl0eSlcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gbmV3IEZpbGUobnVsbCwge1xuXHRcdFx0XHRcdG5hbWU6IF9ibG9iLm5hbWUgfHwgJycsXG5cdFx0XHRcdFx0dHlwZTogdHlwZSxcblx0XHRcdFx0XHRkYXRhOiBtZS5nZXRBc0JpbmFyeVN0cmluZyh0eXBlLCBxdWFsaXR5KVxuXHRcdFx0XHR9KTtcblx0XHRcdH0sXG5cblx0XHRcdGdldEFzRGF0YVVSTDogZnVuY3Rpb24odHlwZSkge1xuXHRcdFx0XHR2YXIgcXVhbGl0eSA9IGFyZ3VtZW50c1sxXSB8fCA5MDtcblxuXHRcdFx0XHQvLyBpZiBpbWFnZSBoYXMgbm90IGJlZW4gbW9kaWZpZWQsIHJldHVybiB0aGUgc291cmNlIHJpZ2h0IGF3YXlcblx0XHRcdFx0aWYgKCFfbW9kaWZpZWQpIHtcblx0XHRcdFx0XHRyZXR1cm4gX2ltZy5zcmM7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBtYWtlIHN1cmUgd2UgaGF2ZSBhIGNhbnZhcyB0byB3b3JrIHdpdGhcblx0XHRcdFx0X2dldENhbnZhcygpO1xuXG5cdFx0XHRcdGlmICgnaW1hZ2UvanBlZycgIT09IHR5cGUpIHtcblx0XHRcdFx0XHRyZXR1cm4gX2NhbnZhcy50b0RhdGFVUkwoJ2ltYWdlL3BuZycpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHQvLyBvbGRlciBHZWNrb3MgdXNlZCB0byByZXN1bHQgaW4gYW4gZXhjZXB0aW9uIG9uIHF1YWxpdHkgYXJndW1lbnRcblx0XHRcdFx0XHRcdHJldHVybiBfY2FudmFzLnRvRGF0YVVSTCgnaW1hZ2UvanBlZycsIHF1YWxpdHkvMTAwKTtcblx0XHRcdFx0XHR9IGNhdGNoIChleCkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIF9jYW52YXMudG9EYXRhVVJMKCdpbWFnZS9qcGVnJyk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXG5cdFx0XHRnZXRBc0JpbmFyeVN0cmluZzogZnVuY3Rpb24odHlwZSwgcXVhbGl0eSkge1xuXHRcdFx0XHQvLyBpZiBpbWFnZSBoYXMgbm90IGJlZW4gbW9kaWZpZWQsIHJldHVybiB0aGUgc291cmNlIHJpZ2h0IGF3YXlcblx0XHRcdFx0aWYgKCFfbW9kaWZpZWQpIHtcblx0XHRcdFx0XHQvLyBpZiBpbWFnZSB3YXMgbm90IGxvYWRlZCBmcm9tIGJpbmFyeSBzdHJpbmdcblx0XHRcdFx0XHRpZiAoIV9iaW5TdHIpIHtcblx0XHRcdFx0XHRcdF9iaW5TdHIgPSBfdG9CaW5hcnkobWUuZ2V0QXNEYXRhVVJMKHR5cGUsIHF1YWxpdHkpKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cmV0dXJuIF9iaW5TdHI7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoJ2ltYWdlL2pwZWcnICE9PSB0eXBlKSB7XG5cdFx0XHRcdFx0X2JpblN0ciA9IF90b0JpbmFyeShtZS5nZXRBc0RhdGFVUkwodHlwZSwgcXVhbGl0eSkpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHZhciBkYXRhVXJsO1xuXG5cdFx0XHRcdFx0Ly8gaWYganBlZ1xuXHRcdFx0XHRcdGlmICghcXVhbGl0eSkge1xuXHRcdFx0XHRcdFx0cXVhbGl0eSA9IDkwO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8vIG1ha2Ugc3VyZSB3ZSBoYXZlIGEgY2FudmFzIHRvIHdvcmsgd2l0aFxuXHRcdFx0XHRcdF9nZXRDYW52YXMoKTtcblxuXHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHQvLyBvbGRlciBHZWNrb3MgdXNlZCB0byByZXN1bHQgaW4gYW4gZXhjZXB0aW9uIG9uIHF1YWxpdHkgYXJndW1lbnRcblx0XHRcdFx0XHRcdGRhdGFVcmwgPSBfY2FudmFzLnRvRGF0YVVSTCgnaW1hZ2UvanBlZycsIHF1YWxpdHkvMTAwKTtcblx0XHRcdFx0XHR9IGNhdGNoIChleCkge1xuXHRcdFx0XHRcdFx0ZGF0YVVybCA9IF9jYW52YXMudG9EYXRhVVJMKCdpbWFnZS9qcGVnJyk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0X2JpblN0ciA9IF90b0JpbmFyeShkYXRhVXJsKTtcblxuXHRcdFx0XHRcdGlmIChfaW1nSW5mbykge1xuXHRcdFx0XHRcdFx0X2JpblN0ciA9IF9pbWdJbmZvLnN0cmlwSGVhZGVycyhfYmluU3RyKTtcblxuXHRcdFx0XHRcdFx0aWYgKF9wcmVzZXJ2ZUhlYWRlcnMpIHtcblx0XHRcdFx0XHRcdFx0Ly8gdXBkYXRlIGRpbWVuc2lvbnMgaW5mbyBpbiBleGlmXG5cdFx0XHRcdFx0XHRcdGlmIChfaW1nSW5mby5tZXRhICYmIF9pbWdJbmZvLm1ldGEuZXhpZikge1xuXHRcdFx0XHRcdFx0XHRcdF9pbWdJbmZvLnNldEV4aWYoe1xuXHRcdFx0XHRcdFx0XHRcdFx0UGl4ZWxYRGltZW5zaW9uOiB0aGlzLndpZHRoLFxuXHRcdFx0XHRcdFx0XHRcdFx0UGl4ZWxZRGltZW5zaW9uOiB0aGlzLmhlaWdodFxuXHRcdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0Ly8gcmUtaW5qZWN0IHRoZSBoZWFkZXJzXG5cdFx0XHRcdFx0XHRcdF9iaW5TdHIgPSBfaW1nSW5mby53cml0ZUhlYWRlcnMoX2JpblN0cik7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdC8vIHdpbGwgYmUgcmUtY3JlYXRlZCBmcm9tIGZyZXNoIG9uIG5leHQgZ2V0SW5mbyBjYWxsXG5cdFx0XHRcdFx0XHRfaW1nSW5mby5wdXJnZSgpO1xuXHRcdFx0XHRcdFx0X2ltZ0luZm8gPSBudWxsO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdF9tb2RpZmllZCA9IGZhbHNlO1xuXG5cdFx0XHRcdHJldHVybiBfYmluU3RyO1xuXHRcdFx0fSxcblxuXHRcdFx0ZGVzdHJveTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdG1lID0gbnVsbDtcblx0XHRcdFx0X3B1cmdlLmNhbGwodGhpcyk7XG5cdFx0XHRcdHRoaXMuZ2V0UnVudGltZSgpLmdldFNoaW0oKS5yZW1vdmVJbnN0YW5jZSh0aGlzLnVpZCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblxuXHRcdGZ1bmN0aW9uIF9nZXRJbWcoKSB7XG5cdFx0XHRpZiAoIV9jYW52YXMgJiYgIV9pbWcpIHtcblx0XHRcdFx0dGhyb3cgbmV3IHguSW1hZ2VFcnJvcih4LkRPTUV4Y2VwdGlvbi5JTlZBTElEX1NUQVRFX0VSUik7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gX2NhbnZhcyB8fCBfaW1nO1xuXHRcdH1cblxuXG5cdFx0ZnVuY3Rpb24gX2dldENhbnZhcygpIHtcblx0XHRcdHZhciBjYW52YXMgPSBfZ2V0SW1nKCk7XG5cdFx0XHRpZiAoY2FudmFzLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT0gJ2NhbnZhcycpIHtcblx0XHRcdFx0cmV0dXJuIGNhbnZhcztcblx0XHRcdH1cblx0XHRcdF9jYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcblx0XHRcdF9jYW52YXMud2lkdGggPSBjYW52YXMud2lkdGg7XG5cdFx0XHRfY2FudmFzLmhlaWdodCA9IGNhbnZhcy5oZWlnaHQ7XG5cdFx0XHRfY2FudmFzLmdldENvbnRleHQoXCIyZFwiKS5kcmF3SW1hZ2UoY2FudmFzLCAwLCAwKTtcblx0XHRcdHJldHVybiBfY2FudmFzO1xuXHRcdH1cblxuXG5cdFx0ZnVuY3Rpb24gX3RvQmluYXJ5KHN0cikge1xuXHRcdFx0cmV0dXJuIEVuY29kZS5hdG9iKHN0ci5zdWJzdHJpbmcoc3RyLmluZGV4T2YoJ2Jhc2U2NCwnKSArIDcpKTtcblx0XHR9XG5cblxuXHRcdGZ1bmN0aW9uIF90b0RhdGFVcmwoc3RyLCB0eXBlKSB7XG5cdFx0XHRyZXR1cm4gJ2RhdGE6JyArICh0eXBlIHx8ICcnKSArICc7YmFzZTY0LCcgKyBFbmNvZGUuYnRvYShzdHIpO1xuXHRcdH1cblxuXG5cdFx0ZnVuY3Rpb24gX3ByZWxvYWQoc3RyKSB7XG5cdFx0XHR2YXIgY29tcCA9IHRoaXM7XG5cblx0XHRcdF9pbWcgPSBuZXcgSW1hZ2UoKTtcblx0XHRcdF9pbWcub25lcnJvciA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRfcHVyZ2UuY2FsbCh0aGlzKTtcblx0XHRcdFx0Y29tcC50cmlnZ2VyKCdlcnJvcicsIHguSW1hZ2VFcnJvci5XUk9OR19GT1JNQVQpO1xuXHRcdFx0fTtcblx0XHRcdF9pbWcub25sb2FkID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGNvbXAudHJpZ2dlcignbG9hZCcpO1xuXHRcdFx0fTtcblxuXHRcdFx0X2ltZy5zcmMgPSBzdHIuc3Vic3RyKDAsIDUpID09ICdkYXRhOicgPyBzdHIgOiBfdG9EYXRhVXJsKHN0ciwgX2Jsb2IudHlwZSk7XG5cdFx0fVxuXG5cblx0XHRmdW5jdGlvbiBfcmVhZEFzRGF0YVVybChmaWxlLCBjYWxsYmFjaykge1xuXHRcdFx0dmFyIGNvbXAgPSB0aGlzLCBmcjtcblxuXHRcdFx0Ly8gdXNlIEZpbGVSZWFkZXIgaWYgaXQncyBhdmFpbGFibGVcblx0XHRcdGlmICh3aW5kb3cuRmlsZVJlYWRlcikge1xuXHRcdFx0XHRmciA9IG5ldyBGaWxlUmVhZGVyKCk7XG5cdFx0XHRcdGZyLm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdGNhbGxiYWNrLmNhbGwoY29tcCwgdGhpcy5yZXN1bHQpO1xuXHRcdFx0XHR9O1xuXHRcdFx0XHRmci5vbmVycm9yID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0Y29tcC50cmlnZ2VyKCdlcnJvcicsIHguSW1hZ2VFcnJvci5XUk9OR19GT1JNQVQpO1xuXHRcdFx0XHR9O1xuXHRcdFx0XHRmci5yZWFkQXNEYXRhVVJMKGZpbGUpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmV0dXJuIGNhbGxiYWNrLmNhbGwodGhpcywgZmlsZS5nZXRBc0RhdGFVUkwoKSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0LyoqXG5cdFx0KiBUcmFuc2Zvcm0gY2FudmFzIGNvb3JkaW5hdGlvbiBhY2NvcmRpbmcgdG8gc3BlY2lmaWVkIGZyYW1lIHNpemUgYW5kIG9yaWVudGF0aW9uXG5cdFx0KiBPcmllbnRhdGlvbiB2YWx1ZSBpcyBmcm9tIEVYSUYgdGFnXG5cdFx0KiBAYXV0aG9yIFNoaW5pY2hpIFRvbWl0YSA8c2hpbmljaGkudG9taXRhQGdtYWlsLmNvbT5cblx0XHQqL1xuXHRcdGZ1bmN0aW9uIF9yb3RhdGVUb09yaWVudGFpb24oaW1nLCBvcmllbnRhdGlvbikge1xuXHRcdFx0dmFyIFJBRElBTlMgPSBNYXRoLlBJLzE4MDtcblx0XHRcdHZhciBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcblx0XHRcdHZhciBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcblx0XHRcdHZhciB3aWR0aCA9IGltZy53aWR0aDtcblx0XHRcdHZhciBoZWlnaHQgPSBpbWcuaGVpZ2h0O1xuXG5cdFx0XHRpZiAoQmFzaWMuaW5BcnJheShvcmllbnRhdGlvbiwgWzUsNiw3LDhdKSA+IC0xKSB7XG5cdFx0XHRcdGNhbnZhcy53aWR0aCA9IGhlaWdodDtcblx0XHRcdFx0Y2FudmFzLmhlaWdodCA9IHdpZHRoO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y2FudmFzLndpZHRoID0gd2lkdGg7XG5cdFx0XHRcdGNhbnZhcy5oZWlnaHQgPSBoZWlnaHQ7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0MSA9IFRoZSAwdGggcm93IGlzIGF0IHRoZSB2aXN1YWwgdG9wIG9mIHRoZSBpbWFnZSwgYW5kIHRoZSAwdGggY29sdW1uIGlzIHRoZSB2aXN1YWwgbGVmdC1oYW5kIHNpZGUuXG5cdFx0XHQyID0gVGhlIDB0aCByb3cgaXMgYXQgdGhlIHZpc3VhbCB0b3Agb2YgdGhlIGltYWdlLCBhbmQgdGhlIDB0aCBjb2x1bW4gaXMgdGhlIHZpc3VhbCByaWdodC1oYW5kIHNpZGUuXG5cdFx0XHQzID0gVGhlIDB0aCByb3cgaXMgYXQgdGhlIHZpc3VhbCBib3R0b20gb2YgdGhlIGltYWdlLCBhbmQgdGhlIDB0aCBjb2x1bW4gaXMgdGhlIHZpc3VhbCByaWdodC1oYW5kIHNpZGUuXG5cdFx0XHQ0ID0gVGhlIDB0aCByb3cgaXMgYXQgdGhlIHZpc3VhbCBib3R0b20gb2YgdGhlIGltYWdlLCBhbmQgdGhlIDB0aCBjb2x1bW4gaXMgdGhlIHZpc3VhbCBsZWZ0LWhhbmQgc2lkZS5cblx0XHRcdDUgPSBUaGUgMHRoIHJvdyBpcyB0aGUgdmlzdWFsIGxlZnQtaGFuZCBzaWRlIG9mIHRoZSBpbWFnZSwgYW5kIHRoZSAwdGggY29sdW1uIGlzIHRoZSB2aXN1YWwgdG9wLlxuXHRcdFx0NiA9IFRoZSAwdGggcm93IGlzIHRoZSB2aXN1YWwgcmlnaHQtaGFuZCBzaWRlIG9mIHRoZSBpbWFnZSwgYW5kIHRoZSAwdGggY29sdW1uIGlzIHRoZSB2aXN1YWwgdG9wLlxuXHRcdFx0NyA9IFRoZSAwdGggcm93IGlzIHRoZSB2aXN1YWwgcmlnaHQtaGFuZCBzaWRlIG9mIHRoZSBpbWFnZSwgYW5kIHRoZSAwdGggY29sdW1uIGlzIHRoZSB2aXN1YWwgYm90dG9tLlxuXHRcdFx0OCA9IFRoZSAwdGggcm93IGlzIHRoZSB2aXN1YWwgbGVmdC1oYW5kIHNpZGUgb2YgdGhlIGltYWdlLCBhbmQgdGhlIDB0aCBjb2x1bW4gaXMgdGhlIHZpc3VhbCBib3R0b20uXG5cdFx0XHQqL1xuXHRcdFx0c3dpdGNoIChvcmllbnRhdGlvbikge1xuXHRcdFx0XHRjYXNlIDI6XG5cdFx0XHRcdFx0Ly8gaG9yaXpvbnRhbCBmbGlwXG5cdFx0XHRcdFx0Y3R4LnRyYW5zbGF0ZSh3aWR0aCwgMCk7XG5cdFx0XHRcdFx0Y3R4LnNjYWxlKC0xLCAxKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAzOlxuXHRcdFx0XHRcdC8vIDE4MCByb3RhdGUgbGVmdFxuXHRcdFx0XHRcdGN0eC50cmFuc2xhdGUod2lkdGgsIGhlaWdodCk7XG5cdFx0XHRcdFx0Y3R4LnJvdGF0ZSgxODAgKiBSQURJQU5TKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSA0OlxuXHRcdFx0XHRcdC8vIHZlcnRpY2FsIGZsaXBcblx0XHRcdFx0XHRjdHgudHJhbnNsYXRlKDAsIGhlaWdodCk7XG5cdFx0XHRcdFx0Y3R4LnNjYWxlKDEsIC0xKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSA1OlxuXHRcdFx0XHRcdC8vIHZlcnRpY2FsIGZsaXAgKyA5MCByb3RhdGUgcmlnaHRcblx0XHRcdFx0XHRjdHgucm90YXRlKDkwICogUkFESUFOUyk7XG5cdFx0XHRcdFx0Y3R4LnNjYWxlKDEsIC0xKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSA2OlxuXHRcdFx0XHRcdC8vIDkwIHJvdGF0ZSByaWdodFxuXHRcdFx0XHRcdGN0eC5yb3RhdGUoOTAgKiBSQURJQU5TKTtcblx0XHRcdFx0XHRjdHgudHJhbnNsYXRlKDAsIC1oZWlnaHQpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlIDc6XG5cdFx0XHRcdFx0Ly8gaG9yaXpvbnRhbCBmbGlwICsgOTAgcm90YXRlIHJpZ2h0XG5cdFx0XHRcdFx0Y3R4LnJvdGF0ZSg5MCAqIFJBRElBTlMpO1xuXHRcdFx0XHRcdGN0eC50cmFuc2xhdGUod2lkdGgsIC1oZWlnaHQpO1xuXHRcdFx0XHRcdGN0eC5zY2FsZSgtMSwgMSk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgODpcblx0XHRcdFx0XHQvLyA5MCByb3RhdGUgbGVmdFxuXHRcdFx0XHRcdGN0eC5yb3RhdGUoLTkwICogUkFESUFOUyk7XG5cdFx0XHRcdFx0Y3R4LnRyYW5zbGF0ZSgtd2lkdGgsIDApO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXG5cdFx0XHRjdHguZHJhd0ltYWdlKGltZywgMCwgMCwgd2lkdGgsIGhlaWdodCk7XG5cdFx0XHRyZXR1cm4gY2FudmFzO1xuXHRcdH1cblxuXG5cdFx0ZnVuY3Rpb24gX3B1cmdlKCkge1xuXHRcdFx0aWYgKF9pbWdJbmZvKSB7XG5cdFx0XHRcdF9pbWdJbmZvLnB1cmdlKCk7XG5cdFx0XHRcdF9pbWdJbmZvID0gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0X2JpblN0ciA9IF9pbWcgPSBfY2FudmFzID0gX2Jsb2IgPSBudWxsO1xuXHRcdFx0X21vZGlmaWVkID0gZmFsc2U7XG5cdFx0fVxuXHR9XG5cblx0cmV0dXJuIChleHRlbnNpb25zLkltYWdlID0gSFRNTDVJbWFnZSk7XG59KTtcblxuLy8gSW5jbHVkZWQgZnJvbTogc3JjL2phdmFzY3JpcHQvcnVudGltZS9mbGFzaC9SdW50aW1lLmpzXG5cbi8qKlxuICogUnVudGltZS5qc1xuICpcbiAqIENvcHlyaWdodCAyMDEzLCBNb3hpZWNvZGUgU3lzdGVtcyBBQlxuICogUmVsZWFzZWQgdW5kZXIgR1BMIExpY2Vuc2UuXG4gKlxuICogTGljZW5zZTogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vbGljZW5zZVxuICogQ29udHJpYnV0aW5nOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9jb250cmlidXRpbmdcbiAqL1xuXG4vKmdsb2JhbCBBY3RpdmVYT2JqZWN0OnRydWUgKi9cblxuLyoqXG5EZWZpbmVzIGNvbnN0cnVjdG9yIGZvciBGbGFzaCBydW50aW1lLlxuXG5AY2xhc3MgbW94aWUvcnVudGltZS9mbGFzaC9SdW50aW1lXG5AcHJpdmF0ZVxuKi9cbmRlZmluZShcIm1veGllL3J1bnRpbWUvZmxhc2gvUnVudGltZVwiLCBbXG5cdFwibW94aWUvY29yZS91dGlscy9CYXNpY1wiLFxuXHRcIm1veGllL2NvcmUvdXRpbHMvRW52XCIsXG5cdFwibW94aWUvY29yZS91dGlscy9Eb21cIixcblx0XCJtb3hpZS9jb3JlL0V4Y2VwdGlvbnNcIixcblx0XCJtb3hpZS9ydW50aW1lL1J1bnRpbWVcIlxuXSwgZnVuY3Rpb24oQmFzaWMsIEVudiwgRG9tLCB4LCBSdW50aW1lKSB7XG5cdFxuXHR2YXIgdHlwZSA9ICdmbGFzaCcsIGV4dGVuc2lvbnMgPSB7fTtcblxuXHQvKipcblx0R2V0IHRoZSB2ZXJzaW9uIG9mIHRoZSBGbGFzaCBQbGF5ZXJcblxuXHRAbWV0aG9kIGdldFNoaW1WZXJzaW9uXG5cdEBwcml2YXRlXG5cdEByZXR1cm4ge051bWJlcn0gRmxhc2ggUGxheWVyIHZlcnNpb25cblx0Ki9cblx0ZnVuY3Rpb24gZ2V0U2hpbVZlcnNpb24oKSB7XG5cdFx0dmFyIHZlcnNpb247XG5cblx0XHR0cnkge1xuXHRcdFx0dmVyc2lvbiA9IG5hdmlnYXRvci5wbHVnaW5zWydTaG9ja3dhdmUgRmxhc2gnXTtcblx0XHRcdHZlcnNpb24gPSB2ZXJzaW9uLmRlc2NyaXB0aW9uO1xuXHRcdH0gY2F0Y2ggKGUxKSB7XG5cdFx0XHR0cnkge1xuXHRcdFx0XHR2ZXJzaW9uID0gbmV3IEFjdGl2ZVhPYmplY3QoJ1Nob2Nrd2F2ZUZsYXNoLlNob2Nrd2F2ZUZsYXNoJykuR2V0VmFyaWFibGUoJyR2ZXJzaW9uJyk7XG5cdFx0XHR9IGNhdGNoIChlMikge1xuXHRcdFx0XHR2ZXJzaW9uID0gJzAuMCc7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHZlcnNpb24gPSB2ZXJzaW9uLm1hdGNoKC9cXGQrL2cpO1xuXHRcdHJldHVybiBwYXJzZUZsb2F0KHZlcnNpb25bMF0gKyAnLicgKyB2ZXJzaW9uWzFdKTtcblx0fVxuXG5cblx0LyoqXG5cdENyb3NzLWJyb3dzZXIgU1dGIHJlbW92YWxcbiAgICBcdC0gRXNwZWNpYWxseSBuZWVkZWQgdG8gc2FmZWx5IGFuZCBjb21wbGV0ZWx5IHJlbW92ZSBhIFNXRiBpbiBJbnRlcm5ldCBFeHBsb3JlclxuXG4gICBcdE9yaWdpbmF0ZWQgZnJvbSBTV0ZPYmplY3QgdjIuMiA8aHR0cDovL2NvZGUuZ29vZ2xlLmNvbS9wL3N3Zm9iamVjdC8+IFxuXHQqL1xuXHRmdW5jdGlvbiByZW1vdmVTV0YoaWQpIHtcbiAgICAgICAgdmFyIG9iaiA9IERvbS5nZXQoaWQpO1xuICAgICAgICBpZiAob2JqICYmIG9iai5ub2RlTmFtZSA9PSBcIk9CSkVDVFwiKSB7XG4gICAgICAgICAgICBpZiAoRW52LmJyb3dzZXIgPT09ICdJRScpIHtcbiAgICAgICAgICAgICAgICBvYmouc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgICAgICAgICAgICAgIChmdW5jdGlvbiBvbkluaXQoKXtcbiAgICAgICAgICAgICAgICBcdC8vIGh0dHA6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS9pZS9tczUzNDM2MCh2PXZzLjg1KS5hc3B4XG4gICAgICAgICAgICAgICAgICAgIGlmIChvYmoucmVhZHlTdGF0ZSA9PSA0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVPYmplY3RJbklFKGlkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQob25Jbml0LCAxMCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgb2JqLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQob2JqKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuXG5cdGZ1bmN0aW9uIHJlbW92ZU9iamVjdEluSUUoaWQpIHtcbiAgICAgICAgdmFyIG9iaiA9IERvbS5nZXQoaWQpO1xuICAgICAgICBpZiAob2JqKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpIGluIG9iaikge1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygb2JqW2ldID09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgICAgICBvYmpbaV0gPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG9iai5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG9iaik7XG4gICAgICAgIH1cbiAgICB9XG5cblx0LyoqXG5cdENvbnN0cnVjdG9yIGZvciB0aGUgRmxhc2ggUnVudGltZVxuXHQqL1xuXHRmdW5jdGlvbiBGbGFzaFJ1bnRpbWUob3B0aW9ucykge1xuXHRcdHZhciBJID0gdGhpcywgaW5pdFRpbWVyO1xuXG5cdFx0b3B0aW9ucyA9IEJhc2ljLmV4dGVuZCh7IHN3Zl91cmw6IEVudi5zd2ZfdXJsIH0sIG9wdGlvbnMpO1xuXG5cdFx0UnVudGltZS5jYWxsKHRoaXMsIG9wdGlvbnMsIHR5cGUsIHtcblx0XHRcdGFjY2Vzc19iaW5hcnk6IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdFx0XHRcdHJldHVybiB2YWx1ZSAmJiBJLm1vZGUgPT09ICdicm93c2VyJztcblx0XHRcdH0sXG5cdFx0XHRhY2Nlc3NfaW1hZ2VfYmluYXJ5OiBmdW5jdGlvbih2YWx1ZSkge1xuXHRcdFx0XHRyZXR1cm4gdmFsdWUgJiYgSS5tb2RlID09PSAnYnJvd3Nlcic7XG5cdFx0XHR9LFxuXHRcdFx0ZGlzcGxheV9tZWRpYTogUnVudGltZS5jYXBUZXN0KGRlZmluZWQoJ21veGllL2ltYWdlL0ltYWdlJykpLFxuXHRcdFx0ZG9fY29yczogUnVudGltZS5jYXBUcnVlLFxuXHRcdFx0ZHJhZ19hbmRfZHJvcDogZmFsc2UsXG5cdFx0XHRyZXBvcnRfdXBsb2FkX3Byb2dyZXNzOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIEkubW9kZSA9PT0gJ2NsaWVudCc7XG5cdFx0XHR9LFxuXHRcdFx0cmVzaXplX2ltYWdlOiBSdW50aW1lLmNhcFRydWUsXG5cdFx0XHRyZXR1cm5fcmVzcG9uc2VfaGVhZGVyczogZmFsc2UsXG5cdFx0XHRyZXR1cm5fcmVzcG9uc2VfdHlwZTogZnVuY3Rpb24ocmVzcG9uc2VUeXBlKSB7XG5cdFx0XHRcdGlmIChyZXNwb25zZVR5cGUgPT09ICdqc29uJyAmJiAhIXdpbmRvdy5KU09OKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdH0gXG5cdFx0XHRcdHJldHVybiAhQmFzaWMuYXJyYXlEaWZmKHJlc3BvbnNlVHlwZSwgWycnLCAndGV4dCcsICdkb2N1bWVudCddKSB8fCBJLm1vZGUgPT09ICdicm93c2VyJztcblx0XHRcdH0sXG5cdFx0XHRyZXR1cm5fc3RhdHVzX2NvZGU6IGZ1bmN0aW9uKGNvZGUpIHtcblx0XHRcdFx0cmV0dXJuIEkubW9kZSA9PT0gJ2Jyb3dzZXInIHx8ICFCYXNpYy5hcnJheURpZmYoY29kZSwgWzIwMCwgNDA0XSk7XG5cdFx0XHR9LFxuXHRcdFx0c2VsZWN0X2ZpbGU6IFJ1bnRpbWUuY2FwVHJ1ZSxcblx0XHRcdHNlbGVjdF9tdWx0aXBsZTogUnVudGltZS5jYXBUcnVlLFxuXHRcdFx0c2VuZF9iaW5hcnlfc3RyaW5nOiBmdW5jdGlvbih2YWx1ZSkge1xuXHRcdFx0XHRyZXR1cm4gdmFsdWUgJiYgSS5tb2RlID09PSAnYnJvd3Nlcic7XG5cdFx0XHR9LFxuXHRcdFx0c2VuZF9icm93c2VyX2Nvb2tpZXM6IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdFx0XHRcdHJldHVybiB2YWx1ZSAmJiBJLm1vZGUgPT09ICdicm93c2VyJztcblx0XHRcdH0sXG5cdFx0XHRzZW5kX2N1c3RvbV9oZWFkZXJzOiBmdW5jdGlvbih2YWx1ZSkge1xuXHRcdFx0XHRyZXR1cm4gdmFsdWUgJiYgSS5tb2RlID09PSAnYnJvd3Nlcic7XG5cdFx0XHR9LFxuXHRcdFx0c2VuZF9tdWx0aXBhcnQ6IFJ1bnRpbWUuY2FwVHJ1ZSxcblx0XHRcdHNsaWNlX2Jsb2I6IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdFx0XHRcdHJldHVybiB2YWx1ZSAmJiBJLm1vZGUgPT09ICdicm93c2VyJztcblx0XHRcdH0sXG5cdFx0XHRzdHJlYW1fdXBsb2FkOiBmdW5jdGlvbih2YWx1ZSkge1xuXHRcdFx0XHRyZXR1cm4gdmFsdWUgJiYgSS5tb2RlID09PSAnYnJvd3Nlcic7XG5cdFx0XHR9LFxuXHRcdFx0c3VtbW9uX2ZpbGVfZGlhbG9nOiBmYWxzZSxcblx0XHRcdHVwbG9hZF9maWxlc2l6ZTogZnVuY3Rpb24oc2l6ZSkge1xuXHRcdFx0XHRyZXR1cm4gQmFzaWMucGFyc2VTaXplU3RyKHNpemUpIDw9IDIwOTcxNTIgfHwgSS5tb2RlID09PSAnY2xpZW50Jztcblx0XHRcdH0sXG5cdFx0XHR1c2VfaHR0cF9tZXRob2Q6IGZ1bmN0aW9uKG1ldGhvZHMpIHtcblx0XHRcdFx0cmV0dXJuICFCYXNpYy5hcnJheURpZmYobWV0aG9kcywgWydHRVQnLCAnUE9TVCddKTtcblx0XHRcdH1cblx0XHR9LCB7IFxuXHRcdFx0Ly8gY2FwYWJpbGl0aWVzIHRoYXQgcmVxdWlyZSBzcGVjaWZpYyBtb2RlXG5cdFx0XHRhY2Nlc3NfYmluYXJ5OiBmdW5jdGlvbih2YWx1ZSkge1xuXHRcdFx0XHRyZXR1cm4gdmFsdWUgPyAnYnJvd3NlcicgOiAnY2xpZW50Jztcblx0XHRcdH0sXG5cdFx0XHRhY2Nlc3NfaW1hZ2VfYmluYXJ5OiBmdW5jdGlvbih2YWx1ZSkge1xuXHRcdFx0XHRyZXR1cm4gdmFsdWUgPyAnYnJvd3NlcicgOiAnY2xpZW50Jztcblx0XHRcdH0sXG5cdFx0XHRyZXBvcnRfdXBsb2FkX3Byb2dyZXNzOiBmdW5jdGlvbih2YWx1ZSkge1xuXHRcdFx0XHRyZXR1cm4gdmFsdWUgPyAnYnJvd3NlcicgOiAnY2xpZW50Jztcblx0XHRcdH0sXG5cdFx0XHRyZXR1cm5fcmVzcG9uc2VfdHlwZTogZnVuY3Rpb24ocmVzcG9uc2VUeXBlKSB7XG5cdFx0XHRcdHJldHVybiBCYXNpYy5hcnJheURpZmYocmVzcG9uc2VUeXBlLCBbJycsICd0ZXh0JywgJ2pzb24nLCAnZG9jdW1lbnQnXSkgPyAnYnJvd3NlcicgOiBbJ2NsaWVudCcsICdicm93c2VyJ107XG5cdFx0XHR9LFxuXHRcdFx0cmV0dXJuX3N0YXR1c19jb2RlOiBmdW5jdGlvbihjb2RlKSB7XG5cdFx0XHRcdHJldHVybiBCYXNpYy5hcnJheURpZmYoY29kZSwgWzIwMCwgNDA0XSkgPyAnYnJvd3NlcicgOiBbJ2NsaWVudCcsICdicm93c2VyJ107XG5cdFx0XHR9LFxuXHRcdFx0c2VuZF9iaW5hcnlfc3RyaW5nOiBmdW5jdGlvbih2YWx1ZSkge1xuXHRcdFx0XHRyZXR1cm4gdmFsdWUgPyAnYnJvd3NlcicgOiAnY2xpZW50Jztcblx0XHRcdH0sXG5cdFx0XHRzZW5kX2Jyb3dzZXJfY29va2llczogZnVuY3Rpb24odmFsdWUpIHtcblx0XHRcdFx0cmV0dXJuIHZhbHVlID8gJ2Jyb3dzZXInIDogJ2NsaWVudCc7XG5cdFx0XHR9LFxuXHRcdFx0c2VuZF9jdXN0b21faGVhZGVyczogZnVuY3Rpb24odmFsdWUpIHtcblx0XHRcdFx0cmV0dXJuIHZhbHVlID8gJ2Jyb3dzZXInIDogJ2NsaWVudCc7XG5cdFx0XHR9LFxuXHRcdFx0c2xpY2VfYmxvYjogZnVuY3Rpb24odmFsdWUpIHtcblx0XHRcdFx0cmV0dXJuIHZhbHVlID8gJ2Jyb3dzZXInIDogJ2NsaWVudCc7XG5cdFx0XHR9LFxuXHRcdFx0c3RyZWFtX3VwbG9hZDogZnVuY3Rpb24odmFsdWUpIHtcblx0XHRcdFx0cmV0dXJuIHZhbHVlID8gJ2NsaWVudCcgOiAnYnJvd3Nlcic7XG5cdFx0XHR9LFxuXHRcdFx0dXBsb2FkX2ZpbGVzaXplOiBmdW5jdGlvbihzaXplKSB7XG5cdFx0XHRcdHJldHVybiBCYXNpYy5wYXJzZVNpemVTdHIoc2l6ZSkgPj0gMjA5NzE1MiA/ICdjbGllbnQnIDogJ2Jyb3dzZXInO1xuXHRcdFx0fVxuXHRcdH0sICdjbGllbnQnKTtcblxuXG5cdFx0Ly8gbWluaW1hbCByZXF1aXJlbWVudCBmb3IgRmxhc2ggUGxheWVyIHZlcnNpb25cblx0XHRpZiAoZ2V0U2hpbVZlcnNpb24oKSA8IDExLjMpIHtcblx0XHRcdGlmIChNWElfREVCVUcgJiYgRW52LmRlYnVnLnJ1bnRpbWUpIHtcblx0XHRcdFx0RW52LmxvZyhcIlxcdEZsYXNoIGRpZG4ndCBtZWV0IG1pbmltYWwgdmVyc2lvbiByZXF1aXJlbWVudCAoMTEuMykuXCIpO1x0XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMubW9kZSA9IGZhbHNlOyAvLyB3aXRoIGZhbHN5IG1vZGUsIHJ1bnRpbWUgd29uJ3Qgb3BlcmFibGUsIG5vIG1hdHRlciB3aGF0IHRoZSBtb2RlIHdhcyBiZWZvcmVcblx0XHR9XG5cblxuXHRcdEJhc2ljLmV4dGVuZCh0aGlzLCB7XG5cblx0XHRcdGdldFNoaW06IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gRG9tLmdldCh0aGlzLnVpZCk7XG5cdFx0XHR9LFxuXG5cdFx0XHRzaGltRXhlYzogZnVuY3Rpb24oY29tcG9uZW50LCBhY3Rpb24pIHtcblx0XHRcdFx0dmFyIGFyZ3MgPSBbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMik7XG5cdFx0XHRcdHJldHVybiBJLmdldFNoaW0oKS5leGVjKHRoaXMudWlkLCBjb21wb25lbnQsIGFjdGlvbiwgYXJncyk7XG5cdFx0XHR9LFxuXG5cdFx0XHRpbml0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIGh0bWwsIGVsLCBjb250YWluZXI7XG5cblx0XHRcdFx0Y29udGFpbmVyID0gdGhpcy5nZXRTaGltQ29udGFpbmVyKCk7XG5cblx0XHRcdFx0Ly8gaWYgbm90IHRoZSBtaW5pbWFsIGhlaWdodCwgc2hpbXMgYXJlIG5vdCBpbml0aWFsaXplZCBpbiBvbGRlciBicm93c2VycyAoZS5nIEZGMy42LCBJRTYsNyw4LCBTYWZhcmkgNC4wLDUuMCwgZXRjKVxuXHRcdFx0XHRCYXNpYy5leHRlbmQoY29udGFpbmVyLnN0eWxlLCB7XG5cdFx0XHRcdFx0cG9zaXRpb246ICdhYnNvbHV0ZScsXG5cdFx0XHRcdFx0dG9wOiAnLThweCcsXG5cdFx0XHRcdFx0bGVmdDogJy04cHgnLFxuXHRcdFx0XHRcdHdpZHRoOiAnOXB4Jyxcblx0XHRcdFx0XHRoZWlnaHQ6ICc5cHgnLFxuXHRcdFx0XHRcdG92ZXJmbG93OiAnaGlkZGVuJ1xuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHQvLyBpbnNlcnQgZmxhc2ggb2JqZWN0XG5cdFx0XHRcdGh0bWwgPSAnPG9iamVjdCBpZD1cIicgKyB0aGlzLnVpZCArICdcIiB0eXBlPVwiYXBwbGljYXRpb24veC1zaG9ja3dhdmUtZmxhc2hcIiBkYXRhPVwiJyArICBvcHRpb25zLnN3Zl91cmwgKyAnXCIgJztcblxuXHRcdFx0XHRpZiAoRW52LmJyb3dzZXIgPT09ICdJRScpIHtcblx0XHRcdFx0XHRodG1sICs9ICdjbGFzc2lkPVwiY2xzaWQ6ZDI3Y2RiNmUtYWU2ZC0xMWNmLTk2YjgtNDQ0NTUzNTQwMDAwXCIgJztcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGh0bWwgKz0gJ3dpZHRoPVwiMTAwJVwiIGhlaWdodD1cIjEwMCVcIiBzdHlsZT1cIm91dGxpbmU6MFwiPicgICtcblx0XHRcdFx0XHQnPHBhcmFtIG5hbWU9XCJtb3ZpZVwiIHZhbHVlPVwiJyArIG9wdGlvbnMuc3dmX3VybCArICdcIiAvPicgK1xuXHRcdFx0XHRcdCc8cGFyYW0gbmFtZT1cImZsYXNodmFyc1wiIHZhbHVlPVwidWlkPScgKyBlc2NhcGUodGhpcy51aWQpICsgJyZ0YXJnZXQ9JyArIFJ1bnRpbWUuZ2V0R2xvYmFsRXZlbnRUYXJnZXQoKSArICdcIiAvPicgK1xuXHRcdFx0XHRcdCc8cGFyYW0gbmFtZT1cIndtb2RlXCIgdmFsdWU9XCJ0cmFuc3BhcmVudFwiIC8+JyArXG5cdFx0XHRcdFx0JzxwYXJhbSBuYW1lPVwiYWxsb3dzY3JpcHRhY2Nlc3NcIiB2YWx1ZT1cImFsd2F5c1wiIC8+JyArXG5cdFx0XHRcdCc8L29iamVjdD4nO1xuXG5cdFx0XHRcdGlmIChFbnYuYnJvd3NlciA9PT0gJ0lFJykge1xuXHRcdFx0XHRcdGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0XHRcdFx0Y29udGFpbmVyLmFwcGVuZENoaWxkKGVsKTtcblx0XHRcdFx0XHRlbC5vdXRlckhUTUwgPSBodG1sO1xuXHRcdFx0XHRcdGVsID0gY29udGFpbmVyID0gbnVsbDsgLy8ganVzdCBpbiBjYXNlXG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Y29udGFpbmVyLmlubmVySFRNTCA9IGh0bWw7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBJbml0IGlzIGRpc3BhdGNoZWQgYnkgdGhlIHNoaW1cblx0XHRcdFx0aW5pdFRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRpZiAoSSAmJiAhSS5pbml0aWFsaXplZCkgeyAvLyBydW50aW1lIG1pZ2h0IGJlIGFscmVhZHkgZGVzdHJveWVkIGJ5IHRoaXMgbW9tZW50XG5cdFx0XHRcdFx0XHRJLnRyaWdnZXIoXCJFcnJvclwiLCBuZXcgeC5SdW50aW1lRXJyb3IoeC5SdW50aW1lRXJyb3IuTk9UX0lOSVRfRVJSKSk7XG5cblx0XHRcdFx0XHRcdGlmIChNWElfREVCVUcgJiYgRW52LmRlYnVnLnJ1bnRpbWUpIHtcblx0XHRcdFx0XHRcdFx0RW52LmxvZyhcIlxcdEZsYXNoIGZhaWxlZCB0byBpbml0aWFsaXplIHdpdGhpbiBhIHNwZWNpZmllZCBwZXJpb2Qgb2YgdGltZSAodHlwaWNhbGx5IDVzKS5cIik7XHRcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0sIDUwMDApO1xuXHRcdFx0fSxcblxuXHRcdFx0ZGVzdHJveTogKGZ1bmN0aW9uKGRlc3Ryb3kpIHsgLy8gZXh0ZW5kIGRlZmF1bHQgZGVzdHJveSBtZXRob2Rcblx0XHRcdFx0cmV0dXJuIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdHJlbW92ZVNXRihJLnVpZCk7IC8vIFNXRiByZW1vdmFsIHJlcXVpcmVzIHNwZWNpYWwgY2FyZSBpbiBJRVxuXG5cdFx0XHRcdFx0ZGVzdHJveS5jYWxsKEkpO1xuXHRcdFx0XHRcdGNsZWFyVGltZW91dChpbml0VGltZXIpOyAvLyBpbml0aWFsaXphdGlvbiBjaGVjayBtaWdodCBiZSBzdGlsbCBvbndhaXRcblx0XHRcdFx0XHRvcHRpb25zID0gaW5pdFRpbWVyID0gZGVzdHJveSA9IEkgPSBudWxsO1xuXHRcdFx0XHR9O1xuXHRcdFx0fSh0aGlzLmRlc3Ryb3kpKVxuXG5cdFx0fSwgZXh0ZW5zaW9ucyk7XG5cdH1cblxuXHRSdW50aW1lLmFkZENvbnN0cnVjdG9yKHR5cGUsIEZsYXNoUnVudGltZSk7XG5cblx0cmV0dXJuIGV4dGVuc2lvbnM7XG59KTtcblxuLy8gSW5jbHVkZWQgZnJvbTogc3JjL2phdmFzY3JpcHQvcnVudGltZS9mbGFzaC9maWxlL0Jsb2IuanNcblxuLyoqXG4gKiBCbG9iLmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG5cbi8qKlxuQGNsYXNzIG1veGllL3J1bnRpbWUvZmxhc2gvZmlsZS9CbG9iXG5AcHJpdmF0ZVxuKi9cbmRlZmluZShcIm1veGllL3J1bnRpbWUvZmxhc2gvZmlsZS9CbG9iXCIsIFtcblx0XCJtb3hpZS9ydW50aW1lL2ZsYXNoL1J1bnRpbWVcIixcblx0XCJtb3hpZS9maWxlL0Jsb2JcIlxuXSwgZnVuY3Rpb24oZXh0ZW5zaW9ucywgQmxvYikge1xuXG5cdHZhciBGbGFzaEJsb2IgPSB7XG5cdFx0c2xpY2U6IGZ1bmN0aW9uKGJsb2IsIHN0YXJ0LCBlbmQsIHR5cGUpIHtcblx0XHRcdHZhciBzZWxmID0gdGhpcy5nZXRSdW50aW1lKCk7XG5cblx0XHRcdGlmIChzdGFydCA8IDApIHtcblx0XHRcdFx0c3RhcnQgPSBNYXRoLm1heChibG9iLnNpemUgKyBzdGFydCwgMCk7XG5cdFx0XHR9IGVsc2UgaWYgKHN0YXJ0ID4gMCkge1xuXHRcdFx0XHRzdGFydCA9IE1hdGgubWluKHN0YXJ0LCBibG9iLnNpemUpO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoZW5kIDwgMCkge1xuXHRcdFx0XHRlbmQgPSBNYXRoLm1heChibG9iLnNpemUgKyBlbmQsIDApO1xuXHRcdFx0fSBlbHNlIGlmIChlbmQgPiAwKSB7XG5cdFx0XHRcdGVuZCA9IE1hdGgubWluKGVuZCwgYmxvYi5zaXplKTtcblx0XHRcdH1cblxuXHRcdFx0YmxvYiA9IHNlbGYuc2hpbUV4ZWMuY2FsbCh0aGlzLCAnQmxvYicsICdzbGljZScsIHN0YXJ0LCBlbmQsIHR5cGUgfHwgJycpO1xuXG5cdFx0XHRpZiAoYmxvYikge1xuXHRcdFx0XHRibG9iID0gbmV3IEJsb2Ioc2VsZi51aWQsIGJsb2IpO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIGJsb2I7XG5cdFx0fVxuXHR9O1xuXG5cdHJldHVybiAoZXh0ZW5zaW9ucy5CbG9iID0gRmxhc2hCbG9iKTtcbn0pO1xuXG4vLyBJbmNsdWRlZCBmcm9tOiBzcmMvamF2YXNjcmlwdC9ydW50aW1lL2ZsYXNoL2ZpbGUvRmlsZUlucHV0LmpzXG5cbi8qKlxuICogRmlsZUlucHV0LmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG5cbi8qKlxuQGNsYXNzIG1veGllL3J1bnRpbWUvZmxhc2gvZmlsZS9GaWxlSW5wdXRcbkBwcml2YXRlXG4qL1xuZGVmaW5lKFwibW94aWUvcnVudGltZS9mbGFzaC9maWxlL0ZpbGVJbnB1dFwiLCBbXG5cdFwibW94aWUvcnVudGltZS9mbGFzaC9SdW50aW1lXCIsXG5cdFwibW94aWUvZmlsZS9GaWxlXCIsXG5cdFwibW94aWUvY29yZS91dGlscy9Eb21cIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCJcbl0sIGZ1bmN0aW9uKGV4dGVuc2lvbnMsIEZpbGUsIERvbSwgQmFzaWMpIHtcblxuXHR2YXIgRmlsZUlucHV0ID0ge1xuXHRcdGluaXQ6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHRcdHZhciBjb21wID0gdGhpcywgSSA9IHRoaXMuZ2V0UnVudGltZSgpO1xuXHRcdFx0dmFyIGJyb3dzZUJ1dHRvbiA9IERvbS5nZXQob3B0aW9ucy5icm93c2VfYnV0dG9uKTtcblxuXHRcdFx0aWYgKGJyb3dzZUJ1dHRvbikge1xuXHRcdFx0XHRicm93c2VCdXR0b24uc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsIC0xKTtcblx0XHRcdFx0YnJvd3NlQnV0dG9uID0gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0dGhpcy5iaW5kKFwiQ2hhbmdlXCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR2YXIgZmlsZXMgPSBJLnNoaW1FeGVjLmNhbGwoY29tcCwgJ0ZpbGVJbnB1dCcsICdnZXRGaWxlcycpO1xuXHRcdFx0XHRjb21wLmZpbGVzID0gW107XG5cdFx0XHRcdEJhc2ljLmVhY2goZmlsZXMsIGZ1bmN0aW9uKGZpbGUpIHtcblx0XHRcdFx0XHRjb21wLmZpbGVzLnB1c2gobmV3IEZpbGUoSS51aWQsIGZpbGUpKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9LCA5OTkpO1xuXG5cdFx0XHR0aGlzLmdldFJ1bnRpbWUoKS5zaGltRXhlYy5jYWxsKHRoaXMsICdGaWxlSW5wdXQnLCAnaW5pdCcsIHtcblx0XHRcdFx0YWNjZXB0OiBvcHRpb25zLmFjY2VwdCxcblx0XHRcdFx0bXVsdGlwbGU6IG9wdGlvbnMubXVsdGlwbGVcblx0XHRcdH0pO1xuXG5cdFx0XHR0aGlzLnRyaWdnZXIoJ3JlYWR5Jyk7XG5cdFx0fVxuXHR9O1xuXG5cdHJldHVybiAoZXh0ZW5zaW9ucy5GaWxlSW5wdXQgPSBGaWxlSW5wdXQpO1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L3J1bnRpbWUvZmxhc2gvZmlsZS9GaWxlUmVhZGVyLmpzXG5cbi8qKlxuICogRmlsZVJlYWRlci5qc1xuICpcbiAqIENvcHlyaWdodCAyMDEzLCBNb3hpZWNvZGUgU3lzdGVtcyBBQlxuICogUmVsZWFzZWQgdW5kZXIgR1BMIExpY2Vuc2UuXG4gKlxuICogTGljZW5zZTogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vbGljZW5zZVxuICogQ29udHJpYnV0aW5nOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9jb250cmlidXRpbmdcbiAqL1xuXG4vKipcbkBjbGFzcyBtb3hpZS9ydW50aW1lL2ZsYXNoL2ZpbGUvRmlsZVJlYWRlclxuQHByaXZhdGVcbiovXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL2ZsYXNoL2ZpbGUvRmlsZVJlYWRlclwiLCBbXG5cdFwibW94aWUvcnVudGltZS9mbGFzaC9SdW50aW1lXCIsXG5cdFwibW94aWUvY29yZS91dGlscy9FbmNvZGVcIlxuXSwgZnVuY3Rpb24oZXh0ZW5zaW9ucywgRW5jb2RlKSB7XG5cblx0ZnVuY3Rpb24gX2Zvcm1hdERhdGEoZGF0YSwgb3ApIHtcblx0XHRzd2l0Y2ggKG9wKSB7XG5cdFx0XHRjYXNlICdyZWFkQXNUZXh0Jzpcblx0XHRcdFx0cmV0dXJuIEVuY29kZS5hdG9iKGRhdGEsICd1dGY4Jyk7XG5cdFx0XHRjYXNlICdyZWFkQXNCaW5hcnlTdHJpbmcnOlxuXHRcdFx0XHRyZXR1cm4gRW5jb2RlLmF0b2IoZGF0YSk7XG5cdFx0XHRjYXNlICdyZWFkQXNEYXRhVVJMJzpcblx0XHRcdFx0cmV0dXJuIGRhdGE7XG5cdFx0fVxuXHRcdHJldHVybiBudWxsO1xuXHR9XG5cblx0dmFyIEZpbGVSZWFkZXIgPSB7XG5cdFx0cmVhZDogZnVuY3Rpb24ob3AsIGJsb2IpIHtcblx0XHRcdHZhciBjb21wID0gdGhpcztcblxuXHRcdFx0Y29tcC5yZXN1bHQgPSAnJztcblxuXHRcdFx0Ly8gc3BlY2lhbCBwcmVmaXggZm9yIERhdGFVUkwgcmVhZCBtb2RlXG5cdFx0XHRpZiAob3AgPT09ICdyZWFkQXNEYXRhVVJMJykge1xuXHRcdFx0XHRjb21wLnJlc3VsdCA9ICdkYXRhOicgKyAoYmxvYi50eXBlIHx8ICcnKSArICc7YmFzZTY0LCc7XG5cdFx0XHR9XG5cblx0XHRcdGNvbXAuYmluZCgnUHJvZ3Jlc3MnLCBmdW5jdGlvbihlLCBkYXRhKSB7XG5cdFx0XHRcdGlmIChkYXRhKSB7XG5cdFx0XHRcdFx0Y29tcC5yZXN1bHQgKz0gX2Zvcm1hdERhdGEoZGF0YSwgb3ApO1xuXHRcdFx0XHR9XG5cdFx0XHR9LCA5OTkpO1xuXG5cdFx0XHRyZXR1cm4gY29tcC5nZXRSdW50aW1lKCkuc2hpbUV4ZWMuY2FsbCh0aGlzLCAnRmlsZVJlYWRlcicsICdyZWFkQXNCYXNlNjQnLCBibG9iLnVpZCk7XG5cdFx0fVxuXHR9O1xuXG5cdHJldHVybiAoZXh0ZW5zaW9ucy5GaWxlUmVhZGVyID0gRmlsZVJlYWRlcik7XG59KTtcblxuLy8gSW5jbHVkZWQgZnJvbTogc3JjL2phdmFzY3JpcHQvcnVudGltZS9mbGFzaC9maWxlL0ZpbGVSZWFkZXJTeW5jLmpzXG5cbi8qKlxuICogRmlsZVJlYWRlclN5bmMuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuLyoqXG5AY2xhc3MgbW94aWUvcnVudGltZS9mbGFzaC9maWxlL0ZpbGVSZWFkZXJTeW5jXG5AcHJpdmF0ZVxuKi9cbmRlZmluZShcIm1veGllL3J1bnRpbWUvZmxhc2gvZmlsZS9GaWxlUmVhZGVyU3luY1wiLCBbXG5cdFwibW94aWUvcnVudGltZS9mbGFzaC9SdW50aW1lXCIsXG5cdFwibW94aWUvY29yZS91dGlscy9FbmNvZGVcIlxuXSwgZnVuY3Rpb24oZXh0ZW5zaW9ucywgRW5jb2RlKSB7XG5cdFxuXHRmdW5jdGlvbiBfZm9ybWF0RGF0YShkYXRhLCBvcCkge1xuXHRcdHN3aXRjaCAob3ApIHtcblx0XHRcdGNhc2UgJ3JlYWRBc1RleHQnOlxuXHRcdFx0XHRyZXR1cm4gRW5jb2RlLmF0b2IoZGF0YSwgJ3V0ZjgnKTtcblx0XHRcdGNhc2UgJ3JlYWRBc0JpbmFyeVN0cmluZyc6XG5cdFx0XHRcdHJldHVybiBFbmNvZGUuYXRvYihkYXRhKTtcblx0XHRcdGNhc2UgJ3JlYWRBc0RhdGFVUkwnOlxuXHRcdFx0XHRyZXR1cm4gZGF0YTtcblx0XHR9XG5cdFx0cmV0dXJuIG51bGw7XG5cdH1cblxuXHR2YXIgRmlsZVJlYWRlclN5bmMgPSB7XG5cdFx0cmVhZDogZnVuY3Rpb24ob3AsIGJsb2IpIHtcblx0XHRcdHZhciByZXN1bHQsIHNlbGYgPSB0aGlzLmdldFJ1bnRpbWUoKTtcblxuXHRcdFx0cmVzdWx0ID0gc2VsZi5zaGltRXhlYy5jYWxsKHRoaXMsICdGaWxlUmVhZGVyU3luYycsICdyZWFkQXNCYXNlNjQnLCBibG9iLnVpZCk7XG5cdFx0XHRpZiAoIXJlc3VsdCkge1xuXHRcdFx0XHRyZXR1cm4gbnVsbDsgLy8gb3IgdGhyb3cgZXhcblx0XHRcdH1cblxuXHRcdFx0Ly8gc3BlY2lhbCBwcmVmaXggZm9yIERhdGFVUkwgcmVhZCBtb2RlXG5cdFx0XHRpZiAob3AgPT09ICdyZWFkQXNEYXRhVVJMJykge1xuXHRcdFx0XHRyZXN1bHQgPSAnZGF0YTonICsgKGJsb2IudHlwZSB8fCAnJykgKyAnO2Jhc2U2NCwnICsgcmVzdWx0O1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gX2Zvcm1hdERhdGEocmVzdWx0LCBvcCwgYmxvYi50eXBlKTtcblx0XHR9XG5cdH07XG5cblx0cmV0dXJuIChleHRlbnNpb25zLkZpbGVSZWFkZXJTeW5jID0gRmlsZVJlYWRlclN5bmMpO1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L3J1bnRpbWUvZmxhc2gvcnVudGltZS9UcmFuc3BvcnRlci5qc1xuXG4vKipcbiAqIFRyYW5zcG9ydGVyLmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG5cbi8qKlxuQGNsYXNzIG1veGllL3J1bnRpbWUvZmxhc2gvcnVudGltZS9UcmFuc3BvcnRlclxuQHByaXZhdGVcbiovXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL2ZsYXNoL3J1bnRpbWUvVHJhbnNwb3J0ZXJcIiwgW1xuXHRcIm1veGllL3J1bnRpbWUvZmxhc2gvUnVudGltZVwiLFxuXHRcIm1veGllL2ZpbGUvQmxvYlwiXG5dLCBmdW5jdGlvbihleHRlbnNpb25zLCBCbG9iKSB7XG5cblx0dmFyIFRyYW5zcG9ydGVyID0ge1xuXHRcdGdldEFzQmxvYjogZnVuY3Rpb24odHlwZSkge1xuXHRcdFx0dmFyIHNlbGYgPSB0aGlzLmdldFJ1bnRpbWUoKVxuXHRcdFx0LCBibG9iID0gc2VsZi5zaGltRXhlYy5jYWxsKHRoaXMsICdUcmFuc3BvcnRlcicsICdnZXRBc0Jsb2InLCB0eXBlKVxuXHRcdFx0O1xuXHRcdFx0aWYgKGJsb2IpIHtcblx0XHRcdFx0cmV0dXJuIG5ldyBCbG9iKHNlbGYudWlkLCBibG9iKTtcblx0XHRcdH1cblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblx0fTtcblxuXHRyZXR1cm4gKGV4dGVuc2lvbnMuVHJhbnNwb3J0ZXIgPSBUcmFuc3BvcnRlcik7XG59KTtcblxuLy8gSW5jbHVkZWQgZnJvbTogc3JjL2phdmFzY3JpcHQvcnVudGltZS9mbGFzaC94aHIvWE1MSHR0cFJlcXVlc3QuanNcblxuLyoqXG4gKiBYTUxIdHRwUmVxdWVzdC5qc1xuICpcbiAqIENvcHlyaWdodCAyMDEzLCBNb3hpZWNvZGUgU3lzdGVtcyBBQlxuICogUmVsZWFzZWQgdW5kZXIgR1BMIExpY2Vuc2UuXG4gKlxuICogTGljZW5zZTogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vbGljZW5zZVxuICogQ29udHJpYnV0aW5nOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9jb250cmlidXRpbmdcbiAqL1xuXG4vKipcbkBjbGFzcyBtb3hpZS9ydW50aW1lL2ZsYXNoL3hoci9YTUxIdHRwUmVxdWVzdFxuQHByaXZhdGVcbiovXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL2ZsYXNoL3hoci9YTUxIdHRwUmVxdWVzdFwiLCBbXG5cdFwibW94aWUvcnVudGltZS9mbGFzaC9SdW50aW1lXCIsXG5cdFwibW94aWUvY29yZS91dGlscy9CYXNpY1wiLFxuXHRcIm1veGllL2ZpbGUvQmxvYlwiLFxuXHRcIm1veGllL2ZpbGUvRmlsZVwiLFxuXHRcIm1veGllL2ZpbGUvRmlsZVJlYWRlclN5bmNcIixcblx0XCJtb3hpZS9ydW50aW1lL2ZsYXNoL2ZpbGUvRmlsZVJlYWRlclN5bmNcIixcblx0XCJtb3hpZS94aHIvRm9ybURhdGFcIixcblx0XCJtb3hpZS9ydW50aW1lL1RyYW5zcG9ydGVyXCIsXG5cdFwibW94aWUvcnVudGltZS9mbGFzaC9ydW50aW1lL1RyYW5zcG9ydGVyXCJcbl0sIGZ1bmN0aW9uKGV4dGVuc2lvbnMsIEJhc2ljLCBCbG9iLCBGaWxlLCBGaWxlUmVhZGVyU3luYywgRmlsZVJlYWRlclN5bmNGbGFzaCwgRm9ybURhdGEsIFRyYW5zcG9ydGVyLCBUcmFuc3BvcnRlckZsYXNoKSB7XG5cdFxuXHR2YXIgWE1MSHR0cFJlcXVlc3QgPSB7XG5cblx0XHRzZW5kOiBmdW5jdGlvbihtZXRhLCBkYXRhKSB7XG5cdFx0XHR2YXIgdGFyZ2V0ID0gdGhpcywgc2VsZiA9IHRhcmdldC5nZXRSdW50aW1lKCk7XG5cblx0XHRcdGZ1bmN0aW9uIHNlbmQoKSB7XG5cdFx0XHRcdG1ldGEudHJhbnNwb3J0ID0gc2VsZi5tb2RlO1xuXHRcdFx0XHRzZWxmLnNoaW1FeGVjLmNhbGwodGFyZ2V0LCAnWE1MSHR0cFJlcXVlc3QnLCAnc2VuZCcsIG1ldGEsIGRhdGEpO1xuXHRcdFx0fVxuXG5cblx0XHRcdGZ1bmN0aW9uIGFwcGVuZEJsb2IobmFtZSwgYmxvYikge1xuXHRcdFx0XHRzZWxmLnNoaW1FeGVjLmNhbGwodGFyZ2V0LCAnWE1MSHR0cFJlcXVlc3QnLCAnYXBwZW5kQmxvYicsIG5hbWUsIGJsb2IudWlkKTtcblx0XHRcdFx0ZGF0YSA9IG51bGw7XG5cdFx0XHRcdHNlbmQoKTtcblx0XHRcdH1cblxuXG5cdFx0XHRmdW5jdGlvbiBhdHRhY2hCbG9iKGJsb2IsIGNiKSB7XG5cdFx0XHRcdHZhciB0ciA9IG5ldyBUcmFuc3BvcnRlcigpO1xuXG5cdFx0XHRcdHRyLmJpbmQoXCJUcmFuc3BvcnRpbmdDb21wbGV0ZVwiLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRjYih0aGlzLnJlc3VsdCk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdHRyLnRyYW5zcG9ydChibG9iLmdldFNvdXJjZSgpLCBibG9iLnR5cGUsIHtcblx0XHRcdFx0XHRydWlkOiBzZWxmLnVpZFxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gY29weSBvdmVyIHRoZSBoZWFkZXJzIGlmIGFueVxuXHRcdFx0aWYgKCFCYXNpYy5pc0VtcHR5T2JqKG1ldGEuaGVhZGVycykpIHtcblx0XHRcdFx0QmFzaWMuZWFjaChtZXRhLmhlYWRlcnMsIGZ1bmN0aW9uKHZhbHVlLCBoZWFkZXIpIHtcblx0XHRcdFx0XHRzZWxmLnNoaW1FeGVjLmNhbGwodGFyZ2V0LCAnWE1MSHR0cFJlcXVlc3QnLCAnc2V0UmVxdWVzdEhlYWRlcicsIGhlYWRlciwgdmFsdWUudG9TdHJpbmcoKSk7IC8vIFNpbHZlcmxpZ2h0IGRvZXNuJ3QgYWNjZXB0IGludGVnZXJzIGludG8gdGhlIGFyZ3VtZW50cyBvZiB0eXBlIG9iamVjdFxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gdHJhbnNmZXIgb3ZlciBtdWx0aXBhcnQgcGFyYW1zIGFuZCBibG9iIGl0c2VsZlxuXHRcdFx0aWYgKGRhdGEgaW5zdGFuY2VvZiBGb3JtRGF0YSkge1xuXHRcdFx0XHR2YXIgYmxvYkZpZWxkO1xuXHRcdFx0XHRkYXRhLmVhY2goZnVuY3Rpb24odmFsdWUsIG5hbWUpIHtcblx0XHRcdFx0XHRpZiAodmFsdWUgaW5zdGFuY2VvZiBCbG9iKSB7XG5cdFx0XHRcdFx0XHRibG9iRmllbGQgPSBuYW1lO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRzZWxmLnNoaW1FeGVjLmNhbGwodGFyZ2V0LCAnWE1MSHR0cFJlcXVlc3QnLCAnYXBwZW5kJywgbmFtZSwgdmFsdWUpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0aWYgKCFkYXRhLmhhc0Jsb2IoKSkge1xuXHRcdFx0XHRcdGRhdGEgPSBudWxsO1xuXHRcdFx0XHRcdHNlbmQoKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHR2YXIgYmxvYiA9IGRhdGEuZ2V0QmxvYigpO1xuXHRcdFx0XHRcdGlmIChibG9iLmlzRGV0YWNoZWQoKSkge1xuXHRcdFx0XHRcdFx0YXR0YWNoQmxvYihibG9iLCBmdW5jdGlvbihhdHRhY2hlZEJsb2IpIHtcblx0XHRcdFx0XHRcdFx0YmxvYi5kZXN0cm95KCk7XG5cdFx0XHRcdFx0XHRcdGFwcGVuZEJsb2IoYmxvYkZpZWxkLCBhdHRhY2hlZEJsb2IpO1x0XHRcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRhcHBlbmRCbG9iKGJsb2JGaWVsZCwgYmxvYik7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2UgaWYgKGRhdGEgaW5zdGFuY2VvZiBCbG9iKSB7XG5cdFx0XHRcdGlmIChkYXRhLmlzRGV0YWNoZWQoKSkge1xuXHRcdFx0XHRcdGF0dGFjaEJsb2IoZGF0YSwgZnVuY3Rpb24oYXR0YWNoZWRCbG9iKSB7XG5cdFx0XHRcdFx0XHRkYXRhLmRlc3Ryb3koKTtcblx0XHRcdFx0XHRcdGRhdGEgPSBhdHRhY2hlZEJsb2IudWlkO1xuXHRcdFx0XHRcdFx0c2VuZCgpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGRhdGEgPSBkYXRhLnVpZDtcblx0XHRcdFx0XHRzZW5kKCk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHNlbmQoKTtcblx0XHRcdH1cblx0XHR9LFxuXG5cdFx0Z2V0UmVzcG9uc2U6IGZ1bmN0aW9uKHJlc3BvbnNlVHlwZSkge1xuXHRcdFx0dmFyIGZycywgYmxvYiwgc2VsZiA9IHRoaXMuZ2V0UnVudGltZSgpO1xuXG5cdFx0XHRibG9iID0gc2VsZi5zaGltRXhlYy5jYWxsKHRoaXMsICdYTUxIdHRwUmVxdWVzdCcsICdnZXRSZXNwb25zZUFzQmxvYicpO1xuXG5cdFx0XHRpZiAoYmxvYikge1xuXHRcdFx0XHRibG9iID0gbmV3IEZpbGUoc2VsZi51aWQsIGJsb2IpO1xuXG5cdFx0XHRcdGlmICgnYmxvYicgPT09IHJlc3BvbnNlVHlwZSkge1xuXHRcdFx0XHRcdHJldHVybiBibG9iO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0dHJ5IHsgXG5cdFx0XHRcdFx0ZnJzID0gbmV3IEZpbGVSZWFkZXJTeW5jKCk7XG5cblx0XHRcdFx0XHRpZiAoISF+QmFzaWMuaW5BcnJheShyZXNwb25zZVR5cGUsIFtcIlwiLCBcInRleHRcIl0pKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gZnJzLnJlYWRBc1RleHQoYmxvYik7XG5cdFx0XHRcdFx0fSBlbHNlIGlmICgnanNvbicgPT09IHJlc3BvbnNlVHlwZSAmJiAhIXdpbmRvdy5KU09OKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gSlNPTi5wYXJzZShmcnMucmVhZEFzVGV4dChibG9iKSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGZpbmFsbHkge1xuXHRcdFx0XHRcdGJsb2IuZGVzdHJveSgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9LFxuXG5cdFx0YWJvcnQ6IGZ1bmN0aW9uKHVwbG9hZF9jb21wbGV0ZV9mbGFnKSB7XG5cdFx0XHR2YXIgc2VsZiA9IHRoaXMuZ2V0UnVudGltZSgpO1xuXG5cdFx0XHRzZWxmLnNoaW1FeGVjLmNhbGwodGhpcywgJ1hNTEh0dHBSZXF1ZXN0JywgJ2Fib3J0Jyk7XG5cblx0XHRcdHRoaXMuZGlzcGF0Y2hFdmVudCgncmVhZHlzdGF0ZWNoYW5nZScpO1xuXHRcdFx0Ly8gdGhpcy5kaXNwYXRjaEV2ZW50KCdwcm9ncmVzcycpO1xuXHRcdFx0dGhpcy5kaXNwYXRjaEV2ZW50KCdhYm9ydCcpO1xuXG5cdFx0XHQvL2lmICghdXBsb2FkX2NvbXBsZXRlX2ZsYWcpIHtcblx0XHRcdFx0Ly8gdGhpcy5kaXNwYXRjaEV2ZW50KCd1cGxvYWRwcm9ncmVzcycpO1xuXHRcdFx0Ly99XG5cdFx0fVxuXHR9O1xuXG5cdHJldHVybiAoZXh0ZW5zaW9ucy5YTUxIdHRwUmVxdWVzdCA9IFhNTEh0dHBSZXF1ZXN0KTtcbn0pO1xuXG4vLyBJbmNsdWRlZCBmcm9tOiBzcmMvamF2YXNjcmlwdC9ydW50aW1lL2ZsYXNoL2ltYWdlL0ltYWdlLmpzXG5cbi8qKlxuICogSW1hZ2UuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuLyoqXG5AY2xhc3MgbW94aWUvcnVudGltZS9mbGFzaC9pbWFnZS9JbWFnZVxuQHByaXZhdGVcbiovXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL2ZsYXNoL2ltYWdlL0ltYWdlXCIsIFtcblx0XCJtb3hpZS9ydW50aW1lL2ZsYXNoL1J1bnRpbWVcIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCIsXG5cdFwibW94aWUvcnVudGltZS9UcmFuc3BvcnRlclwiLFxuXHRcIm1veGllL2ZpbGUvQmxvYlwiLFxuXHRcIm1veGllL2ZpbGUvRmlsZVJlYWRlclN5bmNcIlxuXSwgZnVuY3Rpb24oZXh0ZW5zaW9ucywgQmFzaWMsIFRyYW5zcG9ydGVyLCBCbG9iLCBGaWxlUmVhZGVyU3luYykge1xuXHRcblx0dmFyIEltYWdlID0ge1xuXHRcdGxvYWRGcm9tQmxvYjogZnVuY3Rpb24oYmxvYikge1xuXHRcdFx0dmFyIGNvbXAgPSB0aGlzLCBzZWxmID0gY29tcC5nZXRSdW50aW1lKCk7XG5cblx0XHRcdGZ1bmN0aW9uIGV4ZWMoc3JjQmxvYikge1xuXHRcdFx0XHRzZWxmLnNoaW1FeGVjLmNhbGwoY29tcCwgJ0ltYWdlJywgJ2xvYWRGcm9tQmxvYicsIHNyY0Jsb2IudWlkKTtcblx0XHRcdFx0Y29tcCA9IHNlbGYgPSBudWxsO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoYmxvYi5pc0RldGFjaGVkKCkpIHsgLy8gYmluYXJ5IHN0cmluZ1xuXHRcdFx0XHR2YXIgdHIgPSBuZXcgVHJhbnNwb3J0ZXIoKTtcblx0XHRcdFx0dHIuYmluZChcIlRyYW5zcG9ydGluZ0NvbXBsZXRlXCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdGV4ZWModHIucmVzdWx0LmdldFNvdXJjZSgpKTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdHRyLnRyYW5zcG9ydChibG9iLmdldFNvdXJjZSgpLCBibG9iLnR5cGUsIHsgcnVpZDogc2VsZi51aWQgfSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRleGVjKGJsb2IuZ2V0U291cmNlKCkpO1xuXHRcdFx0fVxuXHRcdH0sXG5cblx0XHRsb2FkRnJvbUltYWdlOiBmdW5jdGlvbihpbWcpIHtcblx0XHRcdHZhciBzZWxmID0gdGhpcy5nZXRSdW50aW1lKCk7XG5cdFx0XHRyZXR1cm4gc2VsZi5zaGltRXhlYy5jYWxsKHRoaXMsICdJbWFnZScsICdsb2FkRnJvbUltYWdlJywgaW1nLnVpZCk7XG5cdFx0fSxcblxuXHRcdGdldEluZm86IGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIHNlbGYgPSB0aGlzLmdldFJ1bnRpbWUoKVxuXHRcdFx0LCBpbmZvID0gc2VsZi5zaGltRXhlYy5jYWxsKHRoaXMsICdJbWFnZScsICdnZXRJbmZvJylcblx0XHRcdDtcblxuXHRcdFx0aWYgKGluZm8ubWV0YSAmJiBpbmZvLm1ldGEudGh1bWIgJiYgaW5mby5tZXRhLnRodW1iLmRhdGEgJiYgIShzZWxmLm1ldGEudGh1bWIuZGF0YSBpbnN0YW5jZW9mIEJsb2IpKSB7XG5cdFx0XHRcdGluZm8ubWV0YS50aHVtYi5kYXRhID0gbmV3IEJsb2Ioc2VsZi51aWQsIGluZm8ubWV0YS50aHVtYi5kYXRhKTtcblx0XHRcdH1cblx0XHRcdHJldHVybiBpbmZvO1xuXHRcdH0sXG5cblx0XHRnZXRBc0Jsb2I6IGZ1bmN0aW9uKHR5cGUsIHF1YWxpdHkpIHtcblx0XHRcdHZhciBzZWxmID0gdGhpcy5nZXRSdW50aW1lKClcblx0XHRcdCwgYmxvYiA9IHNlbGYuc2hpbUV4ZWMuY2FsbCh0aGlzLCAnSW1hZ2UnLCAnZ2V0QXNCbG9iJywgdHlwZSwgcXVhbGl0eSlcblx0XHRcdDtcblx0XHRcdGlmIChibG9iKSB7XG5cdFx0XHRcdHJldHVybiBuZXcgQmxvYihzZWxmLnVpZCwgYmxvYik7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9LFxuXG5cdFx0Z2V0QXNEYXRhVVJMOiBmdW5jdGlvbigpIHtcblx0XHRcdHZhciBzZWxmID0gdGhpcy5nZXRSdW50aW1lKClcblx0XHRcdCwgYmxvYiA9IHNlbGYuSW1hZ2UuZ2V0QXNCbG9iLmFwcGx5KHRoaXMsIGFyZ3VtZW50cylcblx0XHRcdCwgZnJzXG5cdFx0XHQ7XG5cdFx0XHRpZiAoIWJsb2IpIHtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cdFx0XHRmcnMgPSBuZXcgRmlsZVJlYWRlclN5bmMoKTtcblx0XHRcdHJldHVybiBmcnMucmVhZEFzRGF0YVVSTChibG9iKTtcblx0XHR9XG5cdH07XG5cblx0cmV0dXJuIChleHRlbnNpb25zLkltYWdlID0gSW1hZ2UpO1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L3J1bnRpbWUvc2lsdmVybGlnaHQvUnVudGltZS5qc1xuXG4vKipcbiAqIFJ1blRpbWUuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuLypnbG9iYWwgQWN0aXZlWE9iamVjdDp0cnVlICovXG5cbi8qKlxuRGVmaW5lcyBjb25zdHJ1Y3RvciBmb3IgU2lsdmVybGlnaHQgcnVudGltZS5cblxuQGNsYXNzIG1veGllL3J1bnRpbWUvc2lsdmVybGlnaHQvUnVudGltZVxuQHByaXZhdGVcbiovXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL3NpbHZlcmxpZ2h0L1J1bnRpbWVcIiwgW1xuXHRcIm1veGllL2NvcmUvdXRpbHMvQmFzaWNcIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0VudlwiLFxuXHRcIm1veGllL2NvcmUvdXRpbHMvRG9tXCIsXG5cdFwibW94aWUvY29yZS9FeGNlcHRpb25zXCIsXG5cdFwibW94aWUvcnVudGltZS9SdW50aW1lXCJcbl0sIGZ1bmN0aW9uKEJhc2ljLCBFbnYsIERvbSwgeCwgUnVudGltZSkge1xuXHRcblx0dmFyIHR5cGUgPSBcInNpbHZlcmxpZ2h0XCIsIGV4dGVuc2lvbnMgPSB7fTtcblxuXHRmdW5jdGlvbiBpc0luc3RhbGxlZCh2ZXJzaW9uKSB7XG5cdFx0dmFyIGlzVmVyc2lvblN1cHBvcnRlZCA9IGZhbHNlLCBjb250cm9sID0gbnVsbCwgYWN0dWFsVmVyLFxuXHRcdFx0YWN0dWFsVmVyQXJyYXksIHJlcVZlckFycmF5LCByZXF1aXJlZFZlcnNpb25QYXJ0LCBhY3R1YWxWZXJzaW9uUGFydCwgaW5kZXggPSAwO1xuXG5cdFx0dHJ5IHtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdGNvbnRyb2wgPSBuZXcgQWN0aXZlWE9iamVjdCgnQWdDb250cm9sLkFnQ29udHJvbCcpO1xuXG5cdFx0XHRcdGlmIChjb250cm9sLklzVmVyc2lvblN1cHBvcnRlZCh2ZXJzaW9uKSkge1xuXHRcdFx0XHRcdGlzVmVyc2lvblN1cHBvcnRlZCA9IHRydWU7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRjb250cm9sID0gbnVsbDtcblx0XHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdFx0dmFyIHBsdWdpbiA9IG5hdmlnYXRvci5wbHVnaW5zW1wiU2lsdmVybGlnaHQgUGx1Zy1JblwiXTtcblxuXHRcdFx0XHRpZiAocGx1Z2luKSB7XG5cdFx0XHRcdFx0YWN0dWFsVmVyID0gcGx1Z2luLmRlc2NyaXB0aW9uO1xuXG5cdFx0XHRcdFx0aWYgKGFjdHVhbFZlciA9PT0gXCIxLjAuMzAyMjYuMlwiKSB7XG5cdFx0XHRcdFx0XHRhY3R1YWxWZXIgPSBcIjIuMC4zMDIyNi4yXCI7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0YWN0dWFsVmVyQXJyYXkgPSBhY3R1YWxWZXIuc3BsaXQoXCIuXCIpO1xuXG5cdFx0XHRcdFx0d2hpbGUgKGFjdHVhbFZlckFycmF5Lmxlbmd0aCA+IDMpIHtcblx0XHRcdFx0XHRcdGFjdHVhbFZlckFycmF5LnBvcCgpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHdoaWxlICggYWN0dWFsVmVyQXJyYXkubGVuZ3RoIDwgNCkge1xuXHRcdFx0XHRcdFx0YWN0dWFsVmVyQXJyYXkucHVzaCgwKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRyZXFWZXJBcnJheSA9IHZlcnNpb24uc3BsaXQoXCIuXCIpO1xuXG5cdFx0XHRcdFx0d2hpbGUgKHJlcVZlckFycmF5Lmxlbmd0aCA+IDQpIHtcblx0XHRcdFx0XHRcdHJlcVZlckFycmF5LnBvcCgpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGRvIHtcblx0XHRcdFx0XHRcdHJlcXVpcmVkVmVyc2lvblBhcnQgPSBwYXJzZUludChyZXFWZXJBcnJheVtpbmRleF0sIDEwKTtcblx0XHRcdFx0XHRcdGFjdHVhbFZlcnNpb25QYXJ0ID0gcGFyc2VJbnQoYWN0dWFsVmVyQXJyYXlbaW5kZXhdLCAxMCk7XG5cdFx0XHRcdFx0XHRpbmRleCsrO1xuXHRcdFx0XHRcdH0gd2hpbGUgKGluZGV4IDwgcmVxVmVyQXJyYXkubGVuZ3RoICYmIHJlcXVpcmVkVmVyc2lvblBhcnQgPT09IGFjdHVhbFZlcnNpb25QYXJ0KTtcblxuXHRcdFx0XHRcdGlmIChyZXF1aXJlZFZlcnNpb25QYXJ0IDw9IGFjdHVhbFZlcnNpb25QYXJ0ICYmICFpc05hTihyZXF1aXJlZFZlcnNpb25QYXJ0KSkge1xuXHRcdFx0XHRcdFx0aXNWZXJzaW9uU3VwcG9ydGVkID0gdHJ1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9IGNhdGNoIChlMikge1xuXHRcdFx0aXNWZXJzaW9uU3VwcG9ydGVkID0gZmFsc2U7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGlzVmVyc2lvblN1cHBvcnRlZDtcblx0fVxuXG5cdC8qKlxuXHRDb25zdHJ1Y3RvciBmb3IgdGhlIFNpbHZlcmxpZ2h0IFJ1bnRpbWVcblx0Ki9cblx0ZnVuY3Rpb24gU2lsdmVybGlnaHRSdW50aW1lKG9wdGlvbnMpIHtcblx0XHR2YXIgSSA9IHRoaXMsIGluaXRUaW1lcjtcblxuXHRcdG9wdGlvbnMgPSBCYXNpYy5leHRlbmQoeyB4YXBfdXJsOiBFbnYueGFwX3VybCB9LCBvcHRpb25zKTtcblxuXHRcdFJ1bnRpbWUuY2FsbCh0aGlzLCBvcHRpb25zLCB0eXBlLCB7XG5cdFx0XHRhY2Nlc3NfYmluYXJ5OiBSdW50aW1lLmNhcFRydWUsXG5cdFx0XHRhY2Nlc3NfaW1hZ2VfYmluYXJ5OiBSdW50aW1lLmNhcFRydWUsXG5cdFx0XHRkaXNwbGF5X21lZGlhOiBSdW50aW1lLmNhcFRlc3QoZGVmaW5lZCgnbW94aWUvaW1hZ2UvSW1hZ2UnKSksXG5cdFx0XHRkb19jb3JzOiBSdW50aW1lLmNhcFRydWUsXG5cdFx0XHRkcmFnX2FuZF9kcm9wOiBmYWxzZSxcblx0XHRcdHJlcG9ydF91cGxvYWRfcHJvZ3Jlc3M6IFJ1bnRpbWUuY2FwVHJ1ZSxcblx0XHRcdHJlc2l6ZV9pbWFnZTogUnVudGltZS5jYXBUcnVlLFxuXHRcdFx0cmV0dXJuX3Jlc3BvbnNlX2hlYWRlcnM6IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdFx0XHRcdHJldHVybiB2YWx1ZSAmJiBJLm1vZGUgPT09ICdjbGllbnQnO1xuXHRcdFx0fSxcblx0XHRcdHJldHVybl9yZXNwb25zZV90eXBlOiBmdW5jdGlvbihyZXNwb25zZVR5cGUpIHtcblx0XHRcdFx0aWYgKHJlc3BvbnNlVHlwZSAhPT0gJ2pzb24nKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0cmV0dXJuICEhd2luZG93LkpTT047XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cdFx0XHRyZXR1cm5fc3RhdHVzX2NvZGU6IGZ1bmN0aW9uKGNvZGUpIHtcblx0XHRcdFx0cmV0dXJuIEkubW9kZSA9PT0gJ2NsaWVudCcgfHwgIUJhc2ljLmFycmF5RGlmZihjb2RlLCBbMjAwLCA0MDRdKTtcblx0XHRcdH0sXG5cdFx0XHRzZWxlY3RfZmlsZTogUnVudGltZS5jYXBUcnVlLFxuXHRcdFx0c2VsZWN0X211bHRpcGxlOiBSdW50aW1lLmNhcFRydWUsXG5cdFx0XHRzZW5kX2JpbmFyeV9zdHJpbmc6IFJ1bnRpbWUuY2FwVHJ1ZSxcblx0XHRcdHNlbmRfYnJvd3Nlcl9jb29raWVzOiBmdW5jdGlvbih2YWx1ZSkge1xuXHRcdFx0XHRyZXR1cm4gdmFsdWUgJiYgSS5tb2RlID09PSAnYnJvd3Nlcic7XG5cdFx0XHR9LFxuXHRcdFx0c2VuZF9jdXN0b21faGVhZGVyczogZnVuY3Rpb24odmFsdWUpIHtcblx0XHRcdFx0cmV0dXJuIHZhbHVlICYmIEkubW9kZSA9PT0gJ2NsaWVudCc7XG5cdFx0XHR9LFxuXHRcdFx0c2VuZF9tdWx0aXBhcnQ6IFJ1bnRpbWUuY2FwVHJ1ZSxcblx0XHRcdHNsaWNlX2Jsb2I6IFJ1bnRpbWUuY2FwVHJ1ZSxcblx0XHRcdHN0cmVhbV91cGxvYWQ6IHRydWUsXG5cdFx0XHRzdW1tb25fZmlsZV9kaWFsb2c6IGZhbHNlLFxuXHRcdFx0dXBsb2FkX2ZpbGVzaXplOiBSdW50aW1lLmNhcFRydWUsXG5cdFx0XHR1c2VfaHR0cF9tZXRob2Q6IGZ1bmN0aW9uKG1ldGhvZHMpIHtcblx0XHRcdFx0cmV0dXJuIEkubW9kZSA9PT0gJ2NsaWVudCcgfHwgIUJhc2ljLmFycmF5RGlmZihtZXRob2RzLCBbJ0dFVCcsICdQT1NUJ10pO1xuXHRcdFx0fVxuXHRcdH0sIHsgXG5cdFx0XHQvLyBjYXBhYmlsaXRpZXMgdGhhdCByZXF1aXJlIHNwZWNpZmljIG1vZGVcblx0XHRcdHJldHVybl9yZXNwb25zZV9oZWFkZXJzOiBmdW5jdGlvbih2YWx1ZSkge1xuXHRcdFx0XHRyZXR1cm4gdmFsdWUgPyAnY2xpZW50JyA6ICdicm93c2VyJztcblx0XHRcdH0sXG5cdFx0XHRyZXR1cm5fc3RhdHVzX2NvZGU6IGZ1bmN0aW9uKGNvZGUpIHtcblx0XHRcdFx0cmV0dXJuIEJhc2ljLmFycmF5RGlmZihjb2RlLCBbMjAwLCA0MDRdKSA/ICdjbGllbnQnIDogWydjbGllbnQnLCAnYnJvd3NlciddO1xuXHRcdFx0fSxcblx0XHRcdHNlbmRfYnJvd3Nlcl9jb29raWVzOiBmdW5jdGlvbih2YWx1ZSkge1xuXHRcdFx0XHRyZXR1cm4gdmFsdWUgPyAnYnJvd3NlcicgOiAnY2xpZW50Jztcblx0XHRcdH0sXG5cdFx0XHRzZW5kX2N1c3RvbV9oZWFkZXJzOiBmdW5jdGlvbih2YWx1ZSkge1xuXHRcdFx0XHRyZXR1cm4gdmFsdWUgPyAnY2xpZW50JyA6ICdicm93c2VyJztcblx0XHRcdH0sXG5cdFx0XHR1c2VfaHR0cF9tZXRob2Q6IGZ1bmN0aW9uKG1ldGhvZHMpIHtcblx0XHRcdFx0cmV0dXJuIEJhc2ljLmFycmF5RGlmZihtZXRob2RzLCBbJ0dFVCcsICdQT1NUJ10pID8gJ2NsaWVudCcgOiBbJ2NsaWVudCcsICdicm93c2VyJ107XG5cdFx0XHR9XG5cdFx0fSk7XG5cblxuXHRcdC8vIG1pbmltYWwgcmVxdWlyZW1lbnRcblx0XHRpZiAoIWlzSW5zdGFsbGVkKCcyLjAuMzEwMDUuMCcpIHx8IEVudi5icm93c2VyID09PSAnT3BlcmEnKSB7XG5cdFx0XHRpZiAoTVhJX0RFQlVHICYmIEVudi5kZWJ1Zy5ydW50aW1lKSB7XG5cdFx0XHRcdEVudi5sb2coXCJcXHRTaWx2ZXJsaWdodCBpcyBub3QgaW5zdGFsbGVkIG9yIG1pbmltYWwgdmVyc2lvbiAoMi4wLjMxMDA1LjApIHJlcXVpcmVtZW50IG5vdCBtZXQgKG5vdCBsaWtlbHkpLlwiKTtcdFxuXHRcdFx0fVxuXG5cdFx0XHR0aGlzLm1vZGUgPSBmYWxzZTtcblx0XHR9XG5cblxuXHRcdEJhc2ljLmV4dGVuZCh0aGlzLCB7XG5cdFx0XHRnZXRTaGltOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIERvbS5nZXQodGhpcy51aWQpLmNvbnRlbnQuTW94aWU7XG5cdFx0XHR9LFxuXG5cdFx0XHRzaGltRXhlYzogZnVuY3Rpb24oY29tcG9uZW50LCBhY3Rpb24pIHtcblx0XHRcdFx0dmFyIGFyZ3MgPSBbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMik7XG5cdFx0XHRcdHJldHVybiBJLmdldFNoaW0oKS5leGVjKHRoaXMudWlkLCBjb21wb25lbnQsIGFjdGlvbiwgYXJncyk7XG5cdFx0XHR9LFxuXG5cdFx0XHRpbml0IDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciBjb250YWluZXI7XG5cblx0XHRcdFx0Y29udGFpbmVyID0gdGhpcy5nZXRTaGltQ29udGFpbmVyKCk7XG5cblx0XHRcdFx0Y29udGFpbmVyLmlubmVySFRNTCA9ICc8b2JqZWN0IGlkPVwiJyArIHRoaXMudWlkICsgJ1wiIGRhdGE9XCJkYXRhOmFwcGxpY2F0aW9uL3gtc2lsdmVybGlnaHQsXCIgdHlwZT1cImFwcGxpY2F0aW9uL3gtc2lsdmVybGlnaHQtMlwiIHdpZHRoPVwiMTAwJVwiIGhlaWdodD1cIjEwMCVcIiBzdHlsZT1cIm91dGxpbmU6bm9uZTtcIj4nICtcblx0XHRcdFx0XHQnPHBhcmFtIG5hbWU9XCJzb3VyY2VcIiB2YWx1ZT1cIicgKyBvcHRpb25zLnhhcF91cmwgKyAnXCIvPicgK1xuXHRcdFx0XHRcdCc8cGFyYW0gbmFtZT1cImJhY2tncm91bmRcIiB2YWx1ZT1cIlRyYW5zcGFyZW50XCIvPicgK1xuXHRcdFx0XHRcdCc8cGFyYW0gbmFtZT1cIndpbmRvd2xlc3NcIiB2YWx1ZT1cInRydWVcIi8+JyArXG5cdFx0XHRcdFx0JzxwYXJhbSBuYW1lPVwiZW5hYmxlaHRtbGFjY2Vzc1wiIHZhbHVlPVwidHJ1ZVwiLz4nICtcblx0XHRcdFx0XHQnPHBhcmFtIG5hbWU9XCJpbml0UGFyYW1zXCIgdmFsdWU9XCJ1aWQ9JyArIHRoaXMudWlkICsgJyx0YXJnZXQ9JyArIFJ1bnRpbWUuZ2V0R2xvYmFsRXZlbnRUYXJnZXQoKSArICdcIi8+JyArXG5cdFx0XHRcdCc8L29iamVjdD4nO1xuXG5cdFx0XHRcdC8vIEluaXQgaXMgZGlzcGF0Y2hlZCBieSB0aGUgc2hpbVxuXHRcdFx0XHRpbml0VGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdGlmIChJICYmICFJLmluaXRpYWxpemVkKSB7IC8vIHJ1bnRpbWUgbWlnaHQgYmUgYWxyZWFkeSBkZXN0cm95ZWQgYnkgdGhpcyBtb21lbnRcblx0XHRcdFx0XHRcdEkudHJpZ2dlcihcIkVycm9yXCIsIG5ldyB4LlJ1bnRpbWVFcnJvcih4LlJ1bnRpbWVFcnJvci5OT1RfSU5JVF9FUlIpKTtcblxuXHRcdFx0XHRcdFx0aWYgKE1YSV9ERUJVRyAmJiBFbnYuZGVidWcucnVudGltZSkge1xuXHRcdFx0XHRcdFx0XHRFbnYubG9nKFwiXFxTaWx2ZXJsaWdodCBmYWlsZWQgdG8gaW5pdGlhbGl6ZSB3aXRoaW4gYSBzcGVjaWZpZWQgcGVyaW9kIG9mIHRpbWUgKDUtMTBzKS5cIik7XHRcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0sIEVudi5PUyAhPT0gJ1dpbmRvd3MnPyAxMDAwMCA6IDUwMDApOyAvLyBnaXZlIGl0IG1vcmUgdGltZSB0byBpbml0aWFsaXplIGluIG5vbiBXaW5kb3dzIE9TIChsaWtlIE1hYylcblx0XHRcdH0sXG5cblx0XHRcdGRlc3Ryb3k6IChmdW5jdGlvbihkZXN0cm95KSB7IC8vIGV4dGVuZCBkZWZhdWx0IGRlc3Ryb3kgbWV0aG9kXG5cdFx0XHRcdHJldHVybiBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRkZXN0cm95LmNhbGwoSSk7XG5cdFx0XHRcdFx0Y2xlYXJUaW1lb3V0KGluaXRUaW1lcik7IC8vIGluaXRpYWxpemF0aW9uIGNoZWNrIG1pZ2h0IGJlIHN0aWxsIG9ud2FpdFxuXHRcdFx0XHRcdG9wdGlvbnMgPSBpbml0VGltZXIgPSBkZXN0cm95ID0gSSA9IG51bGw7XG5cdFx0XHRcdH07XG5cdFx0XHR9KHRoaXMuZGVzdHJveSkpXG5cblx0XHR9LCBleHRlbnNpb25zKTtcblx0fVxuXG5cdFJ1bnRpbWUuYWRkQ29uc3RydWN0b3IodHlwZSwgU2lsdmVybGlnaHRSdW50aW1lKTsgXG5cblx0cmV0dXJuIGV4dGVuc2lvbnM7XG59KTtcblxuLy8gSW5jbHVkZWQgZnJvbTogc3JjL2phdmFzY3JpcHQvcnVudGltZS9zaWx2ZXJsaWdodC9maWxlL0Jsb2IuanNcblxuLyoqXG4gKiBCbG9iLmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG5cbi8qKlxuQGNsYXNzIG1veGllL3J1bnRpbWUvc2lsdmVybGlnaHQvZmlsZS9CbG9iXG5AcHJpdmF0ZVxuKi9cbmRlZmluZShcIm1veGllL3J1bnRpbWUvc2lsdmVybGlnaHQvZmlsZS9CbG9iXCIsIFtcblx0XCJtb3hpZS9ydW50aW1lL3NpbHZlcmxpZ2h0L1J1bnRpbWVcIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCIsXG5cdFwibW94aWUvcnVudGltZS9mbGFzaC9maWxlL0Jsb2JcIlxuXSwgZnVuY3Rpb24oZXh0ZW5zaW9ucywgQmFzaWMsIEJsb2IpIHtcblx0cmV0dXJuIChleHRlbnNpb25zLkJsb2IgPSBCYXNpYy5leHRlbmQoe30sIEJsb2IpKTtcbn0pO1xuXG4vLyBJbmNsdWRlZCBmcm9tOiBzcmMvamF2YXNjcmlwdC9ydW50aW1lL3NpbHZlcmxpZ2h0L2ZpbGUvRmlsZUlucHV0LmpzXG5cbi8qKlxuICogRmlsZUlucHV0LmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG5cbi8qKlxuQGNsYXNzIG1veGllL3J1bnRpbWUvc2lsdmVybGlnaHQvZmlsZS9GaWxlSW5wdXRcbkBwcml2YXRlXG4qL1xuZGVmaW5lKFwibW94aWUvcnVudGltZS9zaWx2ZXJsaWdodC9maWxlL0ZpbGVJbnB1dFwiLCBbXG5cdFwibW94aWUvcnVudGltZS9zaWx2ZXJsaWdodC9SdW50aW1lXCIsXG5cdFwibW94aWUvZmlsZS9GaWxlXCIsXG5cdFwibW94aWUvY29yZS91dGlscy9Eb21cIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCJcbl0sIGZ1bmN0aW9uKGV4dGVuc2lvbnMsIEZpbGUsIERvbSwgQmFzaWMpIHtcblxuXHRmdW5jdGlvbiB0b0ZpbHRlcnMoYWNjZXB0KSB7XG5cdFx0dmFyIGZpbHRlciA9ICcnO1xuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgYWNjZXB0Lmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRmaWx0ZXIgKz0gKGZpbHRlciAhPT0gJycgPyAnfCcgOiAnJykgKyBhY2NlcHRbaV0udGl0bGUgKyBcIiB8ICouXCIgKyBhY2NlcHRbaV0uZXh0ZW5zaW9ucy5yZXBsYWNlKC8sL2csICc7Ki4nKTtcblx0XHR9XG5cdFx0cmV0dXJuIGZpbHRlcjtcblx0fVxuXG5cdFxuXHR2YXIgRmlsZUlucHV0ID0ge1xuXHRcdGluaXQ6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHRcdHZhciBjb21wID0gdGhpcywgSSA9IHRoaXMuZ2V0UnVudGltZSgpO1xuXHRcdFx0dmFyIGJyb3dzZUJ1dHRvbiA9IERvbS5nZXQob3B0aW9ucy5icm93c2VfYnV0dG9uKTtcblxuXHRcdFx0aWYgKGJyb3dzZUJ1dHRvbikge1xuXHRcdFx0XHRicm93c2VCdXR0b24uc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsIC0xKTtcblx0XHRcdFx0YnJvd3NlQnV0dG9uID0gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0dGhpcy5iaW5kKFwiQ2hhbmdlXCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR2YXIgZmlsZXMgPSBJLnNoaW1FeGVjLmNhbGwoY29tcCwgJ0ZpbGVJbnB1dCcsICdnZXRGaWxlcycpO1xuXHRcdFx0XHRjb21wLmZpbGVzID0gW107XG5cdFx0XHRcdEJhc2ljLmVhY2goZmlsZXMsIGZ1bmN0aW9uKGZpbGUpIHtcblx0XHRcdFx0XHRjb21wLmZpbGVzLnB1c2gobmV3IEZpbGUoSS51aWQsIGZpbGUpKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9LCA5OTkpO1xuXHRcdFx0XG5cdFx0XHRJLnNoaW1FeGVjLmNhbGwodGhpcywgJ0ZpbGVJbnB1dCcsICdpbml0JywgdG9GaWx0ZXJzKG9wdGlvbnMuYWNjZXB0KSwgb3B0aW9ucy5tdWx0aXBsZSk7XG5cdFx0XHR0aGlzLnRyaWdnZXIoJ3JlYWR5Jyk7XG5cdFx0fSxcblxuXHRcdHNldE9wdGlvbjogZnVuY3Rpb24obmFtZSwgdmFsdWUpIHtcblx0XHRcdGlmIChuYW1lID09ICdhY2NlcHQnKSB7XG5cdFx0XHRcdHZhbHVlID0gdG9GaWx0ZXJzKHZhbHVlKTtcblx0XHRcdH1cblx0XHRcdHRoaXMuZ2V0UnVudGltZSgpLnNoaW1FeGVjLmNhbGwodGhpcywgJ0ZpbGVJbnB1dCcsICdzZXRPcHRpb24nLCBuYW1lLCB2YWx1ZSk7XG5cdFx0fVxuXHR9O1xuXG5cdHJldHVybiAoZXh0ZW5zaW9ucy5GaWxlSW5wdXQgPSBGaWxlSW5wdXQpO1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L3J1bnRpbWUvc2lsdmVybGlnaHQvZmlsZS9GaWxlRHJvcC5qc1xuXG4vKipcbiAqIEZpbGVEcm9wLmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG5cbi8qKlxuQGNsYXNzIG1veGllL3J1bnRpbWUvc2lsdmVybGlnaHQvZmlsZS9GaWxlRHJvcFxuQHByaXZhdGVcbiovXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL3NpbHZlcmxpZ2h0L2ZpbGUvRmlsZURyb3BcIiwgW1xuXHRcIm1veGllL3J1bnRpbWUvc2lsdmVybGlnaHQvUnVudGltZVwiLFxuXHRcIm1veGllL2NvcmUvdXRpbHMvRG9tXCIsIFxuXHRcIm1veGllL2NvcmUvdXRpbHMvRXZlbnRzXCJcbl0sIGZ1bmN0aW9uKGV4dGVuc2lvbnMsIERvbSwgRXZlbnRzKSB7XG5cblx0Ly8gbm90IGV4YWN0bHkgdXNlZnVsLCBzaW5jZSB3b3JrcyBvbmx5IGluIHNhZmFyaSAoLi4uY3JpY2tldHMuLi4pXG5cdHZhciBGaWxlRHJvcCA9IHtcblx0XHRpbml0OiBmdW5jdGlvbigpIHtcblx0XHRcdHZhciBjb21wID0gdGhpcywgc2VsZiA9IGNvbXAuZ2V0UnVudGltZSgpLCBkcm9wWm9uZTtcblxuXHRcdFx0ZHJvcFpvbmUgPSBzZWxmLmdldFNoaW1Db250YWluZXIoKTtcblxuXHRcdFx0RXZlbnRzLmFkZEV2ZW50KGRyb3Bab25lLCAnZHJhZ292ZXInLCBmdW5jdGlvbihlKSB7XG5cdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0ZS5kYXRhVHJhbnNmZXIuZHJvcEVmZmVjdCA9ICdjb3B5Jztcblx0XHRcdH0sIGNvbXAudWlkKTtcblxuXHRcdFx0RXZlbnRzLmFkZEV2ZW50KGRyb3Bab25lLCAnZHJhZ2VudGVyJywgZnVuY3Rpb24oZSkge1xuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdHZhciBmbGFnID0gRG9tLmdldChzZWxmLnVpZCkuZHJhZ0VudGVyKGUpO1xuXHRcdFx0XHQvLyBJZiBoYW5kbGVkLCB0aGVuIHN0b3AgcHJvcGFnYXRpb24gb2YgZXZlbnQgaW4gRE9NXG5cdFx0XHRcdGlmIChmbGFnKSB7XG5cdFx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0fVxuXHRcdFx0fSwgY29tcC51aWQpO1xuXG5cdFx0XHRFdmVudHMuYWRkRXZlbnQoZHJvcFpvbmUsICdkcm9wJywgZnVuY3Rpb24oZSkge1xuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdHZhciBmbGFnID0gRG9tLmdldChzZWxmLnVpZCkuZHJhZ0Ryb3AoZSk7XG5cdFx0XHRcdC8vIElmIGhhbmRsZWQsIHRoZW4gc3RvcCBwcm9wYWdhdGlvbiBvZiBldmVudCBpbiBET01cblx0XHRcdFx0aWYgKGZsYWcpIHtcblx0XHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHR9XG5cdFx0XHR9LCBjb21wLnVpZCk7XG5cblx0XHRcdHJldHVybiBzZWxmLnNoaW1FeGVjLmNhbGwodGhpcywgJ0ZpbGVEcm9wJywgJ2luaXQnKTtcblx0XHR9XG5cdH07XG5cblx0cmV0dXJuIChleHRlbnNpb25zLkZpbGVEcm9wID0gRmlsZURyb3ApO1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L3J1bnRpbWUvc2lsdmVybGlnaHQvZmlsZS9GaWxlUmVhZGVyLmpzXG5cbi8qKlxuICogRmlsZVJlYWRlci5qc1xuICpcbiAqIENvcHlyaWdodCAyMDEzLCBNb3hpZWNvZGUgU3lzdGVtcyBBQlxuICogUmVsZWFzZWQgdW5kZXIgR1BMIExpY2Vuc2UuXG4gKlxuICogTGljZW5zZTogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vbGljZW5zZVxuICogQ29udHJpYnV0aW5nOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9jb250cmlidXRpbmdcbiAqL1xuXG4vKipcbkBjbGFzcyBtb3hpZS9ydW50aW1lL3NpbHZlcmxpZ2h0L2ZpbGUvRmlsZVJlYWRlclxuQHByaXZhdGVcbiovXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL3NpbHZlcmxpZ2h0L2ZpbGUvRmlsZVJlYWRlclwiLCBbXG5cdFwibW94aWUvcnVudGltZS9zaWx2ZXJsaWdodC9SdW50aW1lXCIsXG5cdFwibW94aWUvY29yZS91dGlscy9CYXNpY1wiLFxuXHRcIm1veGllL3J1bnRpbWUvZmxhc2gvZmlsZS9GaWxlUmVhZGVyXCJcbl0sIGZ1bmN0aW9uKGV4dGVuc2lvbnMsIEJhc2ljLCBGaWxlUmVhZGVyKSB7XG5cdHJldHVybiAoZXh0ZW5zaW9ucy5GaWxlUmVhZGVyID0gQmFzaWMuZXh0ZW5kKHt9LCBGaWxlUmVhZGVyKSk7XG59KTtcblxuLy8gSW5jbHVkZWQgZnJvbTogc3JjL2phdmFzY3JpcHQvcnVudGltZS9zaWx2ZXJsaWdodC9maWxlL0ZpbGVSZWFkZXJTeW5jLmpzXG5cbi8qKlxuICogRmlsZVJlYWRlclN5bmMuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuLyoqXG5AY2xhc3MgbW94aWUvcnVudGltZS9zaWx2ZXJsaWdodC9maWxlL0ZpbGVSZWFkZXJTeW5jXG5AcHJpdmF0ZVxuKi9cbmRlZmluZShcIm1veGllL3J1bnRpbWUvc2lsdmVybGlnaHQvZmlsZS9GaWxlUmVhZGVyU3luY1wiLCBbXG5cdFwibW94aWUvcnVudGltZS9zaWx2ZXJsaWdodC9SdW50aW1lXCIsXG5cdFwibW94aWUvY29yZS91dGlscy9CYXNpY1wiLFxuXHRcIm1veGllL3J1bnRpbWUvZmxhc2gvZmlsZS9GaWxlUmVhZGVyU3luY1wiXG5dLCBmdW5jdGlvbihleHRlbnNpb25zLCBCYXNpYywgRmlsZVJlYWRlclN5bmMpIHtcblx0cmV0dXJuIChleHRlbnNpb25zLkZpbGVSZWFkZXJTeW5jID0gQmFzaWMuZXh0ZW5kKHt9LCBGaWxlUmVhZGVyU3luYykpO1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L3J1bnRpbWUvc2lsdmVybGlnaHQvcnVudGltZS9UcmFuc3BvcnRlci5qc1xuXG4vKipcbiAqIFRyYW5zcG9ydGVyLmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG5cbi8qKlxuQGNsYXNzIG1veGllL3J1bnRpbWUvc2lsdmVybGlnaHQvcnVudGltZS9UcmFuc3BvcnRlclxuQHByaXZhdGVcbiovXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL3NpbHZlcmxpZ2h0L3J1bnRpbWUvVHJhbnNwb3J0ZXJcIiwgW1xuXHRcIm1veGllL3J1bnRpbWUvc2lsdmVybGlnaHQvUnVudGltZVwiLFxuXHRcIm1veGllL2NvcmUvdXRpbHMvQmFzaWNcIixcblx0XCJtb3hpZS9ydW50aW1lL2ZsYXNoL3J1bnRpbWUvVHJhbnNwb3J0ZXJcIlxuXSwgZnVuY3Rpb24oZXh0ZW5zaW9ucywgQmFzaWMsIFRyYW5zcG9ydGVyKSB7XG5cdHJldHVybiAoZXh0ZW5zaW9ucy5UcmFuc3BvcnRlciA9IEJhc2ljLmV4dGVuZCh7fSwgVHJhbnNwb3J0ZXIpKTtcbn0pO1xuXG4vLyBJbmNsdWRlZCBmcm9tOiBzcmMvamF2YXNjcmlwdC9ydW50aW1lL3NpbHZlcmxpZ2h0L3hoci9YTUxIdHRwUmVxdWVzdC5qc1xuXG4vKipcbiAqIFhNTEh0dHBSZXF1ZXN0LmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG5cbi8qKlxuQGNsYXNzIG1veGllL3J1bnRpbWUvc2lsdmVybGlnaHQveGhyL1hNTEh0dHBSZXF1ZXN0XG5AcHJpdmF0ZVxuKi9cbmRlZmluZShcIm1veGllL3J1bnRpbWUvc2lsdmVybGlnaHQveGhyL1hNTEh0dHBSZXF1ZXN0XCIsIFtcblx0XCJtb3hpZS9ydW50aW1lL3NpbHZlcmxpZ2h0L1J1bnRpbWVcIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCIsXG5cdFwibW94aWUvcnVudGltZS9mbGFzaC94aHIvWE1MSHR0cFJlcXVlc3RcIixcblx0XCJtb3hpZS9ydW50aW1lL3NpbHZlcmxpZ2h0L2ZpbGUvRmlsZVJlYWRlclN5bmNcIixcblx0XCJtb3hpZS9ydW50aW1lL3NpbHZlcmxpZ2h0L3J1bnRpbWUvVHJhbnNwb3J0ZXJcIlxuXSwgZnVuY3Rpb24oZXh0ZW5zaW9ucywgQmFzaWMsIFhNTEh0dHBSZXF1ZXN0LCBGaWxlUmVhZGVyU3luY1NpbHZlcmxpZ2h0LCBUcmFuc3BvcnRlclNpbHZlcmxpZ2h0KSB7XG5cdHJldHVybiAoZXh0ZW5zaW9ucy5YTUxIdHRwUmVxdWVzdCA9IEJhc2ljLmV4dGVuZCh7fSwgWE1MSHR0cFJlcXVlc3QpKTtcbn0pO1xuXG4vLyBJbmNsdWRlZCBmcm9tOiBzcmMvamF2YXNjcmlwdC9ydW50aW1lL3NpbHZlcmxpZ2h0L2ltYWdlL0ltYWdlLmpzXG5cbi8qKlxuICogSW1hZ2UuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cbiBcbi8qKlxuQGNsYXNzIG1veGllL3J1bnRpbWUvc2lsdmVybGlnaHQvaW1hZ2UvSW1hZ2VcbkBwcml2YXRlXG4qL1xuZGVmaW5lKFwibW94aWUvcnVudGltZS9zaWx2ZXJsaWdodC9pbWFnZS9JbWFnZVwiLCBbXG5cdFwibW94aWUvcnVudGltZS9zaWx2ZXJsaWdodC9SdW50aW1lXCIsXG5cdFwibW94aWUvY29yZS91dGlscy9CYXNpY1wiLFxuXHRcIm1veGllL2ZpbGUvQmxvYlwiLFxuXHRcIm1veGllL3J1bnRpbWUvZmxhc2gvaW1hZ2UvSW1hZ2VcIlxuXSwgZnVuY3Rpb24oZXh0ZW5zaW9ucywgQmFzaWMsIEJsb2IsIEltYWdlKSB7XG5cdHJldHVybiAoZXh0ZW5zaW9ucy5JbWFnZSA9IEJhc2ljLmV4dGVuZCh7fSwgSW1hZ2UsIHtcblxuXHRcdGdldEluZm86IGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIHNlbGYgPSB0aGlzLmdldFJ1bnRpbWUoKVxuXHRcdFx0LCBncnBzID0gWyd0aWZmJywgJ2V4aWYnLCAnZ3BzJywgJ3RodW1iJ11cblx0XHRcdCwgaW5mbyA9IHsgbWV0YToge30gfVxuXHRcdFx0LCByYXdJbmZvID0gc2VsZi5zaGltRXhlYy5jYWxsKHRoaXMsICdJbWFnZScsICdnZXRJbmZvJylcblx0XHRcdDtcblxuXHRcdFx0aWYgKHJhd0luZm8ubWV0YSkge1xuXHRcdFx0XHRCYXNpYy5lYWNoKGdycHMsIGZ1bmN0aW9uKGdycCkge1xuXHRcdFx0XHRcdHZhciBtZXRhID0gcmF3SW5mby5tZXRhW2dycF1cblx0XHRcdFx0XHQsIHRhZ1xuXHRcdFx0XHRcdCwgaVxuXHRcdFx0XHRcdCwgbGVuZ3RoXG5cdFx0XHRcdFx0LCB2YWx1ZVxuXHRcdFx0XHRcdDtcblx0XHRcdFx0XHRpZiAobWV0YSAmJiBtZXRhLmtleXMpIHtcblx0XHRcdFx0XHRcdGluZm8ubWV0YVtncnBdID0ge307XG5cdFx0XHRcdFx0XHRmb3IgKGkgPSAwLCBsZW5ndGggPSBtZXRhLmtleXMubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdFx0dGFnID0gbWV0YS5rZXlzW2ldO1xuXHRcdFx0XHRcdFx0XHR2YWx1ZSA9IG1ldGFbdGFnXTtcblx0XHRcdFx0XHRcdFx0aWYgKHZhbHVlKSB7XG5cdFx0XHRcdFx0XHRcdFx0Ly8gY29udmVydCBudW1iZXJzXG5cdFx0XHRcdFx0XHRcdFx0aWYgKC9eKFxcZHxbMS05XVxcZCspJC8udGVzdCh2YWx1ZSkpIHsgLy8gaW50ZWdlciAobWFrZSBzdXJlIGRvZXNuJ3Qgc3RhcnQgd2l0aCB6ZXJvKVxuXHRcdFx0XHRcdFx0XHRcdFx0dmFsdWUgPSBwYXJzZUludCh2YWx1ZSwgMTApO1xuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoL15cXGQqXFwuXFxkKyQvLnRlc3QodmFsdWUpKSB7IC8vIGRvdWJsZVxuXHRcdFx0XHRcdFx0XHRcdFx0dmFsdWUgPSBwYXJzZUZsb2F0KHZhbHVlKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0aW5mby5tZXRhW2dycF1bdGFnXSA9IHZhbHVlO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHQvLyBzYXZlIHRodW1iIGRhdGEgYXMgYmxvYlxuXHRcdFx0XHRpZiAoaW5mby5tZXRhICYmIGluZm8ubWV0YS50aHVtYiAmJiBpbmZvLm1ldGEudGh1bWIuZGF0YSAmJiAhKHNlbGYubWV0YS50aHVtYi5kYXRhIGluc3RhbmNlb2YgQmxvYikpIHtcblx0XHRcdFx0XHRpbmZvLm1ldGEudGh1bWIuZGF0YSA9IG5ldyBCbG9iKHNlbGYudWlkLCBpbmZvLm1ldGEudGh1bWIuZGF0YSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0aW5mby53aWR0aCA9IHBhcnNlSW50KHJhd0luZm8ud2lkdGgsIDEwKTtcblx0XHRcdGluZm8uaGVpZ2h0ID0gcGFyc2VJbnQocmF3SW5mby5oZWlnaHQsIDEwKTtcblx0XHRcdGluZm8uc2l6ZSA9IHBhcnNlSW50KHJhd0luZm8uc2l6ZSwgMTApO1xuXHRcdFx0aW5mby50eXBlID0gcmF3SW5mby50eXBlO1xuXHRcdFx0aW5mby5uYW1lID0gcmF3SW5mby5uYW1lO1xuXG5cdFx0XHRyZXR1cm4gaW5mbztcblx0XHR9LFxuXG5cdFx0cmVzaXplOiBmdW5jdGlvbihyZWN0LCByYXRpbywgb3B0cykge1xuXHRcdFx0dGhpcy5nZXRSdW50aW1lKCkuc2hpbUV4ZWMuY2FsbCh0aGlzLCAnSW1hZ2UnLCAncmVzaXplJywgcmVjdC54LCByZWN0LnksIHJlY3Qud2lkdGgsIHJlY3QuaGVpZ2h0LCByYXRpbywgb3B0cy5wcmVzZXJ2ZUhlYWRlcnMsIG9wdHMucmVzYW1wbGUpO1xuXHRcdH1cblx0fSkpO1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L3J1bnRpbWUvaHRtbDQvUnVudGltZS5qc1xuXG4vKipcbiAqIFJ1bnRpbWUuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuLypnbG9iYWwgRmlsZTp0cnVlICovXG5cbi8qKlxuRGVmaW5lcyBjb25zdHJ1Y3RvciBmb3IgSFRNTDQgcnVudGltZS5cblxuQGNsYXNzIG1veGllL3J1bnRpbWUvaHRtbDQvUnVudGltZVxuQHByaXZhdGVcbiovXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL2h0bWw0L1J1bnRpbWVcIiwgW1xuXHRcIm1veGllL2NvcmUvdXRpbHMvQmFzaWNcIixcblx0XCJtb3hpZS9jb3JlL0V4Y2VwdGlvbnNcIixcblx0XCJtb3hpZS9ydW50aW1lL1J1bnRpbWVcIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0VudlwiXG5dLCBmdW5jdGlvbihCYXNpYywgeCwgUnVudGltZSwgRW52KSB7XG5cdFxuXHR2YXIgdHlwZSA9ICdodG1sNCcsIGV4dGVuc2lvbnMgPSB7fTtcblxuXHRmdW5jdGlvbiBIdG1sNFJ1bnRpbWUob3B0aW9ucykge1xuXHRcdHZhciBJID0gdGhpc1xuXHRcdCwgVGVzdCA9IFJ1bnRpbWUuY2FwVGVzdFxuXHRcdCwgVHJ1ZSA9IFJ1bnRpbWUuY2FwVHJ1ZVxuXHRcdDtcblxuXHRcdFJ1bnRpbWUuY2FsbCh0aGlzLCBvcHRpb25zLCB0eXBlLCB7XG5cdFx0XHRhY2Nlc3NfYmluYXJ5OiBUZXN0KHdpbmRvdy5GaWxlUmVhZGVyIHx8IHdpbmRvdy5GaWxlICYmIEZpbGUuZ2V0QXNEYXRhVVJMKSxcblx0XHRcdGFjY2Vzc19pbWFnZV9iaW5hcnk6IGZhbHNlLFxuXHRcdFx0ZGlzcGxheV9tZWRpYTogVGVzdChcblx0XHRcdFx0KEVudi5jYW4oJ2NyZWF0ZV9jYW52YXMnKSB8fCBFbnYuY2FuKCd1c2VfZGF0YV91cmlfb3ZlcjMya2InKSkgJiYgXG5cdFx0XHRcdGRlZmluZWQoJ21veGllL2ltYWdlL0ltYWdlJylcblx0XHRcdCksXG5cdFx0XHRkb19jb3JzOiBmYWxzZSxcblx0XHRcdGRyYWdfYW5kX2Ryb3A6IGZhbHNlLFxuXHRcdFx0ZmlsdGVyX2J5X2V4dGVuc2lvbjogVGVzdChmdW5jdGlvbigpIHsgLy8gaWYgeW91IGtub3cgaG93IHRvIGZlYXR1cmUtZGV0ZWN0IHRoaXMsIHBsZWFzZSBzdWdnZXN0XG5cdFx0XHRcdHJldHVybiAhKFxuXHRcdFx0XHRcdChFbnYuYnJvd3NlciA9PT0gJ0Nocm9tZScgJiYgRW52LnZlckNvbXAoRW52LnZlcnNpb24sIDI4LCAnPCcpKSB8fCBcblx0XHRcdFx0XHQoRW52LmJyb3dzZXIgPT09ICdJRScgJiYgRW52LnZlckNvbXAoRW52LnZlcnNpb24sIDEwLCAnPCcpKSB8fCBcblx0XHRcdFx0XHQoRW52LmJyb3dzZXIgPT09ICdTYWZhcmknICYmIEVudi52ZXJDb21wKEVudi52ZXJzaW9uLCA3LCAnPCcpKSB8fFxuXHRcdFx0XHRcdChFbnYuYnJvd3NlciA9PT0gJ0ZpcmVmb3gnICYmIEVudi52ZXJDb21wKEVudi52ZXJzaW9uLCAzNywgJzwnKSlcblx0XHRcdFx0KTtcblx0XHRcdH0oKSksXG5cdFx0XHRyZXNpemVfaW1hZ2U6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gZXh0ZW5zaW9ucy5JbWFnZSAmJiBJLmNhbignYWNjZXNzX2JpbmFyeScpICYmIEVudi5jYW4oJ2NyZWF0ZV9jYW52YXMnKTtcblx0XHRcdH0sXG5cdFx0XHRyZXBvcnRfdXBsb2FkX3Byb2dyZXNzOiBmYWxzZSxcblx0XHRcdHJldHVybl9yZXNwb25zZV9oZWFkZXJzOiBmYWxzZSxcblx0XHRcdHJldHVybl9yZXNwb25zZV90eXBlOiBmdW5jdGlvbihyZXNwb25zZVR5cGUpIHtcblx0XHRcdFx0aWYgKHJlc3BvbnNlVHlwZSA9PT0gJ2pzb24nICYmICEhd2luZG93LkpTT04pIHtcblx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0fSBcblx0XHRcdFx0cmV0dXJuICEhfkJhc2ljLmluQXJyYXkocmVzcG9uc2VUeXBlLCBbJ3RleHQnLCAnZG9jdW1lbnQnLCAnJ10pO1xuXHRcdFx0fSxcblx0XHRcdHJldHVybl9zdGF0dXNfY29kZTogZnVuY3Rpb24oY29kZSkge1xuXHRcdFx0XHRyZXR1cm4gIUJhc2ljLmFycmF5RGlmZihjb2RlLCBbMjAwLCA0MDRdKTtcblx0XHRcdH0sXG5cdFx0XHRzZWxlY3RfZmlsZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiBFbnYuY2FuKCd1c2VfZmlsZWlucHV0Jyk7XG5cdFx0XHR9LFxuXHRcdFx0c2VsZWN0X211bHRpcGxlOiBmYWxzZSxcblx0XHRcdHNlbmRfYmluYXJ5X3N0cmluZzogZmFsc2UsXG5cdFx0XHRzZW5kX2N1c3RvbV9oZWFkZXJzOiBmYWxzZSxcblx0XHRcdHNlbmRfbXVsdGlwYXJ0OiB0cnVlLFxuXHRcdFx0c2xpY2VfYmxvYjogZmFsc2UsXG5cdFx0XHRzdHJlYW1fdXBsb2FkOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIEkuY2FuKCdzZWxlY3RfZmlsZScpO1xuXHRcdFx0fSxcblx0XHRcdHN1bW1vbl9maWxlX2RpYWxvZzogZnVuY3Rpb24oKSB7IC8vIHllYWguLi4gc29tZSBkaXJ0eSBzbmlmZmluZyBoZXJlLi4uXG5cdFx0XHRcdHJldHVybiBJLmNhbignc2VsZWN0X2ZpbGUnKSAmJiAhKFxuXHRcdFx0XHRcdChFbnYuYnJvd3NlciA9PT0gJ0ZpcmVmb3gnICYmIEVudi52ZXJDb21wKEVudi52ZXJzaW9uLCA0LCAnPCcpKSB8fFxuXHRcdFx0XHRcdChFbnYuYnJvd3NlciA9PT0gJ09wZXJhJyAmJiBFbnYudmVyQ29tcChFbnYudmVyc2lvbiwgMTIsICc8JykpIHx8XG5cdFx0XHRcdFx0KEVudi5icm93c2VyID09PSAnSUUnICYmIEVudi52ZXJDb21wKEVudi52ZXJzaW9uLCAxMCwgJzwnKSlcblx0XHRcdFx0KTtcblx0XHRcdH0sXG5cdFx0XHR1cGxvYWRfZmlsZXNpemU6IFRydWUsXG5cdFx0XHR1c2VfaHR0cF9tZXRob2Q6IGZ1bmN0aW9uKG1ldGhvZHMpIHtcblx0XHRcdFx0cmV0dXJuICFCYXNpYy5hcnJheURpZmYobWV0aG9kcywgWydHRVQnLCAnUE9TVCddKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXG5cdFx0QmFzaWMuZXh0ZW5kKHRoaXMsIHtcblx0XHRcdGluaXQgOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0dGhpcy50cmlnZ2VyKFwiSW5pdFwiKTtcblx0XHRcdH0sXG5cblx0XHRcdGRlc3Ryb3k6IChmdW5jdGlvbihkZXN0cm95KSB7IC8vIGV4dGVuZCBkZWZhdWx0IGRlc3Ryb3kgbWV0aG9kXG5cdFx0XHRcdHJldHVybiBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRkZXN0cm95LmNhbGwoSSk7XG5cdFx0XHRcdFx0ZGVzdHJveSA9IEkgPSBudWxsO1xuXHRcdFx0XHR9O1xuXHRcdFx0fSh0aGlzLmRlc3Ryb3kpKVxuXHRcdH0pO1xuXG5cdFx0QmFzaWMuZXh0ZW5kKHRoaXMuZ2V0U2hpbSgpLCBleHRlbnNpb25zKTtcblx0fVxuXG5cdFJ1bnRpbWUuYWRkQ29uc3RydWN0b3IodHlwZSwgSHRtbDRSdW50aW1lKTtcblxuXHRyZXR1cm4gZXh0ZW5zaW9ucztcbn0pO1xuXG4vLyBJbmNsdWRlZCBmcm9tOiBzcmMvamF2YXNjcmlwdC9ydW50aW1lL2h0bWw0L2ZpbGUvRmlsZUlucHV0LmpzXG5cbi8qKlxuICogRmlsZUlucHV0LmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG5cbi8qKlxuQGNsYXNzIG1veGllL3J1bnRpbWUvaHRtbDQvZmlsZS9GaWxlSW5wdXRcbkBwcml2YXRlXG4qL1xuZGVmaW5lKFwibW94aWUvcnVudGltZS9odG1sNC9maWxlL0ZpbGVJbnB1dFwiLCBbXG5cdFwibW94aWUvcnVudGltZS9odG1sNC9SdW50aW1lXCIsXG5cdFwibW94aWUvZmlsZS9GaWxlXCIsXG5cdFwibW94aWUvY29yZS91dGlscy9CYXNpY1wiLFxuXHRcIm1veGllL2NvcmUvdXRpbHMvRG9tXCIsXG5cdFwibW94aWUvY29yZS91dGlscy9FdmVudHNcIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL01pbWVcIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0VudlwiXG5dLCBmdW5jdGlvbihleHRlbnNpb25zLCBGaWxlLCBCYXNpYywgRG9tLCBFdmVudHMsIE1pbWUsIEVudikge1xuXHRcblx0ZnVuY3Rpb24gRmlsZUlucHV0KCkge1xuXHRcdHZhciBfdWlkLCBfbWltZXMgPSBbXSwgX29wdGlvbnMsIF9icm93c2VCdG5aSW5kZXg7IC8vIHNhdmUgb3JpZ2luYWwgei1pbmRleDtcblxuXHRcdGZ1bmN0aW9uIGFkZElucHV0KCkge1xuXHRcdFx0dmFyIGNvbXAgPSB0aGlzLCBJID0gY29tcC5nZXRSdW50aW1lKCksIHNoaW1Db250YWluZXIsIGJyb3dzZUJ1dHRvbiwgY3VyckZvcm0sIGZvcm0sIGlucHV0LCB1aWQ7XG5cblx0XHRcdHVpZCA9IEJhc2ljLmd1aWQoJ3VpZF8nKTtcblxuXHRcdFx0c2hpbUNvbnRhaW5lciA9IEkuZ2V0U2hpbUNvbnRhaW5lcigpOyAvLyB3ZSBnZXQgbmV3IHJlZiBldmVyeSB0aW1lIHRvIGF2b2lkIG1lbW9yeSBsZWFrcyBpbiBJRVxuXG5cdFx0XHRpZiAoX3VpZCkgeyAvLyBtb3ZlIHByZXZpb3VzIGZvcm0gb3V0IG9mIHRoZSB2aWV3XG5cdFx0XHRcdGN1cnJGb3JtID0gRG9tLmdldChfdWlkICsgJ19mb3JtJyk7XG5cdFx0XHRcdGlmIChjdXJyRm9ybSkge1xuXHRcdFx0XHRcdEJhc2ljLmV4dGVuZChjdXJyRm9ybS5zdHlsZSwgeyB0b3A6ICcxMDAlJyB9KTtcblx0XHRcdFx0XHQvLyBpdCBzaG91bGRuJ3QgYmUgcG9zc2libGUgdG8gdGFiIGludG8gdGhlIGhpZGRlbiBlbGVtZW50XG5cdFx0XHRcdFx0Y3VyckZvcm0uZmlyc3RDaGlsZC5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgLTEpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8vIGJ1aWxkIGZvcm0gaW4gRE9NLCBzaW5jZSBpbm5lckhUTUwgdmVyc2lvbiBub3QgYWJsZSB0byBzdWJtaXQgZmlsZSBmb3Igc29tZSByZWFzb25cblx0XHRcdGZvcm0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdmb3JtJyk7XG5cdFx0XHRmb3JtLnNldEF0dHJpYnV0ZSgnaWQnLCB1aWQgKyAnX2Zvcm0nKTtcblx0XHRcdGZvcm0uc2V0QXR0cmlidXRlKCdtZXRob2QnLCAncG9zdCcpO1xuXHRcdFx0Zm9ybS5zZXRBdHRyaWJ1dGUoJ2VuY3R5cGUnLCAnbXVsdGlwYXJ0L2Zvcm0tZGF0YScpO1xuXHRcdFx0Zm9ybS5zZXRBdHRyaWJ1dGUoJ2VuY29kaW5nJywgJ211bHRpcGFydC9mb3JtLWRhdGEnKTtcblxuXHRcdFx0QmFzaWMuZXh0ZW5kKGZvcm0uc3R5bGUsIHtcblx0XHRcdFx0b3ZlcmZsb3c6ICdoaWRkZW4nLFxuXHRcdFx0XHRwb3NpdGlvbjogJ2Fic29sdXRlJyxcblx0XHRcdFx0dG9wOiAwLFxuXHRcdFx0XHRsZWZ0OiAwLFxuXHRcdFx0XHR3aWR0aDogJzEwMCUnLFxuXHRcdFx0XHRoZWlnaHQ6ICcxMDAlJ1xuXHRcdFx0fSk7XG5cblx0XHRcdGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcblx0XHRcdGlucHV0LnNldEF0dHJpYnV0ZSgnaWQnLCB1aWQpO1xuXHRcdFx0aW5wdXQuc2V0QXR0cmlidXRlKCd0eXBlJywgJ2ZpbGUnKTtcblx0XHRcdGlucHV0LnNldEF0dHJpYnV0ZSgnYWNjZXB0JywgX21pbWVzLmpvaW4oJywnKSk7XG5cblx0XHRcdGlmIChJLmNhbignc3VtbW9uX2ZpbGVfZGlhbG9nJykpIHtcblx0XHRcdFx0aW5wdXQuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsIC0xKTtcblx0XHRcdH1cblxuXHRcdFx0QmFzaWMuZXh0ZW5kKGlucHV0LnN0eWxlLCB7XG5cdFx0XHRcdGZvbnRTaXplOiAnOTk5cHgnLFxuXHRcdFx0XHRvcGFjaXR5OiAwXG5cdFx0XHR9KTtcblxuXHRcdFx0Zm9ybS5hcHBlbmRDaGlsZChpbnB1dCk7XG5cdFx0XHRzaGltQ29udGFpbmVyLmFwcGVuZENoaWxkKGZvcm0pO1xuXG5cdFx0XHQvLyBwcmVwYXJlIGZpbGUgaW5wdXQgdG8gYmUgcGxhY2VkIHVuZGVybmVhdGggdGhlIGJyb3dzZV9idXR0b24gZWxlbWVudFxuXHRcdFx0QmFzaWMuZXh0ZW5kKGlucHV0LnN0eWxlLCB7XG5cdFx0XHRcdHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuXHRcdFx0XHR0b3A6IDAsXG5cdFx0XHRcdGxlZnQ6IDAsXG5cdFx0XHRcdHdpZHRoOiAnMTAwJScsXG5cdFx0XHRcdGhlaWdodDogJzEwMCUnXG5cdFx0XHR9KTtcblxuXHRcdFx0aWYgKEVudi5icm93c2VyID09PSAnSUUnICYmIEVudi52ZXJDb21wKEVudi52ZXJzaW9uLCAxMCwgJzwnKSkge1xuXHRcdFx0XHRCYXNpYy5leHRlbmQoaW5wdXQuc3R5bGUsIHtcblx0XHRcdFx0XHRmaWx0ZXIgOiBcInByb2dpZDpEWEltYWdlVHJhbnNmb3JtLk1pY3Jvc29mdC5BbHBoYShvcGFjaXR5PTApXCJcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cblx0XHRcdGlucHV0Lm9uY2hhbmdlID0gZnVuY3Rpb24oKSB7IC8vIHRoZXJlIHNob3VsZCBiZSBvbmx5IG9uZSBoYW5kbGVyIGZvciB0aGlzXG5cdFx0XHRcdHZhciBmaWxlO1xuXG5cdFx0XHRcdGlmICghdGhpcy52YWx1ZSkge1xuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmICh0aGlzLmZpbGVzKSB7IC8vIGNoZWNrIGlmIGJyb3dzZXIgaXMgZnJlc2ggZW5vdWdoXG5cdFx0XHRcdFx0ZmlsZSA9IHRoaXMuZmlsZXNbMF07XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0ZmlsZSA9IHtcblx0XHRcdFx0XHRcdG5hbWU6IHRoaXMudmFsdWVcblx0XHRcdFx0XHR9O1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0ZmlsZSA9IG5ldyBGaWxlKEkudWlkLCBmaWxlKTtcblxuXHRcdFx0XHQvLyBjbGVhciBldmVudCBoYW5kbGVyXG5cdFx0XHRcdHRoaXMub25jaGFuZ2UgPSBmdW5jdGlvbigpIHt9OyBcblx0XHRcdFx0YWRkSW5wdXQuY2FsbChjb21wKTsgXG5cblx0XHRcdFx0Y29tcC5maWxlcyA9IFtmaWxlXTtcblxuXHRcdFx0XHQvLyBzdWJzdGl0dXRlIGFsbCBpZHMgd2l0aCBmaWxlIHVpZHMgKGNvbnNpZGVyIGZpbGUudWlkIHJlYWQtb25seSAtIHdlIGNhbm5vdCBkbyBpdCB0aGUgb3RoZXIgd2F5IGFyb3VuZClcblx0XHRcdFx0aW5wdXQuc2V0QXR0cmlidXRlKCdpZCcsIGZpbGUudWlkKTtcblx0XHRcdFx0Zm9ybS5zZXRBdHRyaWJ1dGUoJ2lkJywgZmlsZS51aWQgKyAnX2Zvcm0nKTtcblx0XHRcdFx0XG5cdFx0XHRcdGNvbXAudHJpZ2dlcignY2hhbmdlJyk7XG5cblx0XHRcdFx0aW5wdXQgPSBmb3JtID0gbnVsbDtcblx0XHRcdH07XG5cblxuXHRcdFx0Ly8gcm91dGUgY2xpY2sgZXZlbnQgdG8gdGhlIGlucHV0XG5cdFx0XHRpZiAoSS5jYW4oJ3N1bW1vbl9maWxlX2RpYWxvZycpKSB7XG5cdFx0XHRcdGJyb3dzZUJ1dHRvbiA9IERvbS5nZXQoX29wdGlvbnMuYnJvd3NlX2J1dHRvbik7XG5cdFx0XHRcdEV2ZW50cy5yZW1vdmVFdmVudChicm93c2VCdXR0b24sICdjbGljaycsIGNvbXAudWlkKTtcblx0XHRcdFx0RXZlbnRzLmFkZEV2ZW50KGJyb3dzZUJ1dHRvbiwgJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuXHRcdFx0XHRcdGlmIChpbnB1dCAmJiAhaW5wdXQuZGlzYWJsZWQpIHsgLy8gZm9yIHNvbWUgcmVhc29uIEZGICh1cCB0byA4LjAuMSBzbyBmYXIpIGxldHMgdG8gY2xpY2sgZGlzYWJsZWQgaW5wdXRbdHlwZT1maWxlXVxuXHRcdFx0XHRcdFx0aW5wdXQuY2xpY2soKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHR9LCBjb21wLnVpZCk7XG5cdFx0XHR9XG5cblx0XHRcdF91aWQgPSB1aWQ7XG5cblx0XHRcdHNoaW1Db250YWluZXIgPSBjdXJyRm9ybSA9IGJyb3dzZUJ1dHRvbiA9IG51bGw7XG5cdFx0fVxuXG5cdFx0QmFzaWMuZXh0ZW5kKHRoaXMsIHtcblx0XHRcdGluaXQ6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHRcdFx0dmFyIGNvbXAgPSB0aGlzLCBJID0gY29tcC5nZXRSdW50aW1lKCksIHNoaW1Db250YWluZXI7XG5cblx0XHRcdFx0Ly8gZmlndXJlIG91dCBhY2NlcHQgc3RyaW5nXG5cdFx0XHRcdF9vcHRpb25zID0gb3B0aW9ucztcblx0XHRcdFx0X21pbWVzID0gTWltZS5leHRMaXN0Mm1pbWVzKG9wdGlvbnMuYWNjZXB0LCBJLmNhbignZmlsdGVyX2J5X2V4dGVuc2lvbicpKTtcblxuXHRcdFx0XHRzaGltQ29udGFpbmVyID0gSS5nZXRTaGltQ29udGFpbmVyKCk7XG5cblx0XHRcdFx0KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdHZhciBicm93c2VCdXR0b24sIHpJbmRleCwgdG9wO1xuXG5cdFx0XHRcdFx0YnJvd3NlQnV0dG9uID0gRG9tLmdldChvcHRpb25zLmJyb3dzZV9idXR0b24pO1xuXHRcdFx0XHRcdF9icm93c2VCdG5aSW5kZXggPSBEb20uZ2V0U3R5bGUoYnJvd3NlQnV0dG9uLCAnei1pbmRleCcpIHx8ICdhdXRvJztcblxuXHRcdFx0XHRcdC8vIFJvdXRlIGNsaWNrIGV2ZW50IHRvIHRoZSBpbnB1dFt0eXBlPWZpbGVdIGVsZW1lbnQgZm9yIGJyb3dzZXJzIHRoYXQgc3VwcG9ydCBzdWNoIGJlaGF2aW9yXG5cdFx0XHRcdFx0aWYgKEkuY2FuKCdzdW1tb25fZmlsZV9kaWFsb2cnKSkge1xuXHRcdFx0XHRcdFx0aWYgKERvbS5nZXRTdHlsZShicm93c2VCdXR0b24sICdwb3NpdGlvbicpID09PSAnc3RhdGljJykge1xuXHRcdFx0XHRcdFx0XHRicm93c2VCdXR0b24uc3R5bGUucG9zaXRpb24gPSAncmVsYXRpdmUnO1xuXHRcdFx0XHRcdFx0fVx0XHRcdFx0XHRcdFxuXG5cdFx0XHRcdFx0XHRjb21wLmJpbmQoJ1JlZnJlc2gnLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFx0ekluZGV4ID0gcGFyc2VJbnQoX2Jyb3dzZUJ0blpJbmRleCwgMTApIHx8IDE7XG5cblx0XHRcdFx0XHRcdFx0RG9tLmdldChfb3B0aW9ucy5icm93c2VfYnV0dG9uKS5zdHlsZS56SW5kZXggPSB6SW5kZXg7XG5cdFx0XHRcdFx0XHRcdHRoaXMuZ2V0UnVudGltZSgpLmdldFNoaW1Db250YWluZXIoKS5zdHlsZS56SW5kZXggPSB6SW5kZXggLSAxO1xuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdC8vIGl0IHNob3VsZG4ndCBiZSBwb3NzaWJsZSB0byB0YWIgaW50byB0aGUgaGlkZGVuIGVsZW1lbnRcblx0XHRcdFx0XHRcdGJyb3dzZUJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgLTEpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8qIFNpbmNlIHdlIGhhdmUgdG8gcGxhY2UgaW5wdXRbdHlwZT1maWxlXSBvbiB0b3Agb2YgdGhlIGJyb3dzZV9idXR0b24gZm9yIHNvbWUgYnJvd3NlcnMsXG5cdFx0XHRcdFx0YnJvd3NlX2J1dHRvbiBsb3NlcyBpbnRlcmFjdGl2aXR5LCBzbyB3ZSByZXN0b3JlIGl0IGhlcmUgKi9cblx0XHRcdFx0XHR0b3AgPSBJLmNhbignc3VtbW9uX2ZpbGVfZGlhbG9nJykgPyBicm93c2VCdXR0b24gOiBzaGltQ29udGFpbmVyO1xuXG5cdFx0XHRcdFx0RXZlbnRzLmFkZEV2ZW50KHRvcCwgJ21vdXNlb3ZlcicsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0Y29tcC50cmlnZ2VyKCdtb3VzZWVudGVyJyk7XG5cdFx0XHRcdFx0fSwgY29tcC51aWQpO1xuXG5cdFx0XHRcdFx0RXZlbnRzLmFkZEV2ZW50KHRvcCwgJ21vdXNlb3V0JywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRjb21wLnRyaWdnZXIoJ21vdXNlbGVhdmUnKTtcblx0XHRcdFx0XHR9LCBjb21wLnVpZCk7XG5cblx0XHRcdFx0XHRFdmVudHMuYWRkRXZlbnQodG9wLCAnbW91c2Vkb3duJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRjb21wLnRyaWdnZXIoJ21vdXNlZG93bicpO1xuXHRcdFx0XHRcdH0sIGNvbXAudWlkKTtcblxuXHRcdFx0XHRcdEV2ZW50cy5hZGRFdmVudChEb20uZ2V0KG9wdGlvbnMuY29udGFpbmVyKSwgJ21vdXNldXAnLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdGNvbXAudHJpZ2dlcignbW91c2V1cCcpO1xuXHRcdFx0XHRcdH0sIGNvbXAudWlkKTtcblxuXHRcdFx0XHRcdGJyb3dzZUJ1dHRvbiA9IG51bGw7XG5cdFx0XHRcdH0oKSk7XG5cblx0XHRcdFx0YWRkSW5wdXQuY2FsbCh0aGlzKTtcblxuXHRcdFx0XHRzaGltQ29udGFpbmVyID0gbnVsbDtcblxuXHRcdFx0XHQvLyB0cmlnZ2VyIHJlYWR5IGV2ZW50IGFzeW5jaHJvbm91c2x5XG5cdFx0XHRcdGNvbXAudHJpZ2dlcih7XG5cdFx0XHRcdFx0dHlwZTogJ3JlYWR5Jyxcblx0XHRcdFx0XHRhc3luYzogdHJ1ZVxuXHRcdFx0XHR9KTtcblx0XHRcdH0sXG5cblx0XHRcdHNldE9wdGlvbjogZnVuY3Rpb24obmFtZSwgdmFsdWUpIHtcblx0XHRcdFx0dmFyIEkgPSB0aGlzLmdldFJ1bnRpbWUoKTtcblx0XHRcdFx0dmFyIGlucHV0O1xuXG5cdFx0XHRcdGlmIChuYW1lID09ICdhY2NlcHQnKSB7XG5cdFx0XHRcdFx0X21pbWVzID0gdmFsdWUubWltZXMgfHwgTWltZS5leHRMaXN0Mm1pbWVzKHZhbHVlLCBJLmNhbignZmlsdGVyX2J5X2V4dGVuc2lvbicpKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIHVwZGF0ZSBjdXJyZW50IGlucHV0XG5cdFx0XHRcdGlucHV0ID0gRG9tLmdldChfdWlkKVxuXHRcdFx0XHRpZiAoaW5wdXQpIHtcblx0XHRcdFx0XHRpbnB1dC5zZXRBdHRyaWJ1dGUoJ2FjY2VwdCcsIF9taW1lcy5qb2luKCcsJykpO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXG5cblx0XHRcdGRpc2FibGU6IGZ1bmN0aW9uKHN0YXRlKSB7XG5cdFx0XHRcdHZhciBpbnB1dDtcblxuXHRcdFx0XHRpZiAoKGlucHV0ID0gRG9tLmdldChfdWlkKSkpIHtcblx0XHRcdFx0XHRpbnB1dC5kaXNhYmxlZCA9ICEhc3RhdGU7XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cblx0XHRcdGRlc3Ryb3k6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR2YXIgSSA9IHRoaXMuZ2V0UnVudGltZSgpXG5cdFx0XHRcdCwgc2hpbSA9IEkuZ2V0U2hpbSgpXG5cdFx0XHRcdCwgc2hpbUNvbnRhaW5lciA9IEkuZ2V0U2hpbUNvbnRhaW5lcigpXG5cdFx0XHRcdCwgY29udGFpbmVyID0gX29wdGlvbnMgJiYgRG9tLmdldChfb3B0aW9ucy5jb250YWluZXIpXG5cdFx0XHRcdCwgYnJvd3NlQnV0dG9uID0gX29wdGlvbnMgJiYgRG9tLmdldChfb3B0aW9ucy5icm93c2VfYnV0dG9uKVxuXHRcdFx0XHQ7XG5cdFx0XHRcdFxuXHRcdFx0XHRpZiAoY29udGFpbmVyKSB7XG5cdFx0XHRcdFx0RXZlbnRzLnJlbW92ZUFsbEV2ZW50cyhjb250YWluZXIsIHRoaXMudWlkKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0aWYgKGJyb3dzZUJ1dHRvbikge1xuXHRcdFx0XHRcdEV2ZW50cy5yZW1vdmVBbGxFdmVudHMoYnJvd3NlQnV0dG9uLCB0aGlzLnVpZCk7XG5cdFx0XHRcdFx0YnJvd3NlQnV0dG9uLnN0eWxlLnpJbmRleCA9IF9icm93c2VCdG5aSW5kZXg7IC8vIHJlc2V0IHRvIG9yaWdpbmFsIHZhbHVlXG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdGlmIChzaGltQ29udGFpbmVyKSB7XG5cdFx0XHRcdFx0RXZlbnRzLnJlbW92ZUFsbEV2ZW50cyhzaGltQ29udGFpbmVyLCB0aGlzLnVpZCk7XG5cdFx0XHRcdFx0c2hpbUNvbnRhaW5lci5pbm5lckhUTUwgPSAnJztcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHNoaW0ucmVtb3ZlSW5zdGFuY2UodGhpcy51aWQpO1xuXG5cdFx0XHRcdF91aWQgPSBfbWltZXMgPSBfb3B0aW9ucyA9IHNoaW1Db250YWluZXIgPSBjb250YWluZXIgPSBicm93c2VCdXR0b24gPSBzaGltID0gbnVsbDtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdHJldHVybiAoZXh0ZW5zaW9ucy5GaWxlSW5wdXQgPSBGaWxlSW5wdXQpO1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L3J1bnRpbWUvaHRtbDQvZmlsZS9GaWxlUmVhZGVyLmpzXG5cbi8qKlxuICogRmlsZVJlYWRlci5qc1xuICpcbiAqIENvcHlyaWdodCAyMDEzLCBNb3hpZWNvZGUgU3lzdGVtcyBBQlxuICogUmVsZWFzZWQgdW5kZXIgR1BMIExpY2Vuc2UuXG4gKlxuICogTGljZW5zZTogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vbGljZW5zZVxuICogQ29udHJpYnV0aW5nOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9jb250cmlidXRpbmdcbiAqL1xuXG4vKipcbkBjbGFzcyBtb3hpZS9ydW50aW1lL2h0bWw0L2ZpbGUvRmlsZVJlYWRlclxuQHByaXZhdGVcbiovXG5kZWZpbmUoXCJtb3hpZS9ydW50aW1lL2h0bWw0L2ZpbGUvRmlsZVJlYWRlclwiLCBbXG5cdFwibW94aWUvcnVudGltZS9odG1sNC9SdW50aW1lXCIsXG5cdFwibW94aWUvcnVudGltZS9odG1sNS9maWxlL0ZpbGVSZWFkZXJcIlxuXSwgZnVuY3Rpb24oZXh0ZW5zaW9ucywgRmlsZVJlYWRlcikge1xuXHRyZXR1cm4gKGV4dGVuc2lvbnMuRmlsZVJlYWRlciA9IEZpbGVSZWFkZXIpO1xufSk7XG5cbi8vIEluY2x1ZGVkIGZyb206IHNyYy9qYXZhc2NyaXB0L3J1bnRpbWUvaHRtbDQveGhyL1hNTEh0dHBSZXF1ZXN0LmpzXG5cbi8qKlxuICogWE1MSHR0cFJlcXVlc3QuanNcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMywgTW94aWVjb2RlIFN5c3RlbXMgQUJcbiAqIFJlbGVhc2VkIHVuZGVyIEdQTCBMaWNlbnNlLlxuICpcbiAqIExpY2Vuc2U6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2xpY2Vuc2VcbiAqIENvbnRyaWJ1dGluZzogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vY29udHJpYnV0aW5nXG4gKi9cblxuLyoqXG5AY2xhc3MgbW94aWUvcnVudGltZS9odG1sNC94aHIvWE1MSHR0cFJlcXVlc3RcbkBwcml2YXRlXG4qL1xuZGVmaW5lKFwibW94aWUvcnVudGltZS9odG1sNC94aHIvWE1MSHR0cFJlcXVlc3RcIiwgW1xuXHRcIm1veGllL3J1bnRpbWUvaHRtbDQvUnVudGltZVwiLFxuXHRcIm1veGllL2NvcmUvdXRpbHMvQmFzaWNcIixcblx0XCJtb3hpZS9jb3JlL3V0aWxzL0RvbVwiLFxuXHRcIm1veGllL2NvcmUvdXRpbHMvVXJsXCIsXG5cdFwibW94aWUvY29yZS9FeGNlcHRpb25zXCIsXG5cdFwibW94aWUvY29yZS91dGlscy9FdmVudHNcIixcblx0XCJtb3hpZS9maWxlL0Jsb2JcIixcblx0XCJtb3hpZS94aHIvRm9ybURhdGFcIlxuXSwgZnVuY3Rpb24oZXh0ZW5zaW9ucywgQmFzaWMsIERvbSwgVXJsLCB4LCBFdmVudHMsIEJsb2IsIEZvcm1EYXRhKSB7XG5cdFxuXHRmdW5jdGlvbiBYTUxIdHRwUmVxdWVzdCgpIHtcblx0XHR2YXIgX3N0YXR1cywgX3Jlc3BvbnNlLCBfaWZyYW1lO1xuXG5cdFx0ZnVuY3Rpb24gY2xlYW51cChjYikge1xuXHRcdFx0dmFyIHRhcmdldCA9IHRoaXMsIHVpZCwgZm9ybSwgaW5wdXRzLCBpLCBoYXNGaWxlID0gZmFsc2U7XG5cblx0XHRcdGlmICghX2lmcmFtZSkge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdHVpZCA9IF9pZnJhbWUuaWQucmVwbGFjZSgvX2lmcmFtZSQvLCAnJyk7XG5cblx0XHRcdGZvcm0gPSBEb20uZ2V0KHVpZCArICdfZm9ybScpO1xuXHRcdFx0aWYgKGZvcm0pIHtcblx0XHRcdFx0aW5wdXRzID0gZm9ybS5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaW5wdXQnKTtcblx0XHRcdFx0aSA9IGlucHV0cy5sZW5ndGg7XG5cblx0XHRcdFx0d2hpbGUgKGktLSkge1xuXHRcdFx0XHRcdHN3aXRjaCAoaW5wdXRzW2ldLmdldEF0dHJpYnV0ZSgndHlwZScpKSB7XG5cdFx0XHRcdFx0XHRjYXNlICdoaWRkZW4nOlxuXHRcdFx0XHRcdFx0XHRpbnB1dHNbaV0ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChpbnB1dHNbaV0pO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdGNhc2UgJ2ZpbGUnOlxuXHRcdFx0XHRcdFx0XHRoYXNGaWxlID0gdHJ1ZTsgLy8gZmxhZyB0aGUgY2FzZSBmb3IgbGF0ZXJcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdGlucHV0cyA9IFtdO1xuXG5cdFx0XHRcdGlmICghaGFzRmlsZSkgeyAvLyB3ZSBuZWVkIHRvIGtlZXAgdGhlIGZvcm0gZm9yIHNha2Ugb2YgcG9zc2libGUgcmV0cmllc1xuXHRcdFx0XHRcdGZvcm0ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChmb3JtKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRmb3JtID0gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0Ly8gd2l0aG91dCB0aW1lb3V0LCByZXF1ZXN0IGlzIG1hcmtlZCBhcyBjYW5jZWxlZCAoaW4gY29uc29sZSlcblx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdEV2ZW50cy5yZW1vdmVFdmVudChfaWZyYW1lLCAnbG9hZCcsIHRhcmdldC51aWQpO1xuXHRcdFx0XHRpZiAoX2lmcmFtZS5wYXJlbnROb2RlKSB7IC8vICMzODJcblx0XHRcdFx0XHRfaWZyYW1lLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoX2lmcmFtZSk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBjaGVjayBpZiBzaGltIGNvbnRhaW5lciBoYXMgYW55IG90aGVyIGNoaWxkcmVuLCBpZiAtIG5vdCwgcmVtb3ZlIGl0IGFzIHdlbGxcblx0XHRcdFx0dmFyIHNoaW1Db250YWluZXIgPSB0YXJnZXQuZ2V0UnVudGltZSgpLmdldFNoaW1Db250YWluZXIoKTtcblx0XHRcdFx0aWYgKCFzaGltQ29udGFpbmVyLmNoaWxkcmVuLmxlbmd0aCkge1xuXHRcdFx0XHRcdHNoaW1Db250YWluZXIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChzaGltQ29udGFpbmVyKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHNoaW1Db250YWluZXIgPSBfaWZyYW1lID0gbnVsbDtcblx0XHRcdFx0Y2IoKTtcblx0XHRcdH0sIDEpO1xuXHRcdH1cblxuXHRcdEJhc2ljLmV4dGVuZCh0aGlzLCB7XG5cdFx0XHRzZW5kOiBmdW5jdGlvbihtZXRhLCBkYXRhKSB7XG5cdFx0XHRcdHZhciB0YXJnZXQgPSB0aGlzLCBJID0gdGFyZ2V0LmdldFJ1bnRpbWUoKSwgdWlkLCBmb3JtLCBpbnB1dCwgYmxvYjtcblxuXHRcdFx0XHRfc3RhdHVzID0gX3Jlc3BvbnNlID0gbnVsbDtcblxuXHRcdFx0XHRmdW5jdGlvbiBjcmVhdGVJZnJhbWUoKSB7XG5cdFx0XHRcdFx0dmFyIGNvbnRhaW5lciA9IEkuZ2V0U2hpbUNvbnRhaW5lcigpIHx8IGRvY3VtZW50LmJvZHlcblx0XHRcdFx0XHQsIHRlbXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuXHRcdFx0XHRcdDtcblxuXHRcdFx0XHRcdC8vIElFIDYgd29uJ3QgYmUgYWJsZSB0byBzZXQgdGhlIG5hbWUgdXNpbmcgc2V0QXR0cmlidXRlIG9yIGlmcmFtZS5uYW1lXG5cdFx0XHRcdFx0dGVtcC5pbm5lckhUTUwgPSAnPGlmcmFtZSBpZD1cIicgKyB1aWQgKyAnX2lmcmFtZVwiIG5hbWU9XCInICsgdWlkICsgJ19pZnJhbWVcIiBzcmM9XCJqYXZhc2NyaXB0OiZxdW90OyZxdW90O1wiIHN0eWxlPVwiZGlzcGxheTpub25lXCI+PC9pZnJhbWU+Jztcblx0XHRcdFx0XHRfaWZyYW1lID0gdGVtcC5maXJzdENoaWxkO1xuXHRcdFx0XHRcdGNvbnRhaW5lci5hcHBlbmRDaGlsZChfaWZyYW1lKTtcblxuXHRcdFx0XHRcdC8qIF9pZnJhbWUub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRjb25zb2xlLmluZm8oX2lmcmFtZS5yZWFkeVN0YXRlKTtcblx0XHRcdFx0XHR9OyovXG5cblx0XHRcdFx0XHRFdmVudHMuYWRkRXZlbnQoX2lmcmFtZSwgJ2xvYWQnLCBmdW5jdGlvbigpIHsgLy8gX2lmcmFtZS5vbmxvYWQgZG9lc24ndCB3b3JrIGluIElFIGx0ZSA4XG5cdFx0XHRcdFx0XHR2YXIgZWw7XG5cblx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdGVsID0gX2lmcmFtZS5jb250ZW50V2luZG93LmRvY3VtZW50IHx8IF9pZnJhbWUuY29udGVudERvY3VtZW50IHx8IHdpbmRvdy5mcmFtZXNbX2lmcmFtZS5pZF0uZG9jdW1lbnQ7XG5cblx0XHRcdFx0XHRcdFx0Ly8gdHJ5IHRvIGRldGVjdCBzb21lIHN0YW5kYXJkIGVycm9yIHBhZ2VzXG5cdFx0XHRcdFx0XHRcdGlmICgvXjQoMFswLTldfDFbMC03XXwyWzIzNDZdKVxccy8udGVzdChlbC50aXRsZSkpIHsgLy8gdGVzdCBpZiB0aXRsZSBzdGFydHMgd2l0aCA0eHggSFRUUCBlcnJvclxuXHRcdFx0XHRcdFx0XHRcdF9zdGF0dXMgPSBlbC50aXRsZS5yZXBsYWNlKC9eKFxcZCspLiokLywgJyQxJyk7XG5cdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0X3N0YXR1cyA9IDIwMDtcblx0XHRcdFx0XHRcdFx0XHQvLyBnZXQgcmVzdWx0XG5cdFx0XHRcdFx0XHRcdFx0X3Jlc3BvbnNlID0gQmFzaWMudHJpbShlbC5ib2R5LmlubmVySFRNTCk7XG5cblx0XHRcdFx0XHRcdFx0XHQvLyB3ZSBuZWVkIHRvIGZpcmUgdGhlc2UgYXQgbGVhc3Qgb25jZVxuXHRcdFx0XHRcdFx0XHRcdHRhcmdldC50cmlnZ2VyKHtcblx0XHRcdFx0XHRcdFx0XHRcdHR5cGU6ICdwcm9ncmVzcycsXG5cdFx0XHRcdFx0XHRcdFx0XHRsb2FkZWQ6IF9yZXNwb25zZS5sZW5ndGgsXG5cdFx0XHRcdFx0XHRcdFx0XHR0b3RhbDogX3Jlc3BvbnNlLmxlbmd0aFxuXHRcdFx0XHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdFx0XHRcdFx0aWYgKGJsb2IpIHsgLy8gaWYgd2Ugd2VyZSB1cGxvYWRpbmcgYSBmaWxlXG5cdFx0XHRcdFx0XHRcdFx0XHR0YXJnZXQudHJpZ2dlcih7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHR5cGU6ICd1cGxvYWRwcm9ncmVzcycsXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGxvYWRlZDogYmxvYi5zaXplIHx8IDEwMjUsXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHRvdGFsOiBibG9iLnNpemUgfHwgMTAyNVxuXHRcdFx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9IGNhdGNoIChleCkge1xuXHRcdFx0XHRcdFx0XHRpZiAoVXJsLmhhc1NhbWVPcmlnaW4obWV0YS51cmwpKSB7XG5cdFx0XHRcdFx0XHRcdFx0Ly8gaWYgcmVzcG9uc2UgaXMgc2VudCB3aXRoIGVycm9yIGNvZGUsIGlmcmFtZSBpbiBJRSBnZXRzIHJlZGlyZWN0ZWQgdG8gcmVzOi8vaWVmcmFtZS5kbGwvaHR0cF94Lmh0bVxuXHRcdFx0XHRcdFx0XHRcdC8vIHdoaWNoIG9idmlvdXNseSByZXN1bHRzIHRvIGNyb3NzIGRvbWFpbiBlcnJvciAod3RmPylcblx0XHRcdFx0XHRcdFx0XHRfc3RhdHVzID0gNDA0O1xuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdGNsZWFudXAuY2FsbCh0YXJnZXQsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0dGFyZ2V0LnRyaWdnZXIoJ2Vycm9yJyk7XG5cdFx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XHRcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdGNsZWFudXAuY2FsbCh0YXJnZXQsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0XHR0YXJnZXQudHJpZ2dlcignbG9hZCcpO1xuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0fSwgdGFyZ2V0LnVpZCk7XG5cdFx0XHRcdH0gLy8gZW5kIGNyZWF0ZUlmcmFtZVxuXG5cdFx0XHRcdC8vIHByZXBhcmUgZGF0YSB0byBiZSBzZW50IGFuZCBjb252ZXJ0IGlmIHJlcXVpcmVkXG5cdFx0XHRcdGlmIChkYXRhIGluc3RhbmNlb2YgRm9ybURhdGEgJiYgZGF0YS5oYXNCbG9iKCkpIHtcblx0XHRcdFx0XHRibG9iID0gZGF0YS5nZXRCbG9iKCk7XG5cdFx0XHRcdFx0dWlkID0gYmxvYi51aWQ7XG5cdFx0XHRcdFx0aW5wdXQgPSBEb20uZ2V0KHVpZCk7XG5cdFx0XHRcdFx0Zm9ybSA9IERvbS5nZXQodWlkICsgJ19mb3JtJyk7XG5cdFx0XHRcdFx0aWYgKCFmb3JtKSB7XG5cdFx0XHRcdFx0XHR0aHJvdyBuZXcgeC5ET01FeGNlcHRpb24oeC5ET01FeGNlcHRpb24uTk9UX0ZPVU5EX0VSUik7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHVpZCA9IEJhc2ljLmd1aWQoJ3VpZF8nKTtcblxuXHRcdFx0XHRcdGZvcm0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdmb3JtJyk7XG5cdFx0XHRcdFx0Zm9ybS5zZXRBdHRyaWJ1dGUoJ2lkJywgdWlkICsgJ19mb3JtJyk7XG5cdFx0XHRcdFx0Zm9ybS5zZXRBdHRyaWJ1dGUoJ21ldGhvZCcsIG1ldGEubWV0aG9kKTtcblx0XHRcdFx0XHRmb3JtLnNldEF0dHJpYnV0ZSgnZW5jdHlwZScsICdtdWx0aXBhcnQvZm9ybS1kYXRhJyk7XG5cdFx0XHRcdFx0Zm9ybS5zZXRBdHRyaWJ1dGUoJ2VuY29kaW5nJywgJ211bHRpcGFydC9mb3JtLWRhdGEnKTtcblxuXHRcdFx0XHRcdEkuZ2V0U2hpbUNvbnRhaW5lcigpLmFwcGVuZENoaWxkKGZvcm0pO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gc2V0IHVwbG9hZCB0YXJnZXRcblx0XHRcdFx0Zm9ybS5zZXRBdHRyaWJ1dGUoJ3RhcmdldCcsIHVpZCArICdfaWZyYW1lJyk7XG5cblx0XHRcdFx0aWYgKGRhdGEgaW5zdGFuY2VvZiBGb3JtRGF0YSkge1xuXHRcdFx0XHRcdGRhdGEuZWFjaChmdW5jdGlvbih2YWx1ZSwgbmFtZSkge1xuXHRcdFx0XHRcdFx0aWYgKHZhbHVlIGluc3RhbmNlb2YgQmxvYikge1xuXHRcdFx0XHRcdFx0XHRpZiAoaW5wdXQpIHtcblx0XHRcdFx0XHRcdFx0XHRpbnB1dC5zZXRBdHRyaWJ1dGUoJ25hbWUnLCBuYW1lKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0dmFyIGhpZGRlbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XG5cblx0XHRcdFx0XHRcdFx0QmFzaWMuZXh0ZW5kKGhpZGRlbiwge1xuXHRcdFx0XHRcdFx0XHRcdHR5cGUgOiAnaGlkZGVuJyxcblx0XHRcdFx0XHRcdFx0XHRuYW1lIDogbmFtZSxcblx0XHRcdFx0XHRcdFx0XHR2YWx1ZSA6IHZhbHVlXG5cdFx0XHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdFx0XHRcdC8vIG1ha2Ugc3VyZSB0aGF0IGlucHV0W3R5cGU9XCJmaWxlXCJdLCBpZiBpdCdzIHRoZXJlLCBjb21lcyBsYXN0XG5cdFx0XHRcdFx0XHRcdGlmIChpbnB1dCkge1xuXHRcdFx0XHRcdFx0XHRcdGZvcm0uaW5zZXJ0QmVmb3JlKGhpZGRlbiwgaW5wdXQpO1xuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdGZvcm0uYXBwZW5kQ2hpbGQoaGlkZGVuKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gc2V0IGRlc3RpbmF0aW9uIHVybFxuXHRcdFx0XHRmb3JtLnNldEF0dHJpYnV0ZShcImFjdGlvblwiLCBtZXRhLnVybCk7XG5cblx0XHRcdFx0Y3JlYXRlSWZyYW1lKCk7XG5cdFx0XHRcdGZvcm0uc3VibWl0KCk7XG5cdFx0XHRcdHRhcmdldC50cmlnZ2VyKCdsb2Fkc3RhcnQnKTtcblx0XHRcdH0sXG5cblx0XHRcdGdldFN0YXR1czogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiBfc3RhdHVzO1xuXHRcdFx0fSxcblxuXHRcdFx0Z2V0UmVzcG9uc2U6IGZ1bmN0aW9uKHJlc3BvbnNlVHlwZSkge1xuXHRcdFx0XHRpZiAoJ2pzb24nID09PSByZXNwb25zZVR5cGUpIHtcblx0XHRcdFx0XHQvLyBzdHJpcCBvZmYgPHByZT4uLjwvcHJlPiB0YWdzIHRoYXQgbWlnaHQgYmUgZW5jbG9zaW5nIHRoZSByZXNwb25zZVxuXHRcdFx0XHRcdGlmIChCYXNpYy50eXBlT2YoX3Jlc3BvbnNlKSA9PT0gJ3N0cmluZycgJiYgISF3aW5kb3cuSlNPTikge1xuXHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIEpTT04ucGFyc2UoX3Jlc3BvbnNlLnJlcGxhY2UoL15cXHMqPHByZVtePl0qPi8sICcnKS5yZXBsYWNlKC88XFwvcHJlPlxccyokLywgJycpKTtcblx0XHRcdFx0XHRcdH0gY2F0Y2ggKGV4KSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0gXG5cdFx0XHRcdH0gZWxzZSBpZiAoJ2RvY3VtZW50JyA9PT0gcmVzcG9uc2VUeXBlKSB7XG5cblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gX3Jlc3BvbnNlO1xuXHRcdFx0fSxcblxuXHRcdFx0YWJvcnQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR2YXIgdGFyZ2V0ID0gdGhpcztcblxuXHRcdFx0XHRpZiAoX2lmcmFtZSAmJiBfaWZyYW1lLmNvbnRlbnRXaW5kb3cpIHtcblx0XHRcdFx0XHRpZiAoX2lmcmFtZS5jb250ZW50V2luZG93LnN0b3ApIHsgLy8gRmlyZUZveC9TYWZhcmkvQ2hyb21lXG5cdFx0XHRcdFx0XHRfaWZyYW1lLmNvbnRlbnRXaW5kb3cuc3RvcCgpO1xuXHRcdFx0XHRcdH0gZWxzZSBpZiAoX2lmcmFtZS5jb250ZW50V2luZG93LmRvY3VtZW50LmV4ZWNDb21tYW5kKSB7IC8vIElFXG5cdFx0XHRcdFx0XHRfaWZyYW1lLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQuZXhlY0NvbW1hbmQoJ1N0b3AnKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0X2lmcmFtZS5zcmMgPSBcImFib3V0OmJsYW5rXCI7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0Y2xlYW51cC5jYWxsKHRoaXMsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdC8vIHRhcmdldC5kaXNwYXRjaEV2ZW50KCdyZWFkeXN0YXRlY2hhbmdlJyk7XG5cdFx0XHRcdFx0dGFyZ2V0LmRpc3BhdGNoRXZlbnQoJ2Fib3J0Jyk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSxcblxuXHRcdFx0ZGVzdHJveTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHRoaXMuZ2V0UnVudGltZSgpLmdldFNoaW0oKS5yZW1vdmVJbnN0YW5jZSh0aGlzLnVpZCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHRyZXR1cm4gKGV4dGVuc2lvbnMuWE1MSHR0cFJlcXVlc3QgPSBYTUxIdHRwUmVxdWVzdCk7XG59KTtcblxuLy8gSW5jbHVkZWQgZnJvbTogc3JjL2phdmFzY3JpcHQvcnVudGltZS9odG1sNC9pbWFnZS9JbWFnZS5qc1xuXG4vKipcbiAqIEltYWdlLmpzXG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICovXG5cbi8qKlxuQGNsYXNzIG1veGllL3J1bnRpbWUvaHRtbDQvaW1hZ2UvSW1hZ2VcbkBwcml2YXRlXG4qL1xuZGVmaW5lKFwibW94aWUvcnVudGltZS9odG1sNC9pbWFnZS9JbWFnZVwiLCBbXG5cdFwibW94aWUvcnVudGltZS9odG1sNC9SdW50aW1lXCIsXG5cdFwibW94aWUvcnVudGltZS9odG1sNS9pbWFnZS9JbWFnZVwiXG5dLCBmdW5jdGlvbihleHRlbnNpb25zLCBJbWFnZSkge1xuXHRyZXR1cm4gKGV4dGVuc2lvbnMuSW1hZ2UgPSBJbWFnZSk7XG59KTtcblxuZXhwb3NlKFtcIm1veGllL2NvcmUvdXRpbHMvQmFzaWNcIixcIm1veGllL2NvcmUvdXRpbHMvRW5jb2RlXCIsXCJtb3hpZS9jb3JlL3V0aWxzL0VudlwiLFwibW94aWUvY29yZS9FeGNlcHRpb25zXCIsXCJtb3hpZS9jb3JlL3V0aWxzL0RvbVwiLFwibW94aWUvY29yZS9FdmVudFRhcmdldFwiLFwibW94aWUvcnVudGltZS9SdW50aW1lXCIsXCJtb3hpZS9ydW50aW1lL1J1bnRpbWVDbGllbnRcIixcIm1veGllL2ZpbGUvQmxvYlwiLFwibW94aWUvY29yZS9JMThuXCIsXCJtb3hpZS9jb3JlL3V0aWxzL01pbWVcIixcIm1veGllL2ZpbGUvRmlsZUlucHV0XCIsXCJtb3hpZS9maWxlL0ZpbGVcIixcIm1veGllL2ZpbGUvRmlsZURyb3BcIixcIm1veGllL2ZpbGUvRmlsZVJlYWRlclwiLFwibW94aWUvY29yZS91dGlscy9VcmxcIixcIm1veGllL3J1bnRpbWUvUnVudGltZVRhcmdldFwiLFwibW94aWUveGhyL0Zvcm1EYXRhXCIsXCJtb3hpZS94aHIvWE1MSHR0cFJlcXVlc3RcIixcIm1veGllL2ltYWdlL0ltYWdlXCIsXCJtb3hpZS9jb3JlL3V0aWxzL0V2ZW50c1wiLFwibW94aWUvcnVudGltZS9odG1sNS9pbWFnZS9SZXNpemVyQ2FudmFzXCJdKTtcbn0pKHRoaXMpO1xufSkpOyIsIi8qKlxuICogbU94aWUgLSBtdWx0aS1ydW50aW1lIEZpbGUgQVBJICYgWE1MSHR0cFJlcXVlc3QgTDIgUG9seWZpbGxcbiAqIHYxLjUuN1xuICpcbiAqIENvcHlyaWdodCAyMDEzLCBNb3hpZWNvZGUgU3lzdGVtcyBBQlxuICogUmVsZWFzZWQgdW5kZXIgR1BMIExpY2Vuc2UuXG4gKlxuICogTGljZW5zZTogaHR0cDovL3d3dy5wbHVwbG9hZC5jb20vbGljZW5zZVxuICogQ29udHJpYnV0aW5nOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9jb250cmlidXRpbmdcbiAqXG4gKiBEYXRlOiAyMDE3LTExLTAzXG4gKi9cbiFmdW5jdGlvbihlLHQpe3ZhciBpPWZ1bmN0aW9uKCl7dmFyIGU9e307cmV0dXJuIHQuYXBwbHkoZSxhcmd1bWVudHMpLGUubW94aWV9O1wiZnVuY3Rpb25cIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZD9kZWZpbmUoXCJtb3hpZVwiLFtdLGkpOlwib2JqZWN0XCI9PXR5cGVvZiBtb2R1bGUmJm1vZHVsZS5leHBvcnRzP21vZHVsZS5leHBvcnRzPWkoKTplLm1veGllPWkoKX0odGhpc3x8d2luZG93LGZ1bmN0aW9uKCl7IWZ1bmN0aW9uKGUsdCl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gaShlLHQpe2Zvcih2YXIgaSxuPVtdLHI9MDtyPGUubGVuZ3RoOysrcil7aWYoaT1zW2Vbcl1dfHxvKGVbcl0pLCFpKXRocm93XCJtb2R1bGUgZGVmaW5pdGlvbiBkZXBlbmRlY3kgbm90IGZvdW5kOiBcIitlW3JdO24ucHVzaChpKX10LmFwcGx5KG51bGwsbil9ZnVuY3Rpb24gbihlLG4scil7aWYoXCJzdHJpbmdcIiE9dHlwZW9mIGUpdGhyb3dcImludmFsaWQgbW9kdWxlIGRlZmluaXRpb24sIG1vZHVsZSBpZCBtdXN0IGJlIGRlZmluZWQgYW5kIGJlIGEgc3RyaW5nXCI7aWYobj09PXQpdGhyb3dcImludmFsaWQgbW9kdWxlIGRlZmluaXRpb24sIGRlcGVuZGVuY2llcyBtdXN0IGJlIHNwZWNpZmllZFwiO2lmKHI9PT10KXRocm93XCJpbnZhbGlkIG1vZHVsZSBkZWZpbml0aW9uLCBkZWZpbml0aW9uIGZ1bmN0aW9uIG11c3QgYmUgc3BlY2lmaWVkXCI7aShuLGZ1bmN0aW9uKCl7c1tlXT1yLmFwcGx5KG51bGwsYXJndW1lbnRzKX0pfWZ1bmN0aW9uIHIoZSl7cmV0dXJuISFzW2VdfWZ1bmN0aW9uIG8odCl7Zm9yKHZhciBpPWUsbj10LnNwbGl0KC9bLlxcL10vKSxyPTA7cjxuLmxlbmd0aDsrK3Ipe2lmKCFpW25bcl1dKXJldHVybjtpPWlbbltyXV19cmV0dXJuIGl9ZnVuY3Rpb24gYShpKXtmb3IodmFyIG49MDtuPGkubGVuZ3RoO24rKyl7Zm9yKHZhciByPWUsbz1pW25dLGE9by5zcGxpdCgvWy5cXC9dLyksdT0wO3U8YS5sZW5ndGgtMTsrK3UpclthW3VdXT09PXQmJihyW2FbdV1dPXt9KSxyPXJbYVt1XV07clthW2EubGVuZ3RoLTFdXT1zW29dfX12YXIgcz17fTtuKFwibW94aWUvY29yZS91dGlscy9CYXNpY1wiLFtdLGZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlKXt2YXIgdDtyZXR1cm4gZT09PXQ/XCJ1bmRlZmluZWRcIjpudWxsPT09ZT9cIm51bGxcIjplLm5vZGVUeXBlP1wibm9kZVwiOnt9LnRvU3RyaW5nLmNhbGwoZSkubWF0Y2goL1xccyhbYS16fEEtWl0rKS8pWzFdLnRvTG93ZXJDYXNlKCl9ZnVuY3Rpb24gdCgpe3JldHVybiBzKCExLCExLGFyZ3VtZW50cyl9ZnVuY3Rpb24gaSgpe3JldHVybiBzKCEwLCExLGFyZ3VtZW50cyl9ZnVuY3Rpb24gbigpe3JldHVybiBzKCExLCEwLGFyZ3VtZW50cyl9ZnVuY3Rpb24gcigpe3JldHVybiBzKCEwLCEwLGFyZ3VtZW50cyl9ZnVuY3Rpb24gbyh0KXtzd2l0Y2goZSh0KSl7Y2FzZVwiYXJyYXlcIjpyZXR1cm4gcyghMSwhMCxbW10sdF0pO2Nhc2VcIm9iamVjdFwiOnJldHVybiBzKCExLCEwLFt7fSx0XSk7ZGVmYXVsdDpyZXR1cm4gdH19ZnVuY3Rpb24gYShpKXtzd2l0Y2goZShpKSl7Y2FzZVwiYXJyYXlcIjpyZXR1cm4gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoaSk7Y2FzZVwib2JqZWN0XCI6cmV0dXJuIHQoe30saSl9cmV0dXJuIGl9ZnVuY3Rpb24gcyh0LGksbil7dmFyIHIsbz1uWzBdO3JldHVybiBjKG4sZnVuY3Rpb24obix1KXt1PjAmJmMobixmdW5jdGlvbihuLHUpe3ZhciBjPS0xIT09aChlKG4pLFtcImFycmF5XCIsXCJvYmplY3RcIl0pO3JldHVybiBuPT09cnx8dCYmb1t1XT09PXI/ITA6KGMmJmkmJihuPWEobikpLGUob1t1XSk9PT1lKG4pJiZjP3ModCxpLFtvW3VdLG5dKTpvW3VdPW4sdm9pZCAwKX0pfSksb31mdW5jdGlvbiB1KGUsdCl7ZnVuY3Rpb24gaSgpe3RoaXMuY29uc3RydWN0b3I9ZX1mb3IodmFyIG4gaW4gdCkoe30pLmhhc093blByb3BlcnR5LmNhbGwodCxuKSYmKGVbbl09dFtuXSk7cmV0dXJuIGkucHJvdG90eXBlPXQucHJvdG90eXBlLGUucHJvdG90eXBlPW5ldyBpLGUucGFyZW50PXQucHJvdG90eXBlLGV9ZnVuY3Rpb24gYyhlLHQpe3ZhciBpLG4scixvO2lmKGUpe3RyeXtpPWUubGVuZ3RofWNhdGNoKGEpe2k9b31pZihpPT09b3x8XCJudW1iZXJcIiE9dHlwZW9mIGkpe2ZvcihuIGluIGUpaWYoZS5oYXNPd25Qcm9wZXJ0eShuKSYmdChlW25dLG4pPT09ITEpcmV0dXJufWVsc2UgZm9yKHI9MDtpPnI7cisrKWlmKHQoZVtyXSxyKT09PSExKXJldHVybn19ZnVuY3Rpb24gbCh0KXt2YXIgaTtpZighdHx8XCJvYmplY3RcIiE9PWUodCkpcmV0dXJuITA7Zm9yKGkgaW4gdClyZXR1cm4hMTtyZXR1cm4hMH1mdW5jdGlvbiBkKHQsaSl7ZnVuY3Rpb24gbihyKXtcImZ1bmN0aW9uXCI9PT1lKHRbcl0pJiZ0W3JdKGZ1bmN0aW9uKGUpeysrcjxvJiYhZT9uKHIpOmkoZSl9KX12YXIgcj0wLG89dC5sZW5ndGg7XCJmdW5jdGlvblwiIT09ZShpKSYmKGk9ZnVuY3Rpb24oKXt9KSx0JiZ0Lmxlbmd0aHx8aSgpLG4ocil9ZnVuY3Rpb24gbShlLHQpe3ZhciBpPTAsbj1lLmxlbmd0aCxyPW5ldyBBcnJheShuKTtjKGUsZnVuY3Rpb24oZSxvKXtlKGZ1bmN0aW9uKGUpe2lmKGUpcmV0dXJuIHQoZSk7dmFyIGE9W10uc2xpY2UuY2FsbChhcmd1bWVudHMpO2Euc2hpZnQoKSxyW29dPWEsaSsrLGk9PT1uJiYoci51bnNoaWZ0KG51bGwpLHQuYXBwbHkodGhpcyxyKSl9KX0pfWZ1bmN0aW9uIGgoZSx0KXtpZih0KXtpZihBcnJheS5wcm90b3R5cGUuaW5kZXhPZilyZXR1cm4gQXJyYXkucHJvdG90eXBlLmluZGV4T2YuY2FsbCh0LGUpO2Zvcih2YXIgaT0wLG49dC5sZW5ndGg7bj5pO2krKylpZih0W2ldPT09ZSlyZXR1cm4gaX1yZXR1cm4tMX1mdW5jdGlvbiBmKHQsaSl7dmFyIG49W107XCJhcnJheVwiIT09ZSh0KSYmKHQ9W3RdKSxcImFycmF5XCIhPT1lKGkpJiYoaT1baV0pO2Zvcih2YXIgciBpbiB0KS0xPT09aCh0W3JdLGkpJiZuLnB1c2godFtyXSk7cmV0dXJuIG4ubGVuZ3RoP246ITF9ZnVuY3Rpb24gcChlLHQpe3ZhciBpPVtdO3JldHVybiBjKGUsZnVuY3Rpb24oZSl7LTEhPT1oKGUsdCkmJmkucHVzaChlKX0pLGkubGVuZ3RoP2k6bnVsbH1mdW5jdGlvbiBnKGUpe3ZhciB0LGk9W107Zm9yKHQ9MDt0PGUubGVuZ3RoO3QrKylpW3RdPWVbdF07cmV0dXJuIGl9ZnVuY3Rpb24geChlKXtyZXR1cm4gZT9TdHJpbmcucHJvdG90eXBlLnRyaW0/U3RyaW5nLnByb3RvdHlwZS50cmltLmNhbGwoZSk6ZS50b1N0cmluZygpLnJlcGxhY2UoL15cXHMqLyxcIlwiKS5yZXBsYWNlKC9cXHMqJC8sXCJcIik6ZX1mdW5jdGlvbiB2KGUpe2lmKFwic3RyaW5nXCIhPXR5cGVvZiBlKXJldHVybiBlO3ZhciB0LGk9e3Q6MTA5OTUxMTYyNzc3NixnOjEwNzM3NDE4MjQsbToxMDQ4NTc2LGs6MTAyNH07cmV0dXJuIGU9L14oWzAtOVxcLl0rKShbdG1na10/KSQvLmV4ZWMoZS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1teMC05XFwudG1rZ10vZyxcIlwiKSksdD1lWzJdLGU9K2VbMV0saS5oYXNPd25Qcm9wZXJ0eSh0KSYmKGUqPWlbdF0pLE1hdGguZmxvb3IoZSl9ZnVuY3Rpb24gdyhlKXt2YXIgdD1bXS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKTtyZXR1cm4gZS5yZXBsYWNlKC8lKFthLXpdKS9nLGZ1bmN0aW9uKGUsaSl7dmFyIG49dC5zaGlmdCgpO3N3aXRjaChpKXtjYXNlXCJzXCI6cmV0dXJuIG4rXCJcIjtjYXNlXCJkXCI6cmV0dXJuIHBhcnNlSW50KG4sMTApO2Nhc2VcImZcIjpyZXR1cm4gcGFyc2VGbG9hdChuKTtjYXNlXCJjXCI6cmV0dXJuXCJcIjtkZWZhdWx0OnJldHVybiBufX0pfWZ1bmN0aW9uIHkoZSx0KXt2YXIgaT10aGlzO3NldFRpbWVvdXQoZnVuY3Rpb24oKXtlLmNhbGwoaSl9LHR8fDEpfXZhciBFPWZ1bmN0aW9uKCl7dmFyIGU9MDtyZXR1cm4gZnVuY3Rpb24odCl7dmFyIGksbj0obmV3IERhdGUpLmdldFRpbWUoKS50b1N0cmluZygzMik7Zm9yKGk9MDs1Pmk7aSsrKW4rPU1hdGguZmxvb3IoNjU1MzUqTWF0aC5yYW5kb20oKSkudG9TdHJpbmcoMzIpO3JldHVybih0fHxcIm9fXCIpK24rKGUrKykudG9TdHJpbmcoMzIpfX0oKTtyZXR1cm57Z3VpZDpFLHR5cGVPZjplLGV4dGVuZDp0LGV4dGVuZElmOmksZXh0ZW5kSW1tdXRhYmxlOm4sZXh0ZW5kSW1tdXRhYmxlSWY6cixjbG9uZTpvLGluaGVyaXQ6dSxlYWNoOmMsaXNFbXB0eU9iajpsLGluU2VyaWVzOmQsaW5QYXJhbGxlbDptLGluQXJyYXk6aCxhcnJheURpZmY6ZixhcnJheUludGVyc2VjdDpwLHRvQXJyYXk6Zyx0cmltOngsc3ByaW50Zjp3LHBhcnNlU2l6ZVN0cjp2LGRlbGF5Onl9fSksbihcIm1veGllL2NvcmUvdXRpbHMvRW5jb2RlXCIsW10sZnVuY3Rpb24oKXt2YXIgZT1mdW5jdGlvbihlKXtyZXR1cm4gdW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KGUpKX0sdD1mdW5jdGlvbihlKXtyZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KGVzY2FwZShlKSl9LGk9ZnVuY3Rpb24oZSxpKXtpZihcImZ1bmN0aW9uXCI9PXR5cGVvZiB3aW5kb3cuYXRvYilyZXR1cm4gaT90KHdpbmRvdy5hdG9iKGUpKTp3aW5kb3cuYXRvYihlKTt2YXIgbixyLG8sYSxzLHUsYyxsLGQ9XCJBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvPVwiLG09MCxoPTAsZj1cIlwiLHA9W107aWYoIWUpcmV0dXJuIGU7ZSs9XCJcIjtkbyBhPWQuaW5kZXhPZihlLmNoYXJBdChtKyspKSxzPWQuaW5kZXhPZihlLmNoYXJBdChtKyspKSx1PWQuaW5kZXhPZihlLmNoYXJBdChtKyspKSxjPWQuaW5kZXhPZihlLmNoYXJBdChtKyspKSxsPWE8PDE4fHM8PDEyfHU8PDZ8YyxuPTI1NSZsPj4xNixyPTI1NSZsPj44LG89MjU1JmwscFtoKytdPTY0PT11P1N0cmluZy5mcm9tQ2hhckNvZGUobik6NjQ9PWM/U3RyaW5nLmZyb21DaGFyQ29kZShuLHIpOlN0cmluZy5mcm9tQ2hhckNvZGUobixyLG8pO3doaWxlKG08ZS5sZW5ndGgpO3JldHVybiBmPXAuam9pbihcIlwiKSxpP3QoZik6Zn0sbj1mdW5jdGlvbih0LGkpe2lmKGkmJih0PWUodCkpLFwiZnVuY3Rpb25cIj09dHlwZW9mIHdpbmRvdy5idG9hKXJldHVybiB3aW5kb3cuYnRvYSh0KTt2YXIgbixyLG8sYSxzLHUsYyxsLGQ9XCJBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvPVwiLG09MCxoPTAsZj1cIlwiLHA9W107aWYoIXQpcmV0dXJuIHQ7ZG8gbj10LmNoYXJDb2RlQXQobSsrKSxyPXQuY2hhckNvZGVBdChtKyspLG89dC5jaGFyQ29kZUF0KG0rKyksbD1uPDwxNnxyPDw4fG8sYT02MyZsPj4xOCxzPTYzJmw+PjEyLHU9NjMmbD4+NixjPTYzJmwscFtoKytdPWQuY2hhckF0KGEpK2QuY2hhckF0KHMpK2QuY2hhckF0KHUpK2QuY2hhckF0KGMpO3doaWxlKG08dC5sZW5ndGgpO2Y9cC5qb2luKFwiXCIpO3ZhciBnPXQubGVuZ3RoJTM7cmV0dXJuKGc/Zi5zbGljZSgwLGctMyk6ZikrXCI9PT1cIi5zbGljZShnfHwzKX07cmV0dXJue3V0ZjhfZW5jb2RlOmUsdXRmOF9kZWNvZGU6dCxhdG9iOmksYnRvYTpufX0pLG4oXCJtb3hpZS9jb3JlL3V0aWxzL0VudlwiLFtcIm1veGllL2NvcmUvdXRpbHMvQmFzaWNcIl0sZnVuY3Rpb24oZSl7ZnVuY3Rpb24gaShlLHQsaSl7dmFyIG49MCxyPTAsbz0wLGE9e2RldjotNixhbHBoYTotNSxhOi01LGJldGE6LTQsYjotNCxSQzotMyxyYzotMyxcIiNcIjotMixwOjEscGw6MX0scz1mdW5jdGlvbihlKXtyZXR1cm4gZT0oXCJcIitlKS5yZXBsYWNlKC9bX1xcLStdL2csXCIuXCIpLGU9ZS5yZXBsYWNlKC8oW14uXFxkXSspL2csXCIuJDEuXCIpLnJlcGxhY2UoL1xcLnsyLH0vZyxcIi5cIiksZS5sZW5ndGg/ZS5zcGxpdChcIi5cIik6Wy04XX0sdT1mdW5jdGlvbihlKXtyZXR1cm4gZT9pc05hTihlKT9hW2VdfHwtNzpwYXJzZUludChlLDEwKTowfTtmb3IoZT1zKGUpLHQ9cyh0KSxyPU1hdGgubWF4KGUubGVuZ3RoLHQubGVuZ3RoKSxuPTA7cj5uO24rKylpZihlW25dIT10W25dKXtpZihlW25dPXUoZVtuXSksdFtuXT11KHRbbl0pLGVbbl08dFtuXSl7bz0tMTticmVha31pZihlW25dPnRbbl0pe289MTticmVha319aWYoIWkpcmV0dXJuIG87c3dpdGNoKGkpe2Nhc2VcIj5cIjpjYXNlXCJndFwiOnJldHVybiBvPjA7Y2FzZVwiPj1cIjpjYXNlXCJnZVwiOnJldHVybiBvPj0wO2Nhc2VcIjw9XCI6Y2FzZVwibGVcIjpyZXR1cm4gMD49bztjYXNlXCI9PVwiOmNhc2VcIj1cIjpjYXNlXCJlcVwiOnJldHVybiAwPT09bztjYXNlXCI8PlwiOmNhc2VcIiE9XCI6Y2FzZVwibmVcIjpyZXR1cm4gMCE9PW87Y2FzZVwiXCI6Y2FzZVwiPFwiOmNhc2VcImx0XCI6cmV0dXJuIDA+bztkZWZhdWx0OnJldHVybiBudWxsfX12YXIgbj1mdW5jdGlvbihlKXt2YXIgdD1cIlwiLGk9XCI/XCIsbj1cImZ1bmN0aW9uXCIscj1cInVuZGVmaW5lZFwiLG89XCJvYmplY3RcIixhPVwibmFtZVwiLHM9XCJ2ZXJzaW9uXCIsdT17aGFzOmZ1bmN0aW9uKGUsdCl7cmV0dXJuLTEhPT10LnRvTG93ZXJDYXNlKCkuaW5kZXhPZihlLnRvTG93ZXJDYXNlKCkpfSxsb3dlcml6ZTpmdW5jdGlvbihlKXtyZXR1cm4gZS50b0xvd2VyQ2FzZSgpfX0sYz17cmd4OmZ1bmN0aW9uKCl7Zm9yKHZhciB0LGksYSxzLHUsYyxsLGQ9MCxtPWFyZ3VtZW50cztkPG0ubGVuZ3RoO2QrPTIpe3ZhciBoPW1bZF0sZj1tW2QrMV07aWYodHlwZW9mIHQ9PT1yKXt0PXt9O2ZvcihzIGluIGYpdT1mW3NdLHR5cGVvZiB1PT09bz90W3VbMF1dPWU6dFt1XT1lfWZvcihpPWE9MDtpPGgubGVuZ3RoO2krKylpZihjPWhbaV0uZXhlYyh0aGlzLmdldFVBKCkpKXtmb3Iocz0wO3M8Zi5sZW5ndGg7cysrKWw9Y1srK2FdLHU9ZltzXSx0eXBlb2YgdT09PW8mJnUubGVuZ3RoPjA/Mj09dS5sZW5ndGg/dFt1WzBdXT10eXBlb2YgdVsxXT09bj91WzFdLmNhbGwodGhpcyxsKTp1WzFdOjM9PXUubGVuZ3RoP3RbdVswXV09dHlwZW9mIHVbMV0hPT1ufHx1WzFdLmV4ZWMmJnVbMV0udGVzdD9sP2wucmVwbGFjZSh1WzFdLHVbMl0pOmU6bD91WzFdLmNhbGwodGhpcyxsLHVbMl0pOmU6ND09dS5sZW5ndGgmJih0W3VbMF1dPWw/dVszXS5jYWxsKHRoaXMsbC5yZXBsYWNlKHVbMV0sdVsyXSkpOmUpOnRbdV09bD9sOmU7YnJlYWt9aWYoYylicmVha31yZXR1cm4gdH0sc3RyOmZ1bmN0aW9uKHQsbil7Zm9yKHZhciByIGluIG4paWYodHlwZW9mIG5bcl09PT1vJiZuW3JdLmxlbmd0aD4wKXtmb3IodmFyIGE9MDthPG5bcl0ubGVuZ3RoO2ErKylpZih1LmhhcyhuW3JdW2FdLHQpKXJldHVybiByPT09aT9lOnJ9ZWxzZSBpZih1LmhhcyhuW3JdLHQpKXJldHVybiByPT09aT9lOnI7cmV0dXJuIHR9fSxsPXticm93c2VyOntvbGRzYWZhcmk6e21ham9yOnsxOltcIi84XCIsXCIvMVwiLFwiLzNcIl0sMjpcIi80XCIsXCI/XCI6XCIvXCJ9LHZlcnNpb246e1wiMS4wXCI6XCIvOFwiLDEuMjpcIi8xXCIsMS4zOlwiLzNcIixcIjIuMFwiOlwiLzQxMlwiLFwiMi4wLjJcIjpcIi80MTZcIixcIjIuMC4zXCI6XCIvNDE3XCIsXCIyLjAuNFwiOlwiLzQxOVwiLFwiP1wiOlwiL1wifX19LGRldmljZTp7c3ByaW50Onttb2RlbDp7XCJFdm8gU2hpZnQgNEdcIjpcIjczNzNLVFwifSx2ZW5kb3I6e0hUQzpcIkFQQVwiLFNwcmludDpcIlNwcmludFwifX19LG9zOnt3aW5kb3dzOnt2ZXJzaW9uOntNRTpcIjQuOTBcIixcIk5UIDMuMTFcIjpcIk5UMy41MVwiLFwiTlQgNC4wXCI6XCJOVDQuMFwiLDIwMDA6XCJOVCA1LjBcIixYUDpbXCJOVCA1LjFcIixcIk5UIDUuMlwiXSxWaXN0YTpcIk5UIDYuMFwiLDc6XCJOVCA2LjFcIiw4OlwiTlQgNi4yXCIsOC4xOlwiTlQgNi4zXCIsUlQ6XCJBUk1cIn19fX0sZD17YnJvd3NlcjpbWy8ob3BlcmFcXHNtaW5pKVxcLyhbXFx3XFwuLV0rKS9pLC8ob3BlcmFcXHNbbW9iaWxldGFiXSspLit2ZXJzaW9uXFwvKFtcXHdcXC4tXSspL2ksLyhvcGVyYSkuK3ZlcnNpb25cXC8oW1xcd1xcLl0rKS9pLC8ob3BlcmEpW1xcL1xcc10rKFtcXHdcXC5dKykvaV0sW2Esc10sWy9cXHMob3ByKVxcLyhbXFx3XFwuXSspL2ldLFtbYSxcIk9wZXJhXCJdLHNdLFsvKGtpbmRsZSlcXC8oW1xcd1xcLl0rKS9pLC8obHVuYXNjYXBlfG1heHRob258bmV0ZnJvbnR8amFzbWluZXxibGF6ZXIpW1xcL1xcc10/KFtcXHdcXC5dKykqL2ksLyhhdmFudFxcc3xpZW1vYmlsZXxzbGltfGJhaWR1KSg/OmJyb3dzZXIpP1tcXC9cXHNdPyhbXFx3XFwuXSopL2ksLyg/Om1zfFxcKCkoaWUpXFxzKFtcXHdcXC5dKykvaSwvKHJla29ucSlcXC8oW1xcd1xcLl0rKSovaSwvKGNocm9taXVtfGZsb2NrfHJvY2ttZWx0fG1pZG9yaXxlcGlwaGFueXxzaWxrfHNreWZpcmV8b3ZpYnJvd3Nlcnxib2x0fGlyb258dml2YWxkaSlcXC8oW1xcd1xcLi1dKykvaV0sW2Esc10sWy8odHJpZGVudCkuK3J2WzpcXHNdKFtcXHdcXC5dKykuK2xpa2VcXHNnZWNrby9pXSxbW2EsXCJJRVwiXSxzXSxbLyhlZGdlKVxcLygoXFxkKyk/W1xcd1xcLl0rKS9pXSxbYSxzXSxbLyh5YWJyb3dzZXIpXFwvKFtcXHdcXC5dKykvaV0sW1thLFwiWWFuZGV4XCJdLHNdLFsvKGNvbW9kb19kcmFnb24pXFwvKFtcXHdcXC5dKykvaV0sW1thLC9fL2csXCIgXCJdLHNdLFsvKGNocm9tZXxvbW5pd2VifGFyb3JhfFt0aXplbm9rYV17NX1cXHM/YnJvd3NlcilcXC92PyhbXFx3XFwuXSspL2ksLyh1Y1xccz9icm93c2VyfHFxYnJvd3NlcilbXFwvXFxzXT8oW1xcd1xcLl0rKS9pXSxbYSxzXSxbLyhkb2xmaW4pXFwvKFtcXHdcXC5dKykvaV0sW1thLFwiRG9scGhpblwiXSxzXSxbLygoPzphbmRyb2lkLispY3Jtb3xjcmlvcylcXC8oW1xcd1xcLl0rKS9pXSxbW2EsXCJDaHJvbWVcIl0sc10sWy9YaWFvTWlcXC9NaXVpQnJvd3NlclxcLyhbXFx3XFwuXSspL2ldLFtzLFthLFwiTUlVSSBCcm93c2VyXCJdXSxbL2FuZHJvaWQuK3ZlcnNpb25cXC8oW1xcd1xcLl0rKVxccysoPzptb2JpbGVcXHM/c2FmYXJpfHNhZmFyaSkvaV0sW3MsW2EsXCJBbmRyb2lkIEJyb3dzZXJcIl1dLFsvRkJBVlxcLyhbXFx3XFwuXSspOy9pXSxbcyxbYSxcIkZhY2Vib29rXCJdXSxbL3ZlcnNpb25cXC8oW1xcd1xcLl0rKS4rP21vYmlsZVxcL1xcdytcXHMoc2FmYXJpKS9pXSxbcyxbYSxcIk1vYmlsZSBTYWZhcmlcIl1dLFsvdmVyc2lvblxcLyhbXFx3XFwuXSspLis/KG1vYmlsZVxccz9zYWZhcml8c2FmYXJpKS9pXSxbcyxhXSxbL3dlYmtpdC4rPyhtb2JpbGVcXHM/c2FmYXJpfHNhZmFyaSkoXFwvW1xcd1xcLl0rKS9pXSxbYSxbcyxjLnN0cixsLmJyb3dzZXIub2xkc2FmYXJpLnZlcnNpb25dXSxbLyhrb25xdWVyb3IpXFwvKFtcXHdcXC5dKykvaSwvKHdlYmtpdHxraHRtbClcXC8oW1xcd1xcLl0rKS9pXSxbYSxzXSxbLyhuYXZpZ2F0b3J8bmV0c2NhcGUpXFwvKFtcXHdcXC4tXSspL2ldLFtbYSxcIk5ldHNjYXBlXCJdLHNdLFsvKHN3aWZ0Zm94KS9pLC8oaWNlZHJhZ29ufGljZXdlYXNlbHxjYW1pbm98Y2hpbWVyYXxmZW5uZWN8bWFlbW9cXHNicm93c2VyfG1pbmltb3xjb25rZXJvcilbXFwvXFxzXT8oW1xcd1xcLlxcK10rKS9pLC8oZmlyZWZveHxzZWFtb25rZXl8ay1tZWxlb258aWNlY2F0fGljZWFwZXxmaXJlYmlyZHxwaG9lbml4KVxcLyhbXFx3XFwuLV0rKS9pLC8obW96aWxsYSlcXC8oW1xcd1xcLl0rKS4rcnZcXDouK2dlY2tvXFwvXFxkKy9pLC8ocG9sYXJpc3xseW54fGRpbGxvfGljYWJ8ZG9yaXN8YW1heWF8dzNtfG5ldHN1cmYpW1xcL1xcc10/KFtcXHdcXC5dKykvaSwvKGxpbmtzKVxcc1xcKChbXFx3XFwuXSspL2ksLyhnb2Jyb3dzZXIpXFwvPyhbXFx3XFwuXSspKi9pLC8oaWNlXFxzP2Jyb3dzZXIpXFwvdj8oW1xcd1xcLl9dKykvaSwvKG1vc2FpYylbXFwvXFxzXShbXFx3XFwuXSspL2ldLFthLHNdXSxlbmdpbmU6W1svd2luZG93cy4rXFxzZWRnZVxcLyhbXFx3XFwuXSspL2ldLFtzLFthLFwiRWRnZUhUTUxcIl1dLFsvKHByZXN0bylcXC8oW1xcd1xcLl0rKS9pLC8od2Via2l0fHRyaWRlbnR8bmV0ZnJvbnR8bmV0c3VyZnxhbWF5YXxseW54fHczbSlcXC8oW1xcd1xcLl0rKS9pLC8oa2h0bWx8dGFzbWFufGxpbmtzKVtcXC9cXHNdXFwoPyhbXFx3XFwuXSspL2ksLyhpY2FiKVtcXC9cXHNdKFsyM11cXC5bXFxkXFwuXSspL2ldLFthLHNdLFsvcnZcXDooW1xcd1xcLl0rKS4qKGdlY2tvKS9pXSxbcyxhXV0sb3M6W1svbWljcm9zb2Z0XFxzKHdpbmRvd3MpXFxzKHZpc3RhfHhwKS9pXSxbYSxzXSxbLyh3aW5kb3dzKVxcc250XFxzNlxcLjI7XFxzKGFybSkvaSwvKHdpbmRvd3NcXHNwaG9uZSg/Olxcc29zKSp8d2luZG93c1xcc21vYmlsZXx3aW5kb3dzKVtcXHNcXC9dPyhbbnRjZVxcZFxcLlxcc10rXFx3KS9pXSxbYSxbcyxjLnN0cixsLm9zLndpbmRvd3MudmVyc2lvbl1dLFsvKHdpbig/PTN8OXxuKXx3aW5cXHM5eFxccykoW250XFxkXFwuXSspL2ldLFtbYSxcIldpbmRvd3NcIl0sW3MsYy5zdHIsbC5vcy53aW5kb3dzLnZlcnNpb25dXSxbL1xcKChiYikoMTApOy9pXSxbW2EsXCJCbGFja0JlcnJ5XCJdLHNdLFsvKGJsYWNrYmVycnkpXFx3KlxcLz8oW1xcd1xcLl0rKSovaSwvKHRpemVuKVtcXC9cXHNdKFtcXHdcXC5dKykvaSwvKGFuZHJvaWR8d2Vib3N8cGFsbVxcb3N8cW54fGJhZGF8cmltXFxzdGFibGV0XFxzb3N8bWVlZ298Y29udGlraSlbXFwvXFxzLV0/KFtcXHdcXC5dKykqL2ksL2xpbnV4Oy4rKHNhaWxmaXNoKTsvaV0sW2Esc10sWy8oc3ltYmlhblxccz9vc3xzeW1ib3N8czYwKD89OykpW1xcL1xccy1dPyhbXFx3XFwuXSspKi9pXSxbW2EsXCJTeW1iaWFuXCJdLHNdLFsvXFwoKHNlcmllczQwKTsvaV0sW2FdLFsvbW96aWxsYS4rXFwobW9iaWxlOy4rZ2Vja28uK2ZpcmVmb3gvaV0sW1thLFwiRmlyZWZveCBPU1wiXSxzXSxbLyhuaW50ZW5kb3xwbGF5c3RhdGlvbilcXHMoW3dpZHMzcG9ydGFibGV2dV0rKS9pLC8obWludClbXFwvXFxzXFwoXT8oXFx3KykqL2ksLyhtYWdlaWF8dmVjdG9ybGludXgpWztcXHNdL2ksLyhqb2xpfFtreGxuXT91YnVudHV8ZGViaWFufFtvcGVuXSpzdXNlfGdlbnRvb3xhcmNofHNsYWNrd2FyZXxmZWRvcmF8bWFuZHJpdmF8Y2VudG9zfHBjbGludXhvc3xyZWRoYXR8emVud2Fsa3xsaW5wdXMpW1xcL1xccy1dPyhbXFx3XFwuLV0rKSovaSwvKGh1cmR8bGludXgpXFxzPyhbXFx3XFwuXSspKi9pLC8oZ251KVxccz8oW1xcd1xcLl0rKSovaV0sW2Esc10sWy8oY3JvcylcXHNbXFx3XStcXHMoW1xcd1xcLl0rXFx3KS9pXSxbW2EsXCJDaHJvbWl1bSBPU1wiXSxzXSxbLyhzdW5vcylcXHM/KFtcXHdcXC5dK1xcZCkqL2ldLFtbYSxcIlNvbGFyaXNcIl0sc10sWy9cXHMoW2ZyZW50b3BjLV17MCw0fWJzZHxkcmFnb25mbHkpXFxzPyhbXFx3XFwuXSspKi9pXSxbYSxzXSxbLyhpcFtob25lYWRdKykoPzouKm9zXFxzKihbXFx3XSspKlxcc2xpa2VcXHNtYWN8O1xcc29wZXJhKS9pXSxbW2EsXCJpT1NcIl0sW3MsL18vZyxcIi5cIl1dLFsvKG1hY1xcc29zXFxzeClcXHM/KFtcXHdcXHNcXC5dK1xcdykqL2ksLyhtYWNpbnRvc2h8bWFjKD89X3Bvd2VycGMpXFxzKS9pXSxbW2EsXCJNYWMgT1NcIl0sW3MsL18vZyxcIi5cIl1dLFsvKCg/Om9wZW4pP3NvbGFyaXMpW1xcL1xccy1dPyhbXFx3XFwuXSspKi9pLC8oaGFpa3UpXFxzKFxcdyspL2ksLyhhaXgpXFxzKChcXGQpKD89XFwufFxcKXxcXHMpW1xcd1xcLl0qKSovaSwvKHBsYW5cXHM5fG1pbml4fGJlb3N8b3NcXC8yfGFtaWdhb3N8bW9ycGhvc3xyaXNjXFxzb3N8b3BlbnZtcykvaSwvKHVuaXgpXFxzPyhbXFx3XFwuXSspKi9pXSxbYSxzXV19LG09ZnVuY3Rpb24oZSl7dmFyIGk9ZXx8KHdpbmRvdyYmd2luZG93Lm5hdmlnYXRvciYmd2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQ/d2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQ6dCk7dGhpcy5nZXRCcm93c2VyPWZ1bmN0aW9uKCl7cmV0dXJuIGMucmd4LmFwcGx5KHRoaXMsZC5icm93c2VyKX0sdGhpcy5nZXRFbmdpbmU9ZnVuY3Rpb24oKXtyZXR1cm4gYy5yZ3guYXBwbHkodGhpcyxkLmVuZ2luZSl9LHRoaXMuZ2V0T1M9ZnVuY3Rpb24oKXtyZXR1cm4gYy5yZ3guYXBwbHkodGhpcyxkLm9zKX0sdGhpcy5nZXRSZXN1bHQ9ZnVuY3Rpb24oKXtyZXR1cm57dWE6dGhpcy5nZXRVQSgpLGJyb3dzZXI6dGhpcy5nZXRCcm93c2VyKCksZW5naW5lOnRoaXMuZ2V0RW5naW5lKCksb3M6dGhpcy5nZXRPUygpfX0sdGhpcy5nZXRVQT1mdW5jdGlvbigpe3JldHVybiBpfSx0aGlzLnNldFVBPWZ1bmN0aW9uKGUpe3JldHVybiBpPWUsdGhpc30sdGhpcy5zZXRVQShpKX07cmV0dXJuIG19KCkscj1mdW5jdGlvbigpe3ZhciBpPXthY2Nlc3NfZ2xvYmFsX25zOmZ1bmN0aW9uKCl7cmV0dXJuISF3aW5kb3cubW94aWV9LGRlZmluZV9wcm9wZXJ0eTpmdW5jdGlvbigpe3JldHVybiExfSgpLGNyZWF0ZV9jYW52YXM6ZnVuY3Rpb24oKXt2YXIgZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpLHQ9ISghZS5nZXRDb250ZXh0fHwhZS5nZXRDb250ZXh0KFwiMmRcIikpO3JldHVybiBpLmNyZWF0ZV9jYW52YXM9dCx0fSxyZXR1cm5fcmVzcG9uc2VfdHlwZTpmdW5jdGlvbih0KXt0cnl7aWYoLTEhPT1lLmluQXJyYXkodCxbXCJcIixcInRleHRcIixcImRvY3VtZW50XCJdKSlyZXR1cm4hMDtpZih3aW5kb3cuWE1MSHR0cFJlcXVlc3Qpe3ZhciBpPW5ldyBYTUxIdHRwUmVxdWVzdDtpZihpLm9wZW4oXCJnZXRcIixcIi9cIiksXCJyZXNwb25zZVR5cGVcImluIGkpcmV0dXJuIGkucmVzcG9uc2VUeXBlPXQsaS5yZXNwb25zZVR5cGUhPT10PyExOiEwfX1jYXRjaChuKXt9cmV0dXJuITF9LHVzZV9ibG9iX3VyaTpmdW5jdGlvbigpe3ZhciBlPXdpbmRvdy5VUkw7cmV0dXJuIGkudXNlX2Jsb2JfdXJpPWUmJlwiY3JlYXRlT2JqZWN0VVJMXCJpbiBlJiZcInJldm9rZU9iamVjdFVSTFwiaW4gZSYmKFwiSUVcIiE9PWEuYnJvd3Nlcnx8YS52ZXJDb21wKGEudmVyc2lvbixcIjExLjAuNDZcIixcIj49XCIpKSxpLnVzZV9ibG9iX3VyaX0sdXNlX2RhdGFfdXJpOmZ1bmN0aW9uKCl7dmFyIGU9bmV3IEltYWdlO3JldHVybiBlLm9ubG9hZD1mdW5jdGlvbigpe2kudXNlX2RhdGFfdXJpPTE9PT1lLndpZHRoJiYxPT09ZS5oZWlnaHR9LHNldFRpbWVvdXQoZnVuY3Rpb24oKXtlLnNyYz1cImRhdGE6aW1hZ2UvZ2lmO2Jhc2U2NCxSMGxHT0RsaEFRQUJBSUFBQVA4QUFBQUFBQ0g1QkFBQUFBQUFMQUFBQUFBQkFBRUFBQUlDUkFFQU93PT1cIn0sMSksITF9KCksdXNlX2RhdGFfdXJpX292ZXIzMmtiOmZ1bmN0aW9uKCl7cmV0dXJuIGkudXNlX2RhdGFfdXJpJiYoXCJJRVwiIT09YS5icm93c2VyfHxhLnZlcnNpb24+PTkpfSx1c2VfZGF0YV91cmlfb2Y6ZnVuY3Rpb24oZSl7cmV0dXJuIGkudXNlX2RhdGFfdXJpJiYzM2UzPmV8fGkudXNlX2RhdGFfdXJpX292ZXIzMmtiKCl9LHVzZV9maWxlaW5wdXQ6ZnVuY3Rpb24oKXtpZihuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC8oQW5kcm9pZCAoMS4wfDEuMXwxLjV8MS42fDIuMHwyLjEpKXwoV2luZG93cyBQaG9uZSAoT1MgN3w4LjApKXwoWEJMV1ApfChadW5lV1ApfCh3KGViKT9PU0Jyb3dzZXIpfCh3ZWJPUyl8KEtpbmRsZVxcLygxLjB8Mi4wfDIuNXwzLjApKS8pKXJldHVybiExO3ZhciBlPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtyZXR1cm4gZS5zZXRBdHRyaWJ1dGUoXCJ0eXBlXCIsXCJmaWxlXCIpLGkudXNlX2ZpbGVpbnB1dD0hZS5kaXNhYmxlZH0sdXNlX3dlYmdsOmZ1bmN0aW9uKCl7dmFyIGUsbj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpLHI9bnVsbDt0cnl7cj1uLmdldENvbnRleHQoXCJ3ZWJnbFwiKXx8bi5nZXRDb250ZXh0KFwiZXhwZXJpbWVudGFsLXdlYmdsXCIpfWNhdGNoKG8pe31yZXR1cm4gcnx8KHI9bnVsbCksZT0hIXIsaS51c2Vfd2ViZ2w9ZSxuPXQsZX19O3JldHVybiBmdW5jdGlvbih0KXt2YXIgbj1bXS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7cmV0dXJuIG4uc2hpZnQoKSxcImZ1bmN0aW9uXCI9PT1lLnR5cGVPZihpW3RdKT9pW3RdLmFwcGx5KHRoaXMsbik6ISFpW3RdfX0oKSxvPShuZXcgbikuZ2V0UmVzdWx0KCksYT17Y2FuOnIsdWFQYXJzZXI6bixicm93c2VyOm8uYnJvd3Nlci5uYW1lLHZlcnNpb246by5icm93c2VyLnZlcnNpb24sb3M6by5vcy5uYW1lLG9zVmVyc2lvbjpvLm9zLnZlcnNpb24sdmVyQ29tcDppLHN3Zl91cmw6XCIuLi9mbGFzaC9Nb3hpZS5zd2ZcIix4YXBfdXJsOlwiLi4vc2lsdmVybGlnaHQvTW94aWUueGFwXCIsZ2xvYmFsX2V2ZW50X2Rpc3BhdGNoZXI6XCJtb3hpZS5jb3JlLkV2ZW50VGFyZ2V0Lmluc3RhbmNlLmRpc3BhdGNoRXZlbnRcIn07cmV0dXJuIGEuT1M9YS5vcyxhfSksbihcIm1veGllL2NvcmUvRXhjZXB0aW9uc1wiLFtcIm1veGllL2NvcmUvdXRpbHMvQmFzaWNcIl0sZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdChlLHQpe3ZhciBpO2ZvcihpIGluIGUpaWYoZVtpXT09PXQpcmV0dXJuIGk7cmV0dXJuIG51bGx9cmV0dXJue1J1bnRpbWVFcnJvcjpmdW5jdGlvbigpe2Z1bmN0aW9uIGkoZSxpKXt0aGlzLmNvZGU9ZSx0aGlzLm5hbWU9dChuLGUpLHRoaXMubWVzc2FnZT10aGlzLm5hbWUrKGl8fFwiOiBSdW50aW1lRXJyb3IgXCIrdGhpcy5jb2RlKX12YXIgbj17Tk9UX0lOSVRfRVJSOjEsRVhDRVBUSU9OX0VSUjozLE5PVF9TVVBQT1JURURfRVJSOjksSlNfRVJSOjR9O3JldHVybiBlLmV4dGVuZChpLG4pLGkucHJvdG90eXBlPUVycm9yLnByb3RvdHlwZSxpfSgpLE9wZXJhdGlvbk5vdEFsbG93ZWRFeGNlcHRpb246ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KGUpe3RoaXMuY29kZT1lLHRoaXMubmFtZT1cIk9wZXJhdGlvbk5vdEFsbG93ZWRFeGNlcHRpb25cIn1yZXR1cm4gZS5leHRlbmQodCx7Tk9UX0FMTE9XRURfRVJSOjF9KSx0LnByb3RvdHlwZT1FcnJvci5wcm90b3R5cGUsdH0oKSxJbWFnZUVycm9yOmZ1bmN0aW9uKCl7ZnVuY3Rpb24gaShlKXt0aGlzLmNvZGU9ZSx0aGlzLm5hbWU9dChuLGUpLHRoaXMubWVzc2FnZT10aGlzLm5hbWUrXCI6IEltYWdlRXJyb3IgXCIrdGhpcy5jb2RlfXZhciBuPXtXUk9OR19GT1JNQVQ6MSxNQVhfUkVTT0xVVElPTl9FUlI6MixJTlZBTElEX01FVEFfRVJSOjN9O3JldHVybiBlLmV4dGVuZChpLG4pLGkucHJvdG90eXBlPUVycm9yLnByb3RvdHlwZSxpfSgpLEZpbGVFeGNlcHRpb246ZnVuY3Rpb24oKXtmdW5jdGlvbiBpKGUpe3RoaXMuY29kZT1lLHRoaXMubmFtZT10KG4sZSksdGhpcy5tZXNzYWdlPXRoaXMubmFtZStcIjogRmlsZUV4Y2VwdGlvbiBcIit0aGlzLmNvZGV9dmFyIG49e05PVF9GT1VORF9FUlI6MSxTRUNVUklUWV9FUlI6MixBQk9SVF9FUlI6MyxOT1RfUkVBREFCTEVfRVJSOjQsRU5DT0RJTkdfRVJSOjUsTk9fTU9ESUZJQ0FUSU9OX0FMTE9XRURfRVJSOjYsSU5WQUxJRF9TVEFURV9FUlI6NyxTWU5UQVhfRVJSOjh9O3JldHVybiBlLmV4dGVuZChpLG4pLGkucHJvdG90eXBlPUVycm9yLnByb3RvdHlwZSxpfSgpLERPTUV4Y2VwdGlvbjpmdW5jdGlvbigpe2Z1bmN0aW9uIGkoZSl7dGhpcy5jb2RlPWUsdGhpcy5uYW1lPXQobixlKSx0aGlzLm1lc3NhZ2U9dGhpcy5uYW1lK1wiOiBET01FeGNlcHRpb24gXCIrdGhpcy5jb2RlfXZhciBuPXtJTkRFWF9TSVpFX0VSUjoxLERPTVNUUklOR19TSVpFX0VSUjoyLEhJRVJBUkNIWV9SRVFVRVNUX0VSUjozLFdST05HX0RPQ1VNRU5UX0VSUjo0LElOVkFMSURfQ0hBUkFDVEVSX0VSUjo1LE5PX0RBVEFfQUxMT1dFRF9FUlI6NixOT19NT0RJRklDQVRJT05fQUxMT1dFRF9FUlI6NyxOT1RfRk9VTkRfRVJSOjgsTk9UX1NVUFBPUlRFRF9FUlI6OSxJTlVTRV9BVFRSSUJVVEVfRVJSOjEwLElOVkFMSURfU1RBVEVfRVJSOjExLFNZTlRBWF9FUlI6MTIsSU5WQUxJRF9NT0RJRklDQVRJT05fRVJSOjEzLE5BTUVTUEFDRV9FUlI6MTQsSU5WQUxJRF9BQ0NFU1NfRVJSOjE1LFZBTElEQVRJT05fRVJSOjE2LFRZUEVfTUlTTUFUQ0hfRVJSOjE3LFNFQ1VSSVRZX0VSUjoxOCxORVRXT1JLX0VSUjoxOSxBQk9SVF9FUlI6MjAsVVJMX01JU01BVENIX0VSUjoyMSxRVU9UQV9FWENFRURFRF9FUlI6MjIsVElNRU9VVF9FUlI6MjMsSU5WQUxJRF9OT0RFX1RZUEVfRVJSOjI0LERBVEFfQ0xPTkVfRVJSOjI1fTtyZXR1cm4gZS5leHRlbmQoaSxuKSxpLnByb3RvdHlwZT1FcnJvci5wcm90b3R5cGUsaX0oKSxFdmVudEV4Y2VwdGlvbjpmdW5jdGlvbigpe2Z1bmN0aW9uIHQoZSl7dGhpcy5jb2RlPWUsdGhpcy5uYW1lPVwiRXZlbnRFeGNlcHRpb25cIn1yZXR1cm4gZS5leHRlbmQodCx7VU5TUEVDSUZJRURfRVZFTlRfVFlQRV9FUlI6MH0pLHQucHJvdG90eXBlPUVycm9yLnByb3RvdHlwZSx0fSgpfX0pLG4oXCJtb3hpZS9jb3JlL3V0aWxzL0RvbVwiLFtcIm1veGllL2NvcmUvdXRpbHMvRW52XCJdLGZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKGUpe3JldHVyblwic3RyaW5nXCIhPXR5cGVvZiBlP2U6ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZSl9LGk9ZnVuY3Rpb24oZSx0KXtpZighZS5jbGFzc05hbWUpcmV0dXJuITE7dmFyIGk9bmV3IFJlZ0V4cChcIihefFxcXFxzKylcIit0K1wiKFxcXFxzK3wkKVwiKTtyZXR1cm4gaS50ZXN0KGUuY2xhc3NOYW1lKX0sbj1mdW5jdGlvbihlLHQpe2koZSx0KXx8KGUuY2xhc3NOYW1lPWUuY2xhc3NOYW1lP2UuY2xhc3NOYW1lLnJlcGxhY2UoL1xccyskLyxcIlwiKStcIiBcIit0OnQpfSxyPWZ1bmN0aW9uKGUsdCl7aWYoZS5jbGFzc05hbWUpe3ZhciBpPW5ldyBSZWdFeHAoXCIoXnxcXFxccyspXCIrdCtcIihcXFxccyt8JClcIik7ZS5jbGFzc05hbWU9ZS5jbGFzc05hbWUucmVwbGFjZShpLGZ1bmN0aW9uKGUsdCxpKXtyZXR1cm5cIiBcIj09PXQmJlwiIFwiPT09aT9cIiBcIjpcIlwifSl9fSxvPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIGUuY3VycmVudFN0eWxlP2UuY3VycmVudFN0eWxlW3RdOndpbmRvdy5nZXRDb21wdXRlZFN0eWxlP3dpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGUsbnVsbClbdF06dm9pZCAwfSxhPWZ1bmN0aW9uKHQsaSl7ZnVuY3Rpb24gbihlKXt2YXIgdCxpLG49MCxyPTA7cmV0dXJuIGUmJihpPWUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksdD1cIkNTUzFDb21wYXRcIj09PWMuY29tcGF0TW9kZT9jLmRvY3VtZW50RWxlbWVudDpjLmJvZHksbj1pLmxlZnQrdC5zY3JvbGxMZWZ0LHI9aS50b3ArdC5zY3JvbGxUb3ApLHt4Om4seTpyfX12YXIgcixvLGEscz0wLHU9MCxjPWRvY3VtZW50O2lmKHQ9dCxpPWl8fGMuYm9keSx0JiZ0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCYmXCJJRVwiPT09ZS5icm93c2VyJiYoIWMuZG9jdW1lbnRNb2RlfHxjLmRvY3VtZW50TW9kZTw4KSlyZXR1cm4gbz1uKHQpLGE9bihpKSx7eDpvLngtYS54LHk6by55LWEueX07Zm9yKHI9dDtyJiZyIT1pJiZyLm5vZGVUeXBlOylzKz1yLm9mZnNldExlZnR8fDAsdSs9ci5vZmZzZXRUb3B8fDAscj1yLm9mZnNldFBhcmVudDtmb3Iocj10LnBhcmVudE5vZGU7ciYmciE9aSYmci5ub2RlVHlwZTspcy09ci5zY3JvbGxMZWZ0fHwwLHUtPXIuc2Nyb2xsVG9wfHwwLHI9ci5wYXJlbnROb2RlO3JldHVybnt4OnMseTp1fX0scz1mdW5jdGlvbihlKXtyZXR1cm57dzplLm9mZnNldFdpZHRofHxlLmNsaWVudFdpZHRoLGg6ZS5vZmZzZXRIZWlnaHR8fGUuY2xpZW50SGVpZ2h0fX07cmV0dXJue2dldDp0LGhhc0NsYXNzOmksYWRkQ2xhc3M6bixyZW1vdmVDbGFzczpyLGdldFN0eWxlOm8sZ2V0UG9zOmEsZ2V0U2l6ZTpzfX0pLG4oXCJtb3hpZS9jb3JlL0V2ZW50VGFyZ2V0XCIsW1wibW94aWUvY29yZS91dGlscy9FbnZcIixcIm1veGllL2NvcmUvRXhjZXB0aW9uc1wiLFwibW94aWUvY29yZS91dGlscy9CYXNpY1wiXSxmdW5jdGlvbihlLHQsaSl7ZnVuY3Rpb24gbigpe3RoaXMudWlkPWkuZ3VpZCgpfXZhciByPXt9O3JldHVybiBpLmV4dGVuZChuLnByb3RvdHlwZSx7aW5pdDpmdW5jdGlvbigpe3RoaXMudWlkfHwodGhpcy51aWQ9aS5ndWlkKFwidWlkX1wiKSl9LGFkZEV2ZW50TGlzdGVuZXI6ZnVuY3Rpb24oZSx0LG4sbyl7dmFyIGEscz10aGlzO3JldHVybiB0aGlzLmhhc093blByb3BlcnR5KFwidWlkXCIpfHwodGhpcy51aWQ9aS5ndWlkKFwidWlkX1wiKSksZT1pLnRyaW0oZSksL1xccy8udGVzdChlKT8oaS5lYWNoKGUuc3BsaXQoL1xccysvKSxmdW5jdGlvbihlKXtzLmFkZEV2ZW50TGlzdGVuZXIoZSx0LG4sbyl9KSx2b2lkIDApOihlPWUudG9Mb3dlckNhc2UoKSxuPXBhcnNlSW50KG4sMTApfHwwLGE9clt0aGlzLnVpZF0mJnJbdGhpcy51aWRdW2VdfHxbXSxhLnB1c2goe2ZuOnQscHJpb3JpdHk6bixzY29wZTpvfHx0aGlzfSksclt0aGlzLnVpZF18fChyW3RoaXMudWlkXT17fSksclt0aGlzLnVpZF1bZV09YSx2b2lkIDApfSxoYXNFdmVudExpc3RlbmVyOmZ1bmN0aW9uKGUpe3ZhciB0O3JldHVybiBlPyhlPWUudG9Mb3dlckNhc2UoKSx0PXJbdGhpcy51aWRdJiZyW3RoaXMudWlkXVtlXSk6dD1yW3RoaXMudWlkXSx0P3Q6ITF9LHJlbW92ZUV2ZW50TGlzdGVuZXI6ZnVuY3Rpb24oZSx0KXt2YXIgbixvLGE9dGhpcztpZihlPWUudG9Mb3dlckNhc2UoKSwvXFxzLy50ZXN0KGUpKXJldHVybiBpLmVhY2goZS5zcGxpdCgvXFxzKy8pLGZ1bmN0aW9uKGUpe2EucmVtb3ZlRXZlbnRMaXN0ZW5lcihlLHQpfSksdm9pZCAwO2lmKG49clt0aGlzLnVpZF0mJnJbdGhpcy51aWRdW2VdKXtpZih0KXtmb3Iobz1uLmxlbmd0aC0xO28+PTA7by0tKWlmKG5bb10uZm49PT10KXtuLnNwbGljZShvLDEpO2JyZWFrfX1lbHNlIG49W107bi5sZW5ndGh8fChkZWxldGUgclt0aGlzLnVpZF1bZV0saS5pc0VtcHR5T2JqKHJbdGhpcy51aWRdKSYmZGVsZXRlIHJbdGhpcy51aWRdKX19LHJlbW92ZUFsbEV2ZW50TGlzdGVuZXJzOmZ1bmN0aW9uKCl7clt0aGlzLnVpZF0mJmRlbGV0ZSByW3RoaXMudWlkXX0sZGlzcGF0Y2hFdmVudDpmdW5jdGlvbihlKXt2YXIgbixvLGEscyx1LGM9e30sbD0hMDtpZihcInN0cmluZ1wiIT09aS50eXBlT2YoZSkpe2lmKHM9ZSxcInN0cmluZ1wiIT09aS50eXBlT2Yocy50eXBlKSl0aHJvdyBuZXcgdC5FdmVudEV4Y2VwdGlvbih0LkV2ZW50RXhjZXB0aW9uLlVOU1BFQ0lGSUVEX0VWRU5UX1RZUEVfRVJSKTtlPXMudHlwZSxzLnRvdGFsIT09dSYmcy5sb2FkZWQhPT11JiYoYy50b3RhbD1zLnRvdGFsLGMubG9hZGVkPXMubG9hZGVkKSxjLmFzeW5jPXMuYXN5bmN8fCExfWlmKC0xIT09ZS5pbmRleE9mKFwiOjpcIik/ZnVuY3Rpb24odCl7bj10WzBdLGU9dFsxXX0oZS5zcGxpdChcIjo6XCIpKTpuPXRoaXMudWlkLGU9ZS50b0xvd2VyQ2FzZSgpLG89cltuXSYmcltuXVtlXSl7by5zb3J0KGZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQucHJpb3JpdHktZS5wcmlvcml0eX0pLGE9W10uc2xpY2UuY2FsbChhcmd1bWVudHMpLGEuc2hpZnQoKSxjLnR5cGU9ZSxhLnVuc2hpZnQoYyk7dmFyIGQ9W107aS5lYWNoKG8sZnVuY3Rpb24oZSl7YVswXS50YXJnZXQ9ZS5zY29wZSxjLmFzeW5jP2QucHVzaChmdW5jdGlvbih0KXtzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7dChlLmZuLmFwcGx5KGUuc2NvcGUsYSk9PT0hMSl9LDEpfSk6ZC5wdXNoKGZ1bmN0aW9uKHQpe3QoZS5mbi5hcHBseShlLnNjb3BlLGEpPT09ITEpfSl9KSxkLmxlbmd0aCYmaS5pblNlcmllcyhkLGZ1bmN0aW9uKGUpe2w9IWV9KX1yZXR1cm4gbH0sYmluZE9uY2U6ZnVuY3Rpb24oZSx0LGksbil7dmFyIHI9dGhpcztyLmJpbmQuY2FsbCh0aGlzLGUsZnVuY3Rpb24gbygpe3JldHVybiByLnVuYmluZChlLG8pLHQuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxpLG4pfSxiaW5kOmZ1bmN0aW9uKCl7dGhpcy5hZGRFdmVudExpc3RlbmVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sdW5iaW5kOmZ1bmN0aW9uKCl7dGhpcy5yZW1vdmVFdmVudExpc3RlbmVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sdW5iaW5kQWxsOmZ1bmN0aW9uKCl7dGhpcy5yZW1vdmVBbGxFdmVudExpc3RlbmVycy5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LHRyaWdnZXI6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kaXNwYXRjaEV2ZW50LmFwcGx5KHRoaXMsYXJndW1lbnRzKX0saGFuZGxlRXZlbnRQcm9wczpmdW5jdGlvbihlKXt2YXIgdD10aGlzO3RoaXMuYmluZChlLmpvaW4oXCIgXCIpLGZ1bmN0aW9uKGUpe3ZhciB0PVwib25cIitlLnR5cGUudG9Mb3dlckNhc2UoKTtcImZ1bmN0aW9uXCI9PT1pLnR5cGVPZih0aGlzW3RdKSYmdGhpc1t0XS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9KSxpLmVhY2goZSxmdW5jdGlvbihlKXtlPVwib25cIitlLnRvTG93ZXJDYXNlKGUpLFwidW5kZWZpbmVkXCI9PT1pLnR5cGVPZih0W2VdKSYmKHRbZV09bnVsbCl9KX19KSxuLmluc3RhbmNlPW5ldyBuLG59KSxuKFwibW94aWUvcnVudGltZS9SdW50aW1lXCIsW1wibW94aWUvY29yZS91dGlscy9FbnZcIixcIm1veGllL2NvcmUvdXRpbHMvQmFzaWNcIixcIm1veGllL2NvcmUvdXRpbHMvRG9tXCIsXCJtb3hpZS9jb3JlL0V2ZW50VGFyZ2V0XCJdLGZ1bmN0aW9uKGUsdCxpLG4pe2Z1bmN0aW9uIHIoZSxuLG8scyx1KXt2YXIgYyxsPXRoaXMsZD10Lmd1aWQobitcIl9cIiksbT11fHxcImJyb3dzZXJcIjtlPWV8fHt9LGFbZF09dGhpcyxvPXQuZXh0ZW5kKHthY2Nlc3NfYmluYXJ5OiExLGFjY2Vzc19pbWFnZV9iaW5hcnk6ITEsZGlzcGxheV9tZWRpYTohMSxkb19jb3JzOiExLGRyYWdfYW5kX2Ryb3A6ITEsZmlsdGVyX2J5X2V4dGVuc2lvbjohMCxyZXNpemVfaW1hZ2U6ITEscmVwb3J0X3VwbG9hZF9wcm9ncmVzczohMSxyZXR1cm5fcmVzcG9uc2VfaGVhZGVyczohMSxyZXR1cm5fcmVzcG9uc2VfdHlwZTohMSxyZXR1cm5fc3RhdHVzX2NvZGU6ITAsc2VuZF9jdXN0b21faGVhZGVyczohMSxzZWxlY3RfZmlsZTohMSxzZWxlY3RfZm9sZGVyOiExLHNlbGVjdF9tdWx0aXBsZTohMCxzZW5kX2JpbmFyeV9zdHJpbmc6ITEsc2VuZF9icm93c2VyX2Nvb2tpZXM6ITAsc2VuZF9tdWx0aXBhcnQ6ITAsc2xpY2VfYmxvYjohMSxzdHJlYW1fdXBsb2FkOiExLHN1bW1vbl9maWxlX2RpYWxvZzohMSx1cGxvYWRfZmlsZXNpemU6ITAsdXNlX2h0dHBfbWV0aG9kOiEwfSxvKSxlLnByZWZlcnJlZF9jYXBzJiYobT1yLmdldE1vZGUocyxlLnByZWZlcnJlZF9jYXBzLG0pKSxjPWZ1bmN0aW9uKCl7dmFyIGU9e307cmV0dXJue2V4ZWM6ZnVuY3Rpb24odCxpLG4scil7cmV0dXJuIGNbaV0mJihlW3RdfHwoZVt0XT17Y29udGV4dDp0aGlzLGluc3RhbmNlOm5ldyBjW2ldfSksZVt0XS5pbnN0YW5jZVtuXSk/ZVt0XS5pbnN0YW5jZVtuXS5hcHBseSh0aGlzLHIpOnZvaWQgMH0scmVtb3ZlSW5zdGFuY2U6ZnVuY3Rpb24odCl7ZGVsZXRlIGVbdF19LHJlbW92ZUFsbEluc3RhbmNlczpmdW5jdGlvbigpe3ZhciBpPXRoaXM7dC5lYWNoKGUsZnVuY3Rpb24oZSxuKXtcImZ1bmN0aW9uXCI9PT10LnR5cGVPZihlLmluc3RhbmNlLmRlc3Ryb3kpJiZlLmluc3RhbmNlLmRlc3Ryb3kuY2FsbChlLmNvbnRleHQpLGkucmVtb3ZlSW5zdGFuY2Uobil9KX19fSgpLHQuZXh0ZW5kKHRoaXMse2luaXRpYWxpemVkOiExLHVpZDpkLHR5cGU6bixtb2RlOnIuZ2V0TW9kZShzLGUucmVxdWlyZWRfY2FwcyxtKSxzaGltaWQ6ZCtcIl9jb250YWluZXJcIixjbGllbnRzOjAsb3B0aW9uczplLGNhbjpmdW5jdGlvbihlLGkpe3ZhciBuPWFyZ3VtZW50c1syXXx8bztpZihcInN0cmluZ1wiPT09dC50eXBlT2YoZSkmJlwidW5kZWZpbmVkXCI9PT10LnR5cGVPZihpKSYmKGU9ci5wYXJzZUNhcHMoZSkpLFwib2JqZWN0XCI9PT10LnR5cGVPZihlKSl7Zm9yKHZhciBhIGluIGUpaWYoIXRoaXMuY2FuKGEsZVthXSxuKSlyZXR1cm4hMTtyZXR1cm4hMH1yZXR1cm5cImZ1bmN0aW9uXCI9PT10LnR5cGVPZihuW2VdKT9uW2VdLmNhbGwodGhpcyxpKTppPT09bltlXX0sZ2V0U2hpbUNvbnRhaW5lcjpmdW5jdGlvbigpe3ZhciBlLG49aS5nZXQodGhpcy5zaGltaWQpO3JldHVybiBufHwoZT1pLmdldCh0aGlzLm9wdGlvbnMuY29udGFpbmVyKXx8ZG9jdW1lbnQuYm9keSxuPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiksbi5pZD10aGlzLnNoaW1pZCxuLmNsYXNzTmFtZT1cIm1veGllLXNoaW0gbW94aWUtc2hpbS1cIit0aGlzLnR5cGUsdC5leHRlbmQobi5zdHlsZSx7cG9zaXRpb246XCJhYnNvbHV0ZVwiLHRvcDpcIjBweFwiLGxlZnQ6XCIwcHhcIix3aWR0aDpcIjFweFwiLGhlaWdodDpcIjFweFwiLG92ZXJmbG93OlwiaGlkZGVuXCJ9KSxlLmFwcGVuZENoaWxkKG4pLGU9bnVsbCksbn0sZ2V0U2hpbTpmdW5jdGlvbigpe3JldHVybiBjfSxzaGltRXhlYzpmdW5jdGlvbihlLHQpe3ZhciBpPVtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLDIpO3JldHVybiBsLmdldFNoaW0oKS5leGVjLmNhbGwodGhpcyx0aGlzLnVpZCxlLHQsaSl9LGV4ZWM6ZnVuY3Rpb24oZSx0KXt2YXIgaT1bXS5zbGljZS5jYWxsKGFyZ3VtZW50cywyKTtyZXR1cm4gbFtlXSYmbFtlXVt0XT9sW2VdW3RdLmFwcGx5KHRoaXMsaSk6bC5zaGltRXhlYy5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LGRlc3Ryb3k6ZnVuY3Rpb24oKXtpZihsKXt2YXIgZT1pLmdldCh0aGlzLnNoaW1pZCk7ZSYmZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGUpLGMmJmMucmVtb3ZlQWxsSW5zdGFuY2VzKCksdGhpcy51bmJpbmRBbGwoKSxkZWxldGUgYVt0aGlzLnVpZF0sdGhpcy51aWQ9bnVsbCxkPWw9Yz1lPW51bGx9fX0pLHRoaXMubW9kZSYmZS5yZXF1aXJlZF9jYXBzJiYhdGhpcy5jYW4oZS5yZXF1aXJlZF9jYXBzKSYmKHRoaXMubW9kZT0hMSl9dmFyIG89e30sYT17fTtyZXR1cm4gci5vcmRlcj1cImh0bWw1LGZsYXNoLHNpbHZlcmxpZ2h0LGh0bWw0XCIsci5nZXRSdW50aW1lPWZ1bmN0aW9uKGUpe3JldHVybiBhW2VdP2FbZV06ITF9LHIuYWRkQ29uc3RydWN0b3I9ZnVuY3Rpb24oZSx0KXt0LnByb3RvdHlwZT1uLmluc3RhbmNlLG9bZV09dH0sci5nZXRDb25zdHJ1Y3Rvcj1mdW5jdGlvbihlKXtyZXR1cm4gb1tlXXx8bnVsbH0sci5nZXRJbmZvPWZ1bmN0aW9uKGUpe3ZhciB0PXIuZ2V0UnVudGltZShlKTtyZXR1cm4gdD97dWlkOnQudWlkLHR5cGU6dC50eXBlLG1vZGU6dC5tb2RlLGNhbjpmdW5jdGlvbigpe3JldHVybiB0LmNhbi5hcHBseSh0LGFyZ3VtZW50cyl9fTpudWxsfSxyLnBhcnNlQ2Fwcz1mdW5jdGlvbihlKXt2YXIgaT17fTtyZXR1cm5cInN0cmluZ1wiIT09dC50eXBlT2YoZSk/ZXx8e306KHQuZWFjaChlLnNwbGl0KFwiLFwiKSxmdW5jdGlvbihlKXtpW2VdPSEwfSksaSl9LHIuY2FuPWZ1bmN0aW9uKGUsdCl7dmFyIGksbixvPXIuZ2V0Q29uc3RydWN0b3IoZSk7cmV0dXJuIG8/KGk9bmV3IG8oe3JlcXVpcmVkX2NhcHM6dH0pLG49aS5tb2RlLGkuZGVzdHJveSgpLCEhbik6ITF9LHIudGhhdENhbj1mdW5jdGlvbihlLHQpe3ZhciBpPSh0fHxyLm9yZGVyKS5zcGxpdCgvXFxzKixcXHMqLyk7Zm9yKHZhciBuIGluIGkpaWYoci5jYW4oaVtuXSxlKSlyZXR1cm4gaVtuXTtyZXR1cm4gbnVsbH0sci5nZXRNb2RlPWZ1bmN0aW9uKGUsaSxuKXt2YXIgcj1udWxsO2lmKFwidW5kZWZpbmVkXCI9PT10LnR5cGVPZihuKSYmKG49XCJicm93c2VyXCIpLGkmJiF0LmlzRW1wdHlPYmooZSkpe2lmKHQuZWFjaChpLGZ1bmN0aW9uKGksbil7aWYoZS5oYXNPd25Qcm9wZXJ0eShuKSl7dmFyIG89ZVtuXShpKTtpZihcInN0cmluZ1wiPT10eXBlb2YgbyYmKG89W29dKSxyKXtpZighKHI9dC5hcnJheUludGVyc2VjdChyLG8pKSlyZXR1cm4gcj0hMX1lbHNlIHI9b319KSxyKXJldHVybi0xIT09dC5pbkFycmF5KG4scik/bjpyWzBdO2lmKHI9PT0hMSlyZXR1cm4hMX1yZXR1cm4gbn0sci5nZXRHbG9iYWxFdmVudFRhcmdldD1mdW5jdGlvbigpe2lmKC9ebW94aWVcXC4vLnRlc3QoZS5nbG9iYWxfZXZlbnRfZGlzcGF0Y2hlcikmJiFlLmNhbihcImFjY2Vzc19nbG9iYWxfbnNcIikpe3ZhciBpPXQuZ3VpZChcIm1veGllX2V2ZW50X3RhcmdldF9cIik7d2luZG93W2ldPWZ1bmN0aW9uKGUsdCl7bi5pbnN0YW5jZS5kaXNwYXRjaEV2ZW50KGUsdCl9LGUuZ2xvYmFsX2V2ZW50X2Rpc3BhdGNoZXI9aX1yZXR1cm4gZS5nbG9iYWxfZXZlbnRfZGlzcGF0Y2hlcn0sci5jYXBUcnVlPWZ1bmN0aW9uKCl7cmV0dXJuITB9LHIuY2FwRmFsc2U9ZnVuY3Rpb24oKXtyZXR1cm4hMX0sci5jYXBUZXN0PWZ1bmN0aW9uKGUpe3JldHVybiBmdW5jdGlvbigpe3JldHVybiEhZX19LHJ9KSxuKFwibW94aWUvcnVudGltZS9SdW50aW1lQ2xpZW50XCIsW1wibW94aWUvY29yZS91dGlscy9FbnZcIixcIm1veGllL2NvcmUvRXhjZXB0aW9uc1wiLFwibW94aWUvY29yZS91dGlscy9CYXNpY1wiLFwibW94aWUvcnVudGltZS9SdW50aW1lXCJdLGZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBmdW5jdGlvbigpe3ZhciBlO2kuZXh0ZW5kKHRoaXMse2Nvbm5lY3RSdW50aW1lOmZ1bmN0aW9uKHIpe2Z1bmN0aW9uIG8oaSl7dmFyIGEsdTtyZXR1cm4gaS5sZW5ndGg/KGE9aS5zaGlmdCgpLnRvTG93ZXJDYXNlKCksKHU9bi5nZXRDb25zdHJ1Y3RvcihhKSk/KGU9bmV3IHUociksZS5iaW5kKFwiSW5pdFwiLGZ1bmN0aW9uKCl7ZS5pbml0aWFsaXplZD0hMCxzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7ZS5jbGllbnRzKysscy5ydWlkPWUudWlkLHMudHJpZ2dlcihcIlJ1bnRpbWVJbml0XCIsZSl9LDEpfSksZS5iaW5kKFwiRXJyb3JcIixmdW5jdGlvbigpe2UuZGVzdHJveSgpLG8oaSl9KSxlLmJpbmQoXCJFeGNlcHRpb25cIixmdW5jdGlvbihlLGkpe3ZhciBuPWkubmFtZStcIigjXCIraS5jb2RlK1wiKVwiKyhpLm1lc3NhZ2U/XCIsIGZyb206IFwiK2kubWVzc2FnZTpcIlwiKTtzLnRyaWdnZXIoXCJSdW50aW1lRXJyb3JcIixuZXcgdC5SdW50aW1lRXJyb3IodC5SdW50aW1lRXJyb3IuRVhDRVBUSU9OX0VSUixuKSl9KSxlLm1vZGU/KGUuaW5pdCgpLHZvaWQgMCk6KGUudHJpZ2dlcihcIkVycm9yXCIpLHZvaWQgMCkpOihvKGkpLHZvaWQgMCkpOihzLnRyaWdnZXIoXCJSdW50aW1lRXJyb3JcIixuZXcgdC5SdW50aW1lRXJyb3IodC5SdW50aW1lRXJyb3IuTk9UX0lOSVRfRVJSKSksZT1udWxsLHZvaWQgMCl9dmFyIGEscz10aGlzO2lmKFwic3RyaW5nXCI9PT1pLnR5cGVPZihyKT9hPXI6XCJzdHJpbmdcIj09PWkudHlwZU9mKHIucnVpZCkmJihhPXIucnVpZCksYSl7aWYoZT1uLmdldFJ1bnRpbWUoYSkpcmV0dXJuIHMucnVpZD1hLGUuY2xpZW50cysrLGU7dGhyb3cgbmV3IHQuUnVudGltZUVycm9yKHQuUnVudGltZUVycm9yLk5PVF9JTklUX0VSUil9bygoci5ydW50aW1lX29yZGVyfHxuLm9yZGVyKS5zcGxpdCgvXFxzKixcXHMqLykpfSxkaXNjb25uZWN0UnVudGltZTpmdW5jdGlvbigpe2UmJi0tZS5jbGllbnRzPD0wJiZlLmRlc3Ryb3koKSxlPW51bGx9LGdldFJ1bnRpbWU6ZnVuY3Rpb24oKXtyZXR1cm4gZSYmZS51aWQ/ZTplPW51bGx9LGV4ZWM6ZnVuY3Rpb24oKXtyZXR1cm4gZT9lLmV4ZWMuYXBwbHkodGhpcyxhcmd1bWVudHMpOm51bGx9LGNhbjpmdW5jdGlvbih0KXtyZXR1cm4gZT9lLmNhbih0KTohMX19KX19KSxuKFwibW94aWUvZmlsZS9CbG9iXCIsW1wibW94aWUvY29yZS91dGlscy9CYXNpY1wiLFwibW94aWUvY29yZS91dGlscy9FbmNvZGVcIixcIm1veGllL3J1bnRpbWUvUnVudGltZUNsaWVudFwiXSxmdW5jdGlvbihlLHQsaSl7ZnVuY3Rpb24gbihvLGEpe2Z1bmN0aW9uIHModCxpLG8pe3ZhciBhLHM9clt0aGlzLnVpZF07cmV0dXJuXCJzdHJpbmdcIj09PWUudHlwZU9mKHMpJiZzLmxlbmd0aD8oYT1uZXcgbihudWxsLHt0eXBlOm8sc2l6ZTppLXR9KSxhLmRldGFjaChzLnN1YnN0cih0LGEuc2l6ZSkpLGEpOm51bGx9aS5jYWxsKHRoaXMpLG8mJnRoaXMuY29ubmVjdFJ1bnRpbWUobyksYT9cInN0cmluZ1wiPT09ZS50eXBlT2YoYSkmJihhPXtkYXRhOmF9KTphPXt9LGUuZXh0ZW5kKHRoaXMse3VpZDphLnVpZHx8ZS5ndWlkKFwidWlkX1wiKSxydWlkOm8sc2l6ZTphLnNpemV8fDAsdHlwZTphLnR5cGV8fFwiXCIsc2xpY2U6ZnVuY3Rpb24oZSx0LGkpe3JldHVybiB0aGlzLmlzRGV0YWNoZWQoKT9zLmFwcGx5KHRoaXMsYXJndW1lbnRzKTp0aGlzLmdldFJ1bnRpbWUoKS5leGVjLmNhbGwodGhpcyxcIkJsb2JcIixcInNsaWNlXCIsdGhpcy5nZXRTb3VyY2UoKSxlLHQsaSl9LGdldFNvdXJjZTpmdW5jdGlvbigpe3JldHVybiByW3RoaXMudWlkXT9yW3RoaXMudWlkXTpudWxsfSxkZXRhY2g6ZnVuY3Rpb24oZSl7aWYodGhpcy5ydWlkJiYodGhpcy5nZXRSdW50aW1lKCkuZXhlYy5jYWxsKHRoaXMsXCJCbG9iXCIsXCJkZXN0cm95XCIpLHRoaXMuZGlzY29ubmVjdFJ1bnRpbWUoKSx0aGlzLnJ1aWQ9bnVsbCksZT1lfHxcIlwiLFwiZGF0YTpcIj09ZS5zdWJzdHIoMCw1KSl7dmFyIGk9ZS5pbmRleE9mKFwiO2Jhc2U2NCxcIik7dGhpcy50eXBlPWUuc3Vic3RyaW5nKDUsaSksZT10LmF0b2IoZS5zdWJzdHJpbmcoaSs4KSl9dGhpcy5zaXplPWUubGVuZ3RoLHJbdGhpcy51aWRdPWV9LGlzRGV0YWNoZWQ6ZnVuY3Rpb24oKXtyZXR1cm4hdGhpcy5ydWlkJiZcInN0cmluZ1wiPT09ZS50eXBlT2Yoclt0aGlzLnVpZF0pfSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5kZXRhY2goKSxkZWxldGUgclt0aGlzLnVpZF19fSksYS5kYXRhP3RoaXMuZGV0YWNoKGEuZGF0YSk6clt0aGlzLnVpZF09YX12YXIgcj17fTtyZXR1cm4gbn0pLG4oXCJtb3hpZS9jb3JlL0kxOG5cIixbXCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCJdLGZ1bmN0aW9uKGUpe3ZhciB0PXt9O3JldHVybnthZGRJMThuOmZ1bmN0aW9uKGkpe3JldHVybiBlLmV4dGVuZCh0LGkpfSx0cmFuc2xhdGU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRbZV18fGV9LF86ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMudHJhbnNsYXRlKGUpfSxzcHJpbnRmOmZ1bmN0aW9uKHQpe3ZhciBpPVtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpO3JldHVybiB0LnJlcGxhY2UoLyVbYS16XS9nLGZ1bmN0aW9uKCl7dmFyIHQ9aS5zaGlmdCgpO3JldHVyblwidW5kZWZpbmVkXCIhPT1lLnR5cGVPZih0KT90OlwiXCJ9KX19fSksbihcIm1veGllL2NvcmUvdXRpbHMvTWltZVwiLFtcIm1veGllL2NvcmUvdXRpbHMvQmFzaWNcIixcIm1veGllL2NvcmUvSTE4blwiXSxmdW5jdGlvbihlLHQpe3ZhciBpPVwiYXBwbGljYXRpb24vbXN3b3JkLGRvYyBkb3QsYXBwbGljYXRpb24vcGRmLHBkZixhcHBsaWNhdGlvbi9wZ3Atc2lnbmF0dXJlLHBncCxhcHBsaWNhdGlvbi9wb3N0c2NyaXB0LHBzIGFpIGVwcyxhcHBsaWNhdGlvbi9ydGYscnRmLGFwcGxpY2F0aW9uL3ZuZC5tcy1leGNlbCx4bHMgeGxiIHhsdCB4bGEsYXBwbGljYXRpb24vdm5kLm1zLXBvd2VycG9pbnQscHB0IHBwcyBwb3QgcHBhLGFwcGxpY2F0aW9uL3ppcCx6aXAsYXBwbGljYXRpb24veC1zaG9ja3dhdmUtZmxhc2gsc3dmIHN3ZmwsYXBwbGljYXRpb24vdm5kLm9wZW54bWxmb3JtYXRzLW9mZmljZWRvY3VtZW50LndvcmRwcm9jZXNzaW5nbWwuZG9jdW1lbnQsZG9jeCxhcHBsaWNhdGlvbi92bmQub3BlbnhtbGZvcm1hdHMtb2ZmaWNlZG9jdW1lbnQud29yZHByb2Nlc3NpbmdtbC50ZW1wbGF0ZSxkb3R4LGFwcGxpY2F0aW9uL3ZuZC5vcGVueG1sZm9ybWF0cy1vZmZpY2Vkb2N1bWVudC5zcHJlYWRzaGVldG1sLnNoZWV0LHhsc3gsYXBwbGljYXRpb24vdm5kLm9wZW54bWxmb3JtYXRzLW9mZmljZWRvY3VtZW50LnByZXNlbnRhdGlvbm1sLnByZXNlbnRhdGlvbixwcHR4LGFwcGxpY2F0aW9uL3ZuZC5vcGVueG1sZm9ybWF0cy1vZmZpY2Vkb2N1bWVudC5wcmVzZW50YXRpb25tbC50ZW1wbGF0ZSxwb3R4LGFwcGxpY2F0aW9uL3ZuZC5vcGVueG1sZm9ybWF0cy1vZmZpY2Vkb2N1bWVudC5wcmVzZW50YXRpb25tbC5zbGlkZXNob3cscHBzeCxhcHBsaWNhdGlvbi94LWphdmFzY3JpcHQsanMsYXBwbGljYXRpb24vanNvbixqc29uLGF1ZGlvL21wZWcsbXAzIG1wZ2EgbXBlZ2EgbXAyLGF1ZGlvL3gtd2F2LHdhdixhdWRpby94LW00YSxtNGEsYXVkaW8vb2dnLG9nYSBvZ2csYXVkaW8vYWlmZixhaWZmIGFpZixhdWRpby9mbGFjLGZsYWMsYXVkaW8vYWFjLGFhYyxhdWRpby9hYzMsYWMzLGF1ZGlvL3gtbXMtd21hLHdtYSxpbWFnZS9ibXAsYm1wLGltYWdlL2dpZixnaWYsaW1hZ2UvanBlZyxqcGcganBlZyBqcGUsaW1hZ2UvcGhvdG9zaG9wLHBzZCxpbWFnZS9wbmcscG5nLGltYWdlL3N2Zyt4bWwsc3ZnIHN2Z3osaW1hZ2UvdGlmZix0aWZmIHRpZix0ZXh0L3BsYWluLGFzYyB0eHQgdGV4dCBkaWZmIGxvZyx0ZXh0L2h0bWwsaHRtIGh0bWwgeGh0bWwsdGV4dC9jc3MsY3NzLHRleHQvY3N2LGNzdix0ZXh0L3J0ZixydGYsdmlkZW8vbXBlZyxtcGVnIG1wZyBtcGUgbTJ2LHZpZGVvL3F1aWNrdGltZSxxdCBtb3YsdmlkZW8vbXA0LG1wNCx2aWRlby94LW00dixtNHYsdmlkZW8veC1mbHYsZmx2LHZpZGVvL3gtbXMtd212LHdtdix2aWRlby9hdmksYXZpLHZpZGVvL3dlYm0sd2VibSx2aWRlby8zZ3BwLDNncHAgM2dwLHZpZGVvLzNncHAyLDNnMix2aWRlby92bmQucm4tcmVhbHZpZGVvLHJ2LHZpZGVvL29nZyxvZ3YsdmlkZW8veC1tYXRyb3NrYSxta3YsYXBwbGljYXRpb24vdm5kLm9hc2lzLm9wZW5kb2N1bWVudC5mb3JtdWxhLXRlbXBsYXRlLG90ZixhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0sZXhlXCIsbj17fSxyPXt9LG89ZnVuY3Rpb24oZSl7dmFyIHQsaSxvLGE9ZS5zcGxpdCgvLC8pO2Zvcih0PTA7dDxhLmxlbmd0aDt0Kz0yKXtmb3Iobz1hW3QrMV0uc3BsaXQoLyAvKSxpPTA7aTxvLmxlbmd0aDtpKyspbltvW2ldXT1hW3RdO3JbYVt0XV09b319LGE9ZnVuY3Rpb24odCxpKXt2YXIgbixyLG8sYSxzPVtdO2ZvcihyPTA7cjx0Lmxlbmd0aDtyKyspZm9yKG49dFtyXS5leHRlbnNpb25zLnRvTG93ZXJDYXNlKCkuc3BsaXQoL1xccyosXFxzKi8pLG89MDtvPG4ubGVuZ3RoO28rKyl7aWYoXCIqXCI9PT1uW29dKXJldHVybltdO2lmKGE9c1tuW29dXSxpJiYvXlxcdyskLy50ZXN0KG5bb10pKXMucHVzaChcIi5cIituW29dKTtlbHNlIGlmKGEmJi0xPT09ZS5pbkFycmF5KGEscykpcy5wdXNoKGEpO2Vsc2UgaWYoIWEpcmV0dXJuW119cmV0dXJuIHN9LHM9ZnVuY3Rpb24odCl7dmFyIGk9W107cmV0dXJuIGUuZWFjaCh0LGZ1bmN0aW9uKHQpe2lmKHQ9dC50b0xvd2VyQ2FzZSgpLFwiKlwiPT09dClyZXR1cm4gaT1bXSwhMTt2YXIgbj10Lm1hdGNoKC9eKFxcdyspXFwvKFxcKnxcXHcrKSQvKTtuJiYoXCIqXCI9PT1uWzJdP2UuZWFjaChyLGZ1bmN0aW9uKGUsdCl7bmV3IFJlZ0V4cChcIl5cIituWzFdK1wiL1wiKS50ZXN0KHQpJiZbXS5wdXNoLmFwcGx5KGksclt0XSl9KTpyW3RdJiZbXS5wdXNoLmFwcGx5KGksclt0XSkpfSksaX0sdT1mdW5jdGlvbihpKXt2YXIgbj1bXSxyPVtdO3JldHVyblwic3RyaW5nXCI9PT1lLnR5cGVPZihpKSYmKGk9ZS50cmltKGkpLnNwbGl0KC9cXHMqLFxccyovKSkscj1zKGkpLG4ucHVzaCh7dGl0bGU6dC50cmFuc2xhdGUoXCJGaWxlc1wiKSxleHRlbnNpb25zOnIubGVuZ3RoP3Iuam9pbihcIixcIik6XCIqXCJ9KSxufSxjPWZ1bmN0aW9uKGUpe3ZhciB0PWUmJmUubWF0Y2goL1xcLihbXi5dKykkLyk7cmV0dXJuIHQ/dFsxXS50b0xvd2VyQ2FzZSgpOlwiXCJ9LGw9ZnVuY3Rpb24oZSl7cmV0dXJuIG5bYyhlKV18fFwiXCJ9O3JldHVybiBvKGkpLHttaW1lczpuLGV4dGVuc2lvbnM6cixhZGRNaW1lVHlwZTpvLGV4dExpc3QybWltZXM6YSxtaW1lczJleHRzOnMsbWltZXMyZXh0TGlzdDp1LGdldEZpbGVFeHRlbnNpb246YyxnZXRGaWxlTWltZTpsfX0pLG4oXCJtb3hpZS9maWxlL0ZpbGVJbnB1dFwiLFtcIm1veGllL2NvcmUvdXRpbHMvQmFzaWNcIixcIm1veGllL2NvcmUvdXRpbHMvRW52XCIsXCJtb3hpZS9jb3JlL3V0aWxzL01pbWVcIixcIm1veGllL2NvcmUvdXRpbHMvRG9tXCIsXCJtb3hpZS9jb3JlL0V4Y2VwdGlvbnNcIixcIm1veGllL2NvcmUvRXZlbnRUYXJnZXRcIixcIm1veGllL2NvcmUvSTE4blwiLFwibW94aWUvcnVudGltZS9SdW50aW1lXCIsXCJtb3hpZS9ydW50aW1lL1J1bnRpbWVDbGllbnRcIl0sZnVuY3Rpb24oZSx0LGksbixyLG8sYSxzLHUpe2Z1bmN0aW9uIGModCl7dmFyIG8sYyxkO2lmKC0xIT09ZS5pbkFycmF5KGUudHlwZU9mKHQpLFtcInN0cmluZ1wiLFwibm9kZVwiXSkmJih0PXticm93c2VfYnV0dG9uOnR9KSxjPW4uZ2V0KHQuYnJvd3NlX2J1dHRvbiksIWMpdGhyb3cgbmV3IHIuRE9NRXhjZXB0aW9uKHIuRE9NRXhjZXB0aW9uLk5PVF9GT1VORF9FUlIpO2Q9e2FjY2VwdDpbe3RpdGxlOmEudHJhbnNsYXRlKFwiQWxsIEZpbGVzXCIpLGV4dGVuc2lvbnM6XCIqXCJ9XSxtdWx0aXBsZTohMSxyZXF1aXJlZF9jYXBzOiExLGNvbnRhaW5lcjpjLnBhcmVudE5vZGV8fGRvY3VtZW50LmJvZHl9LHQ9ZS5leHRlbmQoe30sZCx0KSxcInN0cmluZ1wiPT10eXBlb2YgdC5yZXF1aXJlZF9jYXBzJiYodC5yZXF1aXJlZF9jYXBzPXMucGFyc2VDYXBzKHQucmVxdWlyZWRfY2FwcykpLFwic3RyaW5nXCI9PXR5cGVvZiB0LmFjY2VwdCYmKHQuYWNjZXB0PWkubWltZXMyZXh0TGlzdCh0LmFjY2VwdCkpLG89bi5nZXQodC5jb250YWluZXIpLG98fChvPWRvY3VtZW50LmJvZHkpLFwic3RhdGljXCI9PT1uLmdldFN0eWxlKG8sXCJwb3NpdGlvblwiKSYmKG8uc3R5bGUucG9zaXRpb249XCJyZWxhdGl2ZVwiKSxvPWM9bnVsbCx1LmNhbGwodGhpcyksZS5leHRlbmQodGhpcyx7dWlkOmUuZ3VpZChcInVpZF9cIikscnVpZDpudWxsLHNoaW1pZDpudWxsLGZpbGVzOm51bGwsaW5pdDpmdW5jdGlvbigpe3ZhciBpPXRoaXM7aS5iaW5kKFwiUnVudGltZUluaXRcIixmdW5jdGlvbihyLG8pe2kucnVpZD1vLnVpZCxpLnNoaW1pZD1vLnNoaW1pZCxpLmJpbmQoXCJSZWFkeVwiLGZ1bmN0aW9uKCl7aS50cmlnZ2VyKFwiUmVmcmVzaFwiKX0sOTk5KSxpLmJpbmQoXCJSZWZyZXNoXCIsZnVuY3Rpb24oKXt2YXIgaSxyLGEscyx1O2E9bi5nZXQodC5icm93c2VfYnV0dG9uKSxzPW4uZ2V0KG8uc2hpbWlkKSxhJiYoaT1uLmdldFBvcyhhLG4uZ2V0KHQuY29udGFpbmVyKSkscj1uLmdldFNpemUoYSksdT1wYXJzZUludChuLmdldFN0eWxlKGEsXCJ6LWluZGV4XCIpLDEwKXx8MCxzJiZlLmV4dGVuZChzLnN0eWxlLHt0b3A6aS55K1wicHhcIixsZWZ0OmkueCtcInB4XCIsd2lkdGg6ci53K1wicHhcIixoZWlnaHQ6ci5oK1wicHhcIix6SW5kZXg6dSsxfSkpLHM9YT1udWxsfSksby5leGVjLmNhbGwoaSxcIkZpbGVJbnB1dFwiLFwiaW5pdFwiLHQpfSksaS5jb25uZWN0UnVudGltZShlLmV4dGVuZCh7fSx0LHtyZXF1aXJlZF9jYXBzOntzZWxlY3RfZmlsZTohMH19KSl9LGdldE9wdGlvbjpmdW5jdGlvbihlKXtyZXR1cm4gdFtlXX0sc2V0T3B0aW9uOmZ1bmN0aW9uKGUsbil7aWYodC5oYXNPd25Qcm9wZXJ0eShlKSl7dmFyIG89dFtlXTtzd2l0Y2goZSl7Y2FzZVwiYWNjZXB0XCI6XCJzdHJpbmdcIj09dHlwZW9mIG4mJihuPWkubWltZXMyZXh0TGlzdChuKSk7YnJlYWs7Y2FzZVwiY29udGFpbmVyXCI6Y2FzZVwicmVxdWlyZWRfY2Fwc1wiOnRocm93IG5ldyByLkZpbGVFeGNlcHRpb24oci5GaWxlRXhjZXB0aW9uLk5PX01PRElGSUNBVElPTl9BTExPV0VEX0VSUil9dFtlXT1uLHRoaXMuZXhlYyhcIkZpbGVJbnB1dFwiLFwic2V0T3B0aW9uXCIsZSxuKSx0aGlzLnRyaWdnZXIoXCJPcHRpb25DaGFuZ2VkXCIsZSxuLG8pfX0sZGlzYWJsZTpmdW5jdGlvbih0KXt2YXIgaT10aGlzLmdldFJ1bnRpbWUoKTtpJiZ0aGlzLmV4ZWMoXCJGaWxlSW5wdXRcIixcImRpc2FibGVcIixcInVuZGVmaW5lZFwiPT09ZS50eXBlT2YodCk/ITA6dCl9LHJlZnJlc2g6ZnVuY3Rpb24oKXt0aGlzLnRyaWdnZXIoXCJSZWZyZXNoXCIpfSxkZXN0cm95OmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5nZXRSdW50aW1lKCk7dCYmKHQuZXhlYy5jYWxsKHRoaXMsXCJGaWxlSW5wdXRcIixcImRlc3Ryb3lcIiksdGhpcy5kaXNjb25uZWN0UnVudGltZSgpKSxcImFycmF5XCI9PT1lLnR5cGVPZih0aGlzLmZpbGVzKSYmZS5lYWNoKHRoaXMuZmlsZXMsZnVuY3Rpb24oZSl7ZS5kZXN0cm95KCl9KSx0aGlzLmZpbGVzPW51bGwsdGhpcy51bmJpbmRBbGwoKX19KSx0aGlzLmhhbmRsZUV2ZW50UHJvcHMobCl9dmFyIGw9W1wicmVhZHlcIixcImNoYW5nZVwiLFwiY2FuY2VsXCIsXCJtb3VzZWVudGVyXCIsXCJtb3VzZWxlYXZlXCIsXCJtb3VzZWRvd25cIixcIm1vdXNldXBcIl07cmV0dXJuIGMucHJvdG90eXBlPW8uaW5zdGFuY2UsY30pLG4oXCJtb3hpZS9maWxlL0ZpbGVcIixbXCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCIsXCJtb3hpZS9jb3JlL3V0aWxzL01pbWVcIixcIm1veGllL2ZpbGUvQmxvYlwiXSxmdW5jdGlvbihlLHQsaSl7ZnVuY3Rpb24gbihuLHIpe3J8fChyPXt9KSxpLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLnR5cGV8fCh0aGlzLnR5cGU9dC5nZXRGaWxlTWltZShyLm5hbWUpKTt2YXIgbztpZihyLm5hbWUpbz1yLm5hbWUucmVwbGFjZSgvXFxcXC9nLFwiL1wiKSxvPW8uc3Vic3RyKG8ubGFzdEluZGV4T2YoXCIvXCIpKzEpO2Vsc2UgaWYodGhpcy50eXBlKXt2YXIgYT10aGlzLnR5cGUuc3BsaXQoXCIvXCIpWzBdO289ZS5ndWlkKChcIlwiIT09YT9hOlwiZmlsZVwiKStcIl9cIiksdC5leHRlbnNpb25zW3RoaXMudHlwZV0mJihvKz1cIi5cIit0LmV4dGVuc2lvbnNbdGhpcy50eXBlXVswXSl9ZS5leHRlbmQodGhpcyx7bmFtZTpvfHxlLmd1aWQoXCJmaWxlX1wiKSxyZWxhdGl2ZVBhdGg6XCJcIixsYXN0TW9kaWZpZWREYXRlOnIubGFzdE1vZGlmaWVkRGF0ZXx8KG5ldyBEYXRlKS50b0xvY2FsZVN0cmluZygpfSl9cmV0dXJuIG4ucHJvdG90eXBlPWkucHJvdG90eXBlLG59KSxuKFwibW94aWUvZmlsZS9GaWxlRHJvcFwiLFtcIm1veGllL2NvcmUvSTE4blwiLFwibW94aWUvY29yZS91dGlscy9Eb21cIixcIm1veGllL2NvcmUvRXhjZXB0aW9uc1wiLFwibW94aWUvY29yZS91dGlscy9CYXNpY1wiLFwibW94aWUvY29yZS91dGlscy9FbnZcIixcIm1veGllL2ZpbGUvRmlsZVwiLFwibW94aWUvcnVudGltZS9SdW50aW1lQ2xpZW50XCIsXCJtb3hpZS9jb3JlL0V2ZW50VGFyZ2V0XCIsXCJtb3hpZS9jb3JlL3V0aWxzL01pbWVcIl0sZnVuY3Rpb24oZSx0LGksbixyLG8sYSxzLHUpe2Z1bmN0aW9uIGMoaSl7dmFyIHIsbz10aGlzO1wic3RyaW5nXCI9PXR5cGVvZiBpJiYoaT17ZHJvcF96b25lOml9KSxyPXthY2NlcHQ6W3t0aXRsZTplLnRyYW5zbGF0ZShcIkFsbCBGaWxlc1wiKSxleHRlbnNpb25zOlwiKlwifV0scmVxdWlyZWRfY2Fwczp7ZHJhZ19hbmRfZHJvcDohMH19LGk9XCJvYmplY3RcIj09dHlwZW9mIGk/bi5leHRlbmQoe30scixpKTpyLGkuY29udGFpbmVyPXQuZ2V0KGkuZHJvcF96b25lKXx8ZG9jdW1lbnQuYm9keSxcInN0YXRpY1wiPT09dC5nZXRTdHlsZShpLmNvbnRhaW5lcixcInBvc2l0aW9uXCIpJiYoaS5jb250YWluZXIuc3R5bGUucG9zaXRpb249XCJyZWxhdGl2ZVwiKSxcInN0cmluZ1wiPT10eXBlb2YgaS5hY2NlcHQmJihpLmFjY2VwdD11Lm1pbWVzMmV4dExpc3QoaS5hY2NlcHQpKSxhLmNhbGwobyksbi5leHRlbmQobyx7dWlkOm4uZ3VpZChcInVpZF9cIikscnVpZDpudWxsLGZpbGVzOm51bGwsaW5pdDpmdW5jdGlvbigpe28uYmluZChcIlJ1bnRpbWVJbml0XCIsZnVuY3Rpb24oZSx0KXtvLnJ1aWQ9dC51aWQsdC5leGVjLmNhbGwobyxcIkZpbGVEcm9wXCIsXCJpbml0XCIsaSksby5kaXNwYXRjaEV2ZW50KFwicmVhZHlcIilcbn0pLG8uY29ubmVjdFJ1bnRpbWUoaSl9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLmdldFJ1bnRpbWUoKTtlJiYoZS5leGVjLmNhbGwodGhpcyxcIkZpbGVEcm9wXCIsXCJkZXN0cm95XCIpLHRoaXMuZGlzY29ubmVjdFJ1bnRpbWUoKSksdGhpcy5maWxlcz1udWxsLHRoaXMudW5iaW5kQWxsKCl9fSksdGhpcy5oYW5kbGVFdmVudFByb3BzKGwpfXZhciBsPVtcInJlYWR5XCIsXCJkcmFnZW50ZXJcIixcImRyYWdsZWF2ZVwiLFwiZHJvcFwiLFwiZXJyb3JcIl07cmV0dXJuIGMucHJvdG90eXBlPXMuaW5zdGFuY2UsY30pLG4oXCJtb3hpZS9maWxlL0ZpbGVSZWFkZXJcIixbXCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCIsXCJtb3hpZS9jb3JlL3V0aWxzL0VuY29kZVwiLFwibW94aWUvY29yZS9FeGNlcHRpb25zXCIsXCJtb3hpZS9jb3JlL0V2ZW50VGFyZ2V0XCIsXCJtb3hpZS9maWxlL0Jsb2JcIixcIm1veGllL3J1bnRpbWUvUnVudGltZUNsaWVudFwiXSxmdW5jdGlvbihlLHQsaSxuLHIsbyl7ZnVuY3Rpb24gYSgpe2Z1bmN0aW9uIG4oZSxuKXtpZih0aGlzLnRyaWdnZXIoXCJsb2Fkc3RhcnRcIiksdGhpcy5yZWFkeVN0YXRlPT09YS5MT0FESU5HKXJldHVybiB0aGlzLnRyaWdnZXIoXCJlcnJvclwiLG5ldyBpLkRPTUV4Y2VwdGlvbihpLkRPTUV4Y2VwdGlvbi5JTlZBTElEX1NUQVRFX0VSUikpLHRoaXMudHJpZ2dlcihcImxvYWRlbmRcIiksdm9pZCAwO2lmKCEobiBpbnN0YW5jZW9mIHIpKXJldHVybiB0aGlzLnRyaWdnZXIoXCJlcnJvclwiLG5ldyBpLkRPTUV4Y2VwdGlvbihpLkRPTUV4Y2VwdGlvbi5OT1RfRk9VTkRfRVJSKSksdGhpcy50cmlnZ2VyKFwibG9hZGVuZFwiKSx2b2lkIDA7aWYodGhpcy5yZXN1bHQ9bnVsbCx0aGlzLnJlYWR5U3RhdGU9YS5MT0FESU5HLG4uaXNEZXRhY2hlZCgpKXt2YXIgbz1uLmdldFNvdXJjZSgpO3N3aXRjaChlKXtjYXNlXCJyZWFkQXNUZXh0XCI6Y2FzZVwicmVhZEFzQmluYXJ5U3RyaW5nXCI6dGhpcy5yZXN1bHQ9bzticmVhaztjYXNlXCJyZWFkQXNEYXRhVVJMXCI6dGhpcy5yZXN1bHQ9XCJkYXRhOlwiK24udHlwZStcIjtiYXNlNjQsXCIrdC5idG9hKG8pfXRoaXMucmVhZHlTdGF0ZT1hLkRPTkUsdGhpcy50cmlnZ2VyKFwibG9hZFwiKSx0aGlzLnRyaWdnZXIoXCJsb2FkZW5kXCIpfWVsc2UgdGhpcy5jb25uZWN0UnVudGltZShuLnJ1aWQpLHRoaXMuZXhlYyhcIkZpbGVSZWFkZXJcIixcInJlYWRcIixlLG4pfW8uY2FsbCh0aGlzKSxlLmV4dGVuZCh0aGlzLHt1aWQ6ZS5ndWlkKFwidWlkX1wiKSxyZWFkeVN0YXRlOmEuRU1QVFkscmVzdWx0Om51bGwsZXJyb3I6bnVsbCxyZWFkQXNCaW5hcnlTdHJpbmc6ZnVuY3Rpb24oZSl7bi5jYWxsKHRoaXMsXCJyZWFkQXNCaW5hcnlTdHJpbmdcIixlKX0scmVhZEFzRGF0YVVSTDpmdW5jdGlvbihlKXtuLmNhbGwodGhpcyxcInJlYWRBc0RhdGFVUkxcIixlKX0scmVhZEFzVGV4dDpmdW5jdGlvbihlKXtuLmNhbGwodGhpcyxcInJlYWRBc1RleHRcIixlKX0sYWJvcnQ6ZnVuY3Rpb24oKXt0aGlzLnJlc3VsdD1udWxsLC0xPT09ZS5pbkFycmF5KHRoaXMucmVhZHlTdGF0ZSxbYS5FTVBUWSxhLkRPTkVdKSYmKHRoaXMucmVhZHlTdGF0ZT09PWEuTE9BRElORyYmKHRoaXMucmVhZHlTdGF0ZT1hLkRPTkUpLHRoaXMuZXhlYyhcIkZpbGVSZWFkZXJcIixcImFib3J0XCIpLHRoaXMudHJpZ2dlcihcImFib3J0XCIpLHRoaXMudHJpZ2dlcihcImxvYWRlbmRcIikpfSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5hYm9ydCgpLHRoaXMuZXhlYyhcIkZpbGVSZWFkZXJcIixcImRlc3Ryb3lcIiksdGhpcy5kaXNjb25uZWN0UnVudGltZSgpLHRoaXMudW5iaW5kQWxsKCl9fSksdGhpcy5oYW5kbGVFdmVudFByb3BzKHMpLHRoaXMuYmluZChcIkVycm9yXCIsZnVuY3Rpb24oZSx0KXt0aGlzLnJlYWR5U3RhdGU9YS5ET05FLHRoaXMuZXJyb3I9dH0sOTk5KSx0aGlzLmJpbmQoXCJMb2FkXCIsZnVuY3Rpb24oKXt0aGlzLnJlYWR5U3RhdGU9YS5ET05FfSw5OTkpfXZhciBzPVtcImxvYWRzdGFydFwiLFwicHJvZ3Jlc3NcIixcImxvYWRcIixcImFib3J0XCIsXCJlcnJvclwiLFwibG9hZGVuZFwiXTtyZXR1cm4gYS5FTVBUWT0wLGEuTE9BRElORz0xLGEuRE9ORT0yLGEucHJvdG90eXBlPW4uaW5zdGFuY2UsYX0pLG4oXCJtb3hpZS9jb3JlL3V0aWxzL1VybFwiLFtcIm1veGllL2NvcmUvdXRpbHMvQmFzaWNcIl0sZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oaSxuKXt2YXIgcixvPVtcInNvdXJjZVwiLFwic2NoZW1lXCIsXCJhdXRob3JpdHlcIixcInVzZXJJbmZvXCIsXCJ1c2VyXCIsXCJwYXNzXCIsXCJob3N0XCIsXCJwb3J0XCIsXCJyZWxhdGl2ZVwiLFwicGF0aFwiLFwiZGlyZWN0b3J5XCIsXCJmaWxlXCIsXCJxdWVyeVwiLFwiZnJhZ21lbnRcIl0sYT1vLmxlbmd0aCxzPXtodHRwOjgwLGh0dHBzOjQ0M30sdT17fSxjPS9eKD86KFteOlxcLz8jXSspOik/KD86XFwvXFwvKCkoPzooPzooKSg/OihbXjpAXFwvXSopOj8oW146QFxcL10qKSk/QCk/KFxcW1tcXGRhLWZBLUY6XStcXF18W146XFwvPyNdKikoPzo6KFxcZCopKT8pKT8oKSg/OigoKSg/Oig/OltePyNcXC9dKlxcLykqKSgpKD86W14/I10qKSkoPzpcXFxcPyhbXiNdKikpPyg/OiMoLiopKT8pLyxsPWMuZXhlYyhpfHxcIlwiKSxkPS9eXFwvXFwvXFx3Ly50ZXN0KGkpO3N3aXRjaChlLnR5cGVPZihuKSl7Y2FzZVwidW5kZWZpbmVkXCI6bj10KGRvY3VtZW50LmxvY2F0aW9uLmhyZWYsITEpO2JyZWFrO2Nhc2VcInN0cmluZ1wiOm49dChuLCExKX1mb3IoO2EtLTspbFthXSYmKHVbb1thXV09bFthXSk7aWYocj0hZCYmIXUuc2NoZW1lLChkfHxyKSYmKHUuc2NoZW1lPW4uc2NoZW1lKSxyKXt1Lmhvc3Q9bi5ob3N0LHUucG9ydD1uLnBvcnQ7dmFyIG09XCJcIjsvXlteXFwvXS8udGVzdCh1LnBhdGgpJiYobT1uLnBhdGgsbT0vXFwvW15cXC9dKlxcLlteXFwvXSokLy50ZXN0KG0pP20ucmVwbGFjZSgvXFwvW15cXC9dKyQvLFwiL1wiKTptLnJlcGxhY2UoL1xcLz8kLyxcIi9cIikpLHUucGF0aD1tKyh1LnBhdGh8fFwiXCIpfXJldHVybiB1LnBvcnR8fCh1LnBvcnQ9c1t1LnNjaGVtZV18fDgwKSx1LnBvcnQ9cGFyc2VJbnQodS5wb3J0LDEwKSx1LnBhdGh8fCh1LnBhdGg9XCIvXCIpLGRlbGV0ZSB1LnNvdXJjZSx1fSxpPWZ1bmN0aW9uKGUpe3ZhciBpPXtodHRwOjgwLGh0dHBzOjQ0M30sbj1cIm9iamVjdFwiPT10eXBlb2YgZT9lOnQoZSk7cmV0dXJuIG4uc2NoZW1lK1wiOi8vXCIrbi5ob3N0KyhuLnBvcnQhPT1pW24uc2NoZW1lXT9cIjpcIituLnBvcnQ6XCJcIikrbi5wYXRoKyhuLnF1ZXJ5P24ucXVlcnk6XCJcIil9LG49ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gaShlKXtyZXR1cm5bZS5zY2hlbWUsZS5ob3N0LGUucG9ydF0uam9pbihcIi9cIil9cmV0dXJuXCJzdHJpbmdcIj09dHlwZW9mIGUmJihlPXQoZSkpLGkodCgpKT09PWkoZSl9O3JldHVybntwYXJzZVVybDp0LHJlc29sdmVVcmw6aSxoYXNTYW1lT3JpZ2luOm59fSksbihcIm1veGllL3J1bnRpbWUvUnVudGltZVRhcmdldFwiLFtcIm1veGllL2NvcmUvdXRpbHMvQmFzaWNcIixcIm1veGllL3J1bnRpbWUvUnVudGltZUNsaWVudFwiLFwibW94aWUvY29yZS9FdmVudFRhcmdldFwiXSxmdW5jdGlvbihlLHQsaSl7ZnVuY3Rpb24gbigpe3RoaXMudWlkPWUuZ3VpZChcInVpZF9cIiksdC5jYWxsKHRoaXMpLHRoaXMuZGVzdHJveT1mdW5jdGlvbigpe3RoaXMuZGlzY29ubmVjdFJ1bnRpbWUoKSx0aGlzLnVuYmluZEFsbCgpfX1yZXR1cm4gbi5wcm90b3R5cGU9aS5pbnN0YW5jZSxufSksbihcIm1veGllL2ZpbGUvRmlsZVJlYWRlclN5bmNcIixbXCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCIsXCJtb3hpZS9ydW50aW1lL1J1bnRpbWVDbGllbnRcIixcIm1veGllL2NvcmUvdXRpbHMvRW5jb2RlXCJdLGZ1bmN0aW9uKGUsdCxpKXtyZXR1cm4gZnVuY3Rpb24oKXtmdW5jdGlvbiBuKGUsdCl7aWYoIXQuaXNEZXRhY2hlZCgpKXt2YXIgbj10aGlzLmNvbm5lY3RSdW50aW1lKHQucnVpZCkuZXhlYy5jYWxsKHRoaXMsXCJGaWxlUmVhZGVyU3luY1wiLFwicmVhZFwiLGUsdCk7cmV0dXJuIHRoaXMuZGlzY29ubmVjdFJ1bnRpbWUoKSxufXZhciByPXQuZ2V0U291cmNlKCk7c3dpdGNoKGUpe2Nhc2VcInJlYWRBc0JpbmFyeVN0cmluZ1wiOnJldHVybiByO2Nhc2VcInJlYWRBc0RhdGFVUkxcIjpyZXR1cm5cImRhdGE6XCIrdC50eXBlK1wiO2Jhc2U2NCxcIitpLmJ0b2Eocik7Y2FzZVwicmVhZEFzVGV4dFwiOmZvcih2YXIgbz1cIlwiLGE9MCxzPXIubGVuZ3RoO3M+YTthKyspbys9U3RyaW5nLmZyb21DaGFyQ29kZShyW2FdKTtyZXR1cm4gb319dC5jYWxsKHRoaXMpLGUuZXh0ZW5kKHRoaXMse3VpZDplLmd1aWQoXCJ1aWRfXCIpLHJlYWRBc0JpbmFyeVN0cmluZzpmdW5jdGlvbihlKXtyZXR1cm4gbi5jYWxsKHRoaXMsXCJyZWFkQXNCaW5hcnlTdHJpbmdcIixlKX0scmVhZEFzRGF0YVVSTDpmdW5jdGlvbihlKXtyZXR1cm4gbi5jYWxsKHRoaXMsXCJyZWFkQXNEYXRhVVJMXCIsZSl9LHJlYWRBc1RleHQ6ZnVuY3Rpb24oZSl7cmV0dXJuIG4uY2FsbCh0aGlzLFwicmVhZEFzVGV4dFwiLGUpfX0pfX0pLG4oXCJtb3hpZS94aHIvRm9ybURhdGFcIixbXCJtb3hpZS9jb3JlL0V4Y2VwdGlvbnNcIixcIm1veGllL2NvcmUvdXRpbHMvQmFzaWNcIixcIm1veGllL2ZpbGUvQmxvYlwiXSxmdW5jdGlvbihlLHQsaSl7ZnVuY3Rpb24gbigpe3ZhciBlLG49W107dC5leHRlbmQodGhpcyx7YXBwZW5kOmZ1bmN0aW9uKHIsbyl7dmFyIGE9dGhpcyxzPXQudHlwZU9mKG8pO28gaW5zdGFuY2VvZiBpP2U9e25hbWU6cix2YWx1ZTpvfTpcImFycmF5XCI9PT1zPyhyKz1cIltdXCIsdC5lYWNoKG8sZnVuY3Rpb24oZSl7YS5hcHBlbmQocixlKX0pKTpcIm9iamVjdFwiPT09cz90LmVhY2gobyxmdW5jdGlvbihlLHQpe2EuYXBwZW5kKHIrXCJbXCIrdCtcIl1cIixlKX0pOlwibnVsbFwiPT09c3x8XCJ1bmRlZmluZWRcIj09PXN8fFwibnVtYmVyXCI9PT1zJiZpc05hTihvKT9hLmFwcGVuZChyLFwiZmFsc2VcIik6bi5wdXNoKHtuYW1lOnIsdmFsdWU6by50b1N0cmluZygpfSl9LGhhc0Jsb2I6ZnVuY3Rpb24oKXtyZXR1cm4hIXRoaXMuZ2V0QmxvYigpfSxnZXRCbG9iOmZ1bmN0aW9uKCl7cmV0dXJuIGUmJmUudmFsdWV8fG51bGx9LGdldEJsb2JOYW1lOmZ1bmN0aW9uKCl7cmV0dXJuIGUmJmUubmFtZXx8bnVsbH0sZWFjaDpmdW5jdGlvbihpKXt0LmVhY2gobixmdW5jdGlvbihlKXtpKGUudmFsdWUsZS5uYW1lKX0pLGUmJmkoZS52YWx1ZSxlLm5hbWUpfSxkZXN0cm95OmZ1bmN0aW9uKCl7ZT1udWxsLG49W119fSl9cmV0dXJuIG59KSxuKFwibW94aWUveGhyL1hNTEh0dHBSZXF1ZXN0XCIsW1wibW94aWUvY29yZS91dGlscy9CYXNpY1wiLFwibW94aWUvY29yZS9FeGNlcHRpb25zXCIsXCJtb3hpZS9jb3JlL0V2ZW50VGFyZ2V0XCIsXCJtb3hpZS9jb3JlL3V0aWxzL0VuY29kZVwiLFwibW94aWUvY29yZS91dGlscy9VcmxcIixcIm1veGllL3J1bnRpbWUvUnVudGltZVwiLFwibW94aWUvcnVudGltZS9SdW50aW1lVGFyZ2V0XCIsXCJtb3hpZS9maWxlL0Jsb2JcIixcIm1veGllL2ZpbGUvRmlsZVJlYWRlclN5bmNcIixcIm1veGllL3hoci9Gb3JtRGF0YVwiLFwibW94aWUvY29yZS91dGlscy9FbnZcIixcIm1veGllL2NvcmUvdXRpbHMvTWltZVwiXSxmdW5jdGlvbihlLHQsaSxuLHIsbyxhLHMsdSxjLGwsZCl7ZnVuY3Rpb24gbSgpe3RoaXMudWlkPWUuZ3VpZChcInVpZF9cIil9ZnVuY3Rpb24gaCgpe2Z1bmN0aW9uIGkoZSx0KXtyZXR1cm4gSS5oYXNPd25Qcm9wZXJ0eShlKT8xPT09YXJndW1lbnRzLmxlbmd0aD9sLmNhbihcImRlZmluZV9wcm9wZXJ0eVwiKT9JW2VdOkFbZV06KGwuY2FuKFwiZGVmaW5lX3Byb3BlcnR5XCIpP0lbZV09dDpBW2VdPXQsdm9pZCAwKTp2b2lkIDB9ZnVuY3Rpb24gdSh0KXtmdW5jdGlvbiBuKCl7XyYmKF8uZGVzdHJveSgpLF89bnVsbCkscy5kaXNwYXRjaEV2ZW50KFwibG9hZGVuZFwiKSxzPW51bGx9ZnVuY3Rpb24gcihyKXtfLmJpbmQoXCJMb2FkU3RhcnRcIixmdW5jdGlvbihlKXtpKFwicmVhZHlTdGF0ZVwiLGguTE9BRElORykscy5kaXNwYXRjaEV2ZW50KFwicmVhZHlzdGF0ZWNoYW5nZVwiKSxzLmRpc3BhdGNoRXZlbnQoZSksTCYmcy51cGxvYWQuZGlzcGF0Y2hFdmVudChlKX0pLF8uYmluZChcIlByb2dyZXNzXCIsZnVuY3Rpb24oZSl7aShcInJlYWR5U3RhdGVcIikhPT1oLkxPQURJTkcmJihpKFwicmVhZHlTdGF0ZVwiLGguTE9BRElORykscy5kaXNwYXRjaEV2ZW50KFwicmVhZHlzdGF0ZWNoYW5nZVwiKSkscy5kaXNwYXRjaEV2ZW50KGUpfSksXy5iaW5kKFwiVXBsb2FkUHJvZ3Jlc3NcIixmdW5jdGlvbihlKXtMJiZzLnVwbG9hZC5kaXNwYXRjaEV2ZW50KHt0eXBlOlwicHJvZ3Jlc3NcIixsZW5ndGhDb21wdXRhYmxlOiExLHRvdGFsOmUudG90YWwsbG9hZGVkOmUubG9hZGVkfSl9KSxfLmJpbmQoXCJMb2FkXCIsZnVuY3Rpb24odCl7aShcInJlYWR5U3RhdGVcIixoLkRPTkUpLGkoXCJzdGF0dXNcIixOdW1iZXIoci5leGVjLmNhbGwoXyxcIlhNTEh0dHBSZXF1ZXN0XCIsXCJnZXRTdGF0dXNcIil8fDApKSxpKFwic3RhdHVzVGV4dFwiLGZbaShcInN0YXR1c1wiKV18fFwiXCIpLGkoXCJyZXNwb25zZVwiLHIuZXhlYy5jYWxsKF8sXCJYTUxIdHRwUmVxdWVzdFwiLFwiZ2V0UmVzcG9uc2VcIixpKFwicmVzcG9uc2VUeXBlXCIpKSksfmUuaW5BcnJheShpKFwicmVzcG9uc2VUeXBlXCIpLFtcInRleHRcIixcIlwiXSk/aShcInJlc3BvbnNlVGV4dFwiLGkoXCJyZXNwb25zZVwiKSk6XCJkb2N1bWVudFwiPT09aShcInJlc3BvbnNlVHlwZVwiKSYmaShcInJlc3BvbnNlWE1MXCIsaShcInJlc3BvbnNlXCIpKSxVPXIuZXhlYy5jYWxsKF8sXCJYTUxIdHRwUmVxdWVzdFwiLFwiZ2V0QWxsUmVzcG9uc2VIZWFkZXJzXCIpLHMuZGlzcGF0Y2hFdmVudChcInJlYWR5c3RhdGVjaGFuZ2VcIiksaShcInN0YXR1c1wiKT4wPyhMJiZzLnVwbG9hZC5kaXNwYXRjaEV2ZW50KHQpLHMuZGlzcGF0Y2hFdmVudCh0KSk6KEY9ITAscy5kaXNwYXRjaEV2ZW50KFwiZXJyb3JcIikpLG4oKX0pLF8uYmluZChcIkFib3J0XCIsZnVuY3Rpb24oZSl7cy5kaXNwYXRjaEV2ZW50KGUpLG4oKX0pLF8uYmluZChcIkVycm9yXCIsZnVuY3Rpb24oZSl7Rj0hMCxpKFwicmVhZHlTdGF0ZVwiLGguRE9ORSkscy5kaXNwYXRjaEV2ZW50KFwicmVhZHlzdGF0ZWNoYW5nZVwiKSxNPSEwLHMuZGlzcGF0Y2hFdmVudChlKSxuKCl9KSxyLmV4ZWMuY2FsbChfLFwiWE1MSHR0cFJlcXVlc3RcIixcInNlbmRcIix7dXJsOngsbWV0aG9kOnYsYXN5bmM6VCx1c2VyOncscGFzc3dvcmQ6eSxoZWFkZXJzOlMsbWltZVR5cGU6RCxlbmNvZGluZzpPLHJlc3BvbnNlVHlwZTpzLnJlc3BvbnNlVHlwZSx3aXRoQ3JlZGVudGlhbHM6cy53aXRoQ3JlZGVudGlhbHMsb3B0aW9uczprfSx0KX12YXIgcz10aGlzO0U9KG5ldyBEYXRlKS5nZXRUaW1lKCksXz1uZXcgYSxcInN0cmluZ1wiPT10eXBlb2Ygay5yZXF1aXJlZF9jYXBzJiYoay5yZXF1aXJlZF9jYXBzPW8ucGFyc2VDYXBzKGsucmVxdWlyZWRfY2FwcykpLGsucmVxdWlyZWRfY2Fwcz1lLmV4dGVuZCh7fSxrLnJlcXVpcmVkX2NhcHMse3JldHVybl9yZXNwb25zZV90eXBlOnMucmVzcG9uc2VUeXBlfSksdCBpbnN0YW5jZW9mIGMmJihrLnJlcXVpcmVkX2NhcHMuc2VuZF9tdWx0aXBhcnQ9ITApLGUuaXNFbXB0eU9iaihTKXx8KGsucmVxdWlyZWRfY2Fwcy5zZW5kX2N1c3RvbV9oZWFkZXJzPSEwKSxCfHwoay5yZXF1aXJlZF9jYXBzLmRvX2NvcnM9ITApLGsucnVpZD9yKF8uY29ubmVjdFJ1bnRpbWUoaykpOihfLmJpbmQoXCJSdW50aW1lSW5pdFwiLGZ1bmN0aW9uKGUsdCl7cih0KX0pLF8uYmluZChcIlJ1bnRpbWVFcnJvclwiLGZ1bmN0aW9uKGUsdCl7cy5kaXNwYXRjaEV2ZW50KFwiUnVudGltZUVycm9yXCIsdCl9KSxfLmNvbm5lY3RSdW50aW1lKGspKX1mdW5jdGlvbiBnKCl7aShcInJlc3BvbnNlVGV4dFwiLFwiXCIpLGkoXCJyZXNwb25zZVhNTFwiLG51bGwpLGkoXCJyZXNwb25zZVwiLG51bGwpLGkoXCJzdGF0dXNcIiwwKSxpKFwic3RhdHVzVGV4dFwiLFwiXCIpLEU9Yj1udWxsfXZhciB4LHYsdyx5LEUsYixfLFIsQT10aGlzLEk9e3RpbWVvdXQ6MCxyZWFkeVN0YXRlOmguVU5TRU5ULHdpdGhDcmVkZW50aWFsczohMSxzdGF0dXM6MCxzdGF0dXNUZXh0OlwiXCIscmVzcG9uc2VUeXBlOlwiXCIscmVzcG9uc2VYTUw6bnVsbCxyZXNwb25zZVRleHQ6bnVsbCxyZXNwb25zZTpudWxsfSxUPSEwLFM9e30sTz1udWxsLEQ9bnVsbCxOPSExLEM9ITEsTD0hMSxNPSExLEY9ITEsQj0hMSxQPW51bGwsSD1udWxsLGs9e30sVT1cIlwiO2UuZXh0ZW5kKHRoaXMsSSx7dWlkOmUuZ3VpZChcInVpZF9cIiksdXBsb2FkOm5ldyBtLG9wZW46ZnVuY3Rpb24obyxhLHMsdSxjKXt2YXIgbDtpZighb3x8IWEpdGhyb3cgbmV3IHQuRE9NRXhjZXB0aW9uKHQuRE9NRXhjZXB0aW9uLlNZTlRBWF9FUlIpO2lmKC9bXFx1MDEwMC1cXHVmZmZmXS8udGVzdChvKXx8bi51dGY4X2VuY29kZShvKSE9PW8pdGhyb3cgbmV3IHQuRE9NRXhjZXB0aW9uKHQuRE9NRXhjZXB0aW9uLlNZTlRBWF9FUlIpO2lmKH5lLmluQXJyYXkoby50b1VwcGVyQ2FzZSgpLFtcIkNPTk5FQ1RcIixcIkRFTEVURVwiLFwiR0VUXCIsXCJIRUFEXCIsXCJPUFRJT05TXCIsXCJQT1NUXCIsXCJQVVRcIixcIlRSQUNFXCIsXCJUUkFDS1wiXSkmJih2PW8udG9VcHBlckNhc2UoKSksfmUuaW5BcnJheSh2LFtcIkNPTk5FQ1RcIixcIlRSQUNFXCIsXCJUUkFDS1wiXSkpdGhyb3cgbmV3IHQuRE9NRXhjZXB0aW9uKHQuRE9NRXhjZXB0aW9uLlNFQ1VSSVRZX0VSUik7aWYoYT1uLnV0ZjhfZW5jb2RlKGEpLGw9ci5wYXJzZVVybChhKSxCPXIuaGFzU2FtZU9yaWdpbihsKSx4PXIucmVzb2x2ZVVybChhKSwodXx8YykmJiFCKXRocm93IG5ldyB0LkRPTUV4Y2VwdGlvbih0LkRPTUV4Y2VwdGlvbi5JTlZBTElEX0FDQ0VTU19FUlIpO2lmKHc9dXx8bC51c2VyLHk9Y3x8bC5wYXNzLFQ9c3x8ITAsVD09PSExJiYoaShcInRpbWVvdXRcIil8fGkoXCJ3aXRoQ3JlZGVudGlhbHNcIil8fFwiXCIhPT1pKFwicmVzcG9uc2VUeXBlXCIpKSl0aHJvdyBuZXcgdC5ET01FeGNlcHRpb24odC5ET01FeGNlcHRpb24uSU5WQUxJRF9BQ0NFU1NfRVJSKTtOPSFULEM9ITEsUz17fSxnLmNhbGwodGhpcyksaShcInJlYWR5U3RhdGVcIixoLk9QRU5FRCksdGhpcy5kaXNwYXRjaEV2ZW50KFwicmVhZHlzdGF0ZWNoYW5nZVwiKX0sc2V0UmVxdWVzdEhlYWRlcjpmdW5jdGlvbihyLG8pe3ZhciBhPVtcImFjY2VwdC1jaGFyc2V0XCIsXCJhY2NlcHQtZW5jb2RpbmdcIixcImFjY2Vzcy1jb250cm9sLXJlcXVlc3QtaGVhZGVyc1wiLFwiYWNjZXNzLWNvbnRyb2wtcmVxdWVzdC1tZXRob2RcIixcImNvbm5lY3Rpb25cIixcImNvbnRlbnQtbGVuZ3RoXCIsXCJjb29raWVcIixcImNvb2tpZTJcIixcImNvbnRlbnQtdHJhbnNmZXItZW5jb2RpbmdcIixcImRhdGVcIixcImV4cGVjdFwiLFwiaG9zdFwiLFwia2VlcC1hbGl2ZVwiLFwib3JpZ2luXCIsXCJyZWZlcmVyXCIsXCJ0ZVwiLFwidHJhaWxlclwiLFwidHJhbnNmZXItZW5jb2RpbmdcIixcInVwZ3JhZGVcIixcInVzZXItYWdlbnRcIixcInZpYVwiXTtpZihpKFwicmVhZHlTdGF0ZVwiKSE9PWguT1BFTkVEfHxDKXRocm93IG5ldyB0LkRPTUV4Y2VwdGlvbih0LkRPTUV4Y2VwdGlvbi5JTlZBTElEX1NUQVRFX0VSUik7aWYoL1tcXHUwMTAwLVxcdWZmZmZdLy50ZXN0KHIpfHxuLnV0ZjhfZW5jb2RlKHIpIT09cil0aHJvdyBuZXcgdC5ET01FeGNlcHRpb24odC5ET01FeGNlcHRpb24uU1lOVEFYX0VSUik7cmV0dXJuIHI9ZS50cmltKHIpLnRvTG93ZXJDYXNlKCksfmUuaW5BcnJheShyLGEpfHwvXihwcm94eVxcLXxzZWNcXC0pLy50ZXN0KHIpPyExOihTW3JdP1Nbcl0rPVwiLCBcIitvOlNbcl09bywhMCl9LGhhc1JlcXVlc3RIZWFkZXI6ZnVuY3Rpb24oZSl7cmV0dXJuIGUmJlNbZS50b0xvd2VyQ2FzZSgpXXx8ITF9LGdldEFsbFJlc3BvbnNlSGVhZGVyczpmdW5jdGlvbigpe3JldHVybiBVfHxcIlwifSxnZXRSZXNwb25zZUhlYWRlcjpmdW5jdGlvbih0KXtyZXR1cm4gdD10LnRvTG93ZXJDYXNlKCksRnx8fmUuaW5BcnJheSh0LFtcInNldC1jb29raWVcIixcInNldC1jb29raWUyXCJdKT9udWxsOlUmJlwiXCIhPT1VJiYoUnx8KFI9e30sZS5lYWNoKFUuc3BsaXQoL1xcclxcbi8pLGZ1bmN0aW9uKHQpe3ZhciBpPXQuc3BsaXQoLzpcXHMrLyk7Mj09PWkubGVuZ3RoJiYoaVswXT1lLnRyaW0oaVswXSksUltpWzBdLnRvTG93ZXJDYXNlKCldPXtoZWFkZXI6aVswXSx2YWx1ZTplLnRyaW0oaVsxXSl9KX0pKSxSLmhhc093blByb3BlcnR5KHQpKT9SW3RdLmhlYWRlcitcIjogXCIrUlt0XS52YWx1ZTpudWxsfSxvdmVycmlkZU1pbWVUeXBlOmZ1bmN0aW9uKG4pe3ZhciByLG87aWYofmUuaW5BcnJheShpKFwicmVhZHlTdGF0ZVwiKSxbaC5MT0FESU5HLGguRE9ORV0pKXRocm93IG5ldyB0LkRPTUV4Y2VwdGlvbih0LkRPTUV4Y2VwdGlvbi5JTlZBTElEX1NUQVRFX0VSUik7aWYobj1lLnRyaW0obi50b0xvd2VyQ2FzZSgpKSwvOy8udGVzdChuKSYmKHI9bi5tYXRjaCgvXihbXjtdKykoPzo7XFxzY2hhcnNldFxcPSk/KC4qKSQvKSkmJihuPXJbMV0sclsyXSYmKG89clsyXSkpLCFkLm1pbWVzW25dKXRocm93IG5ldyB0LkRPTUV4Y2VwdGlvbih0LkRPTUV4Y2VwdGlvbi5TWU5UQVhfRVJSKTtQPW4sSD1vfSxzZW5kOmZ1bmN0aW9uKGkscil7aWYoaz1cInN0cmluZ1wiPT09ZS50eXBlT2Yocik/e3J1aWQ6cn06cj9yOnt9LHRoaXMucmVhZHlTdGF0ZSE9PWguT1BFTkVEfHxDKXRocm93IG5ldyB0LkRPTUV4Y2VwdGlvbih0LkRPTUV4Y2VwdGlvbi5JTlZBTElEX1NUQVRFX0VSUik7aWYoaSBpbnN0YW5jZW9mIHMpay5ydWlkPWkucnVpZCxEPWkudHlwZXx8XCJhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW1cIjtlbHNlIGlmKGkgaW5zdGFuY2VvZiBjKXtpZihpLmhhc0Jsb2IoKSl7dmFyIG89aS5nZXRCbG9iKCk7ay5ydWlkPW8ucnVpZCxEPW8udHlwZXx8XCJhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW1cIn19ZWxzZVwic3RyaW5nXCI9PXR5cGVvZiBpJiYoTz1cIlVURi04XCIsRD1cInRleHQvcGxhaW47Y2hhcnNldD1VVEYtOFwiLGk9bi51dGY4X2VuY29kZShpKSk7dGhpcy53aXRoQ3JlZGVudGlhbHN8fCh0aGlzLndpdGhDcmVkZW50aWFscz1rLnJlcXVpcmVkX2NhcHMmJmsucmVxdWlyZWRfY2Fwcy5zZW5kX2Jyb3dzZXJfY29va2llcyYmIUIpLEw9IU4mJnRoaXMudXBsb2FkLmhhc0V2ZW50TGlzdGVuZXIoKSxGPSExLE09IWksTnx8KEM9ITApLHUuY2FsbCh0aGlzLGkpfSxhYm9ydDpmdW5jdGlvbigpe2lmKEY9ITAsTj0hMSx+ZS5pbkFycmF5KGkoXCJyZWFkeVN0YXRlXCIpLFtoLlVOU0VOVCxoLk9QRU5FRCxoLkRPTkVdKSlpKFwicmVhZHlTdGF0ZVwiLGguVU5TRU5UKTtlbHNle2lmKGkoXCJyZWFkeVN0YXRlXCIsaC5ET05FKSxDPSExLCFfKXRocm93IG5ldyB0LkRPTUV4Y2VwdGlvbih0LkRPTUV4Y2VwdGlvbi5JTlZBTElEX1NUQVRFX0VSUik7Xy5nZXRSdW50aW1lKCkuZXhlYy5jYWxsKF8sXCJYTUxIdHRwUmVxdWVzdFwiLFwiYWJvcnRcIixNKSxNPSEwfX0sZGVzdHJveTpmdW5jdGlvbigpe18mJihcImZ1bmN0aW9uXCI9PT1lLnR5cGVPZihfLmRlc3Ryb3kpJiZfLmRlc3Ryb3koKSxfPW51bGwpLHRoaXMudW5iaW5kQWxsKCksdGhpcy51cGxvYWQmJih0aGlzLnVwbG9hZC51bmJpbmRBbGwoKSx0aGlzLnVwbG9hZD1udWxsKX19KSx0aGlzLmhhbmRsZUV2ZW50UHJvcHMocC5jb25jYXQoW1wicmVhZHlzdGF0ZWNoYW5nZVwiXSkpLHRoaXMudXBsb2FkLmhhbmRsZUV2ZW50UHJvcHMocCl9dmFyIGY9ezEwMDpcIkNvbnRpbnVlXCIsMTAxOlwiU3dpdGNoaW5nIFByb3RvY29sc1wiLDEwMjpcIlByb2Nlc3NpbmdcIiwyMDA6XCJPS1wiLDIwMTpcIkNyZWF0ZWRcIiwyMDI6XCJBY2NlcHRlZFwiLDIwMzpcIk5vbi1BdXRob3JpdGF0aXZlIEluZm9ybWF0aW9uXCIsMjA0OlwiTm8gQ29udGVudFwiLDIwNTpcIlJlc2V0IENvbnRlbnRcIiwyMDY6XCJQYXJ0aWFsIENvbnRlbnRcIiwyMDc6XCJNdWx0aS1TdGF0dXNcIiwyMjY6XCJJTSBVc2VkXCIsMzAwOlwiTXVsdGlwbGUgQ2hvaWNlc1wiLDMwMTpcIk1vdmVkIFBlcm1hbmVudGx5XCIsMzAyOlwiRm91bmRcIiwzMDM6XCJTZWUgT3RoZXJcIiwzMDQ6XCJOb3QgTW9kaWZpZWRcIiwzMDU6XCJVc2UgUHJveHlcIiwzMDY6XCJSZXNlcnZlZFwiLDMwNzpcIlRlbXBvcmFyeSBSZWRpcmVjdFwiLDQwMDpcIkJhZCBSZXF1ZXN0XCIsNDAxOlwiVW5hdXRob3JpemVkXCIsNDAyOlwiUGF5bWVudCBSZXF1aXJlZFwiLDQwMzpcIkZvcmJpZGRlblwiLDQwNDpcIk5vdCBGb3VuZFwiLDQwNTpcIk1ldGhvZCBOb3QgQWxsb3dlZFwiLDQwNjpcIk5vdCBBY2NlcHRhYmxlXCIsNDA3OlwiUHJveHkgQXV0aGVudGljYXRpb24gUmVxdWlyZWRcIiw0MDg6XCJSZXF1ZXN0IFRpbWVvdXRcIiw0MDk6XCJDb25mbGljdFwiLDQxMDpcIkdvbmVcIiw0MTE6XCJMZW5ndGggUmVxdWlyZWRcIiw0MTI6XCJQcmVjb25kaXRpb24gRmFpbGVkXCIsNDEzOlwiUmVxdWVzdCBFbnRpdHkgVG9vIExhcmdlXCIsNDE0OlwiUmVxdWVzdC1VUkkgVG9vIExvbmdcIiw0MTU6XCJVbnN1cHBvcnRlZCBNZWRpYSBUeXBlXCIsNDE2OlwiUmVxdWVzdGVkIFJhbmdlIE5vdCBTYXRpc2ZpYWJsZVwiLDQxNzpcIkV4cGVjdGF0aW9uIEZhaWxlZFwiLDQyMjpcIlVucHJvY2Vzc2FibGUgRW50aXR5XCIsNDIzOlwiTG9ja2VkXCIsNDI0OlwiRmFpbGVkIERlcGVuZGVuY3lcIiw0MjY6XCJVcGdyYWRlIFJlcXVpcmVkXCIsNTAwOlwiSW50ZXJuYWwgU2VydmVyIEVycm9yXCIsNTAxOlwiTm90IEltcGxlbWVudGVkXCIsNTAyOlwiQmFkIEdhdGV3YXlcIiw1MDM6XCJTZXJ2aWNlIFVuYXZhaWxhYmxlXCIsNTA0OlwiR2F0ZXdheSBUaW1lb3V0XCIsNTA1OlwiSFRUUCBWZXJzaW9uIE5vdCBTdXBwb3J0ZWRcIiw1MDY6XCJWYXJpYW50IEFsc28gTmVnb3RpYXRlc1wiLDUwNzpcIkluc3VmZmljaWVudCBTdG9yYWdlXCIsNTEwOlwiTm90IEV4dGVuZGVkXCJ9O20ucHJvdG90eXBlPWkuaW5zdGFuY2U7dmFyIHA9W1wibG9hZHN0YXJ0XCIsXCJwcm9ncmVzc1wiLFwiYWJvcnRcIixcImVycm9yXCIsXCJsb2FkXCIsXCJ0aW1lb3V0XCIsXCJsb2FkZW5kXCJdO3JldHVybiBoLlVOU0VOVD0wLGguT1BFTkVEPTEsaC5IRUFERVJTX1JFQ0VJVkVEPTIsaC5MT0FESU5HPTMsaC5ET05FPTQsaC5wcm90b3R5cGU9aS5pbnN0YW5jZSxofSksbihcIm1veGllL3J1bnRpbWUvVHJhbnNwb3J0ZXJcIixbXCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCIsXCJtb3hpZS9jb3JlL3V0aWxzL0VuY29kZVwiLFwibW94aWUvcnVudGltZS9SdW50aW1lQ2xpZW50XCIsXCJtb3hpZS9jb3JlL0V2ZW50VGFyZ2V0XCJdLGZ1bmN0aW9uKGUsdCxpLG4pe2Z1bmN0aW9uIHIoKXtmdW5jdGlvbiBuKCl7bD1kPTAsYz10aGlzLnJlc3VsdD1udWxsfWZ1bmN0aW9uIG8odCxpKXt2YXIgbj10aGlzO3U9aSxuLmJpbmQoXCJUcmFuc3BvcnRpbmdQcm9ncmVzc1wiLGZ1bmN0aW9uKHQpe2Q9dC5sb2FkZWQsbD5kJiYtMT09PWUuaW5BcnJheShuLnN0YXRlLFtyLklETEUsci5ET05FXSkmJmEuY2FsbChuKX0sOTk5KSxuLmJpbmQoXCJUcmFuc3BvcnRpbmdDb21wbGV0ZVwiLGZ1bmN0aW9uKCl7ZD1sLG4uc3RhdGU9ci5ET05FLGM9bnVsbCxuLnJlc3VsdD11LmV4ZWMuY2FsbChuLFwiVHJhbnNwb3J0ZXJcIixcImdldEFzQmxvYlwiLHR8fFwiXCIpfSw5OTkpLG4uc3RhdGU9ci5CVVNZLG4udHJpZ2dlcihcIlRyYW5zcG9ydGluZ1N0YXJ0ZWRcIiksYS5jYWxsKG4pfWZ1bmN0aW9uIGEoKXt2YXIgZSxpPXRoaXMsbj1sLWQ7bT5uJiYobT1uKSxlPXQuYnRvYShjLnN1YnN0cihkLG0pKSx1LmV4ZWMuY2FsbChpLFwiVHJhbnNwb3J0ZXJcIixcInJlY2VpdmVcIixlLGwpfXZhciBzLHUsYyxsLGQsbTtpLmNhbGwodGhpcyksZS5leHRlbmQodGhpcyx7dWlkOmUuZ3VpZChcInVpZF9cIiksc3RhdGU6ci5JRExFLHJlc3VsdDpudWxsLHRyYW5zcG9ydDpmdW5jdGlvbih0LGkscil7dmFyIGE9dGhpcztpZihyPWUuZXh0ZW5kKHtjaHVua19zaXplOjIwNDc5OH0sciksKHM9ci5jaHVua19zaXplJTMpJiYoci5jaHVua19zaXplKz0zLXMpLG09ci5jaHVua19zaXplLG4uY2FsbCh0aGlzKSxjPXQsbD10Lmxlbmd0aCxcInN0cmluZ1wiPT09ZS50eXBlT2Yocil8fHIucnVpZClvLmNhbGwoYSxpLHRoaXMuY29ubmVjdFJ1bnRpbWUocikpO2Vsc2V7dmFyIHU9ZnVuY3Rpb24oZSx0KXthLnVuYmluZChcIlJ1bnRpbWVJbml0XCIsdSksby5jYWxsKGEsaSx0KX07dGhpcy5iaW5kKFwiUnVudGltZUluaXRcIix1KSx0aGlzLmNvbm5lY3RSdW50aW1lKHIpfX0sYWJvcnQ6ZnVuY3Rpb24oKXt2YXIgZT10aGlzO2Uuc3RhdGU9ci5JRExFLHUmJih1LmV4ZWMuY2FsbChlLFwiVHJhbnNwb3J0ZXJcIixcImNsZWFyXCIpLGUudHJpZ2dlcihcIlRyYW5zcG9ydGluZ0Fib3J0ZWRcIikpLG4uY2FsbChlKX0sZGVzdHJveTpmdW5jdGlvbigpe3RoaXMudW5iaW5kQWxsKCksdT1udWxsLHRoaXMuZGlzY29ubmVjdFJ1bnRpbWUoKSxuLmNhbGwodGhpcyl9fSl9cmV0dXJuIHIuSURMRT0wLHIuQlVTWT0xLHIuRE9ORT0yLHIucHJvdG90eXBlPW4uaW5zdGFuY2Uscn0pLG4oXCJtb3hpZS9pbWFnZS9JbWFnZVwiLFtcIm1veGllL2NvcmUvdXRpbHMvQmFzaWNcIixcIm1veGllL2NvcmUvdXRpbHMvRG9tXCIsXCJtb3hpZS9jb3JlL0V4Y2VwdGlvbnNcIixcIm1veGllL2ZpbGUvRmlsZVJlYWRlclN5bmNcIixcIm1veGllL3hoci9YTUxIdHRwUmVxdWVzdFwiLFwibW94aWUvcnVudGltZS9SdW50aW1lXCIsXCJtb3hpZS9ydW50aW1lL1J1bnRpbWVDbGllbnRcIixcIm1veGllL3J1bnRpbWUvVHJhbnNwb3J0ZXJcIixcIm1veGllL2NvcmUvdXRpbHMvRW52XCIsXCJtb3hpZS9jb3JlL0V2ZW50VGFyZ2V0XCIsXCJtb3hpZS9maWxlL0Jsb2JcIixcIm1veGllL2ZpbGUvRmlsZVwiLFwibW94aWUvY29yZS91dGlscy9FbmNvZGVcIl0sZnVuY3Rpb24oZSx0LGksbixyLG8sYSxzLHUsYyxsLGQsbSl7ZnVuY3Rpb24gaCgpe2Z1bmN0aW9uIG4oZSl7dHJ5e3JldHVybiBlfHwoZT10aGlzLmV4ZWMoXCJJbWFnZVwiLFwiZ2V0SW5mb1wiKSksdGhpcy5zaXplPWUuc2l6ZSx0aGlzLndpZHRoPWUud2lkdGgsdGhpcy5oZWlnaHQ9ZS5oZWlnaHQsdGhpcy50eXBlPWUudHlwZSx0aGlzLm1ldGE9ZS5tZXRhLFwiXCI9PT10aGlzLm5hbWUmJih0aGlzLm5hbWU9ZS5uYW1lKSwhMH1jYXRjaCh0KXtyZXR1cm4gdGhpcy50cmlnZ2VyKFwiZXJyb3JcIix0LmNvZGUpLCExfX1mdW5jdGlvbiBjKHQpe3ZhciBuPWUudHlwZU9mKHQpO3RyeXtpZih0IGluc3RhbmNlb2YgaCl7aWYoIXQuc2l6ZSl0aHJvdyBuZXcgaS5ET01FeGNlcHRpb24oaS5ET01FeGNlcHRpb24uSU5WQUxJRF9TVEFURV9FUlIpO3AuYXBwbHkodGhpcyxhcmd1bWVudHMpfWVsc2UgaWYodCBpbnN0YW5jZW9mIGwpe2lmKCF+ZS5pbkFycmF5KHQudHlwZSxbXCJpbWFnZS9qcGVnXCIsXCJpbWFnZS9wbmdcIl0pKXRocm93IG5ldyBpLkltYWdlRXJyb3IoaS5JbWFnZUVycm9yLldST05HX0ZPUk1BVCk7Zy5hcHBseSh0aGlzLGFyZ3VtZW50cyl9ZWxzZSBpZigtMSE9PWUuaW5BcnJheShuLFtcImJsb2JcIixcImZpbGVcIl0pKWMuY2FsbCh0aGlzLG5ldyBkKG51bGwsdCksYXJndW1lbnRzWzFdKTtlbHNlIGlmKFwic3RyaW5nXCI9PT1uKVwiZGF0YTpcIj09PXQuc3Vic3RyKDAsNSk/Yy5jYWxsKHRoaXMsbmV3IGwobnVsbCx7ZGF0YTp0fSksYXJndW1lbnRzWzFdKTp4LmFwcGx5KHRoaXMsYXJndW1lbnRzKTtlbHNle2lmKFwibm9kZVwiIT09bnx8XCJpbWdcIiE9PXQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSl0aHJvdyBuZXcgaS5ET01FeGNlcHRpb24oaS5ET01FeGNlcHRpb24uVFlQRV9NSVNNQVRDSF9FUlIpO2MuY2FsbCh0aGlzLHQuc3JjLGFyZ3VtZW50c1sxXSl9fWNhdGNoKHIpe3RoaXMudHJpZ2dlcihcImVycm9yXCIsci5jb2RlKX19ZnVuY3Rpb24gcCh0LGkpe3ZhciBuPXRoaXMuY29ubmVjdFJ1bnRpbWUodC5ydWlkKTt0aGlzLnJ1aWQ9bi51aWQsbi5leGVjLmNhbGwodGhpcyxcIkltYWdlXCIsXCJsb2FkRnJvbUltYWdlXCIsdCxcInVuZGVmaW5lZFwiPT09ZS50eXBlT2YoaSk/ITA6aSl9ZnVuY3Rpb24gZyh0LGkpe2Z1bmN0aW9uIG4oZSl7ci5ydWlkPWUudWlkLGUuZXhlYy5jYWxsKHIsXCJJbWFnZVwiLFwibG9hZEZyb21CbG9iXCIsdCl9dmFyIHI9dGhpcztyLm5hbWU9dC5uYW1lfHxcIlwiLHQuaXNEZXRhY2hlZCgpPyh0aGlzLmJpbmQoXCJSdW50aW1lSW5pdFwiLGZ1bmN0aW9uKGUsdCl7bih0KX0pLGkmJlwic3RyaW5nXCI9PXR5cGVvZiBpLnJlcXVpcmVkX2NhcHMmJihpLnJlcXVpcmVkX2NhcHM9by5wYXJzZUNhcHMoaS5yZXF1aXJlZF9jYXBzKSksdGhpcy5jb25uZWN0UnVudGltZShlLmV4dGVuZCh7cmVxdWlyZWRfY2Fwczp7YWNjZXNzX2ltYWdlX2JpbmFyeTohMCxyZXNpemVfaW1hZ2U6ITB9fSxpKSkpOm4odGhpcy5jb25uZWN0UnVudGltZSh0LnJ1aWQpKX1mdW5jdGlvbiB4KGUsdCl7dmFyIGksbj10aGlzO2k9bmV3IHIsaS5vcGVuKFwiZ2V0XCIsZSksaS5yZXNwb25zZVR5cGU9XCJibG9iXCIsaS5vbnByb2dyZXNzPWZ1bmN0aW9uKGUpe24udHJpZ2dlcihlKX0saS5vbmxvYWQ9ZnVuY3Rpb24oKXtnLmNhbGwobixpLnJlc3BvbnNlLCEwKX0saS5vbmVycm9yPWZ1bmN0aW9uKGUpe24udHJpZ2dlcihlKX0saS5vbmxvYWRlbmQ9ZnVuY3Rpb24oKXtpLmRlc3Ryb3koKX0saS5iaW5kKFwiUnVudGltZUVycm9yXCIsZnVuY3Rpb24oZSx0KXtuLnRyaWdnZXIoXCJSdW50aW1lRXJyb3JcIix0KX0pLGkuc2VuZChudWxsLHQpfWEuY2FsbCh0aGlzKSxlLmV4dGVuZCh0aGlzLHt1aWQ6ZS5ndWlkKFwidWlkX1wiKSxydWlkOm51bGwsbmFtZTpcIlwiLHNpemU6MCx3aWR0aDowLGhlaWdodDowLHR5cGU6XCJcIixtZXRhOnt9LGNsb25lOmZ1bmN0aW9uKCl7dGhpcy5sb2FkLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sbG9hZDpmdW5jdGlvbigpe2MuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxyZXNpemU6ZnVuY3Rpb24odCl7dmFyIG4scixvPXRoaXMsYT17eDowLHk6MCx3aWR0aDpvLndpZHRoLGhlaWdodDpvLmhlaWdodH0scz1lLmV4dGVuZElmKHt3aWR0aDpvLndpZHRoLGhlaWdodDpvLmhlaWdodCx0eXBlOm8udHlwZXx8XCJpbWFnZS9qcGVnXCIscXVhbGl0eTo5MCxjcm9wOiExLGZpdDohMCxwcmVzZXJ2ZUhlYWRlcnM6ITAscmVzYW1wbGU6XCJkZWZhdWx0XCIsbXVsdGlwYXNzOiEwfSx0KTt0cnl7aWYoIW8uc2l6ZSl0aHJvdyBuZXcgaS5ET01FeGNlcHRpb24oaS5ET01FeGNlcHRpb24uSU5WQUxJRF9TVEFURV9FUlIpO2lmKG8ud2lkdGg+aC5NQVhfUkVTSVpFX1dJRFRIfHxvLmhlaWdodD5oLk1BWF9SRVNJWkVfSEVJR0hUKXRocm93IG5ldyBpLkltYWdlRXJyb3IoaS5JbWFnZUVycm9yLk1BWF9SRVNPTFVUSU9OX0VSUik7aWYobj1vLm1ldGEmJm8ubWV0YS50aWZmJiZvLm1ldGEudGlmZi5PcmllbnRhdGlvbnx8MSwtMSE9PWUuaW5BcnJheShuLFs1LDYsNyw4XSkpe3ZhciB1PXMud2lkdGg7cy53aWR0aD1zLmhlaWdodCxzLmhlaWdodD11fWlmKHMuY3JvcCl7c3dpdGNoKHI9TWF0aC5tYXgocy53aWR0aC9vLndpZHRoLHMuaGVpZ2h0L28uaGVpZ2h0KSx0LmZpdD8oYS53aWR0aD1NYXRoLm1pbihNYXRoLmNlaWwocy53aWR0aC9yKSxvLndpZHRoKSxhLmhlaWdodD1NYXRoLm1pbihNYXRoLmNlaWwocy5oZWlnaHQvciksby5oZWlnaHQpLHI9cy53aWR0aC9hLndpZHRoKTooYS53aWR0aD1NYXRoLm1pbihzLndpZHRoLG8ud2lkdGgpLGEuaGVpZ2h0PU1hdGgubWluKHMuaGVpZ2h0LG8uaGVpZ2h0KSxyPTEpLFwiYm9vbGVhblwiPT10eXBlb2Ygcy5jcm9wJiYocy5jcm9wPVwiY2NcIikscy5jcm9wLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvXy8sXCItXCIpKXtjYXNlXCJyYlwiOmNhc2VcInJpZ2h0LWJvdHRvbVwiOmEueD1vLndpZHRoLWEud2lkdGgsYS55PW8uaGVpZ2h0LWEuaGVpZ2h0O2JyZWFrO2Nhc2VcImNiXCI6Y2FzZVwiY2VudGVyLWJvdHRvbVwiOmEueD1NYXRoLmZsb29yKChvLndpZHRoLWEud2lkdGgpLzIpLGEueT1vLmhlaWdodC1hLmhlaWdodDticmVhaztjYXNlXCJsYlwiOmNhc2VcImxlZnQtYm90dG9tXCI6YS54PTAsYS55PW8uaGVpZ2h0LWEuaGVpZ2h0O2JyZWFrO2Nhc2VcImx0XCI6Y2FzZVwibGVmdC10b3BcIjphLng9MCxhLnk9MDticmVhaztjYXNlXCJjdFwiOmNhc2VcImNlbnRlci10b3BcIjphLng9TWF0aC5mbG9vcigoby53aWR0aC1hLndpZHRoKS8yKSxhLnk9MDticmVhaztjYXNlXCJydFwiOmNhc2VcInJpZ2h0LXRvcFwiOmEueD1vLndpZHRoLWEud2lkdGgsYS55PTA7YnJlYWs7Y2FzZVwicmNcIjpjYXNlXCJyaWdodC1jZW50ZXJcIjpjYXNlXCJyaWdodC1taWRkbGVcIjphLng9by53aWR0aC1hLndpZHRoLGEueT1NYXRoLmZsb29yKChvLmhlaWdodC1hLmhlaWdodCkvMik7YnJlYWs7Y2FzZVwibGNcIjpjYXNlXCJsZWZ0LWNlbnRlclwiOmNhc2VcImxlZnQtbWlkZGxlXCI6YS54PTAsYS55PU1hdGguZmxvb3IoKG8uaGVpZ2h0LWEuaGVpZ2h0KS8yKTticmVhaztjYXNlXCJjY1wiOmNhc2VcImNlbnRlci1jZW50ZXJcIjpjYXNlXCJjZW50ZXItbWlkZGxlXCI6ZGVmYXVsdDphLng9TWF0aC5mbG9vcigoby53aWR0aC1hLndpZHRoKS8yKSxhLnk9TWF0aC5mbG9vcigoby5oZWlnaHQtYS5oZWlnaHQpLzIpfWEueD1NYXRoLm1heChhLngsMCksYS55PU1hdGgubWF4KGEueSwwKX1lbHNlIHI9TWF0aC5taW4ocy53aWR0aC9vLndpZHRoLHMuaGVpZ2h0L28uaGVpZ2h0KSxyPjEmJiFzLmZpdCYmKHI9MSk7dGhpcy5leGVjKFwiSW1hZ2VcIixcInJlc2l6ZVwiLGEscixzKX1jYXRjaChjKXtvLnRyaWdnZXIoXCJlcnJvclwiLGMuY29kZSl9fSxkb3duc2l6ZTpmdW5jdGlvbih0KXt2YXIgaSxuPXt3aWR0aDp0aGlzLndpZHRoLGhlaWdodDp0aGlzLmhlaWdodCx0eXBlOnRoaXMudHlwZXx8XCJpbWFnZS9qcGVnXCIscXVhbGl0eTo5MCxjcm9wOiExLGZpdDohMSxwcmVzZXJ2ZUhlYWRlcnM6ITAscmVzYW1wbGU6XCJkZWZhdWx0XCJ9O2k9XCJvYmplY3RcIj09dHlwZW9mIHQ/ZS5leHRlbmQobix0KTplLmV4dGVuZChuLHt3aWR0aDphcmd1bWVudHNbMF0saGVpZ2h0OmFyZ3VtZW50c1sxXSxjcm9wOmFyZ3VtZW50c1syXSxwcmVzZXJ2ZUhlYWRlcnM6YXJndW1lbnRzWzNdfSksdGhpcy5yZXNpemUoaSl9LGNyb3A6ZnVuY3Rpb24oZSx0LGkpe3RoaXMuZG93bnNpemUoZSx0LCEwLGkpfSxnZXRBc0NhbnZhczpmdW5jdGlvbigpe2lmKCF1LmNhbihcImNyZWF0ZV9jYW52YXNcIikpdGhyb3cgbmV3IGkuUnVudGltZUVycm9yKGkuUnVudGltZUVycm9yLk5PVF9TVVBQT1JURURfRVJSKTtyZXR1cm4gdGhpcy5leGVjKFwiSW1hZ2VcIixcImdldEFzQ2FudmFzXCIpfSxnZXRBc0Jsb2I6ZnVuY3Rpb24oZSx0KXtpZighdGhpcy5zaXplKXRocm93IG5ldyBpLkRPTUV4Y2VwdGlvbihpLkRPTUV4Y2VwdGlvbi5JTlZBTElEX1NUQVRFX0VSUik7cmV0dXJuIHRoaXMuZXhlYyhcIkltYWdlXCIsXCJnZXRBc0Jsb2JcIixlfHxcImltYWdlL2pwZWdcIix0fHw5MCl9LGdldEFzRGF0YVVSTDpmdW5jdGlvbihlLHQpe2lmKCF0aGlzLnNpemUpdGhyb3cgbmV3IGkuRE9NRXhjZXB0aW9uKGkuRE9NRXhjZXB0aW9uLklOVkFMSURfU1RBVEVfRVJSKTtyZXR1cm4gdGhpcy5leGVjKFwiSW1hZ2VcIixcImdldEFzRGF0YVVSTFwiLGV8fFwiaW1hZ2UvanBlZ1wiLHR8fDkwKX0sZ2V0QXNCaW5hcnlTdHJpbmc6ZnVuY3Rpb24oZSx0KXt2YXIgaT10aGlzLmdldEFzRGF0YVVSTChlLHQpO3JldHVybiBtLmF0b2IoaS5zdWJzdHJpbmcoaS5pbmRleE9mKFwiYmFzZTY0LFwiKSs3KSl9LGVtYmVkOmZ1bmN0aW9uKG4scil7ZnVuY3Rpb24gbyh0LHIpe3ZhciBvPXRoaXM7aWYodS5jYW4oXCJjcmVhdGVfY2FudmFzXCIpKXt2YXIgbD1vLmdldEFzQ2FudmFzKCk7aWYobClyZXR1cm4gbi5hcHBlbmRDaGlsZChsKSxsPW51bGwsby5kZXN0cm95KCksYy50cmlnZ2VyKFwiZW1iZWRkZWRcIiksdm9pZCAwfXZhciBkPW8uZ2V0QXNEYXRhVVJMKHQscik7aWYoIWQpdGhyb3cgbmV3IGkuSW1hZ2VFcnJvcihpLkltYWdlRXJyb3IuV1JPTkdfRk9STUFUKTtpZih1LmNhbihcInVzZV9kYXRhX3VyaV9vZlwiLGQubGVuZ3RoKSluLmlubmVySFRNTD0nPGltZyBzcmM9XCInK2QrJ1wiIHdpZHRoPVwiJytvLndpZHRoKydcIiBoZWlnaHQ9XCInK28uaGVpZ2h0KydcIiBhbHQ9XCJcIiAvPicsby5kZXN0cm95KCksYy50cmlnZ2VyKFwiZW1iZWRkZWRcIik7ZWxzZXt2YXIgaD1uZXcgcztoLmJpbmQoXCJUcmFuc3BvcnRpbmdDb21wbGV0ZVwiLGZ1bmN0aW9uKCl7YT1jLmNvbm5lY3RSdW50aW1lKHRoaXMucmVzdWx0LnJ1aWQpLGMuYmluZChcIkVtYmVkZGVkXCIsZnVuY3Rpb24oKXtlLmV4dGVuZChhLmdldFNoaW1Db250YWluZXIoKS5zdHlsZSx7dG9wOlwiMHB4XCIsbGVmdDpcIjBweFwiLHdpZHRoOm8ud2lkdGgrXCJweFwiLGhlaWdodDpvLmhlaWdodCtcInB4XCJ9KSxhPW51bGx9LDk5OSksYS5leGVjLmNhbGwoYyxcIkltYWdlVmlld1wiLFwiZGlzcGxheVwiLHRoaXMucmVzdWx0LnVpZCx3aWR0aCxoZWlnaHQpLG8uZGVzdHJveSgpfSksaC50cmFuc3BvcnQobS5hdG9iKGQuc3Vic3RyaW5nKGQuaW5kZXhPZihcImJhc2U2NCxcIikrNykpLHQse3JlcXVpcmVkX2NhcHM6e2Rpc3BsYXlfbWVkaWE6ITB9LHJ1bnRpbWVfb3JkZXI6XCJmbGFzaCxzaWx2ZXJsaWdodFwiLGNvbnRhaW5lcjpufSl9fXZhciBhLGM9dGhpcyxsPWUuZXh0ZW5kKHt3aWR0aDp0aGlzLndpZHRoLGhlaWdodDp0aGlzLmhlaWdodCx0eXBlOnRoaXMudHlwZXx8XCJpbWFnZS9qcGVnXCIscXVhbGl0eTo5MCxmaXQ6ITAscmVzYW1wbGU6XCJuZWFyZXN0XCJ9LHIpO3RyeXtpZighKG49dC5nZXQobikpKXRocm93IG5ldyBpLkRPTUV4Y2VwdGlvbihpLkRPTUV4Y2VwdGlvbi5JTlZBTElEX05PREVfVFlQRV9FUlIpO2lmKCF0aGlzLnNpemUpdGhyb3cgbmV3IGkuRE9NRXhjZXB0aW9uKGkuRE9NRXhjZXB0aW9uLklOVkFMSURfU1RBVEVfRVJSKTt0aGlzLndpZHRoPmguTUFYX1JFU0laRV9XSURUSHx8dGhpcy5oZWlnaHQ+aC5NQVhfUkVTSVpFX0hFSUdIVDt2YXIgZD1uZXcgaDtyZXR1cm4gZC5iaW5kKFwiUmVzaXplXCIsZnVuY3Rpb24oKXtvLmNhbGwodGhpcyxsLnR5cGUsbC5xdWFsaXR5KX0pLGQuYmluZChcIkxvYWRcIixmdW5jdGlvbigpe3RoaXMuZG93bnNpemUobCl9KSx0aGlzLm1ldGEudGh1bWImJnRoaXMubWV0YS50aHVtYi53aWR0aD49bC53aWR0aCYmdGhpcy5tZXRhLnRodW1iLmhlaWdodD49bC5oZWlnaHQ/ZC5sb2FkKHRoaXMubWV0YS50aHVtYi5kYXRhKTpkLmNsb25lKHRoaXMsITEpLGR9Y2F0Y2goZil7dGhpcy50cmlnZ2VyKFwiZXJyb3JcIixmLmNvZGUpfX0sZGVzdHJveTpmdW5jdGlvbigpe3RoaXMucnVpZCYmKHRoaXMuZ2V0UnVudGltZSgpLmV4ZWMuY2FsbCh0aGlzLFwiSW1hZ2VcIixcImRlc3Ryb3lcIiksdGhpcy5kaXNjb25uZWN0UnVudGltZSgpKSx0aGlzLm1ldGEmJnRoaXMubWV0YS50aHVtYiYmdGhpcy5tZXRhLnRodW1iLmRhdGEuZGVzdHJveSgpLHRoaXMudW5iaW5kQWxsKCl9fSksdGhpcy5oYW5kbGVFdmVudFByb3BzKGYpLHRoaXMuYmluZChcIkxvYWQgUmVzaXplXCIsZnVuY3Rpb24oKXtyZXR1cm4gbi5jYWxsKHRoaXMpfSw5OTkpfXZhciBmPVtcInByb2dyZXNzXCIsXCJsb2FkXCIsXCJlcnJvclwiLFwicmVzaXplXCIsXCJlbWJlZGRlZFwiXTtyZXR1cm4gaC5NQVhfUkVTSVpFX1dJRFRIPTgxOTIsaC5NQVhfUkVTSVpFX0hFSUdIVD04MTkyLGgucHJvdG90eXBlPWMuaW5zdGFuY2UsaH0pLG4oXCJtb3hpZS9ydW50aW1lL2h0bWw1L1J1bnRpbWVcIixbXCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCIsXCJtb3hpZS9jb3JlL0V4Y2VwdGlvbnNcIixcIm1veGllL3J1bnRpbWUvUnVudGltZVwiLFwibW94aWUvY29yZS91dGlscy9FbnZcIl0sZnVuY3Rpb24oZSx0LGksbil7ZnVuY3Rpb24gbyh0KXt2YXIgbz10aGlzLHU9aS5jYXBUZXN0LGM9aS5jYXBUcnVlLGw9ZS5leHRlbmQoe2FjY2Vzc19iaW5hcnk6dSh3aW5kb3cuRmlsZVJlYWRlcnx8d2luZG93LkZpbGUmJndpbmRvdy5GaWxlLmdldEFzRGF0YVVSTCksYWNjZXNzX2ltYWdlX2JpbmFyeTpmdW5jdGlvbigpe3JldHVybiBvLmNhbihcImFjY2Vzc19iaW5hcnlcIikmJiEhcy5JbWFnZX0sZGlzcGxheV9tZWRpYTp1KChuLmNhbihcImNyZWF0ZV9jYW52YXNcIil8fG4uY2FuKFwidXNlX2RhdGFfdXJpX292ZXIzMmtiXCIpKSYmcihcIm1veGllL2ltYWdlL0ltYWdlXCIpKSxkb19jb3JzOnUod2luZG93LlhNTEh0dHBSZXF1ZXN0JiZcIndpdGhDcmVkZW50aWFsc1wiaW4gbmV3IFhNTEh0dHBSZXF1ZXN0KSxkcmFnX2FuZF9kcm9wOnUoZnVuY3Rpb24oKXt2YXIgZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO3JldHVybihcImRyYWdnYWJsZVwiaW4gZXx8XCJvbmRyYWdzdGFydFwiaW4gZSYmXCJvbmRyb3BcImluIGUpJiYoXCJJRVwiIT09bi5icm93c2VyfHxuLnZlckNvbXAobi52ZXJzaW9uLDksXCI+XCIpKX0oKSksZmlsdGVyX2J5X2V4dGVuc2lvbjp1KGZ1bmN0aW9uKCl7cmV0dXJuIShcIkNocm9tZVwiPT09bi5icm93c2VyJiZuLnZlckNvbXAobi52ZXJzaW9uLDI4LFwiPFwiKXx8XCJJRVwiPT09bi5icm93c2VyJiZuLnZlckNvbXAobi52ZXJzaW9uLDEwLFwiPFwiKXx8XCJTYWZhcmlcIj09PW4uYnJvd3NlciYmbi52ZXJDb21wKG4udmVyc2lvbiw3LFwiPFwiKXx8XCJGaXJlZm94XCI9PT1uLmJyb3dzZXImJm4udmVyQ29tcChuLnZlcnNpb24sMzcsXCI8XCIpKX0oKSkscmV0dXJuX3Jlc3BvbnNlX2hlYWRlcnM6YyxyZXR1cm5fcmVzcG9uc2VfdHlwZTpmdW5jdGlvbihlKXtyZXR1cm5cImpzb25cIj09PWUmJndpbmRvdy5KU09OPyEwOm4uY2FuKFwicmV0dXJuX3Jlc3BvbnNlX3R5cGVcIixlKX0scmV0dXJuX3N0YXR1c19jb2RlOmMscmVwb3J0X3VwbG9hZF9wcm9ncmVzczp1KHdpbmRvdy5YTUxIdHRwUmVxdWVzdCYmKG5ldyBYTUxIdHRwUmVxdWVzdCkudXBsb2FkKSxyZXNpemVfaW1hZ2U6ZnVuY3Rpb24oKXtyZXR1cm4gby5jYW4oXCJhY2Nlc3NfYmluYXJ5XCIpJiZuLmNhbihcImNyZWF0ZV9jYW52YXNcIil9LHNlbGVjdF9maWxlOmZ1bmN0aW9uKCl7cmV0dXJuIG4uY2FuKFwidXNlX2ZpbGVpbnB1dFwiKSYmd2luZG93LkZpbGV9LHNlbGVjdF9mb2xkZXI6ZnVuY3Rpb24oKXtyZXR1cm4gby5jYW4oXCJzZWxlY3RfZmlsZVwiKSYmKFwiQ2hyb21lXCI9PT1uLmJyb3dzZXImJm4udmVyQ29tcChuLnZlcnNpb24sMjEsXCI+PVwiKXx8XCJGaXJlZm94XCI9PT1uLmJyb3dzZXImJm4udmVyQ29tcChuLnZlcnNpb24sNDIsXCI+PVwiKSl9LHNlbGVjdF9tdWx0aXBsZTpmdW5jdGlvbigpe3JldHVybiEoIW8uY2FuKFwic2VsZWN0X2ZpbGVcIil8fFwiU2FmYXJpXCI9PT1uLmJyb3dzZXImJlwiV2luZG93c1wiPT09bi5vc3x8XCJpT1NcIj09PW4ub3MmJm4udmVyQ29tcChuLm9zVmVyc2lvbixcIjcuMC4wXCIsXCI+XCIpJiZuLnZlckNvbXAobi5vc1ZlcnNpb24sXCI4LjAuMFwiLFwiPFwiKSl9LHNlbmRfYmluYXJ5X3N0cmluZzp1KHdpbmRvdy5YTUxIdHRwUmVxdWVzdCYmKChuZXcgWE1MSHR0cFJlcXVlc3QpLnNlbmRBc0JpbmFyeXx8d2luZG93LlVpbnQ4QXJyYXkmJndpbmRvdy5BcnJheUJ1ZmZlcikpLHNlbmRfY3VzdG9tX2hlYWRlcnM6dSh3aW5kb3cuWE1MSHR0cFJlcXVlc3QpLHNlbmRfbXVsdGlwYXJ0OmZ1bmN0aW9uKCl7cmV0dXJuISEod2luZG93LlhNTEh0dHBSZXF1ZXN0JiYobmV3IFhNTEh0dHBSZXF1ZXN0KS51cGxvYWQmJndpbmRvdy5Gb3JtRGF0YSl8fG8uY2FuKFwic2VuZF9iaW5hcnlfc3RyaW5nXCIpfSxzbGljZV9ibG9iOnUod2luZG93LkZpbGUmJihGaWxlLnByb3RvdHlwZS5tb3pTbGljZXx8RmlsZS5wcm90b3R5cGUud2Via2l0U2xpY2V8fEZpbGUucHJvdG90eXBlLnNsaWNlKSksc3RyZWFtX3VwbG9hZDpmdW5jdGlvbigpe3JldHVybiBvLmNhbihcInNsaWNlX2Jsb2JcIikmJm8uY2FuKFwic2VuZF9tdWx0aXBhcnRcIil9LHN1bW1vbl9maWxlX2RpYWxvZzpmdW5jdGlvbigpe3JldHVybiBvLmNhbihcInNlbGVjdF9maWxlXCIpJiYhKFwiRmlyZWZveFwiPT09bi5icm93c2VyJiZuLnZlckNvbXAobi52ZXJzaW9uLDQsXCI8XCIpfHxcIk9wZXJhXCI9PT1uLmJyb3dzZXImJm4udmVyQ29tcChuLnZlcnNpb24sMTIsXCI8XCIpfHxcIklFXCI9PT1uLmJyb3dzZXImJm4udmVyQ29tcChuLnZlcnNpb24sMTAsXCI8XCIpKX0sdXBsb2FkX2ZpbGVzaXplOmMsdXNlX2h0dHBfbWV0aG9kOmN9LGFyZ3VtZW50c1syXSk7aS5jYWxsKHRoaXMsdCxhcmd1bWVudHNbMV18fGEsbCksZS5leHRlbmQodGhpcyx7aW5pdDpmdW5jdGlvbigpe3RoaXMudHJpZ2dlcihcIkluaXRcIil9LGRlc3Ryb3k6ZnVuY3Rpb24oZSl7cmV0dXJuIGZ1bmN0aW9uKCl7ZS5jYWxsKG8pLGU9bz1udWxsfX0odGhpcy5kZXN0cm95KX0pLGUuZXh0ZW5kKHRoaXMuZ2V0U2hpbSgpLHMpfXZhciBhPVwiaHRtbDVcIixzPXt9O3JldHVybiBpLmFkZENvbnN0cnVjdG9yKGEsbyksc30pLG4oXCJtb3hpZS9ydW50aW1lL2h0bWw1L2ZpbGUvQmxvYlwiLFtcIm1veGllL3J1bnRpbWUvaHRtbDUvUnVudGltZVwiLFwibW94aWUvZmlsZS9CbG9iXCJdLGZ1bmN0aW9uKGUsdCl7ZnVuY3Rpb24gaSgpe2Z1bmN0aW9uIGUoZSx0LGkpe3ZhciBuO2lmKCF3aW5kb3cuRmlsZS5wcm90b3R5cGUuc2xpY2UpcmV0dXJuKG49d2luZG93LkZpbGUucHJvdG90eXBlLndlYmtpdFNsaWNlfHx3aW5kb3cuRmlsZS5wcm90b3R5cGUubW96U2xpY2UpP24uY2FsbChlLHQsaSk6bnVsbDt0cnl7cmV0dXJuIGUuc2xpY2UoKSxlLnNsaWNlKHQsaSl9Y2F0Y2gocil7cmV0dXJuIGUuc2xpY2UodCxpLXQpfX10aGlzLnNsaWNlPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyB0KHRoaXMuZ2V0UnVudGltZSgpLnVpZCxlLmFwcGx5KHRoaXMsYXJndW1lbnRzKSl9LHRoaXMuZGVzdHJveT1mdW5jdGlvbigpe3RoaXMuZ2V0UnVudGltZSgpLmdldFNoaW0oKS5yZW1vdmVJbnN0YW5jZSh0aGlzLnVpZCl9fXJldHVybiBlLkJsb2I9aX0pLG4oXCJtb3hpZS9jb3JlL3V0aWxzL0V2ZW50c1wiLFtcIm1veGllL2NvcmUvdXRpbHMvQmFzaWNcIl0sZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdCgpe3RoaXMucmV0dXJuVmFsdWU9ITF9ZnVuY3Rpb24gaSgpe3RoaXMuY2FuY2VsQnViYmxlPSEwfXZhciBuPXt9LHI9XCJtb3hpZV9cIitlLmd1aWQoKSxvPWZ1bmN0aW9uKG8sYSxzLHUpe3ZhciBjLGw7YT1hLnRvTG93ZXJDYXNlKCksby5hZGRFdmVudExpc3RlbmVyPyhjPXMsby5hZGRFdmVudExpc3RlbmVyKGEsYywhMSkpOm8uYXR0YWNoRXZlbnQmJihjPWZ1bmN0aW9uKCl7dmFyIGU9d2luZG93LmV2ZW50O2UudGFyZ2V0fHwoZS50YXJnZXQ9ZS5zcmNFbGVtZW50KSxlLnByZXZlbnREZWZhdWx0PXQsZS5zdG9wUHJvcGFnYXRpb249aSxzKGUpfSxvLmF0dGFjaEV2ZW50KFwib25cIithLGMpKSxvW3JdfHwob1tyXT1lLmd1aWQoKSksbi5oYXNPd25Qcm9wZXJ0eShvW3JdKXx8KG5bb1tyXV09e30pLGw9bltvW3JdXSxsLmhhc093blByb3BlcnR5KGEpfHwobFthXT1bXSksbFthXS5wdXNoKHtmdW5jOmMsb3JpZzpzLGtleTp1fSl9LGE9ZnVuY3Rpb24odCxpLG8pe3ZhciBhLHM7aWYoaT1pLnRvTG93ZXJDYXNlKCksdFtyXSYmblt0W3JdXSYmblt0W3JdXVtpXSl7YT1uW3Rbcl1dW2ldO2Zvcih2YXIgdT1hLmxlbmd0aC0xO3U+PTAmJihhW3VdLm9yaWchPT1vJiZhW3VdLmtleSE9PW98fCh0LnJlbW92ZUV2ZW50TGlzdGVuZXI/dC5yZW1vdmVFdmVudExpc3RlbmVyKGksYVt1XS5mdW5jLCExKTp0LmRldGFjaEV2ZW50JiZ0LmRldGFjaEV2ZW50KFwib25cIitpLGFbdV0uZnVuYyksYVt1XS5vcmlnPW51bGwsYVt1XS5mdW5jPW51bGwsYS5zcGxpY2UodSwxKSxvPT09cykpO3UtLSk7aWYoYS5sZW5ndGh8fGRlbGV0ZSBuW3Rbcl1dW2ldLGUuaXNFbXB0eU9iaihuW3Rbcl1dKSl7ZGVsZXRlIG5bdFtyXV07dHJ5e2RlbGV0ZSB0W3JdfWNhdGNoKGMpe3Rbcl09c319fX0scz1mdW5jdGlvbih0LGkpe3QmJnRbcl0mJmUuZWFjaChuW3Rbcl1dLGZ1bmN0aW9uKGUsbil7YSh0LG4saSl9KX07cmV0dXJue2FkZEV2ZW50Om8scmVtb3ZlRXZlbnQ6YSxyZW1vdmVBbGxFdmVudHM6c319KSxuKFwibW94aWUvcnVudGltZS9odG1sNS9maWxlL0ZpbGVJbnB1dFwiLFtcIm1veGllL3J1bnRpbWUvaHRtbDUvUnVudGltZVwiLFwibW94aWUvZmlsZS9GaWxlXCIsXCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCIsXCJtb3hpZS9jb3JlL3V0aWxzL0RvbVwiLFwibW94aWUvY29yZS91dGlscy9FdmVudHNcIixcIm1veGllL2NvcmUvdXRpbHMvTWltZVwiLFwibW94aWUvY29yZS91dGlscy9FbnZcIl0sZnVuY3Rpb24oZSx0LGksbixyLG8sYSl7ZnVuY3Rpb24gcygpe3ZhciBlLHM7aS5leHRlbmQodGhpcyx7aW5pdDpmdW5jdGlvbih1KXt2YXIgYyxsLGQsbSxoLGYscD10aGlzLGc9cC5nZXRSdW50aW1lKCk7ZT11LGQ9by5leHRMaXN0Mm1pbWVzKGUuYWNjZXB0LGcuY2FuKFwiZmlsdGVyX2J5X2V4dGVuc2lvblwiKSksbD1nLmdldFNoaW1Db250YWluZXIoKSxsLmlubmVySFRNTD0nPGlucHV0IGlkPVwiJytnLnVpZCsnXCIgdHlwZT1cImZpbGVcIiBzdHlsZT1cImZvbnQtc2l6ZTo5OTlweDtvcGFjaXR5OjA7XCInKyhlLm11bHRpcGxlJiZnLmNhbihcInNlbGVjdF9tdWx0aXBsZVwiKT9cIm11bHRpcGxlXCI6XCJcIikrKGUuZGlyZWN0b3J5JiZnLmNhbihcInNlbGVjdF9mb2xkZXJcIik/XCJ3ZWJraXRkaXJlY3RvcnkgZGlyZWN0b3J5XCI6XCJcIikrKGQ/JyBhY2NlcHQ9XCInK2Quam9pbihcIixcIikrJ1wiJzpcIlwiKStcIiAvPlwiLGM9bi5nZXQoZy51aWQpLGkuZXh0ZW5kKGMuc3R5bGUse3Bvc2l0aW9uOlwiYWJzb2x1dGVcIix0b3A6MCxsZWZ0OjAsd2lkdGg6XCIxMDAlXCIsaGVpZ2h0OlwiMTAwJVwifSksbT1uLmdldChlLmJyb3dzZV9idXR0b24pLHM9bi5nZXRTdHlsZShtLFwiei1pbmRleFwiKXx8XCJhdXRvXCIsZy5jYW4oXCJzdW1tb25fZmlsZV9kaWFsb2dcIikmJihcInN0YXRpY1wiPT09bi5nZXRTdHlsZShtLFwicG9zaXRpb25cIikmJihtLnN0eWxlLnBvc2l0aW9uPVwicmVsYXRpdmVcIiksci5hZGRFdmVudChtLFwiY2xpY2tcIixmdW5jdGlvbihlKXt2YXIgdD1uLmdldChnLnVpZCk7dCYmIXQuZGlzYWJsZWQmJnQuY2xpY2soKSxlLnByZXZlbnREZWZhdWx0KCl9LHAudWlkKSxwLmJpbmQoXCJSZWZyZXNoXCIsZnVuY3Rpb24oKXtoPXBhcnNlSW50KHMsMTApfHwxLG4uZ2V0KGUuYnJvd3NlX2J1dHRvbikuc3R5bGUuekluZGV4PWgsdGhpcy5nZXRSdW50aW1lKCkuZ2V0U2hpbUNvbnRhaW5lcigpLnN0eWxlLnpJbmRleD1oLTF9KSksZj1nLmNhbihcInN1bW1vbl9maWxlX2RpYWxvZ1wiKT9tOmwsci5hZGRFdmVudChmLFwibW91c2VvdmVyXCIsZnVuY3Rpb24oKXtwLnRyaWdnZXIoXCJtb3VzZWVudGVyXCIpfSxwLnVpZCksci5hZGRFdmVudChmLFwibW91c2VvdXRcIixmdW5jdGlvbigpe3AudHJpZ2dlcihcIm1vdXNlbGVhdmVcIil9LHAudWlkKSxyLmFkZEV2ZW50KGYsXCJtb3VzZWRvd25cIixmdW5jdGlvbigpe3AudHJpZ2dlcihcIm1vdXNlZG93blwiKX0scC51aWQpLHIuYWRkRXZlbnQobi5nZXQoZS5jb250YWluZXIpLFwibW91c2V1cFwiLGZ1bmN0aW9uKCl7cC50cmlnZ2VyKFwibW91c2V1cFwiKX0scC51aWQpLChnLmNhbihcInN1bW1vbl9maWxlX2RpYWxvZ1wiKT9jOm0pLnNldEF0dHJpYnV0ZShcInRhYmluZGV4XCIsLTEpLGMub25jaGFuZ2U9ZnVuY3Rpb24geCgpe2lmKHAuZmlsZXM9W10saS5lYWNoKHRoaXMuZmlsZXMsZnVuY3Rpb24oaSl7dmFyIG49XCJcIjtyZXR1cm4gZS5kaXJlY3RvcnkmJlwiLlwiPT1pLm5hbWU/ITA6KGkud2Via2l0UmVsYXRpdmVQYXRoJiYobj1cIi9cIitpLndlYmtpdFJlbGF0aXZlUGF0aC5yZXBsYWNlKC9eXFwvLyxcIlwiKSksaT1uZXcgdChnLnVpZCxpKSxpLnJlbGF0aXZlUGF0aD1uLHAuZmlsZXMucHVzaChpKSx2b2lkIDApfSksXCJJRVwiIT09YS5icm93c2VyJiZcIklFTW9iaWxlXCIhPT1hLmJyb3dzZXIpdGhpcy52YWx1ZT1cIlwiO2Vsc2V7dmFyIG49dGhpcy5jbG9uZU5vZGUoITApO3RoaXMucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQobix0aGlzKSxuLm9uY2hhbmdlPXh9cC5maWxlcy5sZW5ndGgmJnAudHJpZ2dlcihcImNoYW5nZVwiKX0scC50cmlnZ2VyKHt0eXBlOlwicmVhZHlcIixhc3luYzohMH0pLGw9bnVsbH0sc2V0T3B0aW9uOmZ1bmN0aW9uKGUsdCl7dmFyIGk9dGhpcy5nZXRSdW50aW1lKCkscj1uLmdldChpLnVpZCk7c3dpdGNoKGUpe2Nhc2VcImFjY2VwdFwiOmlmKHQpe3ZhciBhPXQubWltZXN8fG8uZXh0TGlzdDJtaW1lcyh0LGkuY2FuKFwiZmlsdGVyX2J5X2V4dGVuc2lvblwiKSk7ci5zZXRBdHRyaWJ1dGUoXCJhY2NlcHRcIixhLmpvaW4oXCIsXCIpKX1lbHNlIHIucmVtb3ZlQXR0cmlidXRlKFwiYWNjZXB0XCIpO2JyZWFrO2Nhc2VcImRpcmVjdG9yeVwiOnQmJmkuY2FuKFwic2VsZWN0X2ZvbGRlclwiKT8oci5zZXRBdHRyaWJ1dGUoXCJkaXJlY3RvcnlcIixcIlwiKSxyLnNldEF0dHJpYnV0ZShcIndlYmtpdGRpcmVjdG9yeVwiLFwiXCIpKTooci5yZW1vdmVBdHRyaWJ1dGUoXCJkaXJlY3RvcnlcIiksci5yZW1vdmVBdHRyaWJ1dGUoXCJ3ZWJraXRkaXJlY3RvcnlcIikpO2JyZWFrO2Nhc2VcIm11bHRpcGxlXCI6dCYmaS5jYW4oXCJzZWxlY3RfbXVsdGlwbGVcIik/ci5zZXRBdHRyaWJ1dGUoXCJtdWx0aXBsZVwiLFwiXCIpOnIucmVtb3ZlQXR0cmlidXRlKFwibXVsdGlwbGVcIil9fSxkaXNhYmxlOmZ1bmN0aW9uKGUpe3ZhciB0LGk9dGhpcy5nZXRSdW50aW1lKCk7KHQ9bi5nZXQoaS51aWQpKSYmKHQuZGlzYWJsZWQ9ISFlKX0sZGVzdHJveTpmdW5jdGlvbigpe3ZhciB0PXRoaXMuZ2V0UnVudGltZSgpLGk9dC5nZXRTaGltKCksbz10LmdldFNoaW1Db250YWluZXIoKSxhPWUmJm4uZ2V0KGUuY29udGFpbmVyKSx1PWUmJm4uZ2V0KGUuYnJvd3NlX2J1dHRvbik7YSYmci5yZW1vdmVBbGxFdmVudHMoYSx0aGlzLnVpZCksdSYmKHIucmVtb3ZlQWxsRXZlbnRzKHUsdGhpcy51aWQpLHUuc3R5bGUuekluZGV4PXMpLG8mJihyLnJlbW92ZUFsbEV2ZW50cyhvLHRoaXMudWlkKSxvLmlubmVySFRNTD1cIlwiKSxpLnJlbW92ZUluc3RhbmNlKHRoaXMudWlkKSxlPW89YT11PWk9bnVsbH19KX1yZXR1cm4gZS5GaWxlSW5wdXQ9c30pLG4oXCJtb3hpZS9ydW50aW1lL2h0bWw1L2ZpbGUvRmlsZURyb3BcIixbXCJtb3hpZS9ydW50aW1lL2h0bWw1L1J1bnRpbWVcIixcIm1veGllL2ZpbGUvRmlsZVwiLFwibW94aWUvY29yZS91dGlscy9CYXNpY1wiLFwibW94aWUvY29yZS91dGlscy9Eb21cIixcIm1veGllL2NvcmUvdXRpbHMvRXZlbnRzXCIsXCJtb3hpZS9jb3JlL3V0aWxzL01pbWVcIl0sZnVuY3Rpb24oZSx0LGksbixyLG8pe2Z1bmN0aW9uIGEoKXtmdW5jdGlvbiBlKGUpe2lmKCFlLmRhdGFUcmFuc2Zlcnx8IWUuZGF0YVRyYW5zZmVyLnR5cGVzKXJldHVybiExO3ZhciB0PWkudG9BcnJheShlLmRhdGFUcmFuc2Zlci50eXBlc3x8W10pO3JldHVybi0xIT09aS5pbkFycmF5KFwiRmlsZXNcIix0KXx8LTEhPT1pLmluQXJyYXkoXCJwdWJsaWMuZmlsZS11cmxcIix0KXx8LTEhPT1pLmluQXJyYXkoXCJhcHBsaWNhdGlvbi94LW1vei1maWxlXCIsdCl9ZnVuY3Rpb24gYShlLGkpe2lmKHUoZSkpe3ZhciBuPW5ldyB0KGYsZSk7bi5yZWxhdGl2ZVBhdGg9aXx8XCJcIixwLnB1c2gobil9fWZ1bmN0aW9uIHMoZSl7Zm9yKHZhciB0PVtdLG49MDtuPGUubGVuZ3RoO24rKylbXS5wdXNoLmFwcGx5KHQsZVtuXS5leHRlbnNpb25zLnNwbGl0KC9cXHMqLFxccyovKSk7cmV0dXJuLTE9PT1pLmluQXJyYXkoXCIqXCIsdCk/dDpbXX1mdW5jdGlvbiB1KGUpe2lmKCFnLmxlbmd0aClyZXR1cm4hMDt2YXIgdD1vLmdldEZpbGVFeHRlbnNpb24oZS5uYW1lKTtyZXR1cm4hdHx8LTEhPT1pLmluQXJyYXkodCxnKX1mdW5jdGlvbiBjKGUsdCl7dmFyIG49W107aS5lYWNoKGUsZnVuY3Rpb24oZSl7dmFyIHQ9ZS53ZWJraXRHZXRBc0VudHJ5KCk7dCYmKHQuaXNGaWxlP2EoZS5nZXRBc0ZpbGUoKSx0LmZ1bGxQYXRoKTpuLnB1c2godCkpfSksbi5sZW5ndGg/bChuLHQpOnQoKX1mdW5jdGlvbiBsKGUsdCl7dmFyIG49W107aS5lYWNoKGUsZnVuY3Rpb24oZSl7bi5wdXNoKGZ1bmN0aW9uKHQpe2QoZSx0KX0pfSksaS5pblNlcmllcyhuLGZ1bmN0aW9uKCl7dCgpfSl9ZnVuY3Rpb24gZChlLHQpe2UuaXNGaWxlP2UuZmlsZShmdW5jdGlvbihpKXthKGksZS5mdWxsUGF0aCksdCgpfSxmdW5jdGlvbigpe3QoKX0pOmUuaXNEaXJlY3Rvcnk/bShlLHQpOnQoKX1mdW5jdGlvbiBtKGUsdCl7ZnVuY3Rpb24gaShlKXtyLnJlYWRFbnRyaWVzKGZ1bmN0aW9uKHQpe3QubGVuZ3RoPyhbXS5wdXNoLmFwcGx5KG4sdCksaShlKSk6ZSgpfSxlKX12YXIgbj1bXSxyPWUuY3JlYXRlUmVhZGVyKCk7aShmdW5jdGlvbigpe2wobix0KX0pfXZhciBoLGYscD1bXSxnPVtdO2kuZXh0ZW5kKHRoaXMse2luaXQ6ZnVuY3Rpb24odCl7dmFyIG4sbz10aGlzO2g9dCxmPW8ucnVpZCxnPXMoaC5hY2NlcHQpLG49aC5jb250YWluZXIsci5hZGRFdmVudChuLFwiZHJhZ292ZXJcIixmdW5jdGlvbih0KXtlKHQpJiYodC5wcmV2ZW50RGVmYXVsdCgpLHQuZGF0YVRyYW5zZmVyLmRyb3BFZmZlY3Q9XCJjb3B5XCIpfSxvLnVpZCksci5hZGRFdmVudChuLFwiZHJvcFwiLGZ1bmN0aW9uKHQpe2UodCkmJih0LnByZXZlbnREZWZhdWx0KCkscD1bXSx0LmRhdGFUcmFuc2Zlci5pdGVtcyYmdC5kYXRhVHJhbnNmZXIuaXRlbXNbMF0ud2Via2l0R2V0QXNFbnRyeT9jKHQuZGF0YVRyYW5zZmVyLml0ZW1zLGZ1bmN0aW9uKCl7by5maWxlcz1wLG8udHJpZ2dlcihcImRyb3BcIil9KTooaS5lYWNoKHQuZGF0YVRyYW5zZmVyLmZpbGVzLGZ1bmN0aW9uKGUpe2EoZSl9KSxvLmZpbGVzPXAsby50cmlnZ2VyKFwiZHJvcFwiKSkpfSxvLnVpZCksci5hZGRFdmVudChuLFwiZHJhZ2VudGVyXCIsZnVuY3Rpb24oKXtvLnRyaWdnZXIoXCJkcmFnZW50ZXJcIil9LG8udWlkKSxyLmFkZEV2ZW50KG4sXCJkcmFnbGVhdmVcIixmdW5jdGlvbigpe28udHJpZ2dlcihcImRyYWdsZWF2ZVwiKX0sby51aWQpfSxkZXN0cm95OmZ1bmN0aW9uKCl7ci5yZW1vdmVBbGxFdmVudHMoaCYmbi5nZXQoaC5jb250YWluZXIpLHRoaXMudWlkKSxmPXA9Zz1oPW51bGwsdGhpcy5nZXRSdW50aW1lKCkuZ2V0U2hpbSgpLnJlbW92ZUluc3RhbmNlKHRoaXMudWlkKX19KX1yZXR1cm4gZS5GaWxlRHJvcD1hfSksbihcIm1veGllL3J1bnRpbWUvaHRtbDUvZmlsZS9GaWxlUmVhZGVyXCIsW1wibW94aWUvcnVudGltZS9odG1sNS9SdW50aW1lXCIsXCJtb3hpZS9jb3JlL3V0aWxzL0VuY29kZVwiLFwibW94aWUvY29yZS91dGlscy9CYXNpY1wiXSxmdW5jdGlvbihlLHQsaSl7ZnVuY3Rpb24gbigpe2Z1bmN0aW9uIGUoZSl7cmV0dXJuIHQuYXRvYihlLnN1YnN0cmluZyhlLmluZGV4T2YoXCJiYXNlNjQsXCIpKzcpKX12YXIgbixyPSExO2kuZXh0ZW5kKHRoaXMse3JlYWQ6ZnVuY3Rpb24odCxvKXt2YXIgYT10aGlzO2EucmVzdWx0PVwiXCIsbj1uZXcgd2luZG93LkZpbGVSZWFkZXIsbi5hZGRFdmVudExpc3RlbmVyKFwicHJvZ3Jlc3NcIixmdW5jdGlvbihlKXthLnRyaWdnZXIoZSl9KSxuLmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsZnVuY3Rpb24odCl7YS5yZXN1bHQ9cj9lKG4ucmVzdWx0KTpuLnJlc3VsdCxhLnRyaWdnZXIodCl9KSxuLmFkZEV2ZW50TGlzdGVuZXIoXCJlcnJvclwiLGZ1bmN0aW9uKGUpe2EudHJpZ2dlcihlLG4uZXJyb3IpfSksbi5hZGRFdmVudExpc3RlbmVyKFwibG9hZGVuZFwiLGZ1bmN0aW9uKGUpe249bnVsbCxhLnRyaWdnZXIoZSl9KSxcImZ1bmN0aW9uXCI9PT1pLnR5cGVPZihuW3RdKT8ocj0hMSxuW3RdKG8uZ2V0U291cmNlKCkpKTpcInJlYWRBc0JpbmFyeVN0cmluZ1wiPT09dCYmKHI9ITAsbi5yZWFkQXNEYXRhVVJMKG8uZ2V0U291cmNlKCkpKX0sYWJvcnQ6ZnVuY3Rpb24oKXtuJiZuLmFib3J0KCl9LGRlc3Ryb3k6ZnVuY3Rpb24oKXtuPW51bGwsdGhpcy5nZXRSdW50aW1lKCkuZ2V0U2hpbSgpLnJlbW92ZUluc3RhbmNlKHRoaXMudWlkKX19KX1yZXR1cm4gZS5GaWxlUmVhZGVyPW59KSxuKFwibW94aWUvcnVudGltZS9odG1sNS94aHIvWE1MSHR0cFJlcXVlc3RcIixbXCJtb3hpZS9ydW50aW1lL2h0bWw1L1J1bnRpbWVcIixcIm1veGllL2NvcmUvdXRpbHMvQmFzaWNcIixcIm1veGllL2NvcmUvdXRpbHMvTWltZVwiLFwibW94aWUvY29yZS91dGlscy9VcmxcIixcIm1veGllL2ZpbGUvRmlsZVwiLFwibW94aWUvZmlsZS9CbG9iXCIsXCJtb3hpZS94aHIvRm9ybURhdGFcIixcIm1veGllL2NvcmUvRXhjZXB0aW9uc1wiLFwibW94aWUvY29yZS91dGlscy9FbnZcIl0sZnVuY3Rpb24oZSx0LGksbixyLG8sYSxzLHUpe2Z1bmN0aW9uIGMoKXtmdW5jdGlvbiBlKGUsdCl7dmFyIGksbixyPXRoaXM7aT10LmdldEJsb2IoKS5nZXRTb3VyY2UoKSxuPW5ldyB3aW5kb3cuRmlsZVJlYWRlcixuLm9ubG9hZD1mdW5jdGlvbigpe3QuYXBwZW5kKHQuZ2V0QmxvYk5hbWUoKSxuZXcgbyhudWxsLHt0eXBlOmkudHlwZSxkYXRhOm4ucmVzdWx0fSkpLGYuc2VuZC5jYWxsKHIsZSx0KX0sbi5yZWFkQXNCaW5hcnlTdHJpbmcoaSl9ZnVuY3Rpb24gYygpe3JldHVybiF3aW5kb3cuWE1MSHR0cFJlcXVlc3R8fFwiSUVcIj09PXUuYnJvd3NlciYmdS52ZXJDb21wKHUudmVyc2lvbiw4LFwiPFwiKT9mdW5jdGlvbigpe2Zvcih2YXIgZT1bXCJNc3htbDIuWE1MSFRUUC42LjBcIixcIk1pY3Jvc29mdC5YTUxIVFRQXCJdLHQ9MDt0PGUubGVuZ3RoO3QrKyl0cnl7cmV0dXJuIG5ldyBBY3RpdmVYT2JqZWN0KGVbdF0pfWNhdGNoKGkpe319KCk6bmV3IHdpbmRvdy5YTUxIdHRwUmVxdWVzdH1mdW5jdGlvbiBsKGUpe3ZhciB0PWUucmVzcG9uc2VYTUwsaT1lLnJlc3BvbnNlVGV4dDtyZXR1cm5cIklFXCI9PT11LmJyb3dzZXImJmkmJnQmJiF0LmRvY3VtZW50RWxlbWVudCYmL1teXFwvXStcXC9bXlxcK10rXFwreG1sLy50ZXN0KGUuZ2V0UmVzcG9uc2VIZWFkZXIoXCJDb250ZW50LVR5cGVcIikpJiYodD1uZXcgd2luZG93LkFjdGl2ZVhPYmplY3QoXCJNaWNyb3NvZnQuWE1MRE9NXCIpLHQuYXN5bmM9ITEsdC52YWxpZGF0ZU9uUGFyc2U9ITEsdC5sb2FkWE1MKGkpKSx0JiYoXCJJRVwiPT09dS5icm93c2VyJiYwIT09dC5wYXJzZUVycm9yfHwhdC5kb2N1bWVudEVsZW1lbnR8fFwicGFyc2VyZXJyb3JcIj09PXQuZG9jdW1lbnRFbGVtZW50LnRhZ05hbWUpP251bGw6dFxufWZ1bmN0aW9uIGQoZSl7dmFyIHQ9XCItLS0tbW94aWVib3VuZGFyeVwiKyhuZXcgRGF0ZSkuZ2V0VGltZSgpLGk9XCItLVwiLG49XCJcXHJcXG5cIixyPVwiXCIsYT10aGlzLmdldFJ1bnRpbWUoKTtpZighYS5jYW4oXCJzZW5kX2JpbmFyeV9zdHJpbmdcIikpdGhyb3cgbmV3IHMuUnVudGltZUVycm9yKHMuUnVudGltZUVycm9yLk5PVF9TVVBQT1JURURfRVJSKTtyZXR1cm4gbS5zZXRSZXF1ZXN0SGVhZGVyKFwiQ29udGVudC1UeXBlXCIsXCJtdWx0aXBhcnQvZm9ybS1kYXRhOyBib3VuZGFyeT1cIit0KSxlLmVhY2goZnVuY3Rpb24oZSxhKXtyKz1lIGluc3RhbmNlb2Ygbz9pK3QrbisnQ29udGVudC1EaXNwb3NpdGlvbjogZm9ybS1kYXRhOyBuYW1lPVwiJythKydcIjsgZmlsZW5hbWU9XCInK3VuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChlLm5hbWV8fFwiYmxvYlwiKSkrJ1wiJytuK1wiQ29udGVudC1UeXBlOiBcIisoZS50eXBlfHxcImFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbVwiKStuK24rZS5nZXRTb3VyY2UoKStuOmkrdCtuKydDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9XCInK2ErJ1wiJytuK24rdW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KGUpKStufSkscis9aSt0K2krbn12YXIgbSxoLGY9dGhpczt0LmV4dGVuZCh0aGlzLHtzZW5kOmZ1bmN0aW9uKGkscil7dmFyIHM9dGhpcyxsPVwiTW96aWxsYVwiPT09dS5icm93c2VyJiZ1LnZlckNvbXAodS52ZXJzaW9uLDQsXCI+PVwiKSYmdS52ZXJDb21wKHUudmVyc2lvbiw3LFwiPFwiKSxmPVwiQW5kcm9pZCBCcm93c2VyXCI9PT11LmJyb3dzZXIscD0hMTtpZihoPWkudXJsLnJlcGxhY2UoL14uKz9cXC8oW1xcd1xcLVxcLl0rKSQvLFwiJDFcIikudG9Mb3dlckNhc2UoKSxtPWMoKSxtLm9wZW4oaS5tZXRob2QsaS51cmwsaS5hc3luYyxpLnVzZXIsaS5wYXNzd29yZCksciBpbnN0YW5jZW9mIG8pci5pc0RldGFjaGVkKCkmJihwPSEwKSxyPXIuZ2V0U291cmNlKCk7ZWxzZSBpZihyIGluc3RhbmNlb2YgYSl7aWYoci5oYXNCbG9iKCkpaWYoci5nZXRCbG9iKCkuaXNEZXRhY2hlZCgpKXI9ZC5jYWxsKHMscikscD0hMDtlbHNlIGlmKChsfHxmKSYmXCJibG9iXCI9PT10LnR5cGVPZihyLmdldEJsb2IoKS5nZXRTb3VyY2UoKSkmJndpbmRvdy5GaWxlUmVhZGVyKXJldHVybiBlLmNhbGwocyxpLHIpLHZvaWQgMDtpZihyIGluc3RhbmNlb2YgYSl7dmFyIGc9bmV3IHdpbmRvdy5Gb3JtRGF0YTtyLmVhY2goZnVuY3Rpb24oZSx0KXtlIGluc3RhbmNlb2Ygbz9nLmFwcGVuZCh0LGUuZ2V0U291cmNlKCkpOmcuYXBwZW5kKHQsZSl9KSxyPWd9fW0udXBsb2FkPyhpLndpdGhDcmVkZW50aWFscyYmKG0ud2l0aENyZWRlbnRpYWxzPSEwKSxtLmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsZnVuY3Rpb24oZSl7cy50cmlnZ2VyKGUpfSksbS5hZGRFdmVudExpc3RlbmVyKFwiZXJyb3JcIixmdW5jdGlvbihlKXtzLnRyaWdnZXIoZSl9KSxtLmFkZEV2ZW50TGlzdGVuZXIoXCJwcm9ncmVzc1wiLGZ1bmN0aW9uKGUpe3MudHJpZ2dlcihlKX0pLG0udXBsb2FkLmFkZEV2ZW50TGlzdGVuZXIoXCJwcm9ncmVzc1wiLGZ1bmN0aW9uKGUpe3MudHJpZ2dlcih7dHlwZTpcIlVwbG9hZFByb2dyZXNzXCIsbG9hZGVkOmUubG9hZGVkLHRvdGFsOmUudG90YWx9KX0pKTptLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpe3N3aXRjaChtLnJlYWR5U3RhdGUpe2Nhc2UgMTpicmVhaztjYXNlIDI6YnJlYWs7Y2FzZSAzOnZhciBlLHQ7dHJ5e24uaGFzU2FtZU9yaWdpbihpLnVybCkmJihlPW0uZ2V0UmVzcG9uc2VIZWFkZXIoXCJDb250ZW50LUxlbmd0aFwiKXx8MCksbS5yZXNwb25zZVRleHQmJih0PW0ucmVzcG9uc2VUZXh0Lmxlbmd0aCl9Y2F0Y2gocil7ZT10PTB9cy50cmlnZ2VyKHt0eXBlOlwicHJvZ3Jlc3NcIixsZW5ndGhDb21wdXRhYmxlOiEhZSx0b3RhbDpwYXJzZUludChlLDEwKSxsb2FkZWQ6dH0pO2JyZWFrO2Nhc2UgNDptLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpe307dHJ5e2lmKG0uc3RhdHVzPj0yMDAmJm0uc3RhdHVzPDQwMCl7cy50cmlnZ2VyKFwibG9hZFwiKTticmVha319Y2F0Y2gocil7fXMudHJpZ2dlcihcImVycm9yXCIpfX0sdC5pc0VtcHR5T2JqKGkuaGVhZGVycyl8fHQuZWFjaChpLmhlYWRlcnMsZnVuY3Rpb24oZSx0KXttLnNldFJlcXVlc3RIZWFkZXIodCxlKX0pLFwiXCIhPT1pLnJlc3BvbnNlVHlwZSYmXCJyZXNwb25zZVR5cGVcImluIG0mJihtLnJlc3BvbnNlVHlwZT1cImpzb25cIiE9PWkucmVzcG9uc2VUeXBlfHx1LmNhbihcInJldHVybl9yZXNwb25zZV90eXBlXCIsXCJqc29uXCIpP2kucmVzcG9uc2VUeXBlOlwidGV4dFwiKSxwP20uc2VuZEFzQmluYXJ5P20uc2VuZEFzQmluYXJ5KHIpOmZ1bmN0aW9uKCl7Zm9yKHZhciBlPW5ldyBVaW50OEFycmF5KHIubGVuZ3RoKSx0PTA7dDxyLmxlbmd0aDt0KyspZVt0XT0yNTUmci5jaGFyQ29kZUF0KHQpO20uc2VuZChlLmJ1ZmZlcil9KCk6bS5zZW5kKHIpLHMudHJpZ2dlcihcImxvYWRzdGFydFwiKX0sZ2V0U3RhdHVzOmZ1bmN0aW9uKCl7dHJ5e2lmKG0pcmV0dXJuIG0uc3RhdHVzfWNhdGNoKGUpe31yZXR1cm4gMH0sZ2V0UmVzcG9uc2U6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5nZXRSdW50aW1lKCk7dHJ5e3N3aXRjaChlKXtjYXNlXCJibG9iXCI6dmFyIG49bmV3IHIodC51aWQsbS5yZXNwb25zZSksbz1tLmdldFJlc3BvbnNlSGVhZGVyKFwiQ29udGVudC1EaXNwb3NpdGlvblwiKTtpZihvKXt2YXIgYT1vLm1hdGNoKC9maWxlbmFtZT0oW1xcJ1xcXCInXSkoW15cXDFdKylcXDEvKTthJiYoaD1hWzJdKX1yZXR1cm4gbi5uYW1lPWgsbi50eXBlfHwobi50eXBlPWkuZ2V0RmlsZU1pbWUoaCkpLG47Y2FzZVwianNvblwiOnJldHVybiB1LmNhbihcInJldHVybl9yZXNwb25zZV90eXBlXCIsXCJqc29uXCIpP20ucmVzcG9uc2U6MjAwPT09bS5zdGF0dXMmJndpbmRvdy5KU09OP0pTT04ucGFyc2UobS5yZXNwb25zZVRleHQpOm51bGw7Y2FzZVwiZG9jdW1lbnRcIjpyZXR1cm4gbChtKTtkZWZhdWx0OnJldHVyblwiXCIhPT1tLnJlc3BvbnNlVGV4dD9tLnJlc3BvbnNlVGV4dDpudWxsfX1jYXRjaChzKXtyZXR1cm4gbnVsbH19LGdldEFsbFJlc3BvbnNlSGVhZGVyczpmdW5jdGlvbigpe3RyeXtyZXR1cm4gbS5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKX1jYXRjaChlKXt9cmV0dXJuXCJcIn0sYWJvcnQ6ZnVuY3Rpb24oKXttJiZtLmFib3J0KCl9LGRlc3Ryb3k6ZnVuY3Rpb24oKXtmPWg9bnVsbCx0aGlzLmdldFJ1bnRpbWUoKS5nZXRTaGltKCkucmVtb3ZlSW5zdGFuY2UodGhpcy51aWQpfX0pfXJldHVybiBlLlhNTEh0dHBSZXF1ZXN0PWN9KSxuKFwibW94aWUvcnVudGltZS9odG1sNS91dGlscy9CaW5hcnlSZWFkZXJcIixbXCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCJdLGZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQoZSl7ZSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyP2kuYXBwbHkodGhpcyxhcmd1bWVudHMpOm4uYXBwbHkodGhpcyxhcmd1bWVudHMpfWZ1bmN0aW9uIGkodCl7dmFyIGk9bmV3IERhdGFWaWV3KHQpO2UuZXh0ZW5kKHRoaXMse3JlYWRCeXRlQXQ6ZnVuY3Rpb24oZSl7cmV0dXJuIGkuZ2V0VWludDgoZSl9LHdyaXRlQnl0ZUF0OmZ1bmN0aW9uKGUsdCl7aS5zZXRVaW50OChlLHQpfSxTRUdNRU5UOmZ1bmN0aW9uKGUsbixyKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiB0LnNsaWNlKGUsZStuKTtjYXNlIDE6cmV0dXJuIHQuc2xpY2UoZSk7Y2FzZSAzOmlmKG51bGw9PT1yJiYocj1uZXcgQXJyYXlCdWZmZXIpLHIgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcil7dmFyIG89bmV3IFVpbnQ4QXJyYXkodGhpcy5sZW5ndGgoKS1uK3IuYnl0ZUxlbmd0aCk7ZT4wJiZvLnNldChuZXcgVWludDhBcnJheSh0LnNsaWNlKDAsZSkpLDApLG8uc2V0KG5ldyBVaW50OEFycmF5KHIpLGUpLG8uc2V0KG5ldyBVaW50OEFycmF5KHQuc2xpY2UoZStuKSksZStyLmJ5dGVMZW5ndGgpLHRoaXMuY2xlYXIoKSx0PW8uYnVmZmVyLGk9bmV3IERhdGFWaWV3KHQpO2JyZWFrfWRlZmF1bHQ6cmV0dXJuIHR9fSxsZW5ndGg6ZnVuY3Rpb24oKXtyZXR1cm4gdD90LmJ5dGVMZW5ndGg6MH0sY2xlYXI6ZnVuY3Rpb24oKXtpPXQ9bnVsbH19KX1mdW5jdGlvbiBuKHQpe2Z1bmN0aW9uIGkoZSxpLG4pe249Mz09PWFyZ3VtZW50cy5sZW5ndGg/bjp0Lmxlbmd0aC1pLTEsdD10LnN1YnN0cigwLGkpK2UrdC5zdWJzdHIobitpKX1lLmV4dGVuZCh0aGlzLHtyZWFkQnl0ZUF0OmZ1bmN0aW9uKGUpe3JldHVybiB0LmNoYXJDb2RlQXQoZSl9LHdyaXRlQnl0ZUF0OmZ1bmN0aW9uKGUsdCl7aShTdHJpbmcuZnJvbUNoYXJDb2RlKHQpLGUsMSl9LFNFR01FTlQ6ZnVuY3Rpb24oZSxuLHIpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6cmV0dXJuIHQuc3Vic3RyKGUpO2Nhc2UgMjpyZXR1cm4gdC5zdWJzdHIoZSxuKTtjYXNlIDM6aShudWxsIT09cj9yOlwiXCIsZSxuKTticmVhaztkZWZhdWx0OnJldHVybiB0fX0sbGVuZ3RoOmZ1bmN0aW9uKCl7cmV0dXJuIHQ/dC5sZW5ndGg6MH0sY2xlYXI6ZnVuY3Rpb24oKXt0PW51bGx9fSl9cmV0dXJuIGUuZXh0ZW5kKHQucHJvdG90eXBlLHtsaXR0bGVFbmRpYW46ITEscmVhZDpmdW5jdGlvbihlLHQpe3ZhciBpLG4scjtpZihlK3Q+dGhpcy5sZW5ndGgoKSl0aHJvdyBuZXcgRXJyb3IoXCJZb3UgYXJlIHRyeWluZyB0byByZWFkIG91dHNpZGUgdGhlIHNvdXJjZSBib3VuZGFyaWVzLlwiKTtmb3Iobj10aGlzLmxpdHRsZUVuZGlhbj8wOi04Kih0LTEpLHI9MCxpPTA7dD5yO3IrKylpfD10aGlzLnJlYWRCeXRlQXQoZStyKTw8TWF0aC5hYnMobis4KnIpO3JldHVybiBpfSx3cml0ZTpmdW5jdGlvbihlLHQsaSl7dmFyIG4scjtpZihlPnRoaXMubGVuZ3RoKCkpdGhyb3cgbmV3IEVycm9yKFwiWW91IGFyZSB0cnlpbmcgdG8gd3JpdGUgb3V0c2lkZSB0aGUgc291cmNlIGJvdW5kYXJpZXMuXCIpO2ZvcihuPXRoaXMubGl0dGxlRW5kaWFuPzA6LTgqKGktMSkscj0wO2k+cjtyKyspdGhpcy53cml0ZUJ5dGVBdChlK3IsMjU1JnQ+Pk1hdGguYWJzKG4rOCpyKSl9LEJZVEU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMucmVhZChlLDEpfSxTSE9SVDpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5yZWFkKGUsMil9LExPTkc6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMucmVhZChlLDQpfSxTTE9ORzpmdW5jdGlvbihlKXt2YXIgdD10aGlzLnJlYWQoZSw0KTtyZXR1cm4gdD4yMTQ3NDgzNjQ3P3QtNDI5NDk2NzI5Njp0fSxDSEFSOmZ1bmN0aW9uKGUpe3JldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlKHRoaXMucmVhZChlLDEpKX0sU1RSSU5HOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuYXNBcnJheShcIkNIQVJcIixlLHQpLmpvaW4oXCJcIil9LGFzQXJyYXk6ZnVuY3Rpb24oZSx0LGkpe2Zvcih2YXIgbj1bXSxyPTA7aT5yO3IrKyluW3JdPXRoaXNbZV0odCtyKTtyZXR1cm4gbn19KSx0fSksbihcIm1veGllL3J1bnRpbWUvaHRtbDUvaW1hZ2UvSlBFR0hlYWRlcnNcIixbXCJtb3hpZS9ydW50aW1lL2h0bWw1L3V0aWxzL0JpbmFyeVJlYWRlclwiLFwibW94aWUvY29yZS9FeGNlcHRpb25zXCJdLGZ1bmN0aW9uKGUsdCl7cmV0dXJuIGZ1bmN0aW9uIGkobil7dmFyIHIsbyxhLHM9W10sdT0wO2lmKHI9bmV3IGUobiksNjU0OTYhPT1yLlNIT1JUKDApKXRocm93IHIuY2xlYXIoKSxuZXcgdC5JbWFnZUVycm9yKHQuSW1hZ2VFcnJvci5XUk9OR19GT1JNQVQpO2ZvcihvPTI7bzw9ci5sZW5ndGgoKTspaWYoYT1yLlNIT1JUKG8pLGE+PTY1NDg4JiY2NTQ5NT49YSlvKz0yO2Vsc2V7aWYoNjU0OTg9PT1hfHw2NTQ5Nz09PWEpYnJlYWs7dT1yLlNIT1JUKG8rMikrMixhPj02NTUwNSYmNjU1MTk+PWEmJnMucHVzaCh7aGV4OmEsbmFtZTpcIkFQUFwiKygxNSZhKSxzdGFydDpvLGxlbmd0aDp1LHNlZ21lbnQ6ci5TRUdNRU5UKG8sdSl9KSxvKz11fXJldHVybiByLmNsZWFyKCkse2hlYWRlcnM6cyxyZXN0b3JlOmZ1bmN0aW9uKHQpe3ZhciBpLG4scjtmb3Iocj1uZXcgZSh0KSxvPTY1NTA0PT1yLlNIT1JUKDIpPzQrci5TSE9SVCg0KToyLG49MCxpPXMubGVuZ3RoO2k+bjtuKyspci5TRUdNRU5UKG8sMCxzW25dLnNlZ21lbnQpLG8rPXNbbl0ubGVuZ3RoO3JldHVybiB0PXIuU0VHTUVOVCgpLHIuY2xlYXIoKSx0fSxzdHJpcDpmdW5jdGlvbih0KXt2YXIgbixyLG8sYTtmb3Iobz1uZXcgaSh0KSxyPW8uaGVhZGVycyxvLnB1cmdlKCksbj1uZXcgZSh0KSxhPXIubGVuZ3RoO2EtLTspbi5TRUdNRU5UKHJbYV0uc3RhcnQsclthXS5sZW5ndGgsXCJcIik7cmV0dXJuIHQ9bi5TRUdNRU5UKCksbi5jbGVhcigpLHR9LGdldDpmdW5jdGlvbihlKXtmb3IodmFyIHQ9W10saT0wLG49cy5sZW5ndGg7bj5pO2krKylzW2ldLm5hbWU9PT1lLnRvVXBwZXJDYXNlKCkmJnQucHVzaChzW2ldLnNlZ21lbnQpO3JldHVybiB0fSxzZXQ6ZnVuY3Rpb24oZSx0KXt2YXIgaSxuLHIsbz1bXTtmb3IoXCJzdHJpbmdcIj09dHlwZW9mIHQ/by5wdXNoKHQpOm89dCxpPW49MCxyPXMubGVuZ3RoO3I+aSYmKHNbaV0ubmFtZT09PWUudG9VcHBlckNhc2UoKSYmKHNbaV0uc2VnbWVudD1vW25dLHNbaV0ubGVuZ3RoPW9bbl0ubGVuZ3RoLG4rKyksIShuPj1vLmxlbmd0aCkpO2krKyk7fSxwdXJnZTpmdW5jdGlvbigpe3RoaXMuaGVhZGVycz1zPVtdfX19fSksbihcIm1veGllL3J1bnRpbWUvaHRtbDUvaW1hZ2UvRXhpZlBhcnNlclwiLFtcIm1veGllL2NvcmUvdXRpbHMvQmFzaWNcIixcIm1veGllL3J1bnRpbWUvaHRtbDUvdXRpbHMvQmluYXJ5UmVhZGVyXCIsXCJtb3hpZS9jb3JlL0V4Y2VwdGlvbnNcIl0sZnVuY3Rpb24oZSxpLG4pe2Z1bmN0aW9uIHIobyl7ZnVuY3Rpb24gYShpLHIpe3ZhciBvLGEscyx1LGMsbSxoLGYscD10aGlzLGc9W10seD17fSx2PXsxOlwiQllURVwiLDc6XCJVTkRFRklORURcIiwyOlwiQVNDSUlcIiwzOlwiU0hPUlRcIiw0OlwiTE9OR1wiLDU6XCJSQVRJT05BTFwiLDk6XCJTTE9OR1wiLDEwOlwiU1JBVElPTkFMXCJ9LHc9e0JZVEU6MSxVTkRFRklORUQ6MSxBU0NJSToxLFNIT1JUOjIsTE9ORzo0LFJBVElPTkFMOjgsU0xPTkc6NCxTUkFUSU9OQUw6OH07Zm9yKG89cC5TSE9SVChpKSxhPTA7bz5hO2ErKylpZihnPVtdLGg9aSsyKzEyKmEscz1yW3AuU0hPUlQoaCldLHMhPT10KXtpZih1PXZbcC5TSE9SVChoKz0yKV0sYz1wLkxPTkcoaCs9MiksbT13W3VdLCFtKXRocm93IG5ldyBuLkltYWdlRXJyb3Iobi5JbWFnZUVycm9yLklOVkFMSURfTUVUQV9FUlIpO2lmKGgrPTQsbSpjPjQmJihoPXAuTE9ORyhoKStkLnRpZmZIZWFkZXIpLGgrbSpjPj10aGlzLmxlbmd0aCgpKXRocm93IG5ldyBuLkltYWdlRXJyb3Iobi5JbWFnZUVycm9yLklOVkFMSURfTUVUQV9FUlIpO1wiQVNDSUlcIiE9PXU/KGc9cC5hc0FycmF5KHUsaCxjKSxmPTE9PWM/Z1swXTpnLHhbc109bC5oYXNPd25Qcm9wZXJ0eShzKSYmXCJvYmplY3RcIiE9dHlwZW9mIGY/bFtzXVtmXTpmKTp4W3NdPWUudHJpbShwLlNUUklORyhoLGMpLnJlcGxhY2UoL1xcMCQvLFwiXCIpKX1yZXR1cm4geH1mdW5jdGlvbiBzKGUsdCxpKXt2YXIgbixyLG8sYT0wO2lmKFwic3RyaW5nXCI9PXR5cGVvZiB0KXt2YXIgcz1jW2UudG9Mb3dlckNhc2UoKV07Zm9yKHZhciB1IGluIHMpaWYoc1t1XT09PXQpe3Q9dTticmVha319bj1kW2UudG9Mb3dlckNhc2UoKStcIklGRFwiXSxyPXRoaXMuU0hPUlQobik7Zm9yKHZhciBsPTA7cj5sO2wrKylpZihvPW4rMTIqbCsyLHRoaXMuU0hPUlQobyk9PXQpe2E9bys4O2JyZWFrfWlmKCFhKXJldHVybiExO3RyeXt0aGlzLndyaXRlKGEsaSw0KX1jYXRjaChtKXtyZXR1cm4hMX1yZXR1cm4hMH12YXIgdSxjLGwsZCxtLGg7aWYoaS5jYWxsKHRoaXMsbyksYz17dGlmZjp7Mjc0OlwiT3JpZW50YXRpb25cIiwyNzA6XCJJbWFnZURlc2NyaXB0aW9uXCIsMjcxOlwiTWFrZVwiLDI3MjpcIk1vZGVsXCIsMzA1OlwiU29mdHdhcmVcIiwzNDY2NTpcIkV4aWZJRkRQb2ludGVyXCIsMzQ4NTM6XCJHUFNJbmZvSUZEUG9pbnRlclwifSxleGlmOnszNjg2NDpcIkV4aWZWZXJzaW9uXCIsNDA5NjE6XCJDb2xvclNwYWNlXCIsNDA5NjI6XCJQaXhlbFhEaW1lbnNpb25cIiw0MDk2MzpcIlBpeGVsWURpbWVuc2lvblwiLDM2ODY3OlwiRGF0ZVRpbWVPcmlnaW5hbFwiLDMzNDM0OlwiRXhwb3N1cmVUaW1lXCIsMzM0Mzc6XCJGTnVtYmVyXCIsMzQ4NTU6XCJJU09TcGVlZFJhdGluZ3NcIiwzNzM3NzpcIlNodXR0ZXJTcGVlZFZhbHVlXCIsMzczNzg6XCJBcGVydHVyZVZhbHVlXCIsMzczODM6XCJNZXRlcmluZ01vZGVcIiwzNzM4NDpcIkxpZ2h0U291cmNlXCIsMzczODU6XCJGbGFzaFwiLDM3Mzg2OlwiRm9jYWxMZW5ndGhcIiw0MTk4NjpcIkV4cG9zdXJlTW9kZVwiLDQxOTg3OlwiV2hpdGVCYWxhbmNlXCIsNDE5OTA6XCJTY2VuZUNhcHR1cmVUeXBlXCIsNDE5ODg6XCJEaWdpdGFsWm9vbVJhdGlvXCIsNDE5OTI6XCJDb250cmFzdFwiLDQxOTkzOlwiU2F0dXJhdGlvblwiLDQxOTk0OlwiU2hhcnBuZXNzXCJ9LGdwczp7MDpcIkdQU1ZlcnNpb25JRFwiLDE6XCJHUFNMYXRpdHVkZVJlZlwiLDI6XCJHUFNMYXRpdHVkZVwiLDM6XCJHUFNMb25naXR1ZGVSZWZcIiw0OlwiR1BTTG9uZ2l0dWRlXCJ9LHRodW1iOns1MTM6XCJKUEVHSW50ZXJjaGFuZ2VGb3JtYXRcIiw1MTQ6XCJKUEVHSW50ZXJjaGFuZ2VGb3JtYXRMZW5ndGhcIn19LGw9e0NvbG9yU3BhY2U6ezE6XCJzUkdCXCIsMDpcIlVuY2FsaWJyYXRlZFwifSxNZXRlcmluZ01vZGU6ezA6XCJVbmtub3duXCIsMTpcIkF2ZXJhZ2VcIiwyOlwiQ2VudGVyV2VpZ2h0ZWRBdmVyYWdlXCIsMzpcIlNwb3RcIiw0OlwiTXVsdGlTcG90XCIsNTpcIlBhdHRlcm5cIiw2OlwiUGFydGlhbFwiLDI1NTpcIk90aGVyXCJ9LExpZ2h0U291cmNlOnsxOlwiRGF5bGlnaHRcIiwyOlwiRmxpb3Jlc2NlbnRcIiwzOlwiVHVuZ3N0ZW5cIiw0OlwiRmxhc2hcIiw5OlwiRmluZSB3ZWF0aGVyXCIsMTA6XCJDbG91ZHkgd2VhdGhlclwiLDExOlwiU2hhZGVcIiwxMjpcIkRheWxpZ2h0IGZsdW9yZXNjZW50IChEIDU3MDAgLSA3MTAwSylcIiwxMzpcIkRheSB3aGl0ZSBmbHVvcmVzY2VudCAoTiA0NjAwIC01NDAwSylcIiwxNDpcIkNvb2wgd2hpdGUgZmx1b3Jlc2NlbnQgKFcgMzkwMCAtIDQ1MDBLKVwiLDE1OlwiV2hpdGUgZmx1b3Jlc2NlbnQgKFdXIDMyMDAgLSAzNzAwSylcIiwxNzpcIlN0YW5kYXJkIGxpZ2h0IEFcIiwxODpcIlN0YW5kYXJkIGxpZ2h0IEJcIiwxOTpcIlN0YW5kYXJkIGxpZ2h0IENcIiwyMDpcIkQ1NVwiLDIxOlwiRDY1XCIsMjI6XCJENzVcIiwyMzpcIkQ1MFwiLDI0OlwiSVNPIHN0dWRpbyB0dW5nc3RlblwiLDI1NTpcIk90aGVyXCJ9LEZsYXNoOnswOlwiRmxhc2ggZGlkIG5vdCBmaXJlXCIsMTpcIkZsYXNoIGZpcmVkXCIsNTpcIlN0cm9iZSByZXR1cm4gbGlnaHQgbm90IGRldGVjdGVkXCIsNzpcIlN0cm9iZSByZXR1cm4gbGlnaHQgZGV0ZWN0ZWRcIiw5OlwiRmxhc2ggZmlyZWQsIGNvbXB1bHNvcnkgZmxhc2ggbW9kZVwiLDEzOlwiRmxhc2ggZmlyZWQsIGNvbXB1bHNvcnkgZmxhc2ggbW9kZSwgcmV0dXJuIGxpZ2h0IG5vdCBkZXRlY3RlZFwiLDE1OlwiRmxhc2ggZmlyZWQsIGNvbXB1bHNvcnkgZmxhc2ggbW9kZSwgcmV0dXJuIGxpZ2h0IGRldGVjdGVkXCIsMTY6XCJGbGFzaCBkaWQgbm90IGZpcmUsIGNvbXB1bHNvcnkgZmxhc2ggbW9kZVwiLDI0OlwiRmxhc2ggZGlkIG5vdCBmaXJlLCBhdXRvIG1vZGVcIiwyNTpcIkZsYXNoIGZpcmVkLCBhdXRvIG1vZGVcIiwyOTpcIkZsYXNoIGZpcmVkLCBhdXRvIG1vZGUsIHJldHVybiBsaWdodCBub3QgZGV0ZWN0ZWRcIiwzMTpcIkZsYXNoIGZpcmVkLCBhdXRvIG1vZGUsIHJldHVybiBsaWdodCBkZXRlY3RlZFwiLDMyOlwiTm8gZmxhc2ggZnVuY3Rpb25cIiw2NTpcIkZsYXNoIGZpcmVkLCByZWQtZXllIHJlZHVjdGlvbiBtb2RlXCIsNjk6XCJGbGFzaCBmaXJlZCwgcmVkLWV5ZSByZWR1Y3Rpb24gbW9kZSwgcmV0dXJuIGxpZ2h0IG5vdCBkZXRlY3RlZFwiLDcxOlwiRmxhc2ggZmlyZWQsIHJlZC1leWUgcmVkdWN0aW9uIG1vZGUsIHJldHVybiBsaWdodCBkZXRlY3RlZFwiLDczOlwiRmxhc2ggZmlyZWQsIGNvbXB1bHNvcnkgZmxhc2ggbW9kZSwgcmVkLWV5ZSByZWR1Y3Rpb24gbW9kZVwiLDc3OlwiRmxhc2ggZmlyZWQsIGNvbXB1bHNvcnkgZmxhc2ggbW9kZSwgcmVkLWV5ZSByZWR1Y3Rpb24gbW9kZSwgcmV0dXJuIGxpZ2h0IG5vdCBkZXRlY3RlZFwiLDc5OlwiRmxhc2ggZmlyZWQsIGNvbXB1bHNvcnkgZmxhc2ggbW9kZSwgcmVkLWV5ZSByZWR1Y3Rpb24gbW9kZSwgcmV0dXJuIGxpZ2h0IGRldGVjdGVkXCIsODk6XCJGbGFzaCBmaXJlZCwgYXV0byBtb2RlLCByZWQtZXllIHJlZHVjdGlvbiBtb2RlXCIsOTM6XCJGbGFzaCBmaXJlZCwgYXV0byBtb2RlLCByZXR1cm4gbGlnaHQgbm90IGRldGVjdGVkLCByZWQtZXllIHJlZHVjdGlvbiBtb2RlXCIsOTU6XCJGbGFzaCBmaXJlZCwgYXV0byBtb2RlLCByZXR1cm4gbGlnaHQgZGV0ZWN0ZWQsIHJlZC1leWUgcmVkdWN0aW9uIG1vZGVcIn0sRXhwb3N1cmVNb2RlOnswOlwiQXV0byBleHBvc3VyZVwiLDE6XCJNYW51YWwgZXhwb3N1cmVcIiwyOlwiQXV0byBicmFja2V0XCJ9LFdoaXRlQmFsYW5jZTp7MDpcIkF1dG8gd2hpdGUgYmFsYW5jZVwiLDE6XCJNYW51YWwgd2hpdGUgYmFsYW5jZVwifSxTY2VuZUNhcHR1cmVUeXBlOnswOlwiU3RhbmRhcmRcIiwxOlwiTGFuZHNjYXBlXCIsMjpcIlBvcnRyYWl0XCIsMzpcIk5pZ2h0IHNjZW5lXCJ9LENvbnRyYXN0OnswOlwiTm9ybWFsXCIsMTpcIlNvZnRcIiwyOlwiSGFyZFwifSxTYXR1cmF0aW9uOnswOlwiTm9ybWFsXCIsMTpcIkxvdyBzYXR1cmF0aW9uXCIsMjpcIkhpZ2ggc2F0dXJhdGlvblwifSxTaGFycG5lc3M6ezA6XCJOb3JtYWxcIiwxOlwiU29mdFwiLDI6XCJIYXJkXCJ9LEdQU0xhdGl0dWRlUmVmOntOOlwiTm9ydGggbGF0aXR1ZGVcIixTOlwiU291dGggbGF0aXR1ZGVcIn0sR1BTTG9uZ2l0dWRlUmVmOntFOlwiRWFzdCBsb25naXR1ZGVcIixXOlwiV2VzdCBsb25naXR1ZGVcIn19LGQ9e3RpZmZIZWFkZXI6MTB9LG09ZC50aWZmSGVhZGVyLHU9e2NsZWFyOnRoaXMuY2xlYXJ9LGUuZXh0ZW5kKHRoaXMse3JlYWQ6ZnVuY3Rpb24oKXt0cnl7cmV0dXJuIHIucHJvdG90eXBlLnJlYWQuYXBwbHkodGhpcyxhcmd1bWVudHMpfWNhdGNoKGUpe3Rocm93IG5ldyBuLkltYWdlRXJyb3Iobi5JbWFnZUVycm9yLklOVkFMSURfTUVUQV9FUlIpfX0sd3JpdGU6ZnVuY3Rpb24oKXt0cnl7cmV0dXJuIHIucHJvdG90eXBlLndyaXRlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX1jYXRjaChlKXt0aHJvdyBuZXcgbi5JbWFnZUVycm9yKG4uSW1hZ2VFcnJvci5JTlZBTElEX01FVEFfRVJSKX19LFVOREVGSU5FRDpmdW5jdGlvbigpe3JldHVybiB0aGlzLkJZVEUuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxSQVRJT05BTDpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5MT05HKGUpL3RoaXMuTE9ORyhlKzQpfSxTUkFUSU9OQUw6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuU0xPTkcoZSkvdGhpcy5TTE9ORyhlKzQpfSxBU0NJSTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5DSEFSKGUpfSxUSUZGOmZ1bmN0aW9uKCl7cmV0dXJuIGh8fG51bGx9LEVYSUY6ZnVuY3Rpb24oKXt2YXIgdD1udWxsO2lmKGQuZXhpZklGRCl7dHJ5e3Q9YS5jYWxsKHRoaXMsZC5leGlmSUZELGMuZXhpZil9Y2F0Y2goaSl7cmV0dXJuIG51bGx9aWYodC5FeGlmVmVyc2lvbiYmXCJhcnJheVwiPT09ZS50eXBlT2YodC5FeGlmVmVyc2lvbikpe2Zvcih2YXIgbj0wLHI9XCJcIjtuPHQuRXhpZlZlcnNpb24ubGVuZ3RoO24rKylyKz1TdHJpbmcuZnJvbUNoYXJDb2RlKHQuRXhpZlZlcnNpb25bbl0pO3QuRXhpZlZlcnNpb249cn19cmV0dXJuIHR9LEdQUzpmdW5jdGlvbigpe3ZhciB0PW51bGw7aWYoZC5ncHNJRkQpe3RyeXt0PWEuY2FsbCh0aGlzLGQuZ3BzSUZELGMuZ3BzKX1jYXRjaChpKXtyZXR1cm4gbnVsbH10LkdQU1ZlcnNpb25JRCYmXCJhcnJheVwiPT09ZS50eXBlT2YodC5HUFNWZXJzaW9uSUQpJiYodC5HUFNWZXJzaW9uSUQ9dC5HUFNWZXJzaW9uSUQuam9pbihcIi5cIikpfXJldHVybiB0fSx0aHVtYjpmdW5jdGlvbigpe2lmKGQuSUZEMSl0cnl7dmFyIGU9YS5jYWxsKHRoaXMsZC5JRkQxLGMudGh1bWIpO2lmKFwiSlBFR0ludGVyY2hhbmdlRm9ybWF0XCJpbiBlKXJldHVybiB0aGlzLlNFR01FTlQoZC50aWZmSGVhZGVyK2UuSlBFR0ludGVyY2hhbmdlRm9ybWF0LGUuSlBFR0ludGVyY2hhbmdlRm9ybWF0TGVuZ3RoKX1jYXRjaCh0KXt9cmV0dXJuIG51bGx9LHNldEV4aWY6ZnVuY3Rpb24oZSx0KXtyZXR1cm5cIlBpeGVsWERpbWVuc2lvblwiIT09ZSYmXCJQaXhlbFlEaW1lbnNpb25cIiE9PWU/ITE6cy5jYWxsKHRoaXMsXCJleGlmXCIsZSx0KX0sY2xlYXI6ZnVuY3Rpb24oKXt1LmNsZWFyKCksbz1jPWw9aD1kPXU9bnVsbH19KSw2NTUwNSE9PXRoaXMuU0hPUlQoMCl8fFwiRVhJRlxcMFwiIT09dGhpcy5TVFJJTkcoNCw1KS50b1VwcGVyQ2FzZSgpKXRocm93IG5ldyBuLkltYWdlRXJyb3Iobi5JbWFnZUVycm9yLklOVkFMSURfTUVUQV9FUlIpO2lmKHRoaXMubGl0dGxlRW5kaWFuPTE4NzYxPT10aGlzLlNIT1JUKG0pLDQyIT09dGhpcy5TSE9SVChtKz0yKSl0aHJvdyBuZXcgbi5JbWFnZUVycm9yKG4uSW1hZ2VFcnJvci5JTlZBTElEX01FVEFfRVJSKTtkLklGRDA9ZC50aWZmSGVhZGVyK3RoaXMuTE9ORyhtKz0yKSxoPWEuY2FsbCh0aGlzLGQuSUZEMCxjLnRpZmYpLFwiRXhpZklGRFBvaW50ZXJcImluIGgmJihkLmV4aWZJRkQ9ZC50aWZmSGVhZGVyK2guRXhpZklGRFBvaW50ZXIsZGVsZXRlIGguRXhpZklGRFBvaW50ZXIpLFwiR1BTSW5mb0lGRFBvaW50ZXJcImluIGgmJihkLmdwc0lGRD1kLnRpZmZIZWFkZXIraC5HUFNJbmZvSUZEUG9pbnRlcixkZWxldGUgaC5HUFNJbmZvSUZEUG9pbnRlciksZS5pc0VtcHR5T2JqKGgpJiYoaD1udWxsKTt2YXIgZj10aGlzLkxPTkcoZC5JRkQwKzEyKnRoaXMuU0hPUlQoZC5JRkQwKSsyKTtmJiYoZC5JRkQxPWQudGlmZkhlYWRlcitmKX1yZXR1cm4gci5wcm90b3R5cGU9aS5wcm90b3R5cGUscn0pLG4oXCJtb3hpZS9ydW50aW1lL2h0bWw1L2ltYWdlL0pQRUdcIixbXCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCIsXCJtb3hpZS9jb3JlL0V4Y2VwdGlvbnNcIixcIm1veGllL3J1bnRpbWUvaHRtbDUvaW1hZ2UvSlBFR0hlYWRlcnNcIixcIm1veGllL3J1bnRpbWUvaHRtbDUvdXRpbHMvQmluYXJ5UmVhZGVyXCIsXCJtb3hpZS9ydW50aW1lL2h0bWw1L2ltYWdlL0V4aWZQYXJzZXJcIl0sZnVuY3Rpb24oZSx0LGksbixyKXtmdW5jdGlvbiBvKG8pe2Z1bmN0aW9uIGEoZSl7dmFyIHQsaSxuPTA7Zm9yKGV8fChlPWMpO248PWUubGVuZ3RoKCk7KXtpZih0PWUuU0hPUlQobis9MiksdD49NjU0NzImJjY1NDc1Pj10KXJldHVybiBuKz01LHtoZWlnaHQ6ZS5TSE9SVChuKSx3aWR0aDplLlNIT1JUKG4rPTIpfTtpPWUuU0hPUlQobis9Miksbis9aS0yfXJldHVybiBudWxsfWZ1bmN0aW9uIHMoKXt2YXIgZSx0LGk9ZC50aHVtYigpO3JldHVybiBpJiYoZT1uZXcgbihpKSx0PWEoZSksZS5jbGVhcigpLHQpPyh0LmRhdGE9aSx0KTpudWxsfWZ1bmN0aW9uIHUoKXtkJiZsJiZjJiYoZC5jbGVhcigpLGwucHVyZ2UoKSxjLmNsZWFyKCksbT1sPWQ9Yz1udWxsKX12YXIgYyxsLGQsbTtpZihjPW5ldyBuKG8pLDY1NDk2IT09Yy5TSE9SVCgwKSl0aHJvdyBuZXcgdC5JbWFnZUVycm9yKHQuSW1hZ2VFcnJvci5XUk9OR19GT1JNQVQpO2w9bmV3IGkobyk7dHJ5e2Q9bmV3IHIobC5nZXQoXCJhcHAxXCIpWzBdKX1jYXRjaChoKXt9bT1hLmNhbGwodGhpcyksZS5leHRlbmQodGhpcyx7dHlwZTpcImltYWdlL2pwZWdcIixzaXplOmMubGVuZ3RoKCksd2lkdGg6bSYmbS53aWR0aHx8MCxoZWlnaHQ6bSYmbS5oZWlnaHR8fDAsc2V0RXhpZjpmdW5jdGlvbih0LGkpe3JldHVybiBkPyhcIm9iamVjdFwiPT09ZS50eXBlT2YodCk/ZS5lYWNoKHQsZnVuY3Rpb24oZSx0KXtkLnNldEV4aWYodCxlKX0pOmQuc2V0RXhpZih0LGkpLGwuc2V0KFwiYXBwMVwiLGQuU0VHTUVOVCgpKSx2b2lkIDApOiExfSx3cml0ZUhlYWRlcnM6ZnVuY3Rpb24oKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD9sLnJlc3RvcmUoYXJndW1lbnRzWzBdKTpsLnJlc3RvcmUobyl9LHN0cmlwSGVhZGVyczpmdW5jdGlvbihlKXtyZXR1cm4gbC5zdHJpcChlKX0scHVyZ2U6ZnVuY3Rpb24oKXt1LmNhbGwodGhpcyl9fSksZCYmKHRoaXMubWV0YT17dGlmZjpkLlRJRkYoKSxleGlmOmQuRVhJRigpLGdwczpkLkdQUygpLHRodW1iOnMoKX0pfXJldHVybiBvfSksbihcIm1veGllL3J1bnRpbWUvaHRtbDUvaW1hZ2UvUE5HXCIsW1wibW94aWUvY29yZS9FeGNlcHRpb25zXCIsXCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCIsXCJtb3hpZS9ydW50aW1lL2h0bWw1L3V0aWxzL0JpbmFyeVJlYWRlclwiXSxmdW5jdGlvbihlLHQsaSl7ZnVuY3Rpb24gbihuKXtmdW5jdGlvbiByKCl7dmFyIGUsdDtyZXR1cm4gZT1hLmNhbGwodGhpcyw4KSxcIklIRFJcIj09ZS50eXBlPyh0PWUuc3RhcnQse3dpZHRoOnMuTE9ORyh0KSxoZWlnaHQ6cy5MT05HKHQrPTQpfSk6bnVsbH1mdW5jdGlvbiBvKCl7cyYmKHMuY2xlYXIoKSxuPWw9dT1jPXM9bnVsbCl9ZnVuY3Rpb24gYShlKXt2YXIgdCxpLG4scjtyZXR1cm4gdD1zLkxPTkcoZSksaT1zLlNUUklORyhlKz00LDQpLG49ZSs9NCxyPXMuTE9ORyhlK3QpLHtsZW5ndGg6dCx0eXBlOmksc3RhcnQ6bixDUkM6cn19dmFyIHMsdSxjLGw7cz1uZXcgaShuKSxmdW5jdGlvbigpe3ZhciB0PTAsaT0wLG49WzM1MTUyLDIwMDM5LDMzMzgsNjY2Nl07Zm9yKGk9MDtpPG4ubGVuZ3RoO2krKyx0Kz0yKWlmKG5baV0hPXMuU0hPUlQodCkpdGhyb3cgbmV3IGUuSW1hZ2VFcnJvcihlLkltYWdlRXJyb3IuV1JPTkdfRk9STUFUKX0oKSxsPXIuY2FsbCh0aGlzKSx0LmV4dGVuZCh0aGlzLHt0eXBlOlwiaW1hZ2UvcG5nXCIsc2l6ZTpzLmxlbmd0aCgpLHdpZHRoOmwud2lkdGgsaGVpZ2h0OmwuaGVpZ2h0LHB1cmdlOmZ1bmN0aW9uKCl7by5jYWxsKHRoaXMpfX0pLG8uY2FsbCh0aGlzKX1yZXR1cm4gbn0pLG4oXCJtb3hpZS9ydW50aW1lL2h0bWw1L2ltYWdlL0ltYWdlSW5mb1wiLFtcIm1veGllL2NvcmUvdXRpbHMvQmFzaWNcIixcIm1veGllL2NvcmUvRXhjZXB0aW9uc1wiLFwibW94aWUvcnVudGltZS9odG1sNS9pbWFnZS9KUEVHXCIsXCJtb3hpZS9ydW50aW1lL2h0bWw1L2ltYWdlL1BOR1wiXSxmdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gZnVuY3Rpb24ocil7dmFyIG8sYT1baSxuXTtvPWZ1bmN0aW9uKCl7Zm9yKHZhciBlPTA7ZTxhLmxlbmd0aDtlKyspdHJ5e3JldHVybiBuZXcgYVtlXShyKX1jYXRjaChpKXt9dGhyb3cgbmV3IHQuSW1hZ2VFcnJvcih0LkltYWdlRXJyb3IuV1JPTkdfRk9STUFUKX0oKSxlLmV4dGVuZCh0aGlzLHt0eXBlOlwiXCIsc2l6ZTowLHdpZHRoOjAsaGVpZ2h0OjAsc2V0RXhpZjpmdW5jdGlvbigpe30sd3JpdGVIZWFkZXJzOmZ1bmN0aW9uKGUpe3JldHVybiBlfSxzdHJpcEhlYWRlcnM6ZnVuY3Rpb24oZSl7cmV0dXJuIGV9LHB1cmdlOmZ1bmN0aW9uKCl7cj1udWxsfX0pLGUuZXh0ZW5kKHRoaXMsbyksdGhpcy5wdXJnZT1mdW5jdGlvbigpe28ucHVyZ2UoKSxvPW51bGx9fX0pLG4oXCJtb3hpZS9ydW50aW1lL2h0bWw1L2ltYWdlL1Jlc2l6ZXJDYW52YXNcIixbXSxmdW5jdGlvbigpe2Z1bmN0aW9uIGUoaSxuLHIpe3ZhciBvPWkud2lkdGg+aS5oZWlnaHQ/XCJ3aWR0aFwiOlwiaGVpZ2h0XCIsYT1NYXRoLnJvdW5kKGlbb10qbikscz0hMTtcIm5lYXJlc3RcIiE9PXImJiguNT5ufHxuPjIpJiYobj0uNT5uPy41OjIscz0hMCk7dmFyIHU9dChpLG4pO3JldHVybiBzP2UodSxhL3Vbb10scik6dX1mdW5jdGlvbiB0KGUsdCl7dmFyIGk9ZS53aWR0aCxuPWUuaGVpZ2h0LHI9TWF0aC5yb3VuZChpKnQpLG89TWF0aC5yb3VuZChuKnQpLGE9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKTtyZXR1cm4gYS53aWR0aD1yLGEuaGVpZ2h0PW8sYS5nZXRDb250ZXh0KFwiMmRcIikuZHJhd0ltYWdlKGUsMCwwLGksbiwwLDAscixvKSxlPW51bGwsYX1yZXR1cm57c2NhbGU6ZX19KSxuKFwibW94aWUvcnVudGltZS9odG1sNS9pbWFnZS9JbWFnZVwiLFtcIm1veGllL3J1bnRpbWUvaHRtbDUvUnVudGltZVwiLFwibW94aWUvY29yZS91dGlscy9CYXNpY1wiLFwibW94aWUvY29yZS9FeGNlcHRpb25zXCIsXCJtb3hpZS9jb3JlL3V0aWxzL0VuY29kZVwiLFwibW94aWUvZmlsZS9CbG9iXCIsXCJtb3hpZS9maWxlL0ZpbGVcIixcIm1veGllL3J1bnRpbWUvaHRtbDUvaW1hZ2UvSW1hZ2VJbmZvXCIsXCJtb3hpZS9ydW50aW1lL2h0bWw1L2ltYWdlL1Jlc2l6ZXJDYW52YXNcIixcIm1veGllL2NvcmUvdXRpbHMvTWltZVwiLFwibW94aWUvY29yZS91dGlscy9FbnZcIl0sZnVuY3Rpb24oZSx0LGksbixyLG8sYSxzLHUpe2Z1bmN0aW9uIGMoKXtmdW5jdGlvbiBlKCl7aWYoIXYmJiFnKXRocm93IG5ldyBpLkltYWdlRXJyb3IoaS5ET01FeGNlcHRpb24uSU5WQUxJRF9TVEFURV9FUlIpO3JldHVybiB2fHxnfWZ1bmN0aW9uIGMoKXt2YXIgdD1lKCk7cmV0dXJuXCJjYW52YXNcIj09dC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpP3Q6KHY9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKSx2LndpZHRoPXQud2lkdGgsdi5oZWlnaHQ9dC5oZWlnaHQsdi5nZXRDb250ZXh0KFwiMmRcIikuZHJhd0ltYWdlKHQsMCwwKSx2KX1mdW5jdGlvbiBsKGUpe3JldHVybiBuLmF0b2IoZS5zdWJzdHJpbmcoZS5pbmRleE9mKFwiYmFzZTY0LFwiKSs3KSl9ZnVuY3Rpb24gZChlLHQpe3JldHVyblwiZGF0YTpcIisodHx8XCJcIikrXCI7YmFzZTY0LFwiK24uYnRvYShlKX1mdW5jdGlvbiBtKGUpe3ZhciB0PXRoaXM7Zz1uZXcgSW1hZ2UsZy5vbmVycm9yPWZ1bmN0aW9uKCl7cC5jYWxsKHRoaXMpLHQudHJpZ2dlcihcImVycm9yXCIsaS5JbWFnZUVycm9yLldST05HX0ZPUk1BVCl9LGcub25sb2FkPWZ1bmN0aW9uKCl7dC50cmlnZ2VyKFwibG9hZFwiKX0sZy5zcmM9XCJkYXRhOlwiPT1lLnN1YnN0cigwLDUpP2U6ZChlLHkudHlwZSl9ZnVuY3Rpb24gaChlLHQpe3ZhciBuLHI9dGhpcztyZXR1cm4gd2luZG93LkZpbGVSZWFkZXI/KG49bmV3IEZpbGVSZWFkZXIsbi5vbmxvYWQ9ZnVuY3Rpb24oKXt0LmNhbGwocix0aGlzLnJlc3VsdCl9LG4ub25lcnJvcj1mdW5jdGlvbigpe3IudHJpZ2dlcihcImVycm9yXCIsaS5JbWFnZUVycm9yLldST05HX0ZPUk1BVCl9LG4ucmVhZEFzRGF0YVVSTChlKSx2b2lkIDApOnQuY2FsbCh0aGlzLGUuZ2V0QXNEYXRhVVJMKCkpfWZ1bmN0aW9uIGYoZSxpKXt2YXIgbj1NYXRoLlBJLzE4MCxyPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIiksbz1yLmdldENvbnRleHQoXCIyZFwiKSxhPWUud2lkdGgscz1lLmhlaWdodDtzd2l0Y2godC5pbkFycmF5KGksWzUsNiw3LDhdKT4tMT8oci53aWR0aD1zLHIuaGVpZ2h0PWEpOihyLndpZHRoPWEsci5oZWlnaHQ9cyksaSl7Y2FzZSAyOm8udHJhbnNsYXRlKGEsMCksby5zY2FsZSgtMSwxKTticmVhaztjYXNlIDM6by50cmFuc2xhdGUoYSxzKSxvLnJvdGF0ZSgxODAqbik7YnJlYWs7Y2FzZSA0Om8udHJhbnNsYXRlKDAscyksby5zY2FsZSgxLC0xKTticmVhaztjYXNlIDU6by5yb3RhdGUoOTAqbiksby5zY2FsZSgxLC0xKTticmVhaztjYXNlIDY6by5yb3RhdGUoOTAqbiksby50cmFuc2xhdGUoMCwtcyk7YnJlYWs7Y2FzZSA3Om8ucm90YXRlKDkwKm4pLG8udHJhbnNsYXRlKGEsLXMpLG8uc2NhbGUoLTEsMSk7YnJlYWs7Y2FzZSA4Om8ucm90YXRlKC05MCpuKSxvLnRyYW5zbGF0ZSgtYSwwKX1yZXR1cm4gby5kcmF3SW1hZ2UoZSwwLDAsYSxzKSxyfWZ1bmN0aW9uIHAoKXt4JiYoeC5wdXJnZSgpLHg9bnVsbCksdz1nPXY9eT1udWxsLGI9ITF9dmFyIGcseCx2LHcseSxFPXRoaXMsYj0hMSxfPSEwO3QuZXh0ZW5kKHRoaXMse2xvYWRGcm9tQmxvYjpmdW5jdGlvbihlKXt2YXIgdD10aGlzLmdldFJ1bnRpbWUoKSxuPWFyZ3VtZW50cy5sZW5ndGg+MT9hcmd1bWVudHNbMV06ITA7aWYoIXQuY2FuKFwiYWNjZXNzX2JpbmFyeVwiKSl0aHJvdyBuZXcgaS5SdW50aW1lRXJyb3IoaS5SdW50aW1lRXJyb3IuTk9UX1NVUFBPUlRFRF9FUlIpO3JldHVybiB5PWUsZS5pc0RldGFjaGVkKCk/KHc9ZS5nZXRTb3VyY2UoKSxtLmNhbGwodGhpcyx3KSx2b2lkIDApOihoLmNhbGwodGhpcyxlLmdldFNvdXJjZSgpLGZ1bmN0aW9uKGUpe24mJih3PWwoZSkpLG0uY2FsbCh0aGlzLGUpfSksdm9pZCAwKX0sbG9hZEZyb21JbWFnZTpmdW5jdGlvbihlLHQpe3RoaXMubWV0YT1lLm1ldGEseT1uZXcgbyhudWxsLHtuYW1lOmUubmFtZSxzaXplOmUuc2l6ZSx0eXBlOmUudHlwZX0pLG0uY2FsbCh0aGlzLHQ/dz1lLmdldEFzQmluYXJ5U3RyaW5nKCk6ZS5nZXRBc0RhdGFVUkwoKSl9LGdldEluZm86ZnVuY3Rpb24oKXt2YXIgdCxpPXRoaXMuZ2V0UnVudGltZSgpO3JldHVybiF4JiZ3JiZpLmNhbihcImFjY2Vzc19pbWFnZV9iaW5hcnlcIikmJih4PW5ldyBhKHcpKSx0PXt3aWR0aDplKCkud2lkdGh8fDAsaGVpZ2h0OmUoKS5oZWlnaHR8fDAsdHlwZTp5LnR5cGV8fHUuZ2V0RmlsZU1pbWUoeS5uYW1lKSxzaXplOncmJncubGVuZ3RofHx5LnNpemV8fDAsbmFtZTp5Lm5hbWV8fFwiXCIsbWV0YTpudWxsfSxfJiYodC5tZXRhPXgmJngubWV0YXx8dGhpcy5tZXRhfHx7fSwhdC5tZXRhfHwhdC5tZXRhLnRodW1ifHx0Lm1ldGEudGh1bWIuZGF0YSBpbnN0YW5jZW9mIHJ8fCh0Lm1ldGEudGh1bWIuZGF0YT1uZXcgcihudWxsLHt0eXBlOlwiaW1hZ2UvanBlZ1wiLGRhdGE6dC5tZXRhLnRodW1iLmRhdGF9KSkpLHR9LHJlc2l6ZTpmdW5jdGlvbih0LGksbil7dmFyIHI9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKTtpZihyLndpZHRoPXQud2lkdGgsci5oZWlnaHQ9dC5oZWlnaHQsci5nZXRDb250ZXh0KFwiMmRcIikuZHJhd0ltYWdlKGUoKSx0LngsdC55LHQud2lkdGgsdC5oZWlnaHQsMCwwLHIud2lkdGgsci5oZWlnaHQpLHY9cy5zY2FsZShyLGkpLF89bi5wcmVzZXJ2ZUhlYWRlcnMsIV8pe3ZhciBvPXRoaXMubWV0YSYmdGhpcy5tZXRhLnRpZmYmJnRoaXMubWV0YS50aWZmLk9yaWVudGF0aW9ufHwxO3Y9Zih2LG8pfXRoaXMud2lkdGg9di53aWR0aCx0aGlzLmhlaWdodD12LmhlaWdodCxiPSEwLHRoaXMudHJpZ2dlcihcIlJlc2l6ZVwiKX0sZ2V0QXNDYW52YXM6ZnVuY3Rpb24oKXtyZXR1cm4gdnx8KHY9YygpKSx2LmlkPXRoaXMudWlkK1wiX2NhbnZhc1wiLHZ9LGdldEFzQmxvYjpmdW5jdGlvbihlLHQpe3JldHVybiBlIT09dGhpcy50eXBlPyhiPSEwLG5ldyBvKG51bGwse25hbWU6eS5uYW1lfHxcIlwiLHR5cGU6ZSxkYXRhOkUuZ2V0QXNEYXRhVVJMKGUsdCl9KSk6bmV3IG8obnVsbCx7bmFtZTp5Lm5hbWV8fFwiXCIsdHlwZTplLGRhdGE6RS5nZXRBc0JpbmFyeVN0cmluZyhlLHQpfSl9LGdldEFzRGF0YVVSTDpmdW5jdGlvbihlKXt2YXIgdD1hcmd1bWVudHNbMV18fDkwO2lmKCFiKXJldHVybiBnLnNyYztpZihjKCksXCJpbWFnZS9qcGVnXCIhPT1lKXJldHVybiB2LnRvRGF0YVVSTChcImltYWdlL3BuZ1wiKTt0cnl7cmV0dXJuIHYudG9EYXRhVVJMKFwiaW1hZ2UvanBlZ1wiLHQvMTAwKX1jYXRjaChpKXtyZXR1cm4gdi50b0RhdGFVUkwoXCJpbWFnZS9qcGVnXCIpfX0sZ2V0QXNCaW5hcnlTdHJpbmc6ZnVuY3Rpb24oZSx0KXtpZighYilyZXR1cm4gd3x8KHc9bChFLmdldEFzRGF0YVVSTChlLHQpKSksdztpZihcImltYWdlL2pwZWdcIiE9PWUpdz1sKEUuZ2V0QXNEYXRhVVJMKGUsdCkpO2Vsc2V7dmFyIGk7dHx8KHQ9OTApLGMoKTt0cnl7aT12LnRvRGF0YVVSTChcImltYWdlL2pwZWdcIix0LzEwMCl9Y2F0Y2gobil7aT12LnRvRGF0YVVSTChcImltYWdlL2pwZWdcIil9dz1sKGkpLHgmJih3PXguc3RyaXBIZWFkZXJzKHcpLF8mJih4Lm1ldGEmJngubWV0YS5leGlmJiZ4LnNldEV4aWYoe1BpeGVsWERpbWVuc2lvbjp0aGlzLndpZHRoLFBpeGVsWURpbWVuc2lvbjp0aGlzLmhlaWdodH0pLHc9eC53cml0ZUhlYWRlcnModykpLHgucHVyZ2UoKSx4PW51bGwpfXJldHVybiBiPSExLHd9LGRlc3Ryb3k6ZnVuY3Rpb24oKXtFPW51bGwscC5jYWxsKHRoaXMpLHRoaXMuZ2V0UnVudGltZSgpLmdldFNoaW0oKS5yZW1vdmVJbnN0YW5jZSh0aGlzLnVpZCl9fSl9cmV0dXJuIGUuSW1hZ2U9Y30pLG4oXCJtb3hpZS9ydW50aW1lL2ZsYXNoL1J1bnRpbWVcIixbXCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCIsXCJtb3hpZS9jb3JlL3V0aWxzL0VudlwiLFwibW94aWUvY29yZS91dGlscy9Eb21cIixcIm1veGllL2NvcmUvRXhjZXB0aW9uc1wiLFwibW94aWUvcnVudGltZS9SdW50aW1lXCJdLGZ1bmN0aW9uKGUsdCxpLG4sbyl7ZnVuY3Rpb24gYSgpe3ZhciBlO3RyeXtlPW5hdmlnYXRvci5wbHVnaW5zW1wiU2hvY2t3YXZlIEZsYXNoXCJdLGU9ZS5kZXNjcmlwdGlvbn1jYXRjaCh0KXt0cnl7ZT1uZXcgQWN0aXZlWE9iamVjdChcIlNob2Nrd2F2ZUZsYXNoLlNob2Nrd2F2ZUZsYXNoXCIpLkdldFZhcmlhYmxlKFwiJHZlcnNpb25cIil9Y2F0Y2goaSl7ZT1cIjAuMFwifX1yZXR1cm4gZT1lLm1hdGNoKC9cXGQrL2cpLHBhcnNlRmxvYXQoZVswXStcIi5cIitlWzFdKX1mdW5jdGlvbiBzKGUpe3ZhciBuPWkuZ2V0KGUpO24mJlwiT0JKRUNUXCI9PW4ubm9kZU5hbWUmJihcIklFXCI9PT10LmJyb3dzZXI/KG4uc3R5bGUuZGlzcGxheT1cIm5vbmVcIixmdW5jdGlvbiByKCl7ND09bi5yZWFkeVN0YXRlP3UoZSk6c2V0VGltZW91dChyLDEwKX0oKSk6bi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG4pKX1mdW5jdGlvbiB1KGUpe3ZhciB0PWkuZ2V0KGUpO2lmKHQpe2Zvcih2YXIgbiBpbiB0KVwiZnVuY3Rpb25cIj09dHlwZW9mIHRbbl0mJih0W25dPW51bGwpO3QucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0KX19ZnVuY3Rpb24gYyh1KXt2YXIgYyxtPXRoaXM7dT1lLmV4dGVuZCh7c3dmX3VybDp0LnN3Zl91cmx9LHUpLG8uY2FsbCh0aGlzLHUsbCx7YWNjZXNzX2JpbmFyeTpmdW5jdGlvbihlKXtyZXR1cm4gZSYmXCJicm93c2VyXCI9PT1tLm1vZGV9LGFjY2Vzc19pbWFnZV9iaW5hcnk6ZnVuY3Rpb24oZSl7cmV0dXJuIGUmJlwiYnJvd3NlclwiPT09bS5tb2RlfSxkaXNwbGF5X21lZGlhOm8uY2FwVGVzdChyKFwibW94aWUvaW1hZ2UvSW1hZ2VcIikpLGRvX2NvcnM6by5jYXBUcnVlLGRyYWdfYW5kX2Ryb3A6ITEscmVwb3J0X3VwbG9hZF9wcm9ncmVzczpmdW5jdGlvbigpe3JldHVyblwiY2xpZW50XCI9PT1tLm1vZGV9LHJlc2l6ZV9pbWFnZTpvLmNhcFRydWUscmV0dXJuX3Jlc3BvbnNlX2hlYWRlcnM6ITEscmV0dXJuX3Jlc3BvbnNlX3R5cGU6ZnVuY3Rpb24odCl7cmV0dXJuXCJqc29uXCI9PT10JiZ3aW5kb3cuSlNPTj8hMDohZS5hcnJheURpZmYodCxbXCJcIixcInRleHRcIixcImRvY3VtZW50XCJdKXx8XCJicm93c2VyXCI9PT1tLm1vZGV9LHJldHVybl9zdGF0dXNfY29kZTpmdW5jdGlvbih0KXtyZXR1cm5cImJyb3dzZXJcIj09PW0ubW9kZXx8IWUuYXJyYXlEaWZmKHQsWzIwMCw0MDRdKX0sc2VsZWN0X2ZpbGU6by5jYXBUcnVlLHNlbGVjdF9tdWx0aXBsZTpvLmNhcFRydWUsc2VuZF9iaW5hcnlfc3RyaW5nOmZ1bmN0aW9uKGUpe3JldHVybiBlJiZcImJyb3dzZXJcIj09PW0ubW9kZX0sc2VuZF9icm93c2VyX2Nvb2tpZXM6ZnVuY3Rpb24oZSl7cmV0dXJuIGUmJlwiYnJvd3NlclwiPT09bS5tb2RlfSxzZW5kX2N1c3RvbV9oZWFkZXJzOmZ1bmN0aW9uKGUpe3JldHVybiBlJiZcImJyb3dzZXJcIj09PW0ubW9kZX0sc2VuZF9tdWx0aXBhcnQ6by5jYXBUcnVlLHNsaWNlX2Jsb2I6ZnVuY3Rpb24oZSl7cmV0dXJuIGUmJlwiYnJvd3NlclwiPT09bS5tb2RlfSxzdHJlYW1fdXBsb2FkOmZ1bmN0aW9uKGUpe3JldHVybiBlJiZcImJyb3dzZXJcIj09PW0ubW9kZX0sc3VtbW9uX2ZpbGVfZGlhbG9nOiExLHVwbG9hZF9maWxlc2l6ZTpmdW5jdGlvbih0KXtyZXR1cm4gZS5wYXJzZVNpemVTdHIodCk8PTIwOTcxNTJ8fFwiY2xpZW50XCI9PT1tLm1vZGV9LHVzZV9odHRwX21ldGhvZDpmdW5jdGlvbih0KXtyZXR1cm4hZS5hcnJheURpZmYodCxbXCJHRVRcIixcIlBPU1RcIl0pfX0se2FjY2Vzc19iaW5hcnk6ZnVuY3Rpb24oZSl7cmV0dXJuIGU/XCJicm93c2VyXCI6XCJjbGllbnRcIn0sYWNjZXNzX2ltYWdlX2JpbmFyeTpmdW5jdGlvbihlKXtyZXR1cm4gZT9cImJyb3dzZXJcIjpcImNsaWVudFwifSxyZXBvcnRfdXBsb2FkX3Byb2dyZXNzOmZ1bmN0aW9uKGUpe3JldHVybiBlP1wiYnJvd3NlclwiOlwiY2xpZW50XCJ9LHJldHVybl9yZXNwb25zZV90eXBlOmZ1bmN0aW9uKHQpe3JldHVybiBlLmFycmF5RGlmZih0LFtcIlwiLFwidGV4dFwiLFwianNvblwiLFwiZG9jdW1lbnRcIl0pP1wiYnJvd3NlclwiOltcImNsaWVudFwiLFwiYnJvd3NlclwiXX0scmV0dXJuX3N0YXR1c19jb2RlOmZ1bmN0aW9uKHQpe3JldHVybiBlLmFycmF5RGlmZih0LFsyMDAsNDA0XSk/XCJicm93c2VyXCI6W1wiY2xpZW50XCIsXCJicm93c2VyXCJdfSxzZW5kX2JpbmFyeV9zdHJpbmc6ZnVuY3Rpb24oZSl7cmV0dXJuIGU/XCJicm93c2VyXCI6XCJjbGllbnRcIn0sc2VuZF9icm93c2VyX2Nvb2tpZXM6ZnVuY3Rpb24oZSl7cmV0dXJuIGU/XCJicm93c2VyXCI6XCJjbGllbnRcIn0sc2VuZF9jdXN0b21faGVhZGVyczpmdW5jdGlvbihlKXtyZXR1cm4gZT9cImJyb3dzZXJcIjpcImNsaWVudFwifSxzbGljZV9ibG9iOmZ1bmN0aW9uKGUpe3JldHVybiBlP1wiYnJvd3NlclwiOlwiY2xpZW50XCJ9LHN0cmVhbV91cGxvYWQ6ZnVuY3Rpb24oZSl7cmV0dXJuIGU/XCJjbGllbnRcIjpcImJyb3dzZXJcIn0sdXBsb2FkX2ZpbGVzaXplOmZ1bmN0aW9uKHQpe3JldHVybiBlLnBhcnNlU2l6ZVN0cih0KT49MjA5NzE1Mj9cImNsaWVudFwiOlwiYnJvd3NlclwifX0sXCJjbGllbnRcIiksYSgpPDExLjMmJih0aGlzLm1vZGU9ITEpLGUuZXh0ZW5kKHRoaXMse2dldFNoaW06ZnVuY3Rpb24oKXtyZXR1cm4gaS5nZXQodGhpcy51aWQpfSxzaGltRXhlYzpmdW5jdGlvbihlLHQpe3ZhciBpPVtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLDIpO3JldHVybiBtLmdldFNoaW0oKS5leGVjKHRoaXMudWlkLGUsdCxpKX0saW5pdDpmdW5jdGlvbigpe3ZhciBpLHIsYTthPXRoaXMuZ2V0U2hpbUNvbnRhaW5lcigpLGUuZXh0ZW5kKGEuc3R5bGUse3Bvc2l0aW9uOlwiYWJzb2x1dGVcIix0b3A6XCItOHB4XCIsbGVmdDpcIi04cHhcIix3aWR0aDpcIjlweFwiLGhlaWdodDpcIjlweFwiLG92ZXJmbG93OlwiaGlkZGVuXCJ9KSxpPSc8b2JqZWN0IGlkPVwiJyt0aGlzLnVpZCsnXCIgdHlwZT1cImFwcGxpY2F0aW9uL3gtc2hvY2t3YXZlLWZsYXNoXCIgZGF0YT1cIicrdS5zd2ZfdXJsKydcIiAnLFwiSUVcIj09PXQuYnJvd3NlciYmKGkrPSdjbGFzc2lkPVwiY2xzaWQ6ZDI3Y2RiNmUtYWU2ZC0xMWNmLTk2YjgtNDQ0NTUzNTQwMDAwXCIgJyksaSs9J3dpZHRoPVwiMTAwJVwiIGhlaWdodD1cIjEwMCVcIiBzdHlsZT1cIm91dGxpbmU6MFwiPjxwYXJhbSBuYW1lPVwibW92aWVcIiB2YWx1ZT1cIicrdS5zd2ZfdXJsKydcIiAvPicrJzxwYXJhbSBuYW1lPVwiZmxhc2h2YXJzXCIgdmFsdWU9XCJ1aWQ9Jytlc2NhcGUodGhpcy51aWQpK1wiJnRhcmdldD1cIitvLmdldEdsb2JhbEV2ZW50VGFyZ2V0KCkrJ1wiIC8+JysnPHBhcmFtIG5hbWU9XCJ3bW9kZVwiIHZhbHVlPVwidHJhbnNwYXJlbnRcIiAvPicrJzxwYXJhbSBuYW1lPVwiYWxsb3dzY3JpcHRhY2Nlc3NcIiB2YWx1ZT1cImFsd2F5c1wiIC8+JytcIjwvb2JqZWN0PlwiLFwiSUVcIj09PXQuYnJvd3Nlcj8ocj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLGEuYXBwZW5kQ2hpbGQociksci5vdXRlckhUTUw9aSxyPWE9bnVsbCk6YS5pbm5lckhUTUw9aSxjPXNldFRpbWVvdXQoZnVuY3Rpb24oKXttJiYhbS5pbml0aWFsaXplZCYmbS50cmlnZ2VyKFwiRXJyb3JcIixuZXcgbi5SdW50aW1lRXJyb3Iobi5SdW50aW1lRXJyb3IuTk9UX0lOSVRfRVJSKSl9LDVlMyl9LGRlc3Ryb3k6ZnVuY3Rpb24oZSl7cmV0dXJuIGZ1bmN0aW9uKCl7cyhtLnVpZCksZS5jYWxsKG0pLGNsZWFyVGltZW91dChjKSx1PWM9ZT1tPW51bGx9fSh0aGlzLmRlc3Ryb3kpfSxkKX12YXIgbD1cImZsYXNoXCIsZD17fTtyZXR1cm4gby5hZGRDb25zdHJ1Y3RvcihsLGMpLGR9KSxuKFwibW94aWUvcnVudGltZS9mbGFzaC9maWxlL0Jsb2JcIixbXCJtb3hpZS9ydW50aW1lL2ZsYXNoL1J1bnRpbWVcIixcIm1veGllL2ZpbGUvQmxvYlwiXSxmdW5jdGlvbihlLHQpe3ZhciBpPXtzbGljZTpmdW5jdGlvbihlLGksbixyKXt2YXIgbz10aGlzLmdldFJ1bnRpbWUoKTtyZXR1cm4gMD5pP2k9TWF0aC5tYXgoZS5zaXplK2ksMCk6aT4wJiYoaT1NYXRoLm1pbihpLGUuc2l6ZSkpLDA+bj9uPU1hdGgubWF4KGUuc2l6ZStuLDApOm4+MCYmKG49TWF0aC5taW4obixlLnNpemUpKSxlPW8uc2hpbUV4ZWMuY2FsbCh0aGlzLFwiQmxvYlwiLFwic2xpY2VcIixpLG4scnx8XCJcIiksZSYmKGU9bmV3IHQoby51aWQsZSkpLGV9fTtyZXR1cm4gZS5CbG9iPWl9KSxuKFwibW94aWUvcnVudGltZS9mbGFzaC9maWxlL0ZpbGVJbnB1dFwiLFtcIm1veGllL3J1bnRpbWUvZmxhc2gvUnVudGltZVwiLFwibW94aWUvZmlsZS9GaWxlXCIsXCJtb3hpZS9jb3JlL3V0aWxzL0RvbVwiLFwibW94aWUvY29yZS91dGlscy9CYXNpY1wiXSxmdW5jdGlvbihlLHQsaSxuKXt2YXIgcj17aW5pdDpmdW5jdGlvbihlKXt2YXIgcj10aGlzLG89dGhpcy5nZXRSdW50aW1lKCksYT1pLmdldChlLmJyb3dzZV9idXR0b24pO2EmJihhLnNldEF0dHJpYnV0ZShcInRhYmluZGV4XCIsLTEpLGE9bnVsbCksdGhpcy5iaW5kKFwiQ2hhbmdlXCIsZnVuY3Rpb24oKXt2YXIgZT1vLnNoaW1FeGVjLmNhbGwocixcIkZpbGVJbnB1dFwiLFwiZ2V0RmlsZXNcIik7ci5maWxlcz1bXSxuLmVhY2goZSxmdW5jdGlvbihlKXtyLmZpbGVzLnB1c2gobmV3IHQoby51aWQsZSkpfSl9LDk5OSksdGhpcy5nZXRSdW50aW1lKCkuc2hpbUV4ZWMuY2FsbCh0aGlzLFwiRmlsZUlucHV0XCIsXCJpbml0XCIse2FjY2VwdDplLmFjY2VwdCxtdWx0aXBsZTplLm11bHRpcGxlfSksdGhpcy50cmlnZ2VyKFwicmVhZHlcIil9fTtyZXR1cm4gZS5GaWxlSW5wdXQ9cn0pLG4oXCJtb3hpZS9ydW50aW1lL2ZsYXNoL2ZpbGUvRmlsZVJlYWRlclwiLFtcIm1veGllL3J1bnRpbWUvZmxhc2gvUnVudGltZVwiLFwibW94aWUvY29yZS91dGlscy9FbmNvZGVcIl0sZnVuY3Rpb24oZSx0KXtmdW5jdGlvbiBpKGUsaSl7c3dpdGNoKGkpe2Nhc2VcInJlYWRBc1RleHRcIjpyZXR1cm4gdC5hdG9iKGUsXCJ1dGY4XCIpO2Nhc2VcInJlYWRBc0JpbmFyeVN0cmluZ1wiOnJldHVybiB0LmF0b2IoZSk7Y2FzZVwicmVhZEFzRGF0YVVSTFwiOnJldHVybiBlfXJldHVybiBudWxsfXZhciBuPXtyZWFkOmZ1bmN0aW9uKGUsdCl7dmFyIG49dGhpcztyZXR1cm4gbi5yZXN1bHQ9XCJcIixcInJlYWRBc0RhdGFVUkxcIj09PWUmJihuLnJlc3VsdD1cImRhdGE6XCIrKHQudHlwZXx8XCJcIikrXCI7YmFzZTY0LFwiKSxuLmJpbmQoXCJQcm9ncmVzc1wiLGZ1bmN0aW9uKHQscil7ciYmKG4ucmVzdWx0Kz1pKHIsZSkpfSw5OTkpLG4uZ2V0UnVudGltZSgpLnNoaW1FeGVjLmNhbGwodGhpcyxcIkZpbGVSZWFkZXJcIixcInJlYWRBc0Jhc2U2NFwiLHQudWlkKX19O3JldHVybiBlLkZpbGVSZWFkZXI9bn0pLG4oXCJtb3hpZS9ydW50aW1lL2ZsYXNoL2ZpbGUvRmlsZVJlYWRlclN5bmNcIixbXCJtb3hpZS9ydW50aW1lL2ZsYXNoL1J1bnRpbWVcIixcIm1veGllL2NvcmUvdXRpbHMvRW5jb2RlXCJdLGZ1bmN0aW9uKGUsdCl7ZnVuY3Rpb24gaShlLGkpe3N3aXRjaChpKXtjYXNlXCJyZWFkQXNUZXh0XCI6cmV0dXJuIHQuYXRvYihlLFwidXRmOFwiKTtjYXNlXCJyZWFkQXNCaW5hcnlTdHJpbmdcIjpyZXR1cm4gdC5hdG9iKGUpO2Nhc2VcInJlYWRBc0RhdGFVUkxcIjpyZXR1cm4gZX1yZXR1cm4gbnVsbH12YXIgbj17cmVhZDpmdW5jdGlvbihlLHQpe3ZhciBuLHI9dGhpcy5nZXRSdW50aW1lKCk7cmV0dXJuKG49ci5zaGltRXhlYy5jYWxsKHRoaXMsXCJGaWxlUmVhZGVyU3luY1wiLFwicmVhZEFzQmFzZTY0XCIsdC51aWQpKT8oXCJyZWFkQXNEYXRhVVJMXCI9PT1lJiYobj1cImRhdGE6XCIrKHQudHlwZXx8XCJcIikrXCI7YmFzZTY0LFwiK24pLGkobixlLHQudHlwZSkpOm51bGx9fTtyZXR1cm4gZS5GaWxlUmVhZGVyU3luYz1ufSksbihcIm1veGllL3J1bnRpbWUvZmxhc2gvcnVudGltZS9UcmFuc3BvcnRlclwiLFtcIm1veGllL3J1bnRpbWUvZmxhc2gvUnVudGltZVwiLFwibW94aWUvZmlsZS9CbG9iXCJdLGZ1bmN0aW9uKGUsdCl7dmFyIGk9e2dldEFzQmxvYjpmdW5jdGlvbihlKXt2YXIgaT10aGlzLmdldFJ1bnRpbWUoKSxuPWkuc2hpbUV4ZWMuY2FsbCh0aGlzLFwiVHJhbnNwb3J0ZXJcIixcImdldEFzQmxvYlwiLGUpO3JldHVybiBuP25ldyB0KGkudWlkLG4pOm51bGx9fTtyZXR1cm4gZS5UcmFuc3BvcnRlcj1pfSksbihcIm1veGllL3J1bnRpbWUvZmxhc2gveGhyL1hNTEh0dHBSZXF1ZXN0XCIsW1wibW94aWUvcnVudGltZS9mbGFzaC9SdW50aW1lXCIsXCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCIsXCJtb3hpZS9maWxlL0Jsb2JcIixcIm1veGllL2ZpbGUvRmlsZVwiLFwibW94aWUvZmlsZS9GaWxlUmVhZGVyU3luY1wiLFwibW94aWUvcnVudGltZS9mbGFzaC9maWxlL0ZpbGVSZWFkZXJTeW5jXCIsXCJtb3hpZS94aHIvRm9ybURhdGFcIixcIm1veGllL3J1bnRpbWUvVHJhbnNwb3J0ZXJcIixcIm1veGllL3J1bnRpbWUvZmxhc2gvcnVudGltZS9UcmFuc3BvcnRlclwiXSxmdW5jdGlvbihlLHQsaSxuLHIsbyxhLHMpe3ZhciB1PXtzZW5kOmZ1bmN0aW9uKGUsbil7ZnVuY3Rpb24gcigpe2UudHJhbnNwb3J0PWwubW9kZSxsLnNoaW1FeGVjLmNhbGwoYyxcIlhNTEh0dHBSZXF1ZXN0XCIsXCJzZW5kXCIsZSxuKX1mdW5jdGlvbiBvKGUsdCl7bC5zaGltRXhlYy5jYWxsKGMsXCJYTUxIdHRwUmVxdWVzdFwiLFwiYXBwZW5kQmxvYlwiLGUsdC51aWQpLG49bnVsbCxyKCl9ZnVuY3Rpb24gdShlLHQpe3ZhciBpPW5ldyBzO2kuYmluZChcIlRyYW5zcG9ydGluZ0NvbXBsZXRlXCIsZnVuY3Rpb24oKXt0KHRoaXMucmVzdWx0KX0pLGkudHJhbnNwb3J0KGUuZ2V0U291cmNlKCksZS50eXBlLHtydWlkOmwudWlkfSl9dmFyIGM9dGhpcyxsPWMuZ2V0UnVudGltZSgpO2lmKHQuaXNFbXB0eU9iaihlLmhlYWRlcnMpfHx0LmVhY2goZS5oZWFkZXJzLGZ1bmN0aW9uKGUsdCl7bC5zaGltRXhlYy5jYWxsKGMsXCJYTUxIdHRwUmVxdWVzdFwiLFwic2V0UmVxdWVzdEhlYWRlclwiLHQsZS50b1N0cmluZygpKX0pLG4gaW5zdGFuY2VvZiBhKXt2YXIgZDtpZihuLmVhY2goZnVuY3Rpb24oZSx0KXtlIGluc3RhbmNlb2YgaT9kPXQ6bC5zaGltRXhlYy5jYWxsKGMsXCJYTUxIdHRwUmVxdWVzdFwiLFwiYXBwZW5kXCIsdCxlKX0pLG4uaGFzQmxvYigpKXt2YXIgbT1uLmdldEJsb2IoKTttLmlzRGV0YWNoZWQoKT91KG0sZnVuY3Rpb24oZSl7bS5kZXN0cm95KCksbyhkLGUpfSk6byhkLG0pfWVsc2Ugbj1udWxsLHIoKX1lbHNlIG4gaW5zdGFuY2VvZiBpP24uaXNEZXRhY2hlZCgpP3UobixmdW5jdGlvbihlKXtuLmRlc3Ryb3koKSxuPWUudWlkLHIoKX0pOihuPW4udWlkLHIoKSk6cigpfSxnZXRSZXNwb25zZTpmdW5jdGlvbihlKXt2YXIgaSxvLGE9dGhpcy5nZXRSdW50aW1lKCk7aWYobz1hLnNoaW1FeGVjLmNhbGwodGhpcyxcIlhNTEh0dHBSZXF1ZXN0XCIsXCJnZXRSZXNwb25zZUFzQmxvYlwiKSl7aWYobz1uZXcgbihhLnVpZCxvKSxcImJsb2JcIj09PWUpcmV0dXJuIG87dHJ5e2lmKGk9bmV3IHIsfnQuaW5BcnJheShlLFtcIlwiLFwidGV4dFwiXSkpcmV0dXJuIGkucmVhZEFzVGV4dChvKTtpZihcImpzb25cIj09PWUmJndpbmRvdy5KU09OKXJldHVybiBKU09OLnBhcnNlKGkucmVhZEFzVGV4dChvKSl9ZmluYWxseXtvLmRlc3Ryb3koKX19cmV0dXJuIG51bGx9LGFib3J0OmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5nZXRSdW50aW1lKCk7ZS5zaGltRXhlYy5jYWxsKHRoaXMsXCJYTUxIdHRwUmVxdWVzdFwiLFwiYWJvcnRcIiksdGhpcy5kaXNwYXRjaEV2ZW50KFwicmVhZHlzdGF0ZWNoYW5nZVwiKSx0aGlzLmRpc3BhdGNoRXZlbnQoXCJhYm9ydFwiKX19O3JldHVybiBlLlhNTEh0dHBSZXF1ZXN0PXV9KSxuKFwibW94aWUvcnVudGltZS9mbGFzaC9pbWFnZS9JbWFnZVwiLFtcIm1veGllL3J1bnRpbWUvZmxhc2gvUnVudGltZVwiLFwibW94aWUvY29yZS91dGlscy9CYXNpY1wiLFwibW94aWUvcnVudGltZS9UcmFuc3BvcnRlclwiLFwibW94aWUvZmlsZS9CbG9iXCIsXCJtb3hpZS9maWxlL0ZpbGVSZWFkZXJTeW5jXCJdLGZ1bmN0aW9uKGUsdCxpLG4scil7dmFyIG89e2xvYWRGcm9tQmxvYjpmdW5jdGlvbihlKXtmdW5jdGlvbiB0KGUpe3Iuc2hpbUV4ZWMuY2FsbChuLFwiSW1hZ2VcIixcImxvYWRGcm9tQmxvYlwiLGUudWlkKSxuPXI9bnVsbH12YXIgbj10aGlzLHI9bi5nZXRSdW50aW1lKCk7aWYoZS5pc0RldGFjaGVkKCkpe3ZhciBvPW5ldyBpO28uYmluZChcIlRyYW5zcG9ydGluZ0NvbXBsZXRlXCIsZnVuY3Rpb24oKXt0KG8ucmVzdWx0LmdldFNvdXJjZSgpKX0pLG8udHJhbnNwb3J0KGUuZ2V0U291cmNlKCksZS50eXBlLHtydWlkOnIudWlkfSl9ZWxzZSB0KGUuZ2V0U291cmNlKCkpfSxsb2FkRnJvbUltYWdlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuZ2V0UnVudGltZSgpO3JldHVybiB0LnNoaW1FeGVjLmNhbGwodGhpcyxcIkltYWdlXCIsXCJsb2FkRnJvbUltYWdlXCIsZS51aWQpfSxnZXRJbmZvOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5nZXRSdW50aW1lKCksdD1lLnNoaW1FeGVjLmNhbGwodGhpcyxcIkltYWdlXCIsXCJnZXRJbmZvXCIpO3JldHVybiB0Lm1ldGEmJnQubWV0YS50aHVtYiYmdC5tZXRhLnRodW1iLmRhdGEmJiEoZS5tZXRhLnRodW1iLmRhdGEgaW5zdGFuY2VvZiBuKSYmKHQubWV0YS50aHVtYi5kYXRhPW5ldyBuKGUudWlkLHQubWV0YS50aHVtYi5kYXRhKSksdH0sZ2V0QXNCbG9iOmZ1bmN0aW9uKGUsdCl7dmFyIGk9dGhpcy5nZXRSdW50aW1lKCkscj1pLnNoaW1FeGVjLmNhbGwodGhpcyxcIkltYWdlXCIsXCJnZXRBc0Jsb2JcIixlLHQpO3JldHVybiByP25ldyBuKGkudWlkLHIpOm51bGx9LGdldEFzRGF0YVVSTDpmdW5jdGlvbigpe3ZhciBlLHQ9dGhpcy5nZXRSdW50aW1lKCksaT10LkltYWdlLmdldEFzQmxvYi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuIGk/KGU9bmV3IHIsZS5yZWFkQXNEYXRhVVJMKGkpKTpudWxsfX07cmV0dXJuIGUuSW1hZ2U9b30pLG4oXCJtb3hpZS9ydW50aW1lL3NpbHZlcmxpZ2h0L1J1bnRpbWVcIixbXCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCIsXCJtb3hpZS9jb3JlL3V0aWxzL0VudlwiLFwibW94aWUvY29yZS91dGlscy9Eb21cIixcIm1veGllL2NvcmUvRXhjZXB0aW9uc1wiLFwibW94aWUvcnVudGltZS9SdW50aW1lXCJdLGZ1bmN0aW9uKGUsdCxpLG4sbyl7ZnVuY3Rpb24gYShlKXt2YXIgdCxpLG4scixvLGE9ITEscz1udWxsLHU9MDt0cnl7dHJ5e3M9bmV3IEFjdGl2ZVhPYmplY3QoXCJBZ0NvbnRyb2wuQWdDb250cm9sXCIpLHMuSXNWZXJzaW9uU3VwcG9ydGVkKGUpJiYoYT0hMCkscz1udWxsfWNhdGNoKGMpe3ZhciBsPW5hdmlnYXRvci5wbHVnaW5zW1wiU2lsdmVybGlnaHQgUGx1Zy1JblwiXTtpZihsKXtmb3IodD1sLmRlc2NyaXB0aW9uLFwiMS4wLjMwMjI2LjJcIj09PXQmJih0PVwiMi4wLjMwMjI2LjJcIiksaT10LnNwbGl0KFwiLlwiKTtpLmxlbmd0aD4zOylpLnBvcCgpO2Zvcig7aS5sZW5ndGg8NDspaS5wdXNoKDApO2ZvcihuPWUuc3BsaXQoXCIuXCIpO24ubGVuZ3RoPjQ7KW4ucG9wKCk7ZG8gcj1wYXJzZUludChuW3VdLDEwKSxvPXBhcnNlSW50KGlbdV0sMTApLHUrKzt3aGlsZSh1PG4ubGVuZ3RoJiZyPT09byk7bz49ciYmIWlzTmFOKHIpJiYoYT0hMCl9fX1jYXRjaChkKXthPSExfXJldHVybiBhfWZ1bmN0aW9uIHMocyl7dmFyIGwsZD10aGlzO3M9ZS5leHRlbmQoe3hhcF91cmw6dC54YXBfdXJsfSxzKSxvLmNhbGwodGhpcyxzLHUse2FjY2Vzc19iaW5hcnk6by5jYXBUcnVlLGFjY2Vzc19pbWFnZV9iaW5hcnk6by5jYXBUcnVlLGRpc3BsYXlfbWVkaWE6by5jYXBUZXN0KHIoXCJtb3hpZS9pbWFnZS9JbWFnZVwiKSksZG9fY29yczpvLmNhcFRydWUsZHJhZ19hbmRfZHJvcDohMSxyZXBvcnRfdXBsb2FkX3Byb2dyZXNzOm8uY2FwVHJ1ZSxyZXNpemVfaW1hZ2U6by5jYXBUcnVlLHJldHVybl9yZXNwb25zZV9oZWFkZXJzOmZ1bmN0aW9uKGUpe3JldHVybiBlJiZcImNsaWVudFwiPT09ZC5tb2RlfSxyZXR1cm5fcmVzcG9uc2VfdHlwZTpmdW5jdGlvbihlKXtyZXR1cm5cImpzb25cIiE9PWU/ITA6ISF3aW5kb3cuSlNPTn0scmV0dXJuX3N0YXR1c19jb2RlOmZ1bmN0aW9uKHQpe3JldHVyblwiY2xpZW50XCI9PT1kLm1vZGV8fCFlLmFycmF5RGlmZih0LFsyMDAsNDA0XSl9LHNlbGVjdF9maWxlOm8uY2FwVHJ1ZSxzZWxlY3RfbXVsdGlwbGU6by5jYXBUcnVlLHNlbmRfYmluYXJ5X3N0cmluZzpvLmNhcFRydWUsc2VuZF9icm93c2VyX2Nvb2tpZXM6ZnVuY3Rpb24oZSl7cmV0dXJuIGUmJlwiYnJvd3NlclwiPT09ZC5tb2RlfSxzZW5kX2N1c3RvbV9oZWFkZXJzOmZ1bmN0aW9uKGUpe3JldHVybiBlJiZcImNsaWVudFwiPT09ZC5tb2RlfSxzZW5kX211bHRpcGFydDpvLmNhcFRydWUsc2xpY2VfYmxvYjpvLmNhcFRydWUsc3RyZWFtX3VwbG9hZDohMCxzdW1tb25fZmlsZV9kaWFsb2c6ITEsdXBsb2FkX2ZpbGVzaXplOm8uY2FwVHJ1ZSx1c2VfaHR0cF9tZXRob2Q6ZnVuY3Rpb24odCl7cmV0dXJuXCJjbGllbnRcIj09PWQubW9kZXx8IWUuYXJyYXlEaWZmKHQsW1wiR0VUXCIsXCJQT1NUXCJdKX19LHtyZXR1cm5fcmVzcG9uc2VfaGVhZGVyczpmdW5jdGlvbihlKXtyZXR1cm4gZT9cImNsaWVudFwiOlwiYnJvd3NlclwifSxyZXR1cm5fc3RhdHVzX2NvZGU6ZnVuY3Rpb24odCl7cmV0dXJuIGUuYXJyYXlEaWZmKHQsWzIwMCw0MDRdKT9cImNsaWVudFwiOltcImNsaWVudFwiLFwiYnJvd3NlclwiXX0sc2VuZF9icm93c2VyX2Nvb2tpZXM6ZnVuY3Rpb24oZSl7cmV0dXJuIGU/XCJicm93c2VyXCI6XCJjbGllbnRcIn0sc2VuZF9jdXN0b21faGVhZGVyczpmdW5jdGlvbihlKXtyZXR1cm4gZT9cImNsaWVudFwiOlwiYnJvd3NlclwifSx1c2VfaHR0cF9tZXRob2Q6ZnVuY3Rpb24odCl7cmV0dXJuIGUuYXJyYXlEaWZmKHQsW1wiR0VUXCIsXCJQT1NUXCJdKT9cImNsaWVudFwiOltcImNsaWVudFwiLFwiYnJvd3NlclwiXX19KSxhKFwiMi4wLjMxMDA1LjBcIikmJlwiT3BlcmFcIiE9PXQuYnJvd3Nlcnx8KHRoaXMubW9kZT0hMSksZS5leHRlbmQodGhpcyx7Z2V0U2hpbTpmdW5jdGlvbigpe3JldHVybiBpLmdldCh0aGlzLnVpZCkuY29udGVudC5Nb3hpZX0sc2hpbUV4ZWM6ZnVuY3Rpb24oZSx0KXt2YXIgaT1bXS5zbGljZS5jYWxsKGFyZ3VtZW50cywyKTtyZXR1cm4gZC5nZXRTaGltKCkuZXhlYyh0aGlzLnVpZCxlLHQsaSl9LGluaXQ6ZnVuY3Rpb24oKXt2YXIgZTtlPXRoaXMuZ2V0U2hpbUNvbnRhaW5lcigpLGUuaW5uZXJIVE1MPSc8b2JqZWN0IGlkPVwiJyt0aGlzLnVpZCsnXCIgZGF0YT1cImRhdGE6YXBwbGljYXRpb24veC1zaWx2ZXJsaWdodCxcIiB0eXBlPVwiYXBwbGljYXRpb24veC1zaWx2ZXJsaWdodC0yXCIgd2lkdGg9XCIxMDAlXCIgaGVpZ2h0PVwiMTAwJVwiIHN0eWxlPVwib3V0bGluZTpub25lO1wiPicrJzxwYXJhbSBuYW1lPVwic291cmNlXCIgdmFsdWU9XCInK3MueGFwX3VybCsnXCIvPicrJzxwYXJhbSBuYW1lPVwiYmFja2dyb3VuZFwiIHZhbHVlPVwiVHJhbnNwYXJlbnRcIi8+JysnPHBhcmFtIG5hbWU9XCJ3aW5kb3dsZXNzXCIgdmFsdWU9XCJ0cnVlXCIvPicrJzxwYXJhbSBuYW1lPVwiZW5hYmxlaHRtbGFjY2Vzc1wiIHZhbHVlPVwidHJ1ZVwiLz4nKyc8cGFyYW0gbmFtZT1cImluaXRQYXJhbXNcIiB2YWx1ZT1cInVpZD0nK3RoaXMudWlkK1wiLHRhcmdldD1cIitvLmdldEdsb2JhbEV2ZW50VGFyZ2V0KCkrJ1wiLz4nK1wiPC9vYmplY3Q+XCIsbD1zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7ZCYmIWQuaW5pdGlhbGl6ZWQmJmQudHJpZ2dlcihcIkVycm9yXCIsbmV3IG4uUnVudGltZUVycm9yKG4uUnVudGltZUVycm9yLk5PVF9JTklUX0VSUikpfSxcIldpbmRvd3NcIiE9PXQuT1M/MWU0OjVlMyl9LGRlc3Ryb3k6ZnVuY3Rpb24oZSl7cmV0dXJuIGZ1bmN0aW9uKCl7ZS5jYWxsKGQpLGNsZWFyVGltZW91dChsKSxzPWw9ZT1kPW51bGx9fSh0aGlzLmRlc3Ryb3kpfSxjKX12YXIgdT1cInNpbHZlcmxpZ2h0XCIsYz17fTtyZXR1cm4gby5hZGRDb25zdHJ1Y3Rvcih1LHMpLGN9KSxuKFwibW94aWUvcnVudGltZS9zaWx2ZXJsaWdodC9maWxlL0Jsb2JcIixbXCJtb3hpZS9ydW50aW1lL3NpbHZlcmxpZ2h0L1J1bnRpbWVcIixcIm1veGllL2NvcmUvdXRpbHMvQmFzaWNcIixcIm1veGllL3J1bnRpbWUvZmxhc2gvZmlsZS9CbG9iXCJdLGZ1bmN0aW9uKGUsdCxpKXtyZXR1cm4gZS5CbG9iPXQuZXh0ZW5kKHt9LGkpfSksbihcIm1veGllL3J1bnRpbWUvc2lsdmVybGlnaHQvZmlsZS9GaWxlSW5wdXRcIixbXCJtb3hpZS9ydW50aW1lL3NpbHZlcmxpZ2h0L1J1bnRpbWVcIixcIm1veGllL2ZpbGUvRmlsZVwiLFwibW94aWUvY29yZS91dGlscy9Eb21cIixcIm1veGllL2NvcmUvdXRpbHMvQmFzaWNcIl0sZnVuY3Rpb24oZSx0LGksbil7ZnVuY3Rpb24gcihlKXtmb3IodmFyIHQ9XCJcIixpPTA7aTxlLmxlbmd0aDtpKyspdCs9KFwiXCIhPT10P1wifFwiOlwiXCIpK2VbaV0udGl0bGUrXCIgfCAqLlwiK2VbaV0uZXh0ZW5zaW9ucy5yZXBsYWNlKC8sL2csXCI7Ki5cIik7cmV0dXJuIHR9dmFyIG89e2luaXQ6ZnVuY3Rpb24oZSl7dmFyIG89dGhpcyxhPXRoaXMuZ2V0UnVudGltZSgpLHM9aS5nZXQoZS5icm93c2VfYnV0dG9uKTtzJiYocy5zZXRBdHRyaWJ1dGUoXCJ0YWJpbmRleFwiLC0xKSxzPW51bGwpLHRoaXMuYmluZChcIkNoYW5nZVwiLGZ1bmN0aW9uKCl7dmFyIGU9YS5zaGltRXhlYy5jYWxsKG8sXCJGaWxlSW5wdXRcIixcImdldEZpbGVzXCIpO1xuby5maWxlcz1bXSxuLmVhY2goZSxmdW5jdGlvbihlKXtvLmZpbGVzLnB1c2gobmV3IHQoYS51aWQsZSkpfSl9LDk5OSksYS5zaGltRXhlYy5jYWxsKHRoaXMsXCJGaWxlSW5wdXRcIixcImluaXRcIixyKGUuYWNjZXB0KSxlLm11bHRpcGxlKSx0aGlzLnRyaWdnZXIoXCJyZWFkeVwiKX0sc2V0T3B0aW9uOmZ1bmN0aW9uKGUsdCl7XCJhY2NlcHRcIj09ZSYmKHQ9cih0KSksdGhpcy5nZXRSdW50aW1lKCkuc2hpbUV4ZWMuY2FsbCh0aGlzLFwiRmlsZUlucHV0XCIsXCJzZXRPcHRpb25cIixlLHQpfX07cmV0dXJuIGUuRmlsZUlucHV0PW99KSxuKFwibW94aWUvcnVudGltZS9zaWx2ZXJsaWdodC9maWxlL0ZpbGVEcm9wXCIsW1wibW94aWUvcnVudGltZS9zaWx2ZXJsaWdodC9SdW50aW1lXCIsXCJtb3hpZS9jb3JlL3V0aWxzL0RvbVwiLFwibW94aWUvY29yZS91dGlscy9FdmVudHNcIl0sZnVuY3Rpb24oZSx0LGkpe3ZhciBuPXtpbml0OmZ1bmN0aW9uKCl7dmFyIGUsbj10aGlzLHI9bi5nZXRSdW50aW1lKCk7cmV0dXJuIGU9ci5nZXRTaGltQ29udGFpbmVyKCksaS5hZGRFdmVudChlLFwiZHJhZ292ZXJcIixmdW5jdGlvbihlKXtlLnByZXZlbnREZWZhdWx0KCksZS5zdG9wUHJvcGFnYXRpb24oKSxlLmRhdGFUcmFuc2Zlci5kcm9wRWZmZWN0PVwiY29weVwifSxuLnVpZCksaS5hZGRFdmVudChlLFwiZHJhZ2VudGVyXCIsZnVuY3Rpb24oZSl7ZS5wcmV2ZW50RGVmYXVsdCgpO3ZhciBpPXQuZ2V0KHIudWlkKS5kcmFnRW50ZXIoZSk7aSYmZS5zdG9wUHJvcGFnYXRpb24oKX0sbi51aWQpLGkuYWRkRXZlbnQoZSxcImRyb3BcIixmdW5jdGlvbihlKXtlLnByZXZlbnREZWZhdWx0KCk7dmFyIGk9dC5nZXQoci51aWQpLmRyYWdEcm9wKGUpO2kmJmUuc3RvcFByb3BhZ2F0aW9uKCl9LG4udWlkKSxyLnNoaW1FeGVjLmNhbGwodGhpcyxcIkZpbGVEcm9wXCIsXCJpbml0XCIpfX07cmV0dXJuIGUuRmlsZURyb3A9bn0pLG4oXCJtb3hpZS9ydW50aW1lL3NpbHZlcmxpZ2h0L2ZpbGUvRmlsZVJlYWRlclwiLFtcIm1veGllL3J1bnRpbWUvc2lsdmVybGlnaHQvUnVudGltZVwiLFwibW94aWUvY29yZS91dGlscy9CYXNpY1wiLFwibW94aWUvcnVudGltZS9mbGFzaC9maWxlL0ZpbGVSZWFkZXJcIl0sZnVuY3Rpb24oZSx0LGkpe3JldHVybiBlLkZpbGVSZWFkZXI9dC5leHRlbmQoe30saSl9KSxuKFwibW94aWUvcnVudGltZS9zaWx2ZXJsaWdodC9maWxlL0ZpbGVSZWFkZXJTeW5jXCIsW1wibW94aWUvcnVudGltZS9zaWx2ZXJsaWdodC9SdW50aW1lXCIsXCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCIsXCJtb3hpZS9ydW50aW1lL2ZsYXNoL2ZpbGUvRmlsZVJlYWRlclN5bmNcIl0sZnVuY3Rpb24oZSx0LGkpe3JldHVybiBlLkZpbGVSZWFkZXJTeW5jPXQuZXh0ZW5kKHt9LGkpfSksbihcIm1veGllL3J1bnRpbWUvc2lsdmVybGlnaHQvcnVudGltZS9UcmFuc3BvcnRlclwiLFtcIm1veGllL3J1bnRpbWUvc2lsdmVybGlnaHQvUnVudGltZVwiLFwibW94aWUvY29yZS91dGlscy9CYXNpY1wiLFwibW94aWUvcnVudGltZS9mbGFzaC9ydW50aW1lL1RyYW5zcG9ydGVyXCJdLGZ1bmN0aW9uKGUsdCxpKXtyZXR1cm4gZS5UcmFuc3BvcnRlcj10LmV4dGVuZCh7fSxpKX0pLG4oXCJtb3hpZS9ydW50aW1lL3NpbHZlcmxpZ2h0L3hoci9YTUxIdHRwUmVxdWVzdFwiLFtcIm1veGllL3J1bnRpbWUvc2lsdmVybGlnaHQvUnVudGltZVwiLFwibW94aWUvY29yZS91dGlscy9CYXNpY1wiLFwibW94aWUvcnVudGltZS9mbGFzaC94aHIvWE1MSHR0cFJlcXVlc3RcIixcIm1veGllL3J1bnRpbWUvc2lsdmVybGlnaHQvZmlsZS9GaWxlUmVhZGVyU3luY1wiLFwibW94aWUvcnVudGltZS9zaWx2ZXJsaWdodC9ydW50aW1lL1RyYW5zcG9ydGVyXCJdLGZ1bmN0aW9uKGUsdCxpKXtyZXR1cm4gZS5YTUxIdHRwUmVxdWVzdD10LmV4dGVuZCh7fSxpKX0pLG4oXCJtb3hpZS9ydW50aW1lL3NpbHZlcmxpZ2h0L2ltYWdlL0ltYWdlXCIsW1wibW94aWUvcnVudGltZS9zaWx2ZXJsaWdodC9SdW50aW1lXCIsXCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCIsXCJtb3hpZS9maWxlL0Jsb2JcIixcIm1veGllL3J1bnRpbWUvZmxhc2gvaW1hZ2UvSW1hZ2VcIl0sZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIGUuSW1hZ2U9dC5leHRlbmQoe30sbix7Z2V0SW5mbzpmdW5jdGlvbigpe3ZhciBlPXRoaXMuZ2V0UnVudGltZSgpLG49W1widGlmZlwiLFwiZXhpZlwiLFwiZ3BzXCIsXCJ0aHVtYlwiXSxyPXttZXRhOnt9fSxvPWUuc2hpbUV4ZWMuY2FsbCh0aGlzLFwiSW1hZ2VcIixcImdldEluZm9cIik7cmV0dXJuIG8ubWV0YSYmKHQuZWFjaChuLGZ1bmN0aW9uKGUpe3ZhciB0LGksbixhLHM9by5tZXRhW2VdO2lmKHMmJnMua2V5cylmb3Ioci5tZXRhW2VdPXt9LGk9MCxuPXMua2V5cy5sZW5ndGg7bj5pO2krKyl0PXMua2V5c1tpXSxhPXNbdF0sYSYmKC9eKFxcZHxbMS05XVxcZCspJC8udGVzdChhKT9hPXBhcnNlSW50KGEsMTApOi9eXFxkKlxcLlxcZCskLy50ZXN0KGEpJiYoYT1wYXJzZUZsb2F0KGEpKSxyLm1ldGFbZV1bdF09YSl9KSxyLm1ldGEmJnIubWV0YS50aHVtYiYmci5tZXRhLnRodW1iLmRhdGEmJiEoZS5tZXRhLnRodW1iLmRhdGEgaW5zdGFuY2VvZiBpKSYmKHIubWV0YS50aHVtYi5kYXRhPW5ldyBpKGUudWlkLHIubWV0YS50aHVtYi5kYXRhKSkpLHIud2lkdGg9cGFyc2VJbnQoby53aWR0aCwxMCksci5oZWlnaHQ9cGFyc2VJbnQoby5oZWlnaHQsMTApLHIuc2l6ZT1wYXJzZUludChvLnNpemUsMTApLHIudHlwZT1vLnR5cGUsci5uYW1lPW8ubmFtZSxyfSxyZXNpemU6ZnVuY3Rpb24oZSx0LGkpe3RoaXMuZ2V0UnVudGltZSgpLnNoaW1FeGVjLmNhbGwodGhpcyxcIkltYWdlXCIsXCJyZXNpemVcIixlLngsZS55LGUud2lkdGgsZS5oZWlnaHQsdCxpLnByZXNlcnZlSGVhZGVycyxpLnJlc2FtcGxlKX19KX0pLG4oXCJtb3hpZS9ydW50aW1lL2h0bWw0L1J1bnRpbWVcIixbXCJtb3hpZS9jb3JlL3V0aWxzL0Jhc2ljXCIsXCJtb3hpZS9jb3JlL0V4Y2VwdGlvbnNcIixcIm1veGllL3J1bnRpbWUvUnVudGltZVwiLFwibW94aWUvY29yZS91dGlscy9FbnZcIl0sZnVuY3Rpb24oZSx0LGksbil7ZnVuY3Rpb24gbyh0KXt2YXIgbz10aGlzLHU9aS5jYXBUZXN0LGM9aS5jYXBUcnVlO2kuY2FsbCh0aGlzLHQsYSx7YWNjZXNzX2JpbmFyeTp1KHdpbmRvdy5GaWxlUmVhZGVyfHx3aW5kb3cuRmlsZSYmRmlsZS5nZXRBc0RhdGFVUkwpLGFjY2Vzc19pbWFnZV9iaW5hcnk6ITEsZGlzcGxheV9tZWRpYTp1KChuLmNhbihcImNyZWF0ZV9jYW52YXNcIil8fG4uY2FuKFwidXNlX2RhdGFfdXJpX292ZXIzMmtiXCIpKSYmcihcIm1veGllL2ltYWdlL0ltYWdlXCIpKSxkb19jb3JzOiExLGRyYWdfYW5kX2Ryb3A6ITEsZmlsdGVyX2J5X2V4dGVuc2lvbjp1KGZ1bmN0aW9uKCl7cmV0dXJuIShcIkNocm9tZVwiPT09bi5icm93c2VyJiZuLnZlckNvbXAobi52ZXJzaW9uLDI4LFwiPFwiKXx8XCJJRVwiPT09bi5icm93c2VyJiZuLnZlckNvbXAobi52ZXJzaW9uLDEwLFwiPFwiKXx8XCJTYWZhcmlcIj09PW4uYnJvd3NlciYmbi52ZXJDb21wKG4udmVyc2lvbiw3LFwiPFwiKXx8XCJGaXJlZm94XCI9PT1uLmJyb3dzZXImJm4udmVyQ29tcChuLnZlcnNpb24sMzcsXCI8XCIpKX0oKSkscmVzaXplX2ltYWdlOmZ1bmN0aW9uKCl7cmV0dXJuIHMuSW1hZ2UmJm8uY2FuKFwiYWNjZXNzX2JpbmFyeVwiKSYmbi5jYW4oXCJjcmVhdGVfY2FudmFzXCIpfSxyZXBvcnRfdXBsb2FkX3Byb2dyZXNzOiExLHJldHVybl9yZXNwb25zZV9oZWFkZXJzOiExLHJldHVybl9yZXNwb25zZV90eXBlOmZ1bmN0aW9uKHQpe3JldHVyblwianNvblwiPT09dCYmd2luZG93LkpTT04/ITA6ISF+ZS5pbkFycmF5KHQsW1widGV4dFwiLFwiZG9jdW1lbnRcIixcIlwiXSl9LHJldHVybl9zdGF0dXNfY29kZTpmdW5jdGlvbih0KXtyZXR1cm4hZS5hcnJheURpZmYodCxbMjAwLDQwNF0pfSxzZWxlY3RfZmlsZTpmdW5jdGlvbigpe3JldHVybiBuLmNhbihcInVzZV9maWxlaW5wdXRcIil9LHNlbGVjdF9tdWx0aXBsZTohMSxzZW5kX2JpbmFyeV9zdHJpbmc6ITEsc2VuZF9jdXN0b21faGVhZGVyczohMSxzZW5kX211bHRpcGFydDohMCxzbGljZV9ibG9iOiExLHN0cmVhbV91cGxvYWQ6ZnVuY3Rpb24oKXtyZXR1cm4gby5jYW4oXCJzZWxlY3RfZmlsZVwiKX0sc3VtbW9uX2ZpbGVfZGlhbG9nOmZ1bmN0aW9uKCl7cmV0dXJuIG8uY2FuKFwic2VsZWN0X2ZpbGVcIikmJiEoXCJGaXJlZm94XCI9PT1uLmJyb3dzZXImJm4udmVyQ29tcChuLnZlcnNpb24sNCxcIjxcIil8fFwiT3BlcmFcIj09PW4uYnJvd3NlciYmbi52ZXJDb21wKG4udmVyc2lvbiwxMixcIjxcIil8fFwiSUVcIj09PW4uYnJvd3NlciYmbi52ZXJDb21wKG4udmVyc2lvbiwxMCxcIjxcIikpfSx1cGxvYWRfZmlsZXNpemU6Yyx1c2VfaHR0cF9tZXRob2Q6ZnVuY3Rpb24odCl7cmV0dXJuIWUuYXJyYXlEaWZmKHQsW1wiR0VUXCIsXCJQT1NUXCJdKX19KSxlLmV4dGVuZCh0aGlzLHtpbml0OmZ1bmN0aW9uKCl7dGhpcy50cmlnZ2VyKFwiSW5pdFwiKX0sZGVzdHJveTpmdW5jdGlvbihlKXtyZXR1cm4gZnVuY3Rpb24oKXtlLmNhbGwobyksZT1vPW51bGx9fSh0aGlzLmRlc3Ryb3kpfSksZS5leHRlbmQodGhpcy5nZXRTaGltKCkscyl9dmFyIGE9XCJodG1sNFwiLHM9e307cmV0dXJuIGkuYWRkQ29uc3RydWN0b3IoYSxvKSxzfSksbihcIm1veGllL3J1bnRpbWUvaHRtbDQvZmlsZS9GaWxlSW5wdXRcIixbXCJtb3hpZS9ydW50aW1lL2h0bWw0L1J1bnRpbWVcIixcIm1veGllL2ZpbGUvRmlsZVwiLFwibW94aWUvY29yZS91dGlscy9CYXNpY1wiLFwibW94aWUvY29yZS91dGlscy9Eb21cIixcIm1veGllL2NvcmUvdXRpbHMvRXZlbnRzXCIsXCJtb3hpZS9jb3JlL3V0aWxzL01pbWVcIixcIm1veGllL2NvcmUvdXRpbHMvRW52XCJdLGZ1bmN0aW9uKGUsdCxpLG4scixvLGEpe2Z1bmN0aW9uIHMoKXtmdW5jdGlvbiBlKCl7dmFyIG8sYyxkLG0saCxmLHA9dGhpcyxnPXAuZ2V0UnVudGltZSgpO2Y9aS5ndWlkKFwidWlkX1wiKSxvPWcuZ2V0U2hpbUNvbnRhaW5lcigpLHMmJihkPW4uZ2V0KHMrXCJfZm9ybVwiKSxkJiYoaS5leHRlbmQoZC5zdHlsZSx7dG9wOlwiMTAwJVwifSksZC5maXJzdENoaWxkLnNldEF0dHJpYnV0ZShcInRhYmluZGV4XCIsLTEpKSksbT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZm9ybVwiKSxtLnNldEF0dHJpYnV0ZShcImlkXCIsZitcIl9mb3JtXCIpLG0uc2V0QXR0cmlidXRlKFwibWV0aG9kXCIsXCJwb3N0XCIpLG0uc2V0QXR0cmlidXRlKFwiZW5jdHlwZVwiLFwibXVsdGlwYXJ0L2Zvcm0tZGF0YVwiKSxtLnNldEF0dHJpYnV0ZShcImVuY29kaW5nXCIsXCJtdWx0aXBhcnQvZm9ybS1kYXRhXCIpLGkuZXh0ZW5kKG0uc3R5bGUse292ZXJmbG93OlwiaGlkZGVuXCIscG9zaXRpb246XCJhYnNvbHV0ZVwiLHRvcDowLGxlZnQ6MCx3aWR0aDpcIjEwMCVcIixoZWlnaHQ6XCIxMDAlXCJ9KSxoPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKSxoLnNldEF0dHJpYnV0ZShcImlkXCIsZiksaC5zZXRBdHRyaWJ1dGUoXCJ0eXBlXCIsXCJmaWxlXCIpLGguc2V0QXR0cmlidXRlKFwiYWNjZXB0XCIsbC5qb2luKFwiLFwiKSksZy5jYW4oXCJzdW1tb25fZmlsZV9kaWFsb2dcIikmJmguc2V0QXR0cmlidXRlKFwidGFiaW5kZXhcIiwtMSksaS5leHRlbmQoaC5zdHlsZSx7Zm9udFNpemU6XCI5OTlweFwiLG9wYWNpdHk6MH0pLG0uYXBwZW5kQ2hpbGQoaCksby5hcHBlbmRDaGlsZChtKSxpLmV4dGVuZChoLnN0eWxlLHtwb3NpdGlvbjpcImFic29sdXRlXCIsdG9wOjAsbGVmdDowLHdpZHRoOlwiMTAwJVwiLGhlaWdodDpcIjEwMCVcIn0pLFwiSUVcIj09PWEuYnJvd3NlciYmYS52ZXJDb21wKGEudmVyc2lvbiwxMCxcIjxcIikmJmkuZXh0ZW5kKGguc3R5bGUse2ZpbHRlcjpcInByb2dpZDpEWEltYWdlVHJhbnNmb3JtLk1pY3Jvc29mdC5BbHBoYShvcGFjaXR5PTApXCJ9KSxoLm9uY2hhbmdlPWZ1bmN0aW9uKCl7dmFyIGk7dGhpcy52YWx1ZSYmKGk9dGhpcy5maWxlcz90aGlzLmZpbGVzWzBdOntuYW1lOnRoaXMudmFsdWV9LGk9bmV3IHQoZy51aWQsaSksdGhpcy5vbmNoYW5nZT1mdW5jdGlvbigpe30sZS5jYWxsKHApLHAuZmlsZXM9W2ldLGguc2V0QXR0cmlidXRlKFwiaWRcIixpLnVpZCksbS5zZXRBdHRyaWJ1dGUoXCJpZFwiLGkudWlkK1wiX2Zvcm1cIikscC50cmlnZ2VyKFwiY2hhbmdlXCIpLGg9bT1udWxsKX0sZy5jYW4oXCJzdW1tb25fZmlsZV9kaWFsb2dcIikmJihjPW4uZ2V0KHUuYnJvd3NlX2J1dHRvbiksci5yZW1vdmVFdmVudChjLFwiY2xpY2tcIixwLnVpZCksci5hZGRFdmVudChjLFwiY2xpY2tcIixmdW5jdGlvbihlKXtoJiYhaC5kaXNhYmxlZCYmaC5jbGljaygpLGUucHJldmVudERlZmF1bHQoKX0scC51aWQpKSxzPWYsbz1kPWM9bnVsbH12YXIgcyx1LGMsbD1bXTtpLmV4dGVuZCh0aGlzLHtpbml0OmZ1bmN0aW9uKHQpe3ZhciBpLGE9dGhpcyxzPWEuZ2V0UnVudGltZSgpO3U9dCxsPW8uZXh0TGlzdDJtaW1lcyh0LmFjY2VwdCxzLmNhbihcImZpbHRlcl9ieV9leHRlbnNpb25cIikpLGk9cy5nZXRTaGltQ29udGFpbmVyKCksZnVuY3Rpb24oKXt2YXIgZSxvLGw7ZT1uLmdldCh0LmJyb3dzZV9idXR0b24pLGM9bi5nZXRTdHlsZShlLFwiei1pbmRleFwiKXx8XCJhdXRvXCIscy5jYW4oXCJzdW1tb25fZmlsZV9kaWFsb2dcIik/KFwic3RhdGljXCI9PT1uLmdldFN0eWxlKGUsXCJwb3NpdGlvblwiKSYmKGUuc3R5bGUucG9zaXRpb249XCJyZWxhdGl2ZVwiKSxhLmJpbmQoXCJSZWZyZXNoXCIsZnVuY3Rpb24oKXtvPXBhcnNlSW50KGMsMTApfHwxLG4uZ2V0KHUuYnJvd3NlX2J1dHRvbikuc3R5bGUuekluZGV4PW8sdGhpcy5nZXRSdW50aW1lKCkuZ2V0U2hpbUNvbnRhaW5lcigpLnN0eWxlLnpJbmRleD1vLTF9KSk6ZS5zZXRBdHRyaWJ1dGUoXCJ0YWJpbmRleFwiLC0xKSxsPXMuY2FuKFwic3VtbW9uX2ZpbGVfZGlhbG9nXCIpP2U6aSxyLmFkZEV2ZW50KGwsXCJtb3VzZW92ZXJcIixmdW5jdGlvbigpe2EudHJpZ2dlcihcIm1vdXNlZW50ZXJcIil9LGEudWlkKSxyLmFkZEV2ZW50KGwsXCJtb3VzZW91dFwiLGZ1bmN0aW9uKCl7YS50cmlnZ2VyKFwibW91c2VsZWF2ZVwiKX0sYS51aWQpLHIuYWRkRXZlbnQobCxcIm1vdXNlZG93blwiLGZ1bmN0aW9uKCl7YS50cmlnZ2VyKFwibW91c2Vkb3duXCIpfSxhLnVpZCksci5hZGRFdmVudChuLmdldCh0LmNvbnRhaW5lciksXCJtb3VzZXVwXCIsZnVuY3Rpb24oKXthLnRyaWdnZXIoXCJtb3VzZXVwXCIpfSxhLnVpZCksZT1udWxsfSgpLGUuY2FsbCh0aGlzKSxpPW51bGwsYS50cmlnZ2VyKHt0eXBlOlwicmVhZHlcIixhc3luYzohMH0pfSxzZXRPcHRpb246ZnVuY3Rpb24oZSx0KXt2YXIgaSxyPXRoaXMuZ2V0UnVudGltZSgpO1wiYWNjZXB0XCI9PWUmJihsPXQubWltZXN8fG8uZXh0TGlzdDJtaW1lcyh0LHIuY2FuKFwiZmlsdGVyX2J5X2V4dGVuc2lvblwiKSkpLGk9bi5nZXQocyksaSYmaS5zZXRBdHRyaWJ1dGUoXCJhY2NlcHRcIixsLmpvaW4oXCIsXCIpKX0sZGlzYWJsZTpmdW5jdGlvbihlKXt2YXIgdDsodD1uLmdldChzKSkmJih0LmRpc2FibGVkPSEhZSl9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLmdldFJ1bnRpbWUoKSx0PWUuZ2V0U2hpbSgpLGk9ZS5nZXRTaGltQ29udGFpbmVyKCksbz11JiZuLmdldCh1LmNvbnRhaW5lciksYT11JiZuLmdldCh1LmJyb3dzZV9idXR0b24pO28mJnIucmVtb3ZlQWxsRXZlbnRzKG8sdGhpcy51aWQpLGEmJihyLnJlbW92ZUFsbEV2ZW50cyhhLHRoaXMudWlkKSxhLnN0eWxlLnpJbmRleD1jKSxpJiYoci5yZW1vdmVBbGxFdmVudHMoaSx0aGlzLnVpZCksaS5pbm5lckhUTUw9XCJcIiksdC5yZW1vdmVJbnN0YW5jZSh0aGlzLnVpZCkscz1sPXU9aT1vPWE9dD1udWxsfX0pfXJldHVybiBlLkZpbGVJbnB1dD1zfSksbihcIm1veGllL3J1bnRpbWUvaHRtbDQvZmlsZS9GaWxlUmVhZGVyXCIsW1wibW94aWUvcnVudGltZS9odG1sNC9SdW50aW1lXCIsXCJtb3hpZS9ydW50aW1lL2h0bWw1L2ZpbGUvRmlsZVJlYWRlclwiXSxmdW5jdGlvbihlLHQpe3JldHVybiBlLkZpbGVSZWFkZXI9dH0pLG4oXCJtb3hpZS9ydW50aW1lL2h0bWw0L3hoci9YTUxIdHRwUmVxdWVzdFwiLFtcIm1veGllL3J1bnRpbWUvaHRtbDQvUnVudGltZVwiLFwibW94aWUvY29yZS91dGlscy9CYXNpY1wiLFwibW94aWUvY29yZS91dGlscy9Eb21cIixcIm1veGllL2NvcmUvdXRpbHMvVXJsXCIsXCJtb3hpZS9jb3JlL0V4Y2VwdGlvbnNcIixcIm1veGllL2NvcmUvdXRpbHMvRXZlbnRzXCIsXCJtb3hpZS9maWxlL0Jsb2JcIixcIm1veGllL3hoci9Gb3JtRGF0YVwiXSxmdW5jdGlvbihlLHQsaSxuLHIsbyxhLHMpe2Z1bmN0aW9uIHUoKXtmdW5jdGlvbiBlKGUpe3ZhciB0LG4scixhLHM9dGhpcyx1PSExO2lmKGwpe2lmKHQ9bC5pZC5yZXBsYWNlKC9faWZyYW1lJC8sXCJcIiksbj1pLmdldCh0K1wiX2Zvcm1cIikpe2ZvcihyPW4uZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJpbnB1dFwiKSxhPXIubGVuZ3RoO2EtLTspc3dpdGNoKHJbYV0uZ2V0QXR0cmlidXRlKFwidHlwZVwiKSl7Y2FzZVwiaGlkZGVuXCI6clthXS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHJbYV0pO2JyZWFrO2Nhc2VcImZpbGVcIjp1PSEwfXI9W10sdXx8bi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG4pLG49bnVsbH1zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7by5yZW1vdmVFdmVudChsLFwibG9hZFwiLHMudWlkKSxsLnBhcmVudE5vZGUmJmwucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChsKTt2YXIgdD1zLmdldFJ1bnRpbWUoKS5nZXRTaGltQ29udGFpbmVyKCk7dC5jaGlsZHJlbi5sZW5ndGh8fHQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0KSx0PWw9bnVsbCxlKCl9LDEpfX12YXIgdSxjLGw7dC5leHRlbmQodGhpcyx7c2VuZDpmdW5jdGlvbihkLG0pe2Z1bmN0aW9uIGgoKXt2YXIgaT13LmdldFNoaW1Db250YWluZXIoKXx8ZG9jdW1lbnQuYm9keSxyPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7ci5pbm5lckhUTUw9JzxpZnJhbWUgaWQ9XCInK2YrJ19pZnJhbWVcIiBuYW1lPVwiJytmKydfaWZyYW1lXCIgc3JjPVwiamF2YXNjcmlwdDomcXVvdDsmcXVvdDtcIiBzdHlsZT1cImRpc3BsYXk6bm9uZVwiPjwvaWZyYW1lPicsbD1yLmZpcnN0Q2hpbGQsaS5hcHBlbmRDaGlsZChsKSxvLmFkZEV2ZW50KGwsXCJsb2FkXCIsZnVuY3Rpb24oKXt2YXIgaTt0cnl7aT1sLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnR8fGwuY29udGVudERvY3VtZW50fHx3aW5kb3cuZnJhbWVzW2wuaWRdLmRvY3VtZW50LC9eNCgwWzAtOV18MVswLTddfDJbMjM0Nl0pXFxzLy50ZXN0KGkudGl0bGUpP3U9aS50aXRsZS5yZXBsYWNlKC9eKFxcZCspLiokLyxcIiQxXCIpOih1PTIwMCxjPXQudHJpbShpLmJvZHkuaW5uZXJIVE1MKSx2LnRyaWdnZXIoe3R5cGU6XCJwcm9ncmVzc1wiLGxvYWRlZDpjLmxlbmd0aCx0b3RhbDpjLmxlbmd0aH0pLHgmJnYudHJpZ2dlcih7dHlwZTpcInVwbG9hZHByb2dyZXNzXCIsbG9hZGVkOnguc2l6ZXx8MTAyNSx0b3RhbDp4LnNpemV8fDEwMjV9KSl9Y2F0Y2gocil7aWYoIW4uaGFzU2FtZU9yaWdpbihkLnVybCkpcmV0dXJuIGUuY2FsbCh2LGZ1bmN0aW9uKCl7di50cmlnZ2VyKFwiZXJyb3JcIil9KSx2b2lkIDA7dT00MDR9ZS5jYWxsKHYsZnVuY3Rpb24oKXt2LnRyaWdnZXIoXCJsb2FkXCIpfSl9LHYudWlkKX12YXIgZixwLGcseCx2PXRoaXMsdz12LmdldFJ1bnRpbWUoKTtpZih1PWM9bnVsbCxtIGluc3RhbmNlb2YgcyYmbS5oYXNCbG9iKCkpe2lmKHg9bS5nZXRCbG9iKCksZj14LnVpZCxnPWkuZ2V0KGYpLHA9aS5nZXQoZitcIl9mb3JtXCIpLCFwKXRocm93IG5ldyByLkRPTUV4Y2VwdGlvbihyLkRPTUV4Y2VwdGlvbi5OT1RfRk9VTkRfRVJSKX1lbHNlIGY9dC5ndWlkKFwidWlkX1wiKSxwPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJmb3JtXCIpLHAuc2V0QXR0cmlidXRlKFwiaWRcIixmK1wiX2Zvcm1cIikscC5zZXRBdHRyaWJ1dGUoXCJtZXRob2RcIixkLm1ldGhvZCkscC5zZXRBdHRyaWJ1dGUoXCJlbmN0eXBlXCIsXCJtdWx0aXBhcnQvZm9ybS1kYXRhXCIpLHAuc2V0QXR0cmlidXRlKFwiZW5jb2RpbmdcIixcIm11bHRpcGFydC9mb3JtLWRhdGFcIiksdy5nZXRTaGltQ29udGFpbmVyKCkuYXBwZW5kQ2hpbGQocCk7cC5zZXRBdHRyaWJ1dGUoXCJ0YXJnZXRcIixmK1wiX2lmcmFtZVwiKSxtIGluc3RhbmNlb2YgcyYmbS5lYWNoKGZ1bmN0aW9uKGUsaSl7aWYoZSBpbnN0YW5jZW9mIGEpZyYmZy5zZXRBdHRyaWJ1dGUoXCJuYW1lXCIsaSk7ZWxzZXt2YXIgbj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7dC5leHRlbmQobix7dHlwZTpcImhpZGRlblwiLG5hbWU6aSx2YWx1ZTplfSksZz9wLmluc2VydEJlZm9yZShuLGcpOnAuYXBwZW5kQ2hpbGQobil9fSkscC5zZXRBdHRyaWJ1dGUoXCJhY3Rpb25cIixkLnVybCksaCgpLHAuc3VibWl0KCksdi50cmlnZ2VyKFwibG9hZHN0YXJ0XCIpfSxnZXRTdGF0dXM6ZnVuY3Rpb24oKXtyZXR1cm4gdX0sZ2V0UmVzcG9uc2U6ZnVuY3Rpb24oZSl7aWYoXCJqc29uXCI9PT1lJiZcInN0cmluZ1wiPT09dC50eXBlT2YoYykmJndpbmRvdy5KU09OKXRyeXtyZXR1cm4gSlNPTi5wYXJzZShjLnJlcGxhY2UoL15cXHMqPHByZVtePl0qPi8sXCJcIikucmVwbGFjZSgvPFxcL3ByZT5cXHMqJC8sXCJcIikpfWNhdGNoKGkpe3JldHVybiBudWxsfXJldHVybiBjfSxhYm9ydDpmdW5jdGlvbigpe3ZhciB0PXRoaXM7bCYmbC5jb250ZW50V2luZG93JiYobC5jb250ZW50V2luZG93LnN0b3A/bC5jb250ZW50V2luZG93LnN0b3AoKTpsLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQuZXhlY0NvbW1hbmQ/bC5jb250ZW50V2luZG93LmRvY3VtZW50LmV4ZWNDb21tYW5kKFwiU3RvcFwiKTpsLnNyYz1cImFib3V0OmJsYW5rXCIpLGUuY2FsbCh0aGlzLGZ1bmN0aW9uKCl7dC5kaXNwYXRjaEV2ZW50KFwiYWJvcnRcIil9KX0sZGVzdHJveTpmdW5jdGlvbigpe3RoaXMuZ2V0UnVudGltZSgpLmdldFNoaW0oKS5yZW1vdmVJbnN0YW5jZSh0aGlzLnVpZCl9fSl9cmV0dXJuIGUuWE1MSHR0cFJlcXVlc3Q9dX0pLG4oXCJtb3hpZS9ydW50aW1lL2h0bWw0L2ltYWdlL0ltYWdlXCIsW1wibW94aWUvcnVudGltZS9odG1sNC9SdW50aW1lXCIsXCJtb3hpZS9ydW50aW1lL2h0bWw1L2ltYWdlL0ltYWdlXCJdLGZ1bmN0aW9uKGUsdCl7cmV0dXJuIGUuSW1hZ2U9dH0pLGEoW1wibW94aWUvY29yZS91dGlscy9CYXNpY1wiLFwibW94aWUvY29yZS91dGlscy9FbmNvZGVcIixcIm1veGllL2NvcmUvdXRpbHMvRW52XCIsXCJtb3hpZS9jb3JlL0V4Y2VwdGlvbnNcIixcIm1veGllL2NvcmUvdXRpbHMvRG9tXCIsXCJtb3hpZS9jb3JlL0V2ZW50VGFyZ2V0XCIsXCJtb3hpZS9ydW50aW1lL1J1bnRpbWVcIixcIm1veGllL3J1bnRpbWUvUnVudGltZUNsaWVudFwiLFwibW94aWUvZmlsZS9CbG9iXCIsXCJtb3hpZS9jb3JlL0kxOG5cIixcIm1veGllL2NvcmUvdXRpbHMvTWltZVwiLFwibW94aWUvZmlsZS9GaWxlSW5wdXRcIixcIm1veGllL2ZpbGUvRmlsZVwiLFwibW94aWUvZmlsZS9GaWxlRHJvcFwiLFwibW94aWUvZmlsZS9GaWxlUmVhZGVyXCIsXCJtb3hpZS9jb3JlL3V0aWxzL1VybFwiLFwibW94aWUvcnVudGltZS9SdW50aW1lVGFyZ2V0XCIsXCJtb3hpZS94aHIvRm9ybURhdGFcIixcIm1veGllL3hoci9YTUxIdHRwUmVxdWVzdFwiLFwibW94aWUvaW1hZ2UvSW1hZ2VcIixcIm1veGllL2NvcmUvdXRpbHMvRXZlbnRzXCIsXCJtb3hpZS9ydW50aW1lL2h0bWw1L2ltYWdlL1Jlc2l6ZXJDYW52YXNcIl0pfSh0aGlzKX0pO1xuLyoqXG4gKiBQbHVwbG9hZCAtIG11bHRpLXJ1bnRpbWUgRmlsZSBVcGxvYWRlclxuICogdjIuMy42XG4gKlxuICogQ29weXJpZ2h0IDIwMTMsIE1veGllY29kZSBTeXN0ZW1zIEFCXG4gKiBSZWxlYXNlZCB1bmRlciBHUEwgTGljZW5zZS5cbiAqXG4gKiBMaWNlbnNlOiBodHRwOi8vd3d3LnBsdXBsb2FkLmNvbS9saWNlbnNlXG4gKiBDb250cmlidXRpbmc6IGh0dHA6Ly93d3cucGx1cGxvYWQuY29tL2NvbnRyaWJ1dGluZ1xuICpcbiAqIERhdGU6IDIwMTctMTEtMDNcbiAqL1xuIWZ1bmN0aW9uKGUsdCl7dmFyIGk9ZnVuY3Rpb24oKXt2YXIgZT17fTtyZXR1cm4gdC5hcHBseShlLGFyZ3VtZW50cyksZS5wbHVwbG9hZH07XCJmdW5jdGlvblwiPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kP2RlZmluZShcInBsdXBsb2FkXCIsW1wiLi9tb3hpZVwiXSxpKTpcIm9iamVjdFwiPT10eXBlb2YgbW9kdWxlJiZtb2R1bGUuZXhwb3J0cz9tb2R1bGUuZXhwb3J0cz1pKHJlcXVpcmUoXCIuL21veGllXCIpKTplLnBsdXBsb2FkPWkoZS5tb3hpZSl9KHRoaXN8fHdpbmRvdyxmdW5jdGlvbihlKXshZnVuY3Rpb24oZSx0LGkpe2Z1bmN0aW9uIG4oZSl7ZnVuY3Rpb24gdChlLHQsaSl7dmFyIHI9e2NodW5rczpcInNsaWNlX2Jsb2JcIixqcGdyZXNpemU6XCJzZW5kX2JpbmFyeV9zdHJpbmdcIixwbmdyZXNpemU6XCJzZW5kX2JpbmFyeV9zdHJpbmdcIixwcm9ncmVzczpcInJlcG9ydF91cGxvYWRfcHJvZ3Jlc3NcIixtdWx0aV9zZWxlY3Rpb246XCJzZWxlY3RfbXVsdGlwbGVcIixkcmFnZHJvcDpcImRyYWdfYW5kX2Ryb3BcIixkcm9wX2VsZW1lbnQ6XCJkcmFnX2FuZF9kcm9wXCIsaGVhZGVyczpcInNlbmRfY3VzdG9tX2hlYWRlcnNcIix1cmxzdHJlYW1fdXBsb2FkOlwic2VuZF9iaW5hcnlfc3RyaW5nXCIsY2FuU2VuZEJpbmFyeTpcInNlbmRfYmluYXJ5XCIsdHJpZ2dlckRpYWxvZzpcInN1bW1vbl9maWxlX2RpYWxvZ1wifTtyW2VdP25bcltlXV09dDppfHwobltlXT10KX12YXIgaT1lLnJlcXVpcmVkX2ZlYXR1cmVzLG49e307cmV0dXJuXCJzdHJpbmdcIj09dHlwZW9mIGk/bC5lYWNoKGkuc3BsaXQoL1xccyosXFxzKi8pLGZ1bmN0aW9uKGUpe3QoZSwhMCl9KTpcIm9iamVjdFwiPT10eXBlb2YgaT9sLmVhY2goaSxmdW5jdGlvbihlLGkpe3QoaSxlKX0pOmk9PT0hMCYmKGUuY2h1bmtfc2l6ZSYmZS5jaHVua19zaXplPjAmJihuLnNsaWNlX2Jsb2I9ITApLGwuaXNFbXB0eU9iaihlLnJlc2l6ZSkmJmUubXVsdGlwYXJ0IT09ITF8fChuLnNlbmRfYmluYXJ5X3N0cmluZz0hMCksZS5odHRwX21ldGhvZCYmKG4udXNlX2h0dHBfbWV0aG9kPWUuaHR0cF9tZXRob2QpLGwuZWFjaChlLGZ1bmN0aW9uKGUsaSl7dChpLCEhZSwhMCl9KSksbn12YXIgcj13aW5kb3cuc2V0VGltZW91dCxzPXt9LGE9dC5jb3JlLnV0aWxzLG89dC5ydW50aW1lLlJ1bnRpbWUsbD17VkVSU0lPTjpcIjIuMy42XCIsU1RPUFBFRDoxLFNUQVJURUQ6MixRVUVVRUQ6MSxVUExPQURJTkc6MixGQUlMRUQ6NCxET05FOjUsR0VORVJJQ19FUlJPUjotMTAwLEhUVFBfRVJST1I6LTIwMCxJT19FUlJPUjotMzAwLFNFQ1VSSVRZX0VSUk9SOi00MDAsSU5JVF9FUlJPUjotNTAwLEZJTEVfU0laRV9FUlJPUjotNjAwLEZJTEVfRVhURU5TSU9OX0VSUk9SOi02MDEsRklMRV9EVVBMSUNBVEVfRVJST1I6LTYwMixJTUFHRV9GT1JNQVRfRVJST1I6LTcwMCxNRU1PUllfRVJST1I6LTcwMSxJTUFHRV9ESU1FTlNJT05TX0VSUk9SOi03MDIsbW94aWU6dCxtaW1lVHlwZXM6YS5NaW1lLm1pbWVzLHVhOmEuRW52LHR5cGVPZjphLkJhc2ljLnR5cGVPZixleHRlbmQ6YS5CYXNpYy5leHRlbmQsZ3VpZDphLkJhc2ljLmd1aWQsZ2V0QWxsOmZ1bmN0aW9uKGUpe3ZhciB0LGk9W107XCJhcnJheVwiIT09bC50eXBlT2YoZSkmJihlPVtlXSk7Zm9yKHZhciBuPWUubGVuZ3RoO24tLTspdD1sLmdldChlW25dKSx0JiZpLnB1c2godCk7cmV0dXJuIGkubGVuZ3RoP2k6bnVsbH0sZ2V0OmEuRG9tLmdldCxlYWNoOmEuQmFzaWMuZWFjaCxnZXRQb3M6YS5Eb20uZ2V0UG9zLGdldFNpemU6YS5Eb20uZ2V0U2l6ZSx4bWxFbmNvZGU6ZnVuY3Rpb24oZSl7dmFyIHQ9e1wiPFwiOlwibHRcIixcIj5cIjpcImd0XCIsXCImXCI6XCJhbXBcIiwnXCInOlwicXVvdFwiLFwiJ1wiOlwiIzM5XCJ9LGk9L1s8PiZcXFwiXFwnXS9nO3JldHVybiBlPyhcIlwiK2UpLnJlcGxhY2UoaSxmdW5jdGlvbihlKXtyZXR1cm4gdFtlXT9cIiZcIit0W2VdK1wiO1wiOmV9KTplfSx0b0FycmF5OmEuQmFzaWMudG9BcnJheSxpbkFycmF5OmEuQmFzaWMuaW5BcnJheSxpblNlcmllczphLkJhc2ljLmluU2VyaWVzLGFkZEkxOG46dC5jb3JlLkkxOG4uYWRkSTE4bix0cmFuc2xhdGU6dC5jb3JlLkkxOG4udHJhbnNsYXRlLHNwcmludGY6YS5CYXNpYy5zcHJpbnRmLGlzRW1wdHlPYmo6YS5CYXNpYy5pc0VtcHR5T2JqLGhhc0NsYXNzOmEuRG9tLmhhc0NsYXNzLGFkZENsYXNzOmEuRG9tLmFkZENsYXNzLHJlbW92ZUNsYXNzOmEuRG9tLnJlbW92ZUNsYXNzLGdldFN0eWxlOmEuRG9tLmdldFN0eWxlLGFkZEV2ZW50OmEuRXZlbnRzLmFkZEV2ZW50LHJlbW92ZUV2ZW50OmEuRXZlbnRzLnJlbW92ZUV2ZW50LHJlbW92ZUFsbEV2ZW50czphLkV2ZW50cy5yZW1vdmVBbGxFdmVudHMsY2xlYW5OYW1lOmZ1bmN0aW9uKGUpe3ZhciB0LGk7Zm9yKGk9Wy9bXFwzMDAtXFwzMDZdL2csXCJBXCIsL1tcXDM0MC1cXDM0Nl0vZyxcImFcIiwvXFwzMDcvZyxcIkNcIiwvXFwzNDcvZyxcImNcIiwvW1xcMzEwLVxcMzEzXS9nLFwiRVwiLC9bXFwzNTAtXFwzNTNdL2csXCJlXCIsL1tcXDMxNC1cXDMxN10vZyxcIklcIiwvW1xcMzU0LVxcMzU3XS9nLFwiaVwiLC9cXDMyMS9nLFwiTlwiLC9cXDM2MS9nLFwiblwiLC9bXFwzMjItXFwzMzBdL2csXCJPXCIsL1tcXDM2Mi1cXDM3MF0vZyxcIm9cIiwvW1xcMzMxLVxcMzM0XS9nLFwiVVwiLC9bXFwzNzEtXFwzNzRdL2csXCJ1XCJdLHQ9MDt0PGkubGVuZ3RoO3QrPTIpZT1lLnJlcGxhY2UoaVt0XSxpW3QrMV0pO3JldHVybiBlPWUucmVwbGFjZSgvXFxzKy9nLFwiX1wiKSxlPWUucmVwbGFjZSgvW15hLXowLTlfXFwtXFwuXSsvZ2ksXCJcIil9LGJ1aWxkVXJsOmZ1bmN0aW9uKGUsdCl7dmFyIGk9XCJcIjtyZXR1cm4gbC5lYWNoKHQsZnVuY3Rpb24oZSx0KXtpKz0oaT9cIiZcIjpcIlwiKStlbmNvZGVVUklDb21wb25lbnQodCkrXCI9XCIrZW5jb2RlVVJJQ29tcG9uZW50KGUpfSksaSYmKGUrPShlLmluZGV4T2YoXCI/XCIpPjA/XCImXCI6XCI/XCIpK2kpLGV9LGZvcm1hdFNpemU6ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdChlLHQpe3JldHVybiBNYXRoLnJvdW5kKGUqTWF0aC5wb3coMTAsdCkpL01hdGgucG93KDEwLHQpfWlmKGU9PT1pfHwvXFxELy50ZXN0KGUpKXJldHVybiBsLnRyYW5zbGF0ZShcIk4vQVwiKTt2YXIgbj1NYXRoLnBvdygxMDI0LDQpO3JldHVybiBlPm4/dChlL24sMSkrXCIgXCIrbC50cmFuc2xhdGUoXCJ0YlwiKTplPihuLz0xMDI0KT90KGUvbiwxKStcIiBcIitsLnRyYW5zbGF0ZShcImdiXCIpOmU+KG4vPTEwMjQpP3QoZS9uLDEpK1wiIFwiK2wudHJhbnNsYXRlKFwibWJcIik6ZT4xMDI0P01hdGgucm91bmQoZS8xMDI0KStcIiBcIitsLnRyYW5zbGF0ZShcImtiXCIpOmUrXCIgXCIrbC50cmFuc2xhdGUoXCJiXCIpfSxwYXJzZVNpemU6YS5CYXNpYy5wYXJzZVNpemVTdHIscHJlZGljdFJ1bnRpbWU6ZnVuY3Rpb24oZSx0KXt2YXIgaSxuO3JldHVybiBpPW5ldyBsLlVwbG9hZGVyKGUpLG49by50aGF0Q2FuKGkuZ2V0T3B0aW9uKCkucmVxdWlyZWRfZmVhdHVyZXMsdHx8ZS5ydW50aW1lcyksaS5kZXN0cm95KCksbn0sYWRkRmlsZUZpbHRlcjpmdW5jdGlvbihlLHQpe3NbZV09dH19O2wuYWRkRmlsZUZpbHRlcihcIm1pbWVfdHlwZXNcIixmdW5jdGlvbihlLHQsaSl7ZS5sZW5ndGgmJiFlLnJlZ2V4cC50ZXN0KHQubmFtZSk/KHRoaXMudHJpZ2dlcihcIkVycm9yXCIse2NvZGU6bC5GSUxFX0VYVEVOU0lPTl9FUlJPUixtZXNzYWdlOmwudHJhbnNsYXRlKFwiRmlsZSBleHRlbnNpb24gZXJyb3IuXCIpLGZpbGU6dH0pLGkoITEpKTppKCEwKX0pLGwuYWRkRmlsZUZpbHRlcihcIm1heF9maWxlX3NpemVcIixmdW5jdGlvbihlLHQsaSl7dmFyIG47ZT1sLnBhcnNlU2l6ZShlKSx0LnNpemUhPT1uJiZlJiZ0LnNpemU+ZT8odGhpcy50cmlnZ2VyKFwiRXJyb3JcIix7Y29kZTpsLkZJTEVfU0laRV9FUlJPUixtZXNzYWdlOmwudHJhbnNsYXRlKFwiRmlsZSBzaXplIGVycm9yLlwiKSxmaWxlOnR9KSxpKCExKSk6aSghMCl9KSxsLmFkZEZpbGVGaWx0ZXIoXCJwcmV2ZW50X2R1cGxpY2F0ZXNcIixmdW5jdGlvbihlLHQsaSl7aWYoZSlmb3IodmFyIG49dGhpcy5maWxlcy5sZW5ndGg7bi0tOylpZih0Lm5hbWU9PT10aGlzLmZpbGVzW25dLm5hbWUmJnQuc2l6ZT09PXRoaXMuZmlsZXNbbl0uc2l6ZSlyZXR1cm4gdGhpcy50cmlnZ2VyKFwiRXJyb3JcIix7Y29kZTpsLkZJTEVfRFVQTElDQVRFX0VSUk9SLG1lc3NhZ2U6bC50cmFuc2xhdGUoXCJEdXBsaWNhdGUgZmlsZSBlcnJvci5cIiksZmlsZTp0fSksaSghMSksdm9pZCAwO2koITApfSksbC5hZGRGaWxlRmlsdGVyKFwicHJldmVudF9lbXB0eVwiLGZ1bmN0aW9uKGUsdCxuKXtlJiYhdC5zaXplJiZ0LnNpemUhPT1pPyh0aGlzLnRyaWdnZXIoXCJFcnJvclwiLHtjb2RlOmwuRklMRV9TSVpFX0VSUk9SLG1lc3NhZ2U6bC50cmFuc2xhdGUoXCJGaWxlIHNpemUgZXJyb3IuXCIpLGZpbGU6dH0pLG4oITEpKTpuKCEwKX0pLGwuVXBsb2FkZXI9ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gYSgpe3ZhciBlLHQsaT0wO2lmKHRoaXMuc3RhdGU9PWwuU1RBUlRFRCl7Zm9yKHQ9MDt0PEQubGVuZ3RoO3QrKyllfHxEW3RdLnN0YXR1cyE9bC5RVUVVRUQ/aSsrOihlPURbdF0sdGhpcy50cmlnZ2VyKFwiQmVmb3JlVXBsb2FkXCIsZSkmJihlLnN0YXR1cz1sLlVQTE9BRElORyx0aGlzLnRyaWdnZXIoXCJVcGxvYWRGaWxlXCIsZSkpKTtpPT1ELmxlbmd0aCYmKHRoaXMuc3RhdGUhPT1sLlNUT1BQRUQmJih0aGlzLnN0YXRlPWwuU1RPUFBFRCx0aGlzLnRyaWdnZXIoXCJTdGF0ZUNoYW5nZWRcIikpLHRoaXMudHJpZ2dlcihcIlVwbG9hZENvbXBsZXRlXCIsRCkpfX1mdW5jdGlvbiB1KGUpe2UucGVyY2VudD1lLnNpemU+MD9NYXRoLmNlaWwoMTAwKihlLmxvYWRlZC9lLnNpemUpKToxMDAsZCgpfWZ1bmN0aW9uIGQoKXt2YXIgZSx0LG4scj0wO2ZvcihJLnJlc2V0KCksZT0wO2U8RC5sZW5ndGg7ZSsrKXQ9RFtlXSx0LnNpemUhPT1pPyhJLnNpemUrPXQub3JpZ1NpemUsbj10LmxvYWRlZCp0Lm9yaWdTaXplL3Quc2l6ZSwoIXQuY29tcGxldGVUaW1lc3RhbXB8fHQuY29tcGxldGVUaW1lc3RhbXA+UykmJihyKz1uKSxJLmxvYWRlZCs9bik6SS5zaXplPWksdC5zdGF0dXM9PWwuRE9ORT9JLnVwbG9hZGVkKys6dC5zdGF0dXM9PWwuRkFJTEVEP0kuZmFpbGVkKys6SS5xdWV1ZWQrKztJLnNpemU9PT1pP0kucGVyY2VudD1ELmxlbmd0aD4wP01hdGguY2VpbCgxMDAqKEkudXBsb2FkZWQvRC5sZW5ndGgpKTowOihJLmJ5dGVzUGVyU2VjPU1hdGguY2VpbChyLygoK25ldyBEYXRlLVN8fDEpLzFlMykpLEkucGVyY2VudD1JLnNpemU+MD9NYXRoLmNlaWwoMTAwKihJLmxvYWRlZC9JLnNpemUpKTowKX1mdW5jdGlvbiBjKCl7dmFyIGU9RlswXXx8UFswXTtyZXR1cm4gZT9lLmdldFJ1bnRpbWUoKS51aWQ6ITF9ZnVuY3Rpb24gZigpe3RoaXMuYmluZChcIkZpbGVzQWRkZWQgRmlsZXNSZW1vdmVkXCIsZnVuY3Rpb24oZSl7ZS50cmlnZ2VyKFwiUXVldWVDaGFuZ2VkXCIpLGUucmVmcmVzaCgpfSksdGhpcy5iaW5kKFwiQ2FuY2VsVXBsb2FkXCIsYiksdGhpcy5iaW5kKFwiQmVmb3JlVXBsb2FkXCIsbSksdGhpcy5iaW5kKFwiVXBsb2FkRmlsZVwiLF8pLHRoaXMuYmluZChcIlVwbG9hZFByb2dyZXNzXCIsRSksdGhpcy5iaW5kKFwiU3RhdGVDaGFuZ2VkXCIsdiksdGhpcy5iaW5kKFwiUXVldWVDaGFuZ2VkXCIsZCksdGhpcy5iaW5kKFwiRXJyb3JcIixSKSx0aGlzLmJpbmQoXCJGaWxlVXBsb2FkZWRcIix5KSx0aGlzLmJpbmQoXCJEZXN0cm95XCIseil9ZnVuY3Rpb24gcChlLGkpe3ZhciBuPXRoaXMscj0wLHM9W10sYT17cnVudGltZV9vcmRlcjplLnJ1bnRpbWVzLHJlcXVpcmVkX2NhcHM6ZS5yZXF1aXJlZF9mZWF0dXJlcyxwcmVmZXJyZWRfY2Fwczp4LHN3Zl91cmw6ZS5mbGFzaF9zd2ZfdXJsLHhhcF91cmw6ZS5zaWx2ZXJsaWdodF94YXBfdXJsfTtsLmVhY2goZS5ydW50aW1lcy5zcGxpdCgvXFxzKixcXHMqLyksZnVuY3Rpb24odCl7ZVt0XSYmKGFbdF09ZVt0XSl9KSxlLmJyb3dzZV9idXR0b24mJmwuZWFjaChlLmJyb3dzZV9idXR0b24sZnVuY3Rpb24oaSl7cy5wdXNoKGZ1bmN0aW9uKHMpe3ZhciB1PW5ldyB0LmZpbGUuRmlsZUlucHV0KGwuZXh0ZW5kKHt9LGEse2FjY2VwdDplLmZpbHRlcnMubWltZV90eXBlcyxuYW1lOmUuZmlsZV9kYXRhX25hbWUsbXVsdGlwbGU6ZS5tdWx0aV9zZWxlY3Rpb24sY29udGFpbmVyOmUuY29udGFpbmVyLGJyb3dzZV9idXR0b246aX0pKTt1Lm9ucmVhZHk9ZnVuY3Rpb24oKXt2YXIgZT1vLmdldEluZm8odGhpcy5ydWlkKTtsLmV4dGVuZChuLmZlYXR1cmVzLHtjaHVua3M6ZS5jYW4oXCJzbGljZV9ibG9iXCIpLG11bHRpcGFydDplLmNhbihcInNlbmRfbXVsdGlwYXJ0XCIpLG11bHRpX3NlbGVjdGlvbjplLmNhbihcInNlbGVjdF9tdWx0aXBsZVwiKX0pLHIrKyxGLnB1c2godGhpcykscygpfSx1Lm9uY2hhbmdlPWZ1bmN0aW9uKCl7bi5hZGRGaWxlKHRoaXMuZmlsZXMpfSx1LmJpbmQoXCJtb3VzZWVudGVyIG1vdXNlbGVhdmUgbW91c2Vkb3duIG1vdXNldXBcIixmdW5jdGlvbih0KXtVfHwoZS5icm93c2VfYnV0dG9uX2hvdmVyJiYoXCJtb3VzZWVudGVyXCI9PT10LnR5cGU/bC5hZGRDbGFzcyhpLGUuYnJvd3NlX2J1dHRvbl9ob3Zlcik6XCJtb3VzZWxlYXZlXCI9PT10LnR5cGUmJmwucmVtb3ZlQ2xhc3MoaSxlLmJyb3dzZV9idXR0b25faG92ZXIpKSxlLmJyb3dzZV9idXR0b25fYWN0aXZlJiYoXCJtb3VzZWRvd25cIj09PXQudHlwZT9sLmFkZENsYXNzKGksZS5icm93c2VfYnV0dG9uX2FjdGl2ZSk6XCJtb3VzZXVwXCI9PT10LnR5cGUmJmwucmVtb3ZlQ2xhc3MoaSxlLmJyb3dzZV9idXR0b25fYWN0aXZlKSkpfSksdS5iaW5kKFwibW91c2Vkb3duXCIsZnVuY3Rpb24oKXtuLnRyaWdnZXIoXCJCcm93c2VcIil9KSx1LmJpbmQoXCJlcnJvciBydW50aW1lZXJyb3JcIixmdW5jdGlvbigpe3U9bnVsbCxzKCl9KSx1LmluaXQoKX0pfSksZS5kcm9wX2VsZW1lbnQmJmwuZWFjaChlLmRyb3BfZWxlbWVudCxmdW5jdGlvbihlKXtzLnB1c2goZnVuY3Rpb24oaSl7dmFyIHM9bmV3IHQuZmlsZS5GaWxlRHJvcChsLmV4dGVuZCh7fSxhLHtkcm9wX3pvbmU6ZX0pKTtzLm9ucmVhZHk9ZnVuY3Rpb24oKXt2YXIgZT1vLmdldEluZm8odGhpcy5ydWlkKTtsLmV4dGVuZChuLmZlYXR1cmVzLHtjaHVua3M6ZS5jYW4oXCJzbGljZV9ibG9iXCIpLG11bHRpcGFydDplLmNhbihcInNlbmRfbXVsdGlwYXJ0XCIpLGRyYWdkcm9wOmUuY2FuKFwiZHJhZ19hbmRfZHJvcFwiKX0pLHIrKyxQLnB1c2godGhpcyksaSgpfSxzLm9uZHJvcD1mdW5jdGlvbigpe24uYWRkRmlsZSh0aGlzLmZpbGVzKX0scy5iaW5kKFwiZXJyb3IgcnVudGltZWVycm9yXCIsZnVuY3Rpb24oKXtzPW51bGwsaSgpfSkscy5pbml0KCl9KX0pLGwuaW5TZXJpZXMocyxmdW5jdGlvbigpe1wiZnVuY3Rpb25cIj09dHlwZW9mIGkmJmkocil9KX1mdW5jdGlvbiBnKGUsbixyLHMpe3ZhciBhPW5ldyB0LmltYWdlLkltYWdlO3RyeXthLm9ubG9hZD1mdW5jdGlvbigpe24ud2lkdGg+dGhpcy53aWR0aCYmbi5oZWlnaHQ+dGhpcy5oZWlnaHQmJm4ucXVhbGl0eT09PWkmJm4ucHJlc2VydmVfaGVhZGVycyYmIW4uY3JvcD8odGhpcy5kZXN0cm95KCkscyhlKSk6YS5kb3duc2l6ZShuLndpZHRoLG4uaGVpZ2h0LG4uY3JvcCxuLnByZXNlcnZlX2hlYWRlcnMpfSxhLm9ucmVzaXplPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5nZXRBc0Jsb2IoZS50eXBlLG4ucXVhbGl0eSk7dGhpcy5kZXN0cm95KCkscyh0KX0sYS5iaW5kKFwiZXJyb3IgcnVudGltZWVycm9yXCIsZnVuY3Rpb24oKXt0aGlzLmRlc3Ryb3koKSxzKGUpfSksYS5sb2FkKGUscil9Y2F0Y2gobyl7cyhlKX19ZnVuY3Rpb24gaChlLGkscil7ZnVuY3Rpb24gcyhlLGksbil7dmFyIHI9T1tlXTtzd2l0Y2goZSl7Y2FzZVwibWF4X2ZpbGVfc2l6ZVwiOlwibWF4X2ZpbGVfc2l6ZVwiPT09ZSYmKE8ubWF4X2ZpbGVfc2l6ZT1PLmZpbHRlcnMubWF4X2ZpbGVfc2l6ZT1pKTticmVhaztjYXNlXCJjaHVua19zaXplXCI6KGk9bC5wYXJzZVNpemUoaSkpJiYoT1tlXT1pLE8uc2VuZF9maWxlX25hbWU9ITApO2JyZWFrO2Nhc2VcIm11bHRpcGFydFwiOk9bZV09aSxpfHwoTy5zZW5kX2ZpbGVfbmFtZT0hMCk7YnJlYWs7Y2FzZVwiaHR0cF9tZXRob2RcIjpPW2VdPVwiUFVUXCI9PT1pLnRvVXBwZXJDYXNlKCk/XCJQVVRcIjpcIlBPU1RcIjticmVhaztjYXNlXCJ1bmlxdWVfbmFtZXNcIjpPW2VdPWksaSYmKE8uc2VuZF9maWxlX25hbWU9ITApO2JyZWFrO2Nhc2VcImZpbHRlcnNcIjpcImFycmF5XCI9PT1sLnR5cGVPZihpKSYmKGk9e21pbWVfdHlwZXM6aX0pLG4/bC5leHRlbmQoTy5maWx0ZXJzLGkpOk8uZmlsdGVycz1pLGkubWltZV90eXBlcyYmKFwic3RyaW5nXCI9PT1sLnR5cGVPZihpLm1pbWVfdHlwZXMpJiYoaS5taW1lX3R5cGVzPXQuY29yZS51dGlscy5NaW1lLm1pbWVzMmV4dExpc3QoaS5taW1lX3R5cGVzKSksaS5taW1lX3R5cGVzLnJlZ2V4cD1mdW5jdGlvbihlKXt2YXIgdD1bXTtyZXR1cm4gbC5lYWNoKGUsZnVuY3Rpb24oZSl7bC5lYWNoKGUuZXh0ZW5zaW9ucy5zcGxpdCgvLC8pLGZ1bmN0aW9uKGUpey9eXFxzKlxcKlxccyokLy50ZXN0KGUpP3QucHVzaChcIlxcXFwuKlwiKTp0LnB1c2goXCJcXFxcLlwiK2UucmVwbGFjZShuZXcgUmVnRXhwKFwiW1wiK1wiL14kLiorP3woKVtde31cXFxcXCIucmVwbGFjZSgvLi9nLFwiXFxcXCQmXCIpK1wiXVwiLFwiZ1wiKSxcIlxcXFwkJlwiKSl9KX0pLG5ldyBSZWdFeHAoXCIoXCIrdC5qb2luKFwifFwiKStcIikkXCIsXCJpXCIpfShpLm1pbWVfdHlwZXMpLE8uZmlsdGVycy5taW1lX3R5cGVzPWkubWltZV90eXBlcyk7YnJlYWs7Y2FzZVwicmVzaXplXCI6Ty5yZXNpemU9aT9sLmV4dGVuZCh7cHJlc2VydmVfaGVhZGVyczohMCxjcm9wOiExfSxpKTohMTticmVhaztjYXNlXCJwcmV2ZW50X2R1cGxpY2F0ZXNcIjpPLnByZXZlbnRfZHVwbGljYXRlcz1PLmZpbHRlcnMucHJldmVudF9kdXBsaWNhdGVzPSEhaTticmVhaztjYXNlXCJjb250YWluZXJcIjpjYXNlXCJicm93c2VfYnV0dG9uXCI6Y2FzZVwiZHJvcF9lbGVtZW50XCI6aT1cImNvbnRhaW5lclwiPT09ZT9sLmdldChpKTpsLmdldEFsbChpKTtjYXNlXCJydW50aW1lc1wiOmNhc2VcIm11bHRpX3NlbGVjdGlvblwiOmNhc2VcImZsYXNoX3N3Zl91cmxcIjpjYXNlXCJzaWx2ZXJsaWdodF94YXBfdXJsXCI6T1tlXT1pLG58fCh1PSEwKTticmVhaztkZWZhdWx0Ok9bZV09aX1ufHxhLnRyaWdnZXIoXCJPcHRpb25DaGFuZ2VkXCIsZSxpLHIpfXZhciBhPXRoaXMsdT0hMTtcIm9iamVjdFwiPT10eXBlb2YgZT9sLmVhY2goZSxmdW5jdGlvbihlLHQpe3ModCxlLHIpfSk6cyhlLGkscikscj8oTy5yZXF1aXJlZF9mZWF0dXJlcz1uKGwuZXh0ZW5kKHt9LE8pKSx4PW4obC5leHRlbmQoe30sTyx7cmVxdWlyZWRfZmVhdHVyZXM6ITB9KSkpOnUmJihhLnRyaWdnZXIoXCJEZXN0cm95XCIpLHAuY2FsbChhLE8sZnVuY3Rpb24oZSl7ZT8oYS5ydW50aW1lPW8uZ2V0SW5mbyhjKCkpLnR5cGUsYS50cmlnZ2VyKFwiSW5pdFwiLHtydW50aW1lOmEucnVudGltZX0pLGEudHJpZ2dlcihcIlBvc3RJbml0XCIpKTphLnRyaWdnZXIoXCJFcnJvclwiLHtjb2RlOmwuSU5JVF9FUlJPUixtZXNzYWdlOmwudHJhbnNsYXRlKFwiSW5pdCBlcnJvci5cIil9KX0pKX1mdW5jdGlvbiBtKGUsdCl7aWYoZS5zZXR0aW5ncy51bmlxdWVfbmFtZXMpe3ZhciBpPXQubmFtZS5tYXRjaCgvXFwuKFteLl0rKSQvKSxuPVwicGFydFwiO2kmJihuPWlbMV0pLHQudGFyZ2V0X25hbWU9dC5pZCtcIi5cIitufX1mdW5jdGlvbiBfKGUsaSl7ZnVuY3Rpb24gbigpe2MtLT4wP3IocywxZTMpOihpLmxvYWRlZD1wLGUudHJpZ2dlcihcIkVycm9yXCIse2NvZGU6bC5IVFRQX0VSUk9SLG1lc3NhZ2U6bC50cmFuc2xhdGUoXCJIVFRQIEVycm9yLlwiKSxmaWxlOmkscmVzcG9uc2U6VC5yZXNwb25zZVRleHQsc3RhdHVzOlQuc3RhdHVzLHJlc3BvbnNlSGVhZGVyczpULmdldEFsbFJlc3BvbnNlSGVhZGVycygpfSkpfWZ1bmN0aW9uIHMoKXt2YXIgdCxuLHI9e307aS5zdGF0dXM9PT1sLlVQTE9BRElORyYmZS5zdGF0ZSE9PWwuU1RPUFBFRCYmKGUuc2V0dGluZ3Muc2VuZF9maWxlX25hbWUmJihyLm5hbWU9aS50YXJnZXRfbmFtZXx8aS5uYW1lKSxkJiZmLmNodW5rcyYmby5zaXplPmQ/KG49TWF0aC5taW4oZCxvLnNpemUtcCksdD1vLnNsaWNlKHAscCtuKSk6KG49by5zaXplLHQ9byksZCYmZi5jaHVua3MmJihlLnNldHRpbmdzLnNlbmRfY2h1bmtfbnVtYmVyPyhyLmNodW5rPU1hdGguY2VpbChwL2QpLHIuY2h1bmtzPU1hdGguY2VpbChvLnNpemUvZCkpOihyLm9mZnNldD1wLHIudG90YWw9by5zaXplKSksZS50cmlnZ2VyKFwiQmVmb3JlQ2h1bmtVcGxvYWRcIixpLHIsdCxwKSYmYShyLHQsbikpfWZ1bmN0aW9uIGEoYSxkLGcpe3ZhciBtO1Q9bmV3IHQueGhyLlhNTEh0dHBSZXF1ZXN0LFQudXBsb2FkJiYoVC51cGxvYWQub25wcm9ncmVzcz1mdW5jdGlvbih0KXtpLmxvYWRlZD1NYXRoLm1pbihpLnNpemUscCt0LmxvYWRlZCksZS50cmlnZ2VyKFwiVXBsb2FkUHJvZ3Jlc3NcIixpKX0pLFQub25sb2FkPWZ1bmN0aW9uKCl7cmV0dXJuIFQuc3RhdHVzPDIwMHx8VC5zdGF0dXM+PTQwMD8obigpLHZvaWQgMCk6KGM9ZS5zZXR0aW5ncy5tYXhfcmV0cmllcyxnPG8uc2l6ZT8oZC5kZXN0cm95KCkscCs9ZyxpLmxvYWRlZD1NYXRoLm1pbihwLG8uc2l6ZSksZS50cmlnZ2VyKFwiQ2h1bmtVcGxvYWRlZFwiLGkse29mZnNldDppLmxvYWRlZCx0b3RhbDpvLnNpemUscmVzcG9uc2U6VC5yZXNwb25zZVRleHQsc3RhdHVzOlQuc3RhdHVzLHJlc3BvbnNlSGVhZGVyczpULmdldEFsbFJlc3BvbnNlSGVhZGVycygpfSksXCJBbmRyb2lkIEJyb3dzZXJcIj09PWwudWEuYnJvd3NlciYmZS50cmlnZ2VyKFwiVXBsb2FkUHJvZ3Jlc3NcIixpKSk6aS5sb2FkZWQ9aS5zaXplLGQ9bT1udWxsLCFwfHxwPj1vLnNpemU/KGkuc2l6ZSE9aS5vcmlnU2l6ZSYmKG8uZGVzdHJveSgpLG89bnVsbCksZS50cmlnZ2VyKFwiVXBsb2FkUHJvZ3Jlc3NcIixpKSxpLnN0YXR1cz1sLkRPTkUsaS5jb21wbGV0ZVRpbWVzdGFtcD0rbmV3IERhdGUsZS50cmlnZ2VyKFwiRmlsZVVwbG9hZGVkXCIsaSx7cmVzcG9uc2U6VC5yZXNwb25zZVRleHQsc3RhdHVzOlQuc3RhdHVzLHJlc3BvbnNlSGVhZGVyczpULmdldEFsbFJlc3BvbnNlSGVhZGVycygpfSkpOnIocywxKSx2b2lkIDApfSxULm9uZXJyb3I9ZnVuY3Rpb24oKXtuKCl9LFQub25sb2FkZW5kPWZ1bmN0aW9uKCl7dGhpcy5kZXN0cm95KCl9LGUuc2V0dGluZ3MubXVsdGlwYXJ0JiZmLm11bHRpcGFydD8oVC5vcGVuKGUuc2V0dGluZ3MuaHR0cF9tZXRob2QsdSwhMCksbC5lYWNoKGUuc2V0dGluZ3MuaGVhZGVycyxmdW5jdGlvbihlLHQpe1Quc2V0UmVxdWVzdEhlYWRlcih0LGUpfSksbT1uZXcgdC54aHIuRm9ybURhdGEsbC5lYWNoKGwuZXh0ZW5kKGEsZS5zZXR0aW5ncy5tdWx0aXBhcnRfcGFyYW1zKSxmdW5jdGlvbihlLHQpe20uYXBwZW5kKHQsZSl9KSxtLmFwcGVuZChlLnNldHRpbmdzLmZpbGVfZGF0YV9uYW1lLGQpLFQuc2VuZChtLGgpKToodT1sLmJ1aWxkVXJsKGUuc2V0dGluZ3MudXJsLGwuZXh0ZW5kKGEsZS5zZXR0aW5ncy5tdWx0aXBhcnRfcGFyYW1zKSksVC5vcGVuKGUuc2V0dGluZ3MuaHR0cF9tZXRob2QsdSwhMCksbC5lYWNoKGUuc2V0dGluZ3MuaGVhZGVycyxmdW5jdGlvbihlLHQpe1Quc2V0UmVxdWVzdEhlYWRlcih0LGUpfSksVC5oYXNSZXF1ZXN0SGVhZGVyKFwiQ29udGVudC1UeXBlXCIpfHxULnNldFJlcXVlc3RIZWFkZXIoXCJDb250ZW50LVR5cGVcIixcImFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbVwiKSxULnNlbmQoZCxoKSl9dmFyIG8sdT1lLnNldHRpbmdzLnVybCxkPWUuc2V0dGluZ3MuY2h1bmtfc2l6ZSxjPWUuc2V0dGluZ3MubWF4X3JldHJpZXMsZj1lLmZlYXR1cmVzLHA9MCxoPXtydW50aW1lX29yZGVyOmUuc2V0dGluZ3MucnVudGltZXMscmVxdWlyZWRfY2FwczplLnNldHRpbmdzLnJlcXVpcmVkX2ZlYXR1cmVzLHByZWZlcnJlZF9jYXBzOngsc3dmX3VybDplLnNldHRpbmdzLmZsYXNoX3N3Zl91cmwseGFwX3VybDplLnNldHRpbmdzLnNpbHZlcmxpZ2h0X3hhcF91cmx9O2kubG9hZGVkJiYocD1pLmxvYWRlZD1kP2QqTWF0aC5mbG9vcihpLmxvYWRlZC9kKTowKSxvPWkuZ2V0U291cmNlKCksbC5pc0VtcHR5T2JqKGUuc2V0dGluZ3MucmVzaXplKXx8LTE9PT1sLmluQXJyYXkoby50eXBlLFtcImltYWdlL2pwZWdcIixcImltYWdlL3BuZ1wiXSk/cygpOmcobyxlLnNldHRpbmdzLnJlc2l6ZSxoLGZ1bmN0aW9uKGUpe289ZSxpLnNpemU9ZS5zaXplLHMoKX0pfWZ1bmN0aW9uIEUoZSx0KXt1KHQpfWZ1bmN0aW9uIHYoZSl7aWYoZS5zdGF0ZT09bC5TVEFSVEVEKVM9K25ldyBEYXRlO2Vsc2UgaWYoZS5zdGF0ZT09bC5TVE9QUEVEKWZvcih2YXIgdD1lLmZpbGVzLmxlbmd0aC0xO3Q+PTA7dC0tKWUuZmlsZXNbdF0uc3RhdHVzPT1sLlVQTE9BRElORyYmKGUuZmlsZXNbdF0uc3RhdHVzPWwuUVVFVUVELGQoKSl9ZnVuY3Rpb24gYigpe1QmJlQuYWJvcnQoKX1mdW5jdGlvbiB5KGUpe2QoKSxyKGZ1bmN0aW9uKCl7YS5jYWxsKGUpfSwxKX1mdW5jdGlvbiBSKGUsdCl7dC5jb2RlPT09bC5JTklUX0VSUk9SP2UuZGVzdHJveSgpOnQuY29kZT09PWwuSFRUUF9FUlJPUiYmKHQuZmlsZS5zdGF0dXM9bC5GQUlMRUQsdC5maWxlLmNvbXBsZXRlVGltZXN0YW1wPStuZXcgRGF0ZSx1KHQuZmlsZSksZS5zdGF0ZT09bC5TVEFSVEVEJiYoZS50cmlnZ2VyKFwiQ2FuY2VsVXBsb2FkXCIpLHIoZnVuY3Rpb24oKXthLmNhbGwoZSl9LDEpKSl9ZnVuY3Rpb24geihlKXtlLnN0b3AoKSxsLmVhY2goRCxmdW5jdGlvbihlKXtlLmRlc3Ryb3koKX0pLEQ9W10sRi5sZW5ndGgmJihsLmVhY2goRixmdW5jdGlvbihlKXtlLmRlc3Ryb3koKX0pLEY9W10pLFAubGVuZ3RoJiYobC5lYWNoKFAsZnVuY3Rpb24oZSl7ZS5kZXN0cm95KCl9KSxQPVtdKSx4PXt9LFU9ITEsUz1UPW51bGwsSS5yZXNldCgpfXZhciBPLFMsSSxULHc9bC5ndWlkKCksRD1bXSx4PXt9LEY9W10sUD1bXSxVPSExO089e2NodW5rX3NpemU6MCxmaWxlX2RhdGFfbmFtZTpcImZpbGVcIixmaWx0ZXJzOnttaW1lX3R5cGVzOltdLG1heF9maWxlX3NpemU6MCxwcmV2ZW50X2R1cGxpY2F0ZXM6ITEscHJldmVudF9lbXB0eTohMH0sZmxhc2hfc3dmX3VybDpcImpzL01veGllLnN3ZlwiLGh0dHBfbWV0aG9kOlwiUE9TVFwiLG1heF9yZXRyaWVzOjAsbXVsdGlwYXJ0OiEwLG11bHRpX3NlbGVjdGlvbjohMCxyZXNpemU6ITEscnVudGltZXM6by5vcmRlcixzZW5kX2ZpbGVfbmFtZTohMCxzZW5kX2NodW5rX251bWJlcjohMCxzaWx2ZXJsaWdodF94YXBfdXJsOlwianMvTW94aWUueGFwXCJ9LGguY2FsbCh0aGlzLGUsbnVsbCwhMCksST1uZXcgbC5RdWV1ZVByb2dyZXNzLGwuZXh0ZW5kKHRoaXMse2lkOncsdWlkOncsc3RhdGU6bC5TVE9QUEVELGZlYXR1cmVzOnt9LHJ1bnRpbWU6bnVsbCxmaWxlczpELHNldHRpbmdzOk8sdG90YWw6SSxpbml0OmZ1bmN0aW9uKCl7dmFyIGUsdCxpPXRoaXM7cmV0dXJuIGU9aS5nZXRPcHRpb24oXCJwcmVpbml0XCIpLFwiZnVuY3Rpb25cIj09dHlwZW9mIGU/ZShpKTpsLmVhY2goZSxmdW5jdGlvbihlLHQpe2kuYmluZCh0LGUpfSksZi5jYWxsKGkpLGwuZWFjaChbXCJjb250YWluZXJcIixcImJyb3dzZV9idXR0b25cIixcImRyb3BfZWxlbWVudFwiXSxmdW5jdGlvbihlKXtyZXR1cm4gbnVsbD09PWkuZ2V0T3B0aW9uKGUpPyh0PXtjb2RlOmwuSU5JVF9FUlJPUixtZXNzYWdlOmwuc3ByaW50ZihsLnRyYW5zbGF0ZShcIiVzIHNwZWNpZmllZCwgYnV0IGNhbm5vdCBiZSBmb3VuZC5cIiksZSl9LCExKTp2b2lkIDB9KSx0P2kudHJpZ2dlcihcIkVycm9yXCIsdCk6Ty5icm93c2VfYnV0dG9ufHxPLmRyb3BfZWxlbWVudD8ocC5jYWxsKGksTyxmdW5jdGlvbihlKXt2YXIgdD1pLmdldE9wdGlvbihcImluaXRcIik7XCJmdW5jdGlvblwiPT10eXBlb2YgdD90KGkpOmwuZWFjaCh0LGZ1bmN0aW9uKGUsdCl7aS5iaW5kKHQsZSl9KSxlPyhpLnJ1bnRpbWU9by5nZXRJbmZvKGMoKSkudHlwZSxpLnRyaWdnZXIoXCJJbml0XCIse3J1bnRpbWU6aS5ydW50aW1lfSksaS50cmlnZ2VyKFwiUG9zdEluaXRcIikpOmkudHJpZ2dlcihcIkVycm9yXCIse2NvZGU6bC5JTklUX0VSUk9SLG1lc3NhZ2U6bC50cmFuc2xhdGUoXCJJbml0IGVycm9yLlwiKX0pfSksdm9pZCAwKTppLnRyaWdnZXIoXCJFcnJvclwiLHtjb2RlOmwuSU5JVF9FUlJPUixtZXNzYWdlOmwudHJhbnNsYXRlKFwiWW91IG11c3Qgc3BlY2lmeSBlaXRoZXIgYnJvd3NlX2J1dHRvbiBvciBkcm9wX2VsZW1lbnQuXCIpfSl9LHNldE9wdGlvbjpmdW5jdGlvbihlLHQpe2guY2FsbCh0aGlzLGUsdCwhdGhpcy5ydW50aW1lKX0sZ2V0T3B0aW9uOmZ1bmN0aW9uKGUpe3JldHVybiBlP09bZV06T30scmVmcmVzaDpmdW5jdGlvbigpe0YubGVuZ3RoJiZsLmVhY2goRixmdW5jdGlvbihlKXtlLnRyaWdnZXIoXCJSZWZyZXNoXCIpfSksdGhpcy50cmlnZ2VyKFwiUmVmcmVzaFwiKX0sc3RhcnQ6ZnVuY3Rpb24oKXt0aGlzLnN0YXRlIT1sLlNUQVJURUQmJih0aGlzLnN0YXRlPWwuU1RBUlRFRCx0aGlzLnRyaWdnZXIoXCJTdGF0ZUNoYW5nZWRcIiksYS5jYWxsKHRoaXMpKX0sc3RvcDpmdW5jdGlvbigpe3RoaXMuc3RhdGUhPWwuU1RPUFBFRCYmKHRoaXMuc3RhdGU9bC5TVE9QUEVELHRoaXMudHJpZ2dlcihcIlN0YXRlQ2hhbmdlZFwiKSx0aGlzLnRyaWdnZXIoXCJDYW5jZWxVcGxvYWRcIikpfSxkaXNhYmxlQnJvd3NlOmZ1bmN0aW9uKCl7VT1hcmd1bWVudHNbMF0hPT1pP2FyZ3VtZW50c1swXTohMCxGLmxlbmd0aCYmbC5lYWNoKEYsZnVuY3Rpb24oZSl7ZS5kaXNhYmxlKFUpfSksdGhpcy50cmlnZ2VyKFwiRGlzYWJsZUJyb3dzZVwiLFUpfSxnZXRGaWxlOmZ1bmN0aW9uKGUpe3ZhciB0O2Zvcih0PUQubGVuZ3RoLTE7dD49MDt0LS0paWYoRFt0XS5pZD09PWUpcmV0dXJuIERbdF19LGFkZEZpbGU6ZnVuY3Rpb24oZSxpKXtmdW5jdGlvbiBuKGUsdCl7dmFyIGk9W107bC5lYWNoKHUuc2V0dGluZ3MuZmlsdGVycyxmdW5jdGlvbih0LG4pe3Nbbl0mJmkucHVzaChmdW5jdGlvbihpKXtzW25dLmNhbGwodSx0LGUsZnVuY3Rpb24oZSl7aSghZSl9KX0pfSksbC5pblNlcmllcyhpLHQpfWZ1bmN0aW9uIGEoZSl7dmFyIHM9bC50eXBlT2YoZSk7aWYoZSBpbnN0YW5jZW9mIHQuZmlsZS5GaWxlKXtpZighZS5ydWlkJiYhZS5pc0RldGFjaGVkKCkpe2lmKCFvKXJldHVybiExO2UucnVpZD1vLGUuY29ubmVjdFJ1bnRpbWUobyl9YShuZXcgbC5GaWxlKGUpKX1lbHNlIGUgaW5zdGFuY2VvZiB0LmZpbGUuQmxvYj8oYShlLmdldFNvdXJjZSgpKSxlLmRlc3Ryb3koKSk6ZSBpbnN0YW5jZW9mIGwuRmlsZT8oaSYmKGUubmFtZT1pKSxkLnB1c2goZnVuY3Rpb24odCl7bihlLGZ1bmN0aW9uKGkpe2l8fChELnB1c2goZSksZi5wdXNoKGUpLHUudHJpZ2dlcihcIkZpbGVGaWx0ZXJlZFwiLGUpKSxyKHQsMSl9KX0pKTotMSE9PWwuaW5BcnJheShzLFtcImZpbGVcIixcImJsb2JcIl0pP2EobmV3IHQuZmlsZS5GaWxlKG51bGwsZSkpOlwibm9kZVwiPT09cyYmXCJmaWxlbGlzdFwiPT09bC50eXBlT2YoZS5maWxlcyk/bC5lYWNoKGUuZmlsZXMsYSk6XCJhcnJheVwiPT09cyYmKGk9bnVsbCxsLmVhY2goZSxhKSl9dmFyIG8sdT10aGlzLGQ9W10sZj1bXTtvPWMoKSxhKGUpLGQubGVuZ3RoJiZsLmluU2VyaWVzKGQsZnVuY3Rpb24oKXtmLmxlbmd0aCYmdS50cmlnZ2VyKFwiRmlsZXNBZGRlZFwiLGYpfSl9LHJlbW92ZUZpbGU6ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PVwic3RyaW5nXCI9PXR5cGVvZiBlP2U6ZS5pZCxpPUQubGVuZ3RoLTE7aT49MDtpLS0paWYoRFtpXS5pZD09PXQpcmV0dXJuIHRoaXMuc3BsaWNlKGksMSlbMF19LHNwbGljZTpmdW5jdGlvbihlLHQpe3ZhciBuPUQuc3BsaWNlKGU9PT1pPzA6ZSx0PT09aT9ELmxlbmd0aDp0KSxyPSExO3JldHVybiB0aGlzLnN0YXRlPT1sLlNUQVJURUQmJihsLmVhY2gobixmdW5jdGlvbihlKXtyZXR1cm4gZS5zdGF0dXM9PT1sLlVQTE9BRElORz8ocj0hMCwhMSk6dm9pZCAwfSksciYmdGhpcy5zdG9wKCkpLHRoaXMudHJpZ2dlcihcIkZpbGVzUmVtb3ZlZFwiLG4pLGwuZWFjaChuLGZ1bmN0aW9uKGUpe2UuZGVzdHJveSgpfSksciYmdGhpcy5zdGFydCgpLG59LGRpc3BhdGNoRXZlbnQ6ZnVuY3Rpb24oZSl7dmFyIHQsaTtpZihlPWUudG9Mb3dlckNhc2UoKSx0PXRoaXMuaGFzRXZlbnRMaXN0ZW5lcihlKSl7dC5zb3J0KGZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQucHJpb3JpdHktZS5wcmlvcml0eX0pLGk9W10uc2xpY2UuY2FsbChhcmd1bWVudHMpLGkuc2hpZnQoKSxpLnVuc2hpZnQodGhpcyk7Zm9yKHZhciBuPTA7bjx0Lmxlbmd0aDtuKyspaWYodFtuXS5mbi5hcHBseSh0W25dLnNjb3BlLGkpPT09ITEpcmV0dXJuITF9cmV0dXJuITB9LGJpbmQ6ZnVuY3Rpb24oZSx0LGksbil7bC5VcGxvYWRlci5wcm90b3R5cGUuYmluZC5jYWxsKHRoaXMsZSx0LG4saSl9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLnRyaWdnZXIoXCJEZXN0cm95XCIpLE89ST1udWxsLHRoaXMudW5iaW5kQWxsKCl9fSl9LGwuVXBsb2FkZXIucHJvdG90eXBlPXQuY29yZS5FdmVudFRhcmdldC5pbnN0YW5jZSxsLkZpbGU9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUpe2wuZXh0ZW5kKHRoaXMse2lkOmwuZ3VpZCgpLG5hbWU6ZS5uYW1lfHxlLmZpbGVOYW1lLHR5cGU6ZS50eXBlfHxcIlwiLHJlbGF0aXZlUGF0aDplLnJlbGF0aXZlUGF0aHx8XCJcIixzaXplOmUuZmlsZVNpemV8fGUuc2l6ZSxvcmlnU2l6ZTplLmZpbGVTaXplfHxlLnNpemUsbG9hZGVkOjAscGVyY2VudDowLHN0YXR1czpsLlFVRVVFRCxsYXN0TW9kaWZpZWREYXRlOmUubGFzdE1vZGlmaWVkRGF0ZXx8KG5ldyBEYXRlKS50b0xvY2FsZVN0cmluZygpLGNvbXBsZXRlVGltZXN0YW1wOjAsZ2V0TmF0aXZlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5nZXRTb3VyY2UoKS5nZXRTb3VyY2UoKTtyZXR1cm4tMSE9PWwuaW5BcnJheShsLnR5cGVPZihlKSxbXCJibG9iXCIsXCJmaWxlXCJdKT9lOm51bGx9LGdldFNvdXJjZTpmdW5jdGlvbigpe3JldHVybiB0W3RoaXMuaWRdP3RbdGhpcy5pZF06bnVsbH0sZGVzdHJveTpmdW5jdGlvbigpe3ZhciBlPXRoaXMuZ2V0U291cmNlKCk7ZSYmKGUuZGVzdHJveSgpLGRlbGV0ZSB0W3RoaXMuaWRdKX19KSx0W3RoaXMuaWRdPWV9dmFyIHQ9e307cmV0dXJuIGV9KCksbC5RdWV1ZVByb2dyZXNzPWZ1bmN0aW9uKCl7dmFyIGU9dGhpcztlLnNpemU9MCxlLmxvYWRlZD0wLGUudXBsb2FkZWQ9MCxlLmZhaWxlZD0wLGUucXVldWVkPTAsZS5wZXJjZW50PTAsZS5ieXRlc1BlclNlYz0wLGUucmVzZXQ9ZnVuY3Rpb24oKXtlLnNpemU9ZS5sb2FkZWQ9ZS51cGxvYWRlZD1lLmZhaWxlZD1lLnF1ZXVlZD1lLnBlcmNlbnQ9ZS5ieXRlc1BlclNlYz0wfX0sZS5wbHVwbG9hZD1sfSh0aGlzLGUpfSk7IiwidmFyIFZ1ZSAvLyBsYXRlIGJpbmRcbnZhciB2ZXJzaW9uXG52YXIgbWFwID0gKHdpbmRvdy5fX1ZVRV9IT1RfTUFQX18gPSBPYmplY3QuY3JlYXRlKG51bGwpKVxudmFyIGluc3RhbGxlZCA9IGZhbHNlXG52YXIgaXNCcm93c2VyaWZ5ID0gZmFsc2VcbnZhciBpbml0SG9va05hbWUgPSAnYmVmb3JlQ3JlYXRlJ1xuXG5leHBvcnRzLmluc3RhbGwgPSBmdW5jdGlvbiAodnVlLCBicm93c2VyaWZ5KSB7XG4gIGlmIChpbnN0YWxsZWQpIHsgcmV0dXJuIH1cbiAgaW5zdGFsbGVkID0gdHJ1ZVxuXG4gIFZ1ZSA9IHZ1ZS5fX2VzTW9kdWxlID8gdnVlLmRlZmF1bHQgOiB2dWVcbiAgdmVyc2lvbiA9IFZ1ZS52ZXJzaW9uLnNwbGl0KCcuJykubWFwKE51bWJlcilcbiAgaXNCcm93c2VyaWZ5ID0gYnJvd3NlcmlmeVxuXG4gIC8vIGNvbXBhdCB3aXRoIDwgMi4wLjAtYWxwaGEuN1xuICBpZiAoVnVlLmNvbmZpZy5fbGlmZWN5Y2xlSG9va3MuaW5kZXhPZignaW5pdCcpID4gLTEpIHtcbiAgICBpbml0SG9va05hbWUgPSAnaW5pdCdcbiAgfVxuXG4gIGV4cG9ydHMuY29tcGF0aWJsZSA9IHZlcnNpb25bMF0gPj0gMlxuICBpZiAoIWV4cG9ydHMuY29tcGF0aWJsZSkge1xuICAgIGNvbnNvbGUud2FybihcbiAgICAgICdbSE1SXSBZb3UgYXJlIHVzaW5nIGEgdmVyc2lvbiBvZiB2dWUtaG90LXJlbG9hZC1hcGkgdGhhdCBpcyAnICtcbiAgICAgICAgJ29ubHkgY29tcGF0aWJsZSB3aXRoIFZ1ZS5qcyBjb3JlIF4yLjAuMC4nXG4gICAgKVxuICAgIHJldHVyblxuICB9XG59XG5cbi8qKlxuICogQ3JlYXRlIGEgcmVjb3JkIGZvciBhIGhvdCBtb2R1bGUsIHdoaWNoIGtlZXBzIHRyYWNrIG9mIGl0cyBjb25zdHJ1Y3RvclxuICogYW5kIGluc3RhbmNlc1xuICpcbiAqIEBwYXJhbSB7U3RyaW5nfSBpZFxuICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnNcbiAqL1xuXG5leHBvcnRzLmNyZWF0ZVJlY29yZCA9IGZ1bmN0aW9uIChpZCwgb3B0aW9ucykge1xuICBpZihtYXBbaWRdKSB7IHJldHVybiB9XG4gIFxuICB2YXIgQ3RvciA9IG51bGxcbiAgaWYgKHR5cGVvZiBvcHRpb25zID09PSAnZnVuY3Rpb24nKSB7XG4gICAgQ3RvciA9IG9wdGlvbnNcbiAgICBvcHRpb25zID0gQ3Rvci5vcHRpb25zXG4gIH1cbiAgbWFrZU9wdGlvbnNIb3QoaWQsIG9wdGlvbnMpXG4gIG1hcFtpZF0gPSB7XG4gICAgQ3RvcjogQ3RvcixcbiAgICBvcHRpb25zOiBvcHRpb25zLFxuICAgIGluc3RhbmNlczogW11cbiAgfVxufVxuXG4vKipcbiAqIENoZWNrIGlmIG1vZHVsZSBpcyByZWNvcmRlZFxuICpcbiAqIEBwYXJhbSB7U3RyaW5nfSBpZFxuICovXG5cbmV4cG9ydHMuaXNSZWNvcmRlZCA9IGZ1bmN0aW9uIChpZCkge1xuICByZXR1cm4gdHlwZW9mIG1hcFtpZF0gIT09ICd1bmRlZmluZWQnXG59XG5cbi8qKlxuICogTWFrZSBhIENvbXBvbmVudCBvcHRpb25zIG9iamVjdCBob3QuXG4gKlxuICogQHBhcmFtIHtTdHJpbmd9IGlkXG4gKiBAcGFyYW0ge09iamVjdH0gb3B0aW9uc1xuICovXG5cbmZ1bmN0aW9uIG1ha2VPcHRpb25zSG90KGlkLCBvcHRpb25zKSB7XG4gIGlmIChvcHRpb25zLmZ1bmN0aW9uYWwpIHtcbiAgICB2YXIgcmVuZGVyID0gb3B0aW9ucy5yZW5kZXJcbiAgICBvcHRpb25zLnJlbmRlciA9IGZ1bmN0aW9uIChoLCBjdHgpIHtcbiAgICAgIHZhciBpbnN0YW5jZXMgPSBtYXBbaWRdLmluc3RhbmNlc1xuICAgICAgaWYgKGN0eCAmJiBpbnN0YW5jZXMuaW5kZXhPZihjdHgucGFyZW50KSA8IDApIHtcbiAgICAgICAgaW5zdGFuY2VzLnB1c2goY3R4LnBhcmVudClcbiAgICAgIH1cbiAgICAgIHJldHVybiByZW5kZXIoaCwgY3R4KVxuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBpbmplY3RIb29rKG9wdGlvbnMsIGluaXRIb29rTmFtZSwgZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgcmVjb3JkID0gbWFwW2lkXVxuICAgICAgaWYgKCFyZWNvcmQuQ3Rvcikge1xuICAgICAgICByZWNvcmQuQ3RvciA9IHRoaXMuY29uc3RydWN0b3JcbiAgICAgIH1cbiAgICAgIHJlY29yZC5pbnN0YW5jZXMucHVzaCh0aGlzKVxuICAgIH0pXG4gICAgaW5qZWN0SG9vayhvcHRpb25zLCAnYmVmb3JlRGVzdHJveScsIGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGluc3RhbmNlcyA9IG1hcFtpZF0uaW5zdGFuY2VzXG4gICAgICBpbnN0YW5jZXMuc3BsaWNlKGluc3RhbmNlcy5pbmRleE9mKHRoaXMpLCAxKVxuICAgIH0pXG4gIH1cbn1cblxuLyoqXG4gKiBJbmplY3QgYSBob29rIHRvIGEgaG90IHJlbG9hZGFibGUgY29tcG9uZW50IHNvIHRoYXRcbiAqIHdlIGNhbiBrZWVwIHRyYWNrIG9mIGl0LlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zXG4gKiBAcGFyYW0ge1N0cmluZ30gbmFtZVxuICogQHBhcmFtIHtGdW5jdGlvbn0gaG9va1xuICovXG5cbmZ1bmN0aW9uIGluamVjdEhvb2sob3B0aW9ucywgbmFtZSwgaG9vaykge1xuICB2YXIgZXhpc3RpbmcgPSBvcHRpb25zW25hbWVdXG4gIG9wdGlvbnNbbmFtZV0gPSBleGlzdGluZ1xuICAgID8gQXJyYXkuaXNBcnJheShleGlzdGluZykgPyBleGlzdGluZy5jb25jYXQoaG9vaykgOiBbZXhpc3RpbmcsIGhvb2tdXG4gICAgOiBbaG9va11cbn1cblxuZnVuY3Rpb24gdHJ5V3JhcChmbikge1xuICByZXR1cm4gZnVuY3Rpb24gKGlkLCBhcmcpIHtcbiAgICB0cnkge1xuICAgICAgZm4oaWQsIGFyZylcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGUpXG4gICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICdTb21ldGhpbmcgd2VudCB3cm9uZyBkdXJpbmcgVnVlIGNvbXBvbmVudCBob3QtcmVsb2FkLiBGdWxsIHJlbG9hZCByZXF1aXJlZC4nXG4gICAgICApXG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZU9wdGlvbnMgKG9sZE9wdGlvbnMsIG5ld09wdGlvbnMpIHtcbiAgZm9yICh2YXIga2V5IGluIG9sZE9wdGlvbnMpIHtcbiAgICBpZiAoIShrZXkgaW4gbmV3T3B0aW9ucykpIHtcbiAgICAgIGRlbGV0ZSBvbGRPcHRpb25zW2tleV1cbiAgICB9XG4gIH1cbiAgZm9yICh2YXIga2V5JDEgaW4gbmV3T3B0aW9ucykge1xuICAgIG9sZE9wdGlvbnNba2V5JDFdID0gbmV3T3B0aW9uc1trZXkkMV1cbiAgfVxufVxuXG5leHBvcnRzLnJlcmVuZGVyID0gdHJ5V3JhcChmdW5jdGlvbiAoaWQsIG9wdGlvbnMpIHtcbiAgdmFyIHJlY29yZCA9IG1hcFtpZF1cbiAgaWYgKCFvcHRpb25zKSB7XG4gICAgcmVjb3JkLmluc3RhbmNlcy5zbGljZSgpLmZvckVhY2goZnVuY3Rpb24gKGluc3RhbmNlKSB7XG4gICAgICBpbnN0YW5jZS4kZm9yY2VVcGRhdGUoKVxuICAgIH0pXG4gICAgcmV0dXJuXG4gIH1cbiAgaWYgKHR5cGVvZiBvcHRpb25zID09PSAnZnVuY3Rpb24nKSB7XG4gICAgb3B0aW9ucyA9IG9wdGlvbnMub3B0aW9uc1xuICB9XG4gIGlmIChyZWNvcmQuQ3Rvcikge1xuICAgIHJlY29yZC5DdG9yLm9wdGlvbnMucmVuZGVyID0gb3B0aW9ucy5yZW5kZXJcbiAgICByZWNvcmQuQ3Rvci5vcHRpb25zLnN0YXRpY1JlbmRlckZucyA9IG9wdGlvbnMuc3RhdGljUmVuZGVyRm5zXG4gICAgcmVjb3JkLmluc3RhbmNlcy5zbGljZSgpLmZvckVhY2goZnVuY3Rpb24gKGluc3RhbmNlKSB7XG4gICAgICBpbnN0YW5jZS4kb3B0aW9ucy5yZW5kZXIgPSBvcHRpb25zLnJlbmRlclxuICAgICAgaW5zdGFuY2UuJG9wdGlvbnMuc3RhdGljUmVuZGVyRm5zID0gb3B0aW9ucy5zdGF0aWNSZW5kZXJGbnNcbiAgICAgIC8vIHJlc2V0IHN0YXRpYyB0cmVlc1xuICAgICAgLy8gcHJlIDIuNSwgYWxsIHN0YXRpYyB0cmVlcyBhcmUgY2FoY2VkIHRvZ2V0aGVyIG9uIHRoZSBpbnN0YW5jZVxuICAgICAgaWYgKGluc3RhbmNlLl9zdGF0aWNUcmVlcykge1xuICAgICAgICBpbnN0YW5jZS5fc3RhdGljVHJlZXMgPSBbXVxuICAgICAgfVxuICAgICAgLy8gMi41LjBcbiAgICAgIGlmIChBcnJheS5pc0FycmF5KHJlY29yZC5DdG9yLm9wdGlvbnMuY2FjaGVkKSkge1xuICAgICAgICByZWNvcmQuQ3Rvci5vcHRpb25zLmNhY2hlZCA9IFtdXG4gICAgICB9XG4gICAgICAvLyAyLjUuM1xuICAgICAgaWYgKEFycmF5LmlzQXJyYXkoaW5zdGFuY2UuJG9wdGlvbnMuY2FjaGVkKSkge1xuICAgICAgICBpbnN0YW5jZS4kb3B0aW9ucy5jYWNoZWQgPSBbXVxuICAgICAgfVxuICAgICAgLy8gcG9zdCAyLjUuNDogdi1vbmNlIHRyZWVzIGFyZSBjYWNoZWQgb24gaW5zdGFuY2UuX3N0YXRpY1RyZWVzLlxuICAgICAgLy8gUHVyZSBzdGF0aWMgdHJlZXMgYXJlIGNhY2hlZCBvbiB0aGUgc3RhdGljUmVuZGVyRm5zIGFycmF5XG4gICAgICAvLyAoYm90aCBhbHJlYWR5IHJlc2V0IGFib3ZlKVxuICAgICAgaW5zdGFuY2UuJGZvcmNlVXBkYXRlKClcbiAgICB9KVxuICB9IGVsc2Uge1xuICAgIC8vIGZ1bmN0aW9uYWwgb3Igbm8gaW5zdGFuY2UgY3JlYXRlZCB5ZXRcbiAgICByZWNvcmQub3B0aW9ucy5yZW5kZXIgPSBvcHRpb25zLnJlbmRlclxuICAgIHJlY29yZC5vcHRpb25zLnN0YXRpY1JlbmRlckZucyA9IG9wdGlvbnMuc3RhdGljUmVuZGVyRm5zXG5cbiAgICAvLyBoYW5kbGUgZnVuY3Rpb25hbCBjb21wb25lbnQgcmUtcmVuZGVyXG4gICAgaWYgKHJlY29yZC5vcHRpb25zLmZ1bmN0aW9uYWwpIHtcbiAgICAgIC8vIHJlcmVuZGVyIHdpdGggZnVsbCBvcHRpb25zXG4gICAgICBpZiAoT2JqZWN0LmtleXMob3B0aW9ucykubGVuZ3RoID4gMikge1xuICAgICAgICB1cGRhdGVPcHRpb25zKHJlY29yZC5vcHRpb25zLCBvcHRpb25zKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gdGVtcGxhdGUtb25seSByZXJlbmRlci5cbiAgICAgICAgLy8gbmVlZCB0byBpbmplY3QgdGhlIHN0eWxlIGluamVjdGlvbiBjb2RlIGZvciBDU1MgbW9kdWxlc1xuICAgICAgICAvLyB0byB3b3JrIHByb3Blcmx5LlxuICAgICAgICB2YXIgaW5qZWN0U3R5bGVzID0gcmVjb3JkLm9wdGlvbnMuX2luamVjdFN0eWxlc1xuICAgICAgICBpZiAoaW5qZWN0U3R5bGVzKSB7XG4gICAgICAgICAgdmFyIHJlbmRlciA9IG9wdGlvbnMucmVuZGVyXG4gICAgICAgICAgcmVjb3JkLm9wdGlvbnMucmVuZGVyID0gZnVuY3Rpb24gKGgsIGN0eCkge1xuICAgICAgICAgICAgaW5qZWN0U3R5bGVzLmNhbGwoY3R4KVxuICAgICAgICAgICAgcmV0dXJuIHJlbmRlcihoLCBjdHgpXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZWNvcmQub3B0aW9ucy5fQ3RvciA9IG51bGxcbiAgICAgIC8vIDIuNS4zXG4gICAgICBpZiAoQXJyYXkuaXNBcnJheShyZWNvcmQub3B0aW9ucy5jYWNoZWQpKSB7XG4gICAgICAgIHJlY29yZC5vcHRpb25zLmNhY2hlZCA9IFtdXG4gICAgICB9XG4gICAgICByZWNvcmQuaW5zdGFuY2VzLnNsaWNlKCkuZm9yRWFjaChmdW5jdGlvbiAoaW5zdGFuY2UpIHtcbiAgICAgICAgaW5zdGFuY2UuJGZvcmNlVXBkYXRlKClcbiAgICAgIH0pXG4gICAgfVxuICB9XG59KVxuXG5leHBvcnRzLnJlbG9hZCA9IHRyeVdyYXAoZnVuY3Rpb24gKGlkLCBvcHRpb25zKSB7XG4gIHZhciByZWNvcmQgPSBtYXBbaWRdXG4gIGlmIChvcHRpb25zKSB7XG4gICAgaWYgKHR5cGVvZiBvcHRpb25zID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICBvcHRpb25zID0gb3B0aW9ucy5vcHRpb25zXG4gICAgfVxuICAgIG1ha2VPcHRpb25zSG90KGlkLCBvcHRpb25zKVxuICAgIGlmIChyZWNvcmQuQ3Rvcikge1xuICAgICAgaWYgKHZlcnNpb25bMV0gPCAyKSB7XG4gICAgICAgIC8vIHByZXNlcnZlIHByZSAyLjIgYmVoYXZpb3IgZm9yIGdsb2JhbCBtaXhpbiBoYW5kbGluZ1xuICAgICAgICByZWNvcmQuQ3Rvci5leHRlbmRPcHRpb25zID0gb3B0aW9uc1xuICAgICAgfVxuICAgICAgdmFyIG5ld0N0b3IgPSByZWNvcmQuQ3Rvci5zdXBlci5leHRlbmQob3B0aW9ucylcbiAgICAgIHJlY29yZC5DdG9yLm9wdGlvbnMgPSBuZXdDdG9yLm9wdGlvbnNcbiAgICAgIHJlY29yZC5DdG9yLmNpZCA9IG5ld0N0b3IuY2lkXG4gICAgICByZWNvcmQuQ3Rvci5wcm90b3R5cGUgPSBuZXdDdG9yLnByb3RvdHlwZVxuICAgICAgaWYgKG5ld0N0b3IucmVsZWFzZSkge1xuICAgICAgICAvLyB0ZW1wb3JhcnkgZ2xvYmFsIG1peGluIHN0cmF0ZWd5IHVzZWQgaW4gPCAyLjAuMC1hbHBoYS42XG4gICAgICAgIG5ld0N0b3IucmVsZWFzZSgpXG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHVwZGF0ZU9wdGlvbnMocmVjb3JkLm9wdGlvbnMsIG9wdGlvbnMpXG4gICAgfVxuICB9XG4gIHJlY29yZC5pbnN0YW5jZXMuc2xpY2UoKS5mb3JFYWNoKGZ1bmN0aW9uIChpbnN0YW5jZSkge1xuICAgIGlmIChpbnN0YW5jZS4kdm5vZGUgJiYgaW5zdGFuY2UuJHZub2RlLmNvbnRleHQpIHtcbiAgICAgIGluc3RhbmNlLiR2bm9kZS5jb250ZXh0LiRmb3JjZVVwZGF0ZSgpXG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgJ1Jvb3Qgb3IgbWFudWFsbHkgbW91bnRlZCBpbnN0YW5jZSBtb2RpZmllZC4gRnVsbCByZWxvYWQgcmVxdWlyZWQuJ1xuICAgICAgKVxuICAgIH1cbiAgfSlcbn0pXG4iLCJ2YXIgaW5zZXJ0ZWQgPSBleHBvcnRzLmNhY2hlID0ge31cblxuZnVuY3Rpb24gbm9vcCAoKSB7fVxuXG5leHBvcnRzLmluc2VydCA9IGZ1bmN0aW9uIChjc3MpIHtcbiAgaWYgKGluc2VydGVkW2Nzc10pIHJldHVybiBub29wXG4gIGluc2VydGVkW2Nzc10gPSB0cnVlXG5cbiAgdmFyIGVsZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzdHlsZScpXG4gIGVsZW0uc2V0QXR0cmlidXRlKCd0eXBlJywgJ3RleHQvY3NzJylcblxuICBpZiAoJ3RleHRDb250ZW50JyBpbiBlbGVtKSB7XG4gICAgZWxlbS50ZXh0Q29udGVudCA9IGNzc1xuICB9IGVsc2Uge1xuICAgIGVsZW0uc3R5bGVTaGVldC5jc3NUZXh0ID0gY3NzXG4gIH1cblxuICBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaGVhZCcpWzBdLmFwcGVuZENoaWxkKGVsZW0pXG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2hlYWQnKVswXS5yZW1vdmVDaGlsZChlbGVtKVxuICAgIGluc2VydGVkW2Nzc10gPSBmYWxzZVxuICB9XG59XG4iLCI8dGVtcGxhdGU+XHJcbiAgICA8aW5wdXQgcmVmPVwiYnRuXCIgOmNsYXNzPVwiY2xhc3NOYW1lXCIgOnZhbHVlPVwidGV4dFwiIHR5cGU9XCJidXR0b25cIiAvPlxyXG48L3RlbXBsYXRlPlxyXG48c3R5bGU+XHJcbi5wbHVwbG9hZC1idG4ge1xyXG4gICAgY29sb3I6ICNmZmY7XHJcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMzM3YWI3O1xyXG4gICAgYm9yZGVyLWNvbG9yOiAjMmU2ZGE0O1xyXG4gICAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xyXG4gICAgcGFkZGluZzogNnB4IDEycHg7XHJcbiAgICBtYXJnaW4tYm90dG9tOiAwO1xyXG4gICAgZm9udC1zaXplOiAxNHB4O1xyXG4gICAgZm9udC13ZWlnaHQ6IDQwMDtcclxuICAgIGxpbmUtaGVpZ2h0OiAxLjQyODU3MTQzO1xyXG4gICAgdGV4dC1hbGlnbjogY2VudGVyO1xyXG4gICAgdmVydGljYWwtYWxpZ246IG1pZGRsZTtcclxuICAgIHRvdWNoLWFjdGlvbjogbWFuaXB1bGF0aW9uO1xyXG4gICAgY3Vyc29yOiBwb2ludGVyO1xyXG4gICAgdXNlci1zZWxlY3Q6IG5vbmU7XHJcbiAgICBiYWNrZ3JvdW5kLWltYWdlOiBub25lO1xyXG4gICAgYm9yZGVyOiAxcHggc29saWQgdHJhbnNwYXJlbnQ7XHJcbiAgICBib3JkZXItcmFkaXVzOiA0cHg7XHJcbn1cclxuPC9zdHlsZT5cclxuPHNjcmlwdD5cclxudmFyIFZ1ZSA9IGdsb2JhbC5WdWUgfHwgcmVxdWlyZShcInZ1ZVwiKTtcclxudmFyIHBsdXBsb2FkID0gcmVxdWlyZShcInBsdXBsb2FkXCIpO1xyXG52YXIgbWVyZ2UgPSByZXF1aXJlKCdsb2Rhc2gvbWVyZ2UnKTtcclxuXHJcbnZhciB1cGxvYWRlckRlZmF1bHRPcHRpb24gPSB7XHJcbiAgICBydW50aW1lczogJ2h0bWw1LGh0bWw0J1xyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBWdWUuZXh0ZW5kKHtcclxuICAgIHByb3BzOiB7XHJcbiAgICAgICAgY2xhc3NOYW1lOiB7XHJcbiAgICAgICAgICAgIHR5cGU6IFN0cmluZyxcclxuICAgICAgICAgICAgZGVmYXVsdDogXCJwbHVwbG9hZC1idG5cIlxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdGV4dDoge1xyXG4gICAgICAgICAgICB0eXBlOiBTdHJpbmcsXHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IFwiVXBsb2FkXCJcclxuICAgICAgICB9LFxyXG4gICAgICAgIG9wdGlvbnM6IHtcclxuICAgICAgICAgICAgdHlwZTogT2JqZWN0LFxyXG4gICAgICAgICAgICBkZWZhdWx0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBcclxuICAgIG1ldGhvZHM6IHtcclxuICAgICAgICByZW5kZXJVSTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuXHJcbiAgICAgICAgICAgIFZ1ZS5uZXh0VGljayhmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIG9wdCA9IG1lcmdlKHVwbG9hZGVyRGVmYXVsdE9wdGlvbiwgc2VsZi5vcHRpb25zLCB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGJyb3dzZV9idXR0b246IHNlbGYuJHJlZnMuYnRuLFxyXG5cclxuICAgICAgICAgICAgICAgICAgICBpbml0OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFBvc3RJbml0OiBmdW5jdGlvbiAodXBsb2FkZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuJGVtaXQoXCJpbml0XCIsIHVwbG9hZGVyKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgRmlsZXNBZGRlZDogZnVuY3Rpb24gKHVwLCBmaWxlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi4kZW1pdChcImFkZGVkXCIsIHVwLCBmaWxlcylcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFVwbG9hZFByb2dyZXNzOiBmdW5jdGlvbiAodXAsIGZpbGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuJGVtaXQoXCJwcm9ncmVzc1wiLCB1cCwgZmlsZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIEZpbGVVcGxvYWRlZDogZnVuY3Rpb24odXAsIGZpbGUsIHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi4kZW1pdChcInVwbG9hZGVkXCIsIHVwLCBmaWxlLCByZXN1bHQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBFcnJvcjogZnVuY3Rpb24gKHVwLCBlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuJGVtaXQoXCJlcnJvclwiLCB1cCwgZXJyKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgdXBsb2FkZXIgPSBuZXcgcGx1cGxvYWQuVXBsb2FkZXIob3B0KTtcclxuXHJcbiAgICAgICAgICAgICAgICB1cGxvYWRlci5pbml0KCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgbW91bnRlZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMucmVuZGVyVUkoKTtcclxuICAgIH0sXHJcbiAgICBcclxuICAgIHVwZGF0ZWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMucmVuZGVyVUkoKTtcclxuICAgIH1cclxufSk7XHJcblxyXG48L3NjcmlwdD5cclxuIl19
