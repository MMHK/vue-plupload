"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e){if("object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).VuePlupload=e()}}(function(){return function o(a,s,u){function c(t,e){if(!s[t]){if(!a[t]){var i="function"==typeof require&&require;if(!e&&i)return i(t,!0);if(l)return l(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var r=s[t]={exports:{}};a[t][0].call(r.exports,function(e){return c(a[t][1][e]||e)},r,r.exports,o,a,s,u)}return s[t].exports}for(var l="function"==typeof require&&require,e=0;e<u.length;e++)c(u[e]);return c}({1:[function(e,t,i){var n=e("./src/vue-plupload.vue"),r={install:function(e){e.component("vue-plupload",n)}};t.exports=r},{"./src/vue-plupload.vue":6}],2:[function(e,ke,Ue){(function(e){var n="__lodash_hash_undefined__",r=9007199254740991,t="[object Arguments]",i="[object AsyncFunction]",o="[object Function]",a="[object GeneratorFunction]",s="[object Null]",p="[object Object]",u="[object Proxy]",c="[object Undefined]",l=/^\[object .+?Constructor\]$/,d=/^(?:0|[1-9]\d*)$/,f={};f["[object Float32Array]"]=f["[object Float64Array]"]=f["[object Int8Array]"]=f["[object Int16Array]"]=f["[object Int32Array]"]=f["[object Uint8Array]"]=f["[object Uint8ClampedArray]"]=f["[object Uint16Array]"]=f["[object Uint32Array]"]=!0,f[t]=f["[object Array]"]=f["[object ArrayBuffer]"]=f["[object Boolean]"]=f["[object DataView]"]=f["[object Date]"]=f["[object Error]"]=f[o]=f["[object Map]"]=f["[object Number]"]=f[p]=f["[object RegExp]"]=f["[object Set]"]=f["[object String]"]=f["[object WeakMap]"]=!1;var h="object"==_typeof(e)&&e&&e.Object===Object&&e,m="object"==("undefined"==typeof self?"undefined":_typeof(self))&&self&&self.Object===Object&&self,g=h||m||Function("return this")(),v="object"==_typeof(Ue)&&Ue&&!Ue.nodeType&&Ue,x=v&&"object"==_typeof(ke)&&ke&&!ke.nodeType&&ke,y=x&&x.exports===v,w=y&&h.process,_=function(){try{var e=x&&x.require&&x.require("util").types;return e||w&&w.binding&&w.binding("util")}catch(e){}}(),b=_&&_.isTypedArray;var E,R,A,I=Array.prototype,T=Function.prototype,S=Object.prototype,O=g["__core-js_shared__"],D=T.toString,C=S.hasOwnProperty,N=(E=/[^.]+$/.exec(O&&O.keys&&O.keys.IE_PROTO||""))?"Symbol(src)_1."+E:"",L=S.toString,F=D.call(Object),M=RegExp("^"+D.call(C).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),B=y?g.Buffer:void 0,P=g.Symbol,z=g.Uint8Array,k=B?B.allocUnsafe:void 0,U=(R=Object.getPrototypeOf,A=Object,function(e){return R(A(e))}),H=Object.create,j=S.propertyIsEnumerable,q=I.splice,G=P?P.toStringTag:void 0,X=function(){try{var e=ge(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),V=B?B.isBuffer:void 0,W=Math.max,Y=Date.now,$=ge(g,"Map"),J=ge(Object,"create"),Z=function(e){if(!Ce(e))return{};if(H)return H(e);K.prototype=e;var t=new K;return K.prototype=void 0,t};function K(){}function Q(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1])}}function ee(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1])}}function te(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1])}}function ie(e){var t=this.__data__=new ee(e);this.size=t.size}function ne(e,t){var i=Ie(e),n=!i&&Ae(e),r=!i&&!n&&Se(e),o=!i&&!n&&!r&&Fe(e),a=i||n||r||o,s=a?function(e,t){for(var i=-1,n=Array(e);++i<e;)n[i]=t(i);return n}(e.length,String):[],u=s.length;for(var c in e)!t&&!C.call(e,c)||a&&("length"==c||r&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||ve(c,u))||s.push(c);return s}function re(e,t,i){(void 0===i||Re(e[t],i))&&(void 0!==i||t in e)||ae(e,t,i)}function oe(e,t){for(var i=e.length;i--;)if(Re(e[i][0],t))return i;return-1}function ae(e,t,i){"__proto__"==t&&X?X(e,t,{configurable:!0,enumerable:!0,value:i,writable:!0}):e[t]=i}Q.prototype.clear=function(){this.__data__=J?J(null):{},this.size=0},Q.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Q.prototype.get=function(e){var t=this.__data__;if(J){var i=t[e];return i===n?void 0:i}return C.call(t,e)?t[e]:void 0},Q.prototype.has=function(e){var t=this.__data__;return J?void 0!==t[e]:C.call(t,e)},Q.prototype.set=function(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=J&&void 0===t?n:t,this},ee.prototype.clear=function(){this.__data__=[],this.size=0},ee.prototype.delete=function(e){var t=this.__data__,i=oe(t,e);return!(i<0)&&(i==t.length-1?t.pop():q.call(t,i,1),--this.size,!0)},ee.prototype.get=function(e){var t=this.__data__,i=oe(t,e);return i<0?void 0:t[i][1]},ee.prototype.has=function(e){return-1<oe(this.__data__,e)},ee.prototype.set=function(e,t){var i=this.__data__,n=oe(i,e);return n<0?(++this.size,i.push([e,t])):i[n][1]=t,this},te.prototype.clear=function(){this.size=0,this.__data__={hash:new Q,map:new($||ee),string:new Q}},te.prototype.delete=function(e){var t=pe(this,e).delete(e);return this.size-=t?1:0,t},te.prototype.get=function(e){return pe(this,e).get(e)},te.prototype.has=function(e){return pe(this,e).has(e)},te.prototype.set=function(e,t){var i=pe(this,e),n=i.size;return i.set(e,t),this.size+=i.size==n?0:1,this},ie.prototype.clear=function(){this.__data__=new ee,this.size=0},ie.prototype.delete=function(e){var t=this.__data__,i=t.delete(e);return this.size=t.size,i},ie.prototype.get=function(e){return this.__data__.get(e)},ie.prototype.has=function(e){return this.__data__.has(e)},ie.prototype.set=function(e,t){var i=this.__data__;if(i instanceof ee){var n=i.__data__;if(!$||n.length<199)return n.push([e,t]),this.size=++i.size,this;i=this.__data__=new te(n)}return i.set(e,t),this.size=i.size,this};var se,ue=function(e,t,i){for(var n=-1,r=Object(e),o=i(e),a=o.length;a--;){var s=o[se?a:++n];if(!1===t(r[s],s,r))break}return e};function ce(e){return null==e?void 0===e?c:s:G&&G in Object(e)?function(e){var t=C.call(e,G),i=e[G];try{var n=!(e[G]=void 0)}catch(e){}var r=L.call(e);n&&(t?e[G]=i:delete e[G]);return r}(e):function(e){return L.call(e)}(e)}function le(e){return Ne(e)&&ce(e)==t}function de(e){return!(!Ce(e)||function(e){return!!N&&N in e}(e))&&(Oe(e)?M:l).test(function(e){if(null!=e){try{return D.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e))}function fe(e){if(!Ce(e))return function(e){var t=[];if(null!=e)for(var i in Object(e))t.push(i);return t}(e);var t=xe(e),i=[];for(var n in e)("constructor"!=n||!t&&C.call(e,n))&&i.push(n);return i}function he(n,r,o,a,s){n!==r&&ue(r,function(e,t){if(s=s||new ie,Ce(e))!function(e,t,i,n,r,o,a){var s=ye(e,i),u=ye(t,i),c=a.get(u);if(c)return re(e,i,c);var l=o?o(s,u,i+"",e,t,a):void 0,d=void 0===l;if(d){var f=Ie(u),h=!f&&Se(u),m=!f&&!h&&Fe(u);l=u,f||h||m?l=Ie(s)?s:function(e){return Ne(e)&&Te(e)}(s)?function(e,t){var i=-1,n=e.length;t=t||Array(n);for(;++i<n;)t[i]=e[i];return t}(s):h?function(e,t){if(t)return e.slice();var i=e.length,n=k?k(i):new e.constructor(i);return e.copy(n),n}(u,!(d=!1)):m?function(e,t){var i=t?function(e){var t=new e.constructor(e.byteLength);return new z(t).set(new z(e)),t}(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.length)}(u,!(d=!1)):[]:function(e){if(!Ne(e)||ce(e)!=p)return!1;var t=U(e);if(null===t)return!0;var i=C.call(t,"constructor")&&t.constructor;return"function"==typeof i&&i instanceof i&&D.call(i)==F}(u)||Ae(u)?Ae(l=s)?l=function(e){return function(e,t,i,n){var r=!i;i=i||{};var o=-1,a=t.length;for(;++o<a;){var s=t[o],u=n?n(i[s],e[s],s,i,e):void 0;void 0===u&&(u=e[s]),r?ae(i,s,u):(d=u,void 0,f=(c=i)[l=s],C.call(c,l)&&Re(f,d)&&(void 0!==d||l in c)||ae(c,l,d))}var c,l,d,f;return i}(e,Me(e))}(s):Ce(s)&&!Oe(s)||(l=function(e){return"function"!=typeof e.constructor||xe(e)?{}:Z(U(e))}(u)):d=!1}d&&(a.set(u,l),r(l,u,n,o,a),a.delete(u));re(e,i,l)}(n,r,t,o,he,a,s);else{var i=a?a(ye(n,t),e,t+"",n,r,s):void 0;void 0===i&&(i=e),re(n,t,i)}},Me)}function me(e,t){return Ee(function(o,a,s){return a=W(void 0===a?o.length-1:a,0),function(){for(var e=arguments,t=-1,i=W(e.length-a,0),n=Array(i);++t<i;)n[t]=e[a+t];t=-1;for(var r=Array(a+1);++t<a;)r[t]=e[t];return r[a]=s(n),function(e,t,i){switch(i.length){case 0:return e.call(t);case 1:return e.call(t,i[0]);case 2:return e.call(t,i[0],i[1]);case 3:return e.call(t,i[0],i[1],i[2])}return e.apply(t,i)}(o,this,r)}}(e,t,ze),e+"")}function pe(e,t){var i=e.__data__;return function(e){var t=_typeof(e);return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?i["string"==typeof t?"string":"hash"]:i.map}function ge(e,t){var i=function(e,t){return null==e?void 0:e[t]}(e,t);return de(i)?i:void 0}function ve(e,t){var i=_typeof(e);return!!(t=null==t?r:t)&&("number"==i||"symbol"!=i&&d.test(e))&&-1<e&&e%1==0&&e<t}function xe(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||S)}function ye(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var we,_e,be,Ee=(we=X?function(e,t){return X(e,"toString",{configurable:!0,enumerable:!1,value:function(e){return function(){return e}}(t),writable:!0})}:ze,be=_e=0,function(){var e=Y(),t=16-(e-be);if(be=e,0<t){if(800<=++_e)return arguments[0]}else _e=0;return we.apply(void 0,arguments)});function Re(e,t){return e===t||e!=e&&t!=t}var Ae=le(function(){return arguments}())?le:function(e){return Ne(e)&&C.call(e,"callee")&&!j.call(e,"callee")},Ie=Array.isArray;function Te(e){return null!=e&&De(e.length)&&!Oe(e)}var Se=V||function(){return!1};function Oe(e){if(!Ce(e))return!1;var t=ce(e);return t==o||t==a||t==i||t==u}function De(e){return"number"==typeof e&&-1<e&&e%1==0&&e<=r}function Ce(e){var t=_typeof(e);return null!=e&&("object"==t||"function"==t)}function Ne(e){return null!=e&&"object"==_typeof(e)}var Le,Fe=b?(Le=b,function(e){return Le(e)}):function(e){return Ne(e)&&De(e.length)&&!!f[ce(e)]};function Me(e){return Te(e)?ne(e,!0):fe(e)}var Be,Pe=(Be=function(e,t,i){he(e,t,i)},me(function(e,t){var i=-1,n=t.length,r=1<n?t[n-1]:void 0,o=2<n?t[2]:void 0;for(r=3<Be.length&&"function"==typeof r?(n--,r):void 0,o&&function(e,t,i){if(!Ce(i))return!1;var n=_typeof(t);return!!("number"==n?Te(i)&&ve(t,i.length):"string"==n&&t in i)&&Re(i[t],e)}(t[0],t[1],o)&&(r=n<3?void 0:r,n=1),e=Object(e);++i<n;){var a=t[i];a&&Be(e,a,i,r)}return e}));function ze(e){return e}ke.exports=Pe}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(e,t,i){var n,b=!0;function r(){var e={};return function(){(function(a,y){"use strict";var s={};function n(e,t){var i,n=[];for(var r=0;r<e.length;++r){i=s[e[r]]||o(e[r]);if(!i){throw"module definition dependecy not found: "+e[r]}n.push(i)}t.apply(null,n)}function e(e,t,i){if(typeof e!=="string"){throw"invalid module definition, module id must be defined and be a string"}if(t===y){throw"invalid module definition, dependencies must be specified"}if(i===y){throw"invalid module definition, definition function must be specified"}n(t,function(){s[e]=i.apply(null,arguments)})}function f(e){return!!s[e]}function o(e){var t=a;var i=e.split(/[.\/]/);for(var n=0;n<i.length;++n){if(!t[i[n]]){return}t=t[i[n]]}return t}function t(e){for(var t=0;t<e.length;t++){var i=a;var n=e[t];var r=n.split(/[.\/]/);for(var o=0;o<r.length-1;++o){if(i[r[o]]===y){i[r[o]]={}}i=i[r[o]]}i[r[r.length-1]]=s[n]}}e("moxie/core/utils/Basic",[],function(){function s(e){var t;if(e===t){return"undefined"}else if(e===null){return"null"}else if(e.nodeType){return"node"}return{}.toString.call(e).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()}function t(){return c(false,false,arguments)}function e(){return c(true,false,arguments)}function i(){return c(false,true,arguments)}function n(){return c(true,true,arguments)}function r(e){switch(s(e)){case"array":return c(false,true,[[],e]);case"object":return c(false,true,[{},e]);default:return e}}function u(e){switch(s(e)){case"array":return Array.prototype.slice.call(e);case"object":return t({},e)}return e}function c(n,r,e){var o;var a=e[0];l(e,function(e,t){if(t>0){l(e,function(e,t){var i=h(s(e),["array","object"])!==-1;if(e===o||n&&a[t]===o){return true}if(i&&r){e=u(e)}if(s(a[t])===s(e)&&i){c(n,r,[a[t],e])}else{a[t]=e}})}});return a}function o(t,e){for(var i in e){if({}.hasOwnProperty.call(e,i)){t[i]=e[i]}}function n(){this.constructor=t;if(b){var e=function e(t){var i=t.toString().match(/^function\s([^\(\s]+)/);return i?i[1]:false};this.ctorName=e(t)}}n.prototype=e.prototype;t.prototype=new n;t.parent=e.prototype;return t}function l(e,t){var i,n,r,o;if(e){try{i=e.length}catch(e){i=o}if(i===o||typeof i!=="number"){for(n in e){if(e.hasOwnProperty(n)){if(t(e[n],n)===false){return}}}}else{for(r=0;r<i;r++){if(t(e[r],r)===false){return}}}}}function a(e){var t;if(!e||s(e)!=="object"){return true}for(t in e){return false}return true}function d(e,i){var t=0,n=e.length;if(s(i)!=="function"){i=function e(){}}if(!e||!e.length){i()}function r(t){if(s(e[t])==="function"){e[t](function(e){++t<n&&!e?r(t):i(e)})}}r(t)}function f(e,n){var r=0,o=e.length,a=new Array(o);l(e,function(e,i){e(function(e){if(e){return n(e)}var t=[].slice.call(arguments);t.shift();a[i]=t;r++;if(r===o){a.unshift(null);n.apply(this,a)}})})}function h(e,t){if(t){if(Array.prototype.indexOf){return Array.prototype.indexOf.call(t,e)}for(var i=0,n=t.length;i<n;i++){if(t[i]===e){return i}}}return-1}function m(e,t){var i=[];if(s(e)!=="array"){e=[e]}if(s(t)!=="array"){t=[t]}for(var n in e){if(h(e[n],t)===-1){i.push(e[n])}}return i.length?i:false}function p(e,t){var i=[];l(e,function(e){if(h(e,t)!==-1){i.push(e)}});return i.length?i:null}function g(e){var t,i=[];for(t=0;t<e.length;t++){i[t]=e[t]}return i}var v=function(){var n=0;return function(e){var t=(new Date).getTime().toString(32),i;for(i=0;i<5;i++){t+=Math.floor(Math.random()*65535).toString(32)}return(e||"o_")+t+(n++).toString(32)}}();function x(e){if(!e){return e}return String.prototype.trim?String.prototype.trim.call(e):e.toString().replace(/^\s*/,"").replace(/\s*$/,"")}function y(e){if(typeof e!=="string"){return e}var t={t:1099511627776,g:1073741824,m:1048576,k:1024},i;e=/^([0-9\.]+)([tmgk]?)$/.exec(e.toLowerCase().replace(/[^0-9\.tmkg]/g,""));i=e[2];e=+e[1];if(t.hasOwnProperty(i)){e*=t[i]}return Math.floor(e)}function w(e){var n=[].slice.call(arguments,1);return e.replace(/%([a-z])/g,function(e,t){var i=n.shift();switch(t){case"s":return i+"";case"d":return parseInt(i,10);case"f":return parseFloat(i);case"c":return"";default:return i}})}function _(e,t){var i=this;setTimeout(function(){e.call(i)},t||1)}return{guid:v,typeOf:s,extend:t,extendIf:e,extendImmutable:i,extendImmutableIf:n,clone:r,inherit:o,each:l,isEmptyObj:a,inSeries:d,inParallel:f,inArray:h,arrayDiff:m,arrayIntersect:p,toArray:g,trim:x,sprintf:w,parseSizeStr:y,delay:_}});e("moxie/core/utils/Encode",[],function(){var v=function e(t){return unescape(encodeURIComponent(t))};var g=function e(t){return decodeURIComponent(escape(t))};var e=function e(t,i){if(typeof window.atob==="function"){return i?g(window.atob(t)):window.atob(t)}var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var r,o,a,s,u,c,l,d,f=0,h=0,m="",p=[];if(!t){return t}t+="";do{s=n.indexOf(t.charAt(f++));u=n.indexOf(t.charAt(f++));c=n.indexOf(t.charAt(f++));l=n.indexOf(t.charAt(f++));d=s<<18|u<<12|c<<6|l;r=d>>16&255;o=d>>8&255;a=d&255;if(c==64){p[h++]=String.fromCharCode(r)}else if(l==64){p[h++]=String.fromCharCode(r,o)}else{p[h++]=String.fromCharCode(r,o,a)}}while(f<t.length);m=p.join("");return i?g(m):m};var t=function e(t,i){if(i){t=v(t)}if(typeof window.btoa==="function"){return window.btoa(t)}var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var r,o,a,s,u,c,l,d,f=0,h=0,m="",p=[];if(!t){return t}do{r=t.charCodeAt(f++);o=t.charCodeAt(f++);a=t.charCodeAt(f++);d=r<<16|o<<8|a;s=d>>18&63;u=d>>12&63;c=d>>6&63;l=d&63;p[h++]=n.charAt(s)+n.charAt(u)+n.charAt(c)+n.charAt(l)}while(f<t.length);m=p.join("");var g=t.length%3;return(g?m.slice(0,g-3):m)+"===".slice(g||3)};return{utf8_encode:v,utf8_decode:g,atob:e,btoa:t}});e("moxie/core/utils/Env",["moxie/core/utils/Basic"],function(n){var e=function(f){var n="",o="?",h="function",m="undefined",p="object",e="major",t="model",i="name",r="type",a="vendor",s="version",u="architecture",c="console",l="mobile",d="tablet";var g={has:function e(t,i){return i.toLowerCase().indexOf(t.toLowerCase())!==-1},lowerize:function e(t){return t.toLowerCase()}};var v={rgx:function e(){for(var t,i=0,n,r,o,a,s,u,c=arguments;i<c.length;i+=2){var l=c[i],d=c[i+1];if(_typeof(t)===m){t={};for(o in d){a=d[o];if(_typeof(a)===p){t[a[0]]=f}else{t[a]=f}}}for(n=r=0;n<l.length;n++){s=l[n].exec(this.getUA());if(!!s){for(o=0;o<d.length;o++){u=s[++r];a=d[o];if(_typeof(a)===p&&a.length>0){if(a.length==2){if(_typeof(a[1])==h){t[a[0]]=a[1].call(this,u)}else{t[a[0]]=a[1]}}else if(a.length==3){if(_typeof(a[1])===h&&!(a[1].exec&&a[1].test)){t[a[0]]=u?a[1].call(this,u,a[2]):f}else{t[a[0]]=u?u.replace(a[1],a[2]):f}}else if(a.length==4){t[a[0]]=u?a[3].call(this,u.replace(a[1],a[2])):f}}else{t[a]=u?u:f}}break}}if(!!s)break}return t},str:function e(t,i){for(var n in i){if(_typeof(i[n])===p&&i[n].length>0){for(var r=0;r<i[n].length;r++){if(g.has(i[n][r],t)){return n===o?f:n}}}else if(g.has(i[n],t)){return n===o?f:n}}return t}};var x={browser:{oldsafari:{major:{1:["/8","/1","/3"],2:"/4","?":"/"},version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",RT:"ARM"}}}};var y={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[i,s],[/\s(opr)\/([\w\.]+)/i],[[i,"Opera"],s],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi)\/([\w\.-]+)/i],[i,s],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[i,"IE"],s],[/(edge)\/((\d+)?[\w\.]+)/i],[i,s],[/(yabrowser)\/([\w\.]+)/i],[[i,"Yandex"],s],[/(comodo_dragon)\/([\w\.]+)/i],[[i,/_/g," "],s],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i,/(uc\s?browser|qqbrowser)[\/\s]?([\w\.]+)/i],[i,s],[/(dolfin)\/([\w\.]+)/i],[[i,"Dolphin"],s],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[i,"Chrome"],s],[/XiaoMi\/MiuiBrowser\/([\w\.]+)/i],[s,[i,"MIUI Browser"]],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)/i],[s,[i,"Android Browser"]],[/FBAV\/([\w\.]+);/i],[s,[i,"Facebook"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[s,[i,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[s,i],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[i,[s,v.str,x.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[i,s],[/(navigator|netscape)\/([\w\.-]+)/i],[[i,"Netscape"],s],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[i,s]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[s,[i,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[i,s],[/rv\:([\w\.]+).*(gecko)/i],[s,i]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[i,s],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[i,[s,v.str,x.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[i,"Windows"],[s,v.str,x.os.windows.version]],[/\((bb)(10);/i],[[i,"BlackBerry"],s],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],[i,s],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[i,"Symbian"],s],[/\((series40);/i],[i],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[i,"Firefox OS"],s],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[i,s],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[i,"Chromium OS"],s],[/(sunos)\s?([\w\.]+\d)*/i],[[i,"Solaris"],s],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[i,s],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[[i,"iOS"],[s,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[[i,"Mac OS"],[s,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],[i,s]]};var w=function e(t){var i=t||(window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:n);this.getBrowser=function(){return v.rgx.apply(this,y.browser)};this.getEngine=function(){return v.rgx.apply(this,y.engine)};this.getOS=function(){return v.rgx.apply(this,y.os)};this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS()}};this.getUA=function(){return i};this.setUA=function(e){i=e;return this};this.setUA(i)};return w}();function t(e,t,i){var n=0,r=0,o=0,a={dev:-6,alpha:-5,a:-5,beta:-4,b:-4,RC:-3,rc:-3,"#":-2,p:1,pl:1},s=function e(t){t=(""+t).replace(/[_\-+]/g,".");t=t.replace(/([^.\d]+)/g,".$1.").replace(/\.{2,}/g,".");return!t.length?[-8]:t.split(".")},u=function e(t){return!t?0:isNaN(t)?a[t]||-7:parseInt(t,10)};e=s(e);t=s(t);r=Math.max(e.length,t.length);for(n=0;n<r;n++){if(e[n]==t[n]){continue}e[n]=u(e[n]);t[n]=u(t[n]);if(e[n]<t[n]){o=-1;break}else if(e[n]>t[n]){o=1;break}}if(!i){return o}switch(i){case">":case"gt":return o>0;case">=":case"ge":return o>=0;case"<=":case"le":return o<=0;case"==":case"=":case"eq":return o===0;case"<>":case"!=":case"ne":return o!==0;case"":case"<":case"lt":return o<0;default:return null}}var i=function(){var r={access_global_ns:function e(){return!!window.moxie},define_property:function(){return false}(),create_canvas:function e(){var t=document.createElement("canvas");var i=!!(t.getContext&&t.getContext("2d"));r.create_canvas=i;return i},return_response_type:function e(t){try{if(n.inArray(t,["","text","document"])!==-1){return true}else if(window.XMLHttpRequest){var i=new XMLHttpRequest;i.open("get","/");if("responseType"in i){i.responseType=t;if(i.responseType!==t){return false}return true}}}catch(e){}return false},use_blob_uri:function e(){var t=window.URL;r.use_blob_uri=t&&"createObjectURL"in t&&"revokeObjectURL"in t&&(o.browser!=="IE"||o.verComp(o.version,"11.0.46",">="));return r.use_blob_uri},use_data_uri:function(){var e=new Image;e.onload=function(){r.use_data_uri=e.width===1&&e.height===1};setTimeout(function(){e.src="data:image/gif;base64,R0lGODlhAQABAIAAAP8AAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="},1);return false}(),use_data_uri_over32kb:function e(){return r.use_data_uri&&(o.browser!=="IE"||o.version>=9)},use_data_uri_of:function e(t){return r.use_data_uri&&t<33e3||r.use_data_uri_over32kb()},use_fileinput:function e(){if(navigator.userAgent.match(/(Android (1.0|1.1|1.5|1.6|2.0|2.1))|(Windows Phone (OS 7|8.0))|(XBLWP)|(ZuneWP)|(w(eb)?OSBrowser)|(webOS)|(Kindle\/(1.0|2.0|2.5|3.0))/)){return false}var t=document.createElement("input");t.setAttribute("type","file");return r.use_fileinput=!t.disabled},use_webgl:function e(){var t=document.createElement("canvas");var i=null,n;try{i=t.getContext("webgl")||t.getContext("experimental-webgl")}catch(e){}if(!i){i=null}n=!!i;r.use_webgl=n;t=y;return n}};return function(e){var t=[].slice.call(arguments);t.shift();return n.typeOf(r[e])==="function"?r[e].apply(this,t):!!r[e]}}();var r=(new e).getResult();var o={can:i,uaParser:e,browser:r.browser.name,version:r.browser.version,os:r.os.name,osVersion:r.os.version,verComp:t,swf_url:"../flash/Moxie.swf",xap_url:"../silverlight/Moxie.xap",global_event_dispatcher:"moxie.core.EventTarget.instance.dispatchEvent"};o.OS=o.os;if(b){o.debug={runtime:true,events:false};o.log=function(){function e(e){t.appendChild(document.createTextNode(e+"\n"))}if(window&&window.console&&window.console.log&&window.console.log.apply){window.console.log.apply(window.console,arguments)}else if(document){var t=document.getElementById("moxie-console");if(!t){t=document.createElement("pre");t.id="moxie-console";document.body.appendChild(t)}var i=arguments[0];if(n.typeOf(i)==="string"){i=n.sprintf.apply(this,arguments)}else if(n.inArray(n.typeOf(i),["object","array"])!==-1){e(i);return}t.appendChild(document.createTextNode(i+"\n"))}}}return o});e("moxie/core/Exceptions",["moxie/core/utils/Basic"],function(n){function r(e,t){var i;for(i in e){if(e[i]===t){return i}}return null}return{RuntimeError:function(){var i={NOT_INIT_ERR:1,EXCEPTION_ERR:3,NOT_SUPPORTED_ERR:9,JS_ERR:4};function e(e,t){this.code=e;this.name=r(i,e);this.message=this.name+(t||": RuntimeError "+this.code)}n.extend(e,i);e.prototype=Error.prototype;return e}(),OperationNotAllowedException:function(){function e(e){this.code=e;this.name="OperationNotAllowedException"}n.extend(e,{NOT_ALLOWED_ERR:1});e.prototype=Error.prototype;return e}(),ImageError:function(){var t={WRONG_FORMAT:1,MAX_RESOLUTION_ERR:2,INVALID_META_ERR:3};function e(e){this.code=e;this.name=r(t,e);this.message=this.name+": ImageError "+this.code}n.extend(e,t);e.prototype=Error.prototype;return e}(),FileException:function(){var t={NOT_FOUND_ERR:1,SECURITY_ERR:2,ABORT_ERR:3,NOT_READABLE_ERR:4,ENCODING_ERR:5,NO_MODIFICATION_ALLOWED_ERR:6,INVALID_STATE_ERR:7,SYNTAX_ERR:8};function e(e){this.code=e;this.name=r(t,e);this.message=this.name+": FileException "+this.code}n.extend(e,t);e.prototype=Error.prototype;return e}(),DOMException:function(){var t={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};function e(e){this.code=e;this.name=r(t,e);this.message=this.name+": DOMException "+this.code}n.extend(e,t);e.prototype=Error.prototype;return e}(),EventException:function(){function e(e){this.code=e;this.name="EventException"}n.extend(e,{UNSPECIFIED_EVENT_TYPE_ERR:0});e.prototype=Error.prototype;return e}()}});e("moxie/core/utils/Dom",["moxie/core/utils/Env"],function(l){var e=function e(t){if(typeof t!=="string"){return t}return document.getElementById(t)};var n=function e(t,i){if(!t.className){return false}var n=new RegExp("(^|\\s+)"+i+"(\\s+|$)");return n.test(t.className)};var t=function e(t,i){if(!n(t,i)){t.className=!t.className?i:t.className.replace(/\s+$/,"")+" "+i}};var i=function e(t,i){if(t.className){var n=new RegExp("(^|\\s+)"+i+"(\\s+|$)");t.className=t.className.replace(n,function(e,t,i){return t===" "&&i===" "?" ":""})}};var r=function e(t,i){if(t.currentStyle){return t.currentStyle[i]}else if(window.getComputedStyle){return window.getComputedStyle(t,null)[i]}};var o=function e(t,i){var n=0,r=0,o,a=document,s,u;t=t;i=i||a.body;function c(e){var t,i,n=0,r=0;if(e){i=e.getBoundingClientRect();t=a.compatMode==="CSS1Compat"?a.documentElement:a.body;n=i.left+t.scrollLeft;r=i.top+t.scrollTop}return{x:n,y:r}}if(t&&t.getBoundingClientRect&&l.browser==="IE"&&(!a.documentMode||a.documentMode<8)){s=c(t);u=c(i);return{x:s.x-u.x,y:s.y-u.y}}o=t;while(o&&o!=i&&o.nodeType){n+=o.offsetLeft||0;r+=o.offsetTop||0;o=o.offsetParent}o=t.parentNode;while(o&&o!=i&&o.nodeType){n-=o.scrollLeft||0;r-=o.scrollTop||0;o=o.parentNode}return{x:n,y:r}};var a=function e(t){return{w:t.offsetWidth||t.clientWidth,h:t.offsetHeight||t.clientHeight}};return{get:e,hasClass:n,addClass:t,removeClass:i,getStyle:r,getPos:o,getSize:a}});e("moxie/core/EventTarget",["moxie/core/utils/Env","moxie/core/Exceptions","moxie/core/utils/Basic"],function(l,d,f){var h={};function e(){this.uid=f.guid()}f.extend(e.prototype,{init:function e(){if(!this.uid){this.uid=f.guid("uid_")}},addEventListener:function e(t,i,n,r){var o=this,a;if(!this.hasOwnProperty("uid")){this.uid=f.guid("uid_")}t=f.trim(t);if(/\s/.test(t)){f.each(t.split(/\s+/),function(e){o.addEventListener(e,i,n,r)});return}t=t.toLowerCase();n=parseInt(n,10)||0;a=h[this.uid]&&h[this.uid][t]||[];a.push({fn:i,priority:n,scope:r||this});if(!h[this.uid]){h[this.uid]={}}h[this.uid][t]=a},hasEventListener:function e(t){var i;if(t){t=t.toLowerCase();i=h[this.uid]&&h[this.uid][t]}else{i=h[this.uid]}return i?i:false},removeEventListener:function e(t,i){var n=this,r,o;t=t.toLowerCase();if(/\s/.test(t)){f.each(t.split(/\s+/),function(e){n.removeEventListener(e,i)});return}r=h[this.uid]&&h[this.uid][t];if(r){if(i){for(o=r.length-1;o>=0;o--){if(r[o].fn===i){r.splice(o,1);break}}}else{r=[]}if(!r.length){delete h[this.uid][t];if(f.isEmptyObj(h[this.uid])){delete h[this.uid]}}}},removeAllEventListeners:function e(){if(h[this.uid]){delete h[this.uid]}},dispatchEvent:function e(t){var i,n,r,o,a={},s=true,u;if(f.typeOf(t)!=="string"){o=t;if(f.typeOf(o.type)==="string"){t=o.type;if(o.total!==u&&o.loaded!==u){a.total=o.total;a.loaded=o.loaded}a.async=o.async||false}else{throw new d.EventException(d.EventException.UNSPECIFIED_EVENT_TYPE_ERR)}}if(t.indexOf("::")!==-1){(function(e){i=e[0];t=e[1]})(t.split("::"))}else{i=this.uid}t=t.toLowerCase();n=h[i]&&h[i][t];if(n){n.sort(function(e,t){return t.priority-e.priority});r=[].slice.call(arguments);r.shift();a.type=t;r.unshift(a);if(b&&l.debug.events){l.log("%cEvent '%s' fired on %s","color: #999;",a.type,(this.ctorName?this.ctorName+"::":"")+i)}var c=[];f.each(n,function(t){r[0].target=t.scope;if(a.async){c.push(function(e){setTimeout(function(){e(t.fn.apply(t.scope,r)===false)},1)})}else{c.push(function(e){e(t.fn.apply(t.scope,r)===false)})}});if(c.length){f.inSeries(c,function(e){s=!e})}}return s},bindOnce:function e(t,i,n,r){var o=this;o.bind.call(this,t,function e(){o.unbind(t,e);return i.apply(this,arguments)},n,r)},bind:function e(){this.addEventListener.apply(this,arguments)},unbind:function e(){this.removeEventListener.apply(this,arguments)},unbindAll:function e(){this.removeAllEventListeners.apply(this,arguments)},trigger:function e(){return this.dispatchEvent.apply(this,arguments)},handleEventProps:function e(t){var i=this;this.bind(t.join(" "),function(e){var t="on"+e.type.toLowerCase();if(f.typeOf(this[t])==="function"){this[t].apply(this,arguments)}});f.each(t,function(e){e="on"+e.toLowerCase(e);if(f.typeOf(i[e])==="undefined"){i[e]=null}})}});e.instance=new e;return e});e("moxie/runtime/Runtime",["moxie/core/utils/Env","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/EventTarget"],function(c,l,d,i){var n={},f={};function h(e,t,o,i,n){var r=this,a,s=l.guid(t+"_"),u=n||"browser";e=e||{};f[s]=this;o=l.extend({access_binary:false,access_image_binary:false,display_media:false,do_cors:false,drag_and_drop:false,filter_by_extension:true,resize_image:false,report_upload_progress:false,return_response_headers:false,return_response_type:false,return_status_code:true,send_custom_headers:false,select_file:false,select_folder:false,select_multiple:true,send_binary_string:false,send_browser_cookies:true,send_multipart:true,slice_blob:false,stream_upload:false,summon_file_dialog:false,upload_filesize:true,use_http_method:true},o);if(e.preferred_caps){u=h.getMode(i,e.preferred_caps,u)}if(b&&c.debug.runtime){c.log("\tdefault mode: %s",u)}a=function(){var o={};return{exec:function e(t,i,n,r){if(a[i]){if(!o[t]){o[t]={context:this,instance:new a[i]}}if(o[t].instance[n]){return o[t].instance[n].apply(this,r)}}},removeInstance:function e(t){delete o[t]},removeAllInstances:function e(){var i=this;l.each(o,function(e,t){if(l.typeOf(e.instance.destroy)==="function"){e.instance.destroy.call(e.context)}i.removeInstance(t)})}}}();l.extend(this,{initialized:false,uid:s,type:t,mode:h.getMode(i,e.required_caps,u),shimid:s+"_container",clients:0,options:e,can:function e(t,i){var n=arguments[2]||o;if(l.typeOf(t)==="string"&&l.typeOf(i)==="undefined"){t=h.parseCaps(t)}if(l.typeOf(t)==="object"){for(var r in t){if(!this.can(r,t[r],n)){return false}}return true}if(l.typeOf(n[t])==="function"){return n[t].call(this,i)}else{return i===n[t]}},getShimContainer:function e(){var t,i=d.get(this.shimid);if(!i){t=d.get(this.options.container)||document.body;i=document.createElement("div");i.id=this.shimid;i.className="moxie-shim moxie-shim-"+this.type;l.extend(i.style,{position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"});t.appendChild(i);t=null}return i},getShim:function e(){return a},shimExec:function e(t,i){var n=[].slice.call(arguments,2);return r.getShim().exec.call(this,this.uid,t,i,n)},exec:function e(t,i){var n=[].slice.call(arguments,2);if(r[t]&&r[t][i]){return r[t][i].apply(this,n)}return r.shimExec.apply(this,arguments)},destroy:function e(){if(!r){return}var t=d.get(this.shimid);if(t){t.parentNode.removeChild(t)}if(a){a.removeAllInstances()}this.unbindAll();delete f[this.uid];this.uid=null;s=r=a=t=null}});if(this.mode&&e.required_caps&&!this.can(e.required_caps)){this.mode=false}}h.order="html5,flash,silverlight,html4";h.getRuntime=function(e){return f[e]?f[e]:false};h.addConstructor=function(e,t){t.prototype=i.instance;n[e]=t};h.getConstructor=function(e){return n[e]||null};h.getInfo=function(e){var t=h.getRuntime(e);if(t){return{uid:t.uid,type:t.type,mode:t.mode,can:function e(){return t.can.apply(t,arguments)}}}return null};h.parseCaps=function(e){var t={};if(l.typeOf(e)!=="string"){return e||{}}l.each(e.split(","),function(e){t[e]=true});return t};h.can=function(e,t){var i,n=h.getConstructor(e),r;if(n){i=new n({required_caps:t});r=i.mode;i.destroy();return!!r}return false};h.thatCan=function(e,t){var i=(t||h.order).split(/\s*,\s*/);for(var n in i){if(h.can(i[n],e)){return i[n]}}return null};h.getMode=function(n,e,t){var r=null;if(l.typeOf(t)==="undefined"){t="browser"}if(e&&!l.isEmptyObj(n)){l.each(e,function(e,t){if(n.hasOwnProperty(t)){var i=n[t](e);if(typeof i==="string"){i=[i]}if(!r){r=i}else if(!(r=l.arrayIntersect(r,i))){if(b&&c.debug.runtime){c.log("\t\t%s: %s (conflicting mode requested: %s)",t,e,i)}return r=false}}if(b&&c.debug.runtime){c.log("\t\t%s: %s (compatible modes: %s)",t,e,r)}});if(r){return l.inArray(t,r)!==-1?t:r[0]}else if(r===false){return false}}return t};h.getGlobalEventTarget=function(){if(/^moxie\./.test(c.global_event_dispatcher)&&!c.can("access_global_ns")){var e=l.guid("moxie_event_target_");window[e]=function(e,t){i.instance.dispatchEvent(e,t)};c.global_event_dispatcher=e}return c.global_event_dispatcher};h.capTrue=function(){return true};h.capFalse=function(){return false};h.capTest=function(e){return function(){return!!e}};return h});e("moxie/runtime/RuntimeClient",["moxie/core/utils/Env","moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/Runtime"],function(s,u,i,c){return function e(){var a;i.extend(this,{connectRuntime:function e(n){var r=this,t;function o(e){var t,i;if(!e.length){r.trigger("RuntimeError",new u.RuntimeError(u.RuntimeError.NOT_INIT_ERR));a=null;return}t=e.shift().toLowerCase();i=c.getConstructor(t);if(!i){if(b&&s.debug.runtime){s.log("Constructor for '%s' runtime is not available.",t)}o(e);return}if(b&&s.debug.runtime){s.log("Trying runtime: %s",t);s.log(n)}a=new i(n);a.bind("Init",function(){a.initialized=true;if(b&&s.debug.runtime){s.log("Runtime '%s' initialized",a.type)}setTimeout(function(){a.clients++;r.ruid=a.uid;r.trigger("RuntimeInit",a)},1)});a.bind("Error",function(){if(b&&s.debug.runtime){s.log("Runtime '%s' failed to initialize",a.type)}a.destroy();o(e)});a.bind("Exception",function(e,t){var i=t.name+"(#"+t.code+")"+(t.message?", from: "+t.message:"");if(b&&s.debug.runtime){s.log("Runtime '%s' has thrown an exception: %s",this.type,i)}r.trigger("RuntimeError",new u.RuntimeError(u.RuntimeError.EXCEPTION_ERR,i))});if(b&&s.debug.runtime){s.log("\tselected mode: %s",a.mode)}if(!a.mode){a.trigger("Error");return}a.init()}if(i.typeOf(n)==="string"){t=n}else if(i.typeOf(n.ruid)==="string"){t=n.ruid}if(t){a=c.getRuntime(t);if(a){r.ruid=t;a.clients++;return a}else{throw new u.RuntimeError(u.RuntimeError.NOT_INIT_ERR)}}o((n.runtime_order||c.order).split(/\s*,\s*/))},disconnectRuntime:function e(){if(a&&--a.clients<=0){a.destroy()}a=null},getRuntime:function e(){if(a&&a.uid){return a}return a=null},exec:function e(){return a?a.exec.apply(this,arguments):null},can:function e(t){return a?a.can(t):false}})}});e("moxie/file/Blob",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient"],function(o,n,i){var a={};function s(e,t){function r(e,t,i){var n,r=a[this.uid];if(o.typeOf(r)!=="string"||!r.length){return null}n=new s(null,{type:i,size:t-e});n.detach(r.substr(e,n.size));return n}i.call(this);if(e){this.connectRuntime(e)}if(!t){t={}}else if(o.typeOf(t)==="string"){t={data:t}}o.extend(this,{uid:t.uid||o.guid("uid_"),ruid:e,size:t.size||0,type:t.type||"",slice:function e(t,i,n){if(this.isDetached()){return r.apply(this,arguments)}return this.getRuntime().exec.call(this,"Blob","slice",this.getSource(),t,i,n)},getSource:function e(){if(!a[this.uid]){return null}return a[this.uid]},detach:function e(t){if(this.ruid){this.getRuntime().exec.call(this,"Blob","destroy");this.disconnectRuntime();this.ruid=null}t=t||"";if(t.substr(0,5)=="data:"){var i=t.indexOf(";base64,");this.type=t.substring(5,i);t=n.atob(t.substring(i+8))}this.size=t.length;a[this.uid]=t},isDetached:function e(){return!this.ruid&&o.typeOf(a[this.uid])==="string"},destroy:function e(){this.detach();delete a[this.uid]}});if(t.data){this.detach(t.data)}else{a[this.uid]=t}}return s});e("moxie/core/I18n",["moxie/core/utils/Basic"],function(n){var i={};return{addI18n:function e(t){return n.extend(i,t)},translate:function e(t){return i[t]||t},_:function e(t){return this.translate(t)},sprintf:function e(t){var i=[].slice.call(arguments,1);return t.replace(/%[a-z]/g,function(){var e=i.shift();return n.typeOf(e)!=="undefined"?e:""})}}});e("moxie/core/utils/Mime",["moxie/core/utils/Basic","moxie/core/I18n"],function(u,r){var e=""+"application/msword,doc dot,"+"application/pdf,pdf,"+"application/pgp-signature,pgp,"+"application/postscript,ps ai eps,"+"application/rtf,rtf,"+"application/vnd.ms-excel,xls xlb xlt xla,"+"application/vnd.ms-powerpoint,ppt pps pot ppa,"+"application/zip,zip,"+"application/x-shockwave-flash,swf swfl,"+"application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,"+"application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,"+"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,"+"application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,"+"application/vnd.openxmlformats-officedocument.presentationml.template,potx,"+"application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,"+"application/x-javascript,js,"+"application/json,json,"+"audio/mpeg,mp3 mpga mpega mp2,"+"audio/x-wav,wav,"+"audio/x-m4a,m4a,"+"audio/ogg,oga ogg,"+"audio/aiff,aiff aif,"+"audio/flac,flac,"+"audio/aac,aac,"+"audio/ac3,ac3,"+"audio/x-ms-wma,wma,"+"image/bmp,bmp,"+"image/gif,gif,"+"image/jpeg,jpg jpeg jpe,"+"image/photoshop,psd,"+"image/png,png,"+"image/svg+xml,svg svgz,"+"image/tiff,tiff tif,"+"text/plain,asc txt text diff log,"+"text/html,htm html xhtml,"+"text/css,css,"+"text/csv,csv,"+"text/rtf,rtf,"+"video/mpeg,mpeg mpg mpe m2v,"+"video/quicktime,qt mov,"+"video/mp4,mp4,"+"video/x-m4v,m4v,"+"video/x-flv,flv,"+"video/x-ms-wmv,wmv,"+"video/avi,avi,"+"video/webm,webm,"+"video/3gpp,3gpp 3gp,"+"video/3gpp2,3g2,"+"video/vnd.rn-realvideo,rv,"+"video/ogg,ogv,"+"video/x-matroska,mkv,"+"application/vnd.oasis.opendocument.formula-template,otf,"+"application/octet-stream,exe";var a={};var s={};var t=function e(t){var i=t.split(/,/),n,r,o;for(n=0;n<i.length;n+=2){o=i[n+1].split(/ /);for(r=0;r<o.length;r++){a[o[r]]=i[n]}s[i[n]]=o}};var i=function e(t,i){var n,r,o,a,s=[];for(r=0;r<t.length;r++){n=t[r].extensions.toLowerCase().split(/\s*,\s*/);for(o=0;o<n.length;o++){if(n[o]==="*"){return[]}a=s[n[o]];if(i&&/^\w+$/.test(n[o])){s.push("."+n[o])}else if(a&&u.inArray(a,s)===-1){s.push(a)}else if(!a){return[]}}}return s};var o=function e(t){var n=[];u.each(t,function(e){e=e.toLowerCase();if(e==="*"){n=[];return false}var i=e.match(/^(\w+)\/(\*|\w+)$/);if(i){if(i[2]==="*"){u.each(s,function(e,t){if(new RegExp("^"+i[1]+"/").test(t)){[].push.apply(n,s[t])}})}else if(s[e]){[].push.apply(n,s[e])}}});return n};var n=function e(t){var i=[],n=[];if(u.typeOf(t)==="string"){t=u.trim(t).split(/\s*,\s*/)}n=o(t);i.push({title:r.translate("Files"),extensions:n.length?n.join(","):"*"});return i};var c=function e(t){var i=t&&t.match(/\.([^.]+)$/);if(i){return i[1].toLowerCase()}return""};var l=function e(t){return a[c(t)]||""};t(e);return{mimes:a,extensions:s,addMimeType:t,extList2mimes:i,mimes2exts:o,mimes2extList:n,getFileExtension:c,getFileMime:l}});e("moxie/file/FileInput",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Mime","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/core/EventTarget","moxie/core/I18n","moxie/runtime/Runtime","moxie/runtime/RuntimeClient"],function(s,n,r,u,o,e,c,l,d){var f=["ready","change","cancel","mouseenter","mouseleave","mousedown","mouseup"];function t(a){if(b){n.log("Instantiating FileInput...")}var e,t,i;if(s.inArray(s.typeOf(a),["string","node"])!==-1){a={browse_button:a}}t=u.get(a.browse_button);if(!t){throw new o.DOMException(o.DOMException.NOT_FOUND_ERR)}i={accept:[{title:c.translate("All Files"),extensions:"*"}],multiple:false,required_caps:false,container:t.parentNode||document.body};a=s.extend({},i,a);if(typeof a.required_caps==="string"){a.required_caps=l.parseCaps(a.required_caps)}if(typeof a.accept==="string"){a.accept=r.mimes2extList(a.accept)}e=u.get(a.container);if(!e){e=document.body}if(u.getStyle(e,"position")==="static"){e.style.position="relative"}e=t=null;d.call(this);s.extend(this,{uid:s.guid("uid_"),ruid:null,shimid:null,files:null,init:function e(){var t=this;t.bind("RuntimeInit",function(e,o){t.ruid=o.uid;t.shimid=o.shimid;t.bind("Ready",function(){t.trigger("Refresh")},999);t.bind("Refresh",function(){var e,t,i,n,r;i=u.get(a.browse_button);n=u.get(o.shimid);if(i){e=u.getPos(i,u.get(a.container));t=u.getSize(i);r=parseInt(u.getStyle(i,"z-index"),10)||0;if(n){s.extend(n.style,{top:e.y+"px",left:e.x+"px",width:t.w+"px",height:t.h+"px",zIndex:r+1})}}n=i=null});o.exec.call(t,"FileInput","init",a)});t.connectRuntime(s.extend({},a,{required_caps:{select_file:true}}))},getOption:function e(t){return a[t]},setOption:function e(t,i){if(!a.hasOwnProperty(t)){return}var n=a[t];switch(t){case"accept":if(typeof i==="string"){i=r.mimes2extList(i)}break;case"container":case"required_caps":throw new o.FileException(o.FileException.NO_MODIFICATION_ALLOWED_ERR)}a[t]=i;this.exec("FileInput","setOption",t,i);this.trigger("OptionChanged",t,i,n)},disable:function e(t){var i=this.getRuntime();if(i){this.exec("FileInput","disable",s.typeOf(t)==="undefined"?true:t)}},refresh:function e(){this.trigger("Refresh")},destroy:function e(){var t=this.getRuntime();if(t){t.exec.call(this,"FileInput","destroy");this.disconnectRuntime()}if(s.typeOf(this.files)==="array"){s.each(this.files,function(e){e.destroy()})}this.files=null;this.unbindAll()}});this.handleEventProps(f)}t.prototype=e.instance;return t});e("moxie/file/File",["moxie/core/utils/Basic","moxie/core/utils/Mime","moxie/file/Blob"],function(r,o,a){function e(e,t){if(!t){t={}}a.apply(this,arguments);if(!this.type){this.type=o.getFileMime(t.name)}var i;if(t.name){i=t.name.replace(/\\/g,"/");i=i.substr(i.lastIndexOf("/")+1)}else if(this.type){var n=this.type.split("/")[0];i=r.guid((n!==""?n:"file")+"_");if(o.extensions[this.type]){i+="."+o.extensions[this.type][0]}}r.extend(this,{name:i||r.guid("file_"),relativePath:"",lastModifiedDate:t.lastModifiedDate||(new Date).toLocaleString()})}e.prototype=a.prototype;return e});e("moxie/file/FileDrop",["moxie/core/I18n","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/core/utils/Basic","moxie/core/utils/Env","moxie/file/File","moxie/runtime/RuntimeClient","moxie/core/EventTarget","moxie/core/utils/Mime"],function(t,r,e,o,a,i,s,n,u){var c=["ready","dragenter","dragleave","drop","error"];function l(i){if(b){a.log("Instantiating FileDrop...")}var n=this,e;if(typeof i==="string"){i={drop_zone:i}}e={accept:[{title:t.translate("All Files"),extensions:"*"}],required_caps:{drag_and_drop:true}};i=_typeof(i)==="object"?o.extend({},e,i):e;i.container=r.get(i.drop_zone)||document.body;if(r.getStyle(i.container,"position")==="static"){i.container.style.position="relative"}if(typeof i.accept==="string"){i.accept=u.mimes2extList(i.accept)}s.call(n);o.extend(n,{uid:o.guid("uid_"),ruid:null,files:null,init:function e(){n.bind("RuntimeInit",function(e,t){n.ruid=t.uid;t.exec.call(n,"FileDrop","init",i);n.dispatchEvent("ready")});n.connectRuntime(i)},destroy:function e(){var t=this.getRuntime();if(t){t.exec.call(this,"FileDrop","destroy");this.disconnectRuntime()}this.files=null;this.unbindAll()}});this.handleEventProps(c)}l.prototype=n.instance;return l});e("moxie/file/FileReader",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/core/Exceptions","moxie/core/EventTarget","moxie/file/Blob","moxie/runtime/RuntimeClient"],function(t,r,o,e,a,n){var s=["loadstart","progress","load","abort","error","loadend"];function u(){n.call(this);t.extend(this,{uid:t.guid("uid_"),readyState:u.EMPTY,result:null,error:null,readAsBinaryString:function e(t){i.call(this,"readAsBinaryString",t)},readAsDataURL:function e(t){i.call(this,"readAsDataURL",t)},readAsText:function e(t){i.call(this,"readAsText",t)},abort:function e(){this.result=null;if(t.inArray(this.readyState,[u.EMPTY,u.DONE])!==-1){return}else if(this.readyState===u.LOADING){this.readyState=u.DONE}this.exec("FileReader","abort");this.trigger("abort");this.trigger("loadend")},destroy:function e(){this.abort();this.exec("FileReader","destroy");this.disconnectRuntime();this.unbindAll()}});this.handleEventProps(s);this.bind("Error",function(e,t){this.readyState=u.DONE;this.error=t},999);this.bind("Load",function(e){this.readyState=u.DONE},999);function i(e,t){var i=this;this.trigger("loadstart");if(this.readyState===u.LOADING){this.trigger("error",new o.DOMException(o.DOMException.INVALID_STATE_ERR));this.trigger("loadend");return}if(!(t instanceof a)){this.trigger("error",new o.DOMException(o.DOMException.NOT_FOUND_ERR));this.trigger("loadend");return}this.result=null;this.readyState=u.LOADING;if(t.isDetached()){var n=t.getSource();switch(e){case"readAsText":case"readAsBinaryString":this.result=n;break;case"readAsDataURL":this.result="data:"+t.type+";base64,"+r.btoa(n);break}this.readyState=u.DONE;this.trigger("load");this.trigger("loadend")}else{this.connectRuntime(t.ruid);this.exec("FileReader","read",e,t)}}}u.EMPTY=0;u.LOADING=1;u.DONE=2;u.prototype=e.instance;return u});e("moxie/core/utils/Url",["moxie/core/utils/Basic"],function(f){var r=function e(t,i){var n=["source","scheme","authority","userInfo","user","pass","host","port","relative","path","directory","file","query","fragment"],r=n.length,o={http:80,https:443},a={},s=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@\/]*):?([^:@\/]*))?@)?(\[[\da-fA-F:]+\]|[^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/,u=s.exec(t||""),c,l=/^\/\/\w/.test(t);switch(f.typeOf(i)){case"undefined":i=e(document.location.href,false);break;case"string":i=e(i,false);break}while(r--){if(u[r]){a[n[r]]=u[r]}}c=!l&&!a.scheme;if(l||c){a.scheme=i.scheme}if(c){a.host=i.host;a.port=i.port;var d="";if(/^[^\/]/.test(a.path)){d=i.path;if(/\/[^\/]*\.[^\/]*$/.test(d)){d=d.replace(/\/[^\/]+$/,"/")}else{d=d.replace(/\/?$/,"/")}}a.path=d+(a.path||"")}if(!a.port){a.port=o[a.scheme]||80}a.port=parseInt(a.port,10);if(!a.path){a.path="/"}delete a.source;return a};var e=function e(t){var i={http:80,https:443},n=_typeof(t)==="object"?t:r(t);return n.scheme+"://"+n.host+(n.port!==i[n.scheme]?":"+n.port:"")+n.path+(n.query?n.query:"")};var t=function e(t){function i(e){return[e.scheme,e.host,e.port].join("/")}if(typeof t==="string"){t=r(t)}return i(r())===i(t)};return{parseUrl:r,resolveUrl:e,hasSameOrigin:t}});e("moxie/runtime/RuntimeTarget",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(e,t,i){function n(){this.uid=e.guid("uid_");t.call(this);this.destroy=function(){this.disconnectRuntime();this.unbindAll()}}n.prototype=i.instance;return n});e("moxie/file/FileReaderSync",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/utils/Encode"],function(e,t,s){return function(){t.call(this);e.extend(this,{uid:e.guid("uid_"),readAsBinaryString:function e(t){return i.call(this,"readAsBinaryString",t)},readAsDataURL:function e(t){return i.call(this,"readAsDataURL",t)},readAsText:function e(t){return i.call(this,"readAsText",t)}});function i(e,t){if(t.isDetached()){var i=t.getSource();switch(e){case"readAsBinaryString":return i;case"readAsDataURL":return"data:"+t.type+";base64,"+s.btoa(i);case"readAsText":var n="";for(var r=0,o=i.length;r<o;r++){n+=String.fromCharCode(i[r])}return n}}else{var a=this.connectRuntime(t.ruid).exec.call(this,"FileReaderSync","read",e,t);this.disconnectRuntime();return a}}}});e("moxie/xhr/FormData",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/file/Blob"],function(e,s,u){function t(){var o,a=[];s.extend(this,{append:function e(i,t){var n=this,r=s.typeOf(t);if(t instanceof u){o={name:i,value:t}}else if("array"===r){i+="[]";s.each(t,function(e){n.append(i,e)})}else if("object"===r){s.each(t,function(e,t){n.append(i+"["+t+"]",e)})}else if("null"===r||"undefined"===r||"number"===r&&isNaN(t)){n.append(i,"false")}else{a.push({name:i,value:t.toString()})}},hasBlob:function e(){return!!this.getBlob()},getBlob:function e(){return o&&o.value||null},getBlobName:function e(){return o&&o.name||null},each:function e(t){s.each(a,function(e){t(e.value,e.name)});if(o){t(o.value,o.name)}},destroy:function e(){o=null;a=[]}})}return t});e("moxie/xhr/XMLHttpRequest",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/core/EventTarget","moxie/core/utils/Encode","moxie/core/utils/Url","moxie/runtime/Runtime","moxie/runtime/RuntimeTarget","moxie/file/Blob","moxie/file/FileReaderSync","moxie/xhr/FormData","moxie/core/utils/Env","moxie/core/utils/Mime"],function(T,S,e,O,D,C,N,L,t,F,M,B){var P={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Reserved",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",426:"Upgrade Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",510:"Not Extended"};function z(){this.uid=T.guid("uid_")}z.prototype=e.instance;var k=["loadstart","progress","abort","error","load","timeout","loadend"];var i=1,n=2;function U(){var i=this,n={timeout:0,readyState:U.UNSENT,withCredentials:false,status:0,statusText:"",responseType:"",responseXML:null,responseText:null,response:null},s=true,u,c,l={},d,f,o=null,a=null,h=false,m=false,p=false,g=false,v=false,x=false,t,e,r=null,y=null,w={},_,b="",E;T.extend(this,n,{uid:T.guid("uid_"),upload:new z,open:function e(t,i,n,r,o){var a;if(!t||!i){throw new S.DOMException(S.DOMException.SYNTAX_ERR)}if(/[\u0100-\uffff]/.test(t)||O.utf8_encode(t)!==t){throw new S.DOMException(S.DOMException.SYNTAX_ERR)}if(!!~T.inArray(t.toUpperCase(),["CONNECT","DELETE","GET","HEAD","OPTIONS","POST","PUT","TRACE","TRACK"])){c=t.toUpperCase()}if(!!~T.inArray(c,["CONNECT","TRACE","TRACK"])){throw new S.DOMException(S.DOMException.SECURITY_ERR)}i=O.utf8_encode(i);a=D.parseUrl(i);x=D.hasSameOrigin(a);u=D.resolveUrl(i);if((r||o)&&!x){throw new S.DOMException(S.DOMException.INVALID_ACCESS_ERR)}d=r||a.user;f=o||a.pass;s=n||true;if(s===false&&(R("timeout")||R("withCredentials")||R("responseType")!=="")){throw new S.DOMException(S.DOMException.INVALID_ACCESS_ERR)}h=!s;m=false;l={};I.call(this);R("readyState",U.OPENED);this.dispatchEvent("readystatechange")},setRequestHeader:function e(t,i){var n=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","content-transfer-encoding","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"];if(R("readyState")!==U.OPENED||m){throw new S.DOMException(S.DOMException.INVALID_STATE_ERR)}if(/[\u0100-\uffff]/.test(t)||O.utf8_encode(t)!==t){throw new S.DOMException(S.DOMException.SYNTAX_ERR)}t=T.trim(t).toLowerCase();if(!!~T.inArray(t,n)||/^(proxy\-|sec\-)/.test(t)){return false}if(!l[t]){l[t]=i}else{l[t]+=", "+i}return true},hasRequestHeader:function e(t){return t&&l[t.toLowerCase()]||false},getAllResponseHeaders:function e(){return b||""},getResponseHeader:function e(t){t=t.toLowerCase();if(v||!!~T.inArray(t,["set-cookie","set-cookie2"])){return null}if(b&&b!==""){if(!E){E={};T.each(b.split(/\r\n/),function(e){var t=e.split(/:\s+/);if(t.length===2){t[0]=T.trim(t[0]);E[t[0].toLowerCase()]={header:t[0],value:T.trim(t[1])}}})}if(E.hasOwnProperty(t)){return E[t].header+": "+E[t].value}}return null},overrideMimeType:function e(t){var i,n;if(!!~T.inArray(R("readyState"),[U.LOADING,U.DONE])){throw new S.DOMException(S.DOMException.INVALID_STATE_ERR)}t=T.trim(t.toLowerCase());if(/;/.test(t)&&(i=t.match(/^([^;]+)(?:;\scharset\=)?(.*)$/))){t=i[1];if(i[2]){n=i[2]}}if(!B.mimes[t]){throw new S.DOMException(S.DOMException.SYNTAX_ERR)}r=t;y=n},send:function e(t,i){if(T.typeOf(i)==="string"){w={ruid:i}}else if(!i){w={}}else{w=i}if(this.readyState!==U.OPENED||m){throw new S.DOMException(S.DOMException.INVALID_STATE_ERR)}if(t instanceof L){w.ruid=t.ruid;a=t.type||"application/octet-stream"}else if(t instanceof F){if(t.hasBlob()){var n=t.getBlob();w.ruid=n.ruid;a=n.type||"application/octet-stream"}}else if(typeof t==="string"){o="UTF-8";a="text/plain;charset=UTF-8";t=O.utf8_encode(t)}if(!this.withCredentials){this.withCredentials=w.required_caps&&w.required_caps.send_browser_cookies&&!x}p=!h&&this.upload.hasEventListener();v=false;g=!t;if(!h){m=true}A.call(this,t)},abort:function e(){v=true;h=false;if(!~T.inArray(R("readyState"),[U.UNSENT,U.OPENED,U.DONE])){R("readyState",U.DONE);m=false;if(_){_.getRuntime().exec.call(_,"XMLHttpRequest","abort",g)}else{throw new S.DOMException(S.DOMException.INVALID_STATE_ERR)}g=true}else{R("readyState",U.UNSENT)}},destroy:function e(){if(_){if(T.typeOf(_.destroy)==="function"){_.destroy()}_=null}this.unbindAll();if(this.upload){this.upload.unbindAll();this.upload=null}}});this.handleEventProps(k.concat(["readystatechange"]));this.upload.handleEventProps(k);function R(e,t){if(!n.hasOwnProperty(e)){return}if(arguments.length===1){return M.can("define_property")?n[e]:i[e]}else{if(M.can("define_property")){n[e]=t}else{i[e]=t}}}function A(e){var i=this;t=(new Date).getTime();_=new N;function n(){if(_){_.destroy();_=null}i.dispatchEvent("loadend");i=null}function r(t){_.bind("LoadStart",function(e){R("readyState",U.LOADING);i.dispatchEvent("readystatechange");i.dispatchEvent(e);if(p){i.upload.dispatchEvent(e)}});_.bind("Progress",function(e){if(R("readyState")!==U.LOADING){R("readyState",U.LOADING);i.dispatchEvent("readystatechange")}i.dispatchEvent(e)});_.bind("UploadProgress",function(e){if(p){i.upload.dispatchEvent({type:"progress",lengthComputable:false,total:e.total,loaded:e.loaded})}});_.bind("Load",function(e){R("readyState",U.DONE);R("status",Number(t.exec.call(_,"XMLHttpRequest","getStatus")||0));R("statusText",P[R("status")]||"");R("response",t.exec.call(_,"XMLHttpRequest","getResponse",R("responseType")));if(!!~T.inArray(R("responseType"),["text",""])){R("responseText",R("response"))}else if(R("responseType")==="document"){R("responseXML",R("response"))}b=t.exec.call(_,"XMLHttpRequest","getAllResponseHeaders");i.dispatchEvent("readystatechange");if(R("status")>0){if(p){i.upload.dispatchEvent(e)}i.dispatchEvent(e)}else{v=true;i.dispatchEvent("error")}n()});_.bind("Abort",function(e){i.dispatchEvent(e);n()});_.bind("Error",function(e){v=true;R("readyState",U.DONE);i.dispatchEvent("readystatechange");g=true;i.dispatchEvent(e);n()});t.exec.call(_,"XMLHttpRequest","send",{url:u,method:c,async:s,user:d,password:f,headers:l,mimeType:a,encoding:o,responseType:i.responseType,withCredentials:i.withCredentials,options:w},e)}if(typeof w.required_caps==="string"){w.required_caps=C.parseCaps(w.required_caps)}w.required_caps=T.extend({},w.required_caps,{return_response_type:i.responseType});if(e instanceof F){w.required_caps.send_multipart=true}if(!T.isEmptyObj(l)){w.required_caps.send_custom_headers=true}if(!x){w.required_caps.do_cors=true}if(w.ruid){r(_.connectRuntime(w))}else{_.bind("RuntimeInit",function(e,t){r(t)});_.bind("RuntimeError",function(e,t){i.dispatchEvent("RuntimeError",t)});_.connectRuntime(w)}}function I(){R("responseText","");R("responseXML",null);R("response",null);R("status",0);R("statusText","");t=e=null}}U.UNSENT=0;U.OPENED=1;U.HEADERS_RECEIVED=2;U.LOADING=3;U.DONE=4;U.prototype=e.instance;return U});e("moxie/runtime/Transporter",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(f,h,e,t){function m(){var a,n,s,u,r,c;e.call(this);f.extend(this,{uid:f.guid("uid_"),state:m.IDLE,result:null,transport:function e(t,n,i){var r=this;i=f.extend({chunk_size:204798},i);if(a=i.chunk_size%3){i.chunk_size+=3-a}c=i.chunk_size;l.call(this);s=t;u=t.length;if(f.typeOf(i)==="string"||i.ruid){d.call(r,n,this.connectRuntime(i))}else{var o=function e(t,i){r.unbind("RuntimeInit",e);d.call(r,n,i)};this.bind("RuntimeInit",o);this.connectRuntime(i)}},abort:function e(){var t=this;t.state=m.IDLE;if(n){n.exec.call(t,"Transporter","clear");t.trigger("TransportingAborted")}l.call(t)},destroy:function e(){this.unbindAll();n=null;this.disconnectRuntime();l.call(this)}});function l(){u=r=0;s=this.result=null}function d(e,t){var i=this;n=t;i.bind("TransportingProgress",function(e){r=e.loaded;if(r<u&&f.inArray(i.state,[m.IDLE,m.DONE])===-1){o.call(i)}},999);i.bind("TransportingComplete",function(){r=u;i.state=m.DONE;s=null;i.result=n.exec.call(i,"Transporter","getAsBlob",e||"")},999);i.state=m.BUSY;i.trigger("TransportingStarted");o.call(i)}function o(){var e=this,t,i=u-r;if(c>i){c=i}t=h.btoa(s.substr(r,c));n.exec.call(e,"Transporter","receive",t,u)}}m.IDLE=0;m.BUSY=1;m.DONE=2;m.prototype=t.instance;return m});e("moxie/image/Image",["moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/file/FileReaderSync","moxie/xhr/XMLHttpRequest","moxie/runtime/Runtime","moxie/runtime/RuntimeClient","moxie/runtime/Transporter","moxie/core/utils/Env","moxie/core/EventTarget","moxie/file/Blob","moxie/file/File","moxie/core/utils/Encode"],function(c,l,d,e,a,s,t,f,h,i,u,m,p){var g=["progress","load","error","resize","embedded"];function v(){t.call(this);c.extend(this,{uid:c.guid("uid_"),ruid:null,name:"",size:0,width:0,height:0,type:"",meta:{},clone:function e(){this.load.apply(this,arguments)},load:function e(){i.apply(this,arguments)},resize:function e(t){var i=this;var n;var r;var o={x:0,y:0,width:i.width,height:i.height};var a=c.extendIf({width:i.width,height:i.height,type:i.type||"image/jpeg",quality:90,crop:false,fit:true,preserveHeaders:true,resample:"default",multipass:true},t);try{if(!i.size){throw new d.DOMException(d.DOMException.INVALID_STATE_ERR)}if(i.width>v.MAX_RESIZE_WIDTH||i.height>v.MAX_RESIZE_HEIGHT){throw new d.ImageError(d.ImageError.MAX_RESOLUTION_ERR)}n=i.meta&&i.meta.tiff&&i.meta.tiff.Orientation||1;if(c.inArray(n,[5,6,7,8])!==-1){var s=a.width;a.width=a.height;a.height=s}if(a.crop){r=Math.max(a.width/i.width,a.height/i.height);if(t.fit){o.width=Math.min(Math.ceil(a.width/r),i.width);o.height=Math.min(Math.ceil(a.height/r),i.height);r=a.width/o.width}else{o.width=Math.min(a.width,i.width);o.height=Math.min(a.height,i.height);r=1}if(typeof a.crop==="boolean"){a.crop="cc"}switch(a.crop.toLowerCase().replace(/_/,"-")){case"rb":case"right-bottom":o.x=i.width-o.width;o.y=i.height-o.height;break;case"cb":case"center-bottom":o.x=Math.floor((i.width-o.width)/2);o.y=i.height-o.height;break;case"lb":case"left-bottom":o.x=0;o.y=i.height-o.height;break;case"lt":case"left-top":o.x=0;o.y=0;break;case"ct":case"center-top":o.x=Math.floor((i.width-o.width)/2);o.y=0;break;case"rt":case"right-top":o.x=i.width-o.width;o.y=0;break;case"rc":case"right-center":case"right-middle":o.x=i.width-o.width;o.y=Math.floor((i.height-o.height)/2);break;case"lc":case"left-center":case"left-middle":o.x=0;o.y=Math.floor((i.height-o.height)/2);break;case"cc":case"center-center":case"center-middle":default:o.x=Math.floor((i.width-o.width)/2);o.y=Math.floor((i.height-o.height)/2)}o.x=Math.max(o.x,0);o.y=Math.max(o.y,0)}else{r=Math.min(a.width/i.width,a.height/i.height);if(r>1&&!a.fit){r=1}}this.exec("Image","resize",o,r,a)}catch(e){i.trigger("error",e.code)}},downsize:function e(t){var i={width:this.width,height:this.height,type:this.type||"image/jpeg",quality:90,crop:false,fit:false,preserveHeaders:true,resample:"default"},n;if(_typeof(t)==="object"){n=c.extend(i,t)}else{n=c.extend(i,{width:arguments[0],height:arguments[1],crop:arguments[2],preserveHeaders:arguments[3]})}this.resize(n)},crop:function e(t,i,n){this.downsize(t,i,true,n)},getAsCanvas:function e(){if(!h.can("create_canvas")){throw new d.RuntimeError(d.RuntimeError.NOT_SUPPORTED_ERR)}return this.exec("Image","getAsCanvas")},getAsBlob:function e(t,i){if(!this.size){throw new d.DOMException(d.DOMException.INVALID_STATE_ERR)}return this.exec("Image","getAsBlob",t||"image/jpeg",i||90)},getAsDataURL:function e(t,i){if(!this.size){throw new d.DOMException(d.DOMException.INVALID_STATE_ERR)}return this.exec("Image","getAsDataURL",t||"image/jpeg",i||90)},getAsBinaryString:function e(t,i){var n=this.getAsDataURL(t,i);return p.atob(n.substring(n.indexOf("base64,")+7))},embed:function e(a,t){var s=this,u;var i=c.extend({width:this.width,height:this.height,type:this.type||"image/jpeg",quality:90,fit:true,resample:"nearest"},t);function n(e,t){var i=this;if(h.can("create_canvas")){var n=i.getAsCanvas();if(n){a.appendChild(n);n=null;i.destroy();s.trigger("embedded");return}}var r=i.getAsDataURL(e,t);if(!r){throw new d.ImageError(d.ImageError.WRONG_FORMAT)}if(h.can("use_data_uri_of",r.length)){a.innerHTML='<img src="'+r+'" width="'+i.width+'" height="'+i.height+'" alt="" />';i.destroy();s.trigger("embedded")}else{var o=new f;o.bind("TransportingComplete",function(){u=s.connectRuntime(this.result.ruid);s.bind("Embedded",function(){c.extend(u.getShimContainer().style,{top:"0px",left:"0px",width:i.width+"px",height:i.height+"px"});u=null},999);u.exec.call(s,"ImageView","display",this.result.uid,width,height);i.destroy()});o.transport(p.atob(r.substring(r.indexOf("base64,")+7)),e,{required_caps:{display_media:true},runtime_order:"flash,silverlight",container:a})}}try{if(!(a=l.get(a))){throw new d.DOMException(d.DOMException.INVALID_NODE_TYPE_ERR)}if(!this.size){throw new d.DOMException(d.DOMException.INVALID_STATE_ERR)}if(this.width>v.MAX_RESIZE_WIDTH||this.height>v.MAX_RESIZE_HEIGHT){}var r=new v;r.bind("Resize",function(){n.call(this,i.type,i.quality)});r.bind("Load",function(){this.downsize(i)});if(this.meta.thumb&&this.meta.thumb.width>=i.width&&this.meta.thumb.height>=i.height){r.load(this.meta.thumb.data)}else{r.clone(this,false)}return r}catch(e){this.trigger("error",e.code)}},destroy:function e(){if(this.ruid){this.getRuntime().exec.call(this,"Image","destroy");this.disconnectRuntime()}if(this.meta&&this.meta.thumb){this.meta.thumb.data.destroy()}this.unbindAll()}});this.handleEventProps(g);this.bind("Load Resize",function(){return e.call(this)},999);function e(e){try{if(!e){e=this.exec("Image","getInfo")}this.size=e.size;this.width=e.width;this.height=e.height;this.type=e.type;this.meta=e.meta;if(this.name===""){this.name=e.name}return true}catch(e){this.trigger("error",e.code);return false}}function i(e){var t=c.typeOf(e);try{if(e instanceof v){if(!e.size){throw new d.DOMException(d.DOMException.INVALID_STATE_ERR)}n.apply(this,arguments)}else if(e instanceof u){if(!~c.inArray(e.type,["image/jpeg","image/png"])){throw new d.ImageError(d.ImageError.WRONG_FORMAT)}r.apply(this,arguments)}else if(c.inArray(t,["blob","file"])!==-1){i.call(this,new m(null,e),arguments[1])}else if(t==="string"){if(e.substr(0,5)==="data:"){i.call(this,new u(null,{data:e}),arguments[1])}else{o.apply(this,arguments)}}else if(t==="node"&&e.nodeName.toLowerCase()==="img"){i.call(this,e.src,arguments[1])}else{throw new d.DOMException(d.DOMException.TYPE_MISMATCH_ERR)}}catch(e){this.trigger("error",e.code)}}function n(e,t){var i=this.connectRuntime(e.ruid);this.ruid=i.uid;i.exec.call(this,"Image","loadFromImage",e,c.typeOf(t)==="undefined"?true:t)}function r(t,e){var i=this;i.name=t.name||"";function n(e){i.ruid=e.uid;e.exec.call(i,"Image","loadFromBlob",t)}if(t.isDetached()){this.bind("RuntimeInit",function(e,t){n(t)});if(e&&typeof e.required_caps==="string"){e.required_caps=s.parseCaps(e.required_caps)}this.connectRuntime(c.extend({required_caps:{access_image_binary:true,resize_image:true}},e))}else{n(this.connectRuntime(t.ruid))}}function o(e,t){var i=this,n;n=new a;n.open("get",e);n.responseType="blob";n.onprogress=function(e){i.trigger(e)};n.onload=function(){r.call(i,n.response,true)};n.onerror=function(e){i.trigger(e)};n.onloadend=function(){n.destroy()};n.bind("RuntimeError",function(e,t){i.trigger("RuntimeError",t)});n.send(null,t)}}v.MAX_RESIZE_WIDTH=8192;v.MAX_RESIZE_HEIGHT=8192;v.prototype=i.instance;return v});e("moxie/runtime/html5/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(o,e,a,s){var u="html5",c={};function t(e){var t=this,i=a.capTest,n=a.capTrue;var r=o.extend({access_binary:i(window.FileReader||window.File&&window.File.getAsDataURL),access_image_binary:function e(){return t.can("access_binary")&&!!c.Image},display_media:i((s.can("create_canvas")||s.can("use_data_uri_over32kb"))&&f("moxie/image/Image")),do_cors:i(window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest),drag_and_drop:i(function(){var e=document.createElement("div");return("draggable"in e||"ondragstart"in e&&"ondrop"in e)&&(s.browser!=="IE"||s.verComp(s.version,9,">"))}()),filter_by_extension:i(function(){return!(s.browser==="Chrome"&&s.verComp(s.version,28,"<")||s.browser==="IE"&&s.verComp(s.version,10,"<")||s.browser==="Safari"&&s.verComp(s.version,7,"<")||s.browser==="Firefox"&&s.verComp(s.version,37,"<"))}()),return_response_headers:n,return_response_type:function e(t){if(t==="json"&&!!window.JSON){return true}return s.can("return_response_type",t)},return_status_code:n,report_upload_progress:i(window.XMLHttpRequest&&(new XMLHttpRequest).upload),resize_image:function e(){return t.can("access_binary")&&s.can("create_canvas")},select_file:function e(){return s.can("use_fileinput")&&window.File},select_folder:function e(){return t.can("select_file")&&(s.browser==="Chrome"&&s.verComp(s.version,21,">=")||s.browser==="Firefox"&&s.verComp(s.version,42,">="))},select_multiple:function e(){return t.can("select_file")&&!(s.browser==="Safari"&&s.os==="Windows")&&!(s.os==="iOS"&&s.verComp(s.osVersion,"7.0.0",">")&&s.verComp(s.osVersion,"8.0.0","<"))},send_binary_string:i(window.XMLHttpRequest&&((new XMLHttpRequest).sendAsBinary||window.Uint8Array&&window.ArrayBuffer)),send_custom_headers:i(window.XMLHttpRequest),send_multipart:function e(){return!!(window.XMLHttpRequest&&(new XMLHttpRequest).upload&&window.FormData)||t.can("send_binary_string")},slice_blob:i(window.File&&(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice)),stream_upload:function e(){return t.can("slice_blob")&&t.can("send_multipart")},summon_file_dialog:function e(){return t.can("select_file")&&!(s.browser==="Firefox"&&s.verComp(s.version,4,"<")||s.browser==="Opera"&&s.verComp(s.version,12,"<")||s.browser==="IE"&&s.verComp(s.version,10,"<"))},upload_filesize:n,use_http_method:n},arguments[2]);a.call(this,e,arguments[1]||u,r);o.extend(this,{init:function e(){this.trigger("Init")},destroy:function(e){return function(){e.call(t);e=t=null}}(this.destroy)});o.extend(this.getShim(),c)}a.addConstructor(u,t);return c});e("moxie/runtime/html5/file/Blob",["moxie/runtime/html5/Runtime","moxie/file/Blob"],function(e,t){function i(){function e(t,i,n){var e;if(window.File.prototype.slice){try{t.slice();return t.slice(i,n)}catch(e){return t.slice(i,n-i)}}else if(e=window.File.prototype.webkitSlice||window.File.prototype.mozSlice){return e.call(t,i,n)}else{return null}}this.slice=function(){return new t(this.getRuntime().uid,e.apply(this,arguments))};this.destroy=function(){this.getRuntime().getShim().removeInstance(this.uid)}}return e.Blob=i});e("moxie/core/utils/Events",["moxie/core/utils/Basic"],function(s){var u={},c="moxie_"+s.guid();function l(){this.returnValue=false}function d(){this.cancelBubble=true}var e=function e(t,i,n,r){var o,a;i=i.toLowerCase();if(t.addEventListener){o=n;t.addEventListener(i,o,false)}else if(t.attachEvent){o=function e(){var t=window.event;if(!t.target){t.target=t.srcElement}t.preventDefault=l;t.stopPropagation=d;n(t)};t.attachEvent("on"+i,o)}if(!t[c]){t[c]=s.guid()}if(!u.hasOwnProperty(t[c])){u[t[c]]={}}a=u[t[c]];if(!a.hasOwnProperty(i)){a[i]=[]}a[i].push({func:o,orig:n,key:r})};var r=function e(t,i,n){var r,o;i=i.toLowerCase();if(t[c]&&u[t[c]]&&u[t[c]][i]){r=u[t[c]][i]}else{return}for(var a=r.length-1;a>=0;a--){if(r[a].orig===n||r[a].key===n){if(t.removeEventListener){t.removeEventListener(i,r[a].func,false)}else if(t.detachEvent){t.detachEvent("on"+i,r[a].func)}r[a].orig=null;r[a].func=null;r.splice(a,1);if(n!==o){break}}}if(!r.length){delete u[t[c]][i]}if(s.isEmptyObj(u[t[c]])){delete u[t[c]];try{delete t[c]}catch(e){t[c]=o}}};var t=function e(i,n){if(!i||!i[c]){return}s.each(u[i[c]],function(e,t){r(i,t,n)})};return{addEvent:e,removeEvent:r,removeAllEvents:t}});e("moxie/runtime/html5/file/FileInput",["moxie/runtime/html5/Runtime","moxie/file/File","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime","moxie/core/utils/Env"],function(e,f,h,m,p,g,v){function t(){var l,d;h.extend(this,{init:function e(t){var i=this,n=i.getRuntime(),r,o,a,s,u,c;l=t;a=g.extList2mimes(l.accept,n.can("filter_by_extension"));o=n.getShimContainer();o.innerHTML='<input id="'+n.uid+'" type="file" style="font-size:999px;opacity:0;"'+(l.multiple&&n.can("select_multiple")?"multiple":"")+(l.directory&&n.can("select_folder")?"webkitdirectory directory":"")+(a?' accept="'+a.join(",")+'"':"")+" />";r=m.get(n.uid);h.extend(r.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"});s=m.get(l.browse_button);d=m.getStyle(s,"z-index")||"auto";if(n.can("summon_file_dialog")){if(m.getStyle(s,"position")==="static"){s.style.position="relative"}p.addEvent(s,"click",function(e){var t=m.get(n.uid);if(t&&!t.disabled){t.click()}e.preventDefault()},i.uid);i.bind("Refresh",function(){u=parseInt(d,10)||1;m.get(l.browse_button).style.zIndex=u;this.getRuntime().getShimContainer().style.zIndex=u-1})}c=n.can("summon_file_dialog")?s:o;p.addEvent(c,"mouseover",function(){i.trigger("mouseenter")},i.uid);p.addEvent(c,"mouseout",function(){i.trigger("mouseleave")},i.uid);p.addEvent(c,"mousedown",function(){i.trigger("mousedown")},i.uid);p.addEvent(m.get(l.container),"mouseup",function(){i.trigger("mouseup")},i.uid);(n.can("summon_file_dialog")?r:s).setAttribute("tabindex",-1);r.onchange=function e(){i.files=[];h.each(this.files,function(e){var t="";if(l.directory){if(e.name=="."){return true}}if(e.webkitRelativePath){t="/"+e.webkitRelativePath.replace(/^\//,"")}e=new f(n.uid,e);e.relativePath=t;i.files.push(e)});if(v.browser!=="IE"&&v.browser!=="IEMobile"){this.value=""}else{var t=this.cloneNode(true);this.parentNode.replaceChild(t,this);t.onchange=e}if(i.files.length){i.trigger("change")}};i.trigger({type:"ready",async:true});o=null},setOption:function e(t,i){var n=this.getRuntime();var r=m.get(n.uid);switch(t){case"accept":if(i){var o=i.mimes||g.extList2mimes(i,n.can("filter_by_extension"));r.setAttribute("accept",o.join(","))}else{r.removeAttribute("accept")}break;case"directory":if(i&&n.can("select_folder")){r.setAttribute("directory","");r.setAttribute("webkitdirectory","")}else{r.removeAttribute("directory");r.removeAttribute("webkitdirectory")}break;case"multiple":if(i&&n.can("select_multiple")){r.setAttribute("multiple","")}else{r.removeAttribute("multiple")}}},disable:function e(t){var i=this.getRuntime(),n;if(n=m.get(i.uid)){n.disabled=!!t}},destroy:function e(){var t=this.getRuntime(),i=t.getShim(),n=t.getShimContainer(),r=l&&m.get(l.container),o=l&&m.get(l.browse_button);if(r){p.removeAllEvents(r,this.uid)}if(o){p.removeAllEvents(o,this.uid);o.style.zIndex=d}if(n){p.removeAllEvents(n,this.uid);n.innerHTML=""}i.removeInstance(this.uid);l=n=r=o=i=null}})}return e.FileInput=t});e("moxie/runtime/html5/file/FileDrop",["moxie/runtime/html5/Runtime","moxie/file/File","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime"],function(e,m,p,t,g,i){function n(){var r=[],o=[],a,s;p.extend(this,{init:function e(t){var i=this,n;a=t;s=i.ruid;o=l(a.accept);n=a.container;g.addEvent(n,"dragover",function(e){if(!u(e)){return}e.preventDefault();e.dataTransfer.dropEffect="copy"},i.uid);g.addEvent(n,"drop",function(e){if(!u(e)){return}e.preventDefault();r=[];if(e.dataTransfer.items&&e.dataTransfer.items[0].webkitGetAsEntry){d(e.dataTransfer.items,function(){i.files=r;i.trigger("drop")})}else{p.each(e.dataTransfer.files,function(e){c(e)});i.files=r;i.trigger("drop")}},i.uid);g.addEvent(n,"dragenter",function(e){i.trigger("dragenter")},i.uid);g.addEvent(n,"dragleave",function(e){i.trigger("dragleave")},i.uid)},destroy:function e(){g.removeAllEvents(a&&t.get(a.container),this.uid);s=r=o=a=null;this.getRuntime().getShim().removeInstance(this.uid)}});function u(e){if(!e.dataTransfer||!e.dataTransfer.types){return false}var t=p.toArray(e.dataTransfer.types||[]);return p.inArray("Files",t)!==-1||p.inArray("public.file-url",t)!==-1||p.inArray("application/x-moz-file",t)!==-1}function c(e,t){if(n(e)){var i=new m(s,e);i.relativePath=t||"";r.push(i)}}function l(e){var t=[];for(var i=0;i<e.length;i++){[].push.apply(t,e[i].extensions.split(/\s*,\s*/))}return p.inArray("*",t)===-1?t:[]}function n(e){if(!o.length){return true}var t=i.getFileExtension(e.name);return!t||p.inArray(t,o)!==-1}function d(e,t){var i=[];p.each(e,function(e){var t=e.webkitGetAsEntry();if(t){if(t.isFile){c(e.getAsFile(),t.fullPath)}else{i.push(t)}}});if(i.length){f(i,t)}else{t()}}function f(e,t){var i=[];p.each(e,function(t){i.push(function(e){h(t,e)})});p.inSeries(i,function(){t()})}function h(t,i){if(t.isFile){t.file(function(e){c(e,t.fullPath);i()},function(){i()})}else if(t.isDirectory){e(t,i)}else{i()}}function e(e,t){var i=[],n=e.createReader();function r(t){n.readEntries(function(e){if(e.length){[].push.apply(i,e);r(t)}else{t()}},t)}r(function(){f(i,t)})}}return e.FileDrop=n});e("moxie/runtime/html5/file/FileReader",["moxie/runtime/html5/Runtime","moxie/core/utils/Encode","moxie/core/utils/Basic"],function(e,t,s){function i(){var r,o=false;s.extend(this,{read:function e(t,i){var n=this;n.result="";r=new window.FileReader;r.addEventListener("progress",function(e){n.trigger(e)});r.addEventListener("load",function(e){n.result=o?a(r.result):r.result;n.trigger(e)});r.addEventListener("error",function(e){n.trigger(e,r.error)});r.addEventListener("loadend",function(e){r=null;n.trigger(e)});if(s.typeOf(r[t])==="function"){o=false;r[t](i.getSource())}else if(t==="readAsBinaryString"){o=true;r.readAsDataURL(i.getSource())}},abort:function e(){if(r){r.abort()}},destroy:function e(){r=null;this.getRuntime().getShim().removeInstance(this.uid)}});function a(e){return t.atob(e.substring(e.indexOf("base64,")+7))}}return e.FileReader=i});e("moxie/runtime/html5/xhr/XMLHttpRequest",["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/utils/Mime","moxie/core/utils/Url","moxie/file/File","moxie/file/Blob","moxie/xhr/FormData","moxie/core/Exceptions","moxie/core/utils/Env"],function(e,h,s,m,p,g,v,x,y){function t(){var o=this,u,c;h.extend(this,{send:function e(n,i){var r=this,t=y.browser==="Mozilla"&&y.verComp(y.version,4,">=")&&y.verComp(y.version,7,"<"),o=y.browser==="Android Browser",a=false;c=n.url.replace(/^.+?\/([\w\-\.]+)$/,"$1").toLowerCase();u=d();u.open(n.method,n.url,n.async,n.user,n.password);if(i instanceof g){if(i.isDetached()){a=true}i=i.getSource()}else if(i instanceof v){if(i.hasBlob()){if(i.getBlob().isDetached()){i=f.call(r,i);a=true}else if((t||o)&&h.typeOf(i.getBlob().getSource())==="blob"&&window.FileReader){l.call(r,n,i);return}}if(i instanceof v){var s=new window.FormData;i.each(function(e,t){if(e instanceof g){s.append(t,e.getSource())}else{s.append(t,e)}});i=s}}if(u.upload){if(n.withCredentials){u.withCredentials=true}u.addEventListener("load",function(e){r.trigger(e)});u.addEventListener("error",function(e){r.trigger(e)});u.addEventListener("progress",function(e){r.trigger(e)});u.upload.addEventListener("progress",function(e){r.trigger({type:"UploadProgress",loaded:e.loaded,total:e.total})})}else{u.onreadystatechange=function e(){switch(u.readyState){case 1:break;case 2:break;case 3:var t,i;try{if(m.hasSameOrigin(n.url)){t=u.getResponseHeader("Content-Length")||0}if(u.responseText){i=u.responseText.length}}catch(e){t=i=0}r.trigger({type:"progress",lengthComputable:!!t,total:parseInt(t,10),loaded:i});break;case 4:u.onreadystatechange=function(){};try{if(u.status>=200&&u.status<400){r.trigger("load");break}}catch(e){}r.trigger("error");break}}}if(!h.isEmptyObj(n.headers)){h.each(n.headers,function(e,t){u.setRequestHeader(t,e)})}if(""!==n.responseType&&"responseType"in u){if("json"===n.responseType&&!y.can("return_response_type","json")){u.responseType="text"}else{u.responseType=n.responseType}}if(!a){u.send(i)}else{if(u.sendAsBinary){u.sendAsBinary(i)}else{(function(){var e=new Uint8Array(i.length);for(var t=0;t<i.length;t++){e[t]=i.charCodeAt(t)&255}u.send(e.buffer)})()}}r.trigger("loadstart")},getStatus:function e(){try{if(u){return u.status}}catch(e){}return 0},getResponse:function e(t){var i=this.getRuntime();try{switch(t){case"blob":var n=new p(i.uid,u.response);var r=u.getResponseHeader("Content-Disposition");if(r){var o=r.match(/filename=([\'\"'])([^\1]+)\1/);if(o){c=o[2]}}n.name=c;if(!n.type){n.type=s.getFileMime(c)}return n;case"json":if(!y.can("return_response_type","json")){return u.status===200&&!!window.JSON?JSON.parse(u.responseText):null}return u.response;case"document":return a(u);default:return u.responseText!==""?u.responseText:null}}catch(e){return null}},getAllResponseHeaders:function e(){try{return u.getAllResponseHeaders()}catch(e){}return""},abort:function e(){if(u){u.abort()}},destroy:function e(){o=c=null;this.getRuntime().getShim().removeInstance(this.uid)}});function l(e,t){var i=this,n,r;n=t.getBlob().getSource();r=new window.FileReader;r.onload=function(){t.append(t.getBlobName(),new g(null,{type:n.type,data:r.result}));o.send.call(i,e,t)};r.readAsBinaryString(n)}function d(){if(window.XMLHttpRequest&&!(y.browser==="IE"&&y.verComp(y.version,8,"<"))){return new window.XMLHttpRequest}else{return function(){var e=["Msxml2.XMLHTTP.6.0","Microsoft.XMLHTTP"];for(var t=0;t<e.length;t++){try{return new ActiveXObject(e[t])}catch(e){}}}()}}function a(e){var t=e.responseXML;var i=e.responseText;if(y.browser==="IE"&&i&&t&&!t.documentElement&&/[^\/]+\/[^\+]+\+xml/.test(e.getResponseHeader("Content-Type"))){t=new window.ActiveXObject("Microsoft.XMLDOM");t.async=false;t.validateOnParse=false;t.loadXML(i)}if(t){if(y.browser==="IE"&&t.parseError!==0||!t.documentElement||t.documentElement.tagName==="parsererror"){return null}}return t}function f(e){var i="----moxieboundary"+(new Date).getTime(),n="--",r="\r\n",o="",t=this.getRuntime();if(!t.can("send_binary_string")){throw new x.RuntimeError(x.RuntimeError.NOT_SUPPORTED_ERR)}u.setRequestHeader("Content-Type","multipart/form-data; boundary="+i);e.each(function(e,t){if(e instanceof g){o+=n+i+r+'Content-Disposition: form-data; name="'+t+'"; filename="'+unescape(encodeURIComponent(e.name||"blob"))+'"'+r+"Content-Type: "+(e.type||"application/octet-stream")+r+r+e.getSource()+r}else{o+=n+i+r+'Content-Disposition: form-data; name="'+t+'"'+r+r+unescape(encodeURIComponent(e))+r}});o+=n+i+n+r;return o}}return e.XMLHttpRequest=t});e("moxie/runtime/html5/utils/BinaryReader",["moxie/core/utils/Basic"],function(e){function t(e){if(e instanceof ArrayBuffer){i.apply(this,arguments)}else{n.apply(this,arguments)}}e.extend(t.prototype,{littleEndian:false,read:function e(t,i){var n,r,o;if(t+i>this.length()){throw new Error("You are trying to read outside the source boundaries.")}r=this.littleEndian?0:-8*(i-1);for(o=0,n=0;o<i;o++){n|=this.readByteAt(t+o)<<Math.abs(r+o*8)}return n},write:function e(t,i,n){var r,o,a="";if(t>this.length()){throw new Error("You are trying to write outside the source boundaries.")}r=this.littleEndian?0:-8*(n-1);for(o=0;o<n;o++){this.writeByteAt(t+o,i>>Math.abs(r+o*8)&255)}},BYTE:function e(t){return this.read(t,1)},SHORT:function e(t){return this.read(t,2)},LONG:function e(t){return this.read(t,4)},SLONG:function e(t){var i=this.read(t,4);return i>2147483647?i-4294967296:i},CHAR:function e(t){return String.fromCharCode(this.read(t,1))},STRING:function e(t,i){return this.asArray("CHAR",t,i).join("")},asArray:function e(t,i,n){var r=[];for(var o=0;o<n;o++){r[o]=this[t](i+o)}return r}});function i(o){var a=new DataView(o);e.extend(this,{readByteAt:function e(t){return a.getUint8(t)},writeByteAt:function e(t,i){a.setUint8(t,i)},SEGMENT:function e(t,i,n){switch(arguments.length){case 2:return o.slice(t,t+i);case 1:return o.slice(t);case 3:if(n===null){n=new ArrayBuffer}if(n instanceof ArrayBuffer){var r=new Uint8Array(this.length()-i+n.byteLength);if(t>0){r.set(new Uint8Array(o.slice(0,t)),0)}r.set(new Uint8Array(n),t);r.set(new Uint8Array(o.slice(t+i)),t+n.byteLength);this.clear();o=r.buffer;a=new DataView(o);break}default:return o}},length:function e(){return o?o.byteLength:0},clear:function e(){a=o=null}})}function n(r){e.extend(this,{readByteAt:function e(t){return r.charCodeAt(t)},writeByteAt:function e(t,i){o(String.fromCharCode(i),t,1)},SEGMENT:function e(t,i,n){switch(arguments.length){case 1:return r.substr(t);case 2:return r.substr(t,i);case 3:o(n!==null?n:"",t,i);break;default:return r}},length:function e(){return r?r.length:0},clear:function e(){r=null}});function o(e,t,i){i=arguments.length===3?i:r.length-t-1;r=r.substr(0,t)+e+r.substr(i+t)}}return t});e("moxie/runtime/html5/image/JPEGHeaders",["moxie/runtime/html5/utils/BinaryReader","moxie/core/Exceptions"],function(u,r){return function a(e){var s=[],t,o,i,n=0;t=new u(e);if(t.SHORT(0)!==65496){t.clear();throw new r.ImageError(r.ImageError.WRONG_FORMAT)}o=2;while(o<=t.length()){i=t.SHORT(o);if(i>=65488&&i<=65495){o+=2;continue}if(i===65498||i===65497){break}n=t.SHORT(o+2)+2;if(i>=65505&&i<=65519){s.push({hex:i,name:"APP"+(i&15),start:o,length:n,segment:t.SEGMENT(o,n)})}o+=n}t.clear();return{headers:s,restore:function e(t){var i,n,r;r=new u(t);o=r.SHORT(2)==65504?4+r.SHORT(4):2;for(n=0,i=s.length;n<i;n++){r.SEGMENT(o,0,s[n].segment);o+=s[n].length}t=r.SEGMENT();r.clear();return t},strip:function e(t){var i,n,r,o;r=new a(t);n=r.headers;r.purge();i=new u(t);o=n.length;while(o--){i.SEGMENT(n[o].start,n[o].length,"")}t=i.SEGMENT();i.clear();return t},get:function e(t){var i=[];for(var n=0,r=s.length;n<r;n++){if(s[n].name===t.toUpperCase()){i.push(s[n].segment)}}return i},set:function e(t,i){var n=[],r,o,a;if(typeof i==="string"){n.push(i)}else{n=i}for(r=o=0,a=s.length;r<a;r++){if(s[r].name===t.toUpperCase()){s[r].segment=n[o];s[r].length=n[o].length;o++}if(o>=n.length){break}}},purge:function e(){this.headers=s=[]}}}});e("moxie/runtime/html5/image/ExifParser",["moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader","moxie/core/Exceptions"],function(v,s,x){function u(t){var i,l,p,g,e,n;s.call(this,t);l={tiff:{274:"Orientation",270:"ImageDescription",271:"Make",272:"Model",305:"Software",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"},thumb:{513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength"}};p={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}};g={tiffHeader:10};e=g.tiffHeader;i={clear:this.clear};v.extend(this,{read:function e(){try{return u.prototype.read.apply(this,arguments)}catch(e){throw new x.ImageError(x.ImageError.INVALID_META_ERR)}},write:function e(){try{return u.prototype.write.apply(this,arguments)}catch(e){throw new x.ImageError(x.ImageError.INVALID_META_ERR)}},UNDEFINED:function e(){return this.BYTE.apply(this,arguments)},RATIONAL:function e(t){return this.LONG(t)/this.LONG(t+4)},SRATIONAL:function e(t){return this.SLONG(t)/this.SLONG(t+4)},ASCII:function e(t){return this.CHAR(t)},TIFF:function e(){return n||null},EXIF:function e(){var t=null;if(g.exifIFD){try{t=o.call(this,g.exifIFD,l.exif)}catch(e){return null}if(t.ExifVersion&&v.typeOf(t.ExifVersion)==="array"){for(var i=0,n="";i<t.ExifVersion.length;i++){n+=String.fromCharCode(t.ExifVersion[i])}t.ExifVersion=n}}return t},GPS:function e(){var e=null;if(g.gpsIFD){try{e=o.call(this,g.gpsIFD,l.gps)}catch(e){return null}if(e.GPSVersionID&&v.typeOf(e.GPSVersionID)==="array"){e.GPSVersionID=e.GPSVersionID.join(".")}}return e},thumb:function e(){if(g.IFD1){try{var t=o.call(this,g.IFD1,l.thumb);if("JPEGInterchangeFormat"in t){return this.SEGMENT(g.tiffHeader+t.JPEGInterchangeFormat,t.JPEGInterchangeFormatLength)}}catch(e){}}return null},setExif:function e(t,i){if(t!=="PixelXDimension"&&t!=="PixelYDimension"){return false}return a.call(this,"exif",t,i)},clear:function e(){i.clear();t=l=p=n=g=i=null}});if(this.SHORT(0)!==65505||this.STRING(4,5).toUpperCase()!=="EXIF\0"){throw new x.ImageError(x.ImageError.INVALID_META_ERR)}this.littleEndian=this.SHORT(e)==18761;if(this.SHORT(e+=2)!==42){throw new x.ImageError(x.ImageError.INVALID_META_ERR)}g.IFD0=g.tiffHeader+this.LONG(e+=2);n=o.call(this,g.IFD0,l.tiff);if("ExifIFDPointer"in n){g.exifIFD=g.tiffHeader+n.ExifIFDPointer;delete n.ExifIFDPointer}if("GPSInfoIFDPointer"in n){g.gpsIFD=g.tiffHeader+n.GPSInfoIFDPointer;delete n.GPSInfoIFDPointer}if(v.isEmptyObj(n)){n=null}var r=this.LONG(g.IFD0+this.SHORT(g.IFD0)*12+2);if(r){g.IFD1=g.tiffHeader+r}function o(e,t){var i=this;var n,r,o,a,s,u,c,l,d=[],f={};var h={1:"BYTE",7:"UNDEFINED",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",9:"SLONG",10:"SRATIONAL"};var m={BYTE:1,UNDEFINED:1,ASCII:1,SHORT:2,LONG:4,RATIONAL:8,SLONG:4,SRATIONAL:8};n=i.SHORT(e);for(r=0;r<n;r++){d=[];c=e+2+r*12;o=t[i.SHORT(c)];if(o===y){continue}a=h[i.SHORT(c+=2)];s=i.LONG(c+=2);u=m[a];if(!u){throw new x.ImageError(x.ImageError.INVALID_META_ERR)}c+=4;if(u*s>4){c=i.LONG(c)+g.tiffHeader}if(c+u*s>=this.length()){throw new x.ImageError(x.ImageError.INVALID_META_ERR)}if(a==="ASCII"){f[o]=v.trim(i.STRING(c,s).replace(/\0$/,""));continue}else{d=i.asArray(a,c,s);l=s==1?d[0]:d;if(p.hasOwnProperty(o)&&_typeof(l)!="object"){f[o]=p[o][l]}else{f[o]=l}}}return f}function a(e,t,i){var n,r,o,a=0;if(typeof t==="string"){var s=l[e.toLowerCase()];for(var u in s){if(s[u]===t){t=u;break}}}n=g[e.toLowerCase()+"IFD"];r=this.SHORT(n);for(var c=0;c<r;c++){o=n+12*c+2;if(this.SHORT(o)==t){a=o+8;break}}if(!a){return false}try{this.write(a,i,4)}catch(e){return false}return true}}u.prototype=s.prototype;return u});e("moxie/runtime/html5/image/JPEG",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEGHeaders","moxie/runtime/html5/utils/BinaryReader","moxie/runtime/html5/image/ExifParser"],function(u,c,l,d,f){function e(t){var r,n,o,e;r=new d(t);if(r.SHORT(0)!==65496){throw new c.ImageError(c.ImageError.WRONG_FORMAT)}n=new l(t);try{o=new f(n.get("app1")[0])}catch(e){}e=a.call(this);u.extend(this,{type:"image/jpeg",size:r.length(),width:e&&e.width||0,height:e&&e.height||0,setExif:function e(t,i){if(!o){return false}if(u.typeOf(t)==="object"){u.each(t,function(e,t){o.setExif(t,e)})}else{o.setExif(t,i)}n.set("app1",o.SEGMENT())},writeHeaders:function e(){if(!arguments.length){return n.restore(t)}return n.restore(arguments[0])},stripHeaders:function e(t){return n.strip(t)},purge:function e(){s.call(this)}});if(o){this.meta={tiff:o.TIFF(),exif:o.EXIF(),gps:o.GPS(),thumb:i()}}function a(e){var t=0,i,n;if(!e){e=r}while(t<=e.length()){i=e.SHORT(t+=2);if(i>=65472&&i<=65475){t+=5;return{height:e.SHORT(t),width:e.SHORT(t+=2)}}n=e.SHORT(t+=2);t+=n-2}return null}function i(){var e=o.thumb(),t,i;if(e){t=new d(e);i=a(t);t.clear();if(i){i.data=e;return i}}return null}function s(){if(!o||!n||!r){return}o.clear();n.purge();r.clear();e=n=o=r=null}}return e});e("moxie/runtime/html5/image/PNG",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader"],function(u,c,l){function e(e){var o,t,i,n;o=new l(e);(function(){var e=0,t=0,i=[35152,20039,3338,6666];for(t=0;t<i.length;t++,e+=2){if(i[t]!=o.SHORT(e)){throw new u.ImageError(u.ImageError.WRONG_FORMAT)}}})();function r(){var e,t;e=s.call(this,8);if(e.type=="IHDR"){t=e.start;return{width:o.LONG(t),height:o.LONG(t+=4)}}return null}function a(){if(!o){return}o.clear();e=n=t=i=o=null}n=r.call(this);c.extend(this,{type:"image/png",size:o.length(),width:n.width,height:n.height,purge:function e(){a.call(this)}});a.call(this);function s(e){var t,i,n,r;t=o.LONG(e);i=o.STRING(e+=4,4);n=e+=4;r=o.LONG(e+t);return{length:t,type:i,start:n,CRC:r}}}return e});e("moxie/runtime/html5/image/ImageInfo",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEG","moxie/runtime/html5/image/PNG"],function(n,r,o,a){return function(t){var i=[o,a],e;e=function(){for(var e=0;e<i.length;e++){try{return new i[e](t)}catch(e){}}throw new r.ImageError(r.ImageError.WRONG_FORMAT)}();n.extend(this,{type:"",size:0,width:0,height:0,setExif:function e(){},writeHeaders:function e(t){return t},stripHeaders:function e(t){return t},purge:function e(){t=null}});n.extend(this,e);this.purge=function(){e.purge();e=null}}});e("moxie/runtime/html5/image/ResizerCanvas",[],function(){function s(e,t,i){var n=e.width>e.height?"width":"height";var r=Math.round(e[n]*t);var o=false;if(i!=="nearest"&&(t<.5||t>2)){t=t<.5?.5:2;o=true}var a=u(e,t);if(o){return s(a,r/a[n],i)}else{return a}}function u(e,t){var i=e.width;var n=e.height;var r=Math.round(i*t);var o=Math.round(n*t);var a=document.createElement("canvas");a.width=r;a.height=o;a.getContext("2d").drawImage(e,0,0,i,n,0,0,r,o);e=null;return a}return{scale:s}});e("moxie/runtime/html5/image/Image",["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/Exceptions","moxie/core/utils/Encode","moxie/file/Blob","moxie/file/File","moxie/runtime/html5/image/ImageInfo","moxie/runtime/html5/image/ResizerCanvas","moxie/core/utils/Mime","moxie/core/utils/Env"],function(e,x,y,w,_,b,E,R,A,t){function i(){var r=this,n,o,a,s,u,c=false,l=true;x.extend(this,{loadFromBlob:function e(t){var i=this.getRuntime(),n=arguments.length>1?arguments[1]:true;if(!i.can("access_binary")){throw new y.RuntimeError(y.RuntimeError.NOT_SUPPORTED_ERR)}u=t;if(t.isDetached()){s=t.getSource();m.call(this,s);return}else{p.call(this,t.getSource(),function(e){if(n){s=h(e)}m.call(this,e)})}},loadFromImage:function e(t,i){this.meta=t.meta;u=new b(null,{name:t.name,size:t.size,type:t.type});m.call(this,i?s=t.getAsBinaryString():t.getAsDataURL())},getInfo:function e(){var t=this.getRuntime(),i;if(!o&&s&&t.can("access_image_binary")){o=new E(s)}i={width:d().width||0,height:d().height||0,type:u.type||A.getFileMime(u.name),size:s&&s.length||u.size||0,name:u.name||"",meta:null};if(l){i.meta=o&&o.meta||this.meta||{};if(i.meta&&i.meta.thumb&&!(i.meta.thumb.data instanceof _)){i.meta.thumb.data=new _(null,{type:"image/jpeg",data:i.meta.thumb.data})}}return i},resize:function e(t,i,n){var r=document.createElement("canvas");r.width=t.width;r.height=t.height;r.getContext("2d").drawImage(d(),t.x,t.y,t.width,t.height,0,0,r.width,r.height);a=R.scale(r,i);l=n.preserveHeaders;if(!l){var o=this.meta&&this.meta.tiff&&this.meta.tiff.Orientation||1;a=g(a,o)}this.width=a.width;this.height=a.height;c=true;this.trigger("Resize")},getAsCanvas:function e(){if(!a){a=f()}a.id=this.uid+"_canvas";return a},getAsBlob:function e(t,i){if(t!==this.type){c=true;return new b(null,{name:u.name||"",type:t,data:r.getAsDataURL(t,i)})}return new b(null,{name:u.name||"",type:t,data:r.getAsBinaryString(t,i)})},getAsDataURL:function e(t){var i=arguments[1]||90;if(!c){return n.src}f();if("image/jpeg"!==t){return a.toDataURL("image/png")}else{try{return a.toDataURL("image/jpeg",i/100)}catch(e){return a.toDataURL("image/jpeg")}}},getAsBinaryString:function e(t,i){if(!c){if(!s){s=h(r.getAsDataURL(t,i))}return s}if("image/jpeg"!==t){s=h(r.getAsDataURL(t,i))}else{var n;if(!i){i=90}f();try{n=a.toDataURL("image/jpeg",i/100)}catch(e){n=a.toDataURL("image/jpeg")}s=h(n);if(o){s=o.stripHeaders(s);if(l){if(o.meta&&o.meta.exif){o.setExif({PixelXDimension:this.width,PixelYDimension:this.height})}s=o.writeHeaders(s)}o.purge();o=null}}c=false;return s},destroy:function e(){r=null;v.call(this);this.getRuntime().getShim().removeInstance(this.uid)}});function d(){if(!a&&!n){throw new y.ImageError(y.DOMException.INVALID_STATE_ERR)}return a||n}function f(){var e=d();if(e.nodeName.toLowerCase()=="canvas"){return e}a=document.createElement("canvas");a.width=e.width;a.height=e.height;a.getContext("2d").drawImage(e,0,0);return a}function h(e){return w.atob(e.substring(e.indexOf("base64,")+7))}function i(e,t){return"data:"+(t||"")+";base64,"+w.btoa(e)}function m(e){var t=this;n=new Image;n.onerror=function(){v.call(this);t.trigger("error",y.ImageError.WRONG_FORMAT)};n.onload=function(){t.trigger("load")};n.src=e.substr(0,5)=="data:"?e:i(e,u.type)}function p(e,t){var i=this,n;if(window.FileReader){n=new FileReader;n.onload=function(){t.call(i,this.result)};n.onerror=function(){i.trigger("error",y.ImageError.WRONG_FORMAT)};n.readAsDataURL(e)}else{return t.call(this,e.getAsDataURL())}}function g(e,t){var i=Math.PI/180;var n=document.createElement("canvas");var r=n.getContext("2d");var o=e.width;var a=e.height;if(x.inArray(t,[5,6,7,8])>-1){n.width=a;n.height=o}else{n.width=o;n.height=a}switch(t){case 2:r.translate(o,0);r.scale(-1,1);break;case 3:r.translate(o,a);r.rotate(180*i);break;case 4:r.translate(0,a);r.scale(1,-1);break;case 5:r.rotate(90*i);r.scale(1,-1);break;case 6:r.rotate(90*i);r.translate(0,-a);break;case 7:r.rotate(90*i);r.translate(o,-a);r.scale(-1,1);break;case 8:r.rotate(-90*i);r.translate(-o,0);break}r.drawImage(e,0,0,o,a);return n}function v(){if(o){o.purge();o=null}s=n=a=u=null;c=false}}return e.Image=i});e("moxie/runtime/flash/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(s,u,n,c,l){var e="flash",t={};function i(){var t;try{t=navigator.plugins["Shockwave Flash"];t=t.description}catch(e){try{t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(e){t="0.0"}}t=t.match(/\d+/g);return parseFloat(t[0]+"."+t[1])}function d(t){var i=n.get(t);if(i&&i.nodeName=="OBJECT"){if(u.browser==="IE"){i.style.display="none";(function e(){if(i.readyState==4){r(t)}else{setTimeout(e,10)}})()}else{i.parentNode.removeChild(i)}}}function r(e){var t=n.get(e);if(t){for(var i in t){if(typeof t[i]=="function"){t[i]=null}}t.parentNode.removeChild(t)}}function o(r){var o=this,a;r=s.extend({swf_url:u.swf_url},r);l.call(this,r,e,{access_binary:function e(t){return t&&o.mode==="browser"},access_image_binary:function e(t){return t&&o.mode==="browser"},display_media:l.capTest(f("moxie/image/Image")),do_cors:l.capTrue,drag_and_drop:false,report_upload_progress:function e(){return o.mode==="client"},resize_image:l.capTrue,return_response_headers:false,return_response_type:function e(t){if(t==="json"&&!!window.JSON){return true}return!s.arrayDiff(t,["","text","document"])||o.mode==="browser"},return_status_code:function e(t){return o.mode==="browser"||!s.arrayDiff(t,[200,404])},select_file:l.capTrue,select_multiple:l.capTrue,send_binary_string:function e(t){return t&&o.mode==="browser"},send_browser_cookies:function e(t){return t&&o.mode==="browser"},send_custom_headers:function e(t){return t&&o.mode==="browser"},send_multipart:l.capTrue,slice_blob:function e(t){return t&&o.mode==="browser"},stream_upload:function e(t){return t&&o.mode==="browser"},summon_file_dialog:false,upload_filesize:function e(t){return s.parseSizeStr(t)<=2097152||o.mode==="client"},use_http_method:function e(t){return!s.arrayDiff(t,["GET","POST"])}},{access_binary:function e(t){return t?"browser":"client"},access_image_binary:function e(t){return t?"browser":"client"},report_upload_progress:function e(t){return t?"browser":"client"},return_response_type:function e(t){return s.arrayDiff(t,["","text","json","document"])?"browser":["client","browser"]},return_status_code:function e(t){return s.arrayDiff(t,[200,404])?"browser":["client","browser"]},send_binary_string:function e(t){return t?"browser":"client"},send_browser_cookies:function e(t){return t?"browser":"client"},send_custom_headers:function e(t){return t?"browser":"client"},slice_blob:function e(t){return t?"browser":"client"},stream_upload:function e(t){return t?"client":"browser"},upload_filesize:function e(t){return s.parseSizeStr(t)>=2097152?"client":"browser"}},"client");if(i()<11.3){if(b&&u.debug.runtime){u.log("\tFlash didn't meet minimal version requirement (11.3).")}this.mode=false}s.extend(this,{getShim:function e(){return n.get(this.uid)},shimExec:function e(t,i){var n=[].slice.call(arguments,2);return o.getShim().exec(this.uid,t,i,n)},init:function e(){var t,i,n;n=this.getShimContainer();s.extend(n.style,{position:"absolute",top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"});t='<object id="'+this.uid+'" type="application/x-shockwave-flash" data="'+r.swf_url+'" ';if(u.browser==="IE"){t+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '}t+='width="100%" height="100%" style="outline:0">'+'<param name="movie" value="'+r.swf_url+'" />'+'<param name="flashvars" value="uid='+escape(this.uid)+"&target="+l.getGlobalEventTarget()+'" />'+'<param name="wmode" value="transparent" />'+'<param name="allowscriptaccess" value="always" />'+"</object>";if(u.browser==="IE"){i=document.createElement("div");n.appendChild(i);i.outerHTML=t;i=n=null}else{n.innerHTML=t}a=setTimeout(function(){if(o&&!o.initialized){o.trigger("Error",new c.RuntimeError(c.RuntimeError.NOT_INIT_ERR));if(b&&u.debug.runtime){u.log("\tFlash failed to initialize within a specified period of time (typically 5s).")}}},5e3)},destroy:function(e){return function(){d(o.uid);e.call(o);clearTimeout(a);r=a=e=o=null}}(this.destroy)},t)}l.addConstructor(e,o);return t});e("moxie/runtime/flash/file/Blob",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(e,a){var t={slice:function e(t,i,n,r){var o=this.getRuntime();if(i<0){i=Math.max(t.size+i,0)}else if(i>0){i=Math.min(i,t.size)}if(n<0){n=Math.max(t.size+n,0)}else if(n>0){n=Math.min(n,t.size)}t=o.shimExec.call(this,"Blob","slice",i,n,r||"");if(t){t=new a(o.uid,t)}return t}};return e.Blob=t});e("moxie/runtime/flash/file/FileInput",["moxie/runtime/flash/Runtime","moxie/file/File","moxie/core/utils/Dom","moxie/core/utils/Basic"],function(e,o,a,s){var t={init:function e(t){var i=this,n=this.getRuntime();var r=a.get(t.browse_button);if(r){r.setAttribute("tabindex",-1);r=null}this.bind("Change",function(){var e=n.shimExec.call(i,"FileInput","getFiles");i.files=[];s.each(e,function(e){i.files.push(new o(n.uid,e))})},999);this.getRuntime().shimExec.call(this,"FileInput","init",{accept:t.accept,multiple:t.multiple});this.trigger("ready")}};return e.FileInput=t});e("moxie/runtime/flash/file/FileReader",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(e,i){function r(e,t){switch(t){case"readAsText":return i.atob(e,"utf8");case"readAsBinaryString":return i.atob(e);case"readAsDataURL":return e}return null}var t={read:function e(i,t){var n=this;n.result="";if(i==="readAsDataURL"){n.result="data:"+(t.type||"")+";base64,"}n.bind("Progress",function(e,t){if(t){n.result+=r(t,i)}},999);return n.getRuntime().shimExec.call(this,"FileReader","readAsBase64",t.uid)}};return e.FileReader=t});e("moxie/runtime/flash/file/FileReaderSync",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(e,i){function o(e,t){switch(t){case"readAsText":return i.atob(e,"utf8");case"readAsBinaryString":return i.atob(e);case"readAsDataURL":return e}return null}var t={read:function e(t,i){var n,r=this.getRuntime();n=r.shimExec.call(this,"FileReaderSync","readAsBase64",i.uid);if(!n){return null}if(t==="readAsDataURL"){n="data:"+(i.type||"")+";base64,"+n}return o(n,t,i.type)}};return e.FileReaderSync=t});e("moxie/runtime/flash/runtime/Transporter",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(e,r){var t={getAsBlob:function e(t){var i=this.getRuntime(),n=i.shimExec.call(this,"Transporter","getAsBlob",t);if(n){return new r(i.uid,n)}return null}};return e.Transporter=t});e("moxie/runtime/flash/xhr/XMLHttpRequest",["moxie/runtime/flash/Runtime","moxie/core/utils/Basic","moxie/file/Blob","moxie/file/File","moxie/file/FileReaderSync","moxie/runtime/flash/file/FileReaderSync","moxie/xhr/FormData","moxie/runtime/Transporter","moxie/runtime/flash/runtime/Transporter"],function(e,c,l,o,a,t,d,f,i){var n={send:function i(e,n){var r=this,o=r.getRuntime();function i(){e.transport=o.mode;o.shimExec.call(r,"XMLHttpRequest","send",e,n)}function t(e,t){o.shimExec.call(r,"XMLHttpRequest","appendBlob",e,t.uid);n=null;i()}function a(e,t){var i=new f;i.bind("TransportingComplete",function(){t(this.result)});i.transport(e.getSource(),e.type,{ruid:o.uid})}if(!c.isEmptyObj(e.headers)){c.each(e.headers,function(e,t){o.shimExec.call(r,"XMLHttpRequest","setRequestHeader",t,e.toString())})}if(n instanceof d){var s;n.each(function(e,t){if(e instanceof l){s=t}else{o.shimExec.call(r,"XMLHttpRequest","append",t,e)}});if(!n.hasBlob()){n=null;i()}else{var u=n.getBlob();if(u.isDetached()){a(u,function(e){u.destroy();t(s,e)})}else{t(s,u)}}}else if(n instanceof l){if(n.isDetached()){a(n,function(e){n.destroy();n=e.uid;i()})}else{n=n.uid;i()}}else{i()}},getResponse:function e(t){var i,n,r=this.getRuntime();n=r.shimExec.call(this,"XMLHttpRequest","getResponseAsBlob");if(n){n=new o(r.uid,n);if("blob"===t){return n}try{i=new a;if(!!~c.inArray(t,["","text"])){return i.readAsText(n)}else if("json"===t&&!!window.JSON){return JSON.parse(i.readAsText(n))}}finally{n.destroy()}}return null},abort:function e(t){var i=this.getRuntime();i.shimExec.call(this,"XMLHttpRequest","abort");this.dispatchEvent("readystatechange");this.dispatchEvent("abort")}};return e.XMLHttpRequest=n});e("moxie/runtime/flash/image/Image",["moxie/runtime/flash/Runtime","moxie/core/utils/Basic","moxie/runtime/Transporter","moxie/file/Blob","moxie/file/FileReaderSync"],function(e,t,a,o,r){var i={loadFromBlob:function e(t){var i=this,n=i.getRuntime();function r(e){n.shimExec.call(i,"Image","loadFromBlob",e.uid);i=n=null}if(t.isDetached()){var o=new a;o.bind("TransportingComplete",function(){r(o.result.getSource())});o.transport(t.getSource(),t.type,{ruid:n.uid})}else{r(t.getSource())}},loadFromImage:function e(t){var i=this.getRuntime();return i.shimExec.call(this,"Image","loadFromImage",t.uid)},getInfo:function e(){var t=this.getRuntime(),i=t.shimExec.call(this,"Image","getInfo");if(i.meta&&i.meta.thumb&&i.meta.thumb.data&&!(t.meta.thumb.data instanceof o)){i.meta.thumb.data=new o(t.uid,i.meta.thumb.data)}return i},getAsBlob:function e(t,i){var n=this.getRuntime(),r=n.shimExec.call(this,"Image","getAsBlob",t,i);if(r){return new o(n.uid,r)}return null},getAsDataURL:function e(){var t=this.getRuntime(),i=t.Image.getAsBlob.apply(this,arguments),n;if(!i){return null}n=new r;return n.readAsDataURL(i)}};return e.Image=i});e("moxie/runtime/silverlight/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(o,a,t,s,u){var e="silverlight",c={};function l(t){var i=false,e=null,n,r,o,a,s,u=0;try{try{e=new ActiveXObject("AgControl.AgControl");if(e.IsVersionSupported(t)){i=true}e=null}catch(e){var c=navigator.plugins["Silverlight Plug-In"];if(c){n=c.description;if(n==="1.0.30226.2"){n="2.0.30226.2"}r=n.split(".");while(r.length>3){r.pop()}while(r.length<4){r.push(0)}o=t.split(".");while(o.length>4){o.pop()}do{a=parseInt(o[u],10);s=parseInt(r[u],10);u++}while(u<o.length&&a===s);if(a<=s&&!isNaN(a)){i=true}}}}catch(e){i=false}return i}function i(i){var r=this,n;i=o.extend({xap_url:a.xap_url},i);u.call(this,i,e,{access_binary:u.capTrue,access_image_binary:u.capTrue,display_media:u.capTest(f("moxie/image/Image")),do_cors:u.capTrue,drag_and_drop:false,report_upload_progress:u.capTrue,resize_image:u.capTrue,return_response_headers:function e(t){return t&&r.mode==="client"},return_response_type:function e(t){if(t!=="json"){return true}else{return!!window.JSON}},return_status_code:function e(t){return r.mode==="client"||!o.arrayDiff(t,[200,404])},select_file:u.capTrue,select_multiple:u.capTrue,send_binary_string:u.capTrue,send_browser_cookies:function e(t){return t&&r.mode==="browser"},send_custom_headers:function e(t){return t&&r.mode==="client"},send_multipart:u.capTrue,slice_blob:u.capTrue,stream_upload:true,summon_file_dialog:false,upload_filesize:u.capTrue,use_http_method:function e(t){return r.mode==="client"||!o.arrayDiff(t,["GET","POST"])}},{return_response_headers:function e(t){return t?"client":"browser"},return_status_code:function e(t){return o.arrayDiff(t,[200,404])?"client":["client","browser"]},send_browser_cookies:function e(t){return t?"browser":"client"},send_custom_headers:function e(t){return t?"client":"browser"},use_http_method:function e(t){return o.arrayDiff(t,["GET","POST"])?"client":["client","browser"]}});if(!l("2.0.31005.0")||a.browser==="Opera"){if(b&&a.debug.runtime){a.log("\tSilverlight is not installed or minimal version (2.0.31005.0) requirement not met (not likely).")}this.mode=false}o.extend(this,{getShim:function e(){return t.get(this.uid).content.Moxie},shimExec:function e(t,i){var n=[].slice.call(arguments,2);return r.getShim().exec(this.uid,t,i,n)},init:function e(){var t;t=this.getShimContainer();t.innerHTML='<object id="'+this.uid+'" data="data:application/x-silverlight," type="application/x-silverlight-2" width="100%" height="100%" style="outline:none;">'+'<param name="source" value="'+i.xap_url+'"/>'+'<param name="background" value="Transparent"/>'+'<param name="windowless" value="true"/>'+'<param name="enablehtmlaccess" value="true"/>'+'<param name="initParams" value="uid='+this.uid+",target="+u.getGlobalEventTarget()+'"/>'+"</object>";n=setTimeout(function(){if(r&&!r.initialized){r.trigger("Error",new s.RuntimeError(s.RuntimeError.NOT_INIT_ERR));if(b&&a.debug.runtime){a.log("Silverlight failed to initialize within a specified period of time (5-10s).")}}},a.OS!=="Windows"?1e4:5e3)},destroy:function(e){return function(){e.call(r);clearTimeout(n);i=n=e=r=null}}(this.destroy)},c)}u.addConstructor(e,i);return c});e("moxie/runtime/silverlight/file/Blob",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/Blob"],function(e,t,i){return e.Blob=t.extend({},i)});e("moxie/runtime/silverlight/file/FileInput",["moxie/runtime/silverlight/Runtime","moxie/file/File","moxie/core/utils/Dom","moxie/core/utils/Basic"],function(e,o,a,s){function u(e){var t="";for(var i=0;i<e.length;i++){t+=(t!==""?"|":"")+e[i].title+" | *."+e[i].extensions.replace(/,/g,";*.")}return t}var t={init:function e(t){var i=this,n=this.getRuntime();var r=a.get(t.browse_button);if(r){r.setAttribute("tabindex",-1);r=null}this.bind("Change",function(){var e=n.shimExec.call(i,"FileInput","getFiles");i.files=[];s.each(e,function(e){i.files.push(new o(n.uid,e))})},999);n.shimExec.call(this,"FileInput","init",u(t.accept),t.multiple);this.trigger("ready")},setOption:function e(t,i){if(t=="accept"){i=u(i)}this.getRuntime().shimExec.call(this,"FileInput","setOption",t,i)}};return e.FileInput=t});e("moxie/runtime/silverlight/file/FileDrop",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Dom","moxie/core/utils/Events"],function(e,r,o){var t={init:function e(){var t=this,i=t.getRuntime(),n;n=i.getShimContainer();o.addEvent(n,"dragover",function(e){e.preventDefault();e.stopPropagation();e.dataTransfer.dropEffect="copy"},t.uid);o.addEvent(n,"dragenter",function(e){e.preventDefault();var t=r.get(i.uid).dragEnter(e);if(t){e.stopPropagation()}},t.uid);o.addEvent(n,"drop",function(e){e.preventDefault();var t=r.get(i.uid).dragDrop(e);if(t){e.stopPropagation()}},t.uid);return i.shimExec.call(this,"FileDrop","init")}};return e.FileDrop=t});e("moxie/runtime/silverlight/file/FileReader",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReader"],function(e,t,i){return e.FileReader=t.extend({},i)});e("moxie/runtime/silverlight/file/FileReaderSync",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReaderSync"],function(e,t,i){return e.FileReaderSync=t.extend({},i)});e("moxie/runtime/silverlight/runtime/Transporter",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/runtime/Transporter"],function(e,t,i){return e.Transporter=t.extend({},i)});e("moxie/runtime/silverlight/xhr/XMLHttpRequest",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/xhr/XMLHttpRequest","moxie/runtime/silverlight/file/FileReaderSync","moxie/runtime/silverlight/runtime/Transporter"],function(e,t,i,n,r){return e.XMLHttpRequest=t.extend({},i)});e("moxie/runtime/silverlight/image/Image",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/file/Blob","moxie/runtime/flash/image/Image"],function(e,n,r,t){return e.Image=n.extend({},t,{getInfo:function e(){var t=this.getRuntime(),i=["tiff","exif","gps","thumb"],a={meta:{}},s=t.shimExec.call(this,"Image","getInfo");if(s.meta){n.each(i,function(e){var t=s.meta[e],i,n,r,o;if(t&&t.keys){a.meta[e]={};for(n=0,r=t.keys.length;n<r;n++){i=t.keys[n];o=t[i];if(o){if(/^(\d|[1-9]\d+)$/.test(o)){o=parseInt(o,10)}else if(/^\d*\.\d+$/.test(o)){o=parseFloat(o)}a.meta[e][i]=o}}}});if(a.meta&&a.meta.thumb&&a.meta.thumb.data&&!(t.meta.thumb.data instanceof r)){a.meta.thumb.data=new r(t.uid,a.meta.thumb.data)}}a.width=parseInt(s.width,10);a.height=parseInt(s.height,10);a.size=parseInt(s.size,10);a.type=s.type;a.name=s.name;return a},resize:function e(t,i,n){this.getRuntime().shimExec.call(this,"Image","resize",t.x,t.y,t.width,t.height,i,n.preserveHeaders,n.resample)}})});e("moxie/runtime/html4/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(r,e,o,a){var s="html4",u={};function t(e){var t=this,i=o.capTest,n=o.capTrue;o.call(this,e,s,{access_binary:i(window.FileReader||window.File&&File.getAsDataURL),access_image_binary:false,display_media:i((a.can("create_canvas")||a.can("use_data_uri_over32kb"))&&f("moxie/image/Image")),do_cors:false,drag_and_drop:false,filter_by_extension:i(function(){return!(a.browser==="Chrome"&&a.verComp(a.version,28,"<")||a.browser==="IE"&&a.verComp(a.version,10,"<")||a.browser==="Safari"&&a.verComp(a.version,7,"<")||a.browser==="Firefox"&&a.verComp(a.version,37,"<"))}()),resize_image:function e(){return u.Image&&t.can("access_binary")&&a.can("create_canvas")},report_upload_progress:false,return_response_headers:false,return_response_type:function e(t){if(t==="json"&&!!window.JSON){return true}return!!~r.inArray(t,["text","document",""])},return_status_code:function e(t){return!r.arrayDiff(t,[200,404])},select_file:function e(){return a.can("use_fileinput")},select_multiple:false,send_binary_string:false,send_custom_headers:false,send_multipart:true,slice_blob:false,stream_upload:function e(){return t.can("select_file")},summon_file_dialog:function e(){return t.can("select_file")&&!(a.browser==="Firefox"&&a.verComp(a.version,4,"<")||a.browser==="Opera"&&a.verComp(a.version,12,"<")||a.browser==="IE"&&a.verComp(a.version,10,"<"))},upload_filesize:n,use_http_method:function e(t){return!r.arrayDiff(t,["GET","POST"])}});r.extend(this,{init:function e(){this.trigger("Init")},destroy:function(e){return function(){e.call(t);e=t=null}}(this.destroy)});r.extend(this.getShim(),u)}o.addConstructor(s,t);return u});e("moxie/runtime/html4/file/FileInput",["moxie/runtime/html4/Runtime","moxie/file/File","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime","moxie/core/utils/Env"],function(e,f,h,m,p,g,v){function t(){var u,c=[],l,s;function d(){var t=this,i=t.getRuntime(),e,n,r,o,a,s;s=h.guid("uid_");e=i.getShimContainer();if(u){r=m.get(u+"_form");if(r){h.extend(r.style,{top:"100%"});r.firstChild.setAttribute("tabindex",-1)}}o=document.createElement("form");o.setAttribute("id",s+"_form");o.setAttribute("method","post");o.setAttribute("enctype","multipart/form-data");o.setAttribute("encoding","multipart/form-data");h.extend(o.style,{overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",height:"100%"});a=document.createElement("input");a.setAttribute("id",s);a.setAttribute("type","file");a.setAttribute("accept",c.join(","));if(i.can("summon_file_dialog")){a.setAttribute("tabindex",-1)}h.extend(a.style,{fontSize:"999px",opacity:0});o.appendChild(a);e.appendChild(o);h.extend(a.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"});if(v.browser==="IE"&&v.verComp(v.version,10,"<")){h.extend(a.style,{filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"})}a.onchange=function(){var e;if(!this.value){return}if(this.files){e=this.files[0]}else{e={name:this.value}}e=new f(i.uid,e);this.onchange=function(){};d.call(t);t.files=[e];a.setAttribute("id",e.uid);o.setAttribute("id",e.uid+"_form");t.trigger("change");a=o=null};if(i.can("summon_file_dialog")){n=m.get(l.browse_button);p.removeEvent(n,"click",t.uid);p.addEvent(n,"click",function(e){if(a&&!a.disabled){a.click()}e.preventDefault()},t.uid)}u=s;e=r=n=null}h.extend(this,{init:function e(n){var r=this,o=r.getRuntime(),a;l=n;c=g.extList2mimes(n.accept,o.can("filter_by_extension"));a=o.getShimContainer();(function(){var e,t,i;e=m.get(n.browse_button);s=m.getStyle(e,"z-index")||"auto";if(o.can("summon_file_dialog")){if(m.getStyle(e,"position")==="static"){e.style.position="relative"}r.bind("Refresh",function(){t=parseInt(s,10)||1;m.get(l.browse_button).style.zIndex=t;this.getRuntime().getShimContainer().style.zIndex=t-1})}else{e.setAttribute("tabindex",-1)}i=o.can("summon_file_dialog")?e:a;p.addEvent(i,"mouseover",function(){r.trigger("mouseenter")},r.uid);p.addEvent(i,"mouseout",function(){r.trigger("mouseleave")},r.uid);p.addEvent(i,"mousedown",function(){r.trigger("mousedown")},r.uid);p.addEvent(m.get(n.container),"mouseup",function(){r.trigger("mouseup")},r.uid);e=null})();d.call(this);a=null;r.trigger({type:"ready",async:true})},setOption:function e(t,i){var n=this.getRuntime();var r;if(t=="accept"){c=i.mimes||g.extList2mimes(i,n.can("filter_by_extension"))}r=m.get(u);if(r){r.setAttribute("accept",c.join(","))}},disable:function e(t){var i;if(i=m.get(u)){i.disabled=!!t}},destroy:function e(){var t=this.getRuntime(),i=t.getShim(),n=t.getShimContainer(),r=l&&m.get(l.container),o=l&&m.get(l.browse_button);if(r){p.removeAllEvents(r,this.uid)}if(o){p.removeAllEvents(o,this.uid);o.style.zIndex=s}if(n){p.removeAllEvents(n,this.uid);n.innerHTML=""}i.removeInstance(this.uid);u=c=l=n=r=o=i=null}})}return e.FileInput=t});e("moxie/runtime/html4/file/FileReader",["moxie/runtime/html4/Runtime","moxie/runtime/html5/file/FileReader"],function(e,t){return e.FileReader=t});e("moxie/runtime/html4/xhr/XMLHttpRequest",["moxie/runtime/html4/Runtime","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Url","moxie/core/Exceptions","moxie/core/utils/Events","moxie/file/Blob","moxie/xhr/FormData"],function(e,m,p,g,v,x,y,w){function t(){var l,d,f;function h(t){var i=this,e,n,r,o,a=false;if(!f){return}e=f.id.replace(/_iframe$/,"");n=p.get(e+"_form");if(n){r=n.getElementsByTagName("input");o=r.length;while(o--){switch(r[o].getAttribute("type")){case"hidden":r[o].parentNode.removeChild(r[o]);break;case"file":a=true;break}}r=[];if(!a){n.parentNode.removeChild(n)}n=null}setTimeout(function(){x.removeEvent(f,"load",i.uid);if(f.parentNode){f.parentNode.removeChild(f)}var e=i.getRuntime().getShimContainer();if(!e.children.length){e.parentNode.removeChild(e)}e=f=null;t()},1)}m.extend(this,{send:function e(i,t){var n=this,r=n.getRuntime(),o,a,s,u;l=d=null;function c(){var e=r.getShimContainer()||document.body,t=document.createElement("div");t.innerHTML='<iframe id="'+o+'_iframe" name="'+o+'_iframe" src="javascript:&quot;&quot;" style="display:none"></iframe>';f=t.firstChild;e.appendChild(f);x.addEvent(f,"load",function(){var e;try{e=f.contentWindow.document||f.contentDocument||window.frames[f.id].document;if(/^4(0[0-9]|1[0-7]|2[2346])\s/.test(e.title)){l=e.title.replace(/^(\d+).*$/,"$1")}else{l=200;d=m.trim(e.body.innerHTML);n.trigger({type:"progress",loaded:d.length,total:d.length});if(u){n.trigger({type:"uploadprogress",loaded:u.size||1025,total:u.size||1025})}}}catch(e){if(g.hasSameOrigin(i.url)){l=404}else{h.call(n,function(){n.trigger("error")});return}}h.call(n,function(){n.trigger("load")})},n.uid)}if(t instanceof w&&t.hasBlob()){u=t.getBlob();o=u.uid;s=p.get(o);a=p.get(o+"_form");if(!a){throw new v.DOMException(v.DOMException.NOT_FOUND_ERR)}}else{o=m.guid("uid_");a=document.createElement("form");a.setAttribute("id",o+"_form");a.setAttribute("method",i.method);a.setAttribute("enctype","multipart/form-data");a.setAttribute("encoding","multipart/form-data");r.getShimContainer().appendChild(a)}a.setAttribute("target",o+"_iframe");if(t instanceof w){t.each(function(e,t){if(e instanceof y){if(s){s.setAttribute("name",t)}}else{var i=document.createElement("input");m.extend(i,{type:"hidden",name:t,value:e});if(s){a.insertBefore(i,s)}else{a.appendChild(i)}}})}a.setAttribute("action",i.url);c();a.submit();n.trigger("loadstart")},getStatus:function e(){return l},getResponse:function e(t){if("json"===t){if(m.typeOf(d)==="string"&&!!window.JSON){try{return JSON.parse(d.replace(/^\s*<pre[^>]*>/,"").replace(/<\/pre>\s*$/,""))}catch(e){return null}}}else if("document"===t){}return d},abort:function e(){var t=this;if(f&&f.contentWindow){if(f.contentWindow.stop){f.contentWindow.stop()}else if(f.contentWindow.document.execCommand){f.contentWindow.document.execCommand("Stop")}else{f.src="about:blank"}}h.call(this,function(){t.dispatchEvent("abort")})},destroy:function e(){this.getRuntime().getShim().removeInstance(this.uid)}})}return e.XMLHttpRequest=t});e("moxie/runtime/html4/image/Image",["moxie/runtime/html4/Runtime","moxie/runtime/html5/image/Image"],function(e,t){return e.Image=t});t(["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/core/utils/Env","moxie/core/Exceptions","moxie/core/utils/Dom","moxie/core/EventTarget","moxie/runtime/Runtime","moxie/runtime/RuntimeClient","moxie/file/Blob","moxie/core/I18n","moxie/core/utils/Mime","moxie/file/FileInput","moxie/file/File","moxie/file/FileDrop","moxie/file/FileReader","moxie/core/utils/Url","moxie/runtime/RuntimeTarget","moxie/xhr/FormData","moxie/xhr/XMLHttpRequest","moxie/image/Image","moxie/core/utils/Events","moxie/runtime/html5/image/ResizerCanvas"])})(this)}.apply(e,arguments),e.moxie}n=this||window,"object"===_typeof(t)&&t.exports?t.exports=r():n.moxie=r()},{}],4:[function(e,t,i){function n(){var e={};return function(){!function(a,y){"use strict";function n(e,t){for(var i,n=[],r=0;r<e.length;++r){if(i=s[e[r]]||o(e[r]),!i)throw"module definition dependecy not found: "+e[r];n.push(i)}t.apply(null,n)}function e(e,t,i){if("string"!=typeof e)throw"invalid module definition, module id must be defined and be a string";if(t===y)throw"invalid module definition, dependencies must be specified";if(i===y)throw"invalid module definition, definition function must be specified";n(t,function(){s[e]=i.apply(null,arguments)})}function h(e){return!!s[e]}function o(e){for(var t=a,i=e.split(/[.\/]/),n=0;n<i.length;++n){if(!t[i[n]])return;t=t[i[n]]}return t}function t(e){for(var t=0;t<e.length;t++){for(var i=a,n=e[t],r=n.split(/[.\/]/),o=0;o<r.length-1;++o){i[r[o]]===y&&(i[r[o]]={}),i=i[r[o]]}i[r[r.length-1]]=s[n]}}var s={};e("moxie/core/utils/Basic",[],function(){function s(e){var t;return e===t?"undefined":null===e?"null":e.nodeType?"node":{}.toString.call(e).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()}function t(){return c(!1,!1,arguments)}function e(){return c(!0,!1,arguments)}function i(){return c(!1,!0,arguments)}function n(){return c(!0,!0,arguments)}function r(e){switch(s(e)){case"array":return c(!1,!0,[[],e]);case"object":return c(!1,!0,[{},e]);default:return e}}function u(e){switch(s(e)){case"array":return Array.prototype.slice.call(e);case"object":return t({},e)}return e}function c(n,r,e){var o,a=e[0];return l(e,function(e,t){t>0&&l(e,function(e,t){var i=-1!==h(s(e),["array","object"]);return e===o||n&&a[t]===o?!0:(i&&r&&(e=u(e)),s(a[t])===s(e)&&i?c(n,r,[a[t],e]):a[t]=e,void 0)})}),a}function o(e,t){function i(){this.constructor=e}for(var n in t){({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])}return i.prototype=t.prototype,e.prototype=new i,e.parent=t.prototype,e}function l(e,t){var i,n,r,o;if(e){try{i=e.length}catch(e){i=o}if(i===o||"number"!=typeof i){for(n in e){if(e.hasOwnProperty(n)&&t(e[n],n)===!1)return}}else for(r=0;i>r;r++){if(t(e[r],r)===!1)return}}}function a(e){var t;if(!e||"object"!==s(e))return!0;for(t in e){return!1}return!0}function d(e,i){function n(t){"function"===s(e[t])&&e[t](function(e){++t<r&&!e?n(t):i(e)})}var t=0,r=e.length;"function"!==s(i)&&(i=function e(){}),e&&e.length||i(),n(t)}function f(e,n){var r=0,o=e.length,a=new Array(o);l(e,function(e,i){e(function(e){if(e)return n(e);var t=[].slice.call(arguments);t.shift(),a[i]=t,r++,r===o&&(a.unshift(null),n.apply(this,a))})})}function h(e,t){if(t){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(t,e);for(var i=0,n=t.length;n>i;i++){if(t[i]===e)return i}}return-1}function m(e,t){var i=[];"array"!==s(e)&&(e=[e]),"array"!==s(t)&&(t=[t]);for(var n in e){-1===h(e[n],t)&&i.push(e[n])}return i.length?i:!1}function p(e,t){var i=[];return l(e,function(e){-1!==h(e,t)&&i.push(e)}),i.length?i:null}function g(e){var t,i=[];for(t=0;t<e.length;t++){i[t]=e[t]}return i}function v(e){return e?String.prototype.trim?String.prototype.trim.call(e):e.toString().replace(/^\s*/,"").replace(/\s*$/,""):e}function x(e){if("string"!=typeof e)return e;var t,i={t:1099511627776,g:1073741824,m:1048576,k:1024};return e=/^([0-9\.]+)([tmgk]?)$/.exec(e.toLowerCase().replace(/[^0-9\.tmkg]/g,"")),t=e[2],e=+e[1],i.hasOwnProperty(t)&&(e*=i[t]),Math.floor(e)}function y(e){var n=[].slice.call(arguments,1);return e.replace(/%([a-z])/g,function(e,t){var i=n.shift();switch(t){case"s":return i+"";case"d":return parseInt(i,10);case"f":return parseFloat(i);case"c":return"";default:return i}})}function w(e,t){var i=this;setTimeout(function(){e.call(i)},t||1)}var _=function(){var n=0;return function(e){var t,i=(new Date).getTime().toString(32);for(t=0;5>t;t++){i+=Math.floor(65535*Math.random()).toString(32)}return(e||"o_")+i+(n++).toString(32)}}();return{guid:_,typeOf:s,extend:t,extendIf:e,extendImmutable:i,extendImmutableIf:n,clone:r,inherit:o,each:l,isEmptyObj:a,inSeries:d,inParallel:f,inArray:h,arrayDiff:m,arrayIntersect:p,toArray:g,trim:v,sprintf:y,parseSizeStr:x,delay:w}}),e("moxie/core/utils/Encode",[],function(){var g=function e(t){return unescape(encodeURIComponent(t))},v=function e(t){return decodeURIComponent(escape(t))},e=function e(t,i){if("function"==typeof window.atob)return i?v(window.atob(t)):window.atob(t);var n,r,o,a,s,u,c,l,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",f=0,h=0,m="",p=[];if(!t)return t;t+="";do{a=d.indexOf(t.charAt(f++)),s=d.indexOf(t.charAt(f++)),u=d.indexOf(t.charAt(f++)),c=d.indexOf(t.charAt(f++)),l=a<<18|s<<12|u<<6|c,n=255&l>>16,r=255&l>>8,o=255&l,p[h++]=64==u?String.fromCharCode(n):64==c?String.fromCharCode(n,r):String.fromCharCode(n,r,o)}while(f<t.length);return m=p.join(""),i?v(m):m},t=function e(t,i){if(i&&(t=g(t)),"function"==typeof window.btoa)return window.btoa(t);var e,n,r,o,a,s,u,c,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",d=0,f=0,h="",m=[];if(!t)return t;do{e=t.charCodeAt(d++),n=t.charCodeAt(d++),r=t.charCodeAt(d++),c=e<<16|n<<8|r,o=63&c>>18,a=63&c>>12,s=63&c>>6,u=63&c,m[f++]=l.charAt(o)+l.charAt(a)+l.charAt(s)+l.charAt(u)}while(d<t.length);h=m.join("");var p=t.length%3;return(p?h.slice(0,p-3):h)+"===".slice(p||3)};return{utf8_encode:g,utf8_decode:v,atob:e,btoa:t}}),e("moxie/core/utils/Env",["moxie/core/utils/Basic"],function(n){function e(e,t,i){var n=0,r=0,o=0,a={dev:-6,alpha:-5,a:-5,beta:-4,b:-4,RC:-3,rc:-3,"#":-2,p:1,pl:1},s=function e(t){return t=(""+t).replace(/[_\-+]/g,"."),t=t.replace(/([^.\d]+)/g,".$1.").replace(/\.{2,}/g,"."),t.length?t.split("."):[-8]},u=function e(t){return t?isNaN(t)?a[t]||-7:parseInt(t,10):0};for(e=s(e),t=s(t),r=Math.max(e.length,t.length),n=0;r>n;n++){if(e[n]!=t[n]){if(e[n]=u(e[n]),t[n]=u(t[n]),e[n]<t[n]){o=-1;break}if(e[n]>t[n]){o=1;break}}}if(!i)return o;switch(i){case">":case"gt":return o>0;case">=":case"ge":return o>=0;case"<=":case"le":return 0>=o;case"==":case"=":case"eq":return 0===o;case"<>":case"!=":case"ne":return 0!==o;case"":case"<":case"lt":return 0>o;default:return null}}var t=function(f){var n="",o="?",h="function",m="undefined",p="object",e="name",t="version",a={has:function e(t,i){return-1!==i.toLowerCase().indexOf(t.toLowerCase())},lowerize:function e(t){return t.toLowerCase()}},r={rgx:function e(){for(var t,i,n,r,o,a,s,u=0,c=arguments;u<c.length;u+=2){var l=c[u],d=c[u+1];if(_typeof(t)===m){t={};for(r in d){o=d[r],_typeof(o)===p?t[o[0]]=f:t[o]=f}}for(i=n=0;i<l.length;i++){if(a=l[i].exec(this.getUA())){for(r=0;r<d.length;r++){s=a[++n],o=d[r],_typeof(o)===p&&o.length>0?2==o.length?t[o[0]]=_typeof(o[1])==h?o[1].call(this,s):o[1]:3==o.length?t[o[0]]=_typeof(o[1])!==h||o[1].exec&&o[1].test?s?s.replace(o[1],o[2]):f:s?o[1].call(this,s,o[2]):f:4==o.length&&(t[o[0]]=s?o[3].call(this,s.replace(o[1],o[2])):f):t[o]=s?s:f}break}}if(a)break}return t},str:function e(t,i){for(var n in i){if(_typeof(i[n])===p&&i[n].length>0){for(var r=0;r<i[n].length;r++){if(a.has(i[n][r],t))return n===o?f:n}}else if(a.has(i[n],t))return n===o?f:n}return t}},i={browser:{oldsafari:{major:{1:["/8","/1","/3"],2:"/4","?":"/"},version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",RT:"ARM"}}}},s={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[e,t],[/\s(opr)\/([\w\.]+)/i],[[e,"Opera"],t],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi)\/([\w\.-]+)/i],[e,t],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[e,"IE"],t],[/(edge)\/((\d+)?[\w\.]+)/i],[e,t],[/(yabrowser)\/([\w\.]+)/i],[[e,"Yandex"],t],[/(comodo_dragon)\/([\w\.]+)/i],[[e,/_/g," "],t],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i,/(uc\s?browser|qqbrowser)[\/\s]?([\w\.]+)/i],[e,t],[/(dolfin)\/([\w\.]+)/i],[[e,"Dolphin"],t],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[e,"Chrome"],t],[/XiaoMi\/MiuiBrowser\/([\w\.]+)/i],[t,[e,"MIUI Browser"]],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)/i],[t,[e,"Android Browser"]],[/FBAV\/([\w\.]+);/i],[t,[e,"Facebook"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[t,[e,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[t,e],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[e,[t,r.str,i.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[e,t],[/(navigator|netscape)\/([\w\.-]+)/i],[[e,"Netscape"],t],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[e,t]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[t,[e,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[e,t],[/rv\:([\w\.]+).*(gecko)/i],[t,e]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[e,t],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[e,[t,r.str,i.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[e,"Windows"],[t,r.str,i.os.windows.version]],[/\((bb)(10);/i],[[e,"BlackBerry"],t],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],[e,t],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[e,"Symbian"],t],[/\((series40);/i],[e],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[e,"Firefox OS"],t],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[e,t],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[e,"Chromium OS"],t],[/(sunos)\s?([\w\.]+\d)*/i],[[e,"Solaris"],t],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[e,t],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[[e,"iOS"],[t,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[[e,"Mac OS"],[t,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],[e,t]]},u=function e(t){var i=t||(window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:n);this.getBrowser=function(){return r.rgx.apply(this,s.browser)},this.getEngine=function(){return r.rgx.apply(this,s.engine)},this.getOS=function(){return r.rgx.apply(this,s.os)},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS()}},this.getUA=function(){return i},this.setUA=function(e){return i=e,this},this.setUA(i)};return u}(),i=function(){var r={access_global_ns:function e(){return!!window.moxie},define_property:function(){return!1}(),create_canvas:function e(){var t=document.createElement("canvas"),i=!(!t.getContext||!t.getContext("2d"));return r.create_canvas=i,i},return_response_type:function e(t){try{if(-1!==n.inArray(t,["","text","document"]))return!0;if(window.XMLHttpRequest){var i=new XMLHttpRequest;if(i.open("get","/"),"responseType"in i)return i.responseType=t,i.responseType!==t?!1:!0}}catch(e){}return!1},use_blob_uri:function e(){var t=window.URL;return r.use_blob_uri=t&&"createObjectURL"in t&&"revokeObjectURL"in t&&("IE"!==o.browser||o.verComp(o.version,"11.0.46",">=")),r.use_blob_uri},use_data_uri:function(){var e=new Image;return e.onload=function(){r.use_data_uri=1===e.width&&1===e.height},setTimeout(function(){e.src="data:image/gif;base64,R0lGODlhAQABAIAAAP8AAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="},1),!1}(),use_data_uri_over32kb:function e(){return r.use_data_uri&&("IE"!==o.browser||o.version>=9)},use_data_uri_of:function e(t){return r.use_data_uri&&33e3>t||r.use_data_uri_over32kb()},use_fileinput:function e(){if(navigator.userAgent.match(/(Android (1.0|1.1|1.5|1.6|2.0|2.1))|(Windows Phone (OS 7|8.0))|(XBLWP)|(ZuneWP)|(w(eb)?OSBrowser)|(webOS)|(Kindle\/(1.0|2.0|2.5|3.0))/))return!1;var t=document.createElement("input");return t.setAttribute("type","file"),r.use_fileinput=!t.disabled},use_webgl:function e(){var t,i=document.createElement("canvas"),n=null;try{n=i.getContext("webgl")||i.getContext("experimental-webgl")}catch(e){}return n||(n=null),t=!!n,r.use_webgl=t,i=y,t}};return function(e){var t=[].slice.call(arguments);return t.shift(),"function"===n.typeOf(r[e])?r[e].apply(this,t):!!r[e]}}(),r=(new t).getResult(),o={can:i,uaParser:t,browser:r.browser.name,version:r.browser.version,os:r.os.name,osVersion:r.os.version,verComp:e,swf_url:"../flash/Moxie.swf",xap_url:"../silverlight/Moxie.xap",global_event_dispatcher:"moxie.core.EventTarget.instance.dispatchEvent"};return o.OS=o.os,o}),e("moxie/core/Exceptions",["moxie/core/utils/Basic"],function(n){function r(e,t){var i;for(i in e){if(e[i]===t)return i}return null}return{RuntimeError:function(){function e(e,t){this.code=e,this.name=r(i,e),this.message=this.name+(t||": RuntimeError "+this.code)}var i={NOT_INIT_ERR:1,EXCEPTION_ERR:3,NOT_SUPPORTED_ERR:9,JS_ERR:4};return n.extend(e,i),e.prototype=Error.prototype,e}(),OperationNotAllowedException:function(){function e(e){this.code=e,this.name="OperationNotAllowedException"}return n.extend(e,{NOT_ALLOWED_ERR:1}),e.prototype=Error.prototype,e}(),ImageError:function(){function e(e){this.code=e,this.name=r(t,e),this.message=this.name+": ImageError "+this.code}var t={WRONG_FORMAT:1,MAX_RESOLUTION_ERR:2,INVALID_META_ERR:3};return n.extend(e,t),e.prototype=Error.prototype,e}(),FileException:function(){function e(e){this.code=e,this.name=r(t,e),this.message=this.name+": FileException "+this.code}var t={NOT_FOUND_ERR:1,SECURITY_ERR:2,ABORT_ERR:3,NOT_READABLE_ERR:4,ENCODING_ERR:5,NO_MODIFICATION_ALLOWED_ERR:6,INVALID_STATE_ERR:7,SYNTAX_ERR:8};return n.extend(e,t),e.prototype=Error.prototype,e}(),DOMException:function(){function e(e){this.code=e,this.name=r(t,e),this.message=this.name+": DOMException "+this.code}var t={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};return n.extend(e,t),e.prototype=Error.prototype,e}(),EventException:function(){function e(e){this.code=e,this.name="EventException"}return n.extend(e,{UNSPECIFIED_EVENT_TYPE_ERR:0}),e.prototype=Error.prototype,e}()}}),e("moxie/core/utils/Dom",["moxie/core/utils/Env"],function(c){var e=function e(t){return"string"!=typeof t?t:document.getElementById(t)},n=function e(t,i){if(!t.className)return!1;var e=new RegExp("(^|\\s+)"+i+"(\\s+|$)");return e.test(t.className)},t=function e(t,i){n(t,i)||(t.className=t.className?t.className.replace(/\s+$/,"")+" "+i:i)},i=function e(t,i){if(t.className){var n=new RegExp("(^|\\s+)"+i+"(\\s+|$)");t.className=t.className.replace(n,function(e,t,i){return" "===t&&" "===i?" ":""})}},r=function e(t,i){return t.currentStyle?t.currentStyle[i]:window.getComputedStyle?window.getComputedStyle(t,null)[i]:void 0},o=function e(t,i){function n(e){var t,i,n=0,r=0;return e&&(i=e.getBoundingClientRect(),t="CSS1Compat"===u.compatMode?u.documentElement:u.body,n=i.left+t.scrollLeft,r=i.top+t.scrollTop),{x:n,y:r}}var r,o,e,a=0,s=0,u=document;if(t=t,i=i||u.body,t&&t.getBoundingClientRect&&"IE"===c.browser&&(!u.documentMode||u.documentMode<8))return o=n(t),e=n(i),{x:o.x-e.x,y:o.y-e.y};for(r=t;r&&r!=i&&r.nodeType;){a+=r.offsetLeft||0,s+=r.offsetTop||0,r=r.offsetParent}for(r=t.parentNode;r&&r!=i&&r.nodeType;){a-=r.scrollLeft||0,s-=r.scrollTop||0,r=r.parentNode}return{x:a,y:s}},a=function e(t){return{w:t.offsetWidth||t.clientWidth,h:t.offsetHeight||t.clientHeight}};return{get:e,hasClass:n,addClass:t,removeClass:i,getStyle:r,getPos:o,getSize:a}}),e("moxie/core/EventTarget",["moxie/core/utils/Env","moxie/core/Exceptions","moxie/core/utils/Basic"],function(e,l,d){function t(){this.uid=d.guid()}var f={};return d.extend(t.prototype,{init:function e(){this.uid||(this.uid=d.guid("uid_"))},addEventListener:function e(t,i,n,r){var o,a=this;return this.hasOwnProperty("uid")||(this.uid=d.guid("uid_")),t=d.trim(t),/\s/.test(t)?(d.each(t.split(/\s+/),function(e){a.addEventListener(e,i,n,r)}),void 0):(t=t.toLowerCase(),n=parseInt(n,10)||0,o=f[this.uid]&&f[this.uid][t]||[],o.push({fn:i,priority:n,scope:r||this}),f[this.uid]||(f[this.uid]={}),f[this.uid][t]=o,void 0)},hasEventListener:function e(t){var i;return t?(t=t.toLowerCase(),i=f[this.uid]&&f[this.uid][t]):i=f[this.uid],i?i:!1},removeEventListener:function e(t,i){var n,r,o=this;if(t=t.toLowerCase(),/\s/.test(t))return d.each(t.split(/\s+/),function(e){o.removeEventListener(e,i)}),void 0;if(n=f[this.uid]&&f[this.uid][t]){if(i){for(r=n.length-1;r>=0;r--){if(n[r].fn===i){n.splice(r,1);break}}}else n=[];n.length||(delete f[this.uid][t],d.isEmptyObj(f[this.uid])&&delete f[this.uid])}},removeAllEventListeners:function e(){f[this.uid]&&delete f[this.uid]},dispatchEvent:function e(t){var i,n,r,o,a,s={},u=!0;if("string"!==d.typeOf(t)){if(o=t,"string"!==d.typeOf(o.type))throw new l.EventException(l.EventException.UNSPECIFIED_EVENT_TYPE_ERR);t=o.type,o.total!==a&&o.loaded!==a&&(s.total=o.total,s.loaded=o.loaded),s.async=o.async||!1}if(-1!==t.indexOf("::")?function(e){i=e[0],t=e[1]}(t.split("::")):i=this.uid,t=t.toLowerCase(),n=f[i]&&f[i][t]){n.sort(function(e,t){return t.priority-e.priority}),r=[].slice.call(arguments),r.shift(),s.type=t,r.unshift(s);var c=[];d.each(n,function(t){r[0].target=t.scope,s.async?c.push(function(e){setTimeout(function(){e(t.fn.apply(t.scope,r)===!1)},1)}):c.push(function(e){e(t.fn.apply(t.scope,r)===!1)})}),c.length&&d.inSeries(c,function(e){u=!e})}return u},bindOnce:function e(t,i,n,r){var o=this;o.bind.call(this,t,function e(){return o.unbind(t,e),i.apply(this,arguments)},n,r)},bind:function e(){this.addEventListener.apply(this,arguments)},unbind:function e(){this.removeEventListener.apply(this,arguments)},unbindAll:function e(){this.removeAllEventListeners.apply(this,arguments)},trigger:function e(){return this.dispatchEvent.apply(this,arguments)},handleEventProps:function e(t){var i=this;this.bind(t.join(" "),function(e){var t="on"+e.type.toLowerCase();"function"===d.typeOf(this[t])&&this[t].apply(this,arguments)}),d.each(t,function(e){e="on"+e.toLowerCase(e),"undefined"===d.typeOf(i[e])&&(i[e]=null)})}}),t.instance=new t,t}),e("moxie/runtime/Runtime",["moxie/core/utils/Env","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/EventTarget"],function(t,c,l,i){function d(e,t,o,i,n){var a,r=this,s=c.guid(t+"_"),u=n||"browser";e=e||{},f[s]=this,o=c.extend({access_binary:!1,access_image_binary:!1,display_media:!1,do_cors:!1,drag_and_drop:!1,filter_by_extension:!0,resize_image:!1,report_upload_progress:!1,return_response_headers:!1,return_response_type:!1,return_status_code:!0,send_custom_headers:!1,select_file:!1,select_folder:!1,select_multiple:!0,send_binary_string:!1,send_browser_cookies:!0,send_multipart:!0,slice_blob:!1,stream_upload:!1,summon_file_dialog:!1,upload_filesize:!0,use_http_method:!0},o),e.preferred_caps&&(u=d.getMode(i,e.preferred_caps,u)),a=function(){var o={};return{exec:function e(t,i,n,r){return a[i]&&(o[t]||(o[t]={context:this,instance:new a[i]}),o[t].instance[n])?o[t].instance[n].apply(this,r):void 0},removeInstance:function e(t){delete o[t]},removeAllInstances:function e(){var i=this;c.each(o,function(e,t){"function"===c.typeOf(e.instance.destroy)&&e.instance.destroy.call(e.context),i.removeInstance(t)})}}}(),c.extend(this,{initialized:!1,uid:s,type:t,mode:d.getMode(i,e.required_caps,u),shimid:s+"_container",clients:0,options:e,can:function e(t,i){var n=arguments[2]||o;if("string"===c.typeOf(t)&&"undefined"===c.typeOf(i)&&(t=d.parseCaps(t)),"object"===c.typeOf(t)){for(var r in t){if(!this.can(r,t[r],n))return!1}return!0}return"function"===c.typeOf(n[t])?n[t].call(this,i):i===n[t]},getShimContainer:function e(){var t,i=l.get(this.shimid);return i||(t=l.get(this.options.container)||document.body,i=document.createElement("div"),i.id=this.shimid,i.className="moxie-shim moxie-shim-"+this.type,c.extend(i.style,{position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"}),t.appendChild(i),t=null),i},getShim:function e(){return a},shimExec:function e(t,i){var n=[].slice.call(arguments,2);return r.getShim().exec.call(this,this.uid,t,i,n)},exec:function e(t,i){var n=[].slice.call(arguments,2);return r[t]&&r[t][i]?r[t][i].apply(this,n):r.shimExec.apply(this,arguments)},destroy:function e(){if(r){var t=l.get(this.shimid);t&&t.parentNode.removeChild(t),a&&a.removeAllInstances(),this.unbindAll(),delete f[this.uid],this.uid=null,s=r=a=t=null}}}),this.mode&&e.required_caps&&!this.can(e.required_caps)&&(this.mode=!1)}var n={},f={};return d.order="html5,flash,silverlight,html4",d.getRuntime=function(e){return f[e]?f[e]:!1},d.addConstructor=function(e,t){t.prototype=i.instance,n[e]=t},d.getConstructor=function(e){return n[e]||null},d.getInfo=function(e){var t=d.getRuntime(e);return t?{uid:t.uid,type:t.type,mode:t.mode,can:function e(){return t.can.apply(t,arguments)}}:null},d.parseCaps=function(e){var t={};return"string"!==c.typeOf(e)?e||{}:(c.each(e.split(","),function(e){t[e]=!0}),t)},d.can=function(e,t){var i,n,r=d.getConstructor(e);return r?(i=new r({required_caps:t}),n=i.mode,i.destroy(),!!n):!1},d.thatCan=function(e,t){var i=(t||d.order).split(/\s*,\s*/);for(var n in i){if(d.can(i[n],e))return i[n]}return null},d.getMode=function(n,e,t){var r=null;if("undefined"===c.typeOf(t)&&(t="browser"),e&&!c.isEmptyObj(n)){if(c.each(e,function(e,t){if(n.hasOwnProperty(t)){var i=n[t](e);if("string"==typeof i&&(i=[i]),r){if(!(r=c.arrayIntersect(r,i)))return r=!1}else r=i}}),r)return-1!==c.inArray(t,r)?t:r[0];if(r===!1)return!1}return t},d.getGlobalEventTarget=function(){if(/^moxie\./.test(t.global_event_dispatcher)&&!t.can("access_global_ns")){var e=c.guid("moxie_event_target_");window[e]=function(e,t){i.instance.dispatchEvent(e,t)},t.global_event_dispatcher=e}return t.global_event_dispatcher},d.capTrue=function(){return!0},d.capFalse=function(){return!1},d.capTest=function(e){return function(){return!!e}},d}),e("moxie/runtime/RuntimeClient",["moxie/core/utils/Env","moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/Runtime"],function(e,s,i,u){return function(){var a;i.extend(this,{connectRuntime:function e(n){function r(e){var t,i;return e.length?(t=e.shift().toLowerCase(),(i=u.getConstructor(t))?(a=new i(n),a.bind("Init",function(){a.initialized=!0,setTimeout(function(){a.clients++,o.ruid=a.uid,o.trigger("RuntimeInit",a)},1)}),a.bind("Error",function(){a.destroy(),r(e)}),a.bind("Exception",function(e,t){var i=t.name+"(#"+t.code+")"+(t.message?", from: "+t.message:"");o.trigger("RuntimeError",new s.RuntimeError(s.RuntimeError.EXCEPTION_ERR,i))}),a.mode?(a.init(),void 0):(a.trigger("Error"),void 0)):(r(e),void 0)):(o.trigger("RuntimeError",new s.RuntimeError(s.RuntimeError.NOT_INIT_ERR)),a=null,void 0)}var t,o=this;if("string"===i.typeOf(n)?t=n:"string"===i.typeOf(n.ruid)&&(t=n.ruid),t){if(a=u.getRuntime(t))return o.ruid=t,a.clients++,a;throw new s.RuntimeError(s.RuntimeError.NOT_INIT_ERR)}r((n.runtime_order||u.order).split(/\s*,\s*/))},disconnectRuntime:function e(){a&&--a.clients<=0&&a.destroy(),a=null},getRuntime:function e(){return a&&a.uid?a:a=null},exec:function e(){return a?a.exec.apply(this,arguments):null},can:function e(t){return a?a.can(t):!1}})}}),e("moxie/file/Blob",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient"],function(o,n,i){function a(e,t){function r(e,t,i){var n,r=s[this.uid];return"string"===o.typeOf(r)&&r.length?(n=new a(null,{type:i,size:t-e}),n.detach(r.substr(e,n.size)),n):null}i.call(this),e&&this.connectRuntime(e),t?"string"===o.typeOf(t)&&(t={data:t}):t={},o.extend(this,{uid:t.uid||o.guid("uid_"),ruid:e,size:t.size||0,type:t.type||"",slice:function e(t,i,n){return this.isDetached()?r.apply(this,arguments):this.getRuntime().exec.call(this,"Blob","slice",this.getSource(),t,i,n)},getSource:function e(){return s[this.uid]?s[this.uid]:null},detach:function e(t){if(this.ruid&&(this.getRuntime().exec.call(this,"Blob","destroy"),this.disconnectRuntime(),this.ruid=null),t=t||"","data:"==t.substr(0,5)){var i=t.indexOf(";base64,");this.type=t.substring(5,i),t=n.atob(t.substring(i+8))}this.size=t.length,s[this.uid]=t},isDetached:function e(){return!this.ruid&&"string"===o.typeOf(s[this.uid])},destroy:function e(){this.detach(),delete s[this.uid]}}),t.data?this.detach(t.data):s[this.uid]=t}var s={};return a}),e("moxie/core/I18n",["moxie/core/utils/Basic"],function(n){var i={};return{addI18n:function e(t){return n.extend(i,t)},translate:function e(t){return i[t]||t},_:function e(t){return this.translate(t)},sprintf:function e(t){var i=[].slice.call(arguments,1);return t.replace(/%[a-z]/g,function(){var e=i.shift();return"undefined"!==n.typeOf(e)?e:""})}}}),e("moxie/core/utils/Mime",["moxie/core/utils/Basic","moxie/core/I18n"],function(s,r){var e="application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb xlt xla,application/vnd.ms-powerpoint,ppt pps pot ppa,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mp3 mpga mpega mp2,audio/x-wav,wav,audio/x-m4a,m4a,audio/ogg,oga ogg,audio/aiff,aiff aif,audio/flac,flac,audio/aac,aac,audio/ac3,ac3,audio/x-ms-wma,wma,image/bmp,bmp,image/gif,gif,image/jpeg,jpg jpeg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe m2v,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/3gpp,3gpp 3gp,video/3gpp2,3g2,video/vnd.rn-realvideo,rv,video/ogg,ogv,video/x-matroska,mkv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe",o={},a={},t=function e(t){var i,n,e,r=t.split(/,/);for(i=0;i<r.length;i+=2){for(e=r[i+1].split(/ /),n=0;n<e.length;n++){o[e[n]]=r[i]}a[r[i]]=e}},i=function e(t,i){var n,r,o,e,a=[];for(r=0;r<t.length;r++){for(n=t[r].extensions.toLowerCase().split(/\s*,\s*/),o=0;o<n.length;o++){if("*"===n[o])return[];if(e=a[n[o]],i&&/^\w+$/.test(n[o]))a.push("."+n[o]);else if(e&&-1===s.inArray(e,a))a.push(e);else if(!e)return[]}}return a},u=function e(t){var n=[];return s.each(t,function(e){if(e=e.toLowerCase(),"*"===e)return n=[],!1;var i=e.match(/^(\w+)\/(\*|\w+)$/);i&&("*"===i[2]?s.each(a,function(e,t){new RegExp("^"+i[1]+"/").test(t)&&[].push.apply(n,a[t])}):a[e]&&[].push.apply(n,a[e]))}),n},n=function e(t){var i=[],n=[];return"string"===s.typeOf(t)&&(t=s.trim(t).split(/\s*,\s*/)),n=u(t),i.push({title:r.translate("Files"),extensions:n.length?n.join(","):"*"}),i},c=function e(t){var i=t&&t.match(/\.([^.]+)$/);return i?i[1].toLowerCase():""},l=function e(t){return o[c(t)]||""};return t(e),{mimes:o,extensions:a,addMimeType:t,extList2mimes:i,mimes2exts:u,mimes2extList:n,getFileExtension:c,getFileMime:l}}),e("moxie/file/FileInput",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Mime","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/core/EventTarget","moxie/core/I18n","moxie/runtime/Runtime","moxie/runtime/RuntimeClient"],function(s,e,r,u,o,t,n,c,l){function i(a){var e,t,i;if(-1!==s.inArray(s.typeOf(a),["string","node"])&&(a={browse_button:a}),t=u.get(a.browse_button),!t)throw new o.DOMException(o.DOMException.NOT_FOUND_ERR);i={accept:[{title:n.translate("All Files"),extensions:"*"}],multiple:!1,required_caps:!1,container:t.parentNode||document.body},a=s.extend({},i,a),"string"==typeof a.required_caps&&(a.required_caps=c.parseCaps(a.required_caps)),"string"==typeof a.accept&&(a.accept=r.mimes2extList(a.accept)),e=u.get(a.container),e||(e=document.body),"static"===u.getStyle(e,"position")&&(e.style.position="relative"),e=t=null,l.call(this),s.extend(this,{uid:s.guid("uid_"),ruid:null,shimid:null,files:null,init:function e(){var t=this;t.bind("RuntimeInit",function(e,o){t.ruid=o.uid,t.shimid=o.shimid,t.bind("Ready",function(){t.trigger("Refresh")},999),t.bind("Refresh",function(){var e,t,i,n,r;i=u.get(a.browse_button),n=u.get(o.shimid),i&&(e=u.getPos(i,u.get(a.container)),t=u.getSize(i),r=parseInt(u.getStyle(i,"z-index"),10)||0,n&&s.extend(n.style,{top:e.y+"px",left:e.x+"px",width:t.w+"px",height:t.h+"px",zIndex:r+1})),n=i=null}),o.exec.call(t,"FileInput","init",a)}),t.connectRuntime(s.extend({},a,{required_caps:{select_file:!0}}))},getOption:function e(t){return a[t]},setOption:function e(t,i){if(a.hasOwnProperty(t)){var n=a[t];switch(t){case"accept":"string"==typeof i&&(i=r.mimes2extList(i));break;case"container":case"required_caps":throw new o.FileException(o.FileException.NO_MODIFICATION_ALLOWED_ERR)}a[t]=i,this.exec("FileInput","setOption",t,i),this.trigger("OptionChanged",t,i,n)}},disable:function e(t){var i=this.getRuntime();i&&this.exec("FileInput","disable","undefined"===s.typeOf(t)?!0:t)},refresh:function e(){this.trigger("Refresh")},destroy:function e(){var t=this.getRuntime();t&&(t.exec.call(this,"FileInput","destroy"),this.disconnectRuntime()),"array"===s.typeOf(this.files)&&s.each(this.files,function(e){e.destroy()}),this.files=null,this.unbindAll()}}),this.handleEventProps(d)}var d=["ready","change","cancel","mouseenter","mouseleave","mousedown","mouseup"];return i.prototype=t.instance,i}),e("moxie/file/File",["moxie/core/utils/Basic","moxie/core/utils/Mime","moxie/file/Blob"],function(r,o,a){function e(e,t){t||(t={}),a.apply(this,arguments),this.type||(this.type=o.getFileMime(t.name));var i;if(t.name)i=t.name.replace(/\\/g,"/"),i=i.substr(i.lastIndexOf("/")+1);else if(this.type){var n=this.type.split("/")[0];i=r.guid((""!==n?n:"file")+"_"),o.extensions[this.type]&&(i+="."+o.extensions[this.type][0])}r.extend(this,{name:i||r.guid("file_"),relativePath:"",lastModifiedDate:t.lastModifiedDate||(new Date).toLocaleString()})}return e.prototype=a.prototype,e}),e("moxie/file/FileDrop",["moxie/core/I18n","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/core/utils/Basic","moxie/core/utils/Env","moxie/file/File","moxie/runtime/RuntimeClient","moxie/core/EventTarget","moxie/core/utils/Mime"],function(t,r,e,o,i,n,a,s,u){function c(i){var e,n=this;"string"==typeof i&&(i={drop_zone:i}),e={accept:[{title:t.translate("All Files"),extensions:"*"}],required_caps:{drag_and_drop:!0}},i="object"==_typeof(i)?o.extend({},e,i):e,i.container=r.get(i.drop_zone)||document.body,"static"===r.getStyle(i.container,"position")&&(i.container.style.position="relative"),"string"==typeof i.accept&&(i.accept=u.mimes2extList(i.accept)),a.call(n),o.extend(n,{uid:o.guid("uid_"),ruid:null,files:null,init:function e(){n.bind("RuntimeInit",function(e,t){n.ruid=t.uid,t.exec.call(n,"FileDrop","init",i),n.dispatchEvent("ready")}),n.connectRuntime(i)},destroy:function e(){var t=this.getRuntime();t&&(t.exec.call(this,"FileDrop","destroy"),this.disconnectRuntime()),this.files=null,this.unbindAll()}}),this.handleEventProps(l)}var l=["ready","dragenter","dragleave","drop","error"];return c.prototype=s.instance,c}),e("moxie/file/FileReader",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/core/Exceptions","moxie/core/EventTarget","moxie/file/Blob","moxie/runtime/RuntimeClient"],function(t,n,r,e,o,a){function s(){function i(e,t){if(this.trigger("loadstart"),this.readyState===s.LOADING)return this.trigger("error",new r.DOMException(r.DOMException.INVALID_STATE_ERR)),this.trigger("loadend"),void 0;if(!(t instanceof o))return this.trigger("error",new r.DOMException(r.DOMException.NOT_FOUND_ERR)),this.trigger("loadend"),void 0;if(this.result=null,this.readyState=s.LOADING,t.isDetached()){var i=t.getSource();switch(e){case"readAsText":case"readAsBinaryString":this.result=i;break;case"readAsDataURL":this.result="data:"+t.type+";base64,"+n.btoa(i)}this.readyState=s.DONE,this.trigger("load"),this.trigger("loadend")}else this.connectRuntime(t.ruid),this.exec("FileReader","read",e,t)}a.call(this),t.extend(this,{uid:t.guid("uid_"),readyState:s.EMPTY,result:null,error:null,readAsBinaryString:function e(t){i.call(this,"readAsBinaryString",t)},readAsDataURL:function e(t){i.call(this,"readAsDataURL",t)},readAsText:function e(t){i.call(this,"readAsText",t)},abort:function e(){this.result=null,-1===t.inArray(this.readyState,[s.EMPTY,s.DONE])&&(this.readyState===s.LOADING&&(this.readyState=s.DONE),this.exec("FileReader","abort"),this.trigger("abort"),this.trigger("loadend"))},destroy:function e(){this.abort(),this.exec("FileReader","destroy"),this.disconnectRuntime(),this.unbindAll()}}),this.handleEventProps(u),this.bind("Error",function(e,t){this.readyState=s.DONE,this.error=t},999),this.bind("Load",function(){this.readyState=s.DONE},999)}var u=["loadstart","progress","load","abort","error","loadend"];return s.EMPTY=0,s.LOADING=1,s.DONE=2,s.prototype=e.instance,s}),e("moxie/core/utils/Url",["moxie/core/utils/Basic"],function(f){var n=function e(t,i){var n,r=["source","scheme","authority","userInfo","user","pass","host","port","relative","path","directory","file","query","fragment"],o=r.length,a={http:80,https:443},s={},u=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@\/]*):?([^:@\/]*))?@)?(\[[\da-fA-F:]+\]|[^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/,c=u.exec(t||""),l=/^\/\/\w/.test(t);switch(f.typeOf(i)){case"undefined":i=e(document.location.href,!1);break;case"string":i=e(i,!1)}for(;o--;){c[o]&&(s[r[o]]=c[o])}if(n=!l&&!s.scheme,(l||n)&&(s.scheme=i.scheme),n){s.host=i.host,s.port=i.port;var d="";/^[^\/]/.test(s.path)&&(d=i.path,d=/\/[^\/]*\.[^\/]*$/.test(d)?d.replace(/\/[^\/]+$/,"/"):d.replace(/\/?$/,"/")),s.path=d+(s.path||"")}return s.port||(s.port=a[s.scheme]||80),s.port=parseInt(s.port,10),s.path||(s.path="/"),delete s.source,s},e=function e(t){var e={http:80,https:443},i="object"==_typeof(t)?t:n(t);return i.scheme+"://"+i.host+(i.port!==e[i.scheme]?":"+i.port:"")+i.path+(i.query?i.query:"")},t=function e(t){function i(e){return[e.scheme,e.host,e.port].join("/")}return"string"==typeof t&&(t=n(t)),i(n())===i(t)};return{parseUrl:n,resolveUrl:e,hasSameOrigin:t}}),e("moxie/runtime/RuntimeTarget",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(e,t,i){function n(){this.uid=e.guid("uid_"),t.call(this),this.destroy=function(){this.disconnectRuntime(),this.unbindAll()}}return n.prototype=i.instance,n}),e("moxie/file/FileReaderSync",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/utils/Encode"],function(e,t,s){return function(){function i(e,t){if(!t.isDetached()){var i=this.connectRuntime(t.ruid).exec.call(this,"FileReaderSync","read",e,t);return this.disconnectRuntime(),i}var n=t.getSource();switch(e){case"readAsBinaryString":return n;case"readAsDataURL":return"data:"+t.type+";base64,"+s.btoa(n);case"readAsText":for(var r="",o=0,a=n.length;a>o;o++){r+=String.fromCharCode(n[o])}return r}}t.call(this),e.extend(this,{uid:e.guid("uid_"),readAsBinaryString:function e(t){return i.call(this,"readAsBinaryString",t)},readAsDataURL:function e(t){return i.call(this,"readAsDataURL",t)},readAsText:function e(t){return i.call(this,"readAsText",t)}})}}),e("moxie/xhr/FormData",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/file/Blob"],function(e,s,u){function t(){var o,a=[];s.extend(this,{append:function e(i,t){var n=this,r=s.typeOf(t);t instanceof u?o={name:i,value:t}:"array"===r?(i+="[]",s.each(t,function(e){n.append(i,e)})):"object"===r?s.each(t,function(e,t){n.append(i+"["+t+"]",e)}):"null"===r||"undefined"===r||"number"===r&&isNaN(t)?n.append(i,"false"):a.push({name:i,value:t.toString()})},hasBlob:function e(){return!!this.getBlob()},getBlob:function e(){return o&&o.value||null},getBlobName:function e(){return o&&o.name||null},each:function e(t){s.each(a,function(e){t(e.value,e.name)}),o&&t(o.value,o.name)},destroy:function e(){o=null,a=[]}})}return t}),e("moxie/xhr/XMLHttpRequest",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/core/EventTarget","moxie/core/utils/Encode","moxie/core/utils/Url","moxie/runtime/Runtime","moxie/runtime/RuntimeTarget","moxie/file/Blob","moxie/file/FileReaderSync","moxie/xhr/FormData","moxie/core/utils/Env","moxie/core/utils/Mime"],function(T,S,e,O,D,C,N,L,t,F,M,B){function P(){this.uid=T.guid("uid_")}function z(){function s(e,t){return a.hasOwnProperty(e)?1===arguments.length?M.can("define_property")?a[e]:n[e]:(M.can("define_property")?a[e]=t:n[e]=t,void 0):void 0}function r(e){function i(){o&&(o.destroy(),o=null),r.dispatchEvent("loadend"),r=null}function n(t){o.bind("LoadStart",function(e){s("readyState",z.LOADING),r.dispatchEvent("readystatechange"),r.dispatchEvent(e),y&&r.upload.dispatchEvent(e)}),o.bind("Progress",function(e){s("readyState")!==z.LOADING&&(s("readyState",z.LOADING),r.dispatchEvent("readystatechange")),r.dispatchEvent(e)}),o.bind("UploadProgress",function(e){y&&r.upload.dispatchEvent({type:"progress",lengthComputable:!1,total:e.total,loaded:e.loaded})}),o.bind("Load",function(e){s("readyState",z.DONE),s("status",Number(t.exec.call(o,"XMLHttpRequest","getStatus")||0)),s("statusText",k[s("status")]||""),s("response",t.exec.call(o,"XMLHttpRequest","getResponse",s("responseType"))),~T.inArray(s("responseType"),["text",""])?s("responseText",s("response")):"document"===s("responseType")&&s("responseXML",s("response")),I=t.exec.call(o,"XMLHttpRequest","getAllResponseHeaders"),r.dispatchEvent("readystatechange"),s("status")>0?(y&&r.upload.dispatchEvent(e),r.dispatchEvent(e)):(_=!0,r.dispatchEvent("error")),i()}),o.bind("Abort",function(e){r.dispatchEvent(e),i()}),o.bind("Error",function(e){_=!0,s("readyState",z.DONE),r.dispatchEvent("readystatechange"),w=!0,r.dispatchEvent(e),i()}),t.exec.call(o,"XMLHttpRequest","send",{url:c,method:l,async:h,user:d,password:f,headers:m,mimeType:g,encoding:p,responseType:r.responseType,withCredentials:r.withCredentials,options:A},e)}var r=this;t=(new Date).getTime(),o=new N,"string"==typeof A.required_caps&&(A.required_caps=C.parseCaps(A.required_caps)),A.required_caps=T.extend({},A.required_caps,{return_response_type:r.responseType}),e instanceof F&&(A.required_caps.send_multipart=!0),T.isEmptyObj(m)||(A.required_caps.send_custom_headers=!0),b||(A.required_caps.do_cors=!0),A.ruid?n(o.connectRuntime(A)):(o.bind("RuntimeInit",function(e,t){n(t)}),o.bind("RuntimeError",function(e,t){r.dispatchEvent("RuntimeError",t)}),o.connectRuntime(A))}function u(){s("responseText",""),s("responseXML",null),s("response",null),s("status",0),s("statusText",""),t=e=null}var c,l,d,f,t,e,o,i,n=this,a={timeout:0,readyState:z.UNSENT,withCredentials:!1,status:0,statusText:"",responseType:"",responseXML:null,responseText:null,response:null},h=!0,m={},p=null,g=null,v=!1,x=!1,y=!1,w=!1,_=!1,b=!1,E=null,R=null,A={},I="";T.extend(this,a,{uid:T.guid("uid_"),upload:new P,open:function e(t,i,n,r,o){var a;if(!t||!i)throw new S.DOMException(S.DOMException.SYNTAX_ERR);if(/[\u0100-\uffff]/.test(t)||O.utf8_encode(t)!==t)throw new S.DOMException(S.DOMException.SYNTAX_ERR);if(~T.inArray(t.toUpperCase(),["CONNECT","DELETE","GET","HEAD","OPTIONS","POST","PUT","TRACE","TRACK"])&&(l=t.toUpperCase()),~T.inArray(l,["CONNECT","TRACE","TRACK"]))throw new S.DOMException(S.DOMException.SECURITY_ERR);if(i=O.utf8_encode(i),a=D.parseUrl(i),b=D.hasSameOrigin(a),c=D.resolveUrl(i),(r||o)&&!b)throw new S.DOMException(S.DOMException.INVALID_ACCESS_ERR);if(d=r||a.user,f=o||a.pass,h=n||!0,h===!1&&(s("timeout")||s("withCredentials")||""!==s("responseType")))throw new S.DOMException(S.DOMException.INVALID_ACCESS_ERR);v=!h,x=!1,m={},u.call(this),s("readyState",z.OPENED),this.dispatchEvent("readystatechange")},setRequestHeader:function e(t,i){var n=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","content-transfer-encoding","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"];if(s("readyState")!==z.OPENED||x)throw new S.DOMException(S.DOMException.INVALID_STATE_ERR);if(/[\u0100-\uffff]/.test(t)||O.utf8_encode(t)!==t)throw new S.DOMException(S.DOMException.SYNTAX_ERR);return t=T.trim(t).toLowerCase(),~T.inArray(t,n)||/^(proxy\-|sec\-)/.test(t)?!1:(m[t]?m[t]+=", "+i:m[t]=i,!0)},hasRequestHeader:function e(t){return t&&m[t.toLowerCase()]||!1},getAllResponseHeaders:function e(){return I||""},getResponseHeader:function e(t){return t=t.toLowerCase(),_||~T.inArray(t,["set-cookie","set-cookie2"])?null:I&&""!==I&&(i||(i={},T.each(I.split(/\r\n/),function(e){var t=e.split(/:\s+/);2===t.length&&(t[0]=T.trim(t[0]),i[t[0].toLowerCase()]={header:t[0],value:T.trim(t[1])})})),i.hasOwnProperty(t))?i[t].header+": "+i[t].value:null},overrideMimeType:function e(t){var i,n;if(~T.inArray(s("readyState"),[z.LOADING,z.DONE]))throw new S.DOMException(S.DOMException.INVALID_STATE_ERR);if(t=T.trim(t.toLowerCase()),/;/.test(t)&&(i=t.match(/^([^;]+)(?:;\scharset\=)?(.*)$/))&&(t=i[1],i[2]&&(n=i[2])),!B.mimes[t])throw new S.DOMException(S.DOMException.SYNTAX_ERR);E=t,R=n},send:function e(t,i){if(A="string"===T.typeOf(i)?{ruid:i}:i?i:{},this.readyState!==z.OPENED||x)throw new S.DOMException(S.DOMException.INVALID_STATE_ERR);if(t instanceof L)A.ruid=t.ruid,g=t.type||"application/octet-stream";else if(t instanceof F){if(t.hasBlob()){var n=t.getBlob();A.ruid=n.ruid,g=n.type||"application/octet-stream"}}else"string"==typeof t&&(p="UTF-8",g="text/plain;charset=UTF-8",t=O.utf8_encode(t));this.withCredentials||(this.withCredentials=A.required_caps&&A.required_caps.send_browser_cookies&&!b),y=!v&&this.upload.hasEventListener(),_=!1,w=!t,v||(x=!0),r.call(this,t)},abort:function e(){if(_=!0,v=!1,~T.inArray(s("readyState"),[z.UNSENT,z.OPENED,z.DONE]))s("readyState",z.UNSENT);else{if(s("readyState",z.DONE),x=!1,!o)throw new S.DOMException(S.DOMException.INVALID_STATE_ERR);o.getRuntime().exec.call(o,"XMLHttpRequest","abort",w),w=!0}},destroy:function e(){o&&("function"===T.typeOf(o.destroy)&&o.destroy(),o=null),this.unbindAll(),this.upload&&(this.upload.unbindAll(),this.upload=null)}}),this.handleEventProps(U.concat(["readystatechange"])),this.upload.handleEventProps(U)}var k={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Reserved",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",426:"Upgrade Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",510:"Not Extended"};P.prototype=e.instance;var U=["loadstart","progress","abort","error","load","timeout","loadend"];return z.UNSENT=0,z.OPENED=1,z.HEADERS_RECEIVED=2,z.LOADING=3,z.DONE=4,z.prototype=e.instance,z}),e("moxie/runtime/Transporter",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(f,h,e,t){function m(){function a(){l=o=0,c=this.result=null}function s(e,t){var i=this;r=t,i.bind("TransportingProgress",function(e){o=e.loaded,l>o&&-1===f.inArray(i.state,[m.IDLE,m.DONE])&&n.call(i)},999),i.bind("TransportingComplete",function(){o=l,i.state=m.DONE,c=null,i.result=r.exec.call(i,"Transporter","getAsBlob",e||"")},999),i.state=m.BUSY,i.trigger("TransportingStarted"),n.call(i)}function n(){var e,t=this,i=l-o;d>i&&(d=i),e=h.btoa(c.substr(o,d)),r.exec.call(t,"Transporter","receive",e,l)}var u,r,c,l,o,d;e.call(this),f.extend(this,{uid:f.guid("uid_"),state:m.IDLE,result:null,transport:function e(t,n,i){var r=this;if(i=f.extend({chunk_size:204798},i),(u=i.chunk_size%3)&&(i.chunk_size+=3-u),d=i.chunk_size,a.call(this),c=t,l=t.length,"string"===f.typeOf(i)||i.ruid)s.call(r,n,this.connectRuntime(i));else{var o=function e(t,i){r.unbind("RuntimeInit",e),s.call(r,n,i)};this.bind("RuntimeInit",o),this.connectRuntime(i)}},abort:function e(){var t=this;t.state=m.IDLE,r&&(r.exec.call(t,"Transporter","clear"),t.trigger("TransportingAborted")),a.call(t)},destroy:function e(){this.unbindAll(),r=null,this.disconnectRuntime(),a.call(this)}})}return m.IDLE=0,m.BUSY=1,m.DONE=2,m.prototype=t.instance,m}),e("moxie/image/Image",["moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/file/FileReaderSync","moxie/xhr/XMLHttpRequest","moxie/runtime/Runtime","moxie/runtime/RuntimeClient","moxie/runtime/Transporter","moxie/core/utils/Env","moxie/core/EventTarget","moxie/file/Blob","moxie/file/File","moxie/core/utils/Encode"],function(c,l,d,e,a,s,t,f,h,i,u,m,p){function g(){function e(e){try{return e||(e=this.exec("Image","getInfo")),this.size=e.size,this.width=e.width,this.height=e.height,this.type=e.type,this.meta=e.meta,""===this.name&&(this.name=e.name),!0}catch(e){return this.trigger("error",e.code),!1}}function i(e){var t=c.typeOf(e);try{if(e instanceof g){if(!e.size)throw new d.DOMException(d.DOMException.INVALID_STATE_ERR);n.apply(this,arguments)}else if(e instanceof u){if(!~c.inArray(e.type,["image/jpeg","image/png"]))throw new d.ImageError(d.ImageError.WRONG_FORMAT);r.apply(this,arguments)}else if(-1!==c.inArray(t,["blob","file"]))i.call(this,new m(null,e),arguments[1]);else if("string"===t)"data:"===e.substr(0,5)?i.call(this,new u(null,{data:e}),arguments[1]):o.apply(this,arguments);else{if("node"!==t||"img"!==e.nodeName.toLowerCase())throw new d.DOMException(d.DOMException.TYPE_MISMATCH_ERR);i.call(this,e.src,arguments[1])}}catch(e){this.trigger("error",e.code)}}function n(e,t){var i=this.connectRuntime(e.ruid);this.ruid=i.uid,i.exec.call(this,"Image","loadFromImage",e,"undefined"===c.typeOf(t)?!0:t)}function r(t,e){function i(e){n.ruid=e.uid,e.exec.call(n,"Image","loadFromBlob",t)}var n=this;n.name=t.name||"",t.isDetached()?(this.bind("RuntimeInit",function(e,t){i(t)}),e&&"string"==typeof e.required_caps&&(e.required_caps=s.parseCaps(e.required_caps)),this.connectRuntime(c.extend({required_caps:{access_image_binary:!0,resize_image:!0}},e))):i(this.connectRuntime(t.ruid))}function o(e,t){var i,n=this;i=new a,i.open("get",e),i.responseType="blob",i.onprogress=function(e){n.trigger(e)},i.onload=function(){r.call(n,i.response,!0)},i.onerror=function(e){n.trigger(e)},i.onloadend=function(){i.destroy()},i.bind("RuntimeError",function(e,t){n.trigger("RuntimeError",t)}),i.send(null,t)}t.call(this),c.extend(this,{uid:c.guid("uid_"),ruid:null,name:"",size:0,width:0,height:0,type:"",meta:{},clone:function e(){this.load.apply(this,arguments)},load:function e(){i.apply(this,arguments)},resize:function e(t){var i,n,r=this,o={x:0,y:0,width:r.width,height:r.height},a=c.extendIf({width:r.width,height:r.height,type:r.type||"image/jpeg",quality:90,crop:!1,fit:!0,preserveHeaders:!0,resample:"default",multipass:!0},t);try{if(!r.size)throw new d.DOMException(d.DOMException.INVALID_STATE_ERR);if(r.width>g.MAX_RESIZE_WIDTH||r.height>g.MAX_RESIZE_HEIGHT)throw new d.ImageError(d.ImageError.MAX_RESOLUTION_ERR);if(i=r.meta&&r.meta.tiff&&r.meta.tiff.Orientation||1,-1!==c.inArray(i,[5,6,7,8])){var s=a.width;a.width=a.height,a.height=s}if(a.crop){switch(n=Math.max(a.width/r.width,a.height/r.height),t.fit?(o.width=Math.min(Math.ceil(a.width/n),r.width),o.height=Math.min(Math.ceil(a.height/n),r.height),n=a.width/o.width):(o.width=Math.min(a.width,r.width),o.height=Math.min(a.height,r.height),n=1),"boolean"==typeof a.crop&&(a.crop="cc"),a.crop.toLowerCase().replace(/_/,"-")){case"rb":case"right-bottom":o.x=r.width-o.width,o.y=r.height-o.height;break;case"cb":case"center-bottom":o.x=Math.floor((r.width-o.width)/2),o.y=r.height-o.height;break;case"lb":case"left-bottom":o.x=0,o.y=r.height-o.height;break;case"lt":case"left-top":o.x=0,o.y=0;break;case"ct":case"center-top":o.x=Math.floor((r.width-o.width)/2),o.y=0;break;case"rt":case"right-top":o.x=r.width-o.width,o.y=0;break;case"rc":case"right-center":case"right-middle":o.x=r.width-o.width,o.y=Math.floor((r.height-o.height)/2);break;case"lc":case"left-center":case"left-middle":o.x=0,o.y=Math.floor((r.height-o.height)/2);break;case"cc":case"center-center":case"center-middle":default:o.x=Math.floor((r.width-o.width)/2),o.y=Math.floor((r.height-o.height)/2)}o.x=Math.max(o.x,0),o.y=Math.max(o.y,0)}else n=Math.min(a.width/r.width,a.height/r.height),n>1&&!a.fit&&(n=1);this.exec("Image","resize",o,n,a)}catch(e){r.trigger("error",e.code)}},downsize:function e(t){var i,n={width:this.width,height:this.height,type:this.type||"image/jpeg",quality:90,crop:!1,fit:!1,preserveHeaders:!0,resample:"default"};i="object"==_typeof(t)?c.extend(n,t):c.extend(n,{width:arguments[0],height:arguments[1],crop:arguments[2],preserveHeaders:arguments[3]}),this.resize(i)},crop:function e(t,i,n){this.downsize(t,i,!0,n)},getAsCanvas:function e(){if(!h.can("create_canvas"))throw new d.RuntimeError(d.RuntimeError.NOT_SUPPORTED_ERR);return this.exec("Image","getAsCanvas")},getAsBlob:function e(t,i){if(!this.size)throw new d.DOMException(d.DOMException.INVALID_STATE_ERR);return this.exec("Image","getAsBlob",t||"image/jpeg",i||90)},getAsDataURL:function e(t,i){if(!this.size)throw new d.DOMException(d.DOMException.INVALID_STATE_ERR);return this.exec("Image","getAsDataURL",t||"image/jpeg",i||90)},getAsBinaryString:function e(t,i){var n=this.getAsDataURL(t,i);return p.atob(n.substring(n.indexOf("base64,")+7))},embed:function e(a,t){function i(e,t){var i=this;if(h.can("create_canvas")){var n=i.getAsCanvas();if(n)return a.appendChild(n),n=null,i.destroy(),u.trigger("embedded"),void 0}var r=i.getAsDataURL(e,t);if(!r)throw new d.ImageError(d.ImageError.WRONG_FORMAT);if(h.can("use_data_uri_of",r.length))a.innerHTML='<img src="'+r+'" width="'+i.width+'" height="'+i.height+'" alt="" />',i.destroy(),u.trigger("embedded");else{var o=new f;o.bind("TransportingComplete",function(){s=u.connectRuntime(this.result.ruid),u.bind("Embedded",function(){c.extend(s.getShimContainer().style,{top:"0px",left:"0px",width:i.width+"px",height:i.height+"px"}),s=null},999),s.exec.call(u,"ImageView","display",this.result.uid,width,height),i.destroy()}),o.transport(p.atob(r.substring(r.indexOf("base64,")+7)),e,{required_caps:{display_media:!0},runtime_order:"flash,silverlight",container:a})}}var s,u=this,n=c.extend({width:this.width,height:this.height,type:this.type||"image/jpeg",quality:90,fit:!0,resample:"nearest"},t);try{if(!(a=l.get(a)))throw new d.DOMException(d.DOMException.INVALID_NODE_TYPE_ERR);if(!this.size)throw new d.DOMException(d.DOMException.INVALID_STATE_ERR);this.width>g.MAX_RESIZE_WIDTH||this.height>g.MAX_RESIZE_HEIGHT;var r=new g;return r.bind("Resize",function(){i.call(this,n.type,n.quality)}),r.bind("Load",function(){this.downsize(n)}),this.meta.thumb&&this.meta.thumb.width>=n.width&&this.meta.thumb.height>=n.height?r.load(this.meta.thumb.data):r.clone(this,!1),r}catch(e){this.trigger("error",e.code)}},destroy:function e(){this.ruid&&(this.getRuntime().exec.call(this,"Image","destroy"),this.disconnectRuntime()),this.meta&&this.meta.thumb&&this.meta.thumb.data.destroy(),this.unbindAll()}}),this.handleEventProps(v),this.bind("Load Resize",function(){return e.call(this)},999)}var v=["progress","load","error","resize","embedded"];return g.MAX_RESIZE_WIDTH=8192,g.MAX_RESIZE_HEIGHT=8192,g.prototype=i.instance,g}),e("moxie/runtime/html5/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(o,e,a,s){function t(e){var t=this,i=a.capTest,n=a.capTrue,r=o.extend({access_binary:i(window.FileReader||window.File&&window.File.getAsDataURL),access_image_binary:function e(){return t.can("access_binary")&&!!c.Image},display_media:i((s.can("create_canvas")||s.can("use_data_uri_over32kb"))&&h("moxie/image/Image")),do_cors:i(window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest),drag_and_drop:i(function(){var e=document.createElement("div");return("draggable"in e||"ondragstart"in e&&"ondrop"in e)&&("IE"!==s.browser||s.verComp(s.version,9,">"))}()),filter_by_extension:i(function(){return!("Chrome"===s.browser&&s.verComp(s.version,28,"<")||"IE"===s.browser&&s.verComp(s.version,10,"<")||"Safari"===s.browser&&s.verComp(s.version,7,"<")||"Firefox"===s.browser&&s.verComp(s.version,37,"<"))}()),return_response_headers:n,return_response_type:function e(t){return"json"===t&&window.JSON?!0:s.can("return_response_type",t)},return_status_code:n,report_upload_progress:i(window.XMLHttpRequest&&(new XMLHttpRequest).upload),resize_image:function e(){return t.can("access_binary")&&s.can("create_canvas")},select_file:function e(){return s.can("use_fileinput")&&window.File},select_folder:function e(){return t.can("select_file")&&("Chrome"===s.browser&&s.verComp(s.version,21,">=")||"Firefox"===s.browser&&s.verComp(s.version,42,">="))},select_multiple:function e(){return!(!t.can("select_file")||"Safari"===s.browser&&"Windows"===s.os||"iOS"===s.os&&s.verComp(s.osVersion,"7.0.0",">")&&s.verComp(s.osVersion,"8.0.0","<"))},send_binary_string:i(window.XMLHttpRequest&&((new XMLHttpRequest).sendAsBinary||window.Uint8Array&&window.ArrayBuffer)),send_custom_headers:i(window.XMLHttpRequest),send_multipart:function e(){return!!(window.XMLHttpRequest&&(new XMLHttpRequest).upload&&window.FormData)||t.can("send_binary_string")},slice_blob:i(window.File&&(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice)),stream_upload:function e(){return t.can("slice_blob")&&t.can("send_multipart")},summon_file_dialog:function e(){return t.can("select_file")&&!("Firefox"===s.browser&&s.verComp(s.version,4,"<")||"Opera"===s.browser&&s.verComp(s.version,12,"<")||"IE"===s.browser&&s.verComp(s.version,10,"<"))},upload_filesize:n,use_http_method:n},arguments[2]);a.call(this,e,arguments[1]||u,r),o.extend(this,{init:function e(){this.trigger("Init")},destroy:function(e){return function(){e.call(t),e=t=null}}(this.destroy)}),o.extend(this.getShim(),c)}var u="html5",c={};return a.addConstructor(u,t),c}),e("moxie/runtime/html5/file/Blob",["moxie/runtime/html5/Runtime","moxie/file/Blob"],function(e,t){function i(){function e(t,i,n){var e;if(!window.File.prototype.slice)return(e=window.File.prototype.webkitSlice||window.File.prototype.mozSlice)?e.call(t,i,n):null;try{return t.slice(),t.slice(i,n)}catch(e){return t.slice(i,n-i)}}this.slice=function(){return new t(this.getRuntime().uid,e.apply(this,arguments))},this.destroy=function(){this.getRuntime().getShim().removeInstance(this.uid)}}return e.Blob=i}),e("moxie/core/utils/Events",["moxie/core/utils/Basic"],function(s){function u(){this.returnValue=!1}function c(){this.cancelBubble=!0}var l={},d="moxie_"+s.guid(),e=function e(t,i,n,r){var o,a;i=i.toLowerCase(),t.addEventListener?(o=n,t.addEventListener(i,o,!1)):t.attachEvent&&(o=function e(){var t=window.event;t.target||(t.target=t.srcElement),t.preventDefault=u,t.stopPropagation=c,n(t)},t.attachEvent("on"+i,o)),t[d]||(t[d]=s.guid()),l.hasOwnProperty(t[d])||(l[t[d]]={}),a=l[t[d]],a.hasOwnProperty(i)||(a[i]=[]),a[i].push({func:o,orig:n,key:r})},r=function e(t,i,n){var e,r;if(i=i.toLowerCase(),t[d]&&l[t[d]]&&l[t[d]][i]){e=l[t[d]][i];for(var o=e.length-1;o>=0&&(e[o].orig!==n&&e[o].key!==n||(t.removeEventListener?t.removeEventListener(i,e[o].func,!1):t.detachEvent&&t.detachEvent("on"+i,e[o].func),e[o].orig=null,e[o].func=null,e.splice(o,1),n===r));o--){}if(e.length||delete l[t[d]][i],s.isEmptyObj(l[t[d]])){delete l[t[d]];try{delete t[d]}catch(e){t[d]=r}}}},t=function e(i,n){i&&i[d]&&s.each(l[i[d]],function(e,t){r(i,t,n)})};return{addEvent:e,removeEvent:r,removeAllEvents:t}}),e("moxie/runtime/html5/file/FileInput",["moxie/runtime/html5/Runtime","moxie/file/File","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime","moxie/core/utils/Env"],function(e,f,h,m,p,g,v){function t(){var l,d;h.extend(this,{init:function e(t){var i,n,r,o,a,s,u=this,c=u.getRuntime();l=t,r=g.extList2mimes(l.accept,c.can("filter_by_extension")),n=c.getShimContainer(),n.innerHTML='<input id="'+c.uid+'" type="file" style="font-size:999px;opacity:0;"'+(l.multiple&&c.can("select_multiple")?"multiple":"")+(l.directory&&c.can("select_folder")?"webkitdirectory directory":"")+(r?' accept="'+r.join(",")+'"':"")+" />",i=m.get(c.uid),h.extend(i.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"}),o=m.get(l.browse_button),d=m.getStyle(o,"z-index")||"auto",c.can("summon_file_dialog")&&("static"===m.getStyle(o,"position")&&(o.style.position="relative"),p.addEvent(o,"click",function(e){var t=m.get(c.uid);t&&!t.disabled&&t.click(),e.preventDefault()},u.uid),u.bind("Refresh",function(){a=parseInt(d,10)||1,m.get(l.browse_button).style.zIndex=a,this.getRuntime().getShimContainer().style.zIndex=a-1})),s=c.can("summon_file_dialog")?o:n,p.addEvent(s,"mouseover",function(){u.trigger("mouseenter")},u.uid),p.addEvent(s,"mouseout",function(){u.trigger("mouseleave")},u.uid),p.addEvent(s,"mousedown",function(){u.trigger("mousedown")},u.uid),p.addEvent(m.get(l.container),"mouseup",function(){u.trigger("mouseup")},u.uid),(c.can("summon_file_dialog")?i:o).setAttribute("tabindex",-1),i.onchange=function e(){if(u.files=[],h.each(this.files,function(e){var t="";return l.directory&&"."==e.name?!0:(e.webkitRelativePath&&(t="/"+e.webkitRelativePath.replace(/^\//,"")),e=new f(c.uid,e),e.relativePath=t,u.files.push(e),void 0)}),"IE"!==v.browser&&"IEMobile"!==v.browser)this.value="";else{var t=this.cloneNode(!0);this.parentNode.replaceChild(t,this),t.onchange=e}u.files.length&&u.trigger("change")},u.trigger({type:"ready",async:!0}),n=null},setOption:function e(t,i){var n=this.getRuntime(),r=m.get(n.uid);switch(t){case"accept":if(i){var o=i.mimes||g.extList2mimes(i,n.can("filter_by_extension"));r.setAttribute("accept",o.join(","))}else r.removeAttribute("accept");break;case"directory":i&&n.can("select_folder")?(r.setAttribute("directory",""),r.setAttribute("webkitdirectory","")):(r.removeAttribute("directory"),r.removeAttribute("webkitdirectory"));break;case"multiple":i&&n.can("select_multiple")?r.setAttribute("multiple",""):r.removeAttribute("multiple")}},disable:function e(t){var i,n=this.getRuntime();(i=m.get(n.uid))&&(i.disabled=!!t)},destroy:function e(){var t=this.getRuntime(),i=t.getShim(),n=t.getShimContainer(),r=l&&m.get(l.container),o=l&&m.get(l.browse_button);r&&p.removeAllEvents(r,this.uid),o&&(p.removeAllEvents(o,this.uid),o.style.zIndex=d),n&&(p.removeAllEvents(n,this.uid),n.innerHTML=""),i.removeInstance(this.uid),l=n=r=o=i=null}})}return e.FileInput=t}),e("moxie/runtime/html5/file/FileDrop",["moxie/runtime/html5/Runtime","moxie/file/File","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime"],function(e,m,p,t,g,i){function n(){function r(e){if(!e.dataTransfer||!e.dataTransfer.types)return!1;var t=p.toArray(e.dataTransfer.types||[]);return-1!==p.inArray("Files",t)||-1!==p.inArray("public.file-url",t)||-1!==p.inArray("application/x-moz-file",t)}function o(e,t){if(n(e)){var i=new m(d,e);i.relativePath=t||"",f.push(i)}}function a(e){for(var t=[],i=0;i<e.length;i++){[].push.apply(t,e[i].extensions.split(/\s*,\s*/))}return-1===p.inArray("*",t)?t:[]}function n(e){if(!h.length)return!0;var t=i.getFileExtension(e.name);return!t||-1!==p.inArray(t,h)}function s(e,t){var i=[];p.each(e,function(e){var t=e.webkitGetAsEntry();t&&(t.isFile?o(e.getAsFile(),t.fullPath):i.push(t))}),i.length?u(i,t):t()}function u(e,t){var i=[];p.each(e,function(t){i.push(function(e){c(t,e)})}),p.inSeries(i,function(){t()})}function c(t,i){t.isFile?t.file(function(e){o(e,t.fullPath),i()},function(){i()}):t.isDirectory?e(t,i):i()}function e(e,t){function i(t){r.readEntries(function(e){e.length?([].push.apply(n,e),i(t)):t()},t)}var n=[],r=e.createReader();i(function(){u(n,t)})}var l,d,f=[],h=[];p.extend(this,{init:function e(t){var i,n=this;l=t,d=n.ruid,h=a(l.accept),i=l.container,g.addEvent(i,"dragover",function(e){r(e)&&(e.preventDefault(),e.dataTransfer.dropEffect="copy")},n.uid),g.addEvent(i,"drop",function(e){r(e)&&(e.preventDefault(),f=[],e.dataTransfer.items&&e.dataTransfer.items[0].webkitGetAsEntry?s(e.dataTransfer.items,function(){n.files=f,n.trigger("drop")}):(p.each(e.dataTransfer.files,function(e){o(e)}),n.files=f,n.trigger("drop")))},n.uid),g.addEvent(i,"dragenter",function(){n.trigger("dragenter")},n.uid),g.addEvent(i,"dragleave",function(){n.trigger("dragleave")},n.uid)},destroy:function e(){g.removeAllEvents(l&&t.get(l.container),this.uid),d=f=h=l=null,this.getRuntime().getShim().removeInstance(this.uid)}})}return e.FileDrop=n}),e("moxie/runtime/html5/file/FileReader",["moxie/runtime/html5/Runtime","moxie/core/utils/Encode","moxie/core/utils/Basic"],function(e,t,s){function i(){function r(e){return t.atob(e.substring(e.indexOf("base64,")+7))}var o,a=!1;s.extend(this,{read:function e(t,i){var n=this;n.result="",o=new window.FileReader,o.addEventListener("progress",function(e){n.trigger(e)}),o.addEventListener("load",function(e){n.result=a?r(o.result):o.result,n.trigger(e)}),o.addEventListener("error",function(e){n.trigger(e,o.error)}),o.addEventListener("loadend",function(e){o=null,n.trigger(e)}),"function"===s.typeOf(o[t])?(a=!1,o[t](i.getSource())):"readAsBinaryString"===t&&(a=!0,o.readAsDataURL(i.getSource()))},abort:function e(){o&&o.abort()},destroy:function e(){o=null,this.getRuntime().getShim().removeInstance(this.uid)}})}return e.FileReader=i}),e("moxie/runtime/html5/xhr/XMLHttpRequest",["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/utils/Mime","moxie/core/utils/Url","moxie/file/File","moxie/file/Blob","moxie/xhr/FormData","moxie/core/Exceptions","moxie/core/utils/Env"],function(e,h,s,m,p,g,v,x,y){function t(){function u(e,t){var i,n,r=this;i=t.getBlob().getSource(),n=new window.FileReader,n.onload=function(){t.append(t.getBlobName(),new g(null,{type:i.type,data:n.result})),o.send.call(r,e,t)},n.readAsBinaryString(i)}function c(){return!window.XMLHttpRequest||"IE"===y.browser&&y.verComp(y.version,8,"<")?function(){for(var e=["Msxml2.XMLHTTP.6.0","Microsoft.XMLHTTP"],t=0;t<e.length;t++){try{return new ActiveXObject(e[t])}catch(e){}}}():new window.XMLHttpRequest}function a(e){var t=e.responseXML,i=e.responseText;return"IE"===y.browser&&i&&t&&!t.documentElement&&/[^\/]+\/[^\+]+\+xml/.test(e.getResponseHeader("Content-Type"))&&(t=new window.ActiveXObject("Microsoft.XMLDOM"),t.async=!1,t.validateOnParse=!1,t.loadXML(i)),t&&("IE"===y.browser&&0!==t.parseError||!t.documentElement||"parsererror"===t.documentElement.tagName)?null:t}function l(e){var i="----moxieboundary"+(new Date).getTime(),n="--",r="\r\n",o="",t=this.getRuntime();if(!t.can("send_binary_string"))throw new x.RuntimeError(x.RuntimeError.NOT_SUPPORTED_ERR);return d.setRequestHeader("Content-Type","multipart/form-data; boundary="+i),e.each(function(e,t){o+=e instanceof g?n+i+r+'Content-Disposition: form-data; name="'+t+'"; filename="'+unescape(encodeURIComponent(e.name||"blob"))+'"'+r+"Content-Type: "+(e.type||"application/octet-stream")+r+r+e.getSource()+r:n+i+r+'Content-Disposition: form-data; name="'+t+'"'+r+r+unescape(encodeURIComponent(e))+r}),o+=n+i+n+r}var d,f,o=this;h.extend(this,{send:function e(n,i){var r=this,t="Mozilla"===y.browser&&y.verComp(y.version,4,">=")&&y.verComp(y.version,7,"<"),o="Android Browser"===y.browser,a=!1;if(f=n.url.replace(/^.+?\/([\w\-\.]+)$/,"$1").toLowerCase(),d=c(),d.open(n.method,n.url,n.async,n.user,n.password),i instanceof g)i.isDetached()&&(a=!0),i=i.getSource();else if(i instanceof v){if(i.hasBlob())if(i.getBlob().isDetached())i=l.call(r,i),a=!0;else if((t||o)&&"blob"===h.typeOf(i.getBlob().getSource())&&window.FileReader)return u.call(r,n,i),void 0;if(i instanceof v){var s=new window.FormData;i.each(function(e,t){e instanceof g?s.append(t,e.getSource()):s.append(t,e)}),i=s}}d.upload?(n.withCredentials&&(d.withCredentials=!0),d.addEventListener("load",function(e){r.trigger(e)}),d.addEventListener("error",function(e){r.trigger(e)}),d.addEventListener("progress",function(e){r.trigger(e)}),d.upload.addEventListener("progress",function(e){r.trigger({type:"UploadProgress",loaded:e.loaded,total:e.total})})):d.onreadystatechange=function(){switch(d.readyState){case 1:break;case 2:break;case 3:var t,i;try{m.hasSameOrigin(n.url)&&(t=d.getResponseHeader("Content-Length")||0),d.responseText&&(i=d.responseText.length)}catch(e){t=i=0}r.trigger({type:"progress",lengthComputable:!!t,total:parseInt(t,10),loaded:i});break;case 4:d.onreadystatechange=function(){};try{if(d.status>=200&&d.status<400){r.trigger("load");break}}catch(e){}r.trigger("error")}},h.isEmptyObj(n.headers)||h.each(n.headers,function(e,t){d.setRequestHeader(t,e)}),""!==n.responseType&&"responseType"in d&&(d.responseType="json"!==n.responseType||y.can("return_response_type","json")?n.responseType:"text"),a?d.sendAsBinary?d.sendAsBinary(i):function(){for(var e=new Uint8Array(i.length),t=0;t<i.length;t++){e[t]=255&i.charCodeAt(t)}d.send(e.buffer)}():d.send(i),r.trigger("loadstart")},getStatus:function e(){try{if(d)return d.status}catch(e){}return 0},getResponse:function e(t){var i=this.getRuntime();try{switch(t){case"blob":var n=new p(i.uid,d.response),r=d.getResponseHeader("Content-Disposition");if(r){var o=r.match(/filename=([\'\"'])([^\1]+)\1/);o&&(f=o[2])}return n.name=f,n.type||(n.type=s.getFileMime(f)),n;case"json":return y.can("return_response_type","json")?d.response:200===d.status&&window.JSON?JSON.parse(d.responseText):null;case"document":return a(d);default:return""!==d.responseText?d.responseText:null}}catch(e){return null}},getAllResponseHeaders:function e(){try{return d.getAllResponseHeaders()}catch(e){}return""},abort:function e(){d&&d.abort()},destroy:function e(){o=f=null,this.getRuntime().getShim().removeInstance(this.uid)}})}return e.XMLHttpRequest=t}),e("moxie/runtime/html5/utils/BinaryReader",["moxie/core/utils/Basic"],function(e){function t(e){e instanceof ArrayBuffer?i.apply(this,arguments):n.apply(this,arguments)}function i(o){var a=new DataView(o);e.extend(this,{readByteAt:function e(t){return a.getUint8(t)},writeByteAt:function e(t,i){a.setUint8(t,i)},SEGMENT:function e(t,i,n){switch(arguments.length){case 2:return o.slice(t,t+i);case 1:return o.slice(t);case 3:if(null===n&&(n=new ArrayBuffer),n instanceof ArrayBuffer){var r=new Uint8Array(this.length()-i+n.byteLength);t>0&&r.set(new Uint8Array(o.slice(0,t)),0),r.set(new Uint8Array(n),t),r.set(new Uint8Array(o.slice(t+i)),t+n.byteLength),this.clear(),o=r.buffer,a=new DataView(o);break}default:return o}},length:function e(){return o?o.byteLength:0},clear:function e(){a=o=null}})}function n(r){function o(e,t,i){i=3===arguments.length?i:r.length-t-1,r=r.substr(0,t)+e+r.substr(i+t)}e.extend(this,{readByteAt:function e(t){return r.charCodeAt(t)},writeByteAt:function e(t,i){o(String.fromCharCode(i),t,1)},SEGMENT:function e(t,i,n){switch(arguments.length){case 1:return r.substr(t);case 2:return r.substr(t,i);case 3:o(null!==n?n:"",t,i);break;default:return r}},length:function e(){return r?r.length:0},clear:function e(){r=null}})}return e.extend(t.prototype,{littleEndian:!1,read:function e(t,i){var n,r,o;if(t+i>this.length())throw new Error("You are trying to read outside the source boundaries.");for(r=this.littleEndian?0:-8*(i-1),o=0,n=0;i>o;o++){n|=this.readByteAt(t+o)<<Math.abs(r+8*o)}return n},write:function e(t,i,n){var r,o;if(t>this.length())throw new Error("You are trying to write outside the source boundaries.");for(r=this.littleEndian?0:-8*(n-1),o=0;n>o;o++){this.writeByteAt(t+o,255&i>>Math.abs(r+8*o))}},BYTE:function e(t){return this.read(t,1)},SHORT:function e(t){return this.read(t,2)},LONG:function e(t){return this.read(t,4)},SLONG:function e(t){var i=this.read(t,4);return i>2147483647?i-4294967296:i},CHAR:function e(t){return String.fromCharCode(this.read(t,1))},STRING:function e(t,i){return this.asArray("CHAR",t,i).join("")},asArray:function e(t,i,n){for(var r=[],o=0;n>o;o++){r[o]=this[t](i+o)}return r}}),t}),e("moxie/runtime/html5/image/JPEGHeaders",["moxie/runtime/html5/utils/BinaryReader","moxie/core/Exceptions"],function(u,r){return function a(e){var t,o,i,s=[],n=0;if(t=new u(e),65496!==t.SHORT(0))throw t.clear(),new r.ImageError(r.ImageError.WRONG_FORMAT);for(o=2;o<=t.length();){if(i=t.SHORT(o),i>=65488&&65495>=i)o+=2;else{if(65498===i||65497===i)break;n=t.SHORT(o+2)+2,i>=65505&&65519>=i&&s.push({hex:i,name:"APP"+(15&i),start:o,length:n,segment:t.SEGMENT(o,n)}),o+=n}}return t.clear(),{headers:s,restore:function e(t){var i,n,r;for(r=new u(t),o=65504==r.SHORT(2)?4+r.SHORT(4):2,n=0,i=s.length;i>n;n++){r.SEGMENT(o,0,s[n].segment),o+=s[n].length}return t=r.SEGMENT(),r.clear(),t},strip:function e(t){var i,n,r,o;for(r=new a(t),n=r.headers,r.purge(),i=new u(t),o=n.length;o--;){i.SEGMENT(n[o].start,n[o].length,"")}return t=i.SEGMENT(),i.clear(),t},get:function e(t){for(var i=[],n=0,r=s.length;r>n;n++){s[n].name===t.toUpperCase()&&i.push(s[n].segment)}return i},set:function e(t,i){var n,r,o,a=[];for("string"==typeof i?a.push(i):a=i,n=r=0,o=s.length;o>n&&(s[n].name===t.toUpperCase()&&(s[n].segment=a[r],s[n].length=a[r].length,r++),!(r>=a.length));n++){}},purge:function e(){this.headers=s=[]}}}}),e("moxie/runtime/html5/image/ExifParser",["moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader","moxie/core/Exceptions"],function(v,s,x){function u(t){function r(e,t){var i,n,r,o,a,s,u,c,l=this,d=[],f={},h={1:"BYTE",7:"UNDEFINED",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",9:"SLONG",10:"SRATIONAL"},m={BYTE:1,UNDEFINED:1,ASCII:1,SHORT:2,LONG:4,RATIONAL:8,SLONG:4,SRATIONAL:8};for(i=l.SHORT(e),n=0;i>n;n++){if(d=[],u=e+2+12*n,r=t[l.SHORT(u)],r!==y){if(o=h[l.SHORT(u+=2)],a=l.LONG(u+=2),s=m[o],!s)throw new x.ImageError(x.ImageError.INVALID_META_ERR);if(u+=4,s*a>4&&(u=l.LONG(u)+g.tiffHeader),u+s*a>=this.length())throw new x.ImageError(x.ImageError.INVALID_META_ERR);"ASCII"!==o?(d=l.asArray(o,u,a),c=1==a?d[0]:d,f[r]=p.hasOwnProperty(r)&&"object"!=_typeof(c)?p[r][c]:c):f[r]=v.trim(l.STRING(u,a).replace(/\0$/,""))}}return f}function n(e,t,i){var n,r,o,a=0;if("string"==typeof t){var s=l[e.toLowerCase()];for(var u in s){if(s[u]===t){t=u;break}}}n=g[e.toLowerCase()+"IFD"],r=this.SHORT(n);for(var c=0;r>c;c++){if(o=n+12*c+2,this.SHORT(o)==t){a=o+8;break}}if(!a)return!1;try{this.write(a,i,4)}catch(e){return!1}return!0}var i,l,p,g,e,o;if(s.call(this,t),l={tiff:{274:"Orientation",270:"ImageDescription",271:"Make",272:"Model",305:"Software",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"},thumb:{513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength"}},p={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}},g={tiffHeader:10},e=g.tiffHeader,i={clear:this.clear},v.extend(this,{read:function e(){try{return u.prototype.read.apply(this,arguments)}catch(e){throw new x.ImageError(x.ImageError.INVALID_META_ERR)}},write:function e(){try{return u.prototype.write.apply(this,arguments)}catch(e){throw new x.ImageError(x.ImageError.INVALID_META_ERR)}},UNDEFINED:function e(){return this.BYTE.apply(this,arguments)},RATIONAL:function e(t){return this.LONG(t)/this.LONG(t+4)},SRATIONAL:function e(t){return this.SLONG(t)/this.SLONG(t+4)},ASCII:function e(t){return this.CHAR(t)},TIFF:function e(){return o||null},EXIF:function e(){var t=null;if(g.exifIFD){try{t=r.call(this,g.exifIFD,l.exif)}catch(e){return null}if(t.ExifVersion&&"array"===v.typeOf(t.ExifVersion)){for(var i=0,n="";i<t.ExifVersion.length;i++){n+=String.fromCharCode(t.ExifVersion[i])}t.ExifVersion=n}}return t},GPS:function e(){var t=null;if(g.gpsIFD){try{t=r.call(this,g.gpsIFD,l.gps)}catch(e){return null}t.GPSVersionID&&"array"===v.typeOf(t.GPSVersionID)&&(t.GPSVersionID=t.GPSVersionID.join("."))}return t},thumb:function e(){if(g.IFD1)try{var t=r.call(this,g.IFD1,l.thumb);if("JPEGInterchangeFormat"in t)return this.SEGMENT(g.tiffHeader+t.JPEGInterchangeFormat,t.JPEGInterchangeFormatLength)}catch(e){}return null},setExif:function e(t,i){return"PixelXDimension"!==t&&"PixelYDimension"!==t?!1:n.call(this,"exif",t,i)},clear:function e(){i.clear(),t=l=p=o=g=i=null}}),65505!==this.SHORT(0)||"EXIF\0"!==this.STRING(4,5).toUpperCase())throw new x.ImageError(x.ImageError.INVALID_META_ERR);if(this.littleEndian=18761==this.SHORT(e),42!==this.SHORT(e+=2))throw new x.ImageError(x.ImageError.INVALID_META_ERR);g.IFD0=g.tiffHeader+this.LONG(e+=2),o=r.call(this,g.IFD0,l.tiff),"ExifIFDPointer"in o&&(g.exifIFD=g.tiffHeader+o.ExifIFDPointer,delete o.ExifIFDPointer),"GPSInfoIFDPointer"in o&&(g.gpsIFD=g.tiffHeader+o.GPSInfoIFDPointer,delete o.GPSInfoIFDPointer),v.isEmptyObj(o)&&(o=null);var a=this.LONG(g.IFD0+12*this.SHORT(g.IFD0)+2);a&&(g.IFD1=g.tiffHeader+a)}return u.prototype=s.prototype,u}),e("moxie/runtime/html5/image/JPEG",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEGHeaders","moxie/runtime/html5/utils/BinaryReader","moxie/runtime/html5/image/ExifParser"],function(u,c,l,d,f){function e(t){function n(e){var t,i,n=0;for(e||(e=r);n<=e.length();){if(t=e.SHORT(n+=2),t>=65472&&65475>=t)return n+=5,{height:e.SHORT(n),width:e.SHORT(n+=2)};i=e.SHORT(n+=2),n+=i-2}return null}function e(){var e,t,i=a.thumb();return i&&(e=new d(i),t=n(e),e.clear(),t)?(t.data=i,t):null}function i(){a&&o&&r&&(a.clear(),o.purge(),r.clear(),s=o=a=r=null)}var r,o,a,s;if(r=new d(t),65496!==r.SHORT(0))throw new c.ImageError(c.ImageError.WRONG_FORMAT);o=new l(t);try{a=new f(o.get("app1")[0])}catch(e){}s=n.call(this),u.extend(this,{type:"image/jpeg",size:r.length(),width:s&&s.width||0,height:s&&s.height||0,setExif:function e(t,i){return a?("object"===u.typeOf(t)?u.each(t,function(e,t){a.setExif(t,e)}):a.setExif(t,i),o.set("app1",a.SEGMENT()),void 0):!1},writeHeaders:function e(){return arguments.length?o.restore(arguments[0]):o.restore(t)},stripHeaders:function e(t){return o.strip(t)},purge:function e(){i.call(this)}}),a&&(this.meta={tiff:a.TIFF(),exif:a.EXIF(),gps:a.GPS(),thumb:e()})}return e}),e("moxie/runtime/html5/image/PNG",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader"],function(u,c,l){function e(e){function t(){var e,t;return e=n.call(this,8),"IHDR"==e.type?(t=e.start,{width:o.LONG(t),height:o.LONG(t+=4)}):null}function i(){o&&(o.clear(),e=s=r=a=o=null)}function n(e){var t,i,n,r;return t=o.LONG(e),i=o.STRING(e+=4,4),n=e+=4,r=o.LONG(e+t),{length:t,type:i,start:n,CRC:r}}var o,r,a,s;o=new l(e),function(){var e=0,t=0,i=[35152,20039,3338,6666];for(t=0;t<i.length;t++,e+=2){if(i[t]!=o.SHORT(e))throw new u.ImageError(u.ImageError.WRONG_FORMAT)}}(),s=t.call(this),c.extend(this,{type:"image/png",size:o.length(),width:s.width,height:s.height,purge:function e(){i.call(this)}}),i.call(this)}return e}),e("moxie/runtime/html5/image/ImageInfo",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEG","moxie/runtime/html5/image/PNG"],function(n,r,o,a){return function(t){var e,i=[o,a];e=function(){for(var e=0;e<i.length;e++){try{return new i[e](t)}catch(e){}}throw new r.ImageError(r.ImageError.WRONG_FORMAT)}(),n.extend(this,{type:"",size:0,width:0,height:0,setExif:function e(){},writeHeaders:function e(t){return t},stripHeaders:function e(t){return t},purge:function e(){t=null}}),n.extend(this,e),this.purge=function(){e.purge(),e=null}}}),e("moxie/runtime/html5/image/ResizerCanvas",[],function(){function s(e,t,i){var n=e.width>e.height?"width":"height",r=Math.round(e[n]*t),o=!1;"nearest"!==i&&(.5>t||t>2)&&(t=.5>t?.5:2,o=!0);var a=u(e,t);return o?s(a,r/a[n],i):a}function u(e,t){var i=e.width,n=e.height,r=Math.round(i*t),o=Math.round(n*t),a=document.createElement("canvas");return a.width=r,a.height=o,a.getContext("2d").drawImage(e,0,0,i,n,0,0,r,o),e=null,a}return{scale:s}}),e("moxie/runtime/html5/image/Image",["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/Exceptions","moxie/core/utils/Encode","moxie/file/Blob","moxie/file/File","moxie/runtime/html5/image/ImageInfo","moxie/runtime/html5/image/ResizerCanvas","moxie/core/utils/Mime","moxie/core/utils/Env"],function(e,x,y,w,_,b,E,R,A){function t(){function a(){if(!f&&!l)throw new y.ImageError(y.DOMException.INVALID_STATE_ERR);return f||l}function r(){var e=a();return"canvas"==e.nodeName.toLowerCase()?e:(f=document.createElement("canvas"),f.width=e.width,f.height=e.height,f.getContext("2d").drawImage(e,0,0),f)}function o(e){return w.atob(e.substring(e.indexOf("base64,")+7))}function i(e,t){return"data:"+(t||"")+";base64,"+w.btoa(e)}function s(e){var t=this;l=new Image,l.onerror=function(){n.call(this),t.trigger("error",y.ImageError.WRONG_FORMAT)},l.onload=function(){t.trigger("load")},l.src="data:"==e.substr(0,5)?e:i(e,m.type)}function u(e,t){var i,n=this;return window.FileReader?(i=new FileReader,i.onload=function(){t.call(n,this.result)},i.onerror=function(){n.trigger("error",y.ImageError.WRONG_FORMAT)},i.readAsDataURL(e),void 0):t.call(this,e.getAsDataURL())}function c(e,t){var i=Math.PI/180,n=document.createElement("canvas"),r=n.getContext("2d"),o=e.width,a=e.height;switch(x.inArray(t,[5,6,7,8])>-1?(n.width=a,n.height=o):(n.width=o,n.height=a),t){case 2:r.translate(o,0),r.scale(-1,1);break;case 3:r.translate(o,a),r.rotate(180*i);break;case 4:r.translate(0,a),r.scale(1,-1);break;case 5:r.rotate(90*i),r.scale(1,-1);break;case 6:r.rotate(90*i),r.translate(0,-a);break;case 7:r.rotate(90*i),r.translate(o,-a),r.scale(-1,1);break;case 8:r.rotate(-90*i),r.translate(-o,0)}return r.drawImage(e,0,0,o,a),n}function n(){d&&(d.purge(),d=null),h=l=f=m=null,g=!1}var l,d,f,h,m,p=this,g=!1,v=!0;x.extend(this,{loadFromBlob:function e(t){var i=this.getRuntime(),n=arguments.length>1?arguments[1]:!0;if(!i.can("access_binary"))throw new y.RuntimeError(y.RuntimeError.NOT_SUPPORTED_ERR);return m=t,t.isDetached()?(h=t.getSource(),s.call(this,h),void 0):(u.call(this,t.getSource(),function(e){n&&(h=o(e)),s.call(this,e)}),void 0)},loadFromImage:function e(t,i){this.meta=t.meta,m=new b(null,{name:t.name,size:t.size,type:t.type}),s.call(this,i?h=t.getAsBinaryString():t.getAsDataURL())},getInfo:function e(){var t,i=this.getRuntime();return!d&&h&&i.can("access_image_binary")&&(d=new E(h)),t={width:a().width||0,height:a().height||0,type:m.type||A.getFileMime(m.name),size:h&&h.length||m.size||0,name:m.name||"",meta:null},v&&(t.meta=d&&d.meta||this.meta||{},!t.meta||!t.meta.thumb||t.meta.thumb.data instanceof _||(t.meta.thumb.data=new _(null,{type:"image/jpeg",data:t.meta.thumb.data}))),t},resize:function e(t,i,n){var r=document.createElement("canvas");if(r.width=t.width,r.height=t.height,r.getContext("2d").drawImage(a(),t.x,t.y,t.width,t.height,0,0,r.width,r.height),f=R.scale(r,i),v=n.preserveHeaders,!v){var o=this.meta&&this.meta.tiff&&this.meta.tiff.Orientation||1;f=c(f,o)}this.width=f.width,this.height=f.height,g=!0,this.trigger("Resize")},getAsCanvas:function e(){return f||(f=r()),f.id=this.uid+"_canvas",f},getAsBlob:function e(t,i){return t!==this.type?(g=!0,new b(null,{name:m.name||"",type:t,data:p.getAsDataURL(t,i)})):new b(null,{name:m.name||"",type:t,data:p.getAsBinaryString(t,i)})},getAsDataURL:function e(t){var i=arguments[1]||90;if(!g)return l.src;if(r(),"image/jpeg"!==t)return f.toDataURL("image/png");try{return f.toDataURL("image/jpeg",i/100)}catch(e){return f.toDataURL("image/jpeg")}},getAsBinaryString:function e(t,i){if(!g)return h||(h=o(p.getAsDataURL(t,i))),h;if("image/jpeg"!==t)h=o(p.getAsDataURL(t,i));else{var n;i||(i=90),r();try{n=f.toDataURL("image/jpeg",i/100)}catch(e){n=f.toDataURL("image/jpeg")}h=o(n),d&&(h=d.stripHeaders(h),v&&(d.meta&&d.meta.exif&&d.setExif({PixelXDimension:this.width,PixelYDimension:this.height}),h=d.writeHeaders(h)),d.purge(),d=null)}return g=!1,h},destroy:function e(){p=null,n.call(this),this.getRuntime().getShim().removeInstance(this.uid)}})}return e.Image=t}),e("moxie/runtime/flash/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(s,u,n,c,l){function e(){var t;try{t=navigator.plugins["Shockwave Flash"],t=t.description}catch(e){try{t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(e){t="0.0"}}return t=t.match(/\d+/g),parseFloat(t[0]+"."+t[1])}function t(t){var i=n.get(t);i&&"OBJECT"==i.nodeName&&("IE"===u.browser?(i.style.display="none",function e(){4==i.readyState?r(t):setTimeout(e,10)}()):i.parentNode.removeChild(i))}function r(e){var t=n.get(e);if(t){for(var i in t){"function"==typeof t[i]&&(t[i]=null)}t.parentNode.removeChild(t)}}function i(r){var o,a=this;r=s.extend({swf_url:u.swf_url},r),l.call(this,r,d,{access_binary:function e(t){return t&&"browser"===a.mode},access_image_binary:function e(t){return t&&"browser"===a.mode},display_media:l.capTest(h("moxie/image/Image")),do_cors:l.capTrue,drag_and_drop:!1,report_upload_progress:function e(){return"client"===a.mode},resize_image:l.capTrue,return_response_headers:!1,return_response_type:function e(t){return"json"===t&&window.JSON?!0:!s.arrayDiff(t,["","text","document"])||"browser"===a.mode},return_status_code:function e(t){return"browser"===a.mode||!s.arrayDiff(t,[200,404])},select_file:l.capTrue,select_multiple:l.capTrue,send_binary_string:function e(t){return t&&"browser"===a.mode},send_browser_cookies:function e(t){return t&&"browser"===a.mode},send_custom_headers:function e(t){return t&&"browser"===a.mode},send_multipart:l.capTrue,slice_blob:function e(t){return t&&"browser"===a.mode},stream_upload:function e(t){return t&&"browser"===a.mode},summon_file_dialog:!1,upload_filesize:function e(t){return s.parseSizeStr(t)<=2097152||"client"===a.mode},use_http_method:function e(t){return!s.arrayDiff(t,["GET","POST"])}},{access_binary:function e(t){return t?"browser":"client"},access_image_binary:function e(t){return t?"browser":"client"},report_upload_progress:function e(t){return t?"browser":"client"},return_response_type:function e(t){return s.arrayDiff(t,["","text","json","document"])?"browser":["client","browser"]},return_status_code:function e(t){return s.arrayDiff(t,[200,404])?"browser":["client","browser"]},send_binary_string:function e(t){return t?"browser":"client"},send_browser_cookies:function e(t){return t?"browser":"client"},send_custom_headers:function e(t){return t?"browser":"client"},slice_blob:function e(t){return t?"browser":"client"},stream_upload:function e(t){return t?"client":"browser"},upload_filesize:function e(t){return s.parseSizeStr(t)>=2097152?"client":"browser"}},"client"),e()<11.3&&(this.mode=!1),s.extend(this,{getShim:function e(){return n.get(this.uid)},shimExec:function e(t,i){var n=[].slice.call(arguments,2);return a.getShim().exec(this.uid,t,i,n)},init:function e(){var t,i,n;n=this.getShimContainer(),s.extend(n.style,{position:"absolute",top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"}),t='<object id="'+this.uid+'" type="application/x-shockwave-flash" data="'+r.swf_url+'" ',"IE"===u.browser&&(t+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '),t+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+r.swf_url+'" />'+'<param name="flashvars" value="uid='+escape(this.uid)+"&target="+l.getGlobalEventTarget()+'" />'+'<param name="wmode" value="transparent" />'+'<param name="allowscriptaccess" value="always" />'+"</object>","IE"===u.browser?(i=document.createElement("div"),n.appendChild(i),i.outerHTML=t,i=n=null):n.innerHTML=t,o=setTimeout(function(){a&&!a.initialized&&a.trigger("Error",new c.RuntimeError(c.RuntimeError.NOT_INIT_ERR))},5e3)},destroy:function(e){return function(){t(a.uid),e.call(a),clearTimeout(o),r=o=e=a=null}}(this.destroy)},f)}var d="flash",f={};return l.addConstructor(d,i),f}),e("moxie/runtime/flash/file/Blob",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(e,a){var t={slice:function e(t,i,n,r){var o=this.getRuntime();return 0>i?i=Math.max(t.size+i,0):i>0&&(i=Math.min(i,t.size)),0>n?n=Math.max(t.size+n,0):n>0&&(n=Math.min(n,t.size)),t=o.shimExec.call(this,"Blob","slice",i,n,r||""),t&&(t=new a(o.uid,t)),t}};return e.Blob=t}),e("moxie/runtime/flash/file/FileInput",["moxie/runtime/flash/Runtime","moxie/file/File","moxie/core/utils/Dom","moxie/core/utils/Basic"],function(e,o,a,s){var t={init:function e(t){var i=this,n=this.getRuntime(),r=a.get(t.browse_button);r&&(r.setAttribute("tabindex",-1),r=null),this.bind("Change",function(){var e=n.shimExec.call(i,"FileInput","getFiles");i.files=[],s.each(e,function(e){i.files.push(new o(n.uid,e))})},999),this.getRuntime().shimExec.call(this,"FileInput","init",{accept:t.accept,multiple:t.multiple}),this.trigger("ready")}};return e.FileInput=t}),e("moxie/runtime/flash/file/FileReader",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(e,i){function r(e,t){switch(t){case"readAsText":return i.atob(e,"utf8");case"readAsBinaryString":return i.atob(e);case"readAsDataURL":return e}return null}var t={read:function e(i,t){var n=this;return n.result="","readAsDataURL"===i&&(n.result="data:"+(t.type||"")+";base64,"),n.bind("Progress",function(e,t){t&&(n.result+=r(t,i))},999),n.getRuntime().shimExec.call(this,"FileReader","readAsBase64",t.uid)}};return e.FileReader=t}),e("moxie/runtime/flash/file/FileReaderSync",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(e,i){function o(e,t){switch(t){case"readAsText":return i.atob(e,"utf8");case"readAsBinaryString":return i.atob(e);case"readAsDataURL":return e}return null}var t={read:function e(t,i){var n,r=this.getRuntime();return(n=r.shimExec.call(this,"FileReaderSync","readAsBase64",i.uid))?("readAsDataURL"===t&&(n="data:"+(i.type||"")+";base64,"+n),o(n,t,i.type)):null}};return e.FileReaderSync=t}),e("moxie/runtime/flash/runtime/Transporter",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(e,r){var t={getAsBlob:function e(t){var i=this.getRuntime(),n=i.shimExec.call(this,"Transporter","getAsBlob",t);return n?new r(i.uid,n):null}};return e.Transporter=t}),e("moxie/runtime/flash/xhr/XMLHttpRequest",["moxie/runtime/flash/Runtime","moxie/core/utils/Basic","moxie/file/Blob","moxie/file/File","moxie/file/FileReaderSync","moxie/runtime/flash/file/FileReaderSync","moxie/xhr/FormData","moxie/runtime/Transporter","moxie/runtime/flash/runtime/Transporter"],function(e,l,d,o,a,t,f,h){var i={send:function e(t,i){function n(){t.transport=s.mode,s.shimExec.call(a,"XMLHttpRequest","send",t,i)}function r(e,t){s.shimExec.call(a,"XMLHttpRequest","appendBlob",e,t.uid),i=null,n()}function o(e,t){var i=new h;i.bind("TransportingComplete",function(){t(this.result)}),i.transport(e.getSource(),e.type,{ruid:s.uid})}var a=this,s=a.getRuntime();if(l.isEmptyObj(t.headers)||l.each(t.headers,function(e,t){s.shimExec.call(a,"XMLHttpRequest","setRequestHeader",t,e.toString())}),i instanceof f){var u;if(i.each(function(e,t){e instanceof d?u=t:s.shimExec.call(a,"XMLHttpRequest","append",t,e)}),i.hasBlob()){var c=i.getBlob();c.isDetached()?o(c,function(e){c.destroy(),r(u,e)}):r(u,c)}else i=null,n()}else i instanceof d?i.isDetached()?o(i,function(e){i.destroy(),i=e.uid,n()}):(i=i.uid,n()):n()},getResponse:function e(t){var i,n,r=this.getRuntime();if(n=r.shimExec.call(this,"XMLHttpRequest","getResponseAsBlob")){if(n=new o(r.uid,n),"blob"===t)return n;try{if(i=new a,~l.inArray(t,["","text"]))return i.readAsText(n);if("json"===t&&window.JSON)return JSON.parse(i.readAsText(n))}finally{n.destroy()}}return null},abort:function e(){var t=this.getRuntime();t.shimExec.call(this,"XMLHttpRequest","abort"),this.dispatchEvent("readystatechange"),this.dispatchEvent("abort")}};return e.XMLHttpRequest=i}),e("moxie/runtime/flash/image/Image",["moxie/runtime/flash/Runtime","moxie/core/utils/Basic","moxie/runtime/Transporter","moxie/file/Blob","moxie/file/FileReaderSync"],function(e,t,a,o,r){var i={loadFromBlob:function e(t){function i(e){r.shimExec.call(n,"Image","loadFromBlob",e.uid),n=r=null}var n=this,r=n.getRuntime();if(t.isDetached()){var o=new a;o.bind("TransportingComplete",function(){i(o.result.getSource())}),o.transport(t.getSource(),t.type,{ruid:r.uid})}else i(t.getSource())},loadFromImage:function e(t){var i=this.getRuntime();return i.shimExec.call(this,"Image","loadFromImage",t.uid)},getInfo:function e(){var t=this.getRuntime(),i=t.shimExec.call(this,"Image","getInfo");return i.meta&&i.meta.thumb&&i.meta.thumb.data&&!(t.meta.thumb.data instanceof o)&&(i.meta.thumb.data=new o(t.uid,i.meta.thumb.data)),i},getAsBlob:function e(t,i){var n=this.getRuntime(),r=n.shimExec.call(this,"Image","getAsBlob",t,i);return r?new o(n.uid,r):null},getAsDataURL:function e(){var t,i=this.getRuntime(),n=i.Image.getAsBlob.apply(this,arguments);return n?(t=new r,t.readAsDataURL(n)):null}};return e.Image=i}),e("moxie/runtime/silverlight/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(o,a,t,s,u){function e(t){var i,n,r,o,a,s=!1,e=null,u=0;try{try{e=new ActiveXObject("AgControl.AgControl"),e.IsVersionSupported(t)&&(s=!0),e=null}catch(e){var c=navigator.plugins["Silverlight Plug-In"];if(c){for(i=c.description,"1.0.30226.2"===i&&(i="2.0.30226.2"),n=i.split(".");n.length>3;){n.pop()}for(;n.length<4;){n.push(0)}for(r=t.split(".");r.length>4;){r.pop()}do{o=parseInt(r[u],10),a=parseInt(n[u],10),u++}while(u<r.length&&o===a);a>=o&&!isNaN(o)&&(s=!0)}}}catch(e){s=!1}return s}function i(i){var n,r=this;i=o.extend({xap_url:a.xap_url},i),u.call(this,i,c,{access_binary:u.capTrue,access_image_binary:u.capTrue,display_media:u.capTest(h("moxie/image/Image")),do_cors:u.capTrue,drag_and_drop:!1,report_upload_progress:u.capTrue,resize_image:u.capTrue,return_response_headers:function e(t){return t&&"client"===r.mode},return_response_type:function e(t){return"json"!==t?!0:!!window.JSON},return_status_code:function e(t){return"client"===r.mode||!o.arrayDiff(t,[200,404])},select_file:u.capTrue,select_multiple:u.capTrue,send_binary_string:u.capTrue,send_browser_cookies:function e(t){return t&&"browser"===r.mode},send_custom_headers:function e(t){return t&&"client"===r.mode},send_multipart:u.capTrue,slice_blob:u.capTrue,stream_upload:!0,summon_file_dialog:!1,upload_filesize:u.capTrue,use_http_method:function e(t){return"client"===r.mode||!o.arrayDiff(t,["GET","POST"])}},{return_response_headers:function e(t){return t?"client":"browser"},return_status_code:function e(t){return o.arrayDiff(t,[200,404])?"client":["client","browser"]},send_browser_cookies:function e(t){return t?"browser":"client"},send_custom_headers:function e(t){return t?"client":"browser"},use_http_method:function e(t){return o.arrayDiff(t,["GET","POST"])?"client":["client","browser"]}}),e("2.0.31005.0")&&"Opera"!==a.browser||(this.mode=!1),o.extend(this,{getShim:function e(){return t.get(this.uid).content.Moxie},shimExec:function e(t,i){var n=[].slice.call(arguments,2);return r.getShim().exec(this.uid,t,i,n)},init:function e(){var t;t=this.getShimContainer(),t.innerHTML='<object id="'+this.uid+'" data="data:application/x-silverlight," type="application/x-silverlight-2" width="100%" height="100%" style="outline:none;">'+'<param name="source" value="'+i.xap_url+'"/>'+'<param name="background" value="Transparent"/>'+'<param name="windowless" value="true"/>'+'<param name="enablehtmlaccess" value="true"/>'+'<param name="initParams" value="uid='+this.uid+",target="+u.getGlobalEventTarget()+'"/>'+"</object>",n=setTimeout(function(){r&&!r.initialized&&r.trigger("Error",new s.RuntimeError(s.RuntimeError.NOT_INIT_ERR))},"Windows"!==a.OS?1e4:5e3)},destroy:function(e){return function(){e.call(r),clearTimeout(n),i=n=e=r=null}}(this.destroy)},l)}var c="silverlight",l={};return u.addConstructor(c,i),l}),e("moxie/runtime/silverlight/file/Blob",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/Blob"],function(e,t,i){return e.Blob=t.extend({},i)}),e("moxie/runtime/silverlight/file/FileInput",["moxie/runtime/silverlight/Runtime","moxie/file/File","moxie/core/utils/Dom","moxie/core/utils/Basic"],function(e,o,a,s){function u(e){for(var t="",i=0;i<e.length;i++){t+=(""!==t?"|":"")+e[i].title+" | *."+e[i].extensions.replace(/,/g,";*.")}return t}var t={init:function e(t){var i=this,n=this.getRuntime(),r=a.get(t.browse_button);r&&(r.setAttribute("tabindex",-1),r=null),this.bind("Change",function(){var e=n.shimExec.call(i,"FileInput","getFiles");i.files=[],s.each(e,function(e){i.files.push(new o(n.uid,e))})},999),n.shimExec.call(this,"FileInput","init",u(t.accept),t.multiple),this.trigger("ready")},setOption:function e(t,i){"accept"==t&&(i=u(i)),this.getRuntime().shimExec.call(this,"FileInput","setOption",t,i)}};return e.FileInput=t}),e("moxie/runtime/silverlight/file/FileDrop",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Dom","moxie/core/utils/Events"],function(e,r,o){var t={init:function e(){var t,i=this,n=i.getRuntime();return t=n.getShimContainer(),o.addEvent(t,"dragover",function(e){e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="copy"},i.uid),o.addEvent(t,"dragenter",function(e){e.preventDefault();var t=r.get(n.uid).dragEnter(e);t&&e.stopPropagation()},i.uid),o.addEvent(t,"drop",function(e){e.preventDefault();var t=r.get(n.uid).dragDrop(e);t&&e.stopPropagation()},i.uid),n.shimExec.call(this,"FileDrop","init")}};return e.FileDrop=t}),e("moxie/runtime/silverlight/file/FileReader",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReader"],function(e,t,i){return e.FileReader=t.extend({},i)}),e("moxie/runtime/silverlight/file/FileReaderSync",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReaderSync"],function(e,t,i){return e.FileReaderSync=t.extend({},i)}),e("moxie/runtime/silverlight/runtime/Transporter",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/runtime/Transporter"],function(e,t,i){return e.Transporter=t.extend({},i)}),e("moxie/runtime/silverlight/xhr/XMLHttpRequest",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/xhr/XMLHttpRequest","moxie/runtime/silverlight/file/FileReaderSync","moxie/runtime/silverlight/runtime/Transporter"],function(e,t,i){return e.XMLHttpRequest=t.extend({},i)}),e("moxie/runtime/silverlight/image/Image",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/file/Blob","moxie/runtime/flash/image/Image"],function(e,n,r,t){return e.Image=n.extend({},t,{getInfo:function e(){var t=this.getRuntime(),i=["tiff","exif","gps","thumb"],a={meta:{}},s=t.shimExec.call(this,"Image","getInfo");return s.meta&&(n.each(i,function(e){var t,i,n,r,o=s.meta[e];if(o&&o.keys)for(a.meta[e]={},i=0,n=o.keys.length;n>i;i++){t=o.keys[i],r=o[t],r&&(/^(\d|[1-9]\d+)$/.test(r)?r=parseInt(r,10):/^\d*\.\d+$/.test(r)&&(r=parseFloat(r)),a.meta[e][t]=r)}}),a.meta&&a.meta.thumb&&a.meta.thumb.data&&!(t.meta.thumb.data instanceof r)&&(a.meta.thumb.data=new r(t.uid,a.meta.thumb.data))),a.width=parseInt(s.width,10),a.height=parseInt(s.height,10),a.size=parseInt(s.size,10),a.type=s.type,a.name=s.name,a},resize:function e(t,i,n){this.getRuntime().shimExec.call(this,"Image","resize",t.x,t.y,t.width,t.height,i,n.preserveHeaders,n.resample)}})}),e("moxie/runtime/html4/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(r,e,o,a){function t(e){var t=this,i=o.capTest,n=o.capTrue;o.call(this,e,s,{access_binary:i(window.FileReader||window.File&&File.getAsDataURL),access_image_binary:!1,display_media:i((a.can("create_canvas")||a.can("use_data_uri_over32kb"))&&h("moxie/image/Image")),do_cors:!1,drag_and_drop:!1,filter_by_extension:i(function(){return!("Chrome"===a.browser&&a.verComp(a.version,28,"<")||"IE"===a.browser&&a.verComp(a.version,10,"<")||"Safari"===a.browser&&a.verComp(a.version,7,"<")||"Firefox"===a.browser&&a.verComp(a.version,37,"<"))}()),resize_image:function e(){return u.Image&&t.can("access_binary")&&a.can("create_canvas")},report_upload_progress:!1,return_response_headers:!1,return_response_type:function e(t){return"json"===t&&window.JSON?!0:!!~r.inArray(t,["text","document",""])},return_status_code:function e(t){return!r.arrayDiff(t,[200,404])},select_file:function e(){return a.can("use_fileinput")},select_multiple:!1,send_binary_string:!1,send_custom_headers:!1,send_multipart:!0,slice_blob:!1,stream_upload:function e(){return t.can("select_file")},summon_file_dialog:function e(){return t.can("select_file")&&!("Firefox"===a.browser&&a.verComp(a.version,4,"<")||"Opera"===a.browser&&a.verComp(a.version,12,"<")||"IE"===a.browser&&a.verComp(a.version,10,"<"))},upload_filesize:n,use_http_method:function e(t){return!r.arrayDiff(t,["GET","POST"])}}),r.extend(this,{init:function e(){this.trigger("Init")},destroy:function(e){return function(){e.call(t),e=t=null}}(this.destroy)}),r.extend(this.getShim(),u)}var s="html4",u={};return o.addConstructor(s,t),u}),e("moxie/runtime/html4/file/FileInput",["moxie/runtime/html4/Runtime","moxie/file/File","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime","moxie/core/utils/Env"],function(e,f,h,m,p,g,v){function t(){function u(){var e,t,i,n,r,o,a=this,s=a.getRuntime();o=h.guid("uid_"),e=s.getShimContainer(),c&&(i=m.get(c+"_form"),i&&(h.extend(i.style,{top:"100%"}),i.firstChild.setAttribute("tabindex",-1))),n=document.createElement("form"),n.setAttribute("id",o+"_form"),n.setAttribute("method","post"),n.setAttribute("enctype","multipart/form-data"),n.setAttribute("encoding","multipart/form-data"),h.extend(n.style,{overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",height:"100%"}),r=document.createElement("input"),r.setAttribute("id",o),r.setAttribute("type","file"),r.setAttribute("accept",d.join(",")),s.can("summon_file_dialog")&&r.setAttribute("tabindex",-1),h.extend(r.style,{fontSize:"999px",opacity:0}),n.appendChild(r),e.appendChild(n),h.extend(r.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"}),"IE"===v.browser&&v.verComp(v.version,10,"<")&&h.extend(r.style,{filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"}),r.onchange=function(){var e;this.value&&(e=this.files?this.files[0]:{name:this.value},e=new f(s.uid,e),this.onchange=function(){},u.call(a),a.files=[e],r.setAttribute("id",e.uid),n.setAttribute("id",e.uid+"_form"),a.trigger("change"),r=n=null)},s.can("summon_file_dialog")&&(t=m.get(l.browse_button),p.removeEvent(t,"click",a.uid),p.addEvent(t,"click",function(e){r&&!r.disabled&&r.click(),e.preventDefault()},a.uid)),c=o,e=i=t=null}var c,l,s,d=[];h.extend(this,{init:function e(n){var r,o=this,a=o.getRuntime();l=n,d=g.extList2mimes(n.accept,a.can("filter_by_extension")),r=a.getShimContainer(),function(){var e,t,i;e=m.get(n.browse_button),s=m.getStyle(e,"z-index")||"auto",a.can("summon_file_dialog")?("static"===m.getStyle(e,"position")&&(e.style.position="relative"),o.bind("Refresh",function(){t=parseInt(s,10)||1,m.get(l.browse_button).style.zIndex=t,this.getRuntime().getShimContainer().style.zIndex=t-1})):e.setAttribute("tabindex",-1),i=a.can("summon_file_dialog")?e:r,p.addEvent(i,"mouseover",function(){o.trigger("mouseenter")},o.uid),p.addEvent(i,"mouseout",function(){o.trigger("mouseleave")},o.uid),p.addEvent(i,"mousedown",function(){o.trigger("mousedown")},o.uid),p.addEvent(m.get(n.container),"mouseup",function(){o.trigger("mouseup")},o.uid),e=null}(),u.call(this),r=null,o.trigger({type:"ready",async:!0})},setOption:function e(t,i){var n,r=this.getRuntime();"accept"==t&&(d=i.mimes||g.extList2mimes(i,r.can("filter_by_extension"))),n=m.get(c),n&&n.setAttribute("accept",d.join(","))},disable:function e(t){var i;(i=m.get(c))&&(i.disabled=!!t)},destroy:function e(){var t=this.getRuntime(),i=t.getShim(),n=t.getShimContainer(),r=l&&m.get(l.container),o=l&&m.get(l.browse_button);r&&p.removeAllEvents(r,this.uid),o&&(p.removeAllEvents(o,this.uid),o.style.zIndex=s),n&&(p.removeAllEvents(n,this.uid),n.innerHTML=""),i.removeInstance(this.uid),c=d=l=n=r=o=i=null}})}return e.FileInput=t}),e("moxie/runtime/html4/file/FileReader",["moxie/runtime/html4/Runtime","moxie/runtime/html5/file/FileReader"],function(e,t){return e.FileReader=t}),e("moxie/runtime/html4/xhr/XMLHttpRequest",["moxie/runtime/html4/Runtime","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Url","moxie/core/Exceptions","moxie/core/utils/Events","moxie/file/Blob","moxie/xhr/FormData"],function(e,m,p,g,v,x,y,w){function t(){function l(t){var e,i,n,r,o=this,a=!1;if(h){if(e=h.id.replace(/_iframe$/,""),i=p.get(e+"_form")){for(n=i.getElementsByTagName("input"),r=n.length;r--;){switch(n[r].getAttribute("type")){case"hidden":n[r].parentNode.removeChild(n[r]);break;case"file":a=!0}}n=[],a||i.parentNode.removeChild(i),i=null}setTimeout(function(){x.removeEvent(h,"load",o.uid),h.parentNode&&h.parentNode.removeChild(h);var e=o.getRuntime().getShimContainer();e.children.length||e.parentNode.removeChild(e),e=h=null,t()},1)}}var d,f,h;m.extend(this,{send:function e(i,t){function n(){var e=c.getShimContainer()||document.body,t=document.createElement("div");t.innerHTML='<iframe id="'+r+'_iframe" name="'+r+'_iframe" src="javascript:&quot;&quot;" style="display:none"></iframe>',h=t.firstChild,e.appendChild(h),x.addEvent(h,"load",function(){var e;try{e=h.contentWindow.document||h.contentDocument||window.frames[h.id].document,/^4(0[0-9]|1[0-7]|2[2346])\s/.test(e.title)?d=e.title.replace(/^(\d+).*$/,"$1"):(d=200,f=m.trim(e.body.innerHTML),u.trigger({type:"progress",loaded:f.length,total:f.length}),s&&u.trigger({type:"uploadprogress",loaded:s.size||1025,total:s.size||1025}))}catch(e){if(!g.hasSameOrigin(i.url))return l.call(u,function(){u.trigger("error")}),void 0;d=404}l.call(u,function(){u.trigger("load")})},u.uid)}var r,o,a,s,u=this,c=u.getRuntime();if(d=f=null,t instanceof w&&t.hasBlob()){if(s=t.getBlob(),r=s.uid,a=p.get(r),o=p.get(r+"_form"),!o)throw new v.DOMException(v.DOMException.NOT_FOUND_ERR)}else r=m.guid("uid_"),o=document.createElement("form"),o.setAttribute("id",r+"_form"),o.setAttribute("method",i.method),o.setAttribute("enctype","multipart/form-data"),o.setAttribute("encoding","multipart/form-data"),c.getShimContainer().appendChild(o);o.setAttribute("target",r+"_iframe"),t instanceof w&&t.each(function(e,t){if(e instanceof y)a&&a.setAttribute("name",t);else{var i=document.createElement("input");m.extend(i,{type:"hidden",name:t,value:e}),a?o.insertBefore(i,a):o.appendChild(i)}}),o.setAttribute("action",i.url),n(),o.submit(),u.trigger("loadstart")},getStatus:function e(){return d},getResponse:function e(t){if("json"===t&&"string"===m.typeOf(f)&&window.JSON)try{return JSON.parse(f.replace(/^\s*<pre[^>]*>/,"").replace(/<\/pre>\s*$/,""))}catch(e){return null}return f},abort:function e(){var t=this;h&&h.contentWindow&&(h.contentWindow.stop?h.contentWindow.stop():h.contentWindow.document.execCommand?h.contentWindow.document.execCommand("Stop"):h.src="about:blank"),l.call(this,function(){t.dispatchEvent("abort")})},destroy:function e(){this.getRuntime().getShim().removeInstance(this.uid)}})}return e.XMLHttpRequest=t}),e("moxie/runtime/html4/image/Image",["moxie/runtime/html4/Runtime","moxie/runtime/html5/image/Image"],function(e,t){return e.Image=t}),t(["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/core/utils/Env","moxie/core/Exceptions","moxie/core/utils/Dom","moxie/core/EventTarget","moxie/runtime/Runtime","moxie/runtime/RuntimeClient","moxie/file/Blob","moxie/core/I18n","moxie/core/utils/Mime","moxie/file/FileInput","moxie/file/File","moxie/file/FileDrop","moxie/file/FileReader","moxie/core/utils/Url","moxie/runtime/RuntimeTarget","moxie/xhr/FormData","moxie/xhr/XMLHttpRequest","moxie/image/Image","moxie/core/utils/Events","moxie/runtime/html5/image/ResizerCanvas"])}(this)}.apply(e,arguments),e.moxie}var r,o;function a(){var e={};return function(e){!function(e,T,S){function O(e){function i(e,t,i){var n={chunks:"slice_blob",jpgresize:"send_binary_string",pngresize:"send_binary_string",progress:"report_upload_progress",multi_selection:"select_multiple",dragdrop:"drag_and_drop",drop_element:"drag_and_drop",headers:"send_custom_headers",urlstream_upload:"send_binary_string",canSendBinary:"send_binary",triggerDialog:"summon_file_dialog"};n[e]?r[n[e]]=t:i||(r[e]=t)}var t=e.required_features,r={};return"string"==typeof t?L.each(t.split(/\s*,\s*/),function(e){i(e,!0)}):"object"==_typeof(t)?L.each(t,function(e,t){i(t,e)}):t===!0&&(e.chunk_size&&e.chunk_size>0&&(r.slice_blob=!0),L.isEmptyObj(e.resize)&&e.multipart!==!1||(r.send_binary_string=!0),e.http_method&&(r.use_http_method=e.http_method),L.each(e,function(e,t){i(t,!!e,!0)})),r}var D=window.setTimeout,C={},t=T.core.utils,N=T.runtime.Runtime,L={VERSION:"2.3.6",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,FILE_DUPLICATE_ERROR:-602,IMAGE_FORMAT_ERROR:-700,MEMORY_ERROR:-701,IMAGE_DIMENSIONS_ERROR:-702,moxie:T,mimeTypes:t.Mime.mimes,ua:t.Env,typeOf:t.Basic.typeOf,extend:t.Basic.extend,guid:t.Basic.guid,getAll:function e(t){var i,n=[];"array"!==L.typeOf(t)&&(t=[t]);for(var r=t.length;r--;){i=L.get(t[r]),i&&n.push(i)}return n.length?n:null},get:t.Dom.get,each:t.Basic.each,getPos:t.Dom.getPos,getSize:t.Dom.getSize,xmlEncode:function e(t){var i={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},n=/[<>&\"\']/g;return t?(""+t).replace(n,function(e){return i[e]?"&"+i[e]+";":e}):t},toArray:t.Basic.toArray,inArray:t.Basic.inArray,inSeries:t.Basic.inSeries,addI18n:T.core.I18n.addI18n,translate:T.core.I18n.translate,sprintf:t.Basic.sprintf,isEmptyObj:t.Basic.isEmptyObj,hasClass:t.Dom.hasClass,addClass:t.Dom.addClass,removeClass:t.Dom.removeClass,getStyle:t.Dom.getStyle,addEvent:t.Events.addEvent,removeEvent:t.Events.removeEvent,removeAllEvents:t.Events.removeAllEvents,cleanName:function e(t){var i,n;for(n=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"],i=0;i<n.length;i+=2){t=t.replace(n[i],n[i+1])}return t=t.replace(/\s+/g,"_"),t=t.replace(/[^a-z0-9_\-\.]+/gi,"")},buildUrl:function e(t,i){var n="";return L.each(i,function(e,t){n+=(n?"&":"")+encodeURIComponent(t)+"="+encodeURIComponent(e)}),n&&(t+=(t.indexOf("?")>0?"&":"?")+n),t},formatSize:function e(t){function i(e,t){return Math.round(e*Math.pow(10,t))/Math.pow(10,t)}if(t===S||/\D/.test(t))return L.translate("N/A");var n=Math.pow(1024,4);return t>n?i(t/n,1)+" "+L.translate("tb"):t>(n/=1024)?i(t/n,1)+" "+L.translate("gb"):t>(n/=1024)?i(t/n,1)+" "+L.translate("mb"):t>1024?Math.round(t/1024)+" "+L.translate("kb"):t+" "+L.translate("b")},parseSize:t.Basic.parseSizeStr,predictRuntime:function e(t,i){var n,r;return n=new L.Uploader(t),r=N.thatCan(n.getOption().required_features,i||t.runtimes),n.destroy(),r},addFileFilter:function e(t,i){C[t]=i}};L.addFileFilter("mime_types",function(e,t,i){e.length&&!e.regexp.test(t.name)?(this.trigger("Error",{code:L.FILE_EXTENSION_ERROR,message:L.translate("File extension error."),file:t}),i(!1)):i(!0)}),L.addFileFilter("max_file_size",function(e,t,i){var n;e=L.parseSize(e),t.size!==n&&e&&t.size>e?(this.trigger("Error",{code:L.FILE_SIZE_ERROR,message:L.translate("File size error."),file:t}),i(!1)):i(!0)}),L.addFileFilter("prevent_duplicates",function(e,t,i){if(e)for(var n=this.files.length;n--;){if(t.name===this.files[n].name&&t.size===this.files[n].size)return this.trigger("Error",{code:L.FILE_DUPLICATE_ERROR,message:L.translate("Duplicate file error."),file:t}),i(!1),void 0}i(!0)}),L.addFileFilter("prevent_empty",function(e,t,i){e&&!t.size&&t.size!==S?(this.trigger("Error",{code:L.FILE_SIZE_ERROR,message:L.translate("File size error."),file:t}),i(!1)):i(!0)}),L.Uploader=function(e){function i(){var e,t,i=0;if(this.state==L.STARTED){for(t=0;t<b.length;t++){e||b[t].status!=L.QUEUED?i++:(e=b[t],this.trigger("BeforeUpload",e)&&(e.status=L.UPLOADING,this.trigger("UploadFile",e)))}i==b.length&&(this.state!==L.STOPPED&&(this.state=L.STOPPED,this.trigger("StateChanged")),this.trigger("UploadComplete",b))}}function n(e){e.percent=e.size>0?Math.ceil(100*(e.loaded/e.size)):100,r()}function r(){var e,t,i,n=0;for(y.reset(),e=0;e<b.length;e++){t=b[e],t.size!==S?(y.size+=t.origSize,i=t.loaded*t.origSize/t.size,(!t.completeTimestamp||t.completeTimestamp>x)&&(n+=i),y.loaded+=i):y.size=S,t.status==L.DONE?y.uploaded++:t.status==L.FAILED?y.failed++:y.queued++}y.size===S?y.percent=b.length>0?Math.ceil(100*(y.uploaded/b.length)):0:(y.bytesPerSec=Math.ceil(n/((+new Date-x||1)/1e3)),y.percent=y.size>0?Math.ceil(100*(y.loaded/y.size)):0)}function l(){var e=R[0]||A[0];return e?e.getRuntime().uid:!1}function o(){this.bind("FilesAdded FilesRemoved",function(e){e.trigger("QueueChanged"),e.refresh()}),this.bind("CancelUpload",h),this.bind("BeforeUpload",u),this.bind("UploadFile",c),this.bind("UploadProgress",d),this.bind("StateChanged",f),this.bind("QueueChanged",r),this.bind("Error",p),this.bind("FileUploaded",m),this.bind("Destroy",g)}function a(n,e){var r=this,o=0,t=[],a={runtime_order:n.runtimes,required_caps:n.required_features,preferred_caps:E,swf_url:n.flash_swf_url,xap_url:n.silverlight_xap_url};L.each(n.runtimes.split(/\s*,\s*/),function(e){n[e]&&(a[e]=n[e])}),n.browse_button&&L.each(n.browse_button,function(i){t.push(function(t){var e=new T.file.FileInput(L.extend({},a,{accept:n.filters.mime_types,name:n.file_data_name,multiple:n.multi_selection,container:n.container,browse_button:i}));e.onready=function(){var e=N.getInfo(this.ruid);L.extend(r.features,{chunks:e.can("slice_blob"),multipart:e.can("send_multipart"),multi_selection:e.can("select_multiple")}),o++,R.push(this),t()},e.onchange=function(){r.addFile(this.files)},e.bind("mouseenter mouseleave mousedown mouseup",function(e){I||(n.browse_button_hover&&("mouseenter"===e.type?L.addClass(i,n.browse_button_hover):"mouseleave"===e.type&&L.removeClass(i,n.browse_button_hover)),n.browse_button_active&&("mousedown"===e.type?L.addClass(i,n.browse_button_active):"mouseup"===e.type&&L.removeClass(i,n.browse_button_active)))}),e.bind("mousedown",function(){r.trigger("Browse")}),e.bind("error runtimeerror",function(){e=null,t()}),e.init()})}),n.drop_element&&L.each(n.drop_element,function(i){t.push(function(t){var e=new T.file.FileDrop(L.extend({},a,{drop_zone:i}));e.onready=function(){var e=N.getInfo(this.ruid);L.extend(r.features,{chunks:e.can("slice_blob"),multipart:e.can("send_multipart"),dragdrop:e.can("drag_and_drop")}),o++,A.push(this),t()},e.ondrop=function(){r.addFile(this.files)},e.bind("error runtimeerror",function(){e=null,t()}),e.init()})}),L.inSeries(t,function(){"function"==typeof e&&e(o)})}function t(t,i,e,n){var r=new T.image.Image;try{r.onload=function(){i.width>this.width&&i.height>this.height&&i.quality===S&&i.preserve_headers&&!i.crop?(this.destroy(),n(t)):r.downsize(i.width,i.height,i.crop,i.preserve_headers)},r.onresize=function(){var e=this.getAsBlob(t.type,i.quality);this.destroy(),n(e)},r.bind("error runtimeerror",function(){this.destroy(),n(t)}),r.load(t,e)}catch(e){n(t)}}function s(e,t,i){function n(e,t,i){var n=v[e];switch(e){case"max_file_size":"max_file_size"===e&&(v.max_file_size=v.filters.max_file_size=t);break;case"chunk_size":(t=L.parseSize(t))&&(v[e]=t,v.send_file_name=!0);break;case"multipart":v[e]=t,t||(v.send_file_name=!0);break;case"http_method":v[e]="PUT"===t.toUpperCase()?"PUT":"POST";break;case"unique_names":v[e]=t,t&&(v.send_file_name=!0);break;case"filters":"array"===L.typeOf(t)&&(t={mime_types:t}),i?L.extend(v.filters,t):v.filters=t,t.mime_types&&("string"===L.typeOf(t.mime_types)&&(t.mime_types=T.core.utils.Mime.mimes2extList(t.mime_types)),t.mime_types.regexp=function(e){var t=[];return L.each(e,function(e){L.each(e.extensions.split(/,/),function(e){/^\s*\*\s*$/.test(e)?t.push("\\.*"):t.push("\\."+e.replace(new RegExp("["+"/^$.*+?|()[]{}\\".replace(/./g,"\\$&")+"]","g"),"\\$&"))})}),new RegExp("("+t.join("|")+")$","i")}(t.mime_types),v.filters.mime_types=t.mime_types);break;case"resize":v.resize=t?L.extend({preserve_headers:!0,crop:!1},t):!1;break;case"prevent_duplicates":v.prevent_duplicates=v.filters.prevent_duplicates=!!t;break;case"container":case"browse_button":case"drop_element":t="container"===e?L.get(t):L.getAll(t);case"runtimes":case"multi_selection":case"flash_swf_url":case"silverlight_xap_url":v[e]=t,i||(o=!0);break;default:v[e]=t}i||r.trigger("OptionChanged",e,t,n)}var r=this,o=!1;"object"==_typeof(e)?L.each(e,function(e,t){n(t,e,i)}):n(e,t,i),i?(v.required_features=O(L.extend({},v)),E=O(L.extend({},v,{required_features:!0}))):o&&(r.trigger("Destroy"),a.call(r,v,function(e){e?(r.runtime=N.getInfo(l()).type,r.trigger("Init",{runtime:r.runtime}),r.trigger("PostInit")):r.trigger("Error",{code:L.INIT_ERROR,message:L.translate("Init error.")})}))}function u(e,t){if(e.settings.unique_names){var i=t.name.match(/\.([^.]+)$/),n="part";i&&(n=i[1]),t.target_name=t.id+"."+n}}function c(r,o){function a(){d-- >0?D(s,1e3):(o.loaded=h,r.trigger("Error",{code:L.HTTP_ERROR,message:L.translate("HTTP Error."),file:o,response:w.responseText,status:w.status,responseHeaders:w.getAllResponseHeaders()}))}function s(){var e,t,i={};o.status===L.UPLOADING&&r.state!==L.STOPPED&&(r.settings.send_file_name&&(i.name=o.target_name||o.name),l&&f.chunks&&u.size>l?(t=Math.min(l,u.size-h),e=u.slice(h,h+t)):(t=u.size,e=u),l&&f.chunks&&(r.settings.send_chunk_number?(i.chunk=Math.ceil(h/l),i.chunks=Math.ceil(u.size/l)):(i.offset=h,i.total=u.size)),r.trigger("BeforeChunkUpload",o,i,e,h)&&n(i,e,t))}function n(e,t,i){var n;w=new T.xhr.XMLHttpRequest,w.upload&&(w.upload.onprogress=function(e){o.loaded=Math.min(o.size,h+e.loaded),r.trigger("UploadProgress",o)}),w.onload=function(){return w.status<200||w.status>=400?(a(),void 0):(d=r.settings.max_retries,i<u.size?(t.destroy(),h+=i,o.loaded=Math.min(h,u.size),r.trigger("ChunkUploaded",o,{offset:o.loaded,total:u.size,response:w.responseText,status:w.status,responseHeaders:w.getAllResponseHeaders()}),"Android Browser"===L.ua.browser&&r.trigger("UploadProgress",o)):o.loaded=o.size,t=n=null,!h||h>=u.size?(o.size!=o.origSize&&(u.destroy(),u=null),r.trigger("UploadProgress",o),o.status=L.DONE,o.completeTimestamp=+new Date,r.trigger("FileUploaded",o,{response:w.responseText,status:w.status,responseHeaders:w.getAllResponseHeaders()})):D(s,1),void 0)},w.onerror=function(){a()},w.onloadend=function(){this.destroy()},r.settings.multipart&&f.multipart?(w.open(r.settings.http_method,c,!0),L.each(r.settings.headers,function(e,t){w.setRequestHeader(t,e)}),n=new T.xhr.FormData,L.each(L.extend(e,r.settings.multipart_params),function(e,t){n.append(t,e)}),n.append(r.settings.file_data_name,t),w.send(n,m)):(c=L.buildUrl(r.settings.url,L.extend(e,r.settings.multipart_params)),w.open(r.settings.http_method,c,!0),L.each(r.settings.headers,function(e,t){w.setRequestHeader(t,e)}),w.hasRequestHeader("Content-Type")||w.setRequestHeader("Content-Type","application/octet-stream"),w.send(t,m))}var u,c=r.settings.url,l=r.settings.chunk_size,d=r.settings.max_retries,f=r.features,h=0,m={runtime_order:r.settings.runtimes,required_caps:r.settings.required_features,preferred_caps:E,swf_url:r.settings.flash_swf_url,xap_url:r.settings.silverlight_xap_url};o.loaded&&(h=o.loaded=l?l*Math.floor(o.loaded/l):0),u=o.getSource(),L.isEmptyObj(r.settings.resize)||-1===L.inArray(u.type,["image/jpeg","image/png"])?s():t(u,r.settings.resize,m,function(e){u=e,o.size=e.size,s()})}function d(e,t){n(t)}function f(e){if(e.state==L.STARTED)x=+new Date;else if(e.state==L.STOPPED)for(var t=e.files.length-1;t>=0;t--){e.files[t].status==L.UPLOADING&&(e.files[t].status=L.QUEUED,r())}}function h(){w&&w.abort()}function m(e){r(),D(function(){i.call(e)},1)}function p(e,t){t.code===L.INIT_ERROR?e.destroy():t.code===L.HTTP_ERROR&&(t.file.status=L.FAILED,t.file.completeTimestamp=+new Date,n(t.file),e.state==L.STARTED&&(e.trigger("CancelUpload"),D(function(){i.call(e)},1)))}function g(e){e.stop(),L.each(b,function(e){e.destroy()}),b=[],R.length&&(L.each(R,function(e){e.destroy()}),R=[]),A.length&&(L.each(A,function(e){e.destroy()}),A=[]),E={},I=!1,x=w=null,y.reset()}var v,x,y,w,_=L.guid(),b=[],E={},R=[],A=[],I=!1;v={chunk_size:0,file_data_name:"file",filters:{mime_types:[],max_file_size:0,prevent_duplicates:!1,prevent_empty:!0},flash_swf_url:"js/Moxie.swf",http_method:"POST",max_retries:0,multipart:!0,multi_selection:!0,resize:!1,runtimes:N.order,send_file_name:!0,send_chunk_number:!0,silverlight_xap_url:"js/Moxie.xap"},s.call(this,e,null,!0),y=new L.QueueProgress,L.extend(this,{id:_,uid:_,state:L.STOPPED,features:{},runtime:null,files:b,settings:v,total:y,init:function e(){var t,i,n=this;return t=n.getOption("preinit"),"function"==typeof t?t(n):L.each(t,function(e,t){n.bind(t,e)}),o.call(n),L.each(["container","browse_button","drop_element"],function(e){return null===n.getOption(e)?(i={code:L.INIT_ERROR,message:L.sprintf(L.translate("%s specified, but cannot be found."),e)},!1):void 0}),i?n.trigger("Error",i):v.browse_button||v.drop_element?(a.call(n,v,function(e){var t=n.getOption("init");"function"==typeof t?t(n):L.each(t,function(e,t){n.bind(t,e)}),e?(n.runtime=N.getInfo(l()).type,n.trigger("Init",{runtime:n.runtime}),n.trigger("PostInit")):n.trigger("Error",{code:L.INIT_ERROR,message:L.translate("Init error.")})}),void 0):n.trigger("Error",{code:L.INIT_ERROR,message:L.translate("You must specify either browse_button or drop_element.")})},setOption:function e(t,i){s.call(this,t,i,!this.runtime)},getOption:function e(t){return t?v[t]:v},refresh:function e(){R.length&&L.each(R,function(e){e.trigger("Refresh")}),this.trigger("Refresh")},start:function e(){this.state!=L.STARTED&&(this.state=L.STARTED,this.trigger("StateChanged"),i.call(this))},stop:function e(){this.state!=L.STOPPED&&(this.state=L.STOPPED,this.trigger("StateChanged"),this.trigger("CancelUpload"))},disableBrowse:function e(){I=arguments[0]!==S?arguments[0]:!0,R.length&&L.each(R,function(e){e.disable(I)}),this.trigger("DisableBrowse",I)},getFile:function e(t){var i;for(i=b.length-1;i>=0;i--){if(b[i].id===t)return b[i]}},addFile:function e(t,n){function r(n,e){var t=[];L.each(s.settings.filters,function(e,i){C[i]&&t.push(function(t){C[i].call(s,e,n,function(e){t(!e)})})}),L.inSeries(t,e)}function o(i){var e=L.typeOf(i);if(i instanceof T.file.File){if(!i.ruid&&!i.isDetached()){if(!a)return!1;i.ruid=a,i.connectRuntime(a)}o(new L.File(i))}else i instanceof T.file.Blob?(o(i.getSource()),i.destroy()):i instanceof L.File?(n&&(i.name=n),u.push(function(t){r(i,function(e){e||(b.push(i),c.push(i),s.trigger("FileFiltered",i)),D(t,1)})})):-1!==L.inArray(e,["file","blob"])?o(new T.file.File(null,i)):"node"===e&&"filelist"===L.typeOf(i.files)?L.each(i.files,o):"array"===e&&(n=null,L.each(i,o))}var a,s=this,u=[],c=[];a=l(),o(t),u.length&&L.inSeries(u,function(){c.length&&s.trigger("FilesAdded",c)})},removeFile:function e(t){for(var i="string"==typeof t?t:t.id,n=b.length-1;n>=0;n--){if(b[n].id===i)return this.splice(n,1)[0]}},splice:function e(t,i){var n=b.splice(t===S?0:t,i===S?b.length:i),r=!1;return this.state==L.STARTED&&(L.each(n,function(e){return e.status===L.UPLOADING?(r=!0,!1):void 0}),r&&this.stop()),this.trigger("FilesRemoved",n),L.each(n,function(e){e.destroy()}),r&&this.start(),n},dispatchEvent:function e(t){var i,n;if(t=t.toLowerCase(),i=this.hasEventListener(t)){i.sort(function(e,t){return t.priority-e.priority}),n=[].slice.call(arguments),n.shift(),n.unshift(this);for(var r=0;r<i.length;r++){if(i[r].fn.apply(i[r].scope,n)===!1)return!1}}return!0},bind:function e(t,i,n,r){L.Uploader.prototype.bind.call(this,t,i,r,n)},destroy:function e(){this.trigger("Destroy"),v=y=null,this.unbindAll()}})},L.Uploader.prototype=T.core.EventTarget.instance,L.File=function(){function e(e){L.extend(this,{id:L.guid(),name:e.name||e.fileName,type:e.type||"",relativePath:e.relativePath||"",size:e.fileSize||e.size,origSize:e.fileSize||e.size,loaded:0,percent:0,status:L.QUEUED,lastModifiedDate:e.lastModifiedDate||(new Date).toLocaleString(),completeTimestamp:0,getNative:function e(){var t=this.getSource().getSource();return-1!==L.inArray(L.typeOf(t),["blob","file"])?t:null},getSource:function e(){return i[this.id]?i[this.id]:null},destroy:function e(){var t=this.getSource();t&&(t.destroy(),delete i[this.id])}}),i[this.id]=e}var i={};return e}(),L.QueueProgress=function(){var e=this;e.size=0,e.loaded=0,e.uploaded=0,e.failed=0,e.queued=0,e.percent=0,e.bytesPerSec=0,e.reset=function(){e.size=e.loaded=e.uploaded=e.failed=e.queued=e.percent=e.bytesPerSec=0}},e.plupload=L}(this,e)}.apply(e,arguments),e.plupload}r=this||window,"object"==_typeof(t)&&t.exports?t.exports=n():r.moxie=n(),o=this||window,"object"==_typeof(t)&&t.exports?t.exports=a(e("./moxie")):o.plupload=a(o.moxie)},{"./moxie":3}],5:[function(e,t,i){var n=i.cache={};i.insert=function(e){if(!n[e]){n[e]=!0;var t=document.createElement("style");return t.setAttribute("type","text/css"),"textContent"in t?t.textContent=e:t.styleSheet.cssText=e,document.getElementsByTagName("head")[0].appendChild(t),t}}},{}],6:[function(o,a,e){(function(e){o("vueify/lib/insert-css").insert(".plupload-btn{color:#fff;background-color:#337ab7;border-color:#2e6da4;display:inline-block;padding:6px 12px;margin-bottom:0;font-size:14px;font-weight:400;line-height:1.42857143;text-align:center;vertical-align:middle;-ms-touch-action:manipulation;touch-action:manipulation;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background-image:none;border:1px solid transparent;border-radius:4px}");var i=e.Vue||o("vue"),r=o("plupload"),t=o("lodash.merge"),n={runtimes:"html5,html4"};a.exports=i.extend({props:{class:{type:String,default:"plupload-btn"},text:{type:String,default:"Upload"},options:{type:Object,default:function(){return{}}}},data:function(){return{uploader:null}},detached:function(){},watch:{options:{handler:function(e){if(this.uploader){var t=this.mergeOptions(e);this.uploader.setOption(t)}else this.renderPlupload()},deep:!0}},methods:{mergeOptions:function(e){return t(n,e,{browse_button:this.$els.btn})},renderPlupload:function(){var t=this,n=this;i.nextTick(function(){var e=t.mergeOptions(t.options);t.uploader=new r.Uploader(e),t.uploader.bind("PostInit",function(e){n.$emit("init",e)}),t.uploader.bind("FilesAdded",function(e,t){n.$emit("added",e,t)}),t.uploader.bind("UploadProgress",function(e,t){n.$emit("progress",e,t)}),t.uploader.bind("FileUploaded",function(e,t,i){n.$emit("uploaded",e,t,i)}),t.uploader.bind("Error",function(e,t){n.$emit("error",e,t)}),t.uploader.init()})}},attached:function(){this.renderPlupload()}}),a.exports.__esModule&&(a.exports=a.exports.default),("function"==typeof a.exports?a.exports.options:a.exports).template='<input v-el:btn="" :class=class :value=text type=button>'}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"lodash.merge":2,plupload:4,vue:"vue","vueify/lib/insert-css":5}]},{},[1])(1)});
//# sourceMappingURL=vue-plupload.js.map
